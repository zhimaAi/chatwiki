{"version":3,"file":"detail-BFxSU1uH.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/explore/plugins/components/version-modal.vue","../../../../front-end/chat-ai-admin-vue/src/views/explore/plugins/detail.vue"],"sourcesContent":["<template>\r\n  <a-modal\r\n    :title=\"t('title_version_history')\"\r\n    v-model:open=\"open\"\r\n    width=\"500px\"\r\n    :footer=\"null\"\r\n  >\r\n    <a-table :columns=\"columns\" :data-source=\"list\"></a-table>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref} from 'vue';\r\nimport { useI18n } from '@/hooks/web/useI18n';\r\n\r\nconst { t } = useI18n('views.explore.plugins.components.version-modal');\r\n\r\nconst open = ref(false)\r\nconst list = ref([])\r\nconst columns = [\r\n  {\r\n    title: t('label_version'),\r\n    dataIndex: 'version',\r\n    width: 100,\r\n  },\r\n  {\r\n    title: t('label_update_time'),\r\n    dataIndex: 'update_time_text',\r\n    width: 160,\r\n  },\r\n  {\r\n    title: t('label_publisher'),\r\n    dataIndex: 'author',\r\n    width: 100,\r\n  }\r\n]\r\n\r\nfunction show(versions= []) {\r\n  list.value = versions\r\n  open.value = true\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","<template>\r\n  <div class=\"_container _plugin-detail-cont\">\r\n    <div class=\"header\">\r\n      <LeftOutlined @click=\"router.back()\" class=\"back-icon\"/>\r\n      <span class=\"title\">{{ t('title_plugin_detail') }}</span>\r\n    </div>\r\n    <LoadingBox v-if=\"loading\"/>\r\n    <div v-else class=\"content\">\r\n      <div class=\"base-info\">\r\n        <div class=\"top\">\r\n          <img class=\"avatar\" :src=\"info.icon\"/>\r\n          <div class=\"info\">\r\n            <div class=\"left\">\r\n              <div class=\"name zm-line1\">{{ info.title }}</div>\r\n              <div class=\"source\">{{ info.author }}</div>\r\n            </div>\r\n            <div class=\"right\">\r\n              <a v-if=\"info.help_url\" :href=\"info.help_url\" target=\"_blank\">\r\n                <a-button type=\"primary\" ghost>{{ t('btn_usage_guide') }}</a-button>\r\n              </a>\r\n              <template v-if=\"info.local\">\r\n                <a-button v-if=\"info.has_update\" type=\"primary\" @click=\"install\">{{ t('btn_update') }}</a-button>\r\n                <a-button v-else>{{ t('btn_installed') }}</a-button>\r\n              </template>\r\n              <a-button v-else type=\"primary\" @click=\"install\">{{ t('btn_install') }}</a-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"desc\">{{ info.description }}</div>\r\n        <div class=\"action-box\">\r\n          <div class=\"left\">\r\n            <svg-icon name=\"download\"/>\r\n            {{ info.installed_count || 0 }}\r\n          </div>\r\n          <div class=\"right\"></div>\r\n        </div>\r\n      </div>\r\n      <div class=\"detail-info\">\r\n        <div class=\"left\">\r\n          <div v-if=\"info.overview\" class=\"main-block\">\r\n            <div class=\"main-tit\">{{ t('title_plugin_overview') }}</div>\r\n            <pre class=\"text-cont\">{{info.overview}}</pre>\r\n          </div>\r\n          <div class=\"main-block\">\r\n            <div class=\"main-tit\">{{ t('btn_usage_guide') }}</div>\r\n            <pre class=\"text-cont\" v-viewer v-html=\"info.introduction\"></pre>\r\n          </div>\r\n        </div>\r\n        <div class=\"right\">\r\n          <div class=\"main-block\">\r\n            <div class=\"main-tit\">{{ t('title_category') }}</div>\r\n            <div class=\"text-cont flex-center\">\r\n              <img class=\"cate-icon\" :src=\"info.filter_type_icon\"/>\r\n              {{info.filter_type_title}}\r\n            </div>\r\n          </div>\r\n          <div class=\"main-block\">\r\n            <div class=\"main-tit\">{{ t('title_version') }}</div>\r\n            <div class=\"version-info\">\r\n              v{{ info.latest_version }}\r\n              <a-divider type=\"vertical\"/>\r\n              {{ info.author }} {{ dayjs.unix(info?.latest_version_detail?.update_time).format('YYYY-MM-DD HH:mm') }}\r\n            </div>\r\n            <div class=\"text-cont\">{{info?.latest_version_detail?.upgrade_description}}</div>\r\n            <div>\r\n              <a @click=\"showVersionHistory\">{{ t('btn_version_history') }}\r\n                <RightOutlined/>\r\n              </a>\r\n            </div>\r\n          </div>\r\n          <div class=\"main-block\">\r\n            <div class=\"main-tit\">{{ t('title_permissions') }}</div>\r\n            <div class=\"text-cont\">{{ t('label_max_memory') }} {{ info?.latest_version_detail?.memory }}MB</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <VersionModal ref=\"versionRef\"/>\r\n    <UpdateModal ref=\"updateRef\" @ok=\"loadInfo\"/>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {onMounted, ref} from 'vue';\r\nimport {useRouter, useRoute} from 'vue-router';\r\nimport dayjs from 'dayjs';\r\nimport {LeftOutlined, RightOutlined} from '@ant-design/icons-vue';\r\nimport VersionModal from \"./components/version-modal.vue\";\r\nimport UpdateModal from \"./components/update-modal.vue\";\r\nimport LoadingBox from \"@/components/common/loading-box.vue\";\r\nimport {getPluginInfo} from \"@/api/plugins/index.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n';\r\n\r\nconst { t } = useI18n('views.explore.plugins.detail')\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst updateRef = ref(true)\r\nconst loading = ref(true)\r\nconst pluginKey = ref(null)\r\nconst versionRef = ref(null)\r\nconst info = ref({})\r\n\r\nonMounted(() => {\r\n  pluginKey.value = route.query?.name\r\n  loadInfo()\r\n})\r\n\r\nfunction loadInfo() {\r\n  loading.value = true\r\n  getPluginInfo({name: pluginKey.value}).then(res => {\r\n    let data = res?.data || {}\r\n    info.value = data.remote\r\n    info.value.local = data.local\r\n    info.value.has_update = (data.local?.version != data.remote?.latest_version)\r\n    info.value.latest_version_history.map(item => {\r\n      item.update_time_text = dayjs.unix(item.update_time).format('YYYY-MM-DD HH:mm')\r\n      item.author = info.value.author\r\n    })\r\n  }).finally(() => {\r\n    loading.value = false\r\n  })\r\n}\r\n\r\nfunction showVersionHistory() {\r\n  versionRef.value.show(info.value.latest_version_history || [])\r\n}\r\n\r\nfunction install() {\r\n  let {latest_version_detail, local} = info.value\r\n  updateRef.value.show(info.value, latest_version_detail, local)\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n._plugin-detail-cont .text-cont {\r\n    img {\r\n      max-width: 640px;\r\n      cursor: pointer;\r\n    }\r\n}\r\n</style>\r\n<style scoped lang=\"less\">\r\n._container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  overflow: hidden;\r\n\r\n  > div {\r\n    width: 952px;\r\n  }\r\n\r\n  .header {\r\n    padding: 16px 0;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    color: #000000;\r\n    font-size: 20px;\r\n    font-weight: 600;\r\n\r\n    .back-icon {\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  .base-info {\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 24px;\r\n    gap: 12px;\r\n    border-radius: 12px;\r\n    border: 1px solid #E4E6EB;\r\n\r\n    .top {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 12px;\r\n\r\n      .avatar {\r\n        width: 62px;\r\n        height: 62px;\r\n        border-radius: 16px;\r\n        border: 1px solid #F0F0F0;\r\n      }\r\n\r\n      .info {\r\n        flex: 1;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n      }\r\n\r\n      .name {\r\n        color: #262626;\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n      }\r\n\r\n      .source {\r\n        color: #8C8C8C;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n      }\r\n    }\r\n\r\n    .right {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n    }\r\n\r\n    .desc {\r\n      color: #595959;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n    }\r\n\r\n    .action-box {\r\n      width: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      color: #595959;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n    }\r\n  }\r\n\r\n  .detail-info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    margin-top: 24px;\r\n\r\n    .left {\r\n      padding-right: 32px;\r\n      border-right: 1px solid #F0F0F0;\r\n      flex-shrink: 0;\r\n      width: calc(100% - 280px);\r\n    }\r\n\r\n    .right {\r\n      padding-left: 24px;\r\n      width: 280px;\r\n      flex-shrink: 0;\r\n    }\r\n\r\n    .main-block {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n      margin-bottom: 32px;\r\n\r\n      .main-tit {\r\n        color: #000000;\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n        margin-bottom: 8px;\r\n      }\r\n\r\n      .text-cont {\r\n        color: #595959;\r\n        font-size: 14px;\r\n        font-weight: 400;\r\n        line-height: 22px;\r\n        white-space: pre-wrap;\r\n        word-wrap: break-word;\r\n        overflow: hidden;\r\n\r\n        img {\r\n          max-width: 620px !important;\r\n          cursor: pointer;\r\n        }\r\n      }\r\n\r\n      .version-info {\r\n        color: #262626;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.cate-icon {\r\n  width: 14px;\r\n  height: 14px;\r\n  margin-right: 4px;\r\n}\r\n\r\n.flex-center {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n</style>\r\n"],"names":["t","useI18n","open","ref","list","columns","show","versions","__expose","_createBlock","_component_a_modal","_unref","$event","_createVNode","_component_a_table","router","useRouter","route","useRoute","updateRef","loading","pluginKey","versionRef","info","onMounted","_a","loadInfo","getPluginInfo","res","data","_b","item","dayjs","showVersionHistory","install","latest_version_detail","local","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","LeftOutlined","_cache","_hoisted_3","_toDisplayString","LoadingBox","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_component_a_button","_Fragment","_hoisted_14","_hoisted_15","_hoisted_16","_component_svg_icon","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_30","_hoisted_31","_hoisted_32","_createTextVNode","_component_a_divider","_hoisted_33","_d","_c","RightOutlined","_hoisted_34","_hoisted_35","_hoisted_36","_f","_e","VersionModal","UpdateModal"],"mappings":"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"}