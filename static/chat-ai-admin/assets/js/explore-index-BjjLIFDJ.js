import{_ as V}from"./cu-scroll-CpIj948h.js";import{ag as A,a as v,b as x,F as N,l as L,p as n,y as c,v as b,t as w,u as p,_ as $,r as S,j as z,w as j}from"./vue-chunks-BdaA73Wf.js";import{g as H}from"./index-Cg7-0swo.js";import{w as K,x as B}from"./index-C67uUbSa.js";import{u as F,_ as W,ac as Y,ad as G}from"../../index-DSFcP5NQ.js";import{_ as O}from"./emoji-mart-BBMRoEa3.js";import{q as J,H as P,M,N as Q,B as X,b as q}from"./ui-antd-Dl1wwwCD.js";import{_ as Z}from"./main-tab-CdcTMZsk.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./editor-cherry-CFIsbKoN.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";import"./list-tabs-Dv38O5dh.js";import"./index-BuURB1pl.js";import"./usePublicNetworkCheck-B51wgX5Y.js";const tt={class:"list-box"},ot=["onClick"],et={class:"explore-info"},st={class:"explore-info-content"},nt={class:"explore-title"},lt={class:"item-body"},at={class:"support-box"},it={class:"item-footer"},ct={__name:"index",props:{list:{type:Array,default:()=>[]}},emits:["switchChange","clickItem"],setup(T,{emit:l}){const{t:k}=F("views.explore.explore-index.components.explore-list.index"),C=l,u=A(),m=T,h=(d,r)=>C("switchChange",d,r),D=async(d,r)=>{try{const _=d==null?void 0:d.target;if(_&&typeof _.closest=="function"&&_.closest(".no-bubble"))return;if(r.robot_only_show=="1"){const f=u.resolve({path:r.menu.path});window.open(f.href,"_blank");return}}catch{}C("clickItem",r)};return(d,r)=>{const _=W,f=J,R=P;return x(),v("div",tt,[(x(!0),v(N,null,L(m.list,s=>{var t,e;return x(),v("div",{class:"list-item-wrapper",key:s.id},[n("div",{class:"list-item",onClick:o=>D(o,s)},[n("div",et,[c(_,{class:"explore-icon",name:s.ability_type,style:{"font-size":"62px",color:"white"}},null,8,["name"]),n("div",st,[n("div",nt,b(s.explore_name||s.name),1),r[0]||(r[0]=n("div",{class:"explore-type"},"ChatWiki",-1))])]),n("div",lt,[c(f,{title:p(G)(s.explore_intro,s,14,2,12),placement:"top"},{default:w(()=>[n("div",{class:"explore-desc",ref_for:!0,ref:o=>p(Y)(o,s)},b(s.explore_intro),513)]),_:2},1032,["title"]),n("span",at,[(x(!0),v(N,null,L(s.support_channels_list,o=>(x(),v("span",{key:o,class:"support-item"},[c(_,{name:"support",class:"icon"}),$(" "+b(o),1)]))),128))])]),n("div",it,[c(R,{checked:((t=s.user_config)==null?void 0:t.switch_status)=="1"||((e=s.robot_config)==null?void 0:e.switch_status)=="1","checked-children":p(k)("label_on"),"un-checked-children":p(k)("label_off"),class:"no-bubble",onChange:o=>h(s,o)},null,8,["checked","checked-children","un-checked-children","onChange"])])],8,ot)])}),128))])}}},rt=O(ct,[["__scopeId","data-v-331966e1"]]),_t={"bg-color":"#f5f9ff",class:"explore-page"},pt={class:"explore-page-body"},ut={class:"list-toolbar"},dt={class:"toolbar-box"},ft={class:"list-group-box"},ht={class:"enable-tip-footer"},bt={class:"footer-actions"},E="explore_enable_tip_suppress_until",mt={__name:"explore-index",setup(T){const{t:l}=F("views.explore.explore-index.explore-index"),k=S(null),C=S([]),u=S(!1),m=S(!1),h=A();z(()=>{let t=localStorage.getItem("zm:explore:active");t>1?k.value.change(t):d()});let D=S([]);const d=()=>{K().then(t=>{const e=((t==null?void 0:t.data)||[]).map(o=>({...o,explore_name:o.name,explore_intro:o.introduction}));C.value=e,D.value=(t==null?void 0:t.data)||[]})},r=(t,e)=>{const o=e?"1":"0";if(o==="0"){const i={robot_auto_reply:l("msg_close_confirm_default"),library_ability_official_account:l("msg_close_confirm_library"),robot_payment:l("msg_close_confirm_payment")};M.confirm({title:l("title_tip"),content:i[t.ability_type]||l("msg_close_confirm_default"),onOk:()=>{B({ability_type:t.ability_type,switch_status:o}).then(a=>{a&&a.res==0&&(q.success(l("msg_operation_success")),t.user_config?t.user_config.switch_status=o:t.robot_config&&(t.robot_config.switch_status=o))})}});return}B({ability_type:t.ability_type,switch_status:o}).then(i=>{if(i&&i.res==0){if(q.success(l("msg_operation_success")),t.user_config?t.user_config.switch_status=o:t.robot_config&&(t.robot_config.switch_status=o),t.ability_type==="library_ability_official_account")return;const a=Number(localStorage.getItem(E)||0),g=Date.now();a<=g&&(m.value=!1,t.robot_only_show!=1&&(u.value=!0))}})},_=t=>{switch(t.ability_type){case"library_ability_official_account":const e=h.resolve({path:"/library/list",query:{active:3}});window.open(e.href,"_blank");break;default:t.module_type==="robot"&&t.robot_only_show==0&&s(t);break}},f=()=>{if(m.value){const t=Date.now()+2592e5;localStorage.setItem(E,String(t))}},R=()=>{f(),u.value=!1},s=async t=>{var o;f(),u.value=!1;const e=localStorage.getItem("last_local_robot_id");try{const{data:i=[]}=await H();if(!i.length){const I=h.resolve({path:"/robot/list"});window.open(I.href,"_blank");return}let a;e&&(a=i.find(I=>I.id==e)),a=a||i[0];const{id:g,robot_key:y}=a;if((o=t.menu)!=null&&o.path){const I=h.resolve({path:t.menu.path,query:{id:g,robot_key:y}});window.open(I.href,"_blank");return}const U=h.resolve({path:"/robot/config/function-center",query:{id:g,robot_key:y}});window.open(U.href,"_blank")}catch{const a=h.resolve({path:"/robot/list"});window.open(a.href,"_blank")}};return j(u,(t,e)=>{e&&!t&&f()}),(t,e)=>{const o=V,i=Q,a=X,g=M;return x(),v("div",_t,[n("div",pt,[n("div",ut,[n("div",dt,[c(Z,{ref_key:"tabRef",ref:k},null,512)])]),n("div",ft,[c(o,{style:{"padding-right":"16px",flex:"1"}},{default:w(()=>[c(rt,{list:C.value,onSwitchChange:r,onClickItem:_},null,8,["list"])]),_:1})])]),c(g,{open:u.value,"onUpdate:open":e[1]||(e[1]=y=>u.value=y),title:p(l)("title_tip"),footer:null},{default:w(()=>[n("div",null,b(p(l)("msg_enable_feature_tip")),1),n("div",ht,[c(i,{checked:m.value,"onUpdate:checked":e[0]||(e[0]=y=>m.value=y)},{default:w(()=>[$(b(p(l)("label_dont_remind")),1)]),_:1},8,["checked"]),n("div",bt,[c(a,{onClick:R},{default:w(()=>[$(b(p(l)("btn_cancel")),1)]),_:1}),c(a,{type:"primary",onClick:s},{default:w(()=>[$(b(p(l)("btn_go_to_use")),1)]),_:1})])])]),_:1},8,["open","title"])])}}},At=O(mt,[["__scopeId","data-v-07f68b89"]]);export{At as default};
//# sourceMappingURL=explore-index-BjjLIFDJ.js.map
