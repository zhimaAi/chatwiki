import{ad as O}from"./index-Cg7-0swo.js";import{u as V}from"../../index-DSFcP5NQ.js";import{_ as q}from"./emoji-mart-BBMRoEa3.js";import{u as L,a5 as U,x as W,v as H,q as A}from"./ui-antd-Dl1wwwCD.js";import{E as w,r as T,j as P,a as i,p as h,y as C,t as r,u as B,b as n,F as b,l as E,e as y,_ as M,v as s,q as f,h as z}from"./vue-chunks-BdaA73Wf.js";import"./neo4j-MWxXN7EM.js";import"./editor-cherry-CFIsbKoN.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";const Y={class:"comment-record-page"},G={class:"toolbar"},J={class:"table-box"},K={key:0},Q={key:1},X={key:4,class:"ellipsis1"},Z={key:5,class:"rule-tags"},tt={key:0},et={style:{cursor:"pointer"}},at={key:6},nt={__name:"comment-processing-record",setup(lt){const{t:_}=V("views.explore.ai-comment-management.comment-processing-record"),u=w({check_result:void 0,comment_text:""}),g=w({}),I=T([]),k=T(!1),c=w({page:1,size:10,total:0}),j=[{title:_("column_content_text"),dataIndex:"content_text",key:"content_text",width:220},{title:_("column_result"),dataIndex:"ai_comment_result_text",key:"ai_comment_result_text",width:130},{title:_("column_reply_text"),dataIndex:"reply_comment_text",key:"reply_comment_text",width:220},{title:_("column_draft_title"),dataIndex:"draft_title",key:"draft_title",width:120},{title:_("column_rule_name"),dataIndex:"rule_name",key:"rule_name",width:120},{title:_("column_rule_detail"),dataIndex:"ai_comment_rule_text",key:"ai_comment_rule_text",width:300},{title:_("column_exec_time"),dataIndex:"ai_exec_time",key:"ai_exec_time",width:120}],v=()=>{k.value=!0;const l={page:c.page,size:c.size};u.check_result&&(l.check_result=u.check_result),u.comment_text&&(l.comment_text=u.comment_text),O(l).then(e=>{const p=(e==null?void 0:e.data)||{list:[],total:0,type:{}};I.value=p.list||[],c.total=+p.total||0;const d=p.type||{};Object.keys(g).forEach(m=>delete g[m]),Object.entries(d).forEach(([m,o])=>{g[m]=o})}).finally(()=>{k.value=!1})},$=()=>{c.page=1,v()},D=l=>{c.page=l.current,c.size=l.pageSize,v()},F=l=>{try{const e=new Date(Number(l)*1e3),p=String(e.getFullYear()).slice(2),d=String(e.getMonth()+1).padStart(2,"0"),m=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),x=String(e.getMinutes()).padStart(2,"0");return`${p}-${d}-${m} ${o}:${x}`}catch{return""}};function S(l,e){if(!l)return null;const d=document.createElement("canvas").getContext("2d");d.font='14px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif';const m=d.measureText(l).width,o=document.querySelector(`.titleRef_${e.create_time}`);o&&(e.title_width=o.offsetWidth);const x=(e==null?void 0:e.title_width)||250;return m>x?l:null}return P(()=>{v()}),(l,e)=>{const p=H,d=L,m=U,o=A,x=W;return n(),i("div",Y,[h("div",G,[C(d,{value:u.check_result,"onUpdate:value":e[0]||(e[0]=a=>u.check_result=a),allowClear:"",placeholder:B(_)("filter_result_placeholder"),style:{width:"160px"},onChange:$},{default:r(()=>[(n(!0),i(b,null,E(g,(a,t)=>(n(),y(p,{key:t,value:t},{default:r(()=>[M(s(a),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"]),C(m,{value:u.comment_text,"onUpdate:value":e[1]||(e[1]=a=>u.comment_text=a),allowClear:"",placeholder:B(_)("search_comment_placeholder"),style:{width:"300px"},onSearch:$},null,8,["value","placeholder"])]),h("div",J,[C(x,{columns:j,"data-source":I.value,loading:k.value,"row-key":"id",pagination:{current:c.page,pageSize:c.size,total:c.total,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:D},{headerCell:r(({column:a})=>[typeof a.title=="string"?(n(),i("span",K,s(a.title),1)):f("",!0)]),bodyCell:r(({column:a,record:t})=>[a.key==="content_text"?(n(),y(o,{key:0,title:S(t.content_text,t),placement:"top"},{default:r(()=>[h("div",{class:z(["ellipsis1 title",`titleRef_${t.create_time}`])},s(t.content_text),3)]),_:2},1032,["title"])):a.key==="ai_comment_result_text"?(n(),i("span",Q,s(t.ai_comment_result_text),1)):a.key==="reply_comment_text"?(n(),y(o,{key:2,title:S(t.reply_comment_text,t),placement:"top"},{default:r(()=>[h("div",{class:z(["ellipsis1 title",`titleRef_${t.create_time}`])},s(t.reply_comment_text),3)]),_:2},1032,["title"])):a.key==="draft_title"?(n(),y(o,{key:3,title:S(t.draft_title,t),placement:"top"},{default:r(()=>[h("div",{class:z(["ellipsis1 title",`titleRef_${t.create_time}`])},s(t.draft_title),3)]),_:2},1032,["title"])):a.key==="rule_name"?(n(),i("span",X,s(t.rule_name),1)):a.key==="ai_comment_rule_text"?(n(),i("div",Z,[(n(!0),i(b,null,E((t.ai_comment_rule_text||[]).slice(0,3),(R,N)=>(n(),i(b,{key:R+N},[h("span",null,s(R),1),N<(t.ai_comment_rule_text||[]).length-1?(n(),i("span",tt,", ")):f("",!0)],64))),128)),(t.ai_comment_rule_text||[]).length>3?(n(),y(o,{key:0},{title:r(()=>[M(s((t.ai_comment_rule_text||[]).join(", ")),1)]),default:r(()=>[h("span",et,"...+"+s((t.ai_comment_rule_text||[]).length-3),1)]),_:2},1024)):f("",!0)])):a.key==="ai_exec_time"?(n(),i("span",at,s(F(t.ai_exec_time)),1)):f("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},xt=q(nt,[["__scopeId","data-v-27533eac"]]);export{xt as default};
//# sourceMappingURL=comment-processing-record-DISk1Ii4.js.map
