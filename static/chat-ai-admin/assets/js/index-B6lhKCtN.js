import{_ as ie}from"./cu-scroll-CpIj948h.js";import{_ as _e}from"./page-alert-DLppgA58.js";import{u as P,cn as W,_ as re,co as ce,d as ue,cp as de}from"../../index-DSFcP5NQ.js";import{E as M,V as pe,a as y,b as g,y as e,t as s,p as o,z as me,v as l,u as t,e as N,q as E,_ as v,F as Q,l as H,Y,r as b,j as ge,m as I,ah as ve,x as fe}from"./vue-chunks-BdaA73Wf.js";import{_ as V}from"./emoji-mart-BBMRoEa3.js";import{w as be,q as he,a4 as Z,a9 as we,ad as ye,aa as xe,b2 as ke,x as qe,M as j,b as L,O as X,F as G,c as Se,V as $e,Z as Ce,$ as Oe,b7 as Fe,j as Ke,k as Re,e as De,y as Ee,J as Le,B as ze,a$ as Ue,i as Ae,D as Be,f as Ie,g as Me,b3 as Ne}from"./ui-antd-Dl1wwwCD.js";import{U as Qe}from"./index-XVLbk3qE.js";import{I as Pe}from"./import-knowledge-modal-B_fiIwwA.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./neo4j-MWxXN7EM.js";import"./editor-cherry-CFIsbKoN.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";import"./index-B_UHbFfL.js";import"./validate-8MtiUsxW.js";import"./model-select-CMPvMrAQ.js";import"./index-MT9fcN3v.js";const Ve={class:"subsection-box"},je={class:"qa-list-box"},Te={class:"list-item"},Je={class:"list-label"},He={class:"list-content"},Ye={class:"status-error"},Ze={class:"similar-question-list"},Ge={class:"list-item list-item-answer"},We={class:"list-label"},Xe={class:"list-content"},et={class:"fragment-img"},tt=["src"],st={key:0,class:"status-block status-green"},nt={key:1,class:"status-block status-gray"},ot=["href"],at={class:"right-opration"},lt=["onClick"],it=["onClick"],_t={__name:"subsection-box",props:{paragraphLists:{type:Array,default:()=>[]},total:{type:[Number,String],default:0},isLoading:{type:Boolean,default:!1}},emits:["handleDelParagraph","openEditSubscription"],setup(z,{expose:u,emit:R}){const{t:i}=P("views.ai-extract-faq.detail.components.subsection-box"),x=R,k=z,f=M({selectedRowKeys:[]}),q=d=>{f.selectedRowKeys=d},c=()=>{f.selectedRowKeys=[]},S=d=>{x("openEditSubscription",d)},F=d=>{j.confirm({title:i("title_hint"),icon:e(X),content:i("msg_confirm_delete"),onOk(){return new Promise(($,K)=>{W({ids:d}).then(D=>{L.success(i("msg_delete_success")),x("handleDelParagraph",d),$()}).catch(()=>{$()})})},onCancel(){}})};return u({handleOpenEditModal:S,state:f,resetSelect:c}),(d,$)=>{const K=he,D=we,p=be,_=qe,m=pe("viewer");return g(),y("div",Ve,[e(_,{"data-source":z.paragraphLists,"row-key":"id","row-selection":{selectedRowKeys:f.selectedRowKeys,onChange:q},pagination:!1,loading:k.isLoading},{default:s(()=>[e(p,{key:"id","data-index":"id",width:1148},{title:s(()=>[v(l(t(i)("title_qa",{total:k.total})),1)]),default:s(({record:a})=>[o("div",je,[o("div",Te,[o("div",Je,l(t(i)("label_question")),1),o("div",He,[a.status==2?(g(),N(K,{key:0,placement:"top"},{title:s(()=>[o("span",null,l(a.errmsg),1)]),default:s(()=>[o("span",null,[o("span",Ye,[e(t(Z))])])]),_:2},1024)):E("",!0),v(" "+l(a.question)+" ",1),a.similar_questions&&a.similar_questions.length?(g(),N(D,{key:1,placement:"topLeft",overlayInnerStyle:{"padding-right":"2px"}},{content:s(()=>[o("div",Ze,[(g(!0),y(Q,null,H(a.similar_questions,(C,h)=>(g(),y("div",{class:"similar-question-list-item",key:h},l(C),1))),128))])]),title:s(()=>[o("span",null,l(t(i)("msg_similar_questions",{count:a.similar_questions.length})),1)]),default:s(()=>[o("a",null,"（"+l(a.similar_questions.length)+"）",1)]),_:2},1024)):E("",!0)])]),o("div",Ge,[o("div",We,l(t(i)("label_answer")),1),o("div",Xe,l(a.answer),1)]),me((g(),y("div",et,[(g(!0),y(Q,null,H(a.images,(C,h)=>(g(),y("img",{key:h,src:C,alt:""},null,8,tt))),128))])),[[m]])])]),_:1}),e(p,{title:t(i)("title_import_to_knowledge"),key:"is_import","data-index":"is_import",width:180},{default:s(({record:a})=>[a.is_import==1?(g(),y("div",st,[e(t(ye)),v(l(t(i)("status_imported")),1)])):E("",!0),a.is_import==0?(g(),y("div",nt,[e(t(Z)),v(l(t(i)("status_not_imported")),1)])):E("",!0),o("div",null,[o("a",{href:`/#/library/details/knowledge-document?id=${a.library_id}`,target:"_blank"},l(a.library_name),9,ot)])]),_:1},8,["title"]),e(p,{title:t(i)("title_action"),key:"action","data-index":"action",width:120},{default:s(({record:a,index:C})=>[o("div",at,[o("div",{class:"hover-btn-box",onClick:Y(h=>S(a),["stop"])},[e(t(xe))],8,lt),o("div",{class:"hover-btn-box",onClick:Y(h=>F(a.id),["stop"])},[e(t(ke))],8,it)])]),_:1},8,["title"])]),_:1},8,["data-source","row-selection","loading"])])}}},rt=V(_t,[["__scopeId","data-v-03274dbf"]]),ct={class:"form-box"},ut={class:"upload-box-wrapper"},dt={key:0},pt={__name:"edit-subsection",emits:["ok"],setup(z,{expose:u,emit:R}){const{t:i}=P("views.ai-extract-faq.detail.edit-subsection"),x=R,k=b(!1),f=b("1"),q=G.useForm,c=M({images:[],question:"",answer:"",id:""}),S=M({question:[{required:!0,message:i("msg_input_segment_question"),trigger:"change"}],answer:[{required:!0,message:i("msg_input_segment_answer"),trigger:"change"}]}),{validate:F,validateInfos:d}=q(c,S),$=()=>{F().then(()=>{K()}).catch(p=>{})},K=()=>{let p={...c},_=new FormData;for(let m in p)Fe.isArray(p[m])?p[m].forEach(a=>{_.append(m,a)}):_.append(m,p[m]);ce(_).then(m=>{L.success(i("msg_edit_success")),k.value=!1,x("ok")})};return u({show:p=>{c.question=p.question,c.answer=p.answer,c.id=p.id,c.title=p.title,c.images=p.images||[],k.value=!0}}),ge(()=>{}),(p,_)=>{const m=$e,a=Se,C=re,h=Oe,U=Ce,A=G,r=j;return g(),N(r,{open:k.value,"onUpdate:open":_[4]||(_[4]=n=>k.value=n),onOk:$,title:t(i)("title_edit_segment"),wrapClassName:"no-padding-modal",bodyStyle:{"max-height":"670px","overflow-y":"auto","padding-right":"12px"},width:944},{default:s(()=>[o("div",ct,[e(A,{layout:"vertical"},{default:s(()=>[e(a,I({ref:"question",label:t(i)("label_segment_question")},t(d).question),{default:s(()=>[e(m,{placeholder:t(i)("ph_input_segment_question"),value:c.question,"onUpdate:value":_[0]||(_[0]=n=>c.question=n),style:{height:"100px"}},null,8,["placeholder","value"])]),_:1},16,["label"]),e(a,I({ref:"answer",label:t(i)("label_segment_answer")},t(d).answer),{default:s(()=>[e(m,{placeholder:t(i)("ph_input_segment_answer"),value:c.answer,"onUpdate:value":_[1]||(_[1]=n=>c.answer=n),style:{height:"100px"}},null,8,["placeholder","value"])]),_:1},16,["label"]),e(a,I({label:t(i)("label_attachments")},t(d).images),{default:s(()=>[o("div",ut,[e(U,{activeKey:f.value,"onUpdate:activeKey":_[2]||(_[2]=n=>f.value=n),size:"small"},{default:s(()=>[e(h,{key:"1"},{tab:s(()=>[o("span",null,[e(C,{name:"img-icon",style:{"font-size":"14px",color:"#2475fc"}}),v(" "+l(t(i)("label_image"))+" ",1),c.images.length?(g(),y("span",dt,"("+l(c.images.length)+")",1)):E("",!0)])]),_:1})]),_:1},8,["activeKey"]),e(Qe,{value:c.images,"onUpdate:value":_[3]||(_[3]=n=>c.images=n)},null,8,["value"])])]),_:1},16,["label"])]),_:1})])]),_:1},8,["open","title"])}}},mt=V(pt,[["__scopeId","data-v-f7e1b37a"]]),gt={class:"main-content-box"},vt={class:"breadcrumb-block"},ft={class:"btn-wrapper-box"},bt={class:"content-block"},ht={class:"pagination-box"},wt={__name:"index",setup(z){const{t:u}=P("views.ai-extract-faq.detail.index"),R=ue(),x=ve().query,k=x.file_name,f=b(""),q=b(null),c=b(0),S=b(!1),F=b([]),d=b({page:1,size:100}),$=b(null),K=r=>{$.value.show(JSON.parse(JSON.stringify(r)))},D=(r,n)=>{d.value.page=r,d.value.size=n,_()},p=()=>{d.value.page=1,_()},_=()=>{S.value=!0,de({...d.value,id:x.id,is_import:f.value}).then(r=>{let n=r.data.list||[];n.forEach(O=>{O.images&&(O.images=JSON.parse(O.images))}),F.value=n,c.value=r.data.total,A(r.data.total,r.data.import_total),q.value.resetSelect()}).finally(()=>{S.value=!1})};_();const m=b(null),a=()=>{let r=q.value.state.selectedRowKeys;if(r.length==0)return L.error(u("msg_select_qa_to_import"));m.value.show({id:x.id,ids:r.join(",")})},C=()=>{let r=q.value.state.selectedRowKeys;if(r.length==0)return L.error(u("msg_select_qa_to_delete"));j.confirm({title:u("title_tip"),icon:e(X),content:u("msg_confirm_delete_segment"),onOk(){W({ids:r.join(",")}).then(n=>{L.success(u("msg_delete_success")),_()})},onCancel(){}})},h=r=>{let n=R.getToken,O=`/manage/exportFAQFileAllQA?id=${x.id}&token=${n}&ext=${r}`;window.location.href=O},U=b([]),A=(r,n)=>{U.value=[{value:"",payload:{num:r,title:u("label_all")}},{value:0,payload:{num:r-n,title:u("label_not_imported")}},{value:1,payload:{num:n,title:u("label_imported")}}]};return(r,n)=>{const O=fe("router-link"),T=Re,ee=Ke,te=Ee,B=ze,J=Me,se=Ie,ne=Ae,oe=Le,ae=Ne,le=ie;return g(),y(Q,null,[o("div",gt,[e(le,{style:{"padding-right":"48px"},scrollbar:{minSize:80,fade:!1,interactive:!0,scrollbarTrackClickable:!0}},{default:s(()=>[o("div",vt,[e(ee,null,{default:s(()=>[e(T,null,{default:s(()=>[e(O,{to:"/ai-extract-faq/list"},{default:s(()=>[e(t(De)),v(" "+l(t(u)("label_document_extract_faq")),1)]),_:1})]),_:1}),e(T,null,{default:s(()=>[v(l(t(k)),1)]),_:1})]),_:1})]),e(_e,{class:"mb16",title:t(u)("title_usage_instruction")},{default:s(()=>[o("div",null,[o("p",null,l(t(u)("msg_usage_description")),1)])]),_:1},8,["title"]),o("div",ft,[e(te,{onChange:p,value:f.value,"onUpdate:value":n[0]||(n[0]=w=>f.value=w),options:U.value},{label:s(({payload:w={}})=>[o("div",null,l(w.title)+"（"+l(w.num)+"）",1)]),_:1},8,["value","options"]),e(oe,{gap:8},{default:s(()=>[e(B,{onClick:a,type:"primary",icon:e(t(Ue))},{default:s(()=>[v(l(t(u)("btn_import_knowledge_base")),1)]),_:1},8,["icon"]),e(B,{onClick:C},{default:s(()=>[v(l(t(u)("btn_batch_delete")),1)]),_:1}),e(ne,null,{overlay:s(()=>[e(se,null,{default:s(()=>[e(J,{onClick:n[1]||(n[1]=w=>h("docx")),key:"1"},{default:s(()=>[v(l(t(u)("label_download_as_docx")),1)]),_:1}),e(J,{onClick:n[2]||(n[2]=w=>h("xlsx")),key:"2"},{default:s(()=>[v(l(t(u)("label_download_as_xlsx")),1)]),_:1})]),_:1})]),default:s(()=>[e(B,{type:"primary"},{default:s(()=>[v(l(t(u)("btn_download"))+" ",1),e(t(Be))]),_:1})]),_:1})]),_:1})]),o("div",bt,[e(rt,{ref_key:"subsectionBoxRef",ref:q,total:c.value,isLoading:S.value,paragraphLists:F.value,onOpenEditSubscription:K,onHandleDelParagraph:_},null,8,["total","isLoading","paragraphLists"]),o("div",ht,[e(ae,{current:d.value.page,"onUpdate:current":n[3]||(n[3]=w=>d.value.page=w),"page-size":d.value.size,"onUpdate:pageSize":n[4]||(n[4]=w=>d.value.size=w),total:c.value,pageSizeOptions:["100","200","500","1000"],"show-size-changer":"",onChange:D},null,8,["current","page-size","total"])])])]),_:1})]),e(mt,{ref_key:"editSubscriptionRef",ref:$,onOk:_},null,512),e(Pe,{ref_key:"importKnowledgeModalRef",ref:m,onOk:p},null,512)],64)}}},Nt=V(wt,[["__scopeId","data-v-93982a84"]]);export{Nt as default};
//# sourceMappingURL=index-B6lhKCtN.js.map
