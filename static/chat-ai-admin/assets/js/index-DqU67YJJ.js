import{d as C,a3 as M,z as B,N as f,O as c,j as t,U as e,ae as S,af as N,u as r,Z as a,F as T,a1 as G,_,X as d}from"./vue-chunks-BRsu9_To.js";import{f as H,a as K,u as W,h as Y}from"./index-BZQFjdo3.js";import{b as V,M as L,k as P,B as ee,E as te}from"../../index-Bo1NSLpy.js";import{F as I,_ as oe}from"./index-COWZrpvC.js";import"./index-Caod9rOO.js";import{I as ne}from"./Input-CCKFAS4o.js";import{Q as p}from"./QuestionCircleOutlined-VG1FNUnl.js";import{S as ie,a as le}from"./index-Bs02Ec-o.js";import{_ as D}from"./index-B4MPC5xv.js";import{_ as E}from"./index-Dlji98bI.js";import{P as ae}from"./PlusOutlined-vSxn8uyP.js";import{_ as se,a as re}from"./index-Ct9MFKxB.js";import{_ as de}from"./index-CNGEafUN.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Trigger-DtRTHvld.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-CHj0iPA3.js";import"./Col-QoogualX.js";import"./responsiveObserve-D3ho5cFZ.js";import"./hasIn-BtXuxCTT.js";import"./collapseMotion-Brd6xpAT.js";import"./FormItemContext-Cv3f2sEj.js";import"./index-CuPJUS8f.js";import"./Search-BF8URtRh.js";import"./SearchOutlined-CFTHZIcT.js";import"./inputProps--_pnbyjO.js";import"./TextArea--DLJ7VtX.js";import"./index-BwedndIp.js";import"./Password-CJww1n-s.js";import"./slide-CVAZ5BEM.js";import"./List-qVz67bUg.js";import"./useMergedState-C0iIHNGF.js";import"./DownOutlined-CrhRpWT5.js";import"./CheckOutlined-C6m5maw6.js";import"./move-DztQgbGg.js";import"./colors-4myZb9T8.js";import"./index-C_M0mW4F.js";import"./CaretDownFilled-DQ5FyPd3.js";import"./index-BeCYXilq.js";import"./index-eahgXICC.js";import"./LeftOutlined-6ERu0fUO.js";import"./RightOutlined-zEOifMPB.js";import"./index-kP7DVVOS.js";import"./Checkbox-B_uQPvVs.js";import"./index-BZOjzqJ2.js";import"./dropdown-DAy60lp8.js";import"./Dropdown-hEIgqeS3.js";import"./index-Dxy-C30T.js";import"./shallowequal-C0xnIuy8.js";import"./index-Bb6fuwF7.js";import"./RadioButton-CWIeNl_M.js";import"./CaretDownOutlined-C8EH_hS-.js";const ue={class:"add-data-sheet"},pe={__name:"add-field-modal",emits:["ok"],setup(j,{expose:U,emit:q}){const k=C("添加字段"),O=M().query,v=C(!1),b=q,x=[{label:"string",value:"string"},{label:"integer",value:"integer"},{label:"number",value:"number"},{label:"boolean",value:"boolean"}],n=B({name:"",description:"",type:void 0,required:"false",form_id:O.form_id,id:""}),i=l=>{v.value=!0,m(),n.name=l.name||"",n.description=l.description||"",n.type=l.type,n.required=l.required,n.id=l.id||"",k.value=l.id?"编辑字段":"添加字段"},h=B({name:[{required:!0,validator:async(l,o)=>/^[a-z][a-z0-9_]*$/.test(o)?Promise.resolve():Promise.reject("必须以英文字母开头，只能包含小写字母、数字、下划线")}],description:[{required:!0,message:"请输入字段描述"}],type:[{required:!0,message:"请选择数据类型"}]}),u=I.useForm,{resetFields:m,validate:$,validateInfos:g}=u(n,h),R=()=>{$().then(()=>{H(n).then(l=>{let o=n.id?"修改成功":"新增成功";P.success(o),v.value=!1,b("ok")})})};return U({show:i}),(l,o)=>{const F=D,z=ne,w=oe,A=le,J=ie,Q=E,X=I,Z=L;return c(),f("div",ue,[t(Z,{open:v.value,"onUpdate:open":o[4]||(o[4]=s=>v.value=s),title:k.value,onOk:R,width:540},{default:e(()=>[t(X,{layout:"vertical"},{default:e(()=>[t(w,S(N(r(g).name)),{label:e(()=>[o[6]||(o[6]=a("字段名称  ")),t(F,null,{title:e(()=>o[5]||(o[5]=[a("定义数据表的表头，可以在对应表头下存储相关数据。")])),default:e(()=>[t(r(p))]),_:1})]),default:e(()=>[t(z,{maxLength:64,value:n.name,"onUpdate:value":o[0]||(o[0]=s=>n.name=s),placeholder:"请输入字段名称"},null,8,["value"])]),_:1},16),t(w,S(N(r(g).description)),{label:e(()=>[o[8]||(o[8]=a("字段描述  ")),t(F,null,{title:e(()=>o[7]||(o[7]=[a("表头字段的说明，帮助用户或大模型理解表头字段")])),default:e(()=>[t(r(p))]),_:1})]),default:e(()=>[t(z,{maxLength:64,value:n.description,"onUpdate:value":o[1]||(o[1]=s=>n.description=s),placeholder:"请输入字段描述"},null,8,["value"])]),_:1},16),t(w,S(N(r(g).type)),{label:e(()=>[o[10]||(o[10]=a("数据类型  ")),t(F,null,{title:e(()=>o[9]||(o[9]=[a("选择存储字段对应的数据类型")])),default:e(()=>[t(r(p))]),_:1})]),default:e(()=>[t(J,{value:n.type,"onUpdate:value":o[2]||(o[2]=s=>n.type=s),style:{width:"100%"},placeholder:"请选择数据类型"},{default:e(()=>[(c(),f(T,null,G(x,s=>t(A,{value:s.value,key:s.value},{default:e(()=>[a(_(s.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},16),t(w,null,{label:e(()=>[o[12]||(o[12]=a("是否必要  ")),t(F,null,{title:e(()=>o[11]||(o[11]=[d("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1),d("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)])),default:e(()=>[t(r(p))]),_:1})]),default:e(()=>[t(Q,{checked:n.required,"onUpdate:checked":o[3]||(o[3]=s=>n.required=s),"checked-children":"开","un-checked-children":"关",checkedValue:"true",unCheckedValue:"false"},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["open","title"])])}}},me=V(pe,[["__scopeId","data-v-85152a05"]]),_e={class:"field-manage-page"},fe={class:"page-title"},ce={class:"table-wrapper customize-scroll-style"},ve={key:0},ke={key:1},ye={key:0},ge={key:1},qe=["onClick"],be=["onClick"],xe={__name:"index",setup(j){const q=M().query,k=C([]),y=()=>{K({form_id:q.form_id}).then(n=>{k.value=n.data||[]})};y();const O=n=>{W({id:n.id,form_id:q.form_id,required:n.required=="true"?"false":"true"}).then(i=>{P.success("修改成功"),y()})},v=n=>{L.confirm({title:"删除确认",icon:t(te),content:`删除后，字段下所有数据将一并删除，删除后不可恢复。确认删除字段${n.name}吗?`,okText:"确 定",okType:"danger",cancelText:"取 消",onOk(){Y({id:n.id}).then(i=>{P.success("删除成功"),y()})},onCancel(){}})},b=C(null),x=(n={})=>{b.value.show(JSON.parse(JSON.stringify(n)))};return(n,i)=>{const h=ee,u=D,m=se,$=E,g=de,R=re;return c(),f(T,null,[d("div",_e,[d("div",fe,[i[2]||(i[2]=a(" 字段管理 ")),t(h,{type:"primary",onClick:i[0]||(i[0]=l=>x())},{icon:e(()=>[t(r(ae))]),default:e(()=>[i[1]||(i[1]=a(" 添加字段 "))]),_:1,__:[1]})]),d("div",ce,[t(R,{pagination:!1,"data-source":k.value},{default:e(()=>[t(m,{key:"name","data-index":"name",width:150},{title:e(()=>[i[4]||(i[4]=a(" 字段名称 ")),t(u,null,{title:e(()=>i[3]||(i[3]=[a("定义数据表的表头，可以在对应表头下存储相关数据。")])),default:e(()=>[t(r(p))]),_:1})]),default:e(({record:l})=>[l.name.length>50?(c(),f("span",ve,[t(u,null,{title:e(()=>[a(_(l.name),1)]),default:e(()=>[a(" "+_(l.name.slice(0,50)+"..."),1)]),_:2},1024)])):(c(),f("span",ke,_(l.name),1))]),_:1}),t(m,{key:"description","data-index":"description",width:150},{title:e(()=>[i[6]||(i[6]=a(" 字段描述 ")),t(u,null,{title:e(()=>i[5]||(i[5]=[a("表头字段的说明，帮助用户或大模型理解表头字段")])),default:e(()=>[t(r(p))]),_:1})]),default:e(({record:l})=>[l.description.length>50?(c(),f("span",ye,[t(u,null,{title:e(()=>[a(_(l.description),1)]),default:e(()=>[a(" "+_(l.description.slice(0,50)+"..."),1)]),_:2},1024)])):(c(),f("span",ge,_(l.description),1))]),_:1}),t(m,{key:"type","data-index":"type",width:120},{title:e(()=>[i[8]||(i[8]=a(" 数据类型 ")),t(u,null,{title:e(()=>i[7]||(i[7]=[a("选择存储字段对应的数据类型")])),default:e(()=>[t(r(p))]),_:1})]),_:1}),t(m,{key:"required","data-index":"required",width:120},{title:e(()=>[i[10]||(i[10]=a(" 是否必要 ")),t(u,null,{title:e(()=>i[9]||(i[9]=[d("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1),d("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)])),default:e(()=>[t(r(p))]),_:1})]),default:e(({record:l})=>[t($,{onChange:o=>O(l),checked:l.required=="true","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked"])]),_:1}),t(m,{key:"action",title:"操作",width:90},{default:e(({record:l})=>[d("span",null,[d("a",{onClick:o=>x(l)},"编辑",8,qe),t(g,{type:"vertical"}),d("a",{onClick:o=>v(l)},"删除",8,be)])]),_:1})]),_:1},8,["data-source"])])]),t(me,{onOk:y,ref_key:"addFieldModalRef",ref:b},null,512)],64)}}},wt=V(xe,[["__scopeId","data-v-7f6a3079"]]);export{wt as default};
