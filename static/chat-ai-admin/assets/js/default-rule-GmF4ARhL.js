import{b as Y,d as j}from"../../index-CPkdGIiL.js";import{M as H}from"./model-select-CiMSoZvM.js";import{a9 as W,a8 as Z,ai as ee}from"./index-Bu5ae_-0.js";import{I as te,X as le,ad as oe,Q as ne,q as se,B as de,M as re,ag as ie,ao as ae,R as _e,y as pe,a as c}from"./ui-antd-Bw8cEW5z.js";import{r as N,e as me,f as g,o as ue,w as ce,Y as _,a5 as o,k as s,ae as y,a2 as r,F as ye,a9 as fe,a7 as A,_ as a,G as p,a1 as ve}from"./vue-chunks-Ci-XTWEs.js";import"./utils-ChQO-_r6.js";import"./index-BxiNNyyE.js";const ge={class:"default-rule-page"},ke={class:"form-row"},we={class:"form-row"},he={class:"module-card"},Se={class:"module-card-header"},be={class:"module-card-title"},Ce={key:0,class:"module-card-body"},Ae={class:"field"},xe={key:0,class:"field"},ze={class:"tag-list"},Ie={key:1,class:"field"},Ue={key:2,class:"field"},Ne={key:3,class:"field"},Re={class:"module-card"},Oe={class:"module-card-header"},Ve={class:"module-card-title"},Le={key:0,class:"module-card-body"},Be={class:"field"},Me={class:"field"},Te={class:"field"},Je={class:"field-label"},Ke={class:"module-card"},De={class:"module-card-header"},$e={class:"module-card-title"},Fe={key:0,class:"module-card-body"},qe={class:"field"},Ee={class:"page-right-footer"},Ge={class:"task-modal"},Pe={key:0},R=`审核规则（请严格遵循）：

违法违规： 包含明显违法、煽动暴力、恐怖、极端主义，或传播非法信息的内容。

仇恨与攻击： 针对种族、民族、宗教、性别、性取向、残疾等个人或群体的侮辱、歧视、人身攻击或恶意嘲讽。

严重不雅与污秽： 包含极度污言秽语、色情露骨描述或令人极度不适的暴力细节。

垃圾广告与导流： 明显的、与讨论主题无关的商业广告、重复刷屏、推广联系方式或恶意引流链接。

严重误导与欺诈： 传播已被官方证伪的、可能造成公共危害的虚假信息（如健康谣言、金融骗局），或试图进行欺诈。

侵犯隐私： 公开他人的个人信息（电话、住址、身份证号等）。

恶意破坏： 纯粹无意义的字符、重复内容，或旨在干扰社区正常讨论的恶意刷屏。`,x=`特征（满足以下所有条件）：

意图明确：问题或需求清晰可识别

问题标准化：属于常见问题或标准业务流程

情绪稳定：用户情绪中立或积极（无明显愤怒/失望）

信息完整：提供了足够判断信息

解决方案已知：有预设的解决方案或知识库条目`,w=`解决问题导向： 针对问题提出具体的解决方案或下一步行动。

保持专业与友善： 语气礼貌、积极，即使面对负面评论也保持冷静和专业。

呼吁行动： 在适当时，引导客户进行下一步（如私信、联系客服、再次购买等）。

符合品牌人设： 语言风格应与品牌形象一致（如：亲切的、专业的、活泼的、高端的)`,h="感谢您的评论，您的建议是我们进步的基石，祝愿您开心每一天",O=`精选标准

好评： 包含具体、细节的使用体验、效果对比、场景描述，能为其他潜在客户提供真实参考。

中评建议： 客观、理性地指出产品或服务的具体问题，并提出了可行的改进建议。这类评论对品牌成长极具价值。`,Qe={__name:"default-rule",setup(Xe){const t=N({id:"",rule_name:"默认规则",use_model:"",model_config_id:"",delete_comment_switch:1,delete_type:[1,2],delete_keywords:[],delete_condition:2,delete_priority:1,delete_prompt:R,reply_comment_switch:1,reply_check_prompt:x,reply_type:1,reply_prompt:"",elect_comment_switch:1,elect_prompt:""}),V=me(()=>t.reply_type===1?"回复内容":"回复内容规则"),k=g(""),L=(n,e)=>{t.use_model=e.modelName,t.model_config_id=e.modelId},B=n=>{t.delete_keywords.splice(n,1)},M=()=>{const n=(k.value||"").trim();n&&(t.delete_keywords.includes(n)||t.delete_keywords.push(n),k.value="")},S=g(!1),z=g([]),b=g(!1),m=N({page:1,size:10,total:0}),I=g([]),T=[{title:"群发名称",dataIndex:"task_name",key:"task_name"}],J=n=>{I.value=n.map(e=>String(e))},K=()=>{b.value=!0,Z({page:m.page,size:m.size}).then(n=>{const e=(n==null?void 0:n.data)||{list:[],total:0};z.value=e.list||[],m.total=+e.total||0}).finally(()=>{b.value=!1})},D=n=>{m.page=n.current,m.size=n.pageSize,K()},$=()=>{W({page:1,size:1,is_default:1}).then(n=>{var u,i;const e=((i=(u=n==null?void 0:n.data)==null?void 0:u.list)==null?void 0:i[0])||(Array.isArray(n==null?void 0:n.data)?n.data[0]:n==null?void 0:n.data)||null;if(e){if(t.id=e.id||"",t.rule_name=e.rule_name||"默认规则",t.use_model=e.use_model||t.use_model,t.model_config_id=e.model_config_id||t.model_config_id,t.delete_comment_switch=+e.delete_comment_switch||0,t.reply_comment_switch=+e.reply_comment_switch||0,t.elect_comment_switch=+e.elect_comment_switch||0,e.delete_comment_rule){let d=e.delete_comment_rule;if(typeof d=="string")try{d=JSON.parse(d)}catch{}t.delete_type=Array.isArray(d.type)?d.type:[],t.delete_keywords=Array.isArray(d.keywords)?d.keywords:[],t.delete_condition=+d.condition||t.delete_condition,t.delete_priority=+d.priority||t.delete_priority,t.delete_prompt=d.prompt||R}if(e.reply_comment_rule){let d=e.reply_comment_rule;if(typeof d=="string")try{d=JSON.parse(d)}catch{}t.reply_check_prompt=d.check_reply_prompt||x,t.reply_type=+d.reply_type||t.reply_type,t.reply_prompt=d.reply_prompt,t.reply_prompt||(t.reply_type==1?t.reply_prompt=h:t.reply_prompt=w)}if(e.elect_comment_rule){let d=e.elect_comment_rule;if(typeof d=="string")try{d=JSON.parse(d)}catch{}t.elect_prompt=d.prompt||O}}})},F=()=>{if(!String(t.rule_name||"").trim())return c.error("请输入规则名称");if(!t.use_model)return c.error("请选择模型");if(t.delete_comment_switch==1){const e=Array.isArray(t.delete_type)?t.delete_type:[],u=e.includes(1),i=e.includes(2);if(e.length===0)return c.error("AI自动删评，请至少勾选一个选项");if(u&&(!t.delete_keywords||t.delete_keywords.length===0))return c.error("请输入敏感词");if(i&&!String(t.delete_prompt||"").trim())return c.error("请输入AI检测规则")}if(t.reply_comment_switch==1){if(!String(t.reply_check_prompt||x))return c.error("请输入自动回复规则");String(t.reply_prompt)||(t.reply_type==1?t.reply_prompt=h:t.reply_prompt=w)}if(t.elect_comment_switch==1&&!String(t.elect_prompt||O))return c.error("请输入自动精选规则");const n={id:t.id,is_default:1,rule_name:t.rule_name,use_model:t.use_model,model_config_id:t.model_config_id,delete_comment_switch:t.delete_comment_switch,delete_comment_rule:JSON.stringify((()=>{const e=Array.isArray(t.delete_type)?t.delete_type:[],u=e.includes(2),i={type:e,keywords:t.delete_keywords,prompt:t.delete_prompt};return u&&(i.condition=t.delete_condition,i.priority=t.delete_priority),i})()),reply_comment_switch:t.reply_comment_switch,reply_comment_rule:JSON.stringify({check_reply_prompt:t.reply_check_prompt,reply_type:t.reply_type,reply_prompt:t.reply_prompt}),elect_comment_switch:t.elect_comment_switch,elect_comment_rule:JSON.stringify({prompt:t.elect_prompt})};ee(n).then(()=>{c.success("保存成功")})};return ue(()=>{$()}),ce(()=>t.reply_type,n=>{const e=String(t.reply_prompt||"");n===1?(!e.trim()||e===w)&&(t.reply_prompt=h):(!e.trim()||e===h)&&(t.reply_prompt=w)}),(n,e)=>{const u=te,i=j,d=le,U=ie,q=oe,E=ae,v=ne,f=_e,C=se,G=de,P=pe,Q=re;return a(),_("div",ge,[o("div",ke,[e[17]||(e[17]=o("div",{class:"form-label"},"规则名称",-1)),s(u,{value:t.rule_name,"onUpdate:value":e[0]||(e[0]=l=>t.rule_name=l),placeholder:"请输入规则名称",style:{width:"300px"},disabled:""},null,8,["value"])]),o("div",we,[e[18]||(e[18]=o("div",{class:"form-label"},"模型",-1)),s(H,{modelType:"LLM",modeName:t.use_model,"onUpdate:modeName":e[1]||(e[1]=l=>t.use_model=l),modeId:t.model_config_id,"onUpdate:modeId":e[2]||(e[2]=l=>t.model_config_id=l),style:{width:"300px"},onChange:L},null,8,["modeName","modeId"])]),o("div",he,[o("div",Se,[o("div",be,[s(i,{name:"comment-delete",style:{"font-size":"16px","margin-right":"8px"}}),e[19]||(e[19]=o("span",null,"AI自动删评",-1))]),s(d,{checked:t.delete_comment_switch,"onUpdate:checked":e[3]||(e[3]=l=>t.delete_comment_switch=l),checkedValue:1,unCheckedValue:0},null,8,["checked"])]),t.delete_comment_switch==1?(a(),_("div",Ce,[o("div",Ae,[e[22]||(e[22]=o("div",{class:"field-label"},"规则",-1)),s(q,{value:t.delete_type,"onUpdate:value":e[4]||(e[4]=l=>t.delete_type=l)},{default:r(()=>[s(U,{value:1},{default:r(()=>e[20]||(e[20]=[p("触发敏感词")])),_:1,__:[20]}),s(U,{value:2},{default:r(()=>e[21]||(e[21]=[p("AI检测")])),_:1,__:[21]})]),_:1},8,["value"])]),(t.delete_type||[]).includes(1)?(a(),_("div",xe,[e[23]||(e[23]=o("div",{class:"field-label"},"敏感词",-1)),o("div",ze,[(a(!0),_(ye,null,fe(t.delete_keywords,(l,X)=>(a(),ve(E,{key:l,closable:"",onClose:Ye=>B(X)},{default:r(()=>[p(A(l),1)]),_:2},1032,["onClose"]))),128))]),s(v,{value:k.value,"onUpdate:value":e[5]||(e[5]=l=>k.value=l),placeholder:"请输入",onBlur:M,"auto-size":{minRows:2}},null,8,["value"])])):y("",!0),(t.delete_type||[]).includes(2)?(a(),_("div",Ie,[e[24]||(e[24]=o("div",{class:"field-label"},"AI检测规则",-1)),s(v,{value:t.delete_prompt,"onUpdate:value":e[6]||(e[6]=l=>t.delete_prompt=l),placeholder:"请输入","auto-size":{minRows:3}},null,8,["value"])])):y("",!0),(t.delete_type||[]).includes(2)?(a(),_("div",Ue,[e[27]||(e[27]=o("div",{class:"field-label"},"条件",-1)),s(C,{value:t.delete_condition,"onUpdate:value":e[7]||(e[7]=l=>t.delete_condition=l)},{default:r(()=>[s(f,{value:1},{default:r(()=>e[25]||(e[25]=[p("全部满足")])),_:1,__:[25]}),s(f,{value:2},{default:r(()=>e[26]||(e[26]=[p("满足其中一个条件")])),_:1,__:[26]})]),_:1},8,["value"])])):y("",!0),(t.delete_type||[]).includes(2)?(a(),_("div",Ne,[e[30]||(e[30]=o("div",{class:"field-label"},"优先级",-1)),s(C,{value:t.delete_priority,"onUpdate:value":e[8]||(e[8]=l=>t.delete_priority=l)},{default:r(()=>[s(f,{value:1},{default:r(()=>e[28]||(e[28]=[p("敏感词优先")])),_:1,__:[28]}),s(f,{value:2},{default:r(()=>e[29]||(e[29]=[p("AI检测优先")])),_:1,__:[29]})]),_:1},8,["value"])])):y("",!0)])):y("",!0)]),o("div",Re,[o("div",Oe,[o("div",Ve,[s(i,{name:"comment-reply",style:{"font-size":"16px","margin-right":"8px"}}),e[31]||(e[31]=o("span",null,"AI自动回复",-1))]),s(d,{checked:t.reply_comment_switch,"onUpdate:checked":e[9]||(e[9]=l=>t.reply_comment_switch=l),checkedValue:1,unCheckedValue:0},null,8,["checked"])]),t.reply_comment_switch==1?(a(),_("div",Le,[o("div",Be,[e[32]||(e[32]=o("div",{class:"field-label"},"自动回复规则",-1)),s(v,{value:t.reply_check_prompt,"onUpdate:value":e[10]||(e[10]=l=>t.reply_check_prompt=l),placeholder:"请输入","auto-size":{minRows:3}},null,8,["value"])]),o("div",Me,[e[35]||(e[35]=o("div",{class:"field-label"},"回复内容",-1)),s(C,{value:t.reply_type,"onUpdate:value":e[11]||(e[11]=l=>t.reply_type=l)},{default:r(()=>[s(f,{value:1},{default:r(()=>e[33]||(e[33]=[p("固定回复内容")])),_:1,__:[33]}),s(f,{value:2},{default:r(()=>e[34]||(e[34]=[p("AI生成回复内容")])),_:1,__:[34]})]),_:1},8,["value"])]),o("div",Te,[o("div",Je,A(V.value),1),s(v,{value:t.reply_prompt,"onUpdate:value":e[12]||(e[12]=l=>t.reply_prompt=l),placeholder:"请输入","auto-size":{minRows:3}},null,8,["value"])])])):y("",!0)]),o("div",Ke,[o("div",De,[o("div",$e,[s(i,{name:"comment-selected",style:{"font-size":"16px","margin-right":"8px"}}),e[36]||(e[36]=o("span",null,"AI自动精选",-1))]),s(d,{checked:t.elect_comment_switch,"onUpdate:checked":e[13]||(e[13]=l=>t.elect_comment_switch=l),checkedValue:1,unCheckedValue:0},null,8,["checked"])]),t.elect_comment_switch==1?(a(),_("div",Fe,[o("div",qe,[e[37]||(e[37]=o("div",{class:"field-label"},"自动精选规则",-1)),s(v,{value:t.elect_prompt,"onUpdate:value":e[14]||(e[14]=l=>t.elect_prompt=l),placeholder:"请输入","auto-size":{minRows:3}},null,8,["value"])])])):y("",!0)]),o("div",Ee,[s(G,{type:"primary",onClick:F},{default:r(()=>e[38]||(e[38]=[p("保存并应用")])),_:1,__:[38]})]),s(Q,{open:S.value,"onUpdate:open":e[15]||(e[15]=l=>S.value=l),title:"选择群发任务",width:720,onOk:n.confirmSelectTasks,onCancel:e[16]||(e[16]=l=>S.value=!1)},{default:r(()=>[o("div",Ge,[s(P,{columns:T,"data-source":z.value,"row-key":l=>String(l.id),loading:b.value,pagination:{current:m.page,pageSize:m.size,total:m.total,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:D,"row-selection":{selectedRowKeys:I.value,onChange:J,preserveSelectedRowKeys:!0}},{headerCell:r(({column:l})=>[typeof l.title=="string"?(a(),_("span",Pe,A(l.title),1)):y("",!0)]),_:1},8,["data-source","row-key","loading","pagination","row-selection"])])]),_:1},8,["open","onOk"])])}}},ot=Y(Qe,[["__scopeId","data-v-91423ef6"]]);export{ot as default};
