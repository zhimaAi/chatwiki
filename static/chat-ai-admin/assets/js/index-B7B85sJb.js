import{b as m,a3 as A,d as D,w as Q,N as l,X as a,F as R,a1 as U,a2 as G,O as o,a6 as x,u as y,a5 as B,j as t,_ as S,U as i,Z as N,S as T,a7 as W,q as ee,D as te,a8 as oe,a0 as ae,z as j,W as E,G as se,V as ne,Y as V}from"./vue-chunks-BRsu9_To.js";import{b as P,e as H,j as K,d as X,h as F,f as re,R as le,M as ie,r as ce,k as ue}from"../../index-Bo1NSLpy.js";import{L as _e}from"./layout-logo-dGf8Zw5d.js";import{g as pe}from"./index-L62dqcZj.js";import{D as de}from"./DownOutlined-CrhRpWT5.js";import{M as Y,_ as Z}from"./index-Dxy-C30T.js";import{C as q}from"./CheckOutlined-C6m5maw6.js";import"./index-BZOjzqJ2.js";import{D as J}from"./dropdown-DAy60lp8.js";import{B as me,_ as ve}from"./index-_hVn8A6r.js";import{v as be}from"./validate-8MtiUsxW.js";import{F as z,_ as he}from"./index-COWZrpvC.js";import{_ as ye}from"./index-Dc6vrBX7.js";import{_ as fe}from"./Password-CJww1n-s.js";import"./index-Caod9rOO.js";import{u as ke}from"./global-B1shEXNi.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-DtRTHvld.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-CVAZ5BEM.js";import"./index-BwedndIp.js";import"./index-B4MPC5xv.js";import"./colors-4myZb9T8.js";import"./Dropdown-hEIgqeS3.js";import"./RightOutlined-zEOifMPB.js";import"./move-DztQgbGg.js";import"./isPlainObject-CHj0iPA3.js";import"./Col-QoogualX.js";import"./responsiveObserve-D3ho5cFZ.js";import"./hasIn-BtXuxCTT.js";import"./QuestionCircleOutlined-VG1FNUnl.js";import"./FormItemContext-Cv3f2sEj.js";import"./Input-CCKFAS4o.js";import"./index-CuPJUS8f.js";import"./inputProps--_pnbyjO.js";import"./Search-BF8URtRh.js";import"./SearchOutlined-CFTHZIcT.js";import"./TextArea--DLJ7VtX.js";const ge={class:"navbar-wrapper"},we={class:"navbar"},Ce=["onClick"],$e={class:"nav-name"},Se={class:"down-icon"},Me=["onClick"],Le={class:"nav-name"},xe={__name:"layout-navbar",setup(I){const p=H(),r=G(),u=A(),d=m(()=>u.meta.activeMenu||""),v=m(()=>u.path.split("/")[1]),c=D(localStorage.getItem("local__robot_menu_key")||"robot_detail"),b=[{id:1,key:"robot",label:"robot",title:"机器人",icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:"知识库",icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:"文档",icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:"搜索",icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:"会话",icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}],C=m(()=>p.top_navigate),M=m(()=>C.value.filter(n=>n.open).map(n=>b.find(_=>_.key===n.id)).filter(Boolean)),g=e=>{r.push(e.path)},$=(e,n)=>{localStorage.setItem("local__robot_menu_key",e),c.value=e,h(n)},h=e=>{c.value=="robot_detail"?f():g(e)},f=async()=>{try{const{data:e=[]}=await pe();if(e.length===0){r.push("/robot/list");return}const n=localStorage.getItem("last_local_robot_id");let _;n&&(_=e.find(s=>s.id==n)),_=_||e[0];const{id:w,robot_key:L,application_type:k}=_;r.push({path:`/robot/config/${k==1?"workflow":"basic-config"}`,query:{id:w,robot_key:L}})}catch{r.push("/robot/list")}};return Q(()=>u.path,()=>{},{immediate:!0}),(e,n)=>{const _=X,w=Z,L=Y,k=J;return o(),l("div",ge,[a("div",we,[(o(!0),l(R,null,U(M.value,s=>(o(),l(R,null,[y(K)(s.permission)?(o(),l(R,{key:0},[s.key==="robot"?(o(),l("div",{key:0,class:B(["nav-menu",{active:s.key===v.value||s.key===d.value}]),onClick:O=>h(s)},[t(_,{class:"nav-icon",name:s.icon},null,8,["name"]),a("span",$e,S(s.title),1),t(k,null,{overlay:i(()=>[t(L,null,{default:i(()=>[t(w,{key:"1",onClick:O=>$("robot_detail",s)},{default:i(()=>[a("div",{class:B(["robot-ment-item",{"robot-active-item":c.value=="robot_detail"}])},[t(y(q),{class:"anticon-check"}),n[0]||(n[0]=N(" 进入机器人详情 "))],2)]),_:2},1032,["onClick"]),t(w,{key:"2",onClick:O=>$("robot_list",s)},{default:i(()=>[a("div",{class:B(["robot-ment-item",{"robot-active-item":c.value=="robot_list"}])},[t(y(q)),n[1]||(n[1]=N(" 进入机器人管理 "))],2)]),_:2},1032,["onClick"])]),_:2},1024)]),default:i(()=>[a("div",Se,[t(y(de))])]),_:2},1024)],10,Ce)):(o(),l("div",{key:1,class:B(["nav-menu",{active:s.key===v.value||s.key===d.value}]),onClick:O=>g(s)},[t(_,{class:"nav-icon",name:s.icon},null,8,["name"]),a("span",Le,S(s.title),1)],10,Me))],64)):x("",!0)],64))),256))])])}}},Re=P(xe,[["__scopeId","data-v-2c245402"]]),Ie={class:"layout-breadcrumb"},Pe={key:1,class:"page-title"},Te={__name:"layout-breadcrumb",props:{title:{type:[String,Boolean],default:""},items:{type:[Array,Boolean],default:()=>[]}},setup(I){const p=I;return(r,u)=>{const d=W("router-link"),v=ve,c=me;return o(),l("div",Ie,[p.items.length>0?(o(),T(c,{key:0},{default:i(()=>[(o(!0),l(R,null,U(p.items,(b,C)=>(o(),l(R,{key:b.title},[C!==p.items.length-1?(o(),T(v,{key:0},{default:i(()=>[t(d,{to:b.path},{default:i(()=>[N(S(b.title),1)]),_:2},1032,["to"])]),_:2},1024)):(o(),T(v,{key:1},{default:i(()=>[N(S(b.title),1)]),_:2},1024))],64))),128))]),_:1})):(o(),l("div",Pe,S(p.title),1))])}}},Be=P(Te,[["__scopeId","data-v-c69a461d"]]),De={class:"layout-footer"},Ne={class:"copyright-text"},Fe={__name:"layout-footer",setup(I){const p=F(),{t:r}=re(),u=D(null);return ee(()=>{u.value=setInterval(()=>{setTimeout(()=>{p.refreshToken()},0)},le)}),te(()=>{clearInterval(u.value),u.value=null}),(d,v)=>(o(),l("div",De,[a("div",Ne,S(y(r)("common.copyright")),1)]))}},Oe=P(Fe,[["__scopeId","data-v-ab337acb"]]),Ue={key:0,class:"user-dropdown"},je=["src"],Ee={class:"user-name"},Ve=["onClick"],qe={class:"menu-name"},ze={__name:"user-dropdown",setup(I){const p=H(),r=G(),u=F(),{userInfo:d,avatar:v,user_name:c}=oe(u),b=()=>{u.logoutConfirm(!0)},C=()=>{window.open("/#/user/model","_blank","noopener")},M=[{id:1,key:"robot",label:"robot",title:"应用",icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:"知识库",icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:"文档",icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:"搜索",icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:"会话",icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}],g=m(()=>p.top_navigate),$=m(()=>g.value.filter(e=>!e.open).map(e=>M.find(n=>n.key===e.id)).filter(Boolean)),h=f=>{r.push(f.path)};return(f,e)=>{const n=X,_=Z,w=Y,L=J;return y(d)?(o(),l("div",Ue,[t(L,null,{overlay:i(()=>[t(w,null,{default:i(()=>[t(_,null,{default:i(()=>[a("a",{class:"menu-item",href:"javascript:;",onClick:C},[t(n,{class:"menu-icon",name:"system-setting"}),e[1]||(e[1]=a("span",{class:"menu-name"},"系统管理",-1))])]),_:1}),(o(!0),l(R,null,U($.value,k=>(o(),l(R,null,[y(K)(k.permission)?(o(),T(_,{key:0},{default:i(()=>[a("a",{class:"menu-item",href:"javascript:;",onClick:s=>h(k)},[t(n,{class:"menu-icon",name:k.icon},null,8,["name"]),a("span",qe,S(k.title),1)],8,Ve)]),_:2},1024)):x("",!0)],64))),256)),t(_,null,{default:i(()=>[a("a",{class:"menu-item",href:"javascript:;",onClick:b},[t(n,{class:"menu-icon",name:"logout"}),e[2]||(e[2]=a("span",{class:"menu-name"},"退出登录",-1))])]),_:1})]),_:1})]),default:i(()=>[a("div",{class:"user-dropdown-link",onClick:e[0]||(e[0]=ae(()=>{},["prevent"]))},[a("img",{class:"user-avatar",src:y(v),alt:""},null,8,je),a("span",Ee,S(y(c)),1),t(n,{name:"arrow-down",style:{"font-size":"16px",color:"#8c8c8c"}})])]),_:1})])):x("",!0)}}},Ae=P(ze,[["__scopeId","data-v-73a10ef4"]]),Ge={class:"form-box"},We={__name:"reset-password",setup(I,{expose:p}){const r=F(),u=z.useForm,d=D(!0),v=D("重置登录密码"),c=j({password:"",check_password:"",id:r.userInfo.user_id}),b=j({password:[{message:"请输入登录密码",required:!0},{validator:async(f,e)=>!be(e)&&e?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(f,e)=>e!=c.password&&e?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:C,validate:M,validateInfos:g}=u(c,b),$=()=>{M().then(()=>{ce({...se(c)}).then(f=>{ue.success("修改成功"),d.value=!1,r.reset(!0)})})},h=()=>{r.setResetPassModal()};return p({open}),(f,e)=>{const n=ye,_=fe,w=he,L=z,k=ie;return o(),l("div",null,[t(k,{open:d.value,"onUpdate:open":e[2]||(e[2]=s=>d.value=s),title:v.value,onOk:$,width:"520px",onCancel:h},{default:i(()=>[t(n,{class:"alert-box",message:"您还未修改初始密码，为了保障您的数据安全，请您尽快重置密码。",type:"info","show-icon":""}),a("div",Ge,[t(L,{layout:"vertical"},{default:i(()=>[t(w,E({label:"登录密码"},y(g).password),{default:i(()=>[t(_,{value:c.password,"onUpdate:value":e[0]||(e[0]=s=>c.password=s),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),t(w,E({label:"确认密码"},y(g).check_password),{default:i(()=>[t(_,{value:c.check_password,"onUpdate:value":e[1]||(e[1]=s=>c.check_password=s),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},He=P(We,[["__scopeId","data-v-9de4c189"]]),Ke={class:"admin-layout"},Xe={key:0,class:"layout-header-wrapper"},Ye={class:"layout-header"},Ze={class:"header-left"},Je={class:"header-body"},Qe={class:"header-right"},et={class:"item-box"},tt={class:"layout-body"},ot={key:0,class:"layout-breadcrumb-wrapper"},at={key:1,class:"layout-footer-wrapper"},st={__name:"index",setup(I){const p=ke(),r=A(),u=F(),d=m(()=>r.name!="robotWorkflow"?!1:p.hideLayoutTopAndBottom||!1),v=m(()=>r.meta.isCustomPage||!1),c=m(()=>r.meta.pageStyle||{}),b=m(()=>r.meta.bgColor||"#ffffff"),C=m(()=>r.meta.breadcrumb||[]),M=m(()=>r.meta.hideTitle||!1),g=m(()=>r.meta.title||!1),$=m(()=>{var h;return((h=u.userInfo)==null?void 0:h.d_pass)==1&&u.isShowResetPassModal});return(h,f)=>{const e=W("router-view");return o(),l("div",Ke,[d.value?x("",!0):(o(),l("div",Xe,[a("div",Ye,[a("div",Ze,[t(_e)]),a("div",Je,[t(Re)]),a("div",Qe,[a("div",et,[t(Ae)])])])])),a("div",tt,[v.value?ne(h.$slots,"default",{key:0},()=>[t(e)],!0):(o(),l("div",{key:1,class:"page-wrapper",style:V({"background-color":b.value})},[M.value?x("",!0):(o(),l("div",ot,[t(Be,{items:C.value,title:g.value},null,8,["items","title"])])),a("div",{class:"page-container",style:V({...c.value})},[t(e)],4)],4))]),d.value?x("",!0):(o(),l("div",at,[t(Oe)])),$.value?(o(),T(He,{key:2})):x("",!0)])}}},Kt=P(st,[["__scopeId","data-v-85411cc0"]]);export{Kt as default};
