{"version":3,"file":"detail-Cfe318al.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/explore/templates/detail.vue"],"sourcesContent":["<template>\r\n  <div class=\"_container _plugin-detail-cont\">\r\n    <div class=\"header\">\r\n<!--      <LeftOutlined @click=\"router.back()\" class=\"back-icon\"/>-->\r\n      <span class=\"title\">{{ t('title_template_detail') }}</span>\r\n    </div>\r\n    <LoadingBox v-if=\"loading\"/>\r\n    <div v-else class=\"content\">\r\n      <div class=\"base-info\">\r\n        <div class=\"top\">\r\n          <img class=\"avatar\" :src=\"tplInfo.avatar\"/>\r\n          <div class=\"info\">\r\n            <div class=\"left\">\r\n              <div class=\"name zm-line1\">{{ tplInfo.name }}</div>\r\n              <div class=\"source\">\r\n                <img class=\"avatar\" :src=\"tplInfo.account_avatar\"/>\r\n                {{ tplInfo.author }}\r\n              </div>\r\n            </div>\r\n            <div class=\"right\">\r\n              <a-button class=\"use-btn\" type=\"primary\" ghost @click=\"useTemplate\">\r\n                <svg-icon name=\"icon-rocket\"/>\r\n                {{ t('btn_use_template') }}\r\n              </a-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"desc\">{{ tplInfo.description }}</div>\r\n        <div class=\"action-box\">\r\n          <div class=\"left\">\r\n            <TeamOutlined/>\r\n            {{ tplInfo.use_count || 0 }}\r\n          </div>\r\n          <div class=\"right\"></div>\r\n        </div>\r\n      </div>\r\n      <div class=\"detail-info\">\r\n        <div class=\"left\">\r\n<!--          <div v-if=\"info.overview\" class=\"main-block\">-->\r\n<!--            <div class=\"main-tit\">插件概叙</div>-->\r\n<!--            <pre class=\"text-cont\">{{ info.overview }}</pre>-->\r\n<!--          </div>-->\r\n          <div class=\"main-block\">\r\n            <div class=\"main-tit\">{{ t('title_usage_instructions') }}</div>\r\n            <pre class=\"text-cont\" v-viewer v-html=\"tplInfo.instructions\"></pre>\r\n          </div>\r\n        </div>\r\n        <div class=\"right\">\r\n          <div class=\"main-block\">\r\n            <div class=\"main-tit\">{{ t('title_template_category') }}</div>\r\n            <div class=\"text-cont flex-center\">\r\n              {{ tplInfo.category_name }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {onMounted, ref, reactive, h, computed} from 'vue';\r\nimport {useRouter, useRoute} from 'vue-router';\r\nimport dayjs from 'dayjs';\r\nimport {message, Modal} from 'ant-design-vue';\r\nimport {LeftOutlined, ExclamationCircleOutlined, TeamOutlined} from '@ant-design/icons-vue';\r\nimport LoadingBox from \"@/components/common/loading-box.vue\";\r\nimport {getPluginInfo} from \"@/api/plugins/index.js\";\r\nimport {getTplDetailMain, useRobotTemplate} from \"@/api/explore/template.js\";\r\nimport {useCompanyStore} from \"@/stores/modules/company.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.explore.templates.detail')\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst companyStore = useCompanyStore()\r\nconst {companyInfo} = companyStore\r\nconst sysVersion = computed(() => {\r\n  return companyInfo?.version\r\n})\r\n\r\nconst loading = ref(true)\r\nconst tplKey = ref(null)\r\nconst tplInfo = ref({})\r\n\r\nonMounted(() => {\r\n  tplKey.value = route.query?.key\r\n  loadInfo()\r\n})\r\n\r\nfunction loadInfo() {\r\n  loading.value = true\r\n  getTplDetailMain({robot_id: tplKey.value}).then(res => {\r\n    tplInfo.value = res?.data || {}\r\n  }).finally(() => {\r\n    loading.value = false\r\n  })\r\n}\r\n\r\nfunction useTemplate() {\r\n  const item = tplInfo.value\r\n  function checkVersion(sys_v, tpl_v) {\r\n    sys_v = Number(sys_v.replace(/\\D/g, ''))\r\n    tpl_v = Number(tpl_v.replace(/\\D/g, ''))\r\n    return sys_v >= tpl_v\r\n  }\r\n  const run = () => {\r\n    useRobotTemplate({template_id: item.id, csl_url: item.csl_url}).then(res => {\r\n      message.success(t('msg_use_success'))\r\n      const {id, robot_key} = res.data\r\n      const url = router.resolve({path: '/robot/config/workflow', query: {id, robot_key}})\r\n      window.open(url.href, '_blank')\r\n    })\r\n  }\r\n  if (!checkVersion(sysVersion.value, item.version)) {\r\n    Modal.confirm({\r\n      title: t('title_tip'),\r\n      content: t('msg_version_too_low'),\r\n      icon: h(ExclamationCircleOutlined),\r\n      okText: t('btn_continue_use'),\r\n      cancelText: t('btn_cancel'),\r\n      onOk: run\r\n    })\r\n  } else {\r\n    Modal.confirm({\r\n      title: t('title_tip'),\r\n      content: t('msg_confirm_use_template', { name: item.name }),\r\n      icon: h(ExclamationCircleOutlined),\r\n      okText: t('btn_confirm'),\r\n      cancelText: t('btn_cancel'),\r\n      onOk: run\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n._plugin-detail-cont .text-cont {\r\n  img {\r\n    max-width: 640px;\r\n    cursor: pointer;\r\n  }\r\n}\r\n</style>\r\n<style scoped lang=\"less\">\r\n._container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  overflow: hidden;\r\n\r\n  > div {\r\n    width: 952px;\r\n  }\r\n\r\n  .header {\r\n    padding: 16px 0;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    color: #000000;\r\n    font-size: 20px;\r\n    font-weight: 600;\r\n\r\n    .back-icon {\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  .base-info {\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 24px;\r\n    gap: 12px;\r\n    border-radius: 12px;\r\n    border: 1px solid #E4E6EB;\r\n\r\n    .top {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 12px;\r\n\r\n      .avatar {\r\n        width: 62px;\r\n        height: 62px;\r\n        border-radius: 16px;\r\n        border: 1px solid #F0F0F0;\r\n      }\r\n\r\n      .info {\r\n        flex: 1;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n      }\r\n\r\n      .name {\r\n        color: #262626;\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n      }\r\n\r\n      .source {\r\n        color: #8C8C8C;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 4px;\r\n        .avatar {\r\n          width: 16px;\r\n          height: 16px;\r\n          border-radius: 16px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .right {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n    }\r\n\r\n    .desc {\r\n      color: #595959;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      word-break: break-all;\r\n    }\r\n\r\n    .action-box {\r\n      width: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      color: #595959;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n    }\r\n  }\r\n\r\n  .detail-info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    margin-top: 24px;\r\n\r\n    .left {\r\n      padding-right: 32px;\r\n      border-right: 1px solid #F0F0F0;\r\n      flex-shrink: 0;\r\n      width: calc(100% - 280px);\r\n    }\r\n\r\n    .right {\r\n      padding-left: 24px;\r\n      width: 280px;\r\n      flex-shrink: 0;\r\n    }\r\n\r\n    .main-block {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n      margin-bottom: 32px;\r\n\r\n      .main-tit {\r\n        color: #000000;\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n        margin-bottom: 8px;\r\n      }\r\n\r\n      .text-cont {\r\n        color: #595959;\r\n        font-size: 14px;\r\n        font-weight: 400;\r\n        line-height: 22px;\r\n        white-space: pre-wrap;\r\n        word-wrap: break-word;\r\n        overflow: hidden;\r\n\r\n        img {\r\n          max-width: 620px !important;\r\n          cursor: pointer;\r\n        }\r\n      }\r\n\r\n      .version-info {\r\n        color: #262626;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.cate-icon {\r\n  width: 14px;\r\n  height: 14px;\r\n  margin-right: 4px;\r\n}\r\n\r\n.flex-center {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.use-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n}\r\n</style>\r\n"],"names":["t","useI18n","router","useRouter","route","useRoute","companyStore","useCompanyStore","companyInfo","sysVersion","computed","loading","ref","tplKey","tplInfo","onMounted","_a","loadInfo","getTplDetailMain","res","useTemplate","item","checkVersion","sys_v","tpl_v","run","useRobotTemplate","message","id","robot_key","url","Modal","h","ExclamationCircleOutlined","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","_unref","_createBlock","LoadingBox","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_13","_createVNode","_component_a_button","_component_svg_icon","_createTextVNode","_hoisted_14","_hoisted_15","_hoisted_16","TeamOutlined","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25"],"mappings":"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"}