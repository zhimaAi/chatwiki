import{_ as Z,c as ct,a5 as le,a6 as Oe,a7 as Ie,a8 as ie,a9 as Ve,f as _t,aa as Fe,o as pt,p as vt,ab as ft,ac as mt,ad as kt,d as ht,ae as bt}from"../../index-WMhSApoa.js";import{_ as gt}from"./cu-scroll-D6f5DzhK.js";import{f as c,ae as q,ad as l,ar as o,as as e,k as t,G as O,u as L,r as Le,ac as _,F as V,ax as Y,at as T,az as Q,ai as ue,o as me,l as _e,B as z,av as We,aw as je,n as ze,A as qe,e as Ne}from"./vue-chunks-CGLjTDrY.js";import{d as yt}from"./vuedraggable.umd--yFJy9Bz.js";import{i as $t,j as He,k as xt,g as Je,l as Ct,m as wt,n as Mt,o as Tt,p as Rt}from"./index-CtAh6k0_.js";import{A as Ke,a as St,b as Pt}from"./add-group-CORu2AJo.js";import{o as Ue,aw as Ot,ax as It,M as W,b as I,u as Lt,y as Ut,z as At,F as Qe,e as Ye,I as ke,$ as Ze,V as Xe,a9 as et,al as he,ai as Dt,Q as Et,a6 as fe,B as ve,ar as pe,h as be,i as ge,k as ye,J as Gt,a2 as Bt,as as tt,ae as Ft,ay as zt,az as qt,aA as Nt,O as Vt,at as Wt,v as jt,an as Ht,a0 as Jt,aB as Kt,R as Qt,W as Re}from"./ui-antd-BDReVt-O.js";import{_ as Yt}from"./page-alert-Dnjj-jJ2.js";import{L as Zt}from"./list-tabs-CdNhBT49.js";import{_ as Se}from"./empty-BFmzY9bl.js";import{_ as Xt}from"./no-permission-DtJ3NYHG.js";import{_ as eo}from"./tool-icon-IWVrYlVb.js";import{a as Pe,g as to,s as oo,b as so,d as no}from"./thirdMcp-wFPc-oZ5.js";import"./neo4j-CK9lNpyi.js";import"./utils-DXEytJvC.js";import"./other-BrZCAsTs.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./vue-pdf-embed-CmVBwGXE.js";import"./index-BafABkdm.js";import"./robot-j5RxAo6l.js";const lo={class:"form-box"},ao={class:"tip-box"},io={class:"ant-upload-drag-icon"},uo={__name:"import-csl-alert",emits:["ok"],setup(U,{expose:G,emit:A}){const M=A,v=c(!1),a=c(!1),b=c([]),r=()=>{v.value=!0},f=()=>{v.value=!1,b.value=[]},R=()=>{if(b.value.length===0){I.error("请上传csl文件");return}a.value=!0,$t({file:b.value[0].originFileObj}).then(x=>{a.value=!1,v.value=!1,I.success("导入成功"),b.value=[],M("ok",x.data)}).catch(()=>{a.value=!1})},h=x=>x.name.endsWith(".csl")?!1:(I.error("只能上传csl格式的文件"),Lt.LIST_IGNORE),s=x=>{const{status:u}=x.file;u!=="uploading"&&(x.file,x.fileList)};return G({open:r}),(x,u)=>{const m=Ue,n=It,$=W;return l(),q($,{width:"600px",open:v.value,"onUpdate:open":u[1]||(u[1]=C=>v.value=C),confirmLoading:a.value,title:"导入csl文件创建机器人",onOk:R,onCancel:f},{default:o(()=>[e("div",lo,[e("div",ao,[t(m,{type:"info"},{description:o(()=>[...u[2]||(u[2]=[O(" 您可以将您编排好的机器人导出为csl文件,共享给他人使用。也可以从他人处获取导出的csl文件,通过导入形式创建机器人。 ",-1)])]),_:1})]),t(n,{fileList:b.value,"onUpdate:fileList":u[0]||(u[0]=C=>b.value=C),name:"file",multiple:!1,maxCount:1,accept:".csl","before-upload":h,onChange:s},{default:o(()=>[e("p",io,[t(L(Ot),{class:"upload-icon"})]),u[3]||(u[3]=e("p",{class:"upload-text"},"点击或将文件拖拽到这里上传",-1)),u[4]||(u[4]=e("p",{class:"upload-hint"},"仅支持从chatwiki导出生成的csl文件",-1))]),_:1},8,["fileList"])])]),_:1},8,["open","confirmLoading"])}}},ro=Z(uo,[["__scopeId","data-v-ae06ccf0"]]),co={class:"form-item"},_o={class:"form-content"},po={__name:"edit-group",emits:["ok"],setup(U,{expose:G,emit:A}){const M=c(!1),v=A,a=c("修改分组"),b=Le({group_id:"",robot_id:""}),r=c([]),f=s=>{b.group_id=s.group_id||"0",b.robot_id=s.id||"",h(),M.value=!0},R=()=>{if(!b.group_id)return I.error("请选择分组");xt({...b}).then(s=>{I.success(`${a.value}成功`),M.value=!1,v("ok")})},h=()=>{He().then(s=>{r.value=s.data||[]})};return G({show:f}),(s,x)=>{const u=At,m=Ut,n=W;return l(),_("div",null,[t(n,{open:M.value,"onUpdate:open":x[1]||(x[1]=$=>M.value=$),title:a.value,onOk:R},{default:o(()=>[e("div",co,[x[2]||(x[2]=e("div",{class:"form-label"},"分组名称：",-1)),e("div",_o,[t(m,{value:b.group_id,"onUpdate:value":x[0]||(x[0]=$=>b.group_id=$),style:{width:"100%"},placeholder:"请选择分组"},{default:o(()=>[(l(!0),_(V,null,Y(r.value,$=>(l(),q(u,{value:$.id},{default:o(()=>[O(T($.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])]),_:1},8,["open","title"])])}}},vo=Z(po,[["__scopeId","data-v-5680d53a"]]),fo=()=>{const U=ct();return{openUrlWithToken:A=>{const M=U.getToken;if(!M){console.warn("Token is missing");return}if(!A){console.warn("URL is missing");return}const v=A.includes("?")?"&":"?",a=`${A}${v}token=${M}`;window.open(a,"_blank")}}};function mo(U={}){return le.get({url:"/manage/getMcpServerList",params:U})}function ko(U={}){return le.post({headers:{"Content-Type":"multipart/form-data"},url:"/manage/saveMcpServer",data:U})}function ho(U={}){return le.post({url:"/manage/deleteMcpServer",data:U})}function bo(U={}){return le.post({url:"/manage/updateMcpServerPublishStatus",data:U})}function go(U={}){return le.post({url:"/manage/saveMcpTool",data:U})}function yo(U={}){return le.post({url:"/manage/editMcpTool",data:U})}function $o(U={}){return le.post({url:"/manage/deleteMcpTool",data:U})}const xo={class:"avatar-box"},Co={__name:"mcp-store",emits:["ok"],setup(U,{expose:G,emit:A}){const M=A,v=c(!1),a=c(!1),b=c(null),r={avatar:Oe,name:"",description:"",server_id:""},f=Le({});function R(x=null){Object.assign(f,x||r),b.value=null,v.value=!0}function h(x){b.value=x}function s(){var x;try{if(a.value=!0,f.name=f.name.trim(),f.description=f.description.trim(),!f.name)throw"请输入MCP插件名称";if(!f.description)throw"请输入MCP插件描述";let u={...f};b.value&&(u.avatar=(x=b.value)==null?void 0:x.file),ko(u).then(m=>{M("ok",f),I.success("已保存"),v.value=!1}).finally(()=>{a.value=!1})}catch(u){a.value=!1,I.error(u)}}return G({show:R}),(x,u)=>{const m=ke,n=Ye,$=Ze,C=Qe,S=W;return l(),q(S,{open:v.value,"onUpdate:open":u[3]||(u[3]=g=>v.value=g),title:f.server_id?"编辑MCP":"添加MCP",width:"472px","confirm-loading":a.value,onOk:s},{default:o(()=>[e("div",xo,[t(Ke,{value:f.avatar,"onUpdate:value":u[0]||(u[0]=g=>f.avatar=g),onChange:h},null,8,["value"]),u[4]||(u[4]=e("div",{class:"tip-info"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1))]),t(C,{class:"form-box",labelAlign:"left"},{default:o(()=>[t(n,{label:"MCP插件名称",required:"",colon:!1},{default:o(()=>[t(m,{value:f.name,"onUpdate:value":u[1]||(u[1]=g=>f.name=g),placeholder:"请输入MCP插件名称，最多20个字",maxlength:20},null,8,["value"])]),_:1}),t(n,{label:"描述",colon:!1},{default:o(()=>[t($,{value:f.description,"onUpdate:value":u[2]||(u[2]=g=>f.description=g),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入描述",maxlength:20},null,8,["value"])]),_:1}),f.server_id?Q("",!0):(l(),_(V,{key:0},[u[5]||(u[5]=e("div",{class:"tit-box"},[O("配置信息 "),e("span",{class:"desc"},"以下配置创建完成后自动生成")],-1)),t(n,{label:"插件URL",colon:!1},{default:o(()=>[t(m,{disabled:"",placeholder:"创建完成后默认生成"})]),_:1}),t(n,{label:"授权方式",colon:!1},{default:o(()=>[t(m,{disabled:"",placeholder:"Service token / API key"})]),_:1}),t(n,{label:"请求头",colon:!1},{default:o(()=>[t(m,{disabled:"",placeholder:"Authorization"})]),_:1}),t(n,{label:"API KEY",colon:!1},{default:o(()=>[t(m,{disabled:"",placeholder:"创建完成后默认生成"})]),_:1})],64))]),_:1})]),_:1},8,["open","title","confirm-loading"])}}},wo=Z(Co,[["__scopeId","data-v-2693434d"]]),Mo={class:"data-list"},To=["onClick"],Ro=["src"],So={class:"info"},Po={class:"tit"},Oo={class:"desc"},Io={key:1,class:"status-tag waiting"},Lo={__name:"select-workflow-modal",emits:["ok"],setup(U,{expose:G,emit:A}){const M=A,v=c(!1),a=c([]),b=c([]);function r(h=[]){b.value=h,v.value=!0,f()}function f(){Je({application_type:1}).then(h=>{a.value=h.data||[],a.value.forEach(s=>{s.checked=b.value.includes(s.id)})})}function R(){v.value=!1,M("ok",a.value.filter(h=>h.checked).map(h=>h.id),a)}return G({show:r}),(h,s)=>{const x=Ue,u=Xe,m=W;return l(),q(m,{open:v.value,"onUpdate:open":s[0]||(s[0]=n=>v.value=n),title:"关联工作流",width:"669px",onOk:R},{default:o(()=>[t(x,{class:"zm-alert-info mt24",type:"info",message:"选择工作流后，会自动生成唯一标识符，可修改","show-icon":""}),e("div",Mo,[(l(!0),_(V,null,Y(a.value,(n,$)=>(l(),_("div",{key:$,class:ue(["data-item",{disabled:n.has_published!=1}]),onClick:C=>n.checked=!n.checked},[e("img",{class:"avatar",src:n.robot_avatar},null,8,Ro),e("div",So,[e("div",null,[e("div",Po,T(n.robot_name),1),e("div",Oo,T(n.robot_intro),1)]),n.has_published==1?(l(),q(u,{key:0,checked:n.checked,"onUpdate:checked":C=>n.checked=C},null,8,["checked","onUpdate:checked"])):(l(),_("span",Io,[t(L(et)),s[1]||(s[1]=O(" 未发布",-1))]))])],10,To))),128))])]),_:1},8,["open"])}}},Uo=Z(Lo,[["__scopeId","data-v-214b9222"]]),Ao={class:"_mcp-box"},Do={key:0,class:"loading-box"},Eo={class:"base-info-box"},Go={class:"app-info"},Bo=["src"],Fo={class:"info-box"},zo={class:"left-box"},qo={class:"name"},No={key:0,class:"status-tag finished"},Vo={key:1,class:"status-tag waiting"},Wo={class:"desc"},jo={class:"right-box"},Ho={class:"app-data"},Jo={class:"data-item"},Ko={class:"title"},Qo={class:"value"},Yo={class:"tools-box"},Zo={class:"head-box"},Xo={key:0,class:"tools-list"},es={class:"left"},ts={class:"tit"},os={class:"key"},ss={class:"desc"},ns={class:"params"},ls={class:"params-box"},as={class:"field"},is={class:"name"},us={class:"type"},ds={key:0,class:"required"},rs={class:"desc"},cs={key:1,class:"empty-box"},_s={key:2,class:"empty-box"},ps={class:"mt4"},vs={__name:"mcp-box",setup(U){const G=c(null),A=c(null),M=c(!0),v=c(!1),a=c(null),b=c([]),r=c([]),f=c(!1),R=c(!1),h=c(""),s=c(null);me(()=>{x()});function x(){M.value=!0,u()}function u(){mo().then(y=>{var p,H,te;a.value=((p=y==null?void 0:y.data)==null?void 0:p.info)||{},r.value=((H=y==null?void 0:y.data)==null?void 0:H.tool_list)||{},a.value.status_bool=((te=a.value)==null?void 0:te.publish_status)==1,r.value.forEach(J=>{J.params=Ie(J.params,[])}),n()}).finally(()=>{M.value=!1})}function m(){const y=()=>{a.value.status_bool=!a.value.status_bool},p=()=>{v.value=!0,bo({server_id:a.value.id,publish_status:Number(a.value.status_bool)}).then(H=>{I.success("操作完成")}).finally(()=>{v.value=!1}).catch(()=>{y()})};a.value.status_bool?p():W.confirm({title:"确认关闭MCP服务？",content:"关闭后，其他应用的位置都不可使用！确认关闭？",okText:"确定",cancelText:"取消",onOk:()=>p(),onCancel:()=>y()})}function n(){var y;b.value=[{title:"URL",value:`${window.location.origin}/mcp`},{title:"请求方式",value:"POST"},{title:"授权方式",value:"Service token / API key"},{title:"请求参数名",value:"Authorization"},{title:"API key",value:`Bearer ${(y=a.value)==null?void 0:y.api_key}`}]}function $(){var p;let y=null;((p=a.value)==null?void 0:p.id)>0&&(y={avatar:a.value.avatar,name:a.value.name,description:a.value.description,server_id:a.value.id}),G.value.show(y)}function C(){W.confirm({title:"确认删除MCP服务？",content:"删除后，其他应用的位置都不可使用！确认删除？",okText:"确定",cancelText:"取消",onOk:()=>{ho({server_id:a.value.id}).then(()=>{I.success("已删除"),u()})}})}function S(){A.value.show(r.value.map(y=>y.robot_id))}function g(y){s.value=y,h.value=y.name,f.value=!0}const k=y=>{y.target.value=y.target.value.replace(/[^a-zA-Z0-9_]/g,""),h.value=y.target.value};function P(){if(!h.value)return I.warning("请输入标识符");R.value=!0,yo({tool_id:s.value.id,name:h.value}).then(y=>{s.value.name=h.value,f.value=!1,I.success("已保存")}).finally(()=>{R.value=!1})}function D(y){W.confirm({title:"确认删除该工具？",okText:"确定",cancelText:"取消",onOk:()=>{$o({tool_id:y.id}).then(()=>{I.success("已删除"),u()})}})}function j(y){go({server_id:a.value.id,robot_id:y.toString()}).then(p=>{u(),I.success("已保存")})}return(y,p)=>{const H=he,te=Et,J=ve,E=ge,se=be,X=ye,$e=Gt,xe=tt,Ce=Ft,we=ke,Me=W;return l(),_("div",Ao,[M.value?(l(),_("div",Do,[t(H)])):a.value.id>0?(l(),_(V,{key:1},[e("div",Eo,[e("div",Go,[e("img",{class:"avatar",src:a.value.avatar},null,8,Bo),e("div",Fo,[e("div",zo,[e("div",qo,[O(T(a.value.name)+" ",1),a.value.status_bool?(l(),_("span",No,[t(L(Dt)),p[3]||(p[3]=O(" 已发布",-1))])):(l(),_("span",Vo,[t(L(et)),p[4]||(p[4]=O(" 未发布",-1))]))]),e("div",Wo,T(a.value.description),1)]),e("div",jo,[t(te,{checked:a.value.status_bool,"onUpdate:checked":p[0]||(p[0]=N=>a.value.status_bool=N),onChange:m,loading:v.value,"checked-children":"开","un-checked-children":"关"},null,8,["checked","loading"]),t(J,{onClick:S,type:"primary",ghost:"",icon:_e(L(fe))},{default:o(()=>[...p[5]||(p[5]=[O("添加工作流",-1)])]),_:1},8,["icon"]),t(X,null,{overlay:o(()=>[t(se,null,{default:o(()=>[t(E,{onClick:$},{default:o(()=>[...p[6]||(p[6]=[O("编辑",-1)])]),_:1}),t(E,{onClick:C},{default:o(()=>[...p[7]||(p[7]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1})]),_:1})]),default:o(()=>[t(J,{icon:_e(L(pe))},null,8,["icon"])]),_:1})])])]),e("div",Ho,[(l(!0),_(V,null,Y(b.value,(N,de)=>(l(),_(V,{key:de},[e("div",Jo,[e("div",Ko,T(N.title),1),e("div",Qo,T(N.value),1)]),t($e,{type:"vertical",style:{height:"24px"}})],64))),128))])]),e("div",Yo,[e("div",Zo,[t(L(Bt),{class:"icon"}),O(" 工具列表（"+T(r.value.length||0)+"） ",1)]),r.value.length?(l(),_("div",Xo,[(l(!0),_(V,null,Y(r.value,(N,de)=>(l(),_("div",{key:de,class:"tools-item"},[e("div",es,[e("div",ts,T(N.robot_name),1),e("div",os,"唯一标识符号："+T(N.name),1),e("div",ss,T(N.robot_intro),1),e("div",ns,[(l(!0),_(V,null,Y(N.params.slice(0,5),(K,ae)=>(l(),q(xe,{key:ae,bordered:!1},{default:o(()=>[O(T(K.key),1)]),_:2},1024))),128)),t(Ce,{placement:"right"},{content:o(()=>[e("div",ls,[(l(!0),_(V,null,Y(N.params,(K,ae)=>(l(),_("div",{key:ae,class:"param-item"},[e("div",as,[e("span",is,T(K.key),1),e("span",us,T(K.typ),1),K.required?(l(),_("span",ds,"必填")):Q("",!0)]),e("div",rs,T(K.desc),1)]))),128))])]),default:o(()=>[p[8]||(p[8]=e("a",null,"参数",-1))]),_:2},1024)])]),t(X,null,{overlay:o(()=>[t(se,null,{default:o(()=>[t(E,{onClick:K=>g(N)},{default:o(()=>[...p[9]||(p[9]=[O("编辑标识符",-1)])]),_:1},8,["onClick"]),t(E,{onClick:K=>D(N)},{default:o(()=>[...p[10]||(p[10]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:o(()=>[t(J,{size:"small",icon:_e(L(pe))},null,8,["icon"])]),_:2},1024)]))),128))])):(l(),_("div",cs,[p[12]||(p[12]=e("img",{src:Se},null,-1)),p[13]||(p[13]=e("div",{class:"title"},"暂未绑定工作流",-1)),t(J,{onClick:S,class:"btn",type:"primary"},{default:o(()=>[...p[11]||(p[11]=[O("立即绑定",-1)])]),_:1})]))])],64)):(l(),_("div",_s,[p[15]||(p[15]=e("img",{src:Se},null,-1)),p[16]||(p[16]=e("div",{class:"title"},"暂未添加工作流MCP插件",-1)),t(J,{onClick:$,class:"btn",type:"primary"},{default:o(()=>[...p[14]||(p[14]=[O("立即添加",-1)])]),_:1})])),t(wo,{ref_key:"mcpRef",ref:G,onOk:u},null,512),t(Uo,{ref_key:"workflowRef",ref:A,onOk:j},null,512),t(Me,{open:f.value,"onUpdate:open":p[2]||(p[2]=N=>f.value=N),"confirm-loading":R.value,title:"编辑标识符",onOk:P},{default:o(()=>[p[17]||(p[17]=e("div",null,"标识符",-1)),e("div",ps,[t(we,{value:h.value,"onUpdate:value":p[1]||(p[1]=N=>h.value=N),onInput:k,placeholder:"请输入标识符",maxlength:32},null,8,["value"])])]),_:1},8,["open","confirm-loading"])])}}},fs=Z(vs,[["__scopeId","data-v-19e13f20"]]),ms={key:0,class:"checking-box"},ks={class:"cont"},hs={class:"head-box"},bs={class:"base-info-box"},gs=["src"],ys={class:"info-box"},$s={class:"left"},xs={class:"name zm-line1"},Cs={key:0,class:"auth-tag"},ws={key:1,class:"auth-tag fail"},Ms={class:"right"},Ts={class:"link"},Rs={class:"link"},Ss={class:"body-box"},Ps={key:0,class:"no-auth-box"},Os={class:"main-tit"},Is={class:"extra-box"},Ls={class:"update-time"},Us={class:"tools-box"},As={class:"info"},Ds={class:"tit"},Es={class:"desc"},Gs={__name:"third-mcp-detail",emits:["del","edit","auth"],setup(U,{expose:G,emit:A}){const M=A,v=c(!1),a=c(!1),b=c(!1),r=c({});function f(m){r.value=m,v.value=!0}function R(){v.value=!1}function h(m){const n=()=>{a.value=!0,ie(!1),Pe({provider_id:r.value.id}).then($=>{setTimeout(()=>{a.value=!1,r.value.has_auth=1,u(),I.success("已验证，授权完成")},2e3)}).catch($=>{r.value.has_auth=0,I.warning("授权失败："+$.message),a.value=!1}).finally(()=>{M("auth",r.value.has_auth),setTimeout(()=>{ie(!0)},500)})};m==2?W.confirm({title:"提示",content:"授权或者刷新应用列表都可能会影响已有工具的调用，确认继续操作吗？",onOk:()=>{n()}}):n()}function s(){M("edit",r.value)}function x(){M("del",r.value)}function u(m=!1){const n=()=>{to({provider_id:r.value.id}).then($=>{let C=($==null?void 0:$.data)||{};C.tools=Ie(C.tools,[]),C.up_time_text=Ve(C.update_time),r.value=C,m&&I.success("刷新完成")}).finally(()=>{b.value=!1})};if(m){if(b.value)return;W.confirm({title:"提示",content:"刷新应用列表或者授权都可能会影响已有工具的调用，确认继续操作吗？",onOk:()=>{b.value=!0,ie(!1),Pe({provider_id:r.value.id}).then($=>{r.value.has_auth=1,n()}).catch($=>{r.value.has_auth=0,I.warning("验证授权失败："+$.message),b.value=!1}).finally(()=>{M("auth",r.value.has_auth),ie(!0)})}})}else n()}return G({show:f,hide:R,refresh:u}),(m,n)=>{const $=he,C=ge,S=be,g=ye,k=ve,P=Nt;return l(),q(P,{open:v.value,"onUpdate:open":n[5]||(n[5]=D=>v.value=D),placement:"right",width:"400px",headerStyle:{display:"none"},bodyStyle:{padding:0}},{default:o(()=>[a.value?(l(),_("div",ms,[e("div",ks,[t($),n[6]||(n[6]=O(" 正在验证... ",-1))])])):Q("",!0),e("div",hs,[e("div",bs,[e("img",{class:"avatar",src:r.value.avatar},null,8,gs),e("div",ys,[e("div",$s,[e("div",xs,T(r.value.name),1),e("div",null,[r.value.has_auth==1?(l(),_("div",Cs,"已授权")):(l(),_("div",ws,"未授权"))])]),e("div",Ms,[t(g,null,{overlay:o(()=>[t(S,null,{default:o(()=>[t(C,{onClick:z(s,["stop"])},{default:o(()=>[...n[7]||(n[7]=[O("编辑",-1)])]),_:1}),t(C,{onClick:z(x,["stop"])},{default:o(()=>[...n[8]||(n[8]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1})]),_:1})]),default:o(()=>[t(L(pe),{class:"icon"})]),_:1}),t(L(zt),{onClick:n[0]||(n[0]=D=>v.value=!1),class:"icon"})])])]),e("div",Ts,T(r.value.description),1),e("div",Rs,T(r.value.url),1),r.value.has_auth==1?(l(),q(k,{key:0,class:"auth-btn",onClick:n[1]||(n[1]=D=>h(2))},{default:o(()=>[...n[9]||(n[9]=[O("重新授权",-1)])]),_:1})):(l(),q(k,{key:1,type:"primary",class:"auth-btn",onClick:n[2]||(n[2]=D=>h(1))},{default:o(()=>[...n[10]||(n[10]=[O("授 权",-1)])]),_:1}))]),e("div",Ss,[r.value.has_auth!=1?(l(),_("div",Ps,[n[11]||(n[11]=e("img",{src:Xt},null,-1)),n[12]||(n[12]=e("div",{class:"tit"},"需要授权",-1)),n[13]||(n[13]=e("div",{class:"desc"},"授权后，MCP工具将显示在这里",-1)),e("a",{class:"link",onClick:n[3]||(n[3]=D=>h(1))},"立即授权")])):(l(),_(V,{key:1},[e("div",Os,[e("span",null,T(r.value.tools.length)+"个可用工具",1),e("div",Is,[e("div",Ls,T(r.value.up_time_text)+"更新",1),e("a",{class:"refresh-btn",onClick:n[4]||(n[4]=D=>u(!0))},[t(L(qt),{spin:b.value},null,8,["spin"]),n[14]||(n[14]=O(" 刷新 ",-1))])])]),e("div",Us,[(l(!0),_(V,null,Y(r.value.tools,(D,j)=>(l(),_("div",{key:j,class:"tool-item"},[n[15]||(n[15]=e("img",{class:"cover",src:eo},null,-1)),e("div",As,[e("div",Ds,T(D.name),1),e("div",Es,T(D.description),1)])]))),128))])],64))])]),_:1},8,["open"])}}},Bs=Z(Gs,[["__scopeId","data-v-1870cc48"]]),Fs={key:0,class:"checking-box"},zs={class:"cont"},qs={class:"avatar-box"},Ns={key:0,class:"cFB363F"},Vs={class:"req-head-box"},Ws={__name:"third-mcp-store",emits:["ok"],setup(U,{expose:G,emit:A}){const M=A,v=c(0),a=c(!1),b=c(!1),r=c(!1),f=c(null),R=c(""),h={avatar:Oe,name:"",description:"",provider_id:"",url:"",request_timeout:"30",headers:[]},s=Le({});function x(g=null){if(Object.assign(s,g||h),f.value=null,s.headers=[],g){v.value=g.id,s.provider_id=g.id;let k=JSON.parse(g.headers);for(let P in k)s.headers.push({key:P,value:k[P]})}R.value=JSON.stringify({headers:s.headers,url:s.url}),a.value=!0}function u(g){f.value=g}function m(){s.headers.push({key:"",value:""})}function n(g){s.headers.splice(g,1)}function $(){return R.value!=JSON.stringify({headers:s.headers,url:s.url})}function C(){const g=I.loading("保存完成，正在进行授权验证...",0);b.value=!0,setTimeout(()=>{ie(!1),Pe({provider_id:v.value}).then(k=>{I.success("授权完成！")}).catch(k=>{I.warning("授权失败："+k.message)}).finally(()=>{g(),b.value=!1,a.value=!1,M("ok",s),setTimeout(()=>{ie(!0)},500)})},1800)}function S(){var g;try{if(r.value=!0,s.name=s.name.trim(),s.description=s.description.trim(),!s.name)throw"请输入MCP插件名称";if(!s.description)throw"请输入MCP插件描述";if(!s.url)throw"请输入服务端点的URL";if(!s.request_timeout)throw"请输入超时时间";let k={...s};f.value&&(k.avatar=(g=f.value)==null?void 0:g.file),k.headers={};for(let P of s.headers)P.key=P.key.trim(),P.value=P.value.trim(),P.key&&P.value&&(k.headers[P.key]=P.value);k.headers=JSON.stringify(k.headers),delete k.toools,oo(k).then(P=>{let{provider_id:D}=(P==null?void 0:P.data)||{};v.value=D,$()?C():(M("ok",s),I.success("已保存"),a.value=!1)}).finally(()=>{r.value=!1})}catch(k){r.value=!1,I.error(k)}}return G({show:x}),(g,k)=>{const P=he,D=ke,j=Ye,y=Ze,p=Vt,H=ve,te=Qe,J=W;return l(),q(J,{open:a.value,"onUpdate:open":k[5]||(k[5]=E=>a.value=E),zIndex:1002,title:s.provider_id?"编辑MCP":"添加MCP",width:"472px","confirm-loading":r.value,onOk:S},{default:o(()=>[b.value?(l(),_("div",Fs,[e("div",zs,[t(P),k[6]||(k[6]=O(" 正在验证... ",-1))])])):Q("",!0),e("div",qs,[t(Ke,{value:s.avatar,"onUpdate:value":k[0]||(k[0]=E=>s.avatar=E),onChange:u},null,8,["value"]),k[7]||(k[7]=e("div",{class:"tip-info"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1))]),t(te,{class:"form-box",labelAlign:"left"},{default:o(()=>[t(j,{label:"MCP插件名称",required:"",colon:!1},{default:o(()=>[t(D,{value:s.name,"onUpdate:value":k[1]||(k[1]=E=>s.name=E),placeholder:"请输入MCP插件名称，最多20个字",maxlength:20},null,8,["value"])]),_:1}),t(j,{label:"描述",colon:!1},{default:o(()=>[t(y,{value:s.description,"onUpdate:value":k[2]||(k[2]=E=>s.description=E),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入描述",maxlength:120},null,8,["value"])]),_:1}),k[11]||(k[11]=e("div",{class:"tit-box"},"配置信息",-1)),t(j,{label:"插件URL",colon:!1},{default:o(()=>[t(D,{value:s.url,"onUpdate:value":k[3]||(k[3]=E=>s.url=E),placeholder:"服务端点的URL"},null,8,["value"]),s.provider_id?(l(),_("div",Ns,"修改服务端点 URL 可能会影响使用当前 MCP的应用")):Q("",!0)]),_:1}),t(j,{label:"超时时间",colon:!1},{default:o(()=>[t(p,{value:s.request_timeout,"onUpdate:value":k[4]||(k[4]=E=>s.request_timeout=E),precision:0,style:{width:"100%"},placeholder:"请输入超时时间"},null,8,["value"])]),_:1}),t(j,{label:"请求头",colon:!1},{default:o(()=>[k[10]||(k[10]=e("div",{class:"tip-info"},"发送到 MCP 服务器的额外 HTTP 请求头",-1)),e("div",Vs,[k[9]||(k[9]=e("div",{class:"req-head-item"},[e("div",{class:"tit"},"请求头名称"),e("div",{class:"tit"},"请求头值")],-1)),(l(!0),_(V,null,Y(s.headers,(E,se)=>(l(),_("div",{key:se,class:"req-head-item"},[t(D,{value:E.key,"onUpdate:value":X=>E.key=X,placeholder:"请输入"},null,8,["value","onUpdate:value"]),t(D,{value:E.value,"onUpdate:value":X=>E.value=X,placeholder:"请输入"},null,8,["value","onUpdate:value"]),t(L(Wt),{onClick:X=>n(se)},null,8,["onClick"])]))),128)),t(H,{class:"add-btn",type:"dashed",icon:_e(L(fe)),onClick:m},{default:o(()=>[...k[8]||(k[8]=[O("添加请求头",-1)])]),_:1},8,["icon"])])]),_:1})]),_:1})]),_:1},8,["open","title","confirm-loading"])}}},ot=Z(Ws,[["__scopeId","data-v-7ab5a130"]]),js={class:"_mcp-box"},Hs={key:0,class:"loading-box"},Js={key:1,class:"list-box"},Ks=["onClick"],Qs={class:"base-info-box"},Ys=["src"],Zs={class:"info-box"},Xs={class:"name zm-line1"},en={key:0,class:"auth-tag"},tn={key:1,class:"auth-tag fail"},on={class:"zm-line1"},sn={class:"bottom"},nn={class:"extra-box"},ln={class:"extra-item"},an={class:"extra-item"},un={key:2,class:"empty-box"},dn={__name:"third-mcp-box",emits:["listLoaded"],setup(U,{expose:G,emit:A}){const M=We(),v=c(null),a=c(null),b=c(!0),r=c([]),f=A;me(()=>{R()});function R(){b.value=!0,s()}function h(){s(),v.value&&v.value.refresh()}function s(){so().then(C=>{let S=(C==null?void 0:C.data)||[];S.forEach(g=>{g.tools=Ie(g.tools,[]),g.up_time_text=Ve(g.update_time)}),r.value=S,f("listLoaded",r.value.length)}).finally(()=>{b.value=!1})}function x(C){v.value.show(C)}function u(){a.value.show()}function m(C){a.value.show(C)}function n(){const C=M.resolve({path:"/mcp/index"}).href;window.open(C,"_blank")}function $(C){W.confirm({title:"确认删除该MCP插件？",content:"删除后，其他应用的位置都不可使用！确认删除？",okText:"确定",cancelText:"取消",onOk:()=>{no({provider_id:C.id}).then(()=>{I.success("已删除"),s(),v.value&&v.value.hide()})}})}return G({update:h}),(C,S)=>{const g=he,k=ve,P=ge,D=be,j=ye;return l(),_("div",js,[b.value?(l(),_("div",Hs,[t(g)])):r.value.length?(l(),_("div",Js,[(l(!0),_(V,null,Y(r.value,(y,p)=>(l(),_("div",{onClick:H=>x(y),key:p,class:"app-item"},[e("div",Qs,[e("img",{class:"avatar",src:y.avatar},null,8,Ys),e("div",Zs,[e("div",Xs,T(y.name),1),e("div",null,[y.has_auth==1?(l(),_("div",en,"已授权")):(l(),_("div",tn,"未授权"))])])]),e("div",on,T(y.url),1),e("div",sn,[e("div",nn,[e("div",ln,"可用工具："+T(y.tools.length),1),e("div",an,T(y.up_time_text)+"更新",1)]),t(j,null,{overlay:o(()=>[t(D,null,{default:o(()=>[t(P,{onClick:z(H=>m(y),["stop"])},{default:o(()=>[...S[1]||(S[1]=[O("编辑",-1)])]),_:1},8,["onClick"]),t(P,{onClick:z(H=>$(y),["stop"])},{default:o(()=>[...S[2]||(S[2]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:o(()=>[t(k,{onClick:S[0]||(S[0]=z(()=>{},["stop"])),size:"small",icon:_e(L(pe))},null,8,["icon"])]),_:2},1024)])],8,Ks))),128))])):(l(),_("div",un,[S[4]||(S[4]=e("img",{src:Se},null,-1)),S[5]||(S[5]=e("div",{class:"title"},"暂未添加外部MCP插件",-1)),e("div",{class:"desc-box"},[e("div",{class:"link",onClick:n},"更多MCP？去MCP广场")]),t(k,{onClick:u,class:"btn",type:"primary"},{default:o(()=>[...S[3]||(S[3]=[O("立即添加",-1)])]),_:1})])),t(Bs,{ref_key:"mcpDetailRef",ref:v,onDel:$,onEdit:m,onAuth:s},null,512),t(ot,{ref_key:"mcpStoreRef",ref:a,onOk:h},null,512)])}}},rn=Z(dn,[["__scopeId","data-v-8236a2d9"]]),cn={class:"_mcp_container"},_n={class:"tabs-box"},pn={__name:"mcp-panel",emits:["thirdMcpListEmpty"],setup(U,{expose:G,emit:A}){const M=je(),v=c(null),a=c(Number(localStorage.getItem("zm:chatwiki:mcp:active")||1)),b=A;me(()=>{M.query.mcp>0&&r(Number(M.query.mcp))});function r(h){a.value=h,localStorage.setItem("zm:chatwiki:mcp:active",h)}function f(){a.value==2&&v.value.update()}function R(h){b("thirdMcpListEmpty",h===0)}return G({update:f}),(h,s)=>(l(),_("div",cn,[e("div",_n,[e("div",{class:ue(["tab-item",{active:a.value==1}]),onClick:s[0]||(s[0]=x=>r(1))},"工作流MCP",2),e("div",{class:ue(["tab-item",{active:a.value==2}]),onClick:s[1]||(s[1]=x=>r(2))},"外部MCP",2)]),a.value==1?(l(),q(fs,{key:0,ref_key:"mcpRef",ref:v},null,512)):(l(),q(rn,{key:1,ref_key:"mcpRef",ref:v,onListLoaded:R},null,512))]))}},vn=Z(pn,[["__scopeId","data-v-f8b38e8b"]]),fn={class:"main"},mn={key:0,class:"item"},kn={class:"list"},hn={class:"warning"},bn={key:1,class:"item"},gn={class:"list"},yn={class:"warning"},$n={__name:"workflow-export-modal",emits:["ok"],setup(U,{expose:G,emit:A}){const M=A,v=c(!1),a=c({}),b=c(!1),r=c(!1),f=c([]),R=c([]);function h(u={}){s(),a.value=u,Ct({id:u==null?void 0:u.id}).then(m=>{let n=(m==null?void 0:m.data)||{};f.value=(n==null?void 0:n.databaseList)||[],R.value=(n==null?void 0:n.library)||[],!R.value.length&&!f.value.length?M("ok",a.value):v.value=!0})}function s(){R.value=[],f.value=[],b.value=!1,r.value=!1}function x(){let u={};b.value&&R.value.length&&(u.library_id=R.value.map(m=>m.id).toString()),r.value&&f.value.length&&(u.form_id=f.value.map(m=>m.form_id).toString()),v.value=!1,M("ok",a.value,u)}return G({handle:h}),(u,m)=>{const n=Ue,$=Xe,C=tt,S=W;return l(),q(S,{open:v.value,"onUpdate:open":m[2]||(m[2]=g=>v.value=g),title:"导出知识库和数据库确认",width:"746px",onOk:x},{default:o(()=>[t(n,{class:"zm-alert-info mt24",type:"info",message:"导出的工作流导入使用后，会自动创建引用的知识库和数据库，请确认是否同步导出知识库内容和数据库内容"}),e("div",fn,[R.value.length?(l(),_("div",mn,[t($,{checked:b.value,"onUpdate:checked":m[0]||(m[0]=g=>b.value=g)},{default:o(()=>[...m[3]||(m[3]=[O("知识库内容",-1)])]),_:1},8,["checked"]),e("div",kn,[(l(!0),_(V,null,Y(R.value,g=>(l(),q(C,{key:g.id},{default:o(()=>[O(T(g.library_name),1)]),_:2},1024))),128))]),ze(e("div",hn,"导出的工作流时会导出引用的知识库，勾选后会同时导出知识库内容，请注意企业内容使用，保证数据安全",512),[[qe,b.value]])])):Q("",!0),f.value.length?(l(),_("div",bn,[t($,{checked:r.value,"onUpdate:checked":m[1]||(m[1]=g=>r.value=g)},{default:o(()=>[...m[4]||(m[4]=[O("数据库内容",-1)])]),_:1},8,["checked"]),e("div",gn,[(l(!0),_(V,null,Y(f.value,g=>(l(),q(C,{key:g.form_id},{default:o(()=>[O(T(g.form_name),1)]),_:2},1024))),128))]),ze(e("div",yn,"导出的工作流时会导出引用的数据库，勾选后会同时导出数据库内容，请注意企业内容使用，保证数据安全",512),[[qe,r.value]])])):Q("",!0)])]),_:1},8,["open"])}}},xn=Z($n,[["__scopeId","data-v-d875ebee"]]),Cn={class:"robot-page"},wn={class:"list-toolbar mt16"},Mn={class:"toolbar-box"},Tn={class:"toolbar-box",style:{"text-align":"right"}},Rn={class:"create-action"},Sn=["src"],Pn={class:"create-action"},On=["src"],In={class:"create-action"},Ln=["src"],Un={class:"create-action"},An=["src"],Dn={key:1,class:"desc-box"},En={key:1,class:"list-group-box"},Gn={key:0,class:"group-head-box"},Bn={class:"head-title"},Fn={class:"search-box"},zn={class:"classify-box"},qn=["onClick"],Nn={class:"classify-title"},Vn={class:"right-content"},Wn={key:0,class:"btn-box"},jn={class:"hover-btn-wrap"},Hn=["onClick"],Jn=["onClick"],Kn={class:"robot-scroll-box"},Qn={key:0,class:"empty-box"},Yn=["onClick"],Zn={class:"list-item"},Xn={class:"robot-info"},el=["src"],tl={class:"robot-info-content"},ol={class:"robot-name"},sl={class:"robot-type-tag"},nl=["onClick"],ll=["onClick"],al=["onClick"],il=["onClick"],ul=["onClick"],dl=["onClick"],rl={__name:"robot-list",setup(U){const G=We(),A=je(),M=c([{title:"全部 (0)",value:"2"},{title:"聊天机器人 (0)",value:"0"},{title:"工作流 (0)",value:"1"},{title:"MCP插件",value:"3"}]),v=_t();let{role_permission:a,role_type:b}=v;const r=Ne(()=>b==1||a.includes("RobotCreate")),f=c(null),R=c(null),h=c("2"),s=c(""),x=c([]),u=c([]),m=c(!1);let n="robot-list-hide-group-key";const $=c(localStorage.getItem(n)==1),C=()=>{$.value=!$.value,localStorage.setItem(n,$.value?1:0)},S=()=>{P(),Ae()},g=()=>{let d=x.value;s.value!=""&&(d=d.filter(i=>i.group_id==s.value)),h.value!=2&&(d=d.filter(i=>i.application_type==h.value)),u.value=d};function k(){const d=G.resolve({path:"/mcp/index"}).href;window.open(d,"_blank")}const P=()=>{Je().then(d=>{let i=0,F=0,B=0;d.data.forEach(oe=>{oe.application_type==0?F++:B++,i++}),M.value=[{title:"全部 ("+i+")",value:"2"},{title:"聊天机器人 ("+F+")",value:"0"},{title:"工作流 ("+B+")",value:"1"},{title:"MCP插件",value:"3"}],x.value=d.data,g()}).catch(()=>{})},D=c(null),j=c(null),y=c(null),p=d=>{D.value.open(d),D.value.setGroupId(s.value)},H=()=>{y.value.show()},te=()=>{j.value.open()},J=d=>{P(),E(d)},E=({id:d,robot_key:i,application_type:F})=>{localStorage.setItem("last_local_robot_id",d),F==0?window.open(`/#/robot/config/basic-config?id=${d}&robot_key=${i}`,"_blank","noopener"):window.open(`/#/robot/config/workflow?id=${d}&robot_key=${i}`,"_blank","noopener")},se=d=>{if(bt(d.id)!=4)return I.error("您没有删除机器人的权限");let F=3,B=W.confirm({title:`删除机器人${d.robot_name}`,icon:t(Re),content:"您确定要删除此机器人吗？",okText:F+" 确 定",okType:"danger",cancelText:"取 消",okButtonProps:{disabled:!0},onOk(){X(d)},onCancel(){}}),oe=setInterval(()=>{F==1?(B.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(oe),oe=void 0):(F-=1,B.update({okText:F+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},X=({id:d})=>{Tt({id:d}).then(()=>{I.success("删除成功"),P()})},$e=d=>{let i=3,F=W.confirm({title:`复制机器人${d.robot_name}`,icon:t(Re),content:"您确定要复制此机器人吗？",okText:i+" 确 定",okType:"danger",cancelText:"取 消",okButtonProps:{disabled:!0},onOk(){xe(d)},onCancel(){}}),B=setInterval(()=>{i==1?(F.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(B),B=void 0):(i-=1,F.update({okText:i+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},xe=({id:d})=>{Rt({id:d}).then(()=>{I.success("复制成功"),P()})},Ce=d=>{f.value.handle(d)},we=(d,i=null)=>{const{openUrlWithToken:F}=fo();i=i||{},i.id=d.id,`${Fe(i)}`,F(`/manage/robotExport?${Fe(i)}`)},Me=d=>{window.open(`#/robot/test?robot_key=${d.robot_key}&id=${d.id}`)},N=d=>{window.open(`#/robot/config/session-record?robot_key=${d.robot_key}&id=${d.id}`)},de=d=>{window.open(`#/robot/config/statistical_analysis?robot_key=${d.robot_key}&id=${d.id}`)},K=c(""),ae=c([]),st=Ne(()=>ae.value.filter(d=>d.group_name.includes(K.value))),Ae=()=>{He({application_type:h.value==2?null:h.value}).then(d=>{let i=d.data||[],F=0;i.forEach(B=>{F+=+B.total}),ae.value=[{group_name:"全部",total:F,id:""},...i]})},nt=d=>{s.value=d.id,P()},De=c(null),Ee=d=>{De.value.show({...d})},Ge=c(null),lt=d=>{Ge.value.show({...d})},at=d=>{W.confirm({title:`确认删除分组${d.group_name}`,icon:t(Re),content:"",okText:"确认",okType:"danger",cancelText:"取消",onOk(){wt({id:d.id}).then(()=>{I.success("删除成功"),Ae(),s.value==d.id&&(s.value="",P())})}})},it=()=>{R.value&&R.value.update()},ut=d=>{if(d.newIndex===d.oldIndex)return;m.value=!0;let i={move_robot_id:u.value[d.newIndex].id,to_robot_id:0};d.newIndex>0&&(i.to_robot_id=u.value[d.newIndex-1].id),Mt(i).then(F=>{I.success("操作完成")}).finally(()=>{m.value=!1})};return me(()=>{h.value=A.query.active||"2",S()}),(d,i)=>{const F=ve,B=ge,oe=be,Te=ye,ne=jt,dt=ke,Be=gt,rt=Ht,re=ht;return l(),_("div",Cn,[t(Yt,{class:"mt16",title:"使用说明"},{default:o(()=>[...i[12]||(i[12]=[e("div",null,[e("p",null," 1、应用包括两种类型：聊天机器人、工作流。聊天机器人适合新手用户，关联知识库后只需简单配置，即可创建一个基于私有知识库的问答机器人。工作流适合高级用户，利用系统预制节点自定义任务流程，适合解决复杂任务。 "),e("p",null,"2、发现模块也提供了丰富模版，可以根据需要选择适合模版快速创建应用。")],-1)])]),_:1}),e("div",wn,[e("div",Mn,[t(Zt,{tabs:M.value,onChange:S,value:h.value,"onUpdate:value":i[0]||(i[0]=w=>h.value=w)},null,8,["tabs","value"])]),e("div",Tn,[r.value?(l(),q(Te,{key:0},{overlay:o(()=>[t(oe,null,{default:o(()=>[t(B,{onClick:i[2]||(i[2]=z(w=>p(0),["prevent"]))},{default:o(()=>[e("span",Rn,[e("img",{class:"icon",src:L(pt),alt:""},null,8,Sn),i[14]||(i[14]=e("span",null,"聊天机器人",-1))])]),_:1}),t(B,{onClick:i[3]||(i[3]=z(w=>p(1),["prevent"]))},{default:o(()=>[e("span",Pn,[e("img",{class:"icon",src:L(vt),alt:""},null,8,On),i[15]||(i[15]=e("span",null,"工作流",-1))])]),_:1}),t(B,{onClick:z(H,["prevent"])},{default:o(()=>[e("span",In,[e("img",{class:"icon",src:L(Oe),alt:""},null,8,Ln),i[16]||(i[16]=e("span",null,"外部MCP",-1))])]),_:1}),t(B,{onClick:te},{default:o(()=>[e("span",Un,[e("img",{class:"icon",src:L(ft),alt:""},null,8,An),i[17]||(i[17]=e("span",null,"导入csl创建",-1))])]),_:1})]),_:1})]),default:o(()=>[t(F,{type:"primary",onClick:i[1]||(i[1]=z(()=>{},["prevent"]))},{icon:o(()=>[t(L(fe))]),default:o(()=>[i[13]||(i[13]=O(" 创建应用 ",-1))]),_:1})]),_:1})):Q("",!0),r.value&&h.value=="3"?(l(),_("div",Dn,[e("div",{class:"link",onClick:k},"更多MCP？去MCP广场")])):Q("",!0)])]),h.value==3?(l(),q(vn,{key:0,ref_key:"mcpPanelRef",ref:R},null,512)):(l(),_("div",En,[e("div",{class:ue(["group-list-box",{"hide-group":$.value}])},[t(Be,{style:{"padding-right":"16px"}},{default:o(()=>[$.value?Q("",!0):(l(),_("div",Gn,[e("div",Bn,[i[18]||(i[18]=e("div",null,"机器人分组",-1)),t(ne,{title:"新建分组"},{default:o(()=>[e("div",{class:"hover-btn-wrap",onClick:i[4]||(i[4]=w=>Ee({}))},[t(L(fe))])]),_:1})]),e("div",Fn,[t(dt,{value:K.value,"onUpdate:value":i[6]||(i[6]=w=>K.value=w),allowClear:"",placeholder:"搜索分组",style:{width:"100%"}},{suffix:o(()=>[t(L(Jt),{onClick:i[5]||(i[5]=z(()=>{},["stop"]))})]),_:1},8,["value"])])])),e("div",zn,[(l(!0),_(V,null,Y(st.value,w=>(l(),_("div",{class:ue(["classify-item",{active:w.id==s.value}]),onClick:ce=>nt(w),key:w.id},[e("div",Nn,T(w.group_name),1),e("div",Vn,[e("div",{class:ue(["num",{"num-block":w.id<=0}])},T(w.total),3),w.id>0?(l(),_("div",Wn,[t(Te,{placement:"bottomRight"},{overlay:o(()=>[t(oe,null,{default:o(()=>[t(B,null,{default:o(()=>[e("div",{onClick:z(ce=>Ee(w),["stop"])},"重命名",8,Hn)]),_:2},1024),t(B,null,{default:o(()=>[e("div",{onClick:z(ce=>at(w),["stop"])},"删 除",8,Jn)]),_:2},1024)]),_:2},1024)]),default:o(()=>[e("div",jn,[t(L(pe))])]),_:2},1024)])):Q("",!0)])],10,qn))),128))])]),_:1}),t(ne,{placement:"right",title:$.value?"展开分组":"收起分组"},{default:o(()=>[e("div",{class:"hide-group-box",onClick:C},[$.value?(l(),q(L(Qt),{key:1})):(l(),q(L(Kt),{key:0}))])]),_:1},8,["title"])],2),e("div",Kn,[u.value.length==0?(l(),_("div",Qn,[t(rt)])):Q("",!0),t(Be,{style:{"padding-right":"16px"}},{default:o(()=>[t(L(yt),{modelValue:u.value,"onUpdate:modelValue":i[10]||(i[10]=w=>u.value=w),handle:".drag-btn","item-key":"id",disabled:m.value,class:"list-box",onEnd:ut},{item:o(({element:w,index:ce})=>[(l(),_("div",{class:"list-item-wrapper",key:w.id,onClick:ee=>E(w)},[e("div",Zn,[e("div",Xn,[e("img",{class:"robot-avatar",src:w.robot_avatar,alt:""},null,8,el),e("div",tl,[e("div",ol,T(w.robot_name),1),e("div",sl,T(w.application_type==0?"聊天机器人":"工作流"),1)])]),t(ne,{title:L(mt)(w.robot_intro,w,14,2,10),placement:"top"},{default:o(()=>[e("div",{class:"robot-desc",ref:ee=>L(kt)(ee,w)},T(w.robot_intro),513)]),_:2},1032,["title"]),e("div",{class:"robot-action",onClick:i[9]||(i[9]=z(()=>{},["stop"]))},[t(ne,{title:"长按拖动排序"},{default:o(()=>[e("div",{class:"robot-action-item drag-btn",onClick:i[7]||(i[7]=z(()=>{},["stop"]))},[t(re,{class:"action-icon",name:"dragv2"})])]),_:1}),t(ne,{title:"聊天测试"},{default:o(()=>[e("div",{class:"robot-action-item",onClick:z(ee=>Me(w),["stop"])},[t(re,{class:"action-icon",name:"chat"})],8,nl)]),_:2},1024),t(ne,{title:"会话记录"},{default:o(()=>[e("div",{class:"robot-action-item",onClick:z(ee=>N(w),["stop"])},[t(re,{class:"action-icon",name:"session"})],8,ll)]),_:2},1024),t(ne,{title:"统计分析"},{default:o(()=>[e("div",{class:"robot-action-item",onClick:z(ee=>de(w),["stop"])},[t(re,{class:"action-icon",name:"analysis"})],8,al)]),_:2},1024),t(Te,null,{overlay:o(()=>[t(oe,null,{default:o(()=>[t(B,null,{default:o(()=>[e("a",{class:"delete-text-color",href:"javascript:;",onClick:ee=>se(w)},"删 除",8,il)]),_:2},1024),t(B,null,{default:o(()=>[e("div",{onClick:z(ee=>lt(w),["stop"])},"修改分组",8,ul)]),_:2},1024),t(B,null,{default:o(()=>[e("a",{class:"copy-text-color",href:"javascript:;",onClick:ee=>$e(w)},"复 制",8,dl)]),_:2},1024),t(B,{onClick:ee=>Ce(w)},{default:o(()=>[...i[19]||(i[19]=[e("span",null,"导出为csl",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:o(()=>[e("div",{class:"robot-action-item",onClick:i[8]||(i[8]=z(()=>{},["stop"]))},[t(re,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,Yn))]),_:1},8,["modelValue","disabled"])]),_:1})])])),t(St,{ref_key:"addRobotAlertRef",ref:D,onOk:S},null,512),t(Pt,{ref_key:"addGroupRef",ref:De,onOk:S},null,512),t(vo,{ref_key:"editGroupRef",ref:Ge,onOk:S},null,512),t(ro,{ref_key:"importCslAlertRef",ref:j,onOk:J},null,512),t(ot,{ref_key:"thirdMcpRef",ref:y,onOk:it},null,512),t(xn,{ref_key:"exportRef",ref:f,onOk:i[11]||(i[11]=(w,ce)=>we(w,ce))},null,512)])}}},Il=Z(rl,[["__scopeId","data-v-0caa6232"]]);export{Il as default};
