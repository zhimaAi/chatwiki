import{_ as K,b as re,L as Ce,e as Q,M as J,n as ue,o as Ae,r as Le,a as Ue,p as Se,E as de,q as Oe,t as Me,B as ce,c as Ie,v as Pe,w as Be,x as Fe,y as De}from"../../index-BokOG9ZU.js";import{r as p,L as r,M as y,F as Z,a1 as j,a2 as Re,Y as w,u as E,w as Ee,j as e,Q as a,P as T,V as o,a3 as _e,a4 as pe,A as V,U as q,X as F,a8 as se,a9 as me,v as ze}from"./vue-chunks-XoCroLmQ.js";import{g as Te}from"./index-_RnYw74I.js";import{g as Ge}from"./index-CbAgVi9e.js";import{g as Ne}from"./index-naxAOiU8.js";import{v as ve}from"./validate-8MtiUsxW.js";import{F as W,_ as le}from"./index-fISAHuLd.js";import{P as ne}from"./PlusOutlined-B3xrJfbK.js";import{_ as $e}from"./index-CAuXv0Mv.js";import"./index-BitUTYbL.js";import{I as fe}from"./Input-CUxLS_nc.js";import{S as Ke,_ as He}from"./index-DgLLvjt3.js";import{_ as he}from"./Password-D_H-hnpK.js";import{C as ge,_ as ye}from"./index-BJ6pqfZz.js";import{a as ke}from"./dayjs-D8VPPBbu.js";import{Q as ae}from"./QuestionCircleOutlined-DEWzrvxy.js";import{_ as be}from"./Search-CbUpX_hw.js";import{_ as ie}from"./index-D_iED9iI.js";import{_ as we,a as xe}from"./index-xOgFOS5S.js";import{_ as Xe}from"./index-BOYSy9Pq.js";import{_ as qe}from"./TextArea-TiJWDxF4.js";import{_ as Qe,a as Ve}from"./index-D3MKxuxN.js";import"./axios-Cm0UX6qg.js";import"./qs-D73tJGQG.js";import"./crypto-js-D323TfIu.js";import"./colors-Cfqlh7qR.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./responsiveObserve-Cyut9UHK.js";import"./collapseMotion-DWwsCVG2.js";import"./FormItemContext-Ch_K4tn1.js";import"./partition-CenmkQe8.js";import"./CheckOutlined-Byfa85ke.js";import"./useRefs-C13sH2-_.js";import"./index-Co375E0k.js";import"./inputProps-CWzf5mAp.js";import"./slide-BpJSAeCl.js";import"./index-CnyiohbP.js";import"./isMobile-D_4OiXLP.js";import"./DownOutlined-I-3QmTPt.js";import"./SearchOutlined-BfUHdq7e.js";import"./move-ChusaJh2.js";import"./RadioButton-DYdQQdGT.js";import"./css-MNT4q5hR.js";import"./index-Bf_Ayn3y.js";import"./LeftOutlined-DN6j0fW4.js";import"./RightOutlined-CViLB99g.js";import"./index-mOJL8w2K.js";import"./dropdown-_4lkCpvo.js";import"./Dropdown-aJrAR27s.js";import"./index-CvsTLiPQ.js";import"./shallowequal-BeorLzKa.js";import"./index-BgMvvztK.js";const Ye={class:"page-tabs"},Ze=["onClick"],je={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(I,{emit:g}){const{t:f}=re(),P=g,U=I,i=p([{value:1,title:f("views.user.model.teamMembers"),langKey:"views.user.model.teamMembers"},{value:0,title:f("views.user.model.rolePermissions"),langKey:"views.user.model.rolePermissions"}]),c=t=>{P("update:value",t),P("change",t)};return(t,O)=>(r(),y("div",Ye,[(r(!0),y(Z,null,j(i.value,x=>(r(),y("div",{class:Re(["tab-item",{active:U.value==x.value}]),onClick:u=>c(x.value),key:x.value},w(E(f)(x.langKey)),11,Ze))),128))]))}},We=K(je,[["__scopeId","data-v-e344f7b9"]]),Je=I=>(_e("data-v-c21fed10"),I=I(),pe(),I),et={class:"avatar-uploader"},tt=["src"],at={key:1},st=Je(()=>o("div",{class:"ant-upload-text"},"上传照片",-1)),ot=["src"],lt={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(I,{emit:g}){function f(l){return new Promise((m,h)=>{const s=new FileReader;s.readAsDataURL(l),s.onload=()=>m(s.result),s.onerror=B=>h(B)})}const P=g,U=I,i=p([]),c=p(!1),t=p("");Ee(()=>U.value,l=>{t.value=l},{immediate:!0});const O=W.useInjectFormItemContext(),x=()=>{let l={imageUrl:t.value,file:i.value[0].originFileObj};P("change",l),P("update:value",l.imageUrl),O.onFieldChange()},u=l=>l.type==="image/jpeg"||l.type==="image/png"?l.size/1024<1024?(i.value=[l],f(l).then(s=>{t.value=s,c.value=!1,x()}),!1):(Q.error("成员头像图片大小不能超过1M"),!1):(Q.error("机器人头像只支持JPG、PNG格式的图片"),!1),S=p(!1),C=p(""),k=p(""),A=()=>{S.value=!1,k.value=""},n=async l=>{!l.url&&!l.preview&&(l.preview=await f(l.originFileObj)),C.value=l.url||l.preview,S.value=!0,k.value=l.name||l.url.substring(l.url.lastIndexOf("/")+1)};return(l,m)=>{const h=$e,s=J;return r(),y("div",et,[e(h,{"file-list":i.value,"onUpdate:fileList":m[0]||(m[0]=B=>i.value=B),"list-type":"picture-card","show-upload-list":!1,"before-upload":u,accept:".jpg,.png,.jpeg",onPreview:n},{default:a(()=>[t.value?(r(),y("img",{key:0,class:"avatar",src:t.value,alt:"avatar"},null,8,tt)):(r(),y("div",at,[c.value?(r(),T(E(Ce),{key:0})):(r(),T(E(ne),{key:1})),st]))]),_:1},8,["file-list"]),e(s,{open:S.value,title:k.value,footer:null,onCancel:A},{default:a(()=>[o("img",{alt:"example",style:{width:"100%"},src:C.value},null,8,ot)]),_:1},8,["open","title"])])}}},nt=K(lt,[["__scopeId","data-v-c21fed10"]]),oe="data:image/png;base64,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",it={class:"form-box"},rt={__name:"add-team-members",emits:["ok"],setup(I,{expose:g,emit:f}){const P=f,U=W.useForm,i=p(!1),c=p("添加团队成员"),t=V({user_name:"",nick_name:"",avatar:"",avatar_url:"",user_roles:"3",password:"",check_password:"",id:""}),O=h=>{t.avatar=h.file},x=p([]);ue({page:1,size:200,search:""}).then(h=>{let s=h.data.list||[];x.value=s.filter(B=>B.id!="1")});const u=V({user_name:[{message:"请输入登录账号",required:!0},{validator:async(h,s)=>!/^[a-zA-Z0-9_.-]+$/.test(s)&&s?Promise.reject("账号只能为字母、数字、“-”、“_”,“.”的组合"):Promise.resolve()}],nick_name:[{message:"请输入昵称",required:!0}],avatar_url:[{message:"请上传头像",required:!0}],user_roles:[{message:"请选择成员角色",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(h,s)=>!ve(s)&&s?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(h,s)=>s!=t.password&&s?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:S,validate:C,validateInfos:k}=U(t,u),A=()=>{c.value="添加团队成员",i.value=!0,S(),t.user_name="",t.nick_name="",t.avatar="",t.avatar_url=oe,t.user_roles="3",t.password="",t.check_password="",t.id=""},n=h=>{c.value="编辑团队成员",t.user_name=h.user_name,t.nick_name=h.nick_name,t.avatar_url=h.avatar||oe,t.avatar="",t.user_roles=h.user_roles,t.password="",t.check_password="",t.id=h.id,delete u.password,delete u.check_password,i.value=!0},l=p(!1),m=()=>{C().then(()=>{let h={...me(t)};delete h.avatar_url,l.value=!0,Ae(h).then(s=>{Q.success(`${c.value}成功`),i.value=!1,P("ok")}).finally(()=>{l.value=!1})})};return g({add:A,edit:n}),(h,s)=>{const B=fe,L=le,b=Ke,M=He,D=he,G=W,d=J;return r(),y("div",null,[e(d,{open:i.value,"onUpdate:open":s[6]||(s[6]=v=>i.value=v),title:c.value,onOk:m,width:"476px"},{default:a(()=>[o("div",it,[e(G,{layout:"vertical"},{default:a(()=>[e(L,q({label:"登录账号"},E(k).user_name),{default:a(()=>[e(B,{disabled:t.id!="",type:"text",placeholder:"账号只能为字母、数字、“-”、“_”,“.”的组合",value:t.user_name,"onUpdate:value":s[0]||(s[0]=v=>t.user_name=v)},null,8,["disabled","value"])]),_:1},16),e(L,q({label:"成员昵称"},E(k).nick_name),{default:a(()=>[e(B,{maxlength:100,type:"text",placeholder:"请输入昵称",value:t.nick_name,"onUpdate:value":s[1]||(s[1]=v=>t.nick_name=v)},null,8,["value"])]),_:1},16),e(L,{label:"成员头像"},{default:a(()=>[e(nt,{value:t.avatar_url,"onUpdate:value":s[2]||(s[2]=v=>t.avatar_url=v),onChange:O},null,8,["value"])]),_:1}),e(L,q({label:"成员角色"},E(k).user_roles),{default:a(()=>[e(M,{value:t.user_roles,"onUpdate:value":s[3]||(s[3]=v=>t.user_roles=v),style:{width:"100%"},placeholder:"请选择成员角色"},{default:a(()=>[(r(!0),y(Z,null,j(x.value,v=>(r(),T(b,{key:v.id,value:v.id},{default:a(()=>[F(w(v.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16),t.id?se("",!0):(r(),T(L,q({key:0,label:"登录密码"},E(k).password),{default:a(()=>[e(D,{value:t.password,"onUpdate:value":s[4]||(s[4]=v=>t.password=v),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16)),t.id?se("",!0):(r(),T(L,q({key:1,label:"确认密码"},E(k).check_password),{default:a(()=>[e(D,{value:t.check_password,"onUpdate:value":s[5]||(s[5]=v=>t.check_password=v),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16))]),_:1})])]),_:1},8,["open","title"])])}}},ut=K(rt,[["__scopeId","data-v-9931da5a"]]),dt={class:"form-box"},ct={__name:"reset-password",emits:["ok"],setup(I,{expose:g,emit:f}){const P=f,U=W.useForm,i=p(!1),c=p("重置登录密码"),t=V({password:"",check_password:"",id:""}),O=V({password:[{message:"请输入登录密码",required:!0},{validator:async(A,n)=>!ve(n)&&n?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(A,n)=>n!=t.password&&n?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:x,validate:u,validateInfos:S}=U(t,O),C=A=>{A.id,i.value=!0,x(),t.password="",t.check_password="",t.id=A.id},k=()=>{u().then(()=>{Le({...me(t)}).then(A=>{Q.success("修改成功"),i.value=!1,P("ok")})})};return g({open:C}),(A,n)=>{const l=he,m=le,h=W,s=J;return r(),y("div",null,[e(s,{open:i.value,"onUpdate:open":n[2]||(n[2]=B=>i.value=B),title:c.value,onOk:k,width:"476px"},{default:a(()=>[o("div",dt,[e(h,{layout:"vertical"},{default:a(()=>[e(m,q({label:"登录密码"},E(S).password),{default:a(()=>[e(l,{value:t.password,"onUpdate:value":n[0]||(n[0]=B=>t.password=B),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),e(m,q({label:"确认密码"},E(S).check_password),{default:a(()=>[e(l,{value:t.check_password,"onUpdate:value":n[1]||(n[1]=B=>t.check_password=B),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},_t=K(ct,[["__scopeId","data-v-d0706fa4"]]),pt={key:0,class:"form-wrapper"},mt={class:"select"},vt={class:"tools-wrapper"},ft=["src"],ht={class:"item-name"},gt={key:1,class:"form-wrapper"},yt={class:"select"},kt={class:"tools-wrapper"},bt={class:"item-name"},wt={key:2,class:"form-wrapper"},xt={class:"select"},Ct={class:"tools-wrapper"},At={class:"item-name"},Lt={__name:"see-model-alert",props:{robotList:{type:Array,default:null},libraryList:{type:Array,default:null},formList:{type:Array,default:null}},emits:["save"],setup(I,{expose:g,emit:f}){const P=f,U=I,i=p([]),c=p(""),t=p("");re();const O=p(!1),x=p([]),u=A=>{const n=[];return A.map(l=>{n.push(l.id)}),n},S=(A,n,l)=>{i.value=[],t.value=A,t.value==="robot"?(x.value=U.robotList,c.value="添加成员管理的机器人",n&&n==="edit"&&(c.value="编辑成员管理的机器人",l&&(i.value=u(l.managed_robot_list)))):t.value==="library"?(x.value=U.libraryList,c.value="添加成员管理的知识库",n&&n==="edit"&&(c.value="编辑成员管理的知识库",l&&(i.value=u(l.managed_library_list)))):t.value==="form"&&(x.value=U.formList,c.value="添加成员管理的数据库",n&&n==="edit"&&(c.value="编辑成员管理的数据库",l&&(i.value=u(l.managed_form_list)))),O.value=!0},C=()=>{O.value=!1,P("save",i.value)},k=()=>{};return g({open:S}),(A,n)=>{const l=ge,m=ye,h=J;return r(),T(h,{class:"add-model-alert",width:"800px",open:O.value,"onUpdate:open":n[3]||(n[3]=s=>O.value=s),title:c.value,onOk:C,onCancel:k},{default:a(()=>[t.value==="robot"?(r(),y("div",pt,[o("div",mt," 已选择("+w(i.value.length)+") ",1),e(m,{class:"list-box",value:i.value,"onUpdate:value":n[0]||(n[0]=s=>i.value=s)},{default:a(()=>[(r(!0),y(Z,null,j(x.value,s=>(r(),T(l,{class:"list-item",key:s.id,value:s.id},{default:a(()=>[o("div",vt,[o("img",{class:"model-logo",src:s.robot_avatar,alt:""},null,8,ft),o("div",ht,w(s.robot_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):t.value==="library"?(r(),y("div",gt,[o("div",yt," 已选择("+w(i.value.length)+") ",1),e(m,{class:"list-box",value:i.value,"onUpdate:value":n[1]||(n[1]=s=>i.value=s)},{default:a(()=>[(r(!0),y(Z,null,j(x.value,s=>(r(),T(l,{class:"list-item",key:s.id,value:s.id},{default:a(()=>[o("div",kt,[o("div",bt,w(s.library_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):t.value==="form"?(r(),y("div",wt,[o("div",xt," 已选择("+w(i.value.length)+") ",1),e(m,{class:"list-box",value:i.value,"onUpdate:value":n[2]||(n[2]=s=>i.value=s)},{default:a(()=>[(r(!0),y(Z,null,j(x.value,s=>(r(),T(l,{class:"list-item",key:s.id,value:s.id},{default:a(()=>[o("div",Ct,[o("div",At,w(s.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):se("",!0)]),_:1},8,["open","title"])}}},Ut=K(Lt,[["__scopeId","data-v-2db5dbba"]]),ee=I=>(_e("data-v-491219bf"),I=I(),pe(),I),St={class:"team-members-pages"},Ot={class:"list-box"},Mt={class:"user-box"},It=["src"],Pt={class:"name-info"},Bt={class:"user-name"},Ft={class:"nick-name"},Dt={key:0,class:"list-content"},Rt=ee(()=>o("div",null,"全部",-1)),Et=[Rt],zt={key:1,class:"list-content"},Tt=["onClick"],Gt={key:2,class:"list-preview list-content"},Nt={style:{display:"inline"}},$t={class:"list-item-box"},Kt={class:"list-item"},Ht=["onClick"],Xt={key:0,class:"list-content"},qt=ee(()=>o("div",null,"全部",-1)),Qt=[qt],Vt={key:1,class:"list-content"},Yt=["onClick"],Zt={key:2,class:"list-preview list-content"},jt={style:{display:"inline"}},Wt={class:"list-item-box"},Jt={class:"list-item"},ea=["onClick"],ta={key:0,class:"list-content"},aa=ee(()=>o("div",null,"全部",-1)),sa=[aa],oa={key:1,class:"list-content"},la=["onClick"],na={key:2,class:"list-preview list-content"},ia={style:{display:"inline"}},ra={class:"list-item-box"},ua={class:"list-item"},da=["onClick"],ca=ee(()=>o("span",{class:"disabled"},"编辑",-1)),_a=ee(()=>o("span",{class:"disabled"},"重置密码",-1)),pa=ee(()=>o("span",{class:"disabled"},"删除",-1)),ma=["onClick"],va=["onClick"],fa=["onClick"],ha={__name:"team-members",setup(I){const g=Ue();p(g.userInfo.user_id);const f=V({page:1,size:10,total:0,search:""}),P=p([]),U=p([]),i=p([]),c=p(""),t=p(""),O=p(null),x=d=>{f.page=d.current,f.size=d.pageSize,k()},u=()=>{f.page=1,k()},S=p([]),C=d=>{let v=[];return d.map(N=>{v.push(N.name)}),v.join(", ")},k=()=>{let d={page:f.page,size:f.size,search:f.search};Se(d).then(v=>{let N=v.data.list;N.forEach(z=>{z.create_time=ke(z.create_time*1e3).format("YYYY-MM-DD HH:mm"),z.managed_robot_list=z.managed_robot_list?JSON.parse(z.managed_robot_list):"",z.managed_library_list=z.managed_library_list?JSON.parse(z.managed_library_list):"",z.managed_form_list=z.managed_form_list?JSON.parse(z.managed_form_list):""}),S.value=N,f.total=+v.data.total})};u();const A=p(null),n=()=>{A.value.add()},l=d=>{A.value.edit(d)},m=p(null),h=d=>{m.value.open(d)},s=d=>{J.confirm({title:"提示?",icon:e(de),content:"确认删除该用户",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Oe({id:d.id}).then(v=>{Q.success("删除成功"),k()})},onCancel(){}})},B=async()=>{await Te().then(d=>{P.value=d.data}).catch(()=>{})},L=async()=>{await Ge().then(d=>{U.value=d.data}).catch(()=>{})},b=async()=>{await Ne().then(d=>{i.value=d.data}).catch(()=>{})},M=async(d,v)=>{d==="robot"?(await B(),c.value=d):d==="library"?(await L(),c.value=d):d==="form"&&(await b(),c.value=d),t.value=v.id,O.value.open(c.value)},D=async(d,v)=>{d==="robot"?(await B(),c.value=d):d==="library"?(await L(),c.value=d):d==="form"&&(await b(),c.value=d),t.value=v.id,O.value.open(c.value,"edit",v)},G=d=>{let v={user_id:t.value,t:c.value,id_list:d.join(",")};Me(v).then(N=>{Q.success("操作成功"),k()}).catch(()=>{})};return(d,v)=>{const N=ce,z=be,te=ie,$=we,H=Xe,R=Ie,Y=xe;return r(),y("div",St,[e(te,{justify:"space-between"},{default:a(()=>[e(N,{type:"primary",onClick:n},{icon:a(()=>[e(E(ne))]),default:a(()=>[F(" 添加团队成员 ")]),_:1}),e(z,{value:f.search,"onUpdate:value":v[0]||(v[0]=_=>f.search=_),placeholder:"输入成员账号或昵称搜索",style:{width:"288px"},onSearch:u},null,8,["value"])]),_:1}),o("div",Ot,[e(Y,{"data-source":S.value,pagination:{current:f.page,total:f.total,pageSize:f.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:x},{default:a(()=>[e($,{title:"成员名称","data-index":"user_name",width:"190px"},{default:a(({record:_})=>[o("div",Mt,[o("img",{src:_.avatar||E(oe),alt:""},null,8,It),o("div",Pt,[o("div",Bt,w(_.user_name),1),o("div",Ft,w(_.nick_name),1)])])]),_:1}),e($,{title:"角色","data-index":"role_name",width:"100px"},{default:a(({record:_})=>[F(w(_.role_name),1)]),_:1}),e($,{"data-index":"managed_robot_list",width:"200px"},{title:a(()=>[F(" 管理的机器人 "),e(H,null,{title:a(()=>[F("所有者和管理员可以创建和管理全部机器人，成员只能管理分配的机器人。")]),default:a(()=>[e(E(ae))]),_:1})]),default:a(({record:_})=>[_.role_type==1||_.role_type==2?(r(),y("div",Dt,Et)):_.managed_robot_list?(r(),y("div",Gt,[e(H,null,{title:a(()=>[o("div",Nt,w(C(_.managed_robot_list)),1)]),default:a(()=>[o("div",$t,[o("div",Kt,w(C(_.managed_robot_list)),1)])]),_:2},1024),o("div",{class:"list-highlight edit",onClick:X=>D("robot",_)},[e(R,{name:"edit"})],8,Ht)])):(r(),y("div",zt,[o("div",{class:"list-highlight",onClick:X=>M("robot",_)},"添加",8,Tt)]))]),_:1}),e($,{"data-index":"managed_library_list",width:"200px"},{title:a(()=>[F(" 管理的知识库 "),e(H,null,{title:a(()=>[F("所有者和管理员可以创建和管理全部知识库，成员只能管理分配的知识库。")]),default:a(()=>[e(E(ae))]),_:1})]),default:a(({record:_})=>[_.role_type==1||_.role_type==2?(r(),y("div",Xt,Qt)):_.managed_library_list?(r(),y("div",Zt,[e(H,null,{title:a(()=>[o("div",jt,w(C(_.managed_library_list)),1)]),default:a(()=>[o("div",Wt,[o("div",Jt,w(C(_.managed_library_list)),1)])]),_:2},1024),o("div",{class:"list-highlight edit",onClick:X=>D("library",_)},[e(R,{name:"edit"})],8,ea)])):(r(),y("div",Vt,[o("div",{class:"list-highlight",onClick:X=>M("library",_)},"添加",8,Yt)]))]),_:1}),e($,{"data-index":"managed_form_list",width:"200px"},{title:a(()=>[F(" 管理的数据库 "),e(H,null,{title:a(()=>[F("所有者和管理员可以创建和管理全部数据库，成员只能管理分配的数据库。")]),default:a(()=>[e(E(ae))]),_:1})]),default:a(({record:_})=>[_.role_type==1||_.role_type==2?(r(),y("div",ta,sa)):_.managed_form_list?(r(),y("div",na,[e(H,null,{title:a(()=>[o("div",ia,w(C(_.managed_form_list)),1)]),default:a(()=>[o("div",ra,[o("div",ua,w(C(_.managed_form_list)),1)])]),_:2},1024),o("div",{class:"list-highlight edit",onClick:X=>D("form",_)},[e(R,{name:"edit"})],8,da)])):(r(),y("div",oa,[o("div",{class:"list-highlight",onClick:X=>M("form",_)},"添加",8,la)]))]),_:1}),e($,{title:"创建时间","data-index":"create_time",width:"190px"},{default:a(({record:_})=>[F(w(_.create_time),1)]),_:1}),e($,{title:"操作","data-index":"action",width:"230px"},{default:a(({record:_})=>[_.role_type=="1"?(r(),T(te,{key:0,gap:16},{default:a(()=>[ca,_a,pa]),_:1})):(r(),T(te,{key:1,gap:16},{default:a(()=>[o("a",{onClick:X=>l(_)},"编辑",8,ma),o("a",{onClick:X=>h(_)},"重置密码",8,va),o("a",{onClick:X=>s(_)},"删除",8,fa)]),_:2},1024))]),_:1})]),_:1},8,["data-source","pagination"])]),e(ut,{ref_key:"addTeamMembersRef",ref:A,onOk:k},null,512),e(_t,{ref_key:"resetPasswordRef",ref:m,onOk:k},null,512),e(Ut,{ref_key:"seeModelAlertRef",ref:O,robotList:P.value,libraryList:U.value,formList:i.value,onSave:G},null,8,["robotList","libraryList","formList"])])}}},ga=K(ha,[["__scopeId","data-v-491219bf"]]),ya={class:"form-box"},ka={class:"title-row"},ba={class:"check-num"},wa={__name:"add-role",emits:["ok"],setup(I,{expose:g,emit:f}){const P=f,U=W.useForm,i=p([]),c=p({}),t=p(!1),O=p("添加角色"),x=p(""),u=V({name:"",mark:"",role_type:""}),S=V({name:[{message:"请输入角色名称",required:!0}]}),{resetFields:C,validate:k,validateInfos:A}=U(u,S),n=async()=>{await Pe().then(L=>{i.value=L.data;for(let b=0;b<L.data.length;b++){const M=L.data[b];c.value[M.uni_key]=[]}})},l=async()=>{await n(),O.value="添加角色",x.value="",t.value=!0,u.name="",u.mark="",C()},m=L=>{O.value="编辑角色",x.value=L.id,Be({id:L.id}).then(b=>{let M=b.data,D=M.role_permission||[];u.name=M.name,u.mark=M.mark,u.role_type=M.role_type,c.value=h(i.value,D),t.value=!0})},h=(L,b)=>{let M={};return L.forEach(D=>{M[D.uni_key]=[];for(let G=0;G<D.children.length;G++){const d=D.children[G];b.includes(d.uni_key)&&M[D.uni_key].push(d.uni_key)}}),M},s=L=>{let b=[];for(let M in L)L[M].map(G=>{b.push(G)});return b},B=()=>{k().then(()=>{let L=s(c.value),b={id:x.value,mark:u.mark};u.role_type==0&&(b.name=u.name,b.role_type=u.role_type,b.uni_keys=L.join(",")),Fe(b).then(M=>{t.value=!1,Q.success("保存成功"),P("ok")})})};return ze(()=>{n()}),g({add:l,edit:m}),(L,b)=>{const M=fe,D=le,G=qe,d=ie,v=ge,N=Qe,z=Ve,te=ye,$=W,H=J;return r(),y("div",null,[e(H,{open:t.value,"onUpdate:open":b[2]||(b[2]=R=>t.value=R),title:O.value,onOk:B,width:"746px"},{default:a(()=>[o("div",ya,[e($,{layout:"vertical"},{default:a(()=>[e(D,q({label:"角色名称"},E(A).name),{default:a(()=>[e(M,{type:"text",maxlength:100,disabled:u.role_type>0,placeholder:"请输入角色名称",value:u.name,"onUpdate:value":b[0]||(b[0]=R=>u.name=R)},null,8,["disabled","value"])]),_:1},16),e(D,{label:"角色备注"},{default:a(()=>[e(G,{value:u.mark,"onUpdate:value":b[1]||(b[1]=R=>u.mark=R),placeholder:"请输入角色备注"},null,8,["value"])]),_:1}),e(D,{label:"角色权限"},{default:a(()=>[(r(!0),y(Z,null,j(i.value,R=>(r(),y("div",{class:"role-check-box",key:R.uni_key},[e(d,{class:"title-boock",justify:"space-between"},{default:a(()=>[o("div",ka,w(R.name),1),o("div",ba,w(c.value[R.uni_key].length)+"/"+w(R.children.length),1)]),_:2},1024),e(te,{value:c.value[R.uni_key],"onUpdate:value":Y=>c.value[R.uni_key]=Y,style:{width:"100%"}},{default:a(()=>[e(z,{gutter:[0,12]},{default:a(()=>[(r(!0),y(Z,null,j(R.children,Y=>(r(),T(N,{span:6,key:Y.uni_key},{default:a(()=>[e(v,{disabled:u.role_type>0,value:Y.uni_key},{default:a(()=>[F(w(Y.name),1)]),_:2},1032,["disabled","value"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])]))),128))]),_:1})]),_:1})])]),_:1},8,["open","title"])])}}},xa=K(wa,[["__scopeId","data-v-93015f2b"]]),Ca={class:"team-members-pages"},Aa={class:"list-box"},La={__name:"role-permissions",setup(I){p("");const g=V({page:1,size:10,total:0,search:""}),f=p([{}]),P=u=>{g.page=u.current,g.size=u.pageSize,i()},U=()=>{g.page=1,i()},i=()=>{let u={page:g.page,size:g.size,search:g.search};ue(u).then(S=>{let C=S.data.list;C.forEach(k=>{k.update_time=ke(k.update_time*1e3).format("YYYY-MM-DD HH:mm")}),f.value=C,g.total=+S.data.total})};U();const c=p(null),t=()=>{c.value.add()},O=u=>{c.value.edit(u)},x=u=>{J.confirm({title:"提示?",icon:e(de),content:"确认删除该角色",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{De({id:u.id}).then(S=>{Q.success("删除成功"),i()})},onCancel(){}})};return(u,S)=>{const C=ce,k=be,A=ie,n=we,l=xe;return r(),y("div",Ca,[e(A,{justify:"space-between"},{default:a(()=>[e(C,{type:"primary",onClick:t},{icon:a(()=>[e(E(ne))]),default:a(()=>[F(" 添加角色 ")]),_:1}),e(k,{value:g.search,"onUpdate:value":S[0]||(S[0]=m=>g.search=m),placeholder:"输入角色名称",style:{width:"288px"},onSearch:U},null,8,["value"])]),_:1}),o("div",Aa,[e(l,{"data-source":f.value,pagination:{current:g.page,total:g.total,pageSize:g.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:P},{default:a(()=>[e(n,{title:"角色","data-index":"name",width:"157px"},{default:a(({record:m})=>[F(w(m.name),1)]),_:1}),e(n,{title:"备注","data-index":"mark",width:"480px"},{default:a(({record:m})=>[F(w(m.mark),1)]),_:1}),e(n,{title:"最近修改时间","data-index":"update_time",width:"150px"},{default:a(({record:m})=>[F(w(m.update_time),1)]),_:1}),e(n,{title:"最近修改人","data-index":"operate_name",width:"130px"},{default:a(({record:m})=>[F(w(m.operate_name),1)]),_:1}),e(n,{title:"创建人","data-index":"create_name",width:"130px"},{default:a(({record:m})=>[F(w(m.create_name),1)]),_:1}),e(n,{title:"操作","data-index":"action",width:"178px"},{default:a(({record:m})=>[e(A,{gap:16,class:"action-box"},{default:a(()=>[e(C,{type:"link",onClick:h=>O(m)},{default:a(()=>[F("编辑")]),_:2},1032,["onClick"]),e(C,{type:"link",onClick:h=>x(m),disabled:m.role_type<=3&&m.role_type>0},{default:a(()=>[F("删除")]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),e(xa,{ref_key:"addRoleRef",ref:c,onOk:i},null,512)])}}},Ua=K(La,[["__scopeId","data-v-5beb8d86"]]),Sa={class:"user-model-page"},Oa={class:"list-wrapper"},Ma={__name:"index",setup(I){const g=p(1),f=()=>{g.value};return(P,U)=>(r(),y("div",Sa,[e(We,{value:g.value,"onUpdate:value":U[0]||(U[0]=i=>g.value=i),onChange:f},null,8,["value"]),o("div",Oa,[g.value==1?(r(),T(ga,{key:0})):(r(),T(Ua,{key:1}))])]))}},Os=K(Ma,[["__scopeId","data-v-752bf84e"]]);export{Os as default};
