import{g as T,j as E}from"./index-CkBKI6U4.js";import{X as b,f as L,w as B,e as N,o as A,a1 as M,_ as m,a2 as _,Y as y,a9 as k,F as I,G,a7 as g,k as O,a5 as p,ae as V}from"./vue-chunks-yZ4gwLzA.js";import{b as D}from"../../index-ZzVqUZIR.js";import{bp as F,v as R,J as X,u as $}from"./ui-antd-BJtyvQX6.js";const w=b("model",()=>{const l=L([]);return{allModelList:l,getAllmodelList:async()=>{try{if(l.value.length==0){const t=await T();l.value=t.data}return l.value}catch(t){}}}});function j(l){let s=l||[],t={};return s.forEach(e=>{e.key=e.config_info.id,e.id=e.config_info.id,e.config_name=e.config_info.config_name,e.model_config_id=e.config_info.id,e.children=e.use_model_configs.map(o=>(o.thinking_type==2&&(t[e.config_info.id+"#"+o.use_model_name]=!0),{...o,key:e.config_info.id+"_"+o.use_model_name,value:e.config_info.id+"_"+o.use_model_name,model_config_id:e.config_info.id,name:o.use_model_name,label:o.show_model_name}))}),{newList:s,choosableThinking:t}}function W(l,s,t="LLM"){if(!l||!s)return"";let e=w();if(e.allModelList.length==0)return"";let o=e.allModelList;o=o.map(a=>({...a,use_model_configs:a.use_model_configs.filter(u=>u.model_type==t)}));let d=o.find(a=>a.config_info.id==l),n=null;return d&&(n=d.use_model_configs.find(a=>a.use_model_name==s)),n?`${d.config_info.config_name||d.config_info.show_model_name||d.model_name}  ${n.show_model_name||n.use_model_name}`:""}function Z(l,s,t="LLM"){if(!l||!s)return null;let e=w();if(e.allModelList.length==0)return null;let o=e.allModelList;o=o.map(a=>({...a,use_model_configs:a.use_model_configs.filter(u=>u.model_type==t)}));let d=o.find(a=>a.config_info.id==l),n=null;return d&&(n=d.use_model_configs.find(a=>a.use_model_name==s)),n||null}const q={key:0,class:"model-show-block"},J=["src"],K={class:"name-text"},Y=["src"],z={__name:"model-select",props:{modelType:{type:String,validator:l=>["TEXT EMBEDDING","RERANK","LLM","IMAGE"].includes(l),required:!0},modeName:{type:[String,Number],default:""},modeId:{type:[String,Number],default:""},placeholder:{type:String,default:"请选择嵌入模型"}},emits:["change","update:modeName","update:modeId","loaded"],setup(l,{emit:s}){const t=s,e=l,o=L();B([()=>e.modeId,()=>e.modeName],([i,r])=>{!i||!r?o.value=void 0:o.value=i+"-"+r},{immediate:!0});const d=L([]),n=N(()=>e.modeId?d.value.find(i=>i.key==e.modeId):{}),a=N(()=>n.value.children&&n.value.children.length?n.value.children.find(i=>i.use_model_name==e.modeName):{}),u=(i,r)=>{r&&(t("update:modeName",r.modelName),t("update:modeId",r.modelId),t("change",i,r))},S=()=>{E({model_type:e.modelType}).then(i=>{let r=i.data||[],{newList:h,choosableThinking:v}=j(r);d.value=h,t("loaded",d.value,v)})};return A(()=>{S(),e.modeId&&e.modeName&&(o.value=e.modeId+"-"+e.modeName)}),(i,r)=>{const h=X,v=R,C=F,x=$;return m(),M(x,{value:o.value,placeholder:l.placeholder,onChange:u,style:{width:"100%"},allowClear:!0,class:"modal-seclet-new"},{clearIcon:_(()=>[n.value?(m(),y("div",q,[p("img",{class:"icon",src:n.value.model_icon_url,alt:""},null,8,J),p("div",K,g(n.value.config_name||n.value.model_name)+" "+g(a.value.show_model_name||a.value.use_model_name),1)])):V("",!0)]),default:_(()=>[(m(!0),y(I,null,k(d.value,f=>(m(),M(C,{key:f.key},{label:_(()=>[O(h,{align:"center",gap:6},{default:_(()=>[p("img",{class:"model-icon",src:f.model_icon_url,alt:""},null,8,Y),p("span",null,g(f.config_name||f.model_name),1)]),_:2},1024)]),default:_(()=>[(m(!0),y(I,null,k(f.children,c=>(m(),M(v,{value:c.value,modelId:c.model_config_id,modelName:c.name,key:c.key,attrs:c},{default:_(()=>[G(g(c.show_model_name||c.name),1)]),_:2},1032,["value","modelId","modelName","attrs"]))),128))]),_:2},1024))),128))]),_:1},8,["value","placeholder"])}}},ee=D(z,[["__scopeId","data-v-5d5b73b9"]]);export{ee as M,Z as a,j as b,W as g,w as u};
