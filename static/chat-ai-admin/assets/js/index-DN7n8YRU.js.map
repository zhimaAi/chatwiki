{"version":3,"file":"index-DN7n8YRU.js","sources":["../../../../front-end/chat-ai-admin-vue/src/api/trigger/index.js","../../../../front-end/chat-ai-admin-vue/src/stores/modules/workflow.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/page-sidebar.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/custom-control/zoom-select.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-list-popup/trigger-list.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-list-popup/workflow-list.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-list-popup/http-tool-list.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-list-popup/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/custom-control/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/node-form-layout.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/node-form-header.vue","../../../../front-end/chat-ai-admin-vue/src/assets/img/workflow/global-variable.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/start-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/at-input/cascade-panel.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/at-input/at-input.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/problem-optimization-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/at-input/full-at-input.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/ai-dialogue-node-from.vue","../../../../front-end/chat-ai-admin-vue/src/assets/img/workflow/input.svg","../../../../front-end/chat-ai-admin-vue/src/stores/modules/data-table.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/field-selector/field-select-alert.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/field-selector/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/database-selector/table-select-alert.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/database-selector/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/add-data-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/library-select-alert.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/knowledge-base-node/recall-settings-alert.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/knowledge-base-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/code-run-node/subs-key.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/code-run-node/code-edit-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/code-run-node/run-test.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/code-run-node/code-run-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/http-node/add-authentication-modal.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/http-node/run-test.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/http-node/http-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/http-tool-node/subs-key.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/http-tool-node/parse-curl-modal.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/http-tool-node/add-authentication-modal.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/http-tool-node/http-tool-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/constants/database.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/query-condition-filter.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/delete-data-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/variable-assignment-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/update-data-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/parameter-extraction-form/add-params-modal.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/parameter-extraction-form/subs-key.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/parameter-extraction-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/assets/img/workflow/output.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/collapse-panel.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/sort-selector/field-select-alert.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/sort-selector/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/output-fields.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/select-data-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/question-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/judge-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/specify-reply-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/immediately-reply-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/mcp-form.vue","../../../../front-end/chat-ai-admin-vue/src/assets/svg/loop-icon.svg","../../../../front-end/chat-ai-admin-vue/src/assets/svg/loop-2.svg","../../../../front-end/chat-ai-admin-vue/src/assets/svg/loop-3.svg","../../../../front-end/chat-ai-admin-vue/src/assets/svg/output.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/image-logs/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/custom-group-node/components/run-test.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/custom-group-node/custom-group-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/feishu-table/field-selector/field-select-alert.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/feishu-table/field-selector/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/at-input/at-full-input.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-insert-data.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-update-data.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-del-data.vue","../../../../front-end/chat-ai-admin-vue/src/constants/feishu-table.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/feishu-table/query-condition-filter.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/feishu-table/sort-selector/field-select-alert.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/feishu-table/sort-selector/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-search-data.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/feishu-table/output-fields.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-batch-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-create-bitable.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-create-table.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-create-view.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-add-members.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-update-advanced.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/feishu-bittable/feishu-bittable-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/pluginFormRender.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-account/official-account-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-account/official-template-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-account/official-tag-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/data-table/reply-select/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-send-message/reply-data.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-send-message/official-send-message-box.vue","../../../../front-end/chat-ai-admin-vue/src/assets/img/workflow/setting-icon.svg","../../../../front-end/chat-ai-admin-vue/node_modules/slate/node_modules/is-plain-object/dist/is-plain-object.mjs","../../../../front-end/chat-ai-admin-vue/node_modules/immer/dist/immer.esm.mjs","../../../../front-end/chat-ai-admin-vue/node_modules/slate/dist/index.es.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-draft/components/draft-news-cont.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-draft/components/draft-newspic-cont.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-draft/official-draft-store.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-draft/official-draft-operate.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-draft/official-draft-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/dynamic-api/output-fields.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/dynamic-api/components/ding-login-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/dynamic-api/components/ding-table-select.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/dynamic-api/field-list.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/dynamic-api/dynamic-api-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/http-tool/http-tool-box.vue","../../../../front-end/chat-ai-admin-vue/src/components/common/qrcode-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/official-account/official-article-box.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/zm-plugins-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/session-trigger-form.vue","../../../../front-end/chat-ai-admin-vue/src/assets/svg/alarm-clock.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/timing-trigger-node/timing-trigger-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/assets/svg/wx-app-icon.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/official-trigger-node/official-trigger-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/assets/svg/execute.svg","../../../../front-end/chat-ai-admin-vue/src/assets/svg/execute_array.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/batch-group-node/components/run-test.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/batch-group-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/end-node-form/subs-key.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/end-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/constants/voice.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/voice-clone-form.vue","../../../../front-end/chat-ai-admin-vue/src/api/node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/components/select-voice-modal.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/voice-synthesis-form.vue","../../../../front-end/chat-ai-admin-vue/src/assets/svg/system-setting.svg","../../../../front-end/chat-ai-admin-vue/src/assets/svg/input.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/image-generation-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/explain-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/webhook-trigger-node-form/add-key-modal.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/webhook-trigger-node-form/subs-key.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/webhook-trigger-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/import-library-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/json-node-form/subs-key.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/json-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/json-reverse-node-form/subs-key.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/json-reverse-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/assets/img/robot/menu-guide.png","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/qa-node-form/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/zm-workflow-node-form.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/node-form-drawer/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/plugins/elk/elk.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/plugins/group-auto-resize/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/edges/custom-line/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/edges/custom-line/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/edges/custom-bezier/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/edges/custom-bezier/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/plugins/context-pad/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/plugins/context-pad/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/plugins/canvas-history/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/plugins/custom-keyboard/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/base-node.js","../../../../front-end/chat-ai-admin-vue/src/assets/img/workflow/node-menu-btn.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/base-node.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/session-trigger-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/session-trigger-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/start-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/start-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/model-name-text.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/user-question-text.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/question-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/question-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/action-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/action-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/at-input/at-text.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/qa-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/qa-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/ai-dialogue-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/ai-dialogue-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/http-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/http-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/http-tool-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/http-tool-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/knowledge-base-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/knowledge-base-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/end-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/end-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/explain-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/explain-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/variable-assignment-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/variable-assignment-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/judge-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/judge-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/specify-reply-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/specify-reply-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/immediately-reply-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/immediately-reply-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/parameter-extraction-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/parameter-extraction-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/problem-optimization-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/problem-optimization-node/index.js","../../../../front-end/chat-ai-admin-vue/src/assets/img/workflow/arrow-right.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/add-data-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/add-data-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/update-data-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/update-data-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/delete-data-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/delete-data-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/select-data-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/select-data-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/code-run-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/code-run-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/mcp-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/mcp-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/zm-plugins-node/components/feishu-table-render.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/zm-plugins-node/components/official-send-message-render.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/zm-plugins-node/components/dynamic-render.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/zm-plugins-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/zm-plugins-node/index.js","../../../../front-end/chat-ai-admin-vue/src/assets/svg/custom-group-node.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/custom-group-node/components/border-line.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/custom-group-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/custom-group-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/group-start-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/group-start-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/terminate-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/terminate-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/timing-trigger-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/timing-trigger-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/official-trigger-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/official-trigger-node/index.js","../../../../front-end/chat-ai-admin-vue/src/assets/svg/batch-group-node.svg","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/batch-group-node/components/border-line.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/batch-group-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/batch-group-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/image-generation-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/image-generation-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/json-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/json-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/json-reverse-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/json-reverse-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/voice-synthesis-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/voice-synthesis-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/voice-clone-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/voice-clone-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/webhook-trigger-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/webhook-trigger-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/import-library-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/import-library-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/zm-workflow-node/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/zm-workflow-node/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/nodes/index.js","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/workflow-canvas.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/run-test/index.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/page-header.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/version-model.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/components/publish-detail.vue","../../../../front-end/chat-ai-admin-vue/src/views/workflow/index.vue"],"sourcesContent":["import request from '@/utils/http/axios'\r\n\r\nexport function getTriggerConfigList(params = {}) {\r\n  return request.get({url: '/manage/getTriggerConfigList', params})\r\n}\r\n\r\nexport function getTriggerOfficialMessage(params = {}) {\r\n  return request.get({url: '/manage/getTriggerOfficialMessage', params})\r\n}","import { defineStore } from 'pinia'\r\nimport { reactive, ref } from 'vue'\r\nimport { getTriggerConfigList, getTriggerOfficialMessage } from '@/api/trigger/index'\r\nimport { getLibraryList } from '@/api/library/index'\r\nexport const useWorkflowStore = defineStore('workflow', () => {\r\n  const triggerList = ref([])\r\n  const officialList = ref([])\r\n  const triggerOfficialList = ref([])\r\n  const libraryLists = ref([])\r\n\r\n  const getTriggerList = async (robot_key, isRefresh) => {\r\n    try {\r\n      if (triggerList.value.length === 0 || isRefresh) {\r\n        const res = await getTriggerConfigList({ robot_key })\r\n        triggerList.value = res.data.map((item) => {\r\n          item.subMenus = []\r\n          item.expend = false\r\n          if (item.trigger_type == 4) {\r\n            item.subMenus = [\r\n              {\r\n                title: '私信消息',\r\n                value: 'message'\r\n              },\r\n              {\r\n                title: '关注/取消关注事件',\r\n                value: 'subscribe_unsubscribe'\r\n              },\r\n              {\r\n                title: '扫描带参数二维码事件',\r\n                value: 'qrcode_scan'\r\n              },\r\n              {\r\n                title: '自定义菜单事件',\r\n                value: 'menu_click'\r\n              }\r\n            ]\r\n          }\r\n          return item\r\n        })\r\n      }\r\n\r\n      return triggerList.value\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  const getTriggerOfficialMsg = (robot_key) => {\r\n    getTriggerOfficialMessage({ robot_key }).then((res) => {\r\n      triggerOfficialList.value = res.data.messages || []\r\n      officialList.value = res.data.apps || []\r\n    })\r\n  }\r\n\r\n\r\n  const getAllLibraryList = () => {\r\n    getLibraryList().then((res) => {\r\n      libraryLists.value = res.data\r\n    })\r\n  }\r\n\r\n  return {\r\n    triggerList,\r\n    getTriggerList,\r\n    officialList,\r\n    getTriggerOfficialMsg,\r\n    triggerOfficialList,\r\n    getAllLibraryList,\r\n    libraryLists,\r\n  }\r\n})\r\n","<style lang=\"less\" scoped>\r\n.sidebar-wrapper {\r\n  position: relative;\r\n  height: 100%;\r\n  width: 256px;\r\n  border-radius: 6px;\r\n  z-index: 10;\r\n  background: none;\r\n  transition: width 0.2s ease;\r\n  background-color: #fff;\r\n  box-shadow: 4px 0 8px 0 rgba(0, 0, 0, 0.04);\r\n\r\n  &:hover {\r\n    .sidebar-handle {\r\n      opacity: 1;\r\n    }\r\n  }\r\n\r\n  .sidebar-handle-wrapper {\r\n    position: absolute;\r\n    top: 0;\r\n    right: -18px;\r\n    width: 18px;\r\n    height: 100%;\r\n    z-index: 100;\r\n  }\r\n  .sidebar-handle {\r\n    position: absolute;\r\n    right: 0;\r\n    top: 50%;\r\n    width: 12px;\r\n    height: 26px;\r\n    transform: translateY(-50%);\r\n    cursor: pointer;\r\n    transition: all 0.2s ease;\r\n    opacity: 0;\r\n\r\n    .handle-line {\r\n      position: absolute;\r\n      width: 4px;\r\n      height: 13px;\r\n      left: 4px;\r\n      position: absolute;\r\n      transition: all 0.2s ease;\r\n      background-color: #bfbfbf;\r\n    }\r\n\r\n    .handle-line01 {\r\n      top: 0;\r\n      border-top-left-radius: 4px;\r\n      border-top-right-radius: 4px;\r\n      transform-origin: 50% 0;\r\n    }\r\n\r\n    .handle-line02 {\r\n      bottom: 0;\r\n      border-bottom-left-radius: 4px;\r\n      border-bottom-right-radius: 4px;\r\n      transform-origin: 50% 100%;\r\n    }\r\n  }\r\n\r\n  .sidebar-handle:hover {\r\n    .handle-line01 {\r\n      background-color: #595959;\r\n      transform: rotate(18deg) translateY(0);\r\n      border-top-left-radius: 4px;\r\n      border-top-right-radius: 4px;\r\n      border-bottom-left-radius: 10px;\r\n      height: 16px;\r\n    }\r\n\r\n    .handle-line02 {\r\n      background-color: #595959;\r\n      transform: rotate(-18deg) translateY(0);\r\n      border-bottom-left-radius: 4px;\r\n      border-bottom-right-radius: 4px;\r\n      border-top-left-radius: 10px;\r\n      height: 16px;\r\n    }\r\n  }\r\n\r\n  .sidebar-container {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    padding: 16px;\r\n    border-radius: 6px;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .sidebar-menus {\r\n    .sidebar-menu {\r\n      display: flex;\r\n      align-items: center;\r\n      height: 40px;\r\n      line-height: 40px;\r\n      padding: 0 12px;\r\n      border-radius: 4px;\r\n      margin-bottom: 4px;\r\n\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n\r\n      &:hover {\r\n        cursor: pointer;\r\n        background-color: #f0f0f0;\r\n      }\r\n\r\n      &.active {\r\n        background-color: #e6efff;\r\n\r\n        .menu-name,\r\n        .menu-icon {\r\n          color: #2475fc;\r\n        }\r\n      }\r\n\r\n      .menu-icon {\r\n        width: 16px;\r\n        height: 16px;\r\n        color: #a1a7b3;\r\n      }\r\n\r\n      .menu-name {\r\n        flex: 1;\r\n        margin-left: 12px;\r\n        font-size: 14px;\r\n        color: #595959;\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.sidebar-wrapper.is-hide {\r\n  width: 72px;\r\n\r\n  .sidebar-handle {\r\n    opacity: 1 !important;\r\n  }\r\n\r\n  .sidebar-handle:hover {\r\n    .handle-line01 {\r\n      background-color: #595959;\r\n      transform: rotate(-18deg) translateY(0);\r\n      border-bottom-left-radius: 4px;\r\n      border-bottom-right-radius: 4px;\r\n      border-top-left-radius: 10px;\r\n      height: 16px;\r\n    }\r\n\r\n    .handle-line02 {\r\n      background-color: #595959;\r\n      transform: rotate(18deg) translateY(0);\r\n      border-top-left-radius: 4px;\r\n      border-top-right-radius: 4px;\r\n      border-bottom-left-radius: 10px;\r\n      height: 16px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"sidebar-wrapper\" :class=\"{ 'is-hide': sidebarHide }\">\r\n    <div class=\"sidebar-handle-wrapper\" v-if=\"showSidebarBtn\">\r\n      <a-tooltip\r\n        :mouseEnterDelay=\"0\"\r\n        :mouseLeaveDelay=\"0\"\r\n        placement=\"right\"\r\n        v-model:open=\"handleTooltipShow\"\r\n        :arrow=\"false\"\r\n      >\r\n        <template #title>{{ sidebarHide ? t('tooltip_expand') : t('tooltip_collapse') }}</template>\r\n        <span class=\"sidebar-handle\" @click=\"onHandleClick\">\r\n          <span class=\"handle-line handle-line01\"></span>\r\n          <span class=\"handle-line handle-line02\"></span>\r\n        </span>\r\n      </a-tooltip>\r\n    </div>\r\n\r\n    <div class=\"sidebar-container\">\r\n      <div class=\"sidebar-menus\">\r\n        <template v-for=\"item in menus\" :key=\"item.value\">\r\n          <cu-tooltip :disabled=\"!sidebarHide\" :title=\"item.label\" placement=\"bottom\">\r\n            <div\r\n              class=\"sidebar-menu\"\r\n              :class=\"{ active: activeMenuKey == item.value }\"\r\n              @click=\"onMenuClick(item)\"\r\n            >\r\n              <svg-icon :name=\"item.iconName\" class=\"menu-icon\" size=\"16\"></svg-icon>\r\n              <span class=\"menu-name\">{{ item.label }}</span>\r\n           </div>\r\n          </cu-tooltip>\r\n        </template>\r\n        \r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useGlobalStore } from '@/stores/modules/global'\r\nimport CuTooltip from '@/components/cu-tooltip/index.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.page-sidebar')\r\n\r\nconst globalStore = useGlobalStore()\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst activeMenuKey = computed(() => route.path.split('/')[3])\r\nconst sidebarHide = ref(true)\r\n\r\n\r\nconst handleTooltipShow = ref(true)\r\nfunction onHandleClick() {\r\n  sidebarHide.value = !sidebarHide.value\r\n  handleTooltipShow.value = false\r\n  globalStore.setHideLayoutTopAndBottom(sidebarHide.value)\r\n}\r\n\r\nconst props = defineProps({\r\n  showSidebarBtn: {\r\n    default: true,\r\n    type: Boolean\r\n  }\r\n})\r\n\r\nconst menus = computed(() => [\r\n  {\r\n    label: t('menu_workflow'),\r\n    value: 'workflow',\r\n    path: '/robot/config/workflow',\r\n    iconName: 'workflow'\r\n  },\r\n  // {\r\n  //   label: '基础配置',\r\n  //   value: 'basic-config',\r\n  //   path: '/robot/config/basic-config',\r\n  //   iconName: 'jichupeizhi'\r\n  // },\r\n  {\r\n    label: t('menu_external_services'),\r\n    value: 'external-services',\r\n    path: '/robot/config/external-services',\r\n    iconName: 'duiwaifuwu'\r\n  },\r\n  {\r\n    label: t('menu_chat_test'),\r\n    value: 'test',\r\n    path: '/robot/test',\r\n    iconName: 'liaotianceshi',\r\n    isNewWindowOpen: true\r\n  },\r\n  // {\r\n  //   label: '功能中心',\r\n  //   value: 'function-center',\r\n  //   path: '/robot/config/function-center',\r\n  //   iconName: 'function-center'\r\n  // },\r\n  {\r\n    label: t('menu_qa_feedback'),\r\n    value: 'qa-feedbacks',\r\n    path: '/robot/config/qa-feedbacks',\r\n    iconName: 'qa-feedback'\r\n  },\r\n  {\r\n    label: t('menu_session_record'),\r\n    value: 'session-record',\r\n    path: '/robot/config/session-record',\r\n    iconName: 'session-record'\r\n  },\r\n  {\r\n    label: t('menu_api_key_manage'),\r\n    value: 'api-key-manage',\r\n    path: '/robot/config/api-key-manage',\r\n    iconName: 'duiwaifuwu'\r\n  },\r\n  // {\r\n  //   label: '未知问题',\r\n  //   value: 'unknown_issue',\r\n  //   path: '/robot/config/unknown_issue',\r\n  //   iconName: 'unknown-issue'\r\n  // },\r\n  {\r\n    label: t('menu_statistical_analysis'),\r\n    value: 'statistical_analysis',\r\n    path: '/robot/config/statistical_analysis',\r\n    iconName: 'statistical-analysis'\r\n  },\r\n  {\r\n    label: t('menu_export_record'),\r\n    value: 'export-record',\r\n    path: '/robot/config/export-record',\r\n    iconName: 'export-record'\r\n  },\r\n  {\r\n    label: t('menu_invoke_logs'),\r\n    value: 'invoke-logs',\r\n    path: '/robot/config/invoke-logs',\r\n    iconName: 'doc-file'\r\n  }\r\n])\r\n\r\nconst onMenuClick = (item) => {\r\n  if(item.isNewWindowOpen){\r\n    window.open(`/#${item.path}?robot_key=${route.query.robot_key}&id=${route.query.id}`)\r\n    return\r\n  }\r\n  router.push({\r\n    path: item.path,\r\n    query: route.query\r\n  })\r\n}\r\n\r\nonMounted(()=>{\r\n  setTimeout(()=>{\r\n    handleTooltipShow.value = false\r\n  },3000)\r\n})\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.zoom-select {\r\n  position: relative;\r\n  margin: 0 4px;\r\n\r\n  .zoom-select-label {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 80px;\r\n    height: 32px;\r\n    border-radius: 6px;\r\n    transition: all 0.2s;\r\n    .zoom-select-input{\r\n      width: 100%;\r\n      height: 100%;\r\n      border: none;\r\n      outline: none;\r\n      text-align: center;\r\n      font-size: 14px;\r\n      color: #595959;\r\n    }\r\n  }\r\n\r\n  .zoom-select-options {\r\n    position: absolute;\r\n    bottom: 48px;\r\n    left: 0;\r\n    padding: 2px;\r\n    font-size: 14px;\r\n    border-radius: 6px;\r\n    color: #595959;\r\n    background-color: #fff;\r\n    box-shadow:\r\n      0 6px 30px 5px #0000000d,\r\n      0 16px 24px 2px #0000000a,\r\n      0 8px 10px -5px #00000014;\r\n  }\r\n  .zoom-select-option {\r\n    width: 77px;\r\n    height: 32px;\r\n    line-height: 32px;\r\n    margin-bottom: 2px;\r\n    border-radius: 6px;\r\n    color: #595959;\r\n    text-align: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s;\r\n\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n\r\n  .option-line {\r\n    border-bottom: 1px solid #f0f0f0;\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .zoom-select-label:hover,\r\n  .zoom-select-option:hover {\r\n    background-color: #e4e6eb;\r\n    cursor: pointer;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"zoom-select\">\r\n    <div class=\"zoom-select-label\" @click.stop=\"\">\r\n      <input class=\"zoom-select-input\" type=\"text\" v-model=\"currentValue\" @input=\"handleInput\" @focus=\"showMenu\" @blur=\"handleBlur\">\r\n    </div>\r\n    <div class=\"zoom-select-options\" v-show=\"isShowMenu\">\r\n      <div\r\n        class=\"zoom-select-option\"\r\n        v-for=\"item in menus\"\r\n        :key=\"item.value\"\r\n        @click=\"handleMenu(item)\"\r\n      >\r\n        {{ item.label }}\r\n      </div>\r\n      <div class=\"option-line\"></div>\r\n      <div class=\"zoom-select-option\" @click=\"handleFitView()\">{{ t('btn_fit_view') }}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'NodeCommon',\r\n  props: {\r\n    modelValue: {\r\n      type: Number,\r\n      default: 100,\r\n    },\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.custom-control.zoom-select')\r\n    return { t }\r\n  },\r\n  data() {\r\n    return {\r\n      isShowMenu: false,\r\n      currentValue: `${this.modelValue}%`,\r\n      previousValue: this.modelValue,\r\n      debounceTimer: null,\r\n      menus: [\r\n        { label: '10%', value: 10 },\r\n        { label: '50%', value: 50 },\r\n        { label: '80%', value: 80 },\r\n        { label: '100%', value: 100 },\r\n        { label: '150%', value: 150 },\r\n        { label: '200%', value: 200 },\r\n        { label: '400%', value: 400 },\r\n      ],\r\n    }\r\n  },\r\n  watch: {\r\n    modelValue(newValue) {\r\n      // 当 modelValue 从外部（如父组件）改变时，更新输入框的显示\r\n      // 检查以避免在内部输入时发生不必要的循环更新\r\n      if (newValue !== parseInt(this.currentValue.replace(/[^\\d]/g, ''), 10)) {\r\n        this.currentValue = `${newValue}%`\r\n        this.previousValue = newValue\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    document.addEventListener('click', this.documentClick)\r\n  },\r\n  beforeUnmount() {\r\n    document.removeEventListener('click', this.documentClick)\r\n  },\r\n  methods: {\r\n    handleMenu(item) {\r\n      this.$emit('update:modelValue', item.value)\r\n      this.$emit('zoom-change', item.value)\r\n      this.isShowMenu = false\r\n    },\r\n    showMenu() {\r\n      this.isShowMenu = !this.isShowMenu\r\n    },\r\n    handleFitView() {\r\n      this.isShowMenu = false\r\n      this.$emit('fitView')\r\n    },\r\n    handleInput() {\r\n      clearTimeout(this.debounceTimer)\r\n      this.debounceTimer = setTimeout(() => {\r\n        // 提取有效数字\r\n        const inputText = this.currentValue.replace('%', '').trim()\r\n        const numberPart = parseInt(inputText.replace(/[^\\d]/g, ''), 10)\r\n        \r\n        if (!inputText) {\r\n          // 空白输入时，显示当前有效值\r\n          this.currentValue = `${this.previousValue}%`\r\n          return\r\n        }\r\n        \r\n        if (isNaN(numberPart)) {\r\n          // 无有效数字，立即恢复显示\r\n          this.currentValue = `${this.previousValue}%`\r\n          return\r\n        }\r\n        \r\n        // 数字超出范围时，自动修正\r\n        let validValue = numberPart\r\n        if (validValue > 800) validValue = 800\r\n        if (validValue < 1) validValue = 1\r\n        \r\n        // 即时显示修正后的值\r\n        this.currentValue = `${validValue}%`\r\n        \r\n        // 发射事件\r\n        this.previousValue = validValue  // 更新记忆值\r\n        this.$emit('update:modelValue', validValue)\r\n        this.$emit('zoom-change', validValue)\r\n      }, 300)\r\n    },\r\n    handleBlur() {\r\n      clearTimeout(this.debounceTimer)\r\n      \r\n      const numberPart = parseInt(this.currentValue.replace(/[^\\d]/g, ''), 10)\r\n      \r\n      // 尝试使用最终输入值\r\n      if (!isNaN(numberPart) && numberPart >= 1 && numberPart <= 800) {\r\n        this.$emit('update:modelValue', numberPart)\r\n        this.$emit('zoom-change', numberPart)\r\n        this.currentValue = `${numberPart}%`\r\n        this.previousValue = numberPart\r\n      } else {\r\n        // 恢复显示为记忆的有效值\r\n        this.currentValue = `${this.previousValue}%`\r\n      }\r\n    },\r\n    documentClick(e) {\r\n      if (this.isShowMenu) {\r\n        const menus = this.$el.querySelector('.zoom-select-options')\r\n        if (\r\n          !menus.contains(e.target) &&\r\n          e.target !== this.$el.querySelector('.zoom-select-label')\r\n        ) {\r\n          this.isShowMenu = false\r\n        }\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.trigger-list-box {\r\n  .search-box {\r\n    margin: 0 8px 8px;\r\n  }\r\n\r\n  .trigger-list {\r\n    .trigger-item {\r\n      .trigger-info {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 4px 8px;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n      }\r\n\r\n      .avatar {\r\n        width: 20px;\r\n        height: 20px;\r\n        flex-shrink: 0;\r\n        border-radius: 4px;\r\n        margin-right: 8px;\r\n      }\r\n      .right-icon {\r\n        margin-left: auto;\r\n        color: #8c8c8c;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n      }\r\n    }\r\n  }\r\n  .sub-menu-list {\r\n    margin-left: 34px;\r\n    border-left: 1px solid #d9d9d9;\r\n    padding-left: 6px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 2px;\r\n    .sub-item {\r\n      height: 26px;\r\n      display: flex;\r\n      align-items: center;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n  .empty-box {\r\n    text-align: center;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"trigger-list-box\">\r\n    <div class=\"search-box\" @click.stop=\"\">\r\n      <a-input-search v-model:value.trim=\"keyword\" allowClear :placeholder=\"t('ph_search_by_name')\" />\r\n    </div>\r\n    <template v-if=\"triggerList.length\">\r\n      <div class=\"trigger-list\">\r\n        <div\r\n          class=\"trigger-item\"\r\n          v-for=\"item in triggerList\"\r\n          @click=\"handleAddNode(item)\"\r\n          :key=\"item.type\"\r\n        >\r\n          <div class=\"trigger-info\">\r\n            <img class=\"avatar\" :src=\"item.trigger_icon\" />\r\n            <div class=\"info\">\r\n              <span class=\"name\">{{ item.trigger_name }}</span>\r\n            </div>\r\n            <div class=\"right-icon\" v-if=\"item.subMenus && item.subMenus.length\">\r\n              <DownOutlined v-if=\"item.expend\" /> <RightOutlined v-else />\r\n            </div>\r\n          </div>\r\n          <div class=\"sub-menu-list\" v-if=\"item.expend && item.subMenus && item.subMenus.length\">\r\n            <div\r\n              class=\"sub-item\"\r\n              @click.stop=\"handleSubClick(item, sub)\"\r\n              v-for=\"sub in item.subMenus\"\r\n              :key=\"sub.value\"\r\n            >\r\n              {{ sub.title }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- <a class=\"more-link\" href=\"/#/plugins/index?active=2\" target=\"_blank\">{{ t('btn_more_plugins') }}\r\n        <RightOutlined />\r\n      </a> -->\r\n    </template>\r\n    <div v-else class=\"empty-box\">\r\n      <img style=\"height: 200px\" src=\"@/assets/empty.png\" />\r\n      <div>{{ t('msg_no_plugins') }}</div>\r\n      <a href=\"/#/plugins/index?active=2\" target=\"_blank\"\r\n        >{{ t('btn_add_now') }}\r\n        <RightOutlined />\r\n      </a>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { createTriggerNode } from '../node-list'\r\nimport { ref, computed } from 'vue'\r\nimport { useWorkflowStore } from '@/stores/modules/workflow'\r\nimport { RightOutlined, DownOutlined } from '@ant-design/icons-vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-list-popup.index')\r\n\r\nconst emit = defineEmits(['add'])\r\n\r\nconst workflowStore = useWorkflowStore()\r\nconst triggerOfficialList = computed(() => workflowStore.triggerOfficialList)\r\n\r\n// 触发器列表\r\nconst keyword = ref('')\r\nconst triggerList = computed(() => {\r\n  let list = workflowStore.triggerList\r\n  if (keyword.value) {\r\n    return list.filter((item) => item.trigger_name.includes(keyword.value))\r\n  }\r\n  return list\r\n})\r\n\r\nconst handleAddNode = (item) => {\r\n  if (item.subMenus && item.subMenus.length) {\r\n    item.expend = !item.expend\r\n    return\r\n  }\r\n  let node = createTriggerNode(item)\r\n  emit('add', node)\r\n}\r\n\r\nconst handleSubClick = (item, sub) => {\r\n  if (item.trigger_type == 4) {\r\n    item.trigger_official_config.msg_type = sub.value\r\n\r\n    item.outputs = triggerOfficialList.value.find((item) => item.msg_type == sub.value).fields\r\n  }\r\n  let node = createTriggerNode(item)\r\n\r\n  emit('add', node)\r\n}\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.trigger-list-box {\r\n  .search-box {\r\n    margin: 0 8px 8px;\r\n  }\r\n\r\n  .trigger-list {\r\n    .trigger-item {\r\n      &:hover {\r\n        background: #e4e6eb;\r\n        border-radius: 6px;\r\n      }\r\n      .trigger-info {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 4px 8px;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n      }\r\n\r\n      .avatar {\r\n        width: 20px;\r\n        height: 20px;\r\n        flex-shrink: 0;\r\n        border-radius: 4px;\r\n        margin-right: 8px;\r\n      }\r\n\r\n      .right-icon {\r\n        margin-left: auto;\r\n        color: #8c8c8c;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n      }\r\n    }\r\n  }\r\n\r\n  .sub-menu-list {\r\n    margin-left: 34px;\r\n    border-left: 1px solid #d9d9d9;\r\n    padding-left: 6px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 2px;\r\n\r\n    .sub-item {\r\n      height: 26px;\r\n      display: flex;\r\n      align-items: center;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  .empty-box {\r\n    text-align: center;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"trigger-list-box\">\r\n    <div class=\"search-box\" @click.stop=\"\">\r\n      <a-input-search v-model:value.trim=\"keyword\" allowClear :placeholder=\"t('ph_search_by_name')\"/>\r\n    </div>\r\n    <template v-if=\"showList.length\">\r\n      <div class=\"trigger-list\">\r\n        <div\r\n          class=\"trigger-item\"\r\n          v-for=\"item in showList\"\r\n          @click=\"handleAddNode(item)\"\r\n          :key=\"item.id\"\r\n        >\r\n          <div class=\"trigger-info\">\r\n            <img class=\"avatar\" :src=\"item.robot_avatar\"/>\r\n            <div class=\"info\">\r\n              <span class=\"name\">{{ item.robot_name }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </template>\r\n    <div v-else class=\"empty-box\">\r\n      <img style=\"height: 200px\" src=\"@/assets/empty.png\"/>\r\n      <div>{{ t('msg_no_workflows_available') }}</div>\r\n      <a href=\"/#/robot/list?active=1\" target=\"_blank\">{{ t('btn_add_now') }}\r\n        <RightOutlined/>\r\n      </a>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, computed, onMounted} from 'vue'\r\nimport {createWorkflowNode} from '../node-list'\r\nimport {RightOutlined, DownOutlined} from '@ant-design/icons-vue'\r\nimport {getRobotList} from \"@/api/robot/index.js\";\r\nimport {useI18n} from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-list-popup.workflow-list')\r\n\r\nconst emit = defineEmits(['add'])\r\nconst list = ref([])\r\nconst keyword = ref('')\r\n\r\nonMounted(() => {\r\n  loadData()\r\n})\r\n\r\nfunction loadData() {\r\n  getRobotList({application_type: 1}).then(res => {\r\n    let _list = res.data || []\r\n    list.value = _list.filter(i => i.has_published == 1)\r\n  })\r\n}\r\n\r\nconst showList = computed(() => {\r\n  if (keyword.value) {\r\n    return list.value.filter((item) => item.robot_name.includes(keyword.value))\r\n  }\r\n  return list.value\r\n})\r\n\r\nconst handleAddNode = (item) => {\r\n  let node = createWorkflowNode(item)\r\n  emit('add', node)\r\n}\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.http-tool-list-box {\r\n  .search-box {\r\n    margin: 0 8px 8px;\r\n  }\r\n  .node-list {\r\n    .node-item {\r\n      .node-info {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 4px 8px;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        &:hover {\r\n          background: #e4e6eb;\r\n        }\r\n        .avatar {\r\n          width: 20px;\r\n          height: 20px;\r\n          flex-shrink: 0;\r\n          border-radius: 4px;\r\n          margin-right: 8px;\r\n        }\r\n        .info {\r\n          flex: 1;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: space-between;\r\n          .name {\r\n            color: #262626;\r\n            font-size: 14px;\r\n            font-weight: 400;\r\n          }\r\n          .total {\r\n            color: #8c8c8c;\r\n            font-size: 12px;\r\n            font-weight: 400;\r\n          }\r\n        }\r\n      }\r\n      .node-tools {\r\n        margin-left: 28px;\r\n        border-left: 1px solid #d9d9d9;\r\n      }\r\n      .node-tool-item {\r\n        padding: 2px 8px;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        &:hover {\r\n          background: #e4e6eb;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .empty-box {\r\n    text-align: center;\r\n  }\r\n  .more-link {\r\n    padding: 8px 16px 0;\r\n    border-top: 1px solid #F0F0F0;\r\n    color: #2475FC;\r\n  }\r\n}\r\n\r\n.node-info-pop {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n  color: #595959;\r\n  font-size: 14px;\r\n  font-weight: 400;\r\n  min-width: 260px;\r\n\r\n  .info {\r\n    display: flex;\r\n    align-items: center;\r\n    color: #262626;\r\n    font-size: 16px;\r\n\r\n    .avatar {\r\n      width: 62px;\r\n      height: 62px;\r\n      border-radius: 14.59px;\r\n      flex-shrink: 0;\r\n      margin-right: 12px;\r\n    }\r\n  }\r\n\r\n  .extra {\r\n    color: #8c8c8c;\r\n    font-size: 12px;\r\n  }\r\n}\r\n.params-box {\r\n  max-height: 80vh;\r\n  overflow-y: auto;\r\n\r\n  .param-item {\r\n    max-width: 500px;\r\n\r\n    &:first-child {\r\n      border-bottom: 1px solid #e4e6eb;\r\n      padding-bottom: 16px;\r\n    }\r\n    &:not(:last-child) {\r\n      margin-bottom: 16px;\r\n    }\r\n\r\n    .field {\r\n      color: #262626;\r\n      font-size: 14px;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 12px;\r\n\r\n      .name {\r\n        font-weight: 600;\r\n      }\r\n\r\n      .type {\r\n        color: #595959;\r\n      }\r\n    }\r\n\r\n    .desc {\r\n      color: #8c8c8c;\r\n      font-size: 14px;\r\n      margin-top: 4px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"http-tool-list-box\">\r\n    <div class=\"node-list\" v-if=\"showList.length\">\r\n      <div v-for=\"(item, j) in showList\" :key=\"j\" class=\"node-item\">\r\n        <a-popover placement=\"right\">\r\n          <template #content>\r\n            <div class=\"node-info-pop\">\r\n              <div class=\"info\">\r\n                <img class=\"avatar\" :src=\"item.avatar || '/src/assets/img/workflow/node-service.svg'\" />\r\n                <div class=\"name\">{{ item.name }}</div>\r\n              </div>\r\n              <div class=\"extra\">{{ t('label_node_count') }}{{ (item.nodes || []).length }}</div>\r\n              <div>{{ item.description }}</div>\r\n            </div>\r\n          </template>\r\n          <div class=\"node-info\" @click=\"item.expand = !item.expand\">\r\n            <img class=\"avatar\" :src=\"item.avatar || '/src/assets/img/workflow/node-service.svg'\" />\r\n            <div class=\"info\">\r\n              <span class=\"name\">{{ item.name }}</span>\r\n              <span class=\"total\">\r\n                {{ (item.nodes || []).length }} <DownOutlined v-if=\"item.expand\"/> <RightOutlined v-else/>\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </a-popover>\r\n        <div v-show=\"item.expand\" class=\"node-tools\">\r\n          <a-popover\r\n            v-for=\"(node, i) in (item.nodes || [])\"\r\n            :key=\"i\"\r\n            placement=\"right\"\r\n          >\r\n            <template #content>\r\n              <div class=\"params-box\">\r\n                <div class=\"param-item\">\r\n                  <div class=\"field\">\r\n                    <span class=\"name\">{{ node.node_name }}</span>\r\n                  </div>\r\n                  <div class=\"desc\">{{ node.node_description }}</div>\r\n                </div>\r\n                <div class=\"param-item\">\r\n                  <div class=\"field\">\r\n                    <span class=\"name\">{{ formatMethod(node?.node_params?.curl?.method) }}</span>\r\n                    <span class=\"type\">{{ cleanupUrl(node?.node_params?.curl?.rawurl) }}</span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"param-item\" v-if=\"Array.isArray(node?.node_params?.curl?.params) && node.node_params.curl.params.length\">\r\n                  <div class=\"field\">\r\n                    <span class=\"name\">{{ t('label_query_params') }}</span>\r\n                  </div>\r\n                  <div class=\"desc\">\r\n                    {{ node.node_params.curl.params.map(p => p.key).filter(Boolean).join(', ') }}\r\n                  </div>\r\n                </div>\r\n                <div class=\"param-item\" v-if=\"Array.isArray(node?.node_params?.curl?.headers) && node.node_params.curl.headers.length\">\r\n                  <div class=\"field\">\r\n                    <span class=\"name\">{{ t('label_request_headers') }}</span>\r\n                  </div>\r\n                  <div class=\"desc\">\r\n                    {{ node.node_params.curl.headers.map(h => h.key).filter(Boolean).join(', ') }}\r\n                  </div>\r\n                </div>\r\n                <div class=\"param-item\" v-if=\"Array.isArray(node?.node_params?.curl?.output) && node.node_params.curl.output.length\">\r\n                  <div class=\"field\">\r\n                    <span class=\"name\">{{ t('label_output_fields') }}</span>\r\n                  </div>\r\n                  <div class=\"desc\">\r\n                    {{ node.node_params.curl.output.map(o => o.key).filter(Boolean).join(', ') }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </template>\r\n            <div class=\"node-tool-item\" @click=\"handleAddNode(item, node)\">{{ node.node_name }}</div>\r\n          </a-popover>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div v-else class=\"empty-box\">\r\n      <img style=\"height: 200px\" src=\"@/assets/empty.png\" />\r\n      <div>{{ t('msg_no_http_tools') }}</div>\r\n      <a @click=\"handleOpenAddHttp\">{{ t('btn_go_add') }}<RightOutlined /></a>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { RightOutlined, DownOutlined } from '@ant-design/icons-vue'\r\nimport { getHttpTools } from '@/api/robot/http_tool.js'\r\nimport { addHttpToolNode } from '../node-list'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-list-popup.http-tool-list')\r\n\r\nconst emit = defineEmits(['add'])\r\n\r\nconst props = defineProps({\r\n  keyword: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n})\r\n\r\nconst list = ref([])\r\n\r\nonMounted(() => {\r\n  loadData()\r\n})\r\n\r\nfunction loadData() {\r\n  getHttpTools({ page: 1, size: 9999, with_nodes: 1 }).then(res => {\r\n    const arr = res?.data?.list || []\r\n    arr.forEach(i => i.expand = false)\r\n    list.value = arr\r\n  })\r\n}\r\n\r\nconst showList = computed(() => {\r\n  if (props.keyword) {\r\n    const kw = props.keyword\r\n    return list.value.filter((item) => {\r\n      let info = (item.description || '') + (item.name || '')\r\n      if (Array.isArray(item.nodes)) {\r\n        item.nodes.forEach(n => {\r\n          info += (n.node_name || '') + (n.node_description || '')\r\n          const url = n?.node_params?.curl?.rawurl || ''\r\n          info += url\r\n        })\r\n      }\r\n      return info.indexOf(kw) > -1\r\n    })\r\n  }\r\n  return list.value\r\n})\r\n\r\nconst handleAddNode = (tool, node) => {\r\n  const curl = node?.node_params?.curl || {}\r\n  const newNode = addHttpToolNode({\r\n    name: node?.node_name || tool?.name,\r\n    avatar: node?.http_tool_avatar || tool?.avatar,\r\n    method: curl?.method,\r\n    url: curl?.rawurl,\r\n    headers: Array.isArray(curl?.headers) ? curl.headers : [],\r\n    params: Array.isArray(curl?.params) ? curl.params : [],\r\n    body: Array.isArray(curl?.body) ? curl.body : [],\r\n    timeout: curl?.timeout || 60,\r\n    output: Array.isArray(curl?.output) ? curl.output : [],\r\n    http_auth: Array.isArray(curl?.http_auth) ? curl.http_auth : [],\r\n    http_tool_info: node?.http_tool_info || {\r\n      http_tool_name: tool?.name || '',\r\n      http_tool_key: tool?.tool_key || '',\r\n      http_tool_avatar: tool?.avatar || '',\r\n      http_tool_description: tool?.description || '',\r\n      http_tool_node_key: node?.node_key || '',\r\n      http_tool_node_name: node?.node_name || '',\r\n      http_tool_node_description: node?.node_description || ''\r\n    }\r\n  })\r\n  emit('add', newNode)\r\n}\r\n\r\nfunction handleOpenAddHttp() {\r\n  window.open('/#/robot/list?active=6', '_blank')\r\n}\r\n\r\nfunction formatMethod(m) {\r\n  return String(m || '').toUpperCase() || 'GET'\r\n}\r\nfunction cleanupUrl(url) {\r\n  return String(url || '').replace(/[`\"]/g, '').trim()\r\n}\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.node-list-popup {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  width: 100%;\r\n  overflow: hidden;\r\n  border-radius: 6px 6px 0 0;\r\n  box-shadow: 0 4px 16px 0 #0000001a;\r\n  .tabs-box {\r\n    display: flex;\r\n    align-items: center;\r\n    border-radius: 6px;\r\n    background: #f3f3f3;\r\n\r\n    .tab-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      color: #595959;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      padding: 12px 18px;\r\n      cursor: pointer;\r\n\r\n      &.active {\r\n        color: #2475fc;\r\n        font-weight: 600;\r\n        border-radius: 9px 9px 0 0;\r\n        background: #fff;\r\n      }\r\n    }\r\n  }\r\n\r\n  .node-list-popup-content {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n    padding: 2px;\r\n    border-radius: 6px;\r\n    background: #fff;\r\n    box-shadow:\r\n      0 6px 30px 5px #0000000d,\r\n      0 16px 24px 2px #0000000a,\r\n      0 8px 10px -5px #00000014;\r\n  }\r\n\r\n  .node-list {\r\n    .node-type {\r\n      height: 30px;\r\n      padding-left: 16px;\r\n      font-size: 12px;\r\n      color: #8c8c8c;\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n    .node-flex-box {\r\n      display: flex;\r\n      align-items: center;\r\n      flex-wrap: wrap;\r\n      gap: 4px 0;\r\n      .node-item {\r\n        height: 100%;\r\n        height: 32px;\r\n        cursor: pointer;\r\n        width: 50%;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        padding: 0 16px;\r\n        &:hover {\r\n          background: #e4e6eb;\r\n          border-radius: 6px;\r\n        }\r\n        img {\r\n          width: 20px;\r\n          height: 20px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .node-box {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 8px;\r\n    overflow: hidden;\r\n\r\n    .search-box {\r\n      margin: 0 8px 8px;\r\n    }\r\n\r\n    .node-list {\r\n      flex: 1;\r\n      overflow-y: auto;\r\n      .node-info {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 4px 8px;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        &:hover {\r\n          background: #e4e6eb;\r\n        }\r\n\r\n        .avatar {\r\n          width: 20px;\r\n          height: 20px;\r\n          flex-shrink: 0;\r\n          border-radius: 4.71px;\r\n          margin-right: 8px;\r\n        }\r\n\r\n        .info {\r\n          flex: 1;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: space-between;\r\n\r\n          .name {\r\n            color: #262626;\r\n            font-size: 14px;\r\n            font-weight: 400;\r\n          }\r\n\r\n          .total {\r\n            color: #8c8c8c;\r\n            font-size: 12px;\r\n            font-weight: 400;\r\n          }\r\n        }\r\n      }\r\n\r\n      .node-tools {\r\n        margin-left: 28px;\r\n        border-left: 1px solid #d9d9d9;\r\n      }\r\n      .node-tool-item {\r\n        padding: 2px 8px;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        &:hover {\r\n          background: #e4e6eb;\r\n        }\r\n      }\r\n    }\r\n\r\n    .more-link {\r\n      padding: 8px 16px 0;\r\n      border-top: 1px solid #F0F0F0;\r\n      color: #2475FC;\r\n    }\r\n  }\r\n}\r\n\r\n.sub-tabs {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding-bottom: 8px;\r\n  .sub-tab-item {\r\n    color: #262626;\r\n    font-size: 14px;\r\n    font-weight: 500;\r\n    padding: 6px 12px;\r\n    border-radius: 8px;\r\n    cursor: pointer;\r\n    &.active {\r\n      background: #E6F0FF;\r\n      color: #2475FC;\r\n      font-weight: 600;\r\n    }\r\n  }\r\n}\r\n.node-info-pop {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n  color: #595959;\r\n  font-size: 14px;\r\n  font-weight: 400;\r\n  min-width: 260px;\r\n\r\n  .info {\r\n    display: flex;\r\n    align-items: center;\r\n    color: #262626;\r\n    font-size: 16px;\r\n\r\n    .avatar {\r\n      width: 62px;\r\n      height: 62px;\r\n      border-radius: 14.59px;\r\n      flex-shrink: 0;\r\n      margin-right: 12px;\r\n    }\r\n  }\r\n\r\n  .extra {\r\n    color: #8c8c8c;\r\n    font-size: 12px;\r\n  }\r\n}\r\n.params-box {\r\n  max-height: 80vh;\r\n  overflow-y: auto;\r\n\r\n  .param-item {\r\n    max-width: 500px;\r\n\r\n    &:first-child {\r\n      border-bottom: 1px solid #e4e6eb;\r\n      padding-bottom: 16px;\r\n    }\r\n    &:not(:last-child) {\r\n      margin-bottom: 16px;\r\n    }\r\n\r\n    .field {\r\n      color: #262626;\r\n      font-size: 14px;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 12px;\r\n\r\n      .name {\r\n        font-weight: 600;\r\n      }\r\n\r\n      .type {\r\n        color: #595959;\r\n      }\r\n\r\n      .required {\r\n        color: #ed744a;\r\n        font-weight: 500;\r\n      }\r\n    }\r\n\r\n    .desc {\r\n      color: #8c8c8c;\r\n      font-size: 14px;\r\n      margin-top: 4px;\r\n    }\r\n  }\r\n}\r\n\r\n.empty-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin: 40px 0;\r\n\r\n  img {\r\n    width: 200px;\r\n    height: 200px;\r\n  }\r\n\r\n  .title {\r\n    color: #262626;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n  }\r\n\r\n  .btn {\r\n    margin-top: 24px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"node-list-popup\">\r\n    <div class=\"tabs-box\">\r\n      <div :class=\"['tab-item', { active: tabActive == 1 }]\" @click=\"tabChange(1)\">\r\n        <svg-icon name=\"base-node-type\" /> <span>{{ t('tab_basic_functions') }}</span>\r\n      </div>\r\n      <div :class=\"['tab-item', {active: tabActive == 3}]\" @click=\"tabChange(3)\">\r\n        <svg-icon name=\"plugin-node-type\"/> <span>{{ t('tab_plugins') }}</span>\r\n      </div>\r\n      <div :class=\"['tab-item', { active: tabActive == 2 }]\" @click=\"tabChange(2)\">\r\n        <svg-icon name=\"mcp-node-type\" /> <span>{{ t('tab_mcp') }}</span>\r\n      </div>\r\n      <div v-if=\"props.type == 'float-btn'\" :class=\"['tab-item', { active: props.active == 4 }]\" @click=\"tabChange(4)\">\r\n        <svg-icon name=\"mcp-node-type\" /> <span>{{ t('tab_triggers') }}</span>\r\n      </div>\r\n      <div :class=\"['tab-item', { active: tabActive == 5 }]\" @click=\"tabChange(5)\">\r\n        <svg-icon name=\"workflow\" /> <span>{{ t('tab_workflows') }}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"node-list-popup-content\">\r\n      <template v-if=\"tabActive == 1\">\r\n        <template v-for=\"group in allGroupNodes\" :key=\"group.key\">\r\n          <div class=\"node-list\" v-if=\"!group.hidden\">\r\n            <div class=\"node-type\">{{ group.name }}</div>\r\n            <div class=\"node-flex-box\">\r\n              <template v-for=\"node in group.nodes\" :key=\"node.type\">\r\n                <div\r\n                  class=\"node-item\"\r\n                  @mousedown=\"handleMouseDownOnNode($event, node)\"\r\n                  v-if=\"!node.hidden\"\r\n                >\r\n                  <img :src=\"node.properties.node_icon\" :alt=\"node.properties.node_name\" />\r\n                  <div class=\"node-name\">{{ node.properties.node_name }}</div>\r\n                </div>\r\n              </template>\r\n            </div>\r\n          </div>\r\n        </template>\r\n      </template>\r\n      <div v-else-if=\"tabActive == 2\" class=\"node-box\">\r\n        <div class=\"sub-tabs\">\r\n          <div :class=\"['sub-tab-item', { active: mcpHttpTab == 'MCP' }]\" @click=\"mcpHttpTab = 'MCP'\">MCP</div>\r\n          <div :class=\"['sub-tab-item', { active: mcpHttpTab == 'HTTP' }]\" @click=\"mcpHttpTab = 'HTTP'\">HTTP</div>\r\n        </div>\r\n        <div class=\"search-box\">\r\n          <a-input-search v-model:value.trim=\"mcpKeyword\" allowClear :placeholder=\"t('ph_search_by_name')\" />\r\n        </div>\r\n        <template v-if=\"mcpHttpTab == 'MCP' && showMcpNodes.length\">\r\n          <div class=\"node-list\">\r\n            <div v-for=\"(item, j) in showMcpNodes\" :key=\"j\" class=\"node-item\">\r\n              <a-popover placement=\"right\">\r\n                <template #content>\r\n                  <div class=\"node-info-pop\">\r\n                    <div class=\"info\">\r\n                      <img class=\"avatar\" :src=\"item.avatar\" />\r\n                      <div class=\"name\">{{ item.name }}</div>\r\n                    </div>\r\n                    <div>{{ item.url }}</div>\r\n                    <div class=\"extra\">{{ t('label_available_tools') }}{{ item.tools.length }}</div>\r\n                  </div>\r\n                </template>\r\n                <div class=\"node-info\" @click=\"item.expand = !item.expand\">\r\n                  <img class=\"avatar\" :src=\"item.avatar\" />\r\n                  <div class=\"info\">\r\n                    <span class=\"name\">{{ item.name }}</span>\r\n                    <span class=\"total\">\r\n                      {{ item.tools.length }} <DownOutlined v-if=\"item.expand\"/> <RightOutlined v-else/>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </a-popover>\r\n              <div v-show=\"item.expand\" class=\"node-tools\">\r\n                <a-popover v-for=\"(tool, i) in item.tools\" :key=\"i\" placement=\"right\">\r\n                  <template #content>\r\n                    <div class=\"params-box\">\r\n                      <div class=\"param-item\">\r\n                        <div class=\"field\">\r\n                          <span class=\"name\">{{ tool.name }}</span>\r\n                        </div>\r\n                        <div class=\"desc\">{{ tool.description }}</div>\r\n                      </div>\r\n                      <div\r\n                        v-for=\"(field, key) in tool.inputSchema.properties\"\r\n                        :key=\"key\"\r\n                        class=\"param-item\"\r\n                      >\r\n                        <div class=\"field\">\r\n                          <span class=\"name\">{{ key }}</span>\r\n                          <span class=\"type\">{{ field.type }}</span>\r\n                          <span v-if=\"tool.inputSchema.required && tool.inputSchema.required.includes(key)\" class=\"required\">{{ t('label_required') }}</span>\r\n                        </div>\r\n                        <div class=\"desc\">{{ field.description }}</div>\r\n                      </div>\r\n                    </div>\r\n                  </template>\r\n                  <div class=\"node-tool-item\" @mousedown=\"addMcpNode($event, item, tool)\">{{ tool.name }}</div>\r\n                </a-popover>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <a class=\"more-link\" @click=\"handleOpenAddMcp\">{{ t('label_more_mcp_plugins') }} <RightOutlined/></a>\r\n        </template>\r\n        <div v-else-if=\"mcpHttpTab == 'MCP'\" class=\"empty-box\">\r\n          <img style=\"height: 200px\" src=\"@/assets/empty.png\" />\r\n          <div>{{ t('msg_no_mcp_plugins') }}</div>\r\n          <a @click=\"handleOpenAddMcp\">{{ t('btn_add_now') }}<RightOutlined /></a>\r\n        </div>\r\n        <template v-else-if=\"mcpHttpTab == 'HTTP'\">\r\n          <div class=\"node-list\" style=\"flex: 1; overflow-y: auto;\">\r\n            <HttpToolList :keyword=\"mcpKeyword\" @add=\"handleAddHttpToolNode\" />\r\n          </div>\r\n          <a class=\"more-link\" href=\"/#/robot/list?active=6\" target=\"_blank\">{{ t('label_more_http_tools') }} <RightOutlined/></a>\r\n        </template>\r\n      </div>\r\n      <template v-else-if=\"tabActive == 3\">\r\n        <PublicNetworkCheck v-if=\"!isPublicNetwork\" style=\"margin: 0;\"/>\r\n        <div v-else class=\"node-box\">\r\n          <template v-if=\"allPluginNodes.length\">\r\n            <div class=\"node-list\">\r\n              <template\r\n                v-for=\"node in allPluginNodes\"\r\n                :key=\"node.type\">\r\n                <div v-if=\"!isActionsPlugin(node)\"\r\n                     @click=\"handleAddNode(node)\"\r\n                     class=\"node-item\"\r\n                >\r\n                  <div class=\"node-info\">\r\n                    <img class=\"avatar\" :src=\"node.properties.node_icon\"/>\r\n                    <div class=\"info\"><span class=\"name\">{{ node.properties.node_name }}</span></div>\r\n                  </div>\r\n                </div>\r\n                <template v-else>\r\n                  <div v-if=\"getPluginActions(node.plugin_name).length > 1\" class=\"node-item\">\r\n                    <a-popover placement=\"right\">\r\n                      <template #content>\r\n                        <div class=\"node-info-pop\">\r\n                          <div class=\"info\">\r\n                            <img class=\"avatar\" :src=\"node.properties.node_icon\" />\r\n                            <div class=\"name\">{{ node.properties.node_name }}</div>\r\n                          </div>\r\n                          <div>{{ node.properties.node_desc }}</div>\r\n                          <div class=\"extra\">{{ t('label_available_tools') }}{{ getPluginActions(node.plugin_name).length  }}</div>\r\n                        </div>\r\n                      </template>\r\n                      <div class=\"node-info\" @click=\"node.expand = !node.expand\">\r\n                        <img class=\"avatar\" :src=\"node.properties.node_icon\" />\r\n                        <div class=\"info\">\r\n                          <span class=\"name\">{{ node.properties.node_name }}</span>\r\n                          <span class=\"total\">\r\n                          {{ getPluginActions(node.plugin_name).length }} <DownOutlined v-if=\"node.expand\"/> <RightOutlined v-else/>\r\n                        </span>\r\n                        </div>\r\n                      </div>\r\n                    </a-popover>\r\n                    <div v-show=\"node.expand\" class=\"node-tools\">\r\n                      <a-popover v-for=\"action in getPluginActions(node.plugin_name)\" :key=\"action.name\" placement=\"right\">\r\n                        <template #content>\r\n                          <div class=\"params-box\">\r\n                            <div class=\"param-item\">\r\n                              <div class=\"field\">\r\n                                <span class=\"name\">{{ action.title }}</span>\r\n                              </div>\r\n                              <div class=\"desc\">{{ action.desc }}</div>\r\n                            </div>\r\n                            <div\r\n                              v-for=\"(field, key) in action.params\"\r\n                              :key=\"key\"\r\n                              class=\"param-item\"\r\n                            >\r\n                              <div class=\"field\">\r\n                                <span class=\"name\">{{ key }}</span>\r\n                                <span class=\"type\">{{ field.type }}</span>\r\n                                <span v-if=\"field.required\" class=\"required\">{{ t('label_required') }}</span>\r\n                              </div>\r\n                              <div class=\"desc\">{{ field.desc }}</div>\r\n                            </div>\r\n                          </div>\r\n                        </template>\r\n                        <div class=\"node-tool-item\" @mousedown=\"addPluginNode($event, node, action, action.name)\">{{ action.title }}</div>\r\n                      </a-popover>\r\n                    </div>\r\n                  </div>\r\n                  <!--仅存在一个方法时-->\r\n                  <template v-else>\r\n                    <div v-for=\"action in getPluginActions(node.plugin_name)\"\r\n                         @click=\"addPluginNode(null, node, action, action.name)\"\r\n                         class=\"node-item\"\r\n                    >\r\n                      <div class=\"node-info\">\r\n                        <img class=\"avatar\" :src=\"node.properties.node_icon\"/>\r\n                        <div class=\"info\"><span class=\"name\">{{ node.properties.node_name }}</span></div>\r\n                      </div>\r\n                    </div>\r\n                  </template>\r\n                </template>\r\n              </template>\r\n            </div>\r\n            <a class=\"more-link\" href=\"/#/plugins/index?active=2\" target=\"_blank\">{{ t('btn_more_plugins') }} <RightOutlined/></a>\r\n          </template>\r\n          <div v-else class=\"empty-box\">\r\n            <img style=\"height: 200px;\" src=\"@/assets/empty.png\"/>\r\n            <div>{{ t('msg_no_plugins') }}</div>\r\n            <a href=\"/#/plugins/index?active=2\" target=\"_blank\">{{ t('btn_add_now') }}<RightOutlined/></a>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <div  v-else-if=\"tabActive == 4\" class=\"node-box\">\r\n        <TriggerList @add=\"handleAddTrigger\" />\r\n      </div>\r\n      <div v-else-if=\"tabActive == 5\" class=\"node-box\">\r\n        <WorkflowList @add=\"handleAddWorkflow\"/>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed, watch } from 'vue'\r\nimport { RightOutlined, DownOutlined } from '@ant-design/icons-vue'\r\nimport TriggerList from './trigger-list.vue'\r\nimport {\r\n  getAllGroupNodes,\r\n  getAllPluginNodes,\r\n  getAllMcpNodes,\r\n  getMcpNode,\r\n  getPluginActionNode,\r\n  getPluginActions,\r\n} from '../node-list'\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\nimport {pluginHasAction} from \"@/constants/plugin.js\";\r\nimport WorkflowList from \"@/views/workflow/components/node-list-popup/workflow-list.vue\";\r\nimport HttpToolList from \"@/views/workflow/components/node-list-popup/http-tool-list.vue\";\r\nimport {usePublicNetworkCheck} from \"@/composables/usePublicNetworkCheck.js\";\r\nimport PublicNetworkCheck from \"@/components/common/public-network-check.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-list-popup.index')\r\n\r\nconst emit = defineEmits(['addNode', 'addTrigger', 'mouseMove', 'update:active'])\r\n\r\nconst props = defineProps({\r\n  type: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  active: {\r\n    type: Number,\r\n    default: 1\r\n  },\r\n  excludedNodeTypes: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n})\r\n\r\nconst {isPublicNetwork} = usePublicNetworkCheck()\r\nconst tabActive = ref(props.active)\r\nconst mcpHttpTab = ref('MCP')\r\n\r\nwatch(() => props.active, (newVal) => {\r\n  tabActive.value = newVal\r\n})\r\n\r\nconst allGroupNodes = ref([])\r\nconst allPluginNodes = ref([])\r\nconst allMcpNodes = ref([])\r\nconst mcpKeyword = ref('')\r\n\r\nwatch(() => props.excludedNodeTypes, () => {\r\n  allGroupNodes.value = getAllGroupNodes({excludedNodeTypes: props.excludedNodeTypes})\r\n}, {\r\n  immediate: true\r\n})\r\n\r\n\r\nonMounted(() => {\r\n  getAllMcpNodes().then((res) => {\r\n    allMcpNodes.value = res\r\n  })\r\n  getAllPluginNodes().then(res => {\r\n    allPluginNodes.value = res\r\n  })\r\n})\r\n\r\nconst showMcpNodes = computed(() => {\r\n  if (mcpKeyword.value) {\r\n    return allMcpNodes.value.filter((item) => {\r\n      let info = item.description + item.name\r\n      return info.indexOf(mcpKeyword.value) > -1\r\n    })\r\n  } else {\r\n    return allMcpNodes.value\r\n  }\r\n})\r\n\r\nconst handleMouseDownOnNode = (event, node) => {\r\n  // 阻止默认行为，例如文本选择\r\n  event.preventDefault()\r\n\r\n  let isDragged = false\r\n  const startX = event.clientX\r\n  const startY = event.clientY\r\n\r\n  // 复制节点数据，为之后创建节点做准备\r\n  const nodeData = JSON.parse(JSON.stringify(node))\r\n\r\n  // 创建一个临时的、跟随鼠标的预览元素\r\n  const ghost = document.createElement('div')\r\n  ghost.classList.add('node-item-ghost')\r\n  ghost.innerHTML = event.currentTarget.innerHTML // 复制外观\r\n\r\n  document.body.appendChild(ghost)\r\n\r\n  const moveGhost = (e) => {\r\n    ghost.style.left = `${e.clientX + 5}px`\r\n    ghost.style.top = `${e.clientY + 5}px`\r\n  }\r\n\r\n  moveGhost(event)\r\n\r\n  const onMouseMove = (e) => {\r\n    if (\r\n      !isDragged &&\r\n      (Math.abs(e.clientX - startX) > 5 || Math.abs(e.clientY - startY) > 5)\r\n    ) {\r\n      isDragged = true\r\n    }\r\n    moveGhost(e)\r\n    emit('mouseMove')\r\n  }\r\n\r\n  const onMouseUp = (e) => {\r\n    // 清理\r\n    document.body.removeChild(ghost)\r\n    window.removeEventListener('mousemove', onMouseMove)\r\n    window.removeEventListener('mouseup', onMouseUp)\r\n\r\n    if (isDragged) {\r\n      // 如果拖动了，发出事件，通知画布创建节点\r\n      // 传递节点数据和鼠标抬起时的事件对象（包含坐标）\r\n      emit('addNode', { node: nodeData, event: e })\r\n    } else {\r\n      // 如果没有拖动，执行原有的 click 逻辑\r\n      handleAddNode(nodeData)\r\n    }\r\n  }\r\n\r\n  window.addEventListener('mousemove', onMouseMove)\r\n  window.addEventListener('mouseup', onMouseUp, { once: true })\r\n}\r\n\r\nconst handleAddNode = (node) => {\r\n  node = JSON.parse(JSON.stringify(node))\r\n\r\n  emit('addNode', { node })\r\n}\r\n\r\nconst addMcpNode = (event, mcp, tool) => {\r\n  let node = getMcpNode(mcp, tool);\r\n\r\n  handleMouseDownOnNode(event, node)\r\n}\r\n\r\nconst handleAddTrigger = (node) => {\r\n  emit('addNode', { node, isTriggerNode: true })\r\n}\r\n\r\nconst handleAddWorkflow = (node) => {\r\n  emit('addNode', { node })\r\n}\r\n\r\nconst addPluginNode = (event, node, action, name) => {\r\n  node = getPluginActionNode(node, action, name)\r\n  if (event) {\r\n    handleMouseDownOnNode(event, node)\r\n  } else {\r\n    emit('addNode', { node })\r\n  }\r\n}\r\n\r\nfunction tabChange(key) {\r\n  tabActive.value = key\r\n  emit('update:active', key)\r\n}\r\n\r\nfunction handleOpenAddMcp() {\r\n  window.open('/#/robot/list?active=3&mcp=2', '_blank')\r\n}\r\n\r\nfunction isActionsPlugin(node) {\r\n  let node_params = jsonDecode(node?.properties?.node_params, {})\r\n  return pluginHasAction(node_params?.plugin?.name) || node_params?.plugin?.multiNode\r\n}\r\n\r\nfunction handleAddHttpToolNode(node) {\r\n  emit('addNode', { node })\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.node-item-ghost {\r\n  position: fixed;\r\n  z-index: 10000;\r\n  pointer-events: none;\r\n  display: flex;\r\n  align-items: center;\r\n  height: 32px;\r\n  min-width: 200px;\r\n  gap: 8px;\r\n  padding: 0 16px;\r\n  border-radius: 6px;\r\n  opacity: 0.7;\r\n  background-color: #fff;\r\n  box-shadow: 0 4px 16px 0 #0000001a;\r\n\r\n  img {\r\n    width: 20px;\r\n    height: 20px;\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.custom-control-warpper {\r\n  position: fixed;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  bottom: 24px;\r\n  z-index: 100;\r\n\r\n  .custom-control-body {\r\n    position: relative;\r\n  }\r\n  .custom-control {\r\n    display: flex;\r\n    flex-flow: row nowrap;\r\n    align-items: center;\r\n    gap: 8px;\r\n    padding: 4px 12px;\r\n    border-radius: 8px;\r\n    background-color: #fff;\r\n    box-shadow: 0 4px 16px 0 #0000001a;\r\n\r\n    .control-line {\r\n      width: 1px;\r\n      height: 24px;\r\n      background-color: #d9d9d9;\r\n    }\r\n  }\r\n  .zoom-control {\r\n    display: flex;\r\n    flex-flow: row nowrap;\r\n    align-items: center;\r\n\r\n    .action-btn {\r\n      border-radius: 6px;\r\n      transition: all 0.2s;\r\n      &:hover {\r\n        background-color: #e4e6eb;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n\r\n    .zoom-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 32px;\r\n      height: 32px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n    }\r\n  }\r\n\r\n  .node-list-fix {\r\n    position: absolute;\r\n    bottom: 48px;\r\n    left: 50%;\r\n    height: 550px;\r\n    width: 500px;\r\n    transform: translateX(-50%);\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"custom-control-warpper\">\r\n    <div class=\"custom-control-body\">\r\n      <div class=\"custom-control\">\r\n        <div class=\"control-item zoom-control\">\r\n          <div class=\"action-btn zoom-btn\" @click=\"handleReduce\">\r\n            <svg-icon name=\"minus\" size=\"16\" />\r\n          </div>\r\n          <zoom-select v-model=\"zoom\" @zoom-change=\"chagneZoom\" @fitView=\"handleFitView\" />\r\n          <div class=\"action-btn zoom-btn\" @click=\"handleAmplify\">\r\n            <svg-icon name=\"plus\" size=\"16\" />\r\n          </div>\r\n        </div>\r\n\r\n        <i class=\"control-line\"></i>\r\n\r\n        <div class=\"control-item\">\r\n          <a-button type=\"primary\" @click.stop=\"handleShowNodeList\">\r\n            <template #icon>\r\n              <PlusOutlined />\r\n            </template>\r\n            <span>{{ t('btn_create_node') }}</span>\r\n          </a-button>\r\n        </div>\r\n\r\n        <div class=\"control-item\">\r\n          <a-button @click=\"handleRunTest\" style=\"background-color: #00ad3a\" type=\"primary\">\r\n            <CaretRightOutlined /><span>{{ t('btn_run_test') }}</span>\r\n          </a-button>\r\n        </div>\r\n\r\n        <div class=\"control-item\">\r\n          <a-button @click=\"handleAutoLayout\" type=\"default\">\r\n            <PartitionOutlined /><span>{{ t('btn_organize_canvas') }}</span>\r\n          </a-button>\r\n        </div>\r\n      </div>\r\n      <!-- 使用 v-show 保证拖拽添加节点时，NodeListPopup 组件不会被销毁，确保 addNode 事件能正常触发 -->\r\n      <div class=\"node-list-fix\" ref=\"nodeListRef\" v-show=\"isShowMenu\">\r\n        <NodeListPopup :excludedNodeTypes=\"excludedNodeTypes\" @addNode=\"handleAddNode\" type=\"float-btn\" @mouseMove=\"handleMouseMove\" v-model:active=\"nodeListTabActive\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onBeforeUnmount } from 'vue'\r\nimport ZoomSelect from './zoom-select.vue'\r\nimport { PlusOutlined, CaretRightOutlined, PartitionOutlined } from '@ant-design/icons-vue'\r\nimport NodeListPopup from '../node-list-popup/index.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.custom-control.index')\r\n\r\nconst emit = defineEmits(['runTest', 'addNode', 'zoomChange', 'autoLayout'])\r\n\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: () => ({}),\r\n    required: true\r\n  }\r\n})\r\n\r\nconst excludedNodeTypes = ref(['terminate-node'])\r\n\r\nconst { eventCenter } = props.lf.graphModel\r\n\r\nconst zoom = ref(100)\r\n\r\nconst handleFitView = () => {\r\n  props.lf.fitView()\r\n}\r\n\r\nconst setZoom = () => {\r\n  let value = zoom.value / 100\r\n  props.lf.zoom(value)\r\n\r\n  emit('zoomChange', value)\r\n}\r\n\r\nconst chagneZoom = (value) => {\r\n  zoom.value = value\r\n  setZoom()\r\n}\r\n\r\nconst handleReduce = () => {\r\n  // 四舍五入到整数\r\n  let value = zoom.value - 10\r\n\r\n  if (value < 1) {\r\n    value = 1\r\n  }\r\n\r\n  zoom.value = value\r\n  setZoom()\r\n}\r\n\r\nconst handleAmplify = () => {\r\n  let value = zoom.value + 10\r\n\r\n  if (value > 800) {\r\n    value = 800\r\n  }\r\n\r\n  zoom.value = value\r\n  setZoom()\r\n}\r\n\r\nconst onGraphTransform = (args) => {\r\n  let value = Math.floor(args.transform.SCALE_X * 100)\r\n  zoom.value = value\r\n}\r\n\r\nconst isShowMenu = ref(false)\r\nconst nodeListRef = ref(null)\r\nconst nodeListTabActive = ref(1)\r\n\r\nconst handleShowNodeList = () => {\r\n  nodeListTabActive.value = 1\r\n  isShowMenu.value = true\r\n}\r\n\r\n// let miniMap = null\r\n\r\n// const handleMouseenter = () => {\r\n//   props.lf.extension.miniMap.show()\r\n//   miniMap = document.querySelector('.lf-mini-map')\r\n//   starListenEvent()\r\n// }\r\n\r\n// const handleMouseleave = (e) => {\r\n//   if (e.offsetY > 0) {\r\n//     props.lf.extension.miniMap.hide()\r\n//   }\r\n// }\r\n\r\n// function starListenEvent() {\r\n//   if (!miniMap) {\r\n//     return\r\n//   }\r\n//   miniMap.addEventListener('mouseenter', () => {\r\n//     props.lf.extension.miniMap.show()\r\n//   })\r\n//   miniMap.addEventListener('mouseleave', () => {\r\n//     props.lf.extension.miniMap.hide()\r\n//   })\r\n// }\r\n\r\nconst handleRunTest = () => {\r\n  emit('runTest')\r\n}\r\n\r\nconst handleAutoLayout = () => {\r\n  emit('autoLayout')\r\n}\r\n\r\nconst documentClick = (e) => {\r\n  if (isShowMenu.value) {\r\n    const menus = nodeListRef.value\r\n    if (!menus.contains(e.target)) {\r\n      isShowMenu.value = false\r\n    }\r\n  }\r\n}\r\n\r\nconst handleMouseMove = () => {\r\n  if (isShowMenu.value) {\r\n    isShowMenu.value = false\r\n  }\r\n}\r\n\r\nconst handleAddNode = (node) => {\r\n  emit('addNode', node)\r\n  isShowMenu.value = false\r\n}\r\n\r\nconst showTriggerLit = () => {\r\n  nodeListTabActive.value = 4\r\n  isShowMenu.value = true\r\n}\r\n\r\nonMounted(() => {\r\n  document.addEventListener('click', documentClick)\r\n  eventCenter.on('graph:transform', onGraphTransform)\r\n  eventCenter.on('custom:showTriggerLit', showTriggerLit)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  document.removeEventListener('click', documentClick)\r\n  eventCenter.off('graph:transform', onGraphTransform)\r\n  eventCenter.off('custom:showTriggerLit', showTriggerLit)\r\n})\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.node-form-layout {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n}\r\n.layout-header {\r\n  padding: 16px 16px 0 16px;\r\n}\r\n.layout-body {\r\n  flex: 1;\r\n  padding: 0 16px 16px 16px;\r\n  overflow-y: auto;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"node-form-layout\">\r\n    <div class=\"layout-header\">\r\n      <slot name=\"header\"></slot>\r\n    </div>\r\n    <div class=\"layout-body\">\r\n      <slot name=\"default\"></slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.node-form-header {\r\n  margin-bottom: 16px;\r\n  \r\n  .node-title {\r\n    display: flex;\r\n    align-items: center;\r\n    & > img{\r\n      width: 20px;\r\n      height: 20px;\r\n    }\r\n  }\r\n  .title-left {\r\n    margin-right: 8px;\r\n  }\r\n  .title-conttent {\r\n    flex: 1;\r\n  }\r\n  .title-right {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .action-btn {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      width: 24px;\r\n      height: 24px;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n      transition: background-color 0.2s;\r\n      margin-left: 8px;\r\n\r\n      &:hover {\r\n        background-color: #e4e6eb;\r\n      }\r\n\r\n      .btn-icon {\r\n        display: block;\r\n        width: 16px;\r\n        height: 16px;\r\n        font-size: 16px;\r\n        line-height: 16px;\r\n        text-align: center;\r\n        color: #333;\r\n      }\r\n    }\r\n  }\r\n  .node-icon {\r\n    display: block;\r\n    width: 20px;\r\n    height: 20px;\r\n    border-radius: 6px;\r\n  }\r\n  .node-name-input {\r\n    line-height: 24px;\r\n    padding: 0 8px;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    border-radius: 6px;\r\n    color: #262626;\r\n    &::placeholder {\r\n      font-weight: 400;\r\n      font-size: 14px;\r\n    }\r\n  }\r\n\r\n  .node-desc {\r\n    margin-top: 8px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    line-height: 22px;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"node-form-header\">\r\n    <div class=\"node-title\">\r\n      <div class=\"title-left\">\r\n        <slot name=\"node-icon\">\r\n          <img class=\"node-icon\" :src=\"iconUrl\" v-if=\"iconUrl\">\r\n          <img class=\"node-icon\" :src=\"nodeIconUrl\" v-else-if=\"nodeIconUrl\">\r\n        </slot>\r\n      </div>\r\n      <div class=\"title-conttent\">\r\n        <a-input class=\"node-name-input\" v-model:value=\"localTitle\" :placeholder=\"t('ph_input_node_name')\" @change.stop=\"handleTitleChange\" />\r\n      </div>\r\n      <div class=\"title-right\">\r\n        <slot name=\"runBtn\"></slot>\r\n        <a-dropdown v-if=\"!hideMenus\">\r\n          <div class=\"action-btn delete-btn\" @click.prevent>\r\n            <svg-icon name=\"point-h\" class=\"btn-icon\"></svg-icon>\r\n          </div>\r\n          <template #overlay>\r\n            <a-menu style=\"width: 100px\">\r\n              <a-menu-item @click=\"handleDeleteNode()\">\r\n                <a href=\"javascript:;\">{{ t('btn_delete') }}</a>\r\n              </a-menu-item>\r\n            </a-menu>\r\n          </template>\r\n        </a-dropdown>\r\n\r\n        <div class=\"action-btn close-btn\" @click=\"handleClose\">\r\n          <CloseOutlined class=\"btn-icon\" style=\"font-size: 12px\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"node-desc\"><slot name=\"desc\">{{ props.desc }}</slot></div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref,  computed, inject } from 'vue'\r\nimport { CloseOutlined } from '@ant-design/icons-vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.node-form-header')\r\n\r\nconst changeTitle = inject('changeTitle')\r\nconst deleteNode = inject('deleteNode')\r\nconst close = inject('close')\r\nconst emit = defineEmits(['changeTitle', 'deleteNode', 'close'])\r\n\r\nconst props = defineProps({\r\n  iconName: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  iconUrl: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  title: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  desc: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  hideMenus: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nlet chagneTimer = null;\r\n\r\nconst getImggeUrl = (name) => {\r\n  let url = new URL(`../../../../assets/svg/${name}.svg`, import.meta.url)\r\n  return url.href\r\n}\r\n\r\nconst nodeIconUrl = computed(() => getImggeUrl(props.iconName))\r\n\r\nconst localTitle = ref(props.title)\r\n\r\nconst handleTitleChange = () => {\r\n  if (chagneTimer) {\r\n    clearTimeout(chagneTimer)\r\n  }\r\n  chagneTimer = setTimeout(() => {\r\n    changeTitle(localTitle.value)\r\n    emit('changeTitle')\r\n  }, 250)\r\n}\r\n\r\nconst handleDeleteNode = () => {\r\n  deleteNode()\r\n  emit('deleteNode')\r\n}\r\n\r\nconst handleClose = () => {\r\n  close()\r\n}\r\n</script>\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cg%20clip-path='url(%23u9u3epnhq__clip0_8437_35332)'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M5.66699%203.66536L8.00033%201.33203L10.3337%203.66536L8.00033%205.9987L5.66699%203.66536Z'%20stroke='%23262626'/%3e%3cpath%20d='M10%208.33333L12.3333%206L14.6667%208.33333L12.3333%2010.6667L10%208.33333Z'%20stroke='%23262626'/%3e%3cpath%20d='M5.66699%2012.3333L8.00033%2010L10.3337%2012.3333L8.00033%2014.6667L5.66699%2012.3333Z'%20stroke='%23262626'/%3e%3cpath%20d='M1.3335%207.9974L3.66683%205.66406L6.00016%207.9974L3.66683%2010.3307L1.3335%207.9974Z'%20stroke='%23262626'/%3e%3cpath%20d='M5.66699%203.66536L8.00033%201.33203L10.3337%203.66536L8.00033%205.9987L5.66699%203.66536Z'%20stroke='%23262626'/%3e%3cpath%20d='M10%208.33333L12.3333%206L14.6667%208.33333L12.3333%2010.6667L10%208.33333Z'%20stroke='%23262626'/%3e%3cpath%20d='M5.66699%2012.3333L8.00033%2010L10.3337%2012.3333L8.00033%2014.6667L5.66699%2012.3333Z'%20stroke='%23000'/%3e%3cpath%20d='M1.3335%207.9974L3.66683%205.66406L6.00016%207.9974L3.66683%2010.3307L1.3335%207.9974Z'%20stroke='%23000'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='u9u3epnhq__clip0_8437_35332'%3e%3cpath%20fill='%23fff'%20d='M0%200H16V16H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","<style lang=\"less\" scoped>\r\n.add-trigger-box{\r\n  margin-bottom: 16px;\r\n  .add-trigger-desc{\r\n    line-height: 22px;\r\n    margin-top: 4px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n  }\r\n}\r\n.start-node {\r\n  position: relative;\r\n\r\n  .start-node-options {\r\n    background: #f2f4f7;\r\n    border-radius: 6px;\r\n    padding: 12px;\r\n    .options-title {\r\n      color: var(--wf-color-text-1);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      font-weight: 600;\r\n      height: 22px;;\r\n      line-height: 22px;\r\n      font-size: 14px;\r\n\r\n      .title-icon{\r\n        width: 16px;\r\n        height: 16px;\r\n        vertical-align: -3px;\r\n        margin-right: 8px;;\r\n      }\r\n      .acton-box{\r\n        font-weight: 400;\r\n      }\r\n    }\r\n    .options-item{\r\n      display: flex;\r\n      align-items: center;\r\n      margin-top: 12px;\r\n      height: 22px;\r\n      line-height: 22px;\r\n     \r\n      .options-item-body{\r\n        flex: 1;\r\n        display: flex;\r\n        align-items: center;\r\n      }\r\n   \r\n      .option-label{\r\n        color: var(--wf-color-text-1);\r\n        font-size: 14px;\r\n        margin-right: 8px;\r\n      }\r\n      \r\n      .option-label::before{\r\n        content: '*';\r\n        color: #FB363F;\r\n        display: inline-block;\r\n        margin-right: 2px;\r\n        opacity: 0;\r\n      }\r\n\r\n      &.is-required .option-label::before{\r\n        content: '*';\r\n        color: #FB363F;\r\n        display: inline-block;\r\n        margin-right: 2px;\r\n        opacity: 1;\r\n      }\r\n      .option-type {\r\n        height: 22px;\r\n        line-height: 18px;\r\n        padding: 0 8px;\r\n        border-radius: 6px;\r\n        border: 1px solid rgba(0, 0, 0, 0.15);\r\n        background-color: #fff;\r\n        color: var(--wf-color-text-3);\r\n        font-size: 12px;\r\n      }\r\n      .option-desc {\r\n        max-width: 90px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        margin-left: 8px;\r\n        font-size: 14px;\r\n      }\r\n      .item-actions-box{\r\n        display: flex;\r\n        align-items: center;\r\n\r\n        .action-btn{\r\n          margin-left: 12px;\r\n          font-size: 16px;\r\n          color: #595959;\r\n          cursor: pointer;\r\n        }\r\n      }\r\n    }\r\n    .diy-options-item{\r\n      height: 38px;\r\n      padding: 8px;\r\n    }\r\n    .diy-options-item:hover{\r\n      border-radius: 6px;\r\n      background: #E4E6EB;\r\n    }\r\n  }\r\n\r\n  .action-items-box{\r\n    margin-top: 16px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :hideMenus=\"true\"\r\n      >\r\n        <template #desc>\r\n          <span>{{ t('desc_start_node') }}</span>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"start-node-form\">\r\n      <div class=\"add-trigger-box\">\r\n        <a-button type=\"primary\" ghost @click.stop=\"handleAddTrigger\">\r\n          <template #icon>\r\n            <PlusOutlined />\r\n          </template>\r\n          <span>{{ t('btn_add_trigger') }}</span>\r\n        </a-button>\r\n        <div class=\"add-trigger-desc\">{{ t('desc_add_trigger') }}</div>\r\n      </div>\r\n      <div class=\"node-form-content\">\r\n        <div class=\"start-node\">\r\n          <div class=\"start-node-options\">\r\n            <div class=\"options-title\">\r\n              <div>\r\n                <img src=\"@/assets/img/workflow/global-variable.svg\" alt=\"\" class=\"title-icon\" />\r\n                <span>{{ t('title_custom_global_variable') }}</span>\r\n              </div>\r\n              <div>\r\n                <a-tooltip\r\n                  placement=\"topRight\"\r\n                  :overlayStyle=\"{ maxWidth: '600px' }\"\r\n                >\r\n                  <template #title>\r\n                    <div v-html=\"t('tip_global_variable_definition')\"></div>\r\n                  </template>\r\n                  <QuestionCircleOutlined style=\"color: #595959; font-size: 16px\" />\r\n                </a-tooltip>\r\n              </div>\r\n            </div>\r\n            <div\r\n              class=\"options-item diy-options-item\"\r\n              :class=\"{ 'is-required': item.required }\"\r\n              v-for=\"(item, index) in diy_global\"\r\n              :key=\"item.key\"\r\n            >\r\n              <div class=\"options-item-body\">\r\n                <div class=\"option-label\">{{ item.key }}</div>\r\n                <div class=\"option-type\">{{ item.typ }}</div>\r\n                <a-tooltip :title=\"item.desc\">\r\n                  <div class=\"option-desc\">{{ item.desc }}</div>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"item-actions-box\">\r\n                <svg-icon\r\n                  class=\"action-btn\"\r\n                  name=\"edit-02\"\r\n                  @click=\"handleEdit(item, index)\"\r\n                ></svg-icon>\r\n                <svg-icon class=\"action-btn\" name=\"close-circle\" @click=\"handleDel(index)\"></svg-icon>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"action-items-box\">\r\n              <a-button style=\"width: 100%\" class=\"add-btn\" type=\"dashed\" @click=\"handleAdd\">\r\n                <template #icon>\r\n                  <PlusOutlined />\r\n                </template>\r\n                {{ t('btn_add_global_variable') }}\r\n              </a-button>\r\n            </div>\r\n          </div>\r\n\r\n          <a-modal\r\n            v-model:open=\"show\"\r\n            :title=\"t('title_add_variable')\"\r\n            :okText=\"t('btn_save')\"\r\n            :cancelText=\"t('btn_cancel')\"\r\n            @ok=\"handleOk\"\r\n          >\r\n            <a-form\r\n              ref=\"formRef\"\r\n              :model=\"formState\"\r\n              :rules=\"formRules\"\r\n              label-align=\"right\"\r\n              :label-col=\"{ span: 6}\"\r\n              :wrapper-col=\"{ span: 18 }\"\r\n            >\r\n              <a-form-item :label=\"t('label_variable_name')\" name=\"key\">\r\n                <a-input v-model:value=\"formState.key\" :placeholder=\"t('ph_input_variable_name')\" />\r\n              </a-form-item>\r\n              <a-form-item :label=\"t('label_type')\" name=\"typ\">\r\n                <a-select v-model:value=\"formState.typ\">\r\n                  <a-select-option :value=\"item.value\" v-for=\"item in typOptions\" :key=\"item.value\">\r\n                    <span>{{ item.lable }}</span>\r\n                  </a-select-option>\r\n                </a-select>\r\n              </a-form-item>\r\n              <a-form-item :label=\"t('label_required')\" name=\"required\">\r\n                <a-switch v-model:checked=\"formState.required\" />\r\n              </a-form-item>\r\n              <a-form-item :label=\"t('label_description')\" name=\"desc\">\r\n                <a-textarea v-model:value=\"formState.desc\" :placeholder=\"t('ph_input_description')\" />\r\n              </a-form-item>\r\n            </a-form>\r\n          </a-modal>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script>\r\nimport { computed } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { QuestionCircleOutlined, PlusOutlined } from '@ant-design/icons-vue'\r\nimport  {message } from 'ant-design-vue'\r\nimport { useWorkflowStore } from '@/stores/modules/workflow'\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'array<string>',\r\n    value: 'array<string>'\r\n  },\r\n  {\r\n    lable: 'array<number>',\r\n    value: 'array<number>'\r\n  },\r\n  {\r\n    lable: 'array<object>',\r\n    value: 'array<object>'\r\n  },\r\n]\r\n\r\nexport default {\r\n  emits: ['close', 'update-node'],\r\n  inject: ['getGraph'],\r\n  components: {\r\n    NodeFormLayout,\r\n    NodeFormHeader,\r\n    QuestionCircleOutlined,\r\n    PlusOutlined\r\n  },\r\n  props: {\r\n    nodeType: {\r\n      type: String,\r\n      default: 'start-node',\r\n    },\r\n    node: {\r\n      type: Object,\r\n      default: () => ({})\r\n    }\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.node-form-drawer.start-node-form.index')\r\n    const workflowStore = useWorkflowStore()\r\n\r\n    const formRules = computed(() => ({\r\n      key: [\r\n        { required: true, message: t('msg_input_variable_name'), trigger: 'blur' },\r\n        { pattern: /[a-zA-Z_][a-zA-Z0-9_\\-.]*/, message: t('msg_variable_name_format'), trigger: 'blur' },\r\n        { min: 1, max: 20, message: t('msg_variable_name_length'), trigger: 'blur' }\r\n      ],\r\n      typ: [\r\n        { required: true, message: t('msg_select_type'), trigger: 'change' }\r\n      ],\r\n      required: [\r\n        { required: true, message: t('msg_select_required'), trigger: 'change' }\r\n      ],\r\n      desc: [\r\n        { min: 1, max: 50, message: t('msg_description_length'), trigger: 'blur' }\r\n      ]\r\n    }))\r\n\r\n    return {\r\n      t,\r\n      workflowStore,\r\n      formRules\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      sys_global: [],\r\n      diy_global: [],\r\n      trigger_list:[],\r\n      show: false,\r\n      typOptions: [...typOptions],\r\n      formState: {\r\n        key: '',\r\n        value: '',\r\n        typ: 'string',\r\n        required: false,\r\n        desc: ''\r\n      },\r\n      editIndex: -1\r\n    }\r\n  },\r\n  mounted() {\r\n    let node_params = JSON.parse(this.node.node_params)\r\n    this.sys_global = node_params.start.sys_global\r\n    this.diy_global = node_params.start.diy_global\r\n    this.trigger_list = node_params.start.trigger_list\r\n  },\r\n  methods: {\r\n    update() {\r\n      let node_params = JSON.parse(this.node.node_params)\r\n\r\n      node_params.start.diy_global = [...this.diy_global]\r\n\r\n      let data = {\r\n        ...this.node,\r\n        node_params: JSON.stringify(node_params)\r\n      }\r\n\r\n      this.$emit('update-node', data)\r\n    },\r\n    handleAddTrigger(){\r\n      this.workflowStore.getTriggerList(this.$route.query.robot_key, true);\r\n      this.getGraph().eventCenter.emit('custom:showTriggerLit')\r\n    },\r\n    getTriggerVariables(){\r\n      let variables = {}\r\n      this.trigger_list.forEach(item => {\r\n        let outputs = item.outputs || []\r\n        outputs.forEach(output => {\r\n          variables[output.variable] = {...output}\r\n        })\r\n      })\r\n\r\n      return variables;\r\n    },\r\n    handleAdd(){\r\n      this.formState = {\r\n        key: '',\r\n        value: '',\r\n        typ:'string',\r\n        required: false,\r\n        desc: ''\r\n      }\r\n      this.editIndex = -1\r\n      this.show = true\r\n    },\r\n    handleEdit(item, index){\r\n      this.formState = {...item}\r\n      this.editIndex = index\r\n      this.show = true\r\n    },\r\n    handleDel(index){\r\n      this.getTriggerVariables()\r\n      // 判断是不是被触发器关联的变量\r\n      let triggerVariableMap = this.getTriggerVariables()\r\n      let field = this.diy_global[index]\r\n\r\n      if(triggerVariableMap['global.' + field.key]){\r\n        return message.error(t('msg_variable_linked_to_trigger'))\r\n      }\r\n \r\n      this.diy_global.splice(index, 1)\r\n      this.update()\r\n    },\r\n    async handleOk() {\r\n      try {\r\n        await this.$refs.formRef.validate()\r\n        if(this.editIndex > -1){\r\n          this.diy_global.splice(this.editIndex, 1, {...this.formState})\r\n          this.editIndex = -1\r\n        }else{\r\n          this.diy_global.push({...this.formState})\r\n        }\r\n        \r\n        this.show = false\r\n        this.formState = {\r\n          key: '',\r\n          value: '',\r\n          typ: 'string',\r\n          required: false,\r\n          desc: ''\r\n        }\r\n\r\n        this.update()\r\n      } catch (error) {\r\n        console.log(t('msg_validation_failed'))\r\n      }\r\n    },\r\n  }\r\n}\r\n</script>\r\n","<template>\r\n  <div class=\"cascade-panel\">\r\n    <div\r\n      class=\"cascade-panel-container\"\r\n      :class=\"[\r\n        `expand-direction-${expandDirection}`\r\n      ]\"\r\n    >\r\n      <!-- 级联面板列表 -->\r\n      <div class=\"cascade-panel-list\" v-for=\"(level, levelIndex) in activePath\" :key=\"levelIndex\">\r\n        <!-- <div class=\"cascade-panel-header\" v-if=\"level.title\">\r\n          {{ level.title }}\r\n        </div> -->\r\n        <div class=\"cascade-panel-body\">\r\n          <div\r\n            class=\"cascade-panel-item\"\r\n            v-for=\"item in level.options\"\r\n            :key=\"item.value\"\r\n            :class=\"{ 'active': isActive(item, levelIndex) }\"\r\n            @click=\"handleSelect(item, levelIndex, $event)\"\r\n          >\r\n            <div class=\"item-content\">\r\n              <span class=\"item-label\">{{ item.label }}</span>\r\n              <span class=\"item-icon\" @click=\"handleRightClick\" v-if=\"hasChildren(item)\">\r\n                <svg viewBox=\"0 0 1024 1024\" width=\"12\" height=\"12\">\r\n                  <path d=\"M765.7 486.8L314.9 134.7c-5.3-4.1-12.9-0.4-12.9 6.3v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1c16.4-12.8 16.4-37.6 0-50.4z\" fill=\"currentColor\"></path>\r\n                </svg>\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div class=\"cascade-panel-empty\" v-if=\"level.options && level.options.length === 0\">\r\n            {{ t('msg_no_data') }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: \"CascadePanel\",\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.at-input.cascade-panel')\r\n    return {\r\n      t\r\n    }\r\n  },\r\n  props: {\r\n    // 级联选项数据\r\n    options: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    // 默认选中的值\r\n    value: {\r\n      type: [String, Number, Array],\r\n      default: \"\"\r\n    },\r\n    // 是否允许选择任意一级\r\n    checkAnyLevel: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    // 子选项的属性名\r\n    childrenKey: {\r\n      type: String,\r\n      default: \"children\"\r\n    },\r\n    // 值的属性名\r\n    valueKey: {\r\n      type: String,\r\n      default: \"value\"\r\n    },\r\n    // 标签的属性名\r\n    labelKey: {\r\n      type: String,\r\n      default: \"label\"\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      // 当前激活的路径\r\n      activePath: [],\r\n      // 当前选中的值路径\r\n      selectedValuePath: [],\r\n      // 当前选中的选项路径\r\n      selectedPath: [],\r\n      // 子菜单展开方向\r\n      expandDirection: 'right', // 'left' or 'right'\r\n      isClickRight: false,\r\n    };\r\n  },\r\n  watch: {\r\n    options: {\r\n      handler() {\r\n        this.initPanel();\r\n      },\r\n      immediate: true\r\n    },\r\n    value: {\r\n      handler(val) {\r\n        if (val) {\r\n          this.initSelectedPath();\r\n        }\r\n      },\r\n      immediate: true\r\n    }\r\n  },\r\n  methods: {\r\n    // 初始化面板\r\n    initPanel() {\r\n      if (!this.options || this.options.length === 0) {\r\n        this.activePath = [];\r\n        return;\r\n      }\r\n      \r\n      // 初始化第一级\r\n      this.activePath = [{\r\n        title: \"\",\r\n        options: this.options,\r\n        level: 0\r\n      }];\r\n      \r\n      // 如果有默认值，初始化选中路径\r\n      if (this.value) {\r\n        this.initSelectedPath();\r\n      }\r\n    },\r\n    \r\n    // 初始化选中路径\r\n    initSelectedPath() {\r\n      // 如果值是数组，表示已经是完整路径\r\n      if (Array.isArray(this.value)) {\r\n        this.selectedValuePath = [...this.value];\r\n        this.findPathByValues(this.selectedValuePath);\r\n      } else {\r\n        // 如果是单个值，需要查找完整路径\r\n        this.findPathByValue(this.value);\r\n      }\r\n    },\r\n    \r\n    // 根据单个值查找路径\r\n    findPathByValue(value) {\r\n      const path = [];\r\n      const valuePath = [];\r\n      \r\n      // 递归查找路径\r\n      const find = (options, level) => {\r\n        if (!options || options.length === 0) return false;\r\n        \r\n        for (let i = 0; i < options.length; i++) {\r\n          const item = options[i];\r\n          const itemValue = item[this.valueKey];\r\n          \r\n          // 找到匹配项\r\n          if (itemValue === value) {\r\n            path[level] = item;\r\n            valuePath[level] = itemValue;\r\n            return true;\r\n          }\r\n          \r\n          // 递归查找子项\r\n          if (item[this.childrenKey] && item[this.childrenKey].length > 0) {\r\n            path[level] = item;\r\n            valuePath[level] = itemValue;\r\n            \r\n            if (find(item[this.childrenKey], level + 1)) {\r\n              return true;\r\n            }\r\n            \r\n            // 未找到，回溯\r\n            path[level] = null;\r\n            valuePath[level] = null;\r\n          }\r\n        }\r\n        \r\n        return false;\r\n      };\r\n      \r\n      find(this.options, 0);\r\n      \r\n      // 过滤掉空值\r\n      this.selectedPath = path.filter(item => item);\r\n      this.selectedValuePath = valuePath.filter(item => item != null);\r\n      \r\n      // 更新激活路径\r\n      this.updateActivePath();\r\n    },\r\n    \r\n    // 根据值数组查找路径\r\n    findPathByValues(values) {\r\n      if (!values || values.length === 0) return;\r\n      \r\n      const path = [];\r\n      let currentOptions = this.options;\r\n      \r\n      // 遍历值数组，查找对应的选项\r\n      for (let i = 0; i < values.length; i++) {\r\n        const value = values[i];\r\n        const found = currentOptions.find(item => item[this.valueKey] === value);\r\n        \r\n        if (found) {\r\n          path.push(found);\r\n          currentOptions = found[this.childrenKey] || [];\r\n        } else {\r\n          break;\r\n        }\r\n      }\r\n      \r\n      this.selectedPath = path;\r\n      \r\n      // 更新激活路径\r\n      this.updateActivePath();\r\n    },\r\n    \r\n    // 更新激活路径\r\n    updateActivePath() {\r\n      if (!this.selectedPath || this.selectedPath.length === 0) {\r\n        this.activePath = [{\r\n          title: \"\",\r\n          options: this.options,\r\n          level: 0\r\n        }];\r\n        return;\r\n      }\r\n      \r\n      // 重置激活路径\r\n      this.activePath = [];\r\n      \r\n      // 第一级\r\n      this.activePath.push({\r\n        title: \"\",\r\n        options: this.options,\r\n        level: 0\r\n      });\r\n      \r\n      // 根据选中路径构建激活路径\r\n      for (let i = 0; i < this.selectedPath.length; i++) {\r\n        const item = this.selectedPath[i];\r\n        \r\n        // 如果有子选项，添加到激活路径\r\n        if (item[this.childrenKey] && item[this.childrenKey].length > 0) {\r\n          this.activePath.push({\r\n            title: item[this.labelKey],\r\n            options: item[this.childrenKey],\r\n            level: i + 1\r\n          });\r\n        }\r\n      }\r\n    },\r\n    handleRightClick(){\r\n      // 判断当前点击的是不是右边的按钮\r\n      this.isClickRight = true\r\n    },\r\n    \r\n    // 处理选择\r\n    handleSelect(item, levelIndex, e) {\r\n      // 在有子节点的情况下，判断下一次展开的方向\r\n      if (this.hasChildren(item)) {\r\n        this.checkDirection();\r\n      }\r\n\r\n      // 更新选中路径\r\n      this.selectedPath = this.selectedPath.slice(0, levelIndex);\r\n      this.selectedPath.push(item);\r\n      \r\n      // 更新选中值路径\r\n      this.selectedValuePath = this.selectedValuePath.slice(0, levelIndex);\r\n      this.selectedValuePath.push(item[this.valueKey]);\r\n      \r\n      // 更新激活路径\r\n      this.activePath = this.activePath.slice(0, levelIndex + 1);\r\n      \r\n      // 如果有子选项，添加到激活路径\r\n      if (this.hasChildren(item)) {\r\n        this.activePath.push({\r\n          title: item[this.labelKey],\r\n          options: item[this.childrenKey],\r\n          level: levelIndex + 1\r\n        });\r\n      }\r\n      \r\n      // 发送选中事件\r\n      this.$emit('select', item, this.selectedPath, levelIndex);\r\n      \r\n      // 如果允许选择任意一级，或者是叶子节点，发送change事件\r\n      if ((this.checkAnyLevel && !this.isClickRight && levelIndex > 0) || !this.hasChildren(item)) {\r\n        this.$emit('change', item[this.valueKey], this.selectedValuePath, this.selectedPath);\r\n        this.$emit('input', this.checkAnyLevel ? this.selectedValuePath : item[this.valueKey]);\r\n      }\r\n      this.isClickRight = false\r\n    },\r\n    \r\n    // 判断是否是激活项\r\n    isActive(item, levelIndex) {\r\n      if (!this.selectedPath || this.selectedPath.length <= levelIndex) {\r\n        return false;\r\n      }\r\n      return item[this.valueKey] === this.selectedPath[levelIndex][this.valueKey];\r\n    },\r\n    \r\n    // 判断是否有子选项\r\n    hasChildren(item) {\r\n      return item[this.childrenKey] && item[this.childrenKey].length > 0;\r\n    },\r\n\r\n    // 检查并设置下一次展开的方向\r\n    checkDirection() {\r\n      this.$nextTick(() => {\r\n        const panelEl = this.$el;\r\n        if (!panelEl) return;\r\n\r\n        const rect = panelEl.getBoundingClientRect();\r\n        const viewportWidth = window.innerWidth;\r\n        \r\n        // 假设每个子面板的平均宽度为 180px (基于 min-width)\r\n        const estimatedNextPanelWidth = 180;\r\n\r\n        // 如果当前面板的右边缘 + 下一个面板的宽度 > 视口宽度\r\n        if (rect.right + estimatedNextPanelWidth > viewportWidth && rect.left > estimatedNextPanelWidth) {\r\n          // 并且左边有足够空间\r\n          if(this.expandDirection !== 'left'){\r\n            this.expandDirection = 'left';\r\n            this.$emit('direction-change', 'left', estimatedNextPanelWidth);\r\n          }\r\n        } else {\r\n          if(this.expandDirection !== 'right'){\r\n            this.expandDirection = 'right';\r\n            this.$emit('direction-change', 'right', estimatedNextPanelWidth);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 重置组件\r\n    reset() {\r\n      this.selectedPath = [];\r\n      this.selectedValuePath = [];\r\n      this.expandDirection = 'right'; // 重置方向\r\n      this.initPanel();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.cascade-panel {\r\n  width: 100%;\r\n  background-color: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05);\r\n  \r\n  &-container {\r\n    display: flex;\r\n    max-height: 300px;\r\n    overflow: hidden;\r\n\r\n    &.expand-direction-left {\r\n      flex-direction: row-reverse;\r\n\r\n      .cascade-panel-list {\r\n        border-right: none;\r\n        border-left: 1px solid #f0f0f0;\r\n\r\n        &:last-child {\r\n          border-left: none;\r\n        }\r\n\r\n        .item-icon {\r\n          transform: rotate(180deg);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  &-list {\r\n    min-width: 180px;\r\n    max-width: 300px;\r\n    border-right: 1px solid #f0f0f0;\r\n    display: flex;\r\n    flex-direction: column;\r\n    \r\n    &:last-child {\r\n      border-right: none;\r\n    }\r\n  }\r\n  \r\n  &-header {\r\n    padding: 8px 12px;\r\n    font-size: 14px;\r\n    color: rgba(0, 0, 0, 0.45);\r\n    border-bottom: 1px solid #f0f0f0;\r\n    background-color: #fafafa;\r\n  }\r\n  \r\n  &-body {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    max-height: 300px;\r\n    \r\n    &::-webkit-scrollbar {\r\n      width: 6px;\r\n      height: 6px;\r\n    }\r\n    \r\n    &::-webkit-scrollbar-track {\r\n      background-color: #fafafa;\r\n    }\r\n    \r\n    &::-webkit-scrollbar-thumb {\r\n      border-radius: 3px;\r\n      background: #c1c1c1;\r\n    }\r\n  }\r\n  \r\n  &-item {\r\n    padding: 8px 12px;\r\n    cursor: pointer;\r\n    transition: background 0.3s;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    \r\n    &:hover {\r\n      background: rgba(0, 0, 0, 0.04);\r\n    }\r\n    \r\n    &.active {\r\n      background: #e6f7ff;\r\n      color: #1890ff;\r\n      font-weight: 500;\r\n    }\r\n    \r\n    .item-content {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      width: 100%;\r\n    }\r\n    \r\n    .item-label {\r\n      flex: 1;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n    }\r\n    \r\n    .item-icon {\r\n      width: 24px;\r\n      color: rgba(0, 0, 0, 0.45);\r\n      text-align: right;\r\n    }\r\n  }\r\n  \r\n  &-empty {\r\n    padding: 16px 12px;\r\n    text-align: center;\r\n    color: rgba(0, 0, 0, 0.45);\r\n    font-size: 14px;\r\n  }\r\n}\r\n</style>","<template>\r\n  <div style=\"width: 100%;position: relative;\">\r\n    <div></div>\r\n    <Teleport to=\"body\">\r\n      <div class=\"dropdown-list\" ref=\"dropdownList\" v-if=\"showDropdown\" :style=\"positionStyle\">\r\n        <CascadePanel\r\n          :options=\"showOptions\"\r\n          :checkAnyLevel=\"checkAnyLevel\"\r\n          @change=\"onSelectOption\"\r\n          @direction-change=\"handleDirectionChange\"\r\n        />\r\n      </div>\r\n    </Teleport>\r\n    <div class=\"mention-input-warpper\" :class=\"{'no-border': !bordered}\" ref=\"JMentionContainer\" >\r\n      <div\r\n      ref=\"JMention\"\r\n      :style=\"[inputStyle]\"\r\n      class=\"j-mention\"\r\n      :class=\"[{'show-placeholder': localValue.length == 0, }, 'type-'+type]\"\r\n      contenteditable=\"plaintext-only\"\r\n      :placeholder=\"computedPlaceholder\"\r\n      @focus=\"onFocus\"\r\n      @input=\"debouncedUpdate\"\r\n      @click=\"clickJMention\"\r\n      @blur=\"handleBlur\"></div>\r\n        <span class=\"placeholder\" v-if=\"localValue.length == 0\">{{ computedPlaceholder }}</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CascadePanel from './cascade-panel.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\n// 把树状的options抓换成编排的数组\r\nconst getTreeOptions = (options) => {\r\n  let result = [];\r\n  options.forEach((opt) => {\r\n    if (opt.children && opt.children.length > 0) {\r\n      result.push(...getTreeOptions(opt.children));\r\n    } else {\r\n      result.push(opt);\r\n    }\r\n  });\r\n  return result;\r\n}\r\n\r\nexport default {\r\n  name: \"JMention\",\r\n  components: {\r\n    CascadePanel,\r\n  },\r\n  inject: [],\r\n  emits: [\"input\", 'change', \"update:selectedList\", \"focus\", 'open'],\r\n  props: {\r\n    type: {\r\n      type: String,\r\n      default: \"input\", // input, textarea\r\n      validator(value) {\r\n        return [\"input\", \"textarea\"].includes(value);\r\n      },\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: \"ph_input\",\r\n    },\r\n    defaultValue: {\r\n      type: [String, Number],\r\n      default: \"\",\r\n    },\r\n    options: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    defaultSelectedList: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    canRepeat: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    isContain: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    inputStyle: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    checkAnyLevel:{\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    bordered: {\r\n      type: Boolean,\r\n      default: true,\r\n    }\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.at-input.at-input')\r\n    return {\r\n      t\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      timer: null,\r\n      showDropdown: false,\r\n      positionStyle: \"\",\r\n      selectedList: [],\r\n      selectedIdSet: new Set(),\r\n      showOptions: [],\r\n      atText: \"\",\r\n      localValue: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    computedPlaceholder() {\r\n      return this.placeholder === 'ph_input' ? this.t('ph_input') : this.placeholder\r\n    }\r\n  },\r\n  watch: {\r\n    defaultValue(val){\r\n      if(val.trim() != this.localValue.trim()){\r\n        this.refresh()\r\n      }\r\n    },\r\n    showDropdown(val){\r\n      this.onOpen(val);\r\n    },\r\n    options(){\r\n      this.initShowOptionList();\r\n    },\r\n  },\r\n  mounted() {\r\n    this.initShowOptionList();\r\n\r\n    document.addEventListener(\"dragstart\", this.handleDragstart);\r\n    document.addEventListener(\"click\", this.handleClick);\r\n    document.addEventListener(\"scroll\", this.onScroll);\r\n\r\n    this.initData();\r\n  },\r\n  beforeUnmount() {\r\n    document.removeEventListener(\"dragstart\", this.handleDragstart);\r\n    document.removeEventListener(\"click\", this.handleClick);\r\n    document.removeEventListener(\"scroll\", this.onScroll);\r\n  },\r\n  methods: {\r\n    handleClick(e){\r\n      const target = e.target.closest(\".dropdown-list\");\r\n      if (!target) {\r\n        this.hideDropdownMenus()\r\n      }\r\n    },\r\n    handleDragstart(e){\r\n      const target = e.target.closest(\".dropdown-list\");\r\n      if (target) {\r\n        e.preventDefault();\r\n      }\r\n    },\r\n    onScroll(){\r\n      this.hideDropdownMenus()\r\n    },\r\n    hideDropdownMenus() {\r\n      this.showDropdown = false;\r\n    },\r\n    onFocus(){\r\n      this.$emit(\"focus\");\r\n    },\r\n    onOpen(val){\r\n      this.$emit(\"open\", val);\r\n    },\r\n    getText(htmlStr){\r\n      const div = document.createElement('div');\r\n      div.innerHTML = htmlStr;\r\n      let text = '';\r\n        // 遍历子节点\r\n        Array.from(div.childNodes).forEach(node => {\r\n        let textContent = '';\r\n        if(this.type === 'textarea'){\r\n          // textarea\r\n          if(node.nodeName === 'BR'){ // 如果是BR节点,直接添加换行\r\n            textContent = '\\n';\r\n          }else{\r\n            if (node.classList && node.classList.contains('j-mention-at')) {\r\n              textContent = node.dataset.value;\r\n            } else{\r\n              textContent = node.textContent\r\n            }\r\n          }\r\n        }else{\r\n          // input\r\n          if (node.classList && node.classList.contains('j-mention-at')) {\r\n            textContent = node.dataset.value;\r\n          }else if(node.nodeName === 'BR'){\r\n              textContent = '';\r\n          }else{\r\n            textContent = node.textContent.replace(/\\n/g, '');\r\n          }\r\n        }\r\n\r\n        // 去除只有&nbsp;字符的节点\r\n        if (textContent === '&nbsp;' || textContent === ' ') {\r\n          textContent = '';\r\n        }\r\n\r\n        // 拼接文本内容\r\n        text += textContent;\r\n      });\r\n\r\n      return text;\r\n    },\r\n    onChange(){\r\n      const jMention = this.$refs.JMention;\r\n\r\n      if(!jMention) return;\r\n\r\n      let htmlStr = jMention.innerHTML;\r\n      let text = this.getText(htmlStr);\r\n\r\n      this.localValue = text\r\n\r\n      let selectedListMap = {};\r\n\r\n      this.selectedList.forEach(item => {\r\n        if(!selectedListMap[item.value] && text.indexOf(item.value) !== -1){\r\n          selectedListMap[item.value] = item;\r\n        }\r\n      });\r\n\r\n      let mySelectedList = Object.values(selectedListMap);\r\n\r\n      this.$emit(\"change\", text.trim(), mySelectedList);\r\n    },\r\n    refresh(){\r\n      this.selectedList = [];\r\n      this.selectedIdSet = new Set();\r\n\r\n      this.initShowOptionList();\r\n      this.initData();\r\n    },\r\n    initData() {\r\n      const JMention = this.$refs.JMention;\r\n      // let html = this.defaultValue;\r\n      let html = this.defaultValue.toString()\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;');\r\n      let defaultSelectedList = this.defaultSelectedList || [];\r\n      let treeOptions = getTreeOptions(this.options);\r\n      let selectedList = [...defaultSelectedList, ...treeOptions].filter(item => item && item.value && item.value != '' && item.typ !== 'node');\r\n\r\n      // 记录已经替换过的的value\r\n      const replacedValues = new Set();\r\n\r\n      selectedList.forEach((opt) => {\r\n        // 使用正则匹配完整的value,避免部分匹配\r\n        const regex = new RegExp(`(${opt.value})`, 'g');\r\n        if(regex.test(this.defaultValue) && !replacedValues.has(opt.value)){\r\n          let text = opt.node_name + '.' + opt.text;\r\n\r\n          text = text.replace(/\\./g, '/')\r\n\r\n          html = html.replace(regex,\r\n            `<span class=\"j-mention-at\" data-id=\"${opt.node_id}\" contentEditable=\"false\" data-value=\"${opt.value}\">${text}</span>`\r\n          );\r\n\r\n          replacedValues.add(opt.value);\r\n\r\n          this.selectOption(opt, true);\r\n        }\r\n      });\r\n\r\n      JMention.innerHTML = html;\r\n      this.localValue = this.defaultValue;\r\n    },\r\n    initShowOptionList() {\r\n      this.showOptions = this.options.filter((opt) => {\r\n        if (this.atText) {\r\n          return opt.label.startsWith(this.atText);\r\n        }\r\n        if (this.canRepeat) return true;\r\n        return !this.selectedIdSet.has(opt.id + \"\");\r\n      });\r\n    },\r\n    getLastChar(len = 1) {\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return;\r\n      const range = selection.getRangeAt(0);\r\n      const startOffset = range.startOffset;\r\n      const startContainer = range.startContainer;\r\n      let textBeforeCursor = \"\";\r\n      if (startContainer.nodeType === Node.TEXT_NODE) {\r\n        textBeforeCursor = startContainer.textContent.slice(\r\n          0,\r\n          startOffset\r\n        );\r\n      } else if (startContainer.nodeType === Node.ELEMENT_NODE) {\r\n        // 若光标在元素节点内，获取其内部文本\r\n        const childNodes = startContainer.childNodes;\r\n        for (let i = 0; i < childNodes.length; i++) {\r\n          const node = childNodes[i];\r\n          if (node.nodeType === Node.TEXT_NODE) {\r\n            if (i === childNodes.length - 1) {\r\n              textBeforeCursor += node.textContent.slice(\r\n                0,\r\n                startOffset\r\n              );\r\n            } else {\r\n              textBeforeCursor += node.textContent;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return textBeforeCursor.slice(-len);\r\n    },\r\n    getLastAtText() {\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return;\r\n      const range = selection.getRangeAt(0);\r\n      const startOffset = range.startOffset;\r\n      const startContainer = range.startContainer;\r\n      let textBeforeCursor = \"\";\r\n      if (startContainer.nodeType === Node.TEXT_NODE) {\r\n        textBeforeCursor = startContainer.textContent.slice(\r\n          0,\r\n          startOffset\r\n        );\r\n      } else if (startContainer.nodeType === Node.ELEMENT_NODE) {\r\n        // 若光标在元素节点内，获取其内部文本\r\n        const childNodes = startContainer.childNodes;\r\n        for (let i = 0; i < childNodes.length; i++) {\r\n          const node = childNodes[i];\r\n          if (node.nodeType === Node.TEXT_NODE) {\r\n            if (i === childNodes.length - 1) {\r\n              textBeforeCursor += node.textContent.slice(\r\n                0,\r\n                startOffset\r\n              );\r\n            } else {\r\n              textBeforeCursor += node.textContent;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      const lastAtIndex = textBeforeCursor.lastIndexOf(\"/\");\r\n      if (lastAtIndex === -1) return \"\";\r\n      return textBeforeCursor.slice(lastAtIndex + 1);\r\n    },\r\n    async getCaretPosition() {\r\n      // const JMention = this.$refs.JMention;\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return { top: 0, left: 0 };\r\n      const range = selection.getRangeAt(0);\r\n      const rect = range.getBoundingClientRect();\r\n      const dropdownListRect = await this.getDropdownListSize();\r\n      const viewportWidth = window.innerWidth;\r\n      const viewportHeight = window.innerHeight;\r\n\r\n      let top = rect.bottom;\r\n      let left = rect.left;\r\n\r\n      // 自动垂直定位：如果下方空间不足，则移动到上方\r\n      if (top + dropdownListRect.height > viewportHeight) {\r\n        top = rect.top - dropdownListRect.height;\r\n      }\r\n\r\n      // 自动水平定位：如果右侧空间不足，则向左对齐\r\n      if (left + dropdownListRect.width > viewportWidth) {\r\n        left = rect.right - dropdownListRect.width;\r\n      }\r\n\r\n      // 确保不会超出视口顶部和左部\r\n      if (top < 0) {\r\n        top = 0;\r\n      }\r\n      if (left < 0) {\r\n        left = 0;\r\n      }\r\n\r\n      return {\r\n        top,\r\n        left,\r\n      };\r\n    },\r\n    async getDropdownListSize() {\r\n      this.showDropdown = true; // 临时显示元素\r\n      await this.$nextTick(); // 等待 DOM 更新\r\n      const width = this.$refs.dropdownList.offsetWidth;\r\n      const height = this.$refs.dropdownList.offsetHeight;\r\n      this.showDropdown = false; // 恢复隐藏\r\n      return { width, height };\r\n    },\r\n    updateSelectedList() {\r\n      const JMention = this.$refs.JMention;\r\n      const nodeList = JMention.querySelectorAll(\".j-mention-at\");\r\n      this.selectedList = [];\r\n      this.selectedIdSet = new Set();\r\n\r\n      for (const node of nodeList) {\r\n        // const { value } = node.dataset;\r\n        let value = node.dataset.value;\r\n        const item = this.options.find((opt) => {\r\n          return opt.value == value;\r\n        });\r\n\r\n        this.selectedList.push(item);\r\n        this.selectedIdSet.add(value);\r\n      }\r\n      this.$emit(\"update:selectedList\", this.selectedList);\r\n      if (\r\n        nodeList.length === this.selectedList.length &&\r\n        !this.atText &&\r\n        !this.showDropdown\r\n      ){\r\n        return;\r\n      }\r\n\r\n      this.initShowOptionList();\r\n    },\r\n    checkStartWith(text) {\r\n      const list = this.options.filter((opt) => {\r\n        return opt.label.startsWith(text);\r\n      });\r\n      return list.length > 0;\r\n    },\r\n    updateValue() {\r\n      this.onChange();\r\n    },\r\n    clickJMention() {\r\n      if(this.showDropdown){\r\n        this.showDropdown = false;\r\n      }\r\n    },\r\n    debouncedUpdate(e) {\r\n      // 1. 优先处理下拉菜单的UI逻辑，这需要实时响应\r\n      this.handleDropdownLogic(e);\r\n\r\n      // 2. 将数据更新操作放入防抖函数中\r\n      // 清除上一个计时器\r\n      if (this.timer) {\r\n        clearTimeout(this.timer);\r\n      }\r\n      // 设置一个新的计时器，在用户停止输入200ms后执行 updateValue\r\n      this.timer = setTimeout(() => {\r\n        this.updateValue();\r\n      }, 350);\r\n    },\r\n    handleBlur() {\r\n      // 当输入框失焦时，为了确保数据最终被同步，立即执行一次 updateValue\r\n      // 同时清除可能存在的防抖计时器，避免重复执行\r\n      if (this.timer) {\r\n        clearTimeout(this.timer);\r\n      }\r\n      this.updateValue();\r\n    },\r\n    async handleDropdownLogic(e) {\r\n      // 获取光标前的最后一个字符。此操作依赖于当前的DOM状态，应在任何DOM修改前执行。\r\n      const lastChar = this.getLastChar();\r\n\r\n      // --- 场景1: 用户执行删除操作 ---\r\n      if (e.inputType === \"deleteContentBackward\" && !this.atText) {\r\n        if(lastChar != '/'){\r\n          this.showDropdown = false;\r\n        }\r\n      } else {\r\n        // --- 场景2: 用户输入'/'，触发提及功能 ---\r\n        if (lastChar === \"/\") {\r\n          this.showDropdown = true;\r\n          this.atText = \"\";\r\n        } else {\r\n          // --- 场景3: 用户在'/'后输入文本，进行筛选 ---\r\n          const text = this.getLastAtText();\r\n          this.atText = text;\r\n          const isExistStartWith = this.checkStartWith(text);\r\n          if (text) {\r\n            this.showDropdown = isExistStartWith;\r\n          }\r\n        }\r\n      }\r\n\r\n      // 如果不显示下拉菜单，则提前退出定位逻辑\r\n      if (!this.showDropdown) {\r\n        return;\r\n      }\r\n\r\n      // --- 定位并最终显示下拉菜单 ---\r\n      const { top, left } = await this.getCaretPosition();\r\n      this.showDropdown = true;\r\n      this.positionStyle = `left:${left}px; top:${top}px;`;\r\n    },\r\n    insertAtCaret(text, dataSet) {\r\n      let len = this.atText.length + 1;\r\n      const lastChar = this.getLastChar(len);\r\n      if (lastChar !== \"/\" + this.atText) len = 0;\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return;\r\n      const range = selection.getRangeAt(0);\r\n      const startOffset = range.startOffset;\r\n      const startContainer = range.startContainer;\r\n\r\n      let prevCharOffset = startOffset - len;\r\n      let prevCharNode = startContainer;\r\n      if (prevCharOffset < 0) {\r\n        // 如果当前节点没有前一个字符，查找前一个兄弟节点\r\n        let prevSibling = startContainer.previousSibling;\r\n        while (prevSibling) {\r\n          if (prevSibling.nodeType === Node.TEXT_NODE) {\r\n            prevCharOffset = prevSibling.textContent.length - len;\r\n            prevCharNode = prevSibling;\r\n            break;\r\n          }\r\n          prevSibling = prevSibling.previousSibling;\r\n        }\r\n      }\r\n\r\n      if (prevCharNode.nodeType === Node.TEXT_NODE) {\r\n        // 将触发词替换为空字符串，而不是空格，以避免在span后留下多余的空格\r\n        prevCharNode.replaceData(prevCharOffset, len, \"\");\r\n\r\n        // 创建 span 标签\r\n        const span = document.createElement(\"span\");\r\n        span.contentEditable = \"false\";\r\n        span.classList.add(\"j-mention-at\");\r\n        span.style = this.atTextStyle;\r\n        span.textContent = `${text}`;\r\n\r\n        // const tmp = document.createElement(\"span\");\r\n        // tmp.contentEditable = true;\r\n        // tmp.innerHTML += \"&nbsp;\";\r\n        // tmp.classList.add(\"at-space\");\r\n\r\n        for (const key in dataSet) {\r\n          span.dataset[key] = dataSet[key];\r\n        }\r\n\r\n        // 在原字符位置插入 span 标签\r\n        const newRange = document.createRange();\r\n        newRange.setStart(prevCharNode, prevCharOffset);\r\n        newRange.insertNode(span);\r\n        // newRange.insertNode(tmp);\r\n\r\n        // 将光标移动到 span 元素外部\r\n        // 将光标移动到 span 元素之后\r\n        range.setStartAfter(span);\r\n        range.setEndAfter(span);\r\n\r\n        selection.removeAllRanges();\r\n        selection.addRange(range);\r\n      }\r\n    },\r\n    onSelectOption(value, selectedValuePath, selectedPath) {\r\n      let item = selectedPath[selectedPath.length - 1];\r\n      delete item['children'];\r\n      this.selectOption(item)\r\n    },\r\n    selectOption(opt, isInit = false) {\r\n      if (!opt) return;\r\n      // 处理用户选择逻辑\r\n      this.showDropdown = false;\r\n\r\n      let text = opt.node_name + '.' + opt.text;\r\n\r\n      text = text.replace(/\\./g, '/')\r\n\r\n      const dataSet = {\r\n        id: opt.id ,\r\n        label: opt.label,\r\n        value: opt.value,\r\n        text: opt.text,\r\n        index: this.selectedList.length,\r\n      };\r\n\r\n      this.selectedList.push(opt);\r\n      this.selectedIdSet.add(opt.value);\r\n\r\n      if (!isInit) {\r\n        this.insertAtCaret(text, dataSet);\r\n        this.initShowOptionList();\r\n        // 在插入提及内容后，立即更新值以确保数据同步\r\n        this.updateValue();\r\n      }\r\n    },\r\n\r\n    handleDirectionChange(direction, width) {\r\n      const leftMatch = this.positionStyle.match(/left:\\s*(-?\\d+\\.?\\d*)px/);\r\n      const topMatch = this.positionStyle.match(/top:\\s*(-?\\d+\\.?\\d*)px/);\r\n\r\n      if (!leftMatch || !topMatch) return;\r\n\r\n      const currentLeft = parseFloat(leftMatch[1]);\r\n      const currentTop = parseFloat(topMatch[1]);\r\n      let newLeft;\r\n\r\n      if (direction === 'left') {\r\n        newLeft = currentLeft - width;\r\n      } else {\r\n        newLeft = currentLeft + width;\r\n      }\r\n\r\n      this.positionStyle = `left:${newLeft}px; top:${currentTop}px;`;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\">\r\n.mention-input-warpper .j-mention-at {\r\n  border-radius: 4px;\r\n  padding: 1px 4px;\r\n  background: #f2f4f5;\r\n  user-select: text;\r\n  -webkit-user-select: text;\r\n  -moz-user-select: text;\r\n  -ms-user-select: text;\r\n}\r\n</style>\r\n<style lang=\"less\" scoped>\r\n.mention-input-warpper {\r\n  position: relative;\r\n  overflow: hidden;\r\n  border-radius: 6px;\r\n  padding: 4px 8px;\r\n  border: 1px solid #d9d9d9;\r\n  background: #fff;\r\n  &.no-border{\r\n    border: none;\r\n    &:hover {\r\n      border: none;\r\n    }\r\n  }\r\n\r\n  &:hover {\r\n    border: 1px solid #409eff;\r\n  }\r\n\r\n  &:focus {\r\n    border-color: #4d94ff;\r\n    box-shadow: 0 0 0 2px rgba(5, 138, 255, 0.06);\r\n    border-inline-end-width: 1px;\r\n    outline: 0;\r\n  }\r\n}\r\n.j-mention {\r\n  position: relative;\r\n  overflow: scroll;\r\n  width: 100%;\r\n  line-height: 22px;\r\n  min-height: 22px;\r\n  outline: none;\r\n  background: #fff;\r\n\r\n  &.type-input{\r\n    overflow-y: hidden;\r\n    overflow-x: scroll;\r\n    white-space: nowrap;\r\n  }\r\n\r\n  &.type-textarea{\r\n    white-space: pre-wrap;\r\n    word-wrap: break-word;\r\n    min-height: 64px;\r\n  }\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 0px;\r\n    height: 0px;\r\n  }\r\n\r\n  /*定义滚动条轨道 内阴影+圆角*/\r\n  &::-webkit-scrollbar-track {\r\n    border-radius: 0px;\r\n    background-color: #fafafa;\r\n  }\r\n\r\n  /*定义滑块 内阴影+圆角*/\r\n  &::-webkit-scrollbar-thumb {\r\n    border-radius: 0px;\r\n    background: rgb(191, 191, 191);\r\n  }\r\n}\r\n.placeholder{\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    line-height: 22px;\r\n    overflow: hidden;\r\n    padding: 4px 8px;\r\n    color: #bfbfbf;\r\n    pointer-events: none;\r\n    user-select: none;\r\n  }\r\n.dropdown-list {\r\n  position: fixed;\r\n  padding: 0;\r\n  margin: 0;\r\n  background-color: #fff;\r\n  z-index: 999999;\r\n  min-width: 180px;\r\n  overflow: hidden;\r\n  user-select: none;\r\n  border-radius: 8px;\r\n  box-shadow: 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05);\r\n\r\n  .dropdown-list-nodata {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    height: 100%;\r\n    font-size: 13px;\r\n    padding: 8px;\r\n  }\r\n\r\n  .dropdown-list-item {\r\n    padding: 8px;\r\n    cursor: pointer;\r\n    background: #fff;\r\n\r\n    &:hover {\r\n      background-color: rgba(0, 0, 0, 0.04) !important;\r\n    }\r\n\r\n    &.active {\r\n      background-color: rgba(0, 0, 0, 0.09) !important;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 0px;\r\n    height: 0px;\r\n  }\r\n\r\n  /*定义滚动条轨道 内阴影+圆角*/\r\n  &::-webkit-scrollbar-track {\r\n    border-radius: 0px;\r\n    background-color: #fafafa;\r\n  }\r\n\r\n  /*定义滑块 内阴影+圆角*/\r\n  &::-webkit-scrollbar-thumb {\r\n    border-radius: 0px;\r\n    background: rgb(191, 191, 191);\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_problem_optimization')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\" @mousedown.stop=\"\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('label_input') }}</div>\r\n            <a-form-item :label=\"t('label_llm_model')\" name=\"use_model\">\r\n              <div class=\"flex-block-item\">\r\n                <ModelSelect\r\n                  modelType=\"LLM\"\r\n                  v-model:modeName=\"formState.use_model\"\r\n                  v-model:modeId=\"formState.model_config_id\"\r\n                  @loaded=\"onVectorModelLoaded\"\r\n                  @change=\"handleModelChange\"\r\n                  style=\"width: 348px\"\r\n                />\r\n                <!-- <DownOutlined /> -->\r\n                <a-button @click=\"hanldeShowMore\"\r\n                  >{{ t('btn_advanced_settings') }}\r\n                  <DownOutlined v-if=\"showMoreBtn\" />\r\n                  <UpOutlined v-else />\r\n                </a-button>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"role\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_prompt_role') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>\r\n                    <div>\r\n                      {{ t('tip_prompt_role_desc') }}\r\n                      <div>{{ t('label_system_role_example') }}</div>\r\n                      <div>{\"role\": \"system\", \"content\": \"{{ t('sample_custom_prompt') }}\"}</div>\r\n                    </div>\r\n                  </template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <a-radio-group v-model:value=\"formState.role\">\r\n                <a-radio :value=\"1\">{{ t('label_system_role') }}</a-radio>\r\n                <a-radio :value=\"2\">{{ t('label_user_role') }}</a-radio>\r\n              </a-radio-group>\r\n            </a-form-item>\r\n            <a-form-item name=\"temperature\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_temperature') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_temperature_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.temperature\"\r\n                      :min=\"0\"\r\n                      :max=\"2\"\r\n                      :step=\"0.1\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number\r\n                    v-model:value=\"formState.temperature\"\r\n                    :min=\"0\"\r\n                    :max=\"2\"\r\n                    :step=\"0.1\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"max_token\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_max_token') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_max_token_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.max_token\"\r\n                      :min=\"0\"\r\n                      :max=\"100 * 1024\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.max_token\" :min=\"0\" :max=\"100 * 1024\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"enable_thinking\" v-if=\"showMoreBtn && show_enable_thinking\">\r\n              <template #label>\r\n                <span>{{ t('label_deep_thinking') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_deep_thinking_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <a-switch v-model:checked=\"formState.enable_thinking\" />\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"context_pair\">\r\n              <template #label>\r\n                <span>{{ t('label_context_pair') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title\r\n                    >{{ t('tip_context_pair_desc') }}</template\r\n                  >\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.context_pair\"\r\n                      :min=\"0\"\r\n                      :max=\"50\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.context_pair\" :min=\"0\" :max=\"50\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"prompt\" class=\"width-100\">\r\n              <template #label>\r\n                <div class=\"space-between-box\">\r\n                  <div>{{ t('label_dialogue_background') }}</div>\r\n                  <!-- <div class=\"btn-hover-wrap\" @click=\"onShowAddPromptModal\">\r\n                  <DownloadOutlined />从提示词库导入\r\n                </div> -->\r\n                </div>\r\n              </template>\r\n              <at-input\r\n                type=\"textarea\"\r\n                inputStyle=\"height: 100px;\"\r\n                :options=\"variableOptions\"\r\n                :defaultSelectedList=\"formState.prompt_tags\"\r\n                :defaultValue=\"formState.prompt\"\r\n                ref=\"atInputRef\"\r\n                @open=\"getVlaueVariableList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n                :placeholder=\"t('ph_input_dialogue_background')\"\r\n              >\r\n                <template #option=\"{ label, payload }\">\r\n                  <div class=\"field-list-item\">\r\n                    <div class=\"field-label\">{{ label }}</div>\r\n                    <div class=\"field-type\">{{ payload.typ }}</div>\r\n                  </div>\r\n                </template>\r\n              </at-input>\r\n              <div class=\"form-tip\">{{ t('msg_input_insert_variable') }}</div>\r\n            </a-form-item>\r\n            <div class=\"diy-form-item\">\r\n              <div class=\"form-label\">{{ t('label_user_question') }}</div>\r\n              <div class=\"form-content\">\r\n                <a-cascader\r\n                  v-model:value=\"formState.question_value\"\r\n                  @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                  style=\"width: 220px\"\r\n                  :options=\"variableOptionsSelect\"\r\n                  :allowClear=\"false\"\r\n                  :displayRender=\"({ labels }) => labels.join('/')\"\r\n                  :field-names=\"{ children: 'children' }\"\r\n                  :placeholder=\"t('ph_select')\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_output') }}</div>\r\n            <div class=\"options-item\">\r\n              <div class=\"option-label\">{{ t('label_question_optimization_result') }}</div>\r\n              <div class=\"option-type\">string</div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n        <ImportPrompt @ok=\"handleSavePrompt\" ref=\"importPromptRef\" />\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n  \r\n</template>\r\n\r\n<script setup>\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { ref, reactive, watch, computed, nextTick, onMounted } from 'vue'\r\nimport { QuestionCircleOutlined, UpOutlined, DownOutlined } from '@ant-design/icons-vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport ModelSelect from '@/components/model-select/model-select.vue'\r\nimport ImportPrompt from '@/components/import-prompt/index.vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.problem-optimization-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst robotStore = useRobotStore()\r\nconst atInputRef = ref(null)\r\nconst modelList = computed(() => {\r\n  return robotStore.modelList\r\n})\r\nconst variableOptions = ref([])\r\nconst variableOptionsSelect = ref([])\r\nconst showMoreBtn = ref(false)\r\n\r\nconst hanldeShowMore = () => {\r\n  showMoreBtn.value = !showMoreBtn.value\r\n}\r\n\r\nconst changeValue = (text, selectedList) => {\r\n  formState.prompt = text\r\n  formState.prompt_tags = selectedList\r\n}\r\n\r\nfunction getOptions() {\r\n  // const node = props.lf.getNodeDataById(props.nodeId)\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    variableOptionsSelect.value = handleOptions(list)\r\n  }\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    variableOptions.value = list\r\n  }\r\n}\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  model_config_id: void 0,\r\n  use_model: void 0,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  prompt_tags: [],\r\n  question_value: '',\r\n  enable_thinking: false,\r\n  role: 1\r\n})\r\n\r\nconst handleModelChange = () => {\r\n  if (formState.use_model && formState.use_model.toLowerCase().includes('deepseek-r1')) {\r\n    formState.role = 2\r\n  } else {\r\n    formState.role = 1\r\n  }\r\n}\r\nconst update = () => {\r\n  const dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n  const oldData = JSON.stringify({\r\n    question_optimize: JSON.parse(dataRaw).question_optimize || {}\r\n  }) \r\n\r\n  const data = JSON.stringify({\r\n    question_optimize: {\r\n      ...formState,\r\n      question_value: formState.question_value.join('.'),\r\n      model_config_id: formState.model_config_id\r\n        ? +formState.model_config_id\r\n        : formState.model_config_id\r\n    }\r\n  })\r\n\r\n  if (oldData == data) {\r\n    return\r\n  }\r\n  \r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let question_optimize = JSON.parse(dataRaw).question_optimize || {}\r\n\r\n    question_optimize = JSON.parse(JSON.stringify(question_optimize))\r\n\r\n    let {\r\n      model_config_id,\r\n      use_model,\r\n      context_pair,\r\n      temperature,\r\n      max_token,\r\n      prompt,\r\n      prompt_tags,\r\n      question_value,\r\n      enable_thinking,\r\n      role\r\n    } = question_optimize\r\n    \r\n    getVlaueVariableList()\r\n    getOptions()\r\n\r\n    formState.model_config_id = model_config_id\r\n    formState.use_model = use_model\r\n    formState.context_pair = context_pair || 0\r\n    formState.temperature = temperature\r\n    formState.max_token = max_token\r\n    formState.prompt = prompt\r\n    formState.enable_thinking = enable_thinking\r\n    formState.prompt_tags = prompt_tags || []\r\n    formState.question_value = formatQuestionValue(question_value)\r\n    if (!formState.model_config_id && modelList.value.length > 0) {\r\n      formState.model_config_id = modelList.value[0].id\r\n      formState.use_model = modelList.value[0].children[0].name\r\n    }\r\n    formState.role = +role || 1\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\n\r\nconst importPromptRef = ref(null)\r\n\r\nconst handleSavePrompt = (item) => {\r\n  formState.prompt = ''\r\n  if (item.prompt_type == 1) {\r\n    formState.prompt = item.markdown\r\n  } else {\r\n    formState.prompt = item.prompt\r\n  }\r\n  nextTick(() => {\r\n    atInputRef.value.initData()\r\n  })\r\n}\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst choosable_thinking = ref({})\r\nconst onVectorModelLoaded = (list, choosable_thinking_map) => {\r\n  choosable_thinking.value = choosable_thinking_map\r\n}\r\n\r\nconst show_enable_thinking = computed(() => {\r\n  if (!formState.model_config_id) {\r\n    return false\r\n  }\r\n  let key = formState.model_config_id + '#' + formState.use_model\r\n  return choosable_thinking.value[key]\r\n})\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import './form-block.less';\r\n\r\n.width-100 {\r\n  ::v-deep(.ant-form-item-label) {\r\n    width: 100%;\r\n    label {\r\n      width: 100%;\r\n    }\r\n  }\r\n}\r\n.space-between-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 100%;\r\n  .btn-hover-wrap {\r\n    width: fit-content;\r\n    padding: 0 6px;\r\n    color: #2475fc;\r\n    gap: 4px;\r\n  }\r\n}\r\n\r\n.options-item {\r\n  margin-top: 12px;\r\n  height: 22px;\r\n  line-height: 22px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  .option-label {\r\n    color: var(--wf-color-text-1);\r\n    font-size: 14px;\r\n    &::before {\r\n      content: '*';\r\n      color: #fb363f;\r\n      display: inline-block;\r\n      margin-right: 2px;\r\n    }\r\n  }\r\n  .option-type {\r\n    height: 22px;\r\n    width: fit-content;\r\n    padding: 0 8px;\r\n    border-radius: 6px;\r\n    border: 1px solid rgba(0, 0, 0, 0.15);\r\n    background-color: #fff;\r\n    color: var(--wf-color-text-3);\r\n    font-size: 12px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n}\r\n.number-box {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  .number-slider-box {\r\n    width: 244px;\r\n  }\r\n\r\n  .number-input-box {\r\n    margin-left: 24px;\r\n  }\r\n}\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <a-modal v-model:open=\"open\" :title=\"t('title_field_detail')\" :width=\"746\">\r\n      <div class=\"input-box\">\r\n        <at-input\r\n          inputStyle=\"height: 550px;\"\r\n          :options=\"props.options\"\r\n          :defaultSelectedList=\"props.defaultSelectedList\"\r\n          :defaultValue=\"props.defaultValue\"\r\n          :placeholder=\"computedPlaceholder\"\r\n          :type=\"props.type\"\r\n          ref=\"atInputRef\"\r\n          @open=\"showAtList\"\r\n          @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n        />\r\n      </div>\r\n      <template #footer>\r\n        <a-button type=\"primary\" @click=\"handleOk\">{{ t('btn_confirm') }}</a-button>\r\n      </template>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, nextTick, watch, computed } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport AtInput from './at-input.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.at-input.full-at-input')\r\nconst open = ref(false)\r\n\r\nconst emit = defineEmits(['open', 'change', 'ok'])\r\n\r\nwatch(\r\n  () => open.value,\r\n  (val) => {\r\n    if (!val) {\r\n      emit('ok')\r\n    }\r\n  }\r\n)\r\n\r\nconst props = defineProps({\r\n  options: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  defaultSelectedList: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  defaultValue: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  placeholder: {\r\n    type: String,\r\n    default: 'ph_input_message_with_variable'\r\n  },\r\n  type: {\r\n    type: String,\r\n    default: 'textarea'\r\n  }\r\n})\r\n\r\nconst computedPlaceholder = computed(() => {\r\n  return props.placeholder === 'ph_input_message_with_variable' ? t('ph_input_message_with_variable') : props.placeholder\r\n})\r\n\r\nconst atInputRef = ref(null)\r\nconst show = () => {\r\n  open.value = true\r\n  nextTick(() => {\r\n    atInputRef.value.refresh()\r\n  })\r\n}\r\n\r\nconst showAtList = (val) => {\r\n  emit('open', val)\r\n}\r\n\r\nconst changeValue = (text, selectedList) => {\r\n  emit('change', text, selectedList)\r\n}\r\n\r\nconst handleOk = () => {\r\n  open.value = false\r\n}\r\n\r\ndefineExpose({ show })\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.input-box {\r\n  margin: 24px 0;\r\n  &::v-deep(.type-textarea) {\r\n    &::-webkit-scrollbar {\r\n      width: 6px;\r\n    }\r\n    &::-webkit-scrollbar-thumb {\r\n      border-radius: 20px;\r\n    }\r\n  }\r\n}\r\n</style>","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n       <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_call_llm_generate_reply')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\" @mousedown.stop=\"\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('title_llm_settings') }}</div>\r\n            <a-form-item :label=\"t('label_llm_model')\" name=\"use_model\">\r\n              <div class=\"flex-block-item\">\r\n                <ModelSelect\r\n                  modelType=\"LLM\"\r\n                  v-model:modeName=\"formState.use_model\"\r\n                  v-model:modeId=\"formState.model_config_id\"\r\n                  @loaded=\"onVectorModelLoaded\"\r\n                  @change=\"handleModelChange\"\r\n                  style=\"width: 348px\"\r\n                />\r\n                <!-- <DownOutlined /> -->\r\n                <a-button @click=\"hanldeShowMore\"\r\n                  >{{ t('btn_advanced_settings') }}\r\n                  <DownOutlined v-if=\"showMoreBtn\" />\r\n                  <UpOutlined v-else />\r\n                </a-button>\r\n              </div>\r\n            </a-form-item>\r\n\r\n            <a-form-item name=\"role\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_prompt_role') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>\r\n                    <div>\r\n                      {{ t('tip_prompt_role_desc') }}\r\n                      <div>{{ t('label_system_role_example') }}</div>\r\n                      <div>{\"role\": \"system\", \"content\": \"{{ t('sample_custom_prompt') }}\"}</div>\r\n                    </div>\r\n                  </template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <a-radio-group v-model:value=\"formState.role\">\r\n                <a-radio :value=\"1\">{{ t('label_system_role') }}</a-radio>\r\n                <a-radio :value=\"2\">{{ t('label_user_role') }}</a-radio>\r\n              </a-radio-group>\r\n            </a-form-item>\r\n\r\n            <a-form-item name=\"temperature\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_temperature') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_temperature_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.temperature\"\r\n                      :min=\"0\"\r\n                      :max=\"2\"\r\n                      :step=\"0.1\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number\r\n                    v-model:value=\"formState.temperature\"\r\n                    :min=\"0\"\r\n                    :max=\"2\"\r\n                    :step=\"0.1\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"max_token\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_max_token') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_max_token_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.max_token\"\r\n                      :min=\"0\"\r\n                      :max=\"100 * 1024\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.max_token\" :min=\"0\" :max=\"100 * 1024\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"enable_thinking\" v-if=\"showMoreBtn && show_enable_thinking\">\r\n              <template #label>\r\n                <span>{{ t('label_deep_thinking') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_deep_thinking_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <a-switch v-model:checked=\"formState.enable_thinking\" />\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"context_pair\">\r\n              <template #label>\r\n                <span>{{ t('label_context_pair') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title\r\n                    >{{ t('tip_context_pair_desc') }}</template\r\n                  >\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.context_pair\"\r\n                      :min=\"0\"\r\n                      :max=\"50\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.context_pair\" :min=\"0\" :max=\"50\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"prompt\" class=\"width-100\">\r\n              <template #label>\r\n                <div class=\"space-between-box\">\r\n                  <div>{{ t('label_prompt') }}</div>\r\n                  <a-flex :gap=\"8\">\r\n                    <div class=\"btn-hover-wrap\" @click=\"onShowAddPromptModal\">\r\n                      <DownloadOutlined />{{ t('btn_import_from_prompt_library') }}\r\n                    </div>\r\n                    <div class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal\">\r\n                      <FullscreenOutlined />\r\n                    </div>\r\n                  </a-flex>\r\n                </div>\r\n              </template>\r\n\r\n              <at-input\r\n                type=\"textarea\"\r\n                inputStyle=\"height: 100px;\"\r\n                :options=\"variableOptions\"\r\n                :defaultSelectedList=\"formState.prompt_tags\"\r\n                :defaultValue=\"formState.prompt\"\r\n                ref=\"atInputRef\"\r\n                @open=\"getVlaueVariableList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n                :placeholder=\"t('ph_input_message_content')\"\r\n              >\r\n                <template #option=\"{ label, payload }\">\r\n                  <div class=\"field-list-item\">\r\n                    <div class=\"field-label\">{{ label }}</div>\r\n                    <div class=\"field-type\">{{ payload.typ }}</div>\r\n                  </div>\r\n                </template>\r\n              </at-input>\r\n              <div class=\"form-tip\">{{ t('msg_input_insert_variable') }}</div>\r\n            </a-form-item>\r\n\r\n            <div class=\"diy-form-item mt12\">\r\n              <div class=\"form-label\">{{ t('label_knowledge_base_reference') }}</div>\r\n              <div class=\"form-content\">\r\n                <a-select\r\n                  :placeholder=\"t('ph_select')\"\r\n                  allowClear\r\n                  @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                  v-model:value=\"formState.libs_node_key\"\r\n                  style=\"width: 220px\"\r\n                >\r\n                  <a-select-option\r\n                    v-for=\"item in knowledgeQuoteOptions\"\r\n                    :value=\"item.node_id\"\r\n                    :key=\"item.node_id\"\r\n                    >{{ item.label }}</a-select-option\r\n                  >\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n           <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_input') }}</div>\r\n            <div class=\"diy-form-item question-value-item\">\r\n              <div class=\"form-label\">{{ t('label_input') }}</div>\r\n              <div class=\"form-content\">\r\n                <a-cascader\r\n                  v-model:value=\"formState.question_value\"\r\n                  @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                  style=\"width: 220px\"\r\n                  :options=\"variableOptionsSelect\"\r\n                  :allowClear=\"false\"\r\n                  :displayRender=\"({ labels }) => labels.join('/')\"\r\n                  :field-names=\"{ children: 'children' }\"\r\n                  :placeholder=\"t('ph_select')\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_output') }}</div>\r\n            <div class=\"options-item\">\r\n              <div class=\"option-label\">{{ t('label_ai_reply_content') }}</div>\r\n              <div class=\"option-type\">string</div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n\r\n      <ImportPrompt @ok=\"handleSavePrompt\" ref=\"importPromptRef\" />\r\n      <FullAtInput\r\n        :options=\"variableOptions\"\r\n        :defaultSelectedList=\"formState.prompt_tags\"\r\n        :defaultValue=\"formState.prompt\"\r\n        :placeholder=\"t('ph_input_message_content')\"\r\n        type=\"textarea\"\r\n        @open=\"getVlaueVariableList\"\r\n        @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n        @ok=\"handleRefreshAtInput\"\r\n        ref=\"fullAtInputRef\"\r\n      />\r\n    </div>\r\n  </NodeFormLayout>\r\n\r\n</template>\r\n\r\n<script setup>\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { ref, reactive, watch, computed, onMounted, nextTick, inject } from 'vue'\r\nimport { QuestionCircleOutlined, UpOutlined, DownOutlined, FullscreenOutlined, DownloadOutlined } from '@ant-design/icons-vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport ModelSelect from '@/components/model-select/model-select.vue'\r\nimport FullAtInput from '../at-input/full-at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.ai-dialogue-node-from')\r\n\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst robotStore = useRobotStore()\r\nconst atInputRef = ref(null)\r\nconst modelList = computed(() => {\r\n  return robotStore.modelList\r\n})\r\nconst variableOptions = ref([])\r\nconst variableOptionsSelect = ref([])\r\nconst showMoreBtn = ref(false)\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  model_config_id: void 0,\r\n  use_model: void 0,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  prompt_tags: [],\r\n  question_value: '',\r\n  enable_thinking: false,\r\n  libs_node_key: void 0,\r\n  role: 1\r\n})\r\n\r\nconst handleModelChange = () => {\r\n  if (formState.use_model && formState.use_model.toLowerCase().includes('deepseek-r1')) {\r\n    formState.role = 2\r\n  } else {\r\n    formState.role = 1\r\n  }\r\n}\r\nconst hanldeShowMore = () => {\r\n  showMoreBtn.value = !showMoreBtn.value\r\n}\r\n\r\nconst changeValue = (text, selectedList) => {\r\n  formState.prompt = text\r\n  formState.prompt_tags = selectedList\r\n}\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptionsSelect.value = handleOptions(list)\r\n}\r\n\r\nconst knowledgeQuoteOptions = computed(() => {\r\n  let list = variableOptionsSelect.value.filter((item) => item.node_type == 5)\r\n  return list\r\n})\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n  variableOptions.value = list\r\n}\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst importPromptRef = ref(null)\r\n\r\nconst onShowAddPromptModal = () => {\r\n  importPromptRef.value.show()\r\n}\r\n\r\nconst handleSavePrompt = (item) => {\r\n  formState.prompt = ''\r\n  if (item.prompt_type == 1) {\r\n    formState.prompt = item.markdown\r\n  } else {\r\n    formState.prompt = item.prompt\r\n  }\r\n  nextTick(() => {\r\n    atInputRef.value.initData()\r\n  })\r\n}\r\n\r\nconst fullAtInputRef = ref(null)\r\nconst handleOpenFullAtModal = () => {\r\n  fullAtInputRef.value.show()\r\n}\r\n\r\nconst handleRefreshAtInput = () => {\r\n  atInputRef.value.refresh()\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    llm: {\r\n      ...formState,\r\n      question_value: formState.question_value.join('.'),\r\n      model_config_id: formState.model_config_id\r\n        ? +formState.model_config_id\r\n        : formState.model_config_id\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let llm = JSON.parse(dataRaw).llm || {}\r\n\r\n    llm = JSON.parse(JSON.stringify(llm))\r\n    let {\r\n      model_config_id,\r\n      use_model,\r\n      context_pair,\r\n      temperature,\r\n      max_token,\r\n      prompt,\r\n      prompt_tags,\r\n      question_value,\r\n      enable_thinking,\r\n      libs_node_key,\r\n      role\r\n    } = llm\r\n\r\n    getVlaueVariableList()\r\n    getOptions()\r\n\r\n    formState.model_config_id = model_config_id\r\n    formState.use_model = use_model\r\n    formState.context_pair = context_pair || 0\r\n    formState.temperature = temperature\r\n    formState.max_token = max_token\r\n    formState.prompt = prompt\r\n    formState.enable_thinking = enable_thinking\r\n    formState.prompt_tags = prompt_tags || []\r\n    formState.libs_node_key = libs_node_key\r\n    formState.question_value = formatQuestionValue(question_value)\r\n    if (!formState.model_config_id && modelList.value.length > 0) {\r\n      formState.model_config_id = modelList.value[0].id\r\n      formState.use_model = modelList.value[0].children[0].name\r\n    }\r\n    formState.role = +role || 1\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst choosable_thinking = ref({})\r\nconst onVectorModelLoaded = (list, choosable_thinking_map) => {\r\n  choosable_thinking.value = choosable_thinking_map\r\n}\r\n\r\nconst show_enable_thinking = computed(() => {\r\n  if (!formState.model_config_id) {\r\n    return false\r\n  }\r\n  let key = formState.model_config_id + '#' + formState.use_model\r\n  return choosable_thinking.value[key]\r\n})\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import './form-block.less';\r\n.width-100 {\r\n  ::v-deep(.ant-form-item-label) {\r\n    width: 100%;\r\n    label {\r\n      width: 100%;\r\n    }\r\n  }\r\n}\r\n.space-between-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 100%;\r\n  .btn-hover-wrap {\r\n    width: fit-content;\r\n    padding: 0 6px;\r\n    color: #2475fc;\r\n    gap: 4px;\r\n  }\r\n}\r\n.question-value-item{\r\n  display: flex;\r\n  align-items: center;\r\n  .form-label{\r\n    margin-right: 8px;\r\n    &::before {\r\n      content: '*';\r\n      color: #fb363f;\r\n      display: inline-block;\r\n      margin-right: 2px;\r\n    }\r\n  }\r\n  .form-content{\r\n    margin-top: 0;\r\n  }\r\n}\r\n.options-item {\r\n  margin-top: 12px;\r\n  height: 22px;\r\n  line-height: 22px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  .option-label {\r\n    color: var(--wf-color-text-1);\r\n    font-size: 14px;\r\n    &::before {\r\n      content: '*';\r\n      color: #fb363f;\r\n      display: inline-block;\r\n      margin-right: 2px;\r\n    }\r\n  }\r\n  .option-type {\r\n    height: 22px;\r\n    width: fit-content;\r\n    padding: 0 8px;\r\n    border-radius: 6px;\r\n    border: 1px solid rgba(0, 0, 0, 0.15);\r\n    background-color: #fff;\r\n    color: var(--wf-color-text-3);\r\n    font-size: 12px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n}\r\n.number-box {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  .number-slider-box {\r\n    width: 244px;\r\n  }\r\n\r\n  .number-input-box {\r\n    margin-left: 24px;\r\n  }\r\n}\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n</style>","export default \"data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1.7002%208L11%208'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M10.9666%208L1.66672%208'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%2012L11%208L7%204'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","import { defineStore } from 'pinia'\r\nimport { getFormList, getFormFieldList } from '@/api/database/index'\r\n\r\nexport const useDataTableStore = defineStore('dataTable', {\r\n  state: () => {\r\n    return {\r\n      // 表单列表缓存\r\n      formList: [],\r\n      // 表单字段列表缓存映射，key为form_id\r\n      formFieldListMap: {},\r\n      // 表单列表加载状态\r\n      formListLoading: false,\r\n      // 表单字段列表加载状态映射，key为form_id\r\n      formFieldListLoadingMap: {},\r\n      // 表单列表请求队列，存储等待结果的Promise resolve函数\r\n      formListQueue: [],\r\n      // 表单字段列表请求队列映射，key为form_id，value为Promise resolve函数数组\r\n      formFieldListQueueMap: {},\r\n    }\r\n  },\r\n  getters: {},\r\n  actions: {\r\n    /**\r\n     * 获取表单列表（带队列机制）\r\n     * @returns {Promise<Array>} 表单列表\r\n     */\r\n    async getFormList(){\r\n      // 如果已有缓存数据，直接返回\r\n      if(this.formList.length > 0){\r\n        return [...this.formList]\r\n      }\r\n      \r\n      // 如果正在加载中，将当前请求加入队列等待\r\n      if(this.formListLoading){\r\n        return new Promise((resolve) => {\r\n          this.formListQueue.push(resolve)\r\n        })\r\n      }\r\n      \r\n      // 设置加载状态为true，防止重复请求\r\n      this.formListLoading = true\r\n      \r\n      try{\r\n        const res = await getFormList()\r\n        this.formList = res.data || []\r\n        \r\n        // 请求成功后，处理队列中等待的所有请求\r\n        const result = [...this.formList]\r\n        this.formListQueue.forEach(resolve => resolve(result))\r\n        this.formListQueue = []\r\n        \r\n        return result\r\n      }catch(error){\r\n        console.log(error)\r\n        this.formList = []\r\n        \r\n        // 请求失败时，也要处理队列中等待的请求\r\n        const result = [...this.formList]\r\n        this.formListQueue.forEach(resolve => resolve(result))\r\n        this.formListQueue = []\r\n        \r\n        return result\r\n      }finally{\r\n        // 无论成功失败，都要重置加载状态\r\n        this.formListLoading = false\r\n      }\r\n    },\r\n    /**\r\n     * 获取表单字段列表（带队列机制）\r\n     * @param {Object} params - 参数对象\r\n     * @param {string} params.form_id - 表单ID\r\n     * @returns {Promise<Array>} 表单字段列表\r\n     */\r\n    async getFormFieldList({form_id}){\r\n      // 如果已有缓存数据，直接返回\r\n      if(this.formFieldListMap[form_id] && this.formFieldListMap[form_id].length > 0){\r\n        return [...this.formFieldListMap[form_id]]\r\n      }\r\n      \r\n      // 如果该form_id正在加载中，将当前请求加入对应的队列等待\r\n      if(this.formFieldListLoadingMap[form_id]){\r\n        return new Promise((resolve) => {\r\n          // 初始化该form_id的队列（如果不存在）\r\n          if(!this.formFieldListQueueMap[form_id]){\r\n            this.formFieldListQueueMap[form_id] = []\r\n          }\r\n          this.formFieldListQueueMap[form_id].push(resolve)\r\n        })\r\n      }\r\n      \r\n      // 设置该form_id的加载状态为true，防止重复请求\r\n      this.formFieldListLoadingMap[form_id] = true\r\n      \r\n      try{\r\n        const res = await getFormFieldList({form_id})\r\n        this.formFieldListMap[form_id] = res.data || []\r\n        \r\n        // 请求成功后，处理该form_id队列中等待的所有请求\r\n        const result = [...this.formFieldListMap[form_id]]\r\n        if(this.formFieldListQueueMap[form_id]){\r\n          this.formFieldListQueueMap[form_id].forEach(resolve => resolve(result))\r\n          this.formFieldListQueueMap[form_id] = []\r\n        }\r\n        \r\n        return result\r\n      }catch(error){\r\n        console.log(error)\r\n        this.formFieldListMap[form_id] = []\r\n        \r\n        // 请求失败时，也要处理队列中等待的请求\r\n        const result = [...this.formFieldListMap[form_id]]\r\n        if(this.formFieldListQueueMap[form_id]){\r\n          this.formFieldListQueueMap[form_id].forEach(resolve => resolve(result))\r\n          this.formFieldListQueueMap[form_id] = []\r\n        }\r\n        \r\n        return result\r\n      }finally{\r\n        // 无论成功失败，都要重置该form_id的加载状态\r\n        this.formFieldListLoadingMap[form_id] = false\r\n      }\r\n    },\r\n    /**\r\n     * 刷新表单列表\r\n     * 清空缓存并重新获取数据\r\n     * @returns {Promise<Array>} 最新的表单列表\r\n     */\r\n    async refreshFormList(){\r\n      // 清空缓存数据\r\n      this.formList = []\r\n      // 重置加载状态和队列\r\n      this.formListLoading = false\r\n      this.formListQueue = []\r\n\r\n      let list = await this.getFormList()\r\n\r\n      return list\r\n    },\r\n    \r\n    /**\r\n     * 刷新指定表单的字段列表\r\n     * 清空缓存并重新获取数据\r\n     * @param {Object} params - 参数对象\r\n     * @param {string} params.form_id - 表单ID\r\n     * @returns {Promise<Array>} 最新的表单字段列表\r\n     */\r\n    async refreshFormFieldList({form_id}){\r\n      // 清空该form_id的缓存数据\r\n      this.formFieldListMap[form_id] = []\r\n      // 重置该form_id的加载状态和队列\r\n      this.formFieldListLoadingMap[form_id] = false\r\n      this.formFieldListQueueMap[form_id] = []\r\n      \r\n      let list = await this.getFormFieldList({form_id})\r\n\r\n      return list\r\n    }\r\n  },\r\n})","<style lang=\"less\" scoped>\r\n.library-checkbox-box {\r\n  padding-top: 16px;\r\n\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n\r\n  .list-box {\r\n    display: flex;\r\n    flex-flow: row wrap;\r\n    height: 388px;\r\n    width: 100%;\r\n    overflow-y: auto;\r\n    align-content: flex-start;\r\n    margin: 0 -8px;\r\n\r\n    .list-item-wraapper {\r\n      padding: 8px;\r\n      width: 50%;\r\n    }\r\n\r\n    .list-item {\r\n      width: 100%;\r\n      padding: 14px 12px;\r\n      border: 1px solid #f0f0f0;\r\n      border-radius: 2px;\r\n\r\n      &:hover {\r\n        cursor: pointer;\r\n        box-shadow: 0 4px 16px 0 #1b3a6929;\r\n      }\r\n\r\n      .library-name {\r\n        line-height: 22px;\r\n        font-size: 14px;\r\n        font-weight: 600;\r\n        color: #262626;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n\r\n      .library-desc {\r\n        line-height: 20px;\r\n        margin-top: 2px;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        color: #8c8c8c;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n\r\n    .list-item :deep(span:last-child) {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n.empty-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  padding-top: 40px;\r\n  padding-bottom: 40px;\r\n  color: #8c8c8c;\r\n  img {\r\n    width: 150px;\r\n    height: 150px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal width=\"746px\" v-model:open=\"state.show\" :title=\"t('title_relate_data_table')\" @ok=\"handleOk\" :ok-text=\"t('btn_confirm')\" :cancel-text=\"t('btn_cancel')\">\r\n    <div class=\"field-select-box\">\r\n      <div class=\"field-list-box\" v-if=\"dataSource.length\">\r\n        <a-table rowKey=\"name\" :row-selection=\"{ selectedRowKeys: state.selectedRowKeys, onChange: onSelectChange }\" :dataSource=\"dataSource\" :columns=\"columns\" :loading=\"loading\" :pagination=\"false\" />\r\n      </div>\r\n      <div class=\"empty-box\" v-if=\"!dataSource.length\">\r\n        <img src=\"@/assets/img/library/preview/empty.png\" alt=\"\" />\r\n        <div>\r\n          {{ t('msg_no_fields_add') }}\r\n          <a @click=\"openAddLibrary\"> {{ t('btn_go_add') }}</a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.field-selector.field-select-alert')\r\n\r\nconst emit = defineEmits(['ok'])\r\n\r\nconst dataTableStore = useDataTableStore()\r\n\r\nconst state = reactive({\r\n  show: false,\r\n  formId: '',\r\n  selectedRowKeys: [],\r\n  selectedRows: []\r\n})\r\n\r\nconst columns = ref([\r\n  {\r\n    title: t('label_field_name'),\r\n    dataIndex: 'name',\r\n    key: 'name'\r\n  },\r\n  {\r\n    title: t('label_data_type'),\r\n    dataIndex: 'type',\r\n    key: 'type'\r\n  },\r\n  {\r\n    title: t('label_field_desc'),\r\n    dataIndex: 'description',\r\n    key: 'description'\r\n  }\r\n])\r\n\r\nconst dataSource = ref([])\r\n\r\nconst onSelectChange = (selectedRowKeys, selectedRows) => {\r\n  state.selectedRowKeys = selectedRowKeys;\r\n  state.selectedRows = selectedRows\r\n};\r\n\r\nconst open = ({\r\n  formId,\r\n  selectedRowKeys,\r\n  selectedRows\r\n}) => {\r\n  state.formId = formId\r\n  state.selectedRowKeys = selectedRowKeys\r\n  state.selectedRows = selectedRows\r\n\r\n  getList(selectedRowKeys)\r\n\r\n  state.show = true\r\n}\r\n\r\nconst openAddLibrary = () => {\r\n  window.open('/#/database/details/field-manage?form_id='+state.formId)\r\n}\r\n\r\nconst handleOk = () => {\r\n  emit('ok', state.selectedRowKeys, state.selectedRows)\r\n  state.show = false;\r\n}\r\n\r\nconst loading = ref(false)\r\nconst getList = () => {\r\n  loading.value = true\r\n  dataTableStore.getFormFieldList({ form_id: state.formId})\r\n    .then((list) => {\r\n      loading.value = false\r\n\r\n      // list = list.filter(item => !selectedRowKeys.includes(item.name))\r\n\r\n      list.forEach(item => {\r\n        item.value = ''\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      dataSource.value = list\r\n    })\r\n    .catch(() => {\r\n      loading.value = false\r\n    })\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>","<style lang=\"less\" scoped>\r\n.field-list {\r\n  .field-list-row {\r\n    position: relative;\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    align-items: center;\r\n    margin-bottom: 4px;\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n  .field-list-col {\r\n    padding: 0 4px;\r\n  }\r\n  .field-name-col,\r\n  .field-type-col,\r\n  .field-name-head,\r\n  .field-type-head {\r\n    flex: 1;\r\n  }\r\n  .field-value-col,\r\n  .field-value-head {\r\n    width: 256px;\r\n  }\r\n  .field-list-col-head {\r\n    line-height: 22px;\r\n    margin-bottom: 4px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n  }\r\n  .field-name-col,\r\n  .field-type-col {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n  }\r\n  .field-del-head,\r\n  .field-del-col {\r\n    width: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .field-del-col {\r\n    text-align: right;\r\n    .del-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 16px;\r\n      height: 16px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n}\r\n.add-btn-box {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div>\r\n    <div class=\"field-list\">\r\n      <div class=\"field-list-row\">\r\n        <div class=\"field-list-col field-list-col-head field-name-head\">{{ t('label_field_name') }}</div>\r\n        <div class=\"field-list-col field-list-col-head field-type-head\">{{ t('label_type') }}</div>\r\n        <div class=\"field-list-col field-list-col-head field-value-head\" v-if=\"showInput\">{{ t('label_field_value') }}</div>\r\n        <div\r\n          class=\"field-list-col field-list-col-head field-del-head\"\r\n          v-if=\"props.showDelete\"\r\n        ></div>\r\n      </div>\r\n\r\n      <div class=\"field-list-row\" v-if=\"showEmptyFieldRow\">\r\n        <div class=\"field-list-col field-name-col\">--</div>\r\n        <div class=\"field-list-col field-type-col\">--</div>\r\n        <div class=\"field-list-col field-value-col\">\r\n          <a-tooltip :title=\"t('ph_select_database_first')\">\r\n            <a-input :disabled=\"true\" :placeholder=\"t('ph_input_value_variable')\" />\r\n          </a-tooltip>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"field-list-row\" v-for=\"(item, index) in state.list\" :key=\"item.name\">\r\n        <div class=\"field-list-col field-name-col\">{{ item.name }}</div>\r\n        <div class=\"field-list-col field-type-col\">{{ item.type }}</div>\r\n        <div class=\"field-list-col field-value-col\" v-if=\"showInput\">\r\n          <!-- <a-input :placeholder=\"t('ph_input_value_variable')\" v-model:value=\"item.value\" @change=\"onChangeFieldValue\" /> -->\r\n          <AtInput\r\n          :options=\"atInputOptions\"\r\n          :defaultValue=\"item.value\"\r\n          :defaultSelectedList=\"item.atTags\"\r\n          @open=\"showAtList\"\r\n          @change=\"(text, selectedList) => changeAtInputValue(text, selectedList, item, index)\"\r\n          :placeholder=\"t('ph_input_value_variable')\" />\r\n        </div>\r\n        <div class=\"field-list-col field-del-col\" v-if=\"props.showDelete\">\r\n          <span class=\"del-btn\" @click=\"handleDel(index)\">\r\n            <svg-icon class=\"del-icon\" name=\"close-circle\"></svg-icon>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"add-btn-box\" v-if=\"props.showAdd\">\r\n      <a-button class=\"add-btn\" type=\"dashed\" block @click=\"handleAddField\"><PlusOutlined /> {{ t('btn_add_update_field') }}</a-button>\r\n    </div>\r\n\r\n    <FieldSelectAlert :formId=\"formId\" ref=\"fieldSelectAlertRef\" @ok=\"onChangeSelect\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, inject, onMounted } from 'vue'\r\nimport { PlusOutlined } from '@ant-design/icons-vue'\r\nimport FieldSelectAlert from './field-select-alert.vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.field-selector.index')\r\n\r\nconst emit = defineEmits(['change'])\r\n\r\nconst props = defineProps({\r\n  showAdd: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  showDelete: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showInput: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showEmptyFieldRow: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  formId: {\r\n    type: [String, Number],\r\n    default: ''\r\n  },\r\n  list: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst state = reactive({\r\n  list: props.list\r\n})\r\n\r\nwatch(() => props.list, (newVal) => {\r\n  state.list = newVal\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable();\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst showAtList = () => {\r\n  getAtInputOptions()\r\n}\r\n\r\nconst changeAtInputValue = (text, selectedList, item, index) => {\r\n  // item.value = text\r\n  state.list[index].value = text\r\n  state.list[index].atTags = selectedList\r\n\r\n  change()\r\n}\r\n\r\n\r\nconst onChangeSelect = (selectedRowKeys, selectedRows) => {\r\n  state.list = [...selectedRows]\r\n\r\n  change()\r\n}\r\n\r\nconst handleDel = (index) => {\r\n  state.list.splice(index, 1)\r\n\r\n  change()\r\n}\r\n\r\nconst change = () => {\r\n  emit('change', [...state.list])\r\n}\r\n\r\nconst fieldSelectAlertRef = ref()\r\n\r\nconst handleAddField = () => {\r\n  fieldSelectAlertRef.value.open({\r\n    formId: props.formId,\r\n    selectedRows: props.list,\r\n    selectedRowKeys: props.list.map(item => {\r\n      return item.name\r\n    })\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  getAtInputOptions()\r\n})\r\n</script>","<style lang=\"less\" scoped>\r\n.library-checkbox-box {\r\n  padding-top: 16px;\r\n\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n\r\n  .list-box {\r\n    display: flex;\r\n    flex-flow: row wrap;\r\n    height: 388px;\r\n    width: 100%;\r\n    overflow-y: auto;\r\n    align-content: flex-start;\r\n    margin: 0 -8px;\r\n\r\n    .list-item-wraapper {\r\n      padding: 8px;\r\n      width: 50%;\r\n    }\r\n\r\n    .list-item {\r\n      width: 100%;\r\n      padding: 14px 12px;\r\n      border: 1px solid #f0f0f0;\r\n      border-radius: 2px;\r\n\r\n      &:hover {\r\n        cursor: pointer;\r\n        box-shadow: 0 4px 16px 0 #1b3a6929;\r\n      }\r\n\r\n      .library-name {\r\n        line-height: 22px;\r\n        font-size: 14px;\r\n        font-weight: 600;\r\n        color: #262626;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n\r\n      .library-desc {\r\n        line-height: 20px;\r\n        margin-top: 2px;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        color: #8c8c8c;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n\r\n    .list-item :deep(span:last-child) {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n.empty-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  padding-top: 40px;\r\n  padding-bottom: 40px;\r\n  color: #8c8c8c;\r\n  img {\r\n    width: 150px;\r\n    height: 150px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal width=\"746px\" v-model:open=\"show\" :title=\"t('title_relate_data_table')\" :ok-text=\"t('btn_confirm')\" :cancel-text=\"t('btn_cancel')\" @ok=\"saveCheckedList\">\r\n    <div class=\"library-checkbox-box\">\r\n\r\n      <a-radio-group v-model:value=\"loaclValue\" style=\"width: 100%\" v-if=\"options.length\">\r\n        <div class=\"list-box\" ref=\"scrollContainer\">\r\n          <div class=\"list-item-wraapper\" v-for=\"item in props.options\" :key=\"item.id\">\r\n            <a-radio class=\"list-item\" :value=\"item.id\">\r\n              <div class=\"library-name\">{{ item.name }}</div>\r\n              <div class=\"library-desc\">{{ item.description }}</div>\r\n            </a-radio>\r\n          </div>\r\n        </div>\r\n      </a-radio-group>\r\n\r\n      <div class=\"empty-box\" v-if=\"!options.length\">\r\n        <img src=\"@/assets/img/library/preview/empty.png\" alt=\"\" />\r\n        <div>\r\n          {{ t('msg_no_data_table') }}\r\n          <a @click=\"openAddLibrary\"> {{ t('btn_go_add') }}</a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.database-selector.table-select-alert')\r\n\r\nconst emit = defineEmits(['ok'])\r\n\r\nconst props = defineProps({\r\n  value: {\r\n    type: [String, Number],\r\n    default: ''\r\n  },\r\n  options: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst loaclValue = ref()\r\nconst show = ref(false)\r\n\r\nconst open = (val) => {\r\n  loaclValue.value = val\r\n  \r\n  show.value = true\r\n}\r\n\r\nconst saveCheckedList = () => {\r\n  show.value = false\r\n  triggerChange()\r\n}\r\n\r\n\r\n\r\nconst triggerChange = () => {\r\n  let arr = props.options.filter(item => item.id === loaclValue.value)\r\n\r\n  emit('ok', loaclValue.value, JSON.parse(JSON.stringify(arr[0])))\r\n}\r\n\r\nconst openAddLibrary = () => {\r\n  window.open('/#/database/list')\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.select-data-btn {\r\n  width: 100%;\r\n}\r\n.data-table-info {\r\n  position: relative;\r\n  padding: 14px 16px;\r\n  border-radius: 6px;\r\n  border: 1px solid #d8dde5;\r\n  background: #fff;\r\n\r\n  .data-table-name {\r\n    font-size: 14px;\r\n    line-height: 22px;\r\n    font-weight: 600;\r\n    color: #262626;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n  }\r\n  .data-table-desc {\r\n    font-size: 12px;\r\n    line-height: 20px;\r\n    font-weight: 400;\r\n    color: #8c8c8c;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n  }\r\n  .del-btn {\r\n    position: absolute;\r\n    right: 16px;\r\n    top: 28px;\r\n    font-size: 16px;\r\n    color: #595959;\r\n    cursor: pointer;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"\">\r\n    <div class=\"data-table-info\" v-if=\"props.value\" >\r\n      <div class=\"data-table-name\">{{ selectedRow ? selectedRow.name : props.title }}</div>\r\n      <div class=\"data-table-desc\">{{ selectedRow ? selectedRow.description : props.description }}</div>\r\n      <svg-icon class=\"del-btn\" name=\"close-circle\" @click=\"handleClear\"></svg-icon>\r\n    </div>\r\n\r\n    <a-button class=\"select-data-btn\" type=\"primary\" ghost @click=\"handleSelectData\" v-else><PlusOutlined /> {{ t('btn_select_data_table') }}</a-button>\r\n\r\n    <TableSelectAlert ref=\"tableSelectAlertRef\" @ok=\"onSelectOk\" :options=\"options\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue'\r\nimport { PlusOutlined } from '@ant-design/icons-vue'\r\nimport TableSelectAlert from './table-select-alert.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.database-selector.index')\r\n\r\nconst emit = defineEmits(['update:value', 'change'])\r\n\r\nconst props = defineProps({\r\n  value: {\r\n    type: [String, Number],\r\n    default: ''\r\n  },\r\n  options: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  description: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  title: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n})\r\n\r\nconst tableSelectAlertRef = ref(null)\r\n\r\nconst selectedRow = computed(() => {\r\n  let arr = props.options.filter(item => item.id === props.value)\r\n\r\n  if (arr.length) {\r\n    return arr[0]\r\n  }\r\n\r\n  return null\r\n})\r\n\r\n\r\nconst handleSelectData = () => {\r\n  tableSelectAlertRef.value.open()\r\n}\r\n\r\nconst onSelectOk = (value, record ) => {\r\n  emit('update:value', value)\r\n  emit('change', value, record)\r\n}\r\n\r\nconst handleClear = () => {\r\n  emit('update:value', '')\r\n  emit('change', '')\r\n}\r\n\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.add-data-form {\r\n  .node-box-content {\r\n    margin-top: 16px;\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n\r\n  .node-box-title {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 48px;\r\n    padding: 0 12px;\r\n\r\n    .input-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .text {\r\n      font-weight: 600;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    padding: 0 12px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n\r\n  .setting-box {\r\n    padding: 0 12px;\r\n    margin-bottom: 12px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :iconName=\"node.node_icon_name\">\r\n        <template #desc>\r\n          <span\r\n            >{{ t('title_desc_insert_data') }}\r\n            <a target=\"_blank\" href=\"/#/database/list\">{{ t('btn_go_manage') }}</a></span\r\n          >\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"add-data-form\">\r\n      <div class=\"node-box-content\">\r\n        <div class=\"node-box-title\">\r\n          <img class=\"input-icon\" src=\"@/assets/img/workflow/input.svg\" alt=\"\" />\r\n          <span class=\"text\">{{ t('label_input') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-label\">\r\n          <span>{{ t('label_data_table') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-box\">\r\n          <DataTableSelect\r\n            :options=\"state.tableList\"\r\n            :title=\"state.formData.form_name\"\r\n            :description=\"state.formData.form_description\"\r\n            v-model:value=\"state.formData.form_id\"\r\n            @change=\"onSelectTable\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"setting-label\">\r\n          <span>{{ t('label_insert_data') }}</span>\r\n          <span class=\"tip\">{{ t('tip_empty_field') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-box\">\r\n          <FieldListSelect\r\n            :form-id=\"state.formData.form_id\"\r\n            :showEmptyFieldRow=\"state.formData.form_id == ''\"\r\n            :list=\"state.formData.datas\"\r\n            :showAdd=\"false\"\r\n            :showDelete=\"false\"\r\n            @change=\"onChangeFields\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, reactive, toRaw } from 'vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport FieldListSelect from '../data-table/field-selector/index.vue'\r\nimport DataTableSelect from '../data-table/database-selector/index.vue'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.add-data-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\n\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeType: {\r\n    type: String\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst dataTableStore = useDataTableStore()\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    datas: []\r\n  }\r\n})\r\n\r\nconst onSelectTable = (value, record) => {\r\n  if (record) {\r\n    state.formData.form_name = record.name\r\n    state.formData.form_description = record.description\r\n    // state.formData.form_id = record.id\r\n    getFieldList(record.id)\r\n  } else {\r\n    state.formData.form_name = ''\r\n    state.formData.form_description = ''\r\n    // state.formData.form_id = ''\r\n    state.formData.datas = []\r\n  }\r\n\r\n  update()\r\n}\r\n\r\nconst onChangeFields = (selectedRows) => {\r\n  state.formData.datas = selectedRows\r\n  update()\r\n}\r\n\r\nconst init = () => {\r\n  let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n\r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  state.formData = node_params.form_insert\r\n\r\n  update()\r\n}\r\n\r\nconst update = () => {\r\n  node_params.form_insert = toRaw(state.formData)\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst getTableList = async () => {\r\n  const list = await dataTableStore.getFormList()\r\n\r\n  state.tableList = list\r\n}\r\n\r\nconst getFieldList = async (form_id) => {\r\n  dataTableStore\r\n    .getFormFieldList({ form_id: form_id })\r\n    .then((list) => {\r\n      list.forEach((item) => {\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      state.formData.datas = list\r\n\r\n      update()\r\n    })\r\n    .catch(() => {})\r\n}\r\n\r\nonMounted(() => {\r\n  getTableList()\r\n  init()\r\n})\r\n</script>\r\n","<style lang=\"less\">\r\n.correlation-library-modal.ant-modal-wrap .ant-modal-content {\r\n  padding: 0;\r\n}\r\n</style>\r\n<style lang=\"less\" scoped>\r\n.library-checkbox-box {\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n  .list-group-box {\r\n    display: flex;\r\n    height: 608px;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .group-list-box {\r\n    width: 248px;\r\n    border-right: 1px solid #d9d9d9;\r\n    position: relative;\r\n    padding: 24px 0 0 16px;\r\n    .main-title-block {\r\n      color: #262626;\r\n      font-size: 16px;\r\n      font-weight: 600;\r\n      line-height: 24px;\r\n      padding-left: 8px;\r\n      padding-bottom: 24px;\r\n    }\r\n\r\n    .classify-box {\r\n      flex: 1;\r\n      overflow: hidden;\r\n      font-size: 14px;\r\n      .classify-item {\r\n        height: 40px;\r\n        padding: 0 16px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        cursor: pointer;\r\n        border-radius: 6px;\r\n        color: #595959;\r\n        transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\r\n\r\n        .classify-title {\r\n          flex: 1;\r\n          text-overflow: ellipsis;\r\n          overflow: hidden;\r\n          white-space: nowrap;\r\n        }\r\n        .num {\r\n          display: block;\r\n        }\r\n        &:hover {\r\n          background: #f2f4f7;\r\n        }\r\n        &.active {\r\n          color: #2475fc;\r\n          background: #e6efff;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .list-item-box {\r\n    flex: 1;\r\n    height: 100%;\r\n    overflow: hidden;\r\n    padding-top: 24px;\r\n    .alert-box {\r\n      width: 600px;\r\n      padding-left: 16px;\r\n    }\r\n    .btn-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      margin-top: 16px;\r\n      margin-bottom: 8px;\r\n      padding-left: 16px;\r\n    }\r\n  }\r\n  .library-list-item {\r\n    min-height: 97px;\r\n    padding: 24px 12px;\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    cursor: pointer;\r\n    &:hover {\r\n      background: var(--09, #f2f4f7);\r\n    }\r\n    .avatar-box {\r\n      width: 48px;\r\n      height: 48px;\r\n      img {\r\n        width: 100%;\r\n        height: 100%;\r\n        border-radius: 12px;\r\n      }\r\n    }\r\n    .info-content-box {\r\n      flex: 1;\r\n      .title-info-block {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        color: #262626;\r\n        font-weight: 600;\r\n        line-height: 22px;\r\n        .type-tag {\r\n          height: 18px;\r\n          line-height: 16px;\r\n          padding: 0 4px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          border-radius: 6px;\r\n          color: #2475fc;\r\n          border: 1px solid #99bffd;\r\n          &.gray-tag {\r\n            border: 1px solid var(--06, #d9d9d9);\r\n            color: #8c8c8c;\r\n          }\r\n        }\r\n      }\r\n      .desc-info-block {\r\n        color: #8c8c8c;\r\n        font-size: 14px;\r\n        line-height: 22px;\r\n        font-weight: 400;\r\n        margin-top: 4px;\r\n      }\r\n    }\r\n  }\r\n  .footer-box {\r\n    height: 52px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: flex-end;\r\n    gap: 8px;\r\n    border-top: 1px solid var(--06, #d9d9d9);\r\n    padding: 0 24px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal\r\n    :width=\"916\"\r\n    v-model:open=\"show\"\r\n    wrapClassName=\"correlation-library-modal\"\r\n    :title=\"null\"\r\n    :footer=\"null\"\r\n  >\r\n    <div class=\"library-checkbox-box\">\r\n      <div class=\"list-group-box\">\r\n        <div class=\"group-list-box\">\r\n          <div class=\"main-title-block\">{{ t('title_linked_library') }}</div>\r\n          <div style=\"margin-bottom: 16px\">\r\n            <a-input\r\n              style=\"width: 216px\"\r\n              v-model:value=\"searchKeyword\"\r\n              :placeholder=\"t('ph_search_library')\"\r\n              @change=\"onSearch\"\r\n            >\r\n              <template #suffix>\r\n                <SearchOutlined style=\"color: rgba(0, 0, 0, 0.25)\" />\r\n              </template>\r\n            </a-input>\r\n          </div>\r\n          <cu-scroll style=\"padding-right: 16px; height: 480px\">\r\n            <div class=\"classify-box\">\r\n              <div\r\n                class=\"classify-item\"\r\n                @click=\"handleChangeGroup(item)\"\r\n                :class=\"{ active: item.id == group_id }\"\r\n                v-for=\"item in groupLists\"\r\n                :key=\"item.id\"\r\n              >\r\n                <div class=\"classify-title\">{{ item.group_name }}</div>\r\n                <div class=\"right-content\">\r\n                  <div class=\"num\" :class=\"{ 'num-block': item.id <= 0 }\">{{ item.total }}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </cu-scroll>\r\n        </div>\r\n        <div class=\"list-item-box\">\r\n          <div class=\"alert-box\">\r\n            <a-alert\r\n              class=\"zm-alert-info\"\r\n              :message=\"t('msg_linked_library_tip')\"\r\n              type=\"info\"\r\n            />\r\n          </div>\r\n          <div class=\"btn-box\">\r\n            <a-button @click=\"onRefresh\"> <SyncOutlined /> {{ t('btn_refresh') }} </a-button>\r\n            <a-button type=\"primary\" ghost @click=\"openAddLibrary\">{{ t('btn_create_library') }}</a-button>\r\n          </div>\r\n          <a-spin :spinning=\"isRefresh\" :delay=\"100\">\r\n            <cu-scroll style=\"padding: 0 16px; height: 414px\">\r\n              <div\r\n                class=\"library-list-item\"\r\n                @click=\"handleChangeChecked(item)\"\r\n                v-for=\"item in showOptions\"\r\n                :key=\"item.id\"\r\n              >\r\n                <div class=\"avatar-box\">\r\n                  <img :src=\"item.avatar\" alt=\"\" />\r\n                </div>\r\n                <div class=\"info-content-box\">\r\n                  <div class=\"title-info-block\">\r\n                    {{ item.library_name }}\r\n                    <span class=\"type-tag\" :class=\"{ 'gray-tag': item.graph_switch == 0 }\"\r\n                      >Graph</span\r\n                    >\r\n                    <span class=\"type-tag\" v-if=\"item.type == 0\">{{ t('label_normal_library') }}</span>\r\n                    <span class=\"type-tag\" v-if=\"item.type == 1\">{{ t('label_external_library') }}</span>\r\n                    <span class=\"type-tag\" v-if=\"item.type == 2\">{{ t('label_qa_library') }}</span>\r\n                    <span class=\"type-tag\" v-if=\"item.type == 3\">{{ t('label_mp_library') }}</span>\r\n                  </div>\r\n                  <div class=\"desc-info-block\">{{ item.library_intro }}</div>\r\n                </div>\r\n                <div class=\"check-block\">\r\n                  <a-checkbox :checked=\"state.checkedList.includes(item.id)\"></a-checkbox>\r\n                </div>\r\n              </div>\r\n            </cu-scroll>\r\n          </a-spin>\r\n          <div class=\"footer-box\">\r\n            <a-button @click=\"show = false\">{{ t('btn_cancel') }}</a-button>\r\n            <a-button type=\"primary\" @click=\"saveCheckedList\">\r\n              ({{ state.checkedList.length }}) {{ t('btn_confirm') }}</a-button\r\n            >\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, computed } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\nimport { SearchOutlined, SyncOutlined } from '@ant-design/icons-vue'\r\nimport { getLibraryList, getLibraryListGroup } from '@/api/library/index'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst robotStore = useRobotStore()\r\nconst { robotInfo } = robotStore\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.library-select-alert')\r\n\r\nconst emit = defineEmits(['change'])\r\nconst props = defineProps({\r\n  showWxType: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  select_type: {\r\n    type: String,\r\n    default: 'checkbox'\r\n  }\r\n})\r\n\r\nconst state = reactive({\r\n  indeterminate: false,\r\n  checkAll: false,\r\n  checkedList: []\r\n})\r\n\r\nconst group_id = ref('')\r\n\r\nconst groupLists = ref([])\r\n\r\nconst getGroupList = () => {\r\n  getLibraryListGroup().then((res) => {\r\n    let lists = res.data || []\r\n    let totalNumber = 0\r\n    // 计算每个分组的机器人数量\r\n    lists.forEach((group) => {\r\n      totalNumber += +group.total\r\n    })\r\n    groupLists.value = [\r\n      {\r\n        group_name: t('label_all'),\r\n        total: totalNumber,\r\n        id: ''\r\n      },\r\n      ...lists\r\n    ]\r\n  })\r\n}\r\n\r\nconst handleChangeGroup = (item) => {\r\n  group_id.value = item.id\r\n  getList()\r\n}\r\n\r\nconst show = ref(false)\r\n\r\nconst open = (checkedList) => {\r\n  group_id.value = ''\r\n  getList()\r\n  getGroupList()\r\n\r\n  state.checkedList = checkedList\r\n  show.value = true\r\n}\r\n\r\nconst saveCheckedList = () => {\r\n  show.value = false\r\n  triggerChange()\r\n}\r\n\r\nconst searchKeyword = ref('')\r\n\r\nconst onSearch = () => {\r\n  getList()\r\n}\r\n\r\nconst options = ref([])\r\n\r\nconst showOptions = computed(() => {\r\n  if (props.showWxType) {\r\n    return options.value\r\n  } else {\r\n    return options.value.filter((item) => item.type != 3)\r\n  }\r\n})\r\n\r\nconst triggerChange = () => {\r\n  emit('change', [...state.checkedList])\r\n}\r\n\r\nconst getList = async () => {\r\n  isRefresh.value = true\r\n  const res = await getLibraryList({\r\n    library_name: searchKeyword.value,\r\n    type: '',\r\n    show_open_docs: 1\r\n  })\r\n  isRefresh.value = false\r\n  if (res) {\r\n    let list = res.data || []\r\n    if (group_id.value != '') {\r\n      list = list.filter((item) => item.group_id == group_id.value)\r\n    }\r\n    options.value = list\r\n  }\r\n}\r\n\r\nconst handleChangeChecked = (e) => {\r\n  let value = e.id\r\n\r\n  if (state.checkedList.includes(value)) {\r\n    state.checkedList = state.checkedList.filter((item) => item != value)\r\n  } else {\r\n    if (props.select_type == 'radio' && state.checkedList.length > 0) {\r\n      state.checkedList = [value]\r\n    } else {\r\n      state.checkedList.push(value)\r\n    }\r\n  }\r\n}\r\n\r\nconst isRefresh = ref(false)\r\nconst onRefresh = async () => {\r\n  isRefresh.value = true\r\n\r\n  await getList()\r\n\r\n  isRefresh.value = false\r\n\r\n  message.success(t('msg_refresh_success'))\r\n}\r\n\r\nconst openAddLibrary = () => {\r\n  window.open('/#/library/list')\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.recall-settings-box {\r\n  margin-top: 24px;\r\n  height: 600px;\r\n  padding-right: 16px;\r\n  overflow-y: auto;\r\n\r\n  .form-box {\r\n    .form-item {\r\n      margin-bottom: 24px;\r\n    }\r\n\r\n    .form-item-label {\r\n      line-height: 22px;\r\n      margin-bottom: 4px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n\r\n      .question-icon {\r\n        color: #8c8c8c;\r\n      }\r\n    }\r\n\r\n    .is-required {\r\n      .form-item-label::before {\r\n        content: '*';\r\n        padding-right: 2px;\r\n        font-size: 14px;\r\n        color: #fb363f;\r\n      }\r\n    }\r\n\r\n    .number-box {\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      .number-slider-box {\r\n        flex: 1;\r\n      }\r\n\r\n      .number-input-box {\r\n        margin-left: 20px;\r\n      }\r\n    }\r\n\r\n    .retrieval-mode-items {\r\n      .retrieval-mode-item {\r\n        position: relative;\r\n        padding: 16px;\r\n        margin-top: 8px;\r\n        border-radius: 2px;\r\n        border: 1px solid #d9d9d9;\r\n        cursor: pointer;\r\n      }\r\n\r\n      .retrieval-mode-title {\r\n        display: flex;\r\n        align-items: center;\r\n        line-height: 22px;\r\n        margin-bottom: 4px;\r\n        color: #262626;\r\n\r\n        .title-icon {\r\n          margin-right: 4px;\r\n          font-size: 16px;\r\n        }\r\n\r\n        .title-text {\r\n          font-size: 14px;\r\n          font-weight: 600;\r\n        }\r\n\r\n        .recommendation-icon {\r\n          margin-left: 4px;\r\n          font-size: 36px;\r\n        }\r\n      }\r\n\r\n      .retrieval-mode-desc {\r\n        min-height: 44px;\r\n        line-height: 22px;\r\n        font-size: 14px;\r\n        color: #595959;\r\n      }\r\n\r\n      .check-arrow {\r\n        display: none;\r\n      }\r\n    }\r\n\r\n    .retrieval-mode-item.active {\r\n      border: 2px solid #2475fc;\r\n\r\n      .check-arrow {\r\n        position: absolute;\r\n        display: block;\r\n        right: -1px;\r\n        bottom: -1px;\r\n        width: 24px;\r\n        height: 24px;\r\n        font-size: 24px;\r\n        color: #fff;\r\n      }\r\n\r\n      .retrieval-mode-title {\r\n        color: #2475fc;\r\n      }\r\n    }\r\n\r\n    .segment-controls{\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      padding-top: 4px;\r\n    }\r\n  }\r\n}\r\n\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal width=\"600px\" v-model:open=\"show\" :title=\"t('title_recall_settings')\" @ok=\"handleSave\" :okText=\"t('btn_confirm')\" :cancelText=\"t('btn_cancel')\">\r\n    <div class=\"recall-settings-box\">\r\n      <div class=\"form-box\">\r\n        <div class=\"form-item is-required\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('label_retrieval_mode') }}</span>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"retrieval-mode-items\">\r\n              <div\r\n                class=\"retrieval-mode-item\"\r\n                :class=\"{ active: formState.search_type == item.value }\"\r\n                v-for=\"item in retrievalModeList\"\r\n                :key=\"item.value\"\r\n                @click=\"handleSelectRetrievalMode(item.value)\"\r\n              >\r\n                <svg-icon\r\n                  class=\"check-arrow\"\r\n                  name=\"check-arrow-filled\"\r\n                  v-if=\"formState.search_type == item.value\"\r\n                ></svg-icon>\r\n\r\n                <div class=\"retrieval-mode-title\">\r\n                  <svg-icon :name=\"item.iconName\" class=\"title-icon\"></svg-icon>\r\n                  <span class=\"title-text\">{{ item.title }}</span>\r\n                  <svg-icon\r\n                    class=\"recommendation-icon\"\r\n                    name=\"recommendation\"\r\n                    v-if=\"item.isRecommendation\"\r\n                  ></svg-icon>\r\n                </div>\r\n\r\n                <div class=\"retrieval-mode-desc\">\r\n                  {{ item.desc }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      <div class=\"form-item\" v-if=\"formState.search_type == 1\">\r\n        <WeightSelect v-model:rrf_weight=\"formState.rrf_weight\" />\r\n      </div>\r\n\r\n        <div class=\"form-item\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('label_top_k') }}&nbsp;</span>\r\n            <a-tooltip>\r\n              <template #title>{{ t('msg_top_k_tooltip') }}</template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"number-box\">\r\n              <div class=\"number-slider-box\">\r\n                <a-slider\r\n                  class=\"custom-slider\"\r\n                  v-model:value=\"formState.top_k\"\r\n                  :min=\"1\"\r\n                  :max=\"500\"\r\n                />\r\n              </div>\r\n              <div class=\"number-input-box\">\r\n                <a-input-number v-model:value=\"formState.top_k\" :min=\"1\" :max=\"500\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-item\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('label_similarity_threshold') }}&nbsp;</span>\r\n            <a-tooltip>\r\n              <template #title>{{ t('msg_similarity_tooltip') }}</template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"number-box\">\r\n              <div class=\"number-slider-box\">\r\n                <a-slider\r\n                  class=\"custom-slider\"\r\n                  v-model:value=\"formState.similarity\"\r\n                  :min=\"0\"\r\n                  :max=\"1\"\r\n                  :step=\"0.01\"\r\n                />\r\n              </div>\r\n              <div class=\"number-input-box\">\r\n                <a-input-number\r\n                  v-model:value=\"formState.similarity\"\r\n                  :min=\"0\"\r\n                  :max=\"1\"\r\n                  :step=\"0.01\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-item\">\r\n          <div class=\"form-item-label\">\r\n            <span class=\"setting-title\">{{ t('label_recall_neighbor_segments') }}&nbsp;</span>\r\n            <a-tooltip :overlayStyle=\"{ maxWidth: '350px' }\">\r\n              <template #title>\r\n                <div style=\"font-size: 13px;\">\r\n                  <p>{{ t('msg_recall_neighbor_tooltip') }}</p>\r\n                </div>\r\n              </template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n            &nbsp;\r\n            <a-switch v-model:checked=\"formState.recall_neighbor_switch\" />\r\n          </div>\r\n\r\n          <div class=\"form-item-body\">\r\n            <div class=\"segment-controls\">\r\n              <div class=\"segment-input\">\r\n                <span>{{ t('label_concat_before') }}</span>&nbsp;\r\n                <a-select v-model:value=\"formState.recall_neighbor_before_num\" style=\"width: 80px;\">\r\n                  <a-select-option :value=\"i - 1\" v-for=\"i in 6\" :key=\"i\">{{ i - 1 }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n\r\n              <div class=\"segment-input\">\r\n                <span>{{ t('label_concat_after') }}</span>&nbsp;\r\n                <a-select v-model:value=\"formState.recall_neighbor_after_num\" style=\"width: 80px;\">\r\n                  <a-select-option :value=\"i - 1\" v-for=\"i in 6\" :key=\"i\">{{ i - 1 }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n\r\n              <div class=\"segment-text\">{{ t('label_segments_count') }}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-item\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('label_rerank_model') }}</span>\r\n            &nbsp;\r\n            <a-switch\r\n              :checkedValue=\"1\"\r\n              :unCheckedValue=\"0\"\r\n              v-model:checked=\"formState.rerank_status\"\r\n            />\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <ModelSelect\r\n              modelType=\"RERANK\"\r\n              v-model:modeName=\"formState.rerank_use_model\"\r\n              v-model:modeId=\"formState.rerank_model_config_id\"\r\n              style=\"width: 320px\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-item\">\r\n          <div class=\"form-item-label\">\r\n            <a-tooltip :title=\"t('msg_metadata_tooltip')\">\r\n              <span>{{ t('label_metadata_filtering') }} <QuestionCircleOutlined/></span>\r\n            </a-tooltip>\r\n            &nbsp;\r\n            <a-switch\r\n              :checkedValue=\"1\"\r\n              :unCheckedValue=\"0\"\r\n              v-model:checked=\"formState.meta_search_switch\"\r\n            />\r\n          </div>\r\n          <div class=\"form-item-body\" v-if=\"formState.meta_search_switch == 1\">\r\n            <MetaFilterBox\r\n              v-model:rule=\"formState.meta_search_condition_list\"\r\n              v-model:type=\"formState.meta_search_type\"\r\n              ref=\"metaFilterRef\"\r\n              class=\"meta-box\"\r\n              :meta-data=\"metaList\"/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, toRaw, computed } from 'vue'\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue'\r\nimport WeightSelect from '@/components/weight-select/index.vue'\r\nimport { message } from 'ant-design-vue'\r\nimport ModelSelect from '@/components/model-select/model-select.vue'\r\nimport MetaFilterBox from \"@/views/robot/robot-config/basic-config/components/meta-filter-box.vue\";\r\nimport {getLibaryMetaSchemaList, getRobotMetaSchemaList} from \"@/api/library/index.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.knowledge-base-node.recall-settings-alert')\r\n\r\nconst emit = defineEmits(['change'])\r\n\r\nconst retrievalModeList = computed(() => [\r\n  {\r\n    iconName: 'search',\r\n    title: t('title_hybrid_search'),\r\n    value: 1,\r\n    isRecommendation: true,\r\n    desc: t('msg_hybrid_search_desc')\r\n  },\r\n  {\r\n    iconName: 'file-search',\r\n    title: t('title_vector_search'),\r\n    value: 2,\r\n    desc: t('msg_vector_search_desc')\r\n  },\r\n  {\r\n    iconName: 'comment-search',\r\n    title: t('title_full_text_search'),\r\n    value: 3,\r\n    desc: t('msg_full_text_search_desc')\r\n  }\r\n])\r\n\r\nconst formState = reactive({\r\n  rerank_status: 0,\r\n  rerank_use_model: undefined,\r\n  rerank_model_config_id: undefined,\r\n  search_type: 1,\r\n  meta_search_switch: 0,\r\n  meta_search_type: 1,\r\n  meta_search_condition_list: \"\",\r\n  rrf_weight: {},\r\n  recall_neighbor_switch: false,\r\n  recall_neighbor_before_num: 1,\r\n  recall_neighbor_after_num: 1,\r\n})\r\n\r\nconst show = ref(false)\r\nconst metaList = ref([])\r\nconst libraryIds = ref([])\r\nconst robotInfo = ref({})\r\n\r\nconst open = (data) => {\r\n  formState.rerank_status = data.rerank_status || 0\r\n  formState.rerank_use_model = data.rerank_use_model || undefined\r\n  formState.rerank_model_config_id = data.rerank_model_config_id || ''\r\n  formState.top_k = data.top_k\r\n  formState.similarity = data.similarity\r\n  formState.search_type = data.search_type\r\n  formState.meta_search_switch = Number(data.meta_search_switch)\r\n  formState.meta_search_type = Number(data.meta_search_type)\r\n  formState.meta_search_condition_list = data.meta_search_condition_list\r\n  formState.rrf_weight = data.rrf_weight\r\n  formState.recall_neighbor_switch = data.recall_neighbor_switch\r\n  formState.recall_neighbor_before_num = data.recall_neighbor_before_num\r\n  formState.recall_neighbor_after_num = data.recall_neighbor_after_num\r\n\r\n  show.value = true\r\n}\r\n\r\nconst getMetaList = () => {\r\n  let req\r\n  if (libraryIds.value.length) {\r\n    req = getLibaryMetaSchemaList({library_ids: libraryIds.value.toString()})\r\n  } else {\r\n    req = getRobotMetaSchemaList({id: robotInfo.value.id})\r\n  }\r\n  req.then(res => {\r\n    metaList.value = res?.data || []\r\n  })\r\n}\r\n\r\nconst handleSelectRetrievalMode = (val) => {\r\n  formState.search_type = val\r\n}\r\n\r\nconst checkRerank = () => {\r\n  if (formState.rerank_status == 1 && !formState.rerank_model_config_id) {\r\n    return true\r\n  }\r\n\r\n  return false\r\n}\r\n\r\nconst handleSave = () => {\r\n  if (checkRerank()) {\r\n    return message.error(t('msg_select_rerank_model'))\r\n  }\r\n\r\n  show.value = false\r\n  triggerChange()\r\n}\r\n\r\nconst triggerChange = () => {\r\n  emit('change', toRaw(formState))\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_knowledge_base')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('label_input') }}</div>\r\n\r\n            <a-form-item :label=\"t('label_knowledge_base')\">\r\n              <div class=\"konwledge-list-item\" v-for=\"item in selectedLibraryRows\" :key=\"item.id\">\r\n                <div class=\"avatar-box\">\r\n                  <img :src=\"item.avatar\" alt=\"\" />\r\n                </div>\r\n                <div class=\"content-box\">\r\n                  <div class=\"list-name\">{{ item.library_name }}</div>\r\n                  <div class=\"list-intro\">{{ item.library_intro }}</div>\r\n                </div>\r\n                <div class=\"btn-hover-wrap\" @click=\"handleDelKonwledge(item)\">\r\n                  <CloseCircleOutlined />\r\n                </div>\r\n              </div>\r\n              <div class=\"btn-block\">\r\n                <div>\r\n                  <a-button\r\n                    @click=\"handleOpenSelectLibraryAlert\"\r\n                    :icon=\"h(PlusOutlined)\"\r\n                    block\r\n                    type=\"dashed\"\r\n                    >{{ t('btn_add_knowledge_base') }}</a-button\r\n                  >\r\n                </div>\r\n                <div>\r\n                  <a-button\r\n                    @click=\"handleOpenRecallSettingsAlert\"\r\n                    :icon=\"h(SettingOutlined)\"\r\n                    block\r\n                    type=\"dashed\"\r\n                    >{{ t('btn_recall_settings') }}</a-button\r\n                  >\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n\r\n            <div class=\"diy-form-item\">\r\n              <div class=\"form-label\">{{ t('label_user_question') }}</div>\r\n              <div class=\"form-content\">\r\n                <div class=\"form-content\">\r\n                  <a-cascader\r\n                    v-model:value=\"formState.question_value\"\r\n                    @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                    style=\"width: 220px\"\r\n                    :options=\"variableOptions\"\r\n                    :allowClear=\"false\"\r\n                    :displayRender=\"({ labels }) => labels.join('/')\"\r\n                    :field-names=\"{ children: 'children' }\"\r\n                    :placeholder=\"t('ph_select')\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_output') }}</div>\r\n            <div class=\"options-item\">\r\n              <div class=\"option-label\">{{ t('label_knowledge_quote') }}</div>\r\n              <div class=\"option-type\">string</div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n        <LibrarySelectAlert\r\n          ref=\"librarySelectAlertRef\"\r\n          :showWxType=\"!!wxAppLibary\"\r\n          @close=\"getList\"\r\n          @change=\"onChangeLibrarySelected\"\r\n        />\r\n        <RecallSettingsAlert ref=\"recallSettingsAlertRef\" @change=\"onChangeRecallSettings\" />\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { ref, reactive, watch, computed, onMounted, h, toRaw } from 'vue'\r\nimport { CloseCircleOutlined, PlusOutlined, SettingOutlined } from '@ant-design/icons-vue'\r\nimport { getLibraryList } from '@/api/library/index'\r\nimport LibrarySelectAlert from './components/library-select-alert.vue'\r\nimport RecallSettingsAlert from '../nodes/knowledge-base-node//recall-settings-alert.vue'\r\nimport { getSpecifyAbilityConfig } from '@/api/explore/index.js'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.knowledge-base-node-form')\r\nconst robotStore = useRobotStore()\r\n\r\nconst rrf_weight = computed(() => {\r\n  if (robotStore.robotInfo.rrf_weight) {\r\n    return JSON.parse(robotStore.robotInfo.rrf_weight)\r\n  }\r\n  return {\r\n    vector: 0,\r\n    search: 0,\r\n    graph: 0\r\n  }\r\n})\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nfunction getOptions() {\r\n  // const node = props.lf.getNodeDataById(props.nodeId)\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    variableOptions.value = handleOptions(list)\r\n  }\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst formRef = ref()\r\nconst wxAppLibary = ref(null)\r\nconst formState = reactive({\r\n  library_ids: [],\r\n  rerank_status: 0,\r\n  rerank_use_model: undefined,\r\n  rerank_model_config_id: void 0,\r\n  top_k: 5,\r\n  similarity: 0.5,\r\n  search_type: 1,\r\n  meta_search_switch: 0,\r\n  meta_search_type: 1,\r\n  meta_search_condition_list: \"\",\r\n  question_value: '',\r\n  rrf_weight: {},\r\n  recall_neighbor_switch: false,\r\n  recall_neighbor_before_num:1,\r\n  recall_neighbor_after_num: 1,\r\n})\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    libs: {\r\n      ...formState,\r\n      rerank_model_config_id: formState.rerank_model_config_id\r\n        ? +formState.rerank_model_config_id\r\n        : void 0,\r\n      question_value: formState.question_value.join('.'),\r\n      library_ids: formState.library_ids.join(','),\r\n      rrf_weight: JSON.stringify(formState.rrf_weight),\r\n      recall_neighbor_switch: formState.recall_neighbor_switch,\r\n      recall_neighbor_before_num: formState.recall_neighbor_before_num,\r\n      recall_neighbor_after_num: formState.recall_neighbor_before_num,\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let libs = JSON.parse(dataRaw).libs || {}\r\n\r\n    getOptions()\r\n\r\n    libs = JSON.parse(JSON.stringify(libs))\r\n\r\n    for (let key in libs) {\r\n      if (key == 'library_ids') {\r\n        formState[key] = libs[key] ? libs[key].split(',') : []\r\n      } else if (key == 'question_value') {\r\n        formState.question_value = formatQuestionValue(libs['question_value'])\r\n      } else if (key == 'rrf_weight') {\r\n        formState.rrf_weight = libs[key] ? JSON.parse(libs[key]) : libs[key]\r\n      } else {\r\n        formState[key] = libs[key]\r\n      }\r\n    }\r\n\r\n    if (!formState.rrf_weight || Object.keys(formState.rrf_weight).length == 0) {\r\n      //  没有值 则去默认值\r\n      formState.rrf_weight = rrf_weight.value\r\n    }\r\n\r\n    // 公众号知识库是否开启\r\n    getSpecifyAbilityConfig({ ability_type: 'library_ability_official_account' }).then((res) => {\r\n      let _data = res?.data || {}\r\n      if (_data?.user_config?.switch_status == 1) {\r\n        wxAppLibary.value = _data\r\n      }\r\n    })\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst libraryList = ref([])\r\nconst librarySelectAlertRef = ref(null)\r\nconst selectedLibraryRows = computed(() => {\r\n  return libraryList.value.filter((item) => {\r\n    if (!wxAppLibary.value) {\r\n      return formState.library_ids.includes(item.id) && item.type != 3\r\n    } else {\r\n      return formState.library_ids.includes(item.id)\r\n    }\r\n  })\r\n})\r\n\r\n// 移除知识库\r\nconst handleDelKonwledge = (item) => {\r\n  let index = formState.library_ids.indexOf(item.id)\r\n  formState.library_ids.splice(index, 1)\r\n}\r\n\r\nconst onChangeLibrarySelected = (checkedList) => {\r\n  getList()\r\n  formState.library_ids = [...checkedList]\r\n}\r\n\r\nconst handleOpenSelectLibraryAlert = () => {\r\n  librarySelectAlertRef.value.open([...formState.library_ids])\r\n}\r\n\r\n// 召回设置\r\nconst recallSettingsAlertRef = ref(null)\r\n\r\nconst handleOpenRecallSettingsAlert = () => {\r\n  recallSettingsAlertRef.value.open(toRaw(formState), null, formState.library_ids)\r\n}\r\n\r\nconst onChangeRecallSettings = (data) => {\r\n  formState.rerank_status = data.rerank_status\r\n  formState.rerank_use_model = data.rerank_use_model\r\n  formState.rerank_model_config_id = data.rerank_model_config_id\r\n  formState.top_k = data.top_k\r\n  formState.similarity = data.similarity\r\n  formState.search_type = data.search_type\r\n  formState.meta_search_switch = Number(data.meta_search_switch)\r\n  formState.meta_search_type = Number(data.meta_search_type)\r\n  formState.meta_search_condition_list = data.meta_search_condition_list\r\n  formState.rrf_weight = data.rrf_weight\r\n  formState.recall_neighbor_switch = data.recall_neighbor_switch\r\n  formState.recall_neighbor_before_num = data.recall_neighbor_before_num\r\n  formState.recall_neighbor_after_num = data.recall_neighbor_after_num\r\n}\r\n\r\n// 获取知识库\r\nconst getList = async () => {\r\n  const res = await getLibraryList({ type: '' })\r\n  if (res) {\r\n    libraryList.value = res.data || []\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n  getList()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import './form-block.less';\r\n.node-form-content {\r\n  ::v-deep(.ant-form-item-label) {\r\n    padding: 0 0 4px;\r\n  }\r\n}\r\n.konwledge-list-item {\r\n  padding: 14px 16px;\r\n  height: 72px;\r\n  border: 1px solid #d8dde5;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: #fff;\r\n  font-size: 14px;\r\n  line-height: 22px;\r\n  margin-bottom: 4px;\r\n  .avatar-box {\r\n    width: 40px;\r\n    height: 40px;\r\n    border: 1px solid var(--07, #f0f0f0);\r\n    border-radius: 6px;\r\n    margin-right: 8px;\r\n    img {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n  .list-name {\r\n    color: #262626;\r\n    font-weight: 600;\r\n  }\r\n  .list-intro {\r\n    font-size: 12px;\r\n    margin-top: 2px;\r\n    line-height: 20px;\r\n    color: #8c8c8c;\r\n    max-width: 400px;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n  }\r\n  .content-box {\r\n    flex: 1;\r\n  }\r\n}\r\n\r\n.btn-block {\r\n  display: flex;\r\n  gap: 4px;\r\n  & > div {\r\n    flex: 1;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    :class=\"['sub-field-item-box', `sub-field-item-box_${props.level}`]\"\r\n    v-for=\"(item, index) in props.data\"\r\n    :key=\"item.cu_key\"\r\n  >\r\n    <div class=\"sub-field-item\">\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-input\r\n        class=\"mr12\"\r\n        :style=\"{ width: widthPx }\"\r\n        v-model:value=\"item.key\"\r\n        :placeholder=\"t('ph_input')\"\r\n      ></a-input>\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-select\r\n        class=\"mr12\"\r\n        @change=\"onTypeChange(item)\"\r\n        v-model:value=\"item.typ\"\r\n        :placeholder=\"t('ph_select')\"\r\n        :style=\"{ width: widthPx }\"\r\n      >\r\n        <a-select-option v-for=\"op in filterTypOptions\" :value=\"op.value\">{{\r\n          op.value\r\n        }}</a-select-option>\r\n      </a-select>\r\n      <div\r\n        class=\"btn-hover-wrap mr12\"\r\n        @click=\"onAddSubs(index, props.data)\"\r\n        v-if=\"showAddBtn(item)\"\r\n      >\r\n        <PlusCircleOutlined />\r\n      </div>\r\n\r\n      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index, props.data)\">\r\n        <CloseCircleOutlined />\r\n      </div>\r\n    </div>\r\n    <template v-if=\"item.subs && item.subs.length > 0\">\r\n      <SubsKey :level=\"props.level + 1\" :typOptions=\"props.typOptions\" :data=\"item.subs\" />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { computed } from 'vue'\r\nimport { CloseCircleOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.code-run-node.subs-key')\r\nconst props = defineProps({\r\n  data: {},\r\n  level: {\r\n    type: Number\r\n  },\r\n  typOptions: {\r\n    type: Array\r\n  }\r\n})\r\n\r\nconst filterTypOptions = computed(() => {\r\n  if (props.level > 2) {\r\n    return props.typOptions.filter((item) => item.value != 'object')\r\n  }\r\n  return props.typOptions\r\n})\r\n\r\nconst widthPx = computed(() => {\r\n  if (props.level == 2) {\r\n    return '180px'\r\n  }\r\n  return '146px'\r\n})\r\n\r\nconst onAddSubs = (index, data) => {\r\n  data[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index, data) => {\r\n  data.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst showAddBtn = (item) => {\r\n  return item.typ == 'object' && props.level <= 2\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sub-field-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 4px;\r\n  .btn-hover-wrap {\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    width: 24px;\r\n    height: 24px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n.mr12 {\r\n  margin-right: 12px;\r\n}\r\n.sub-field-item-box_3 .fork-icon {\r\n  margin-left: 34px;\r\n}\r\n.fork-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n  margin-right: 2px;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <Codemirror\r\n      @wheel.stop=\"\"\r\n      originalStyle\r\n      class=\"cm-component\"\r\n      v-model:value=\"code\"\r\n      :options=\"cmOptions\"\r\n      ref=\"cmRef\"\r\n      :height=\"props.height\"\r\n      :width=\"props.width\"\r\n      @change=\"onChange\"\r\n      @input=\"onInput\"\r\n      @ready=\"onReady\"\r\n    >\r\n    </Codemirror>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue'\r\nimport 'codemirror/mode/javascript/javascript.js'\r\nimport Codemirror from 'codemirror-editor-vue3'\r\nimport 'codemirror/theme/dracula.css'\r\nconst emit = defineEmits(['update:value', 'change'])\r\n\r\nconst code = ref('')\r\n\r\nconst props = defineProps({\r\n  value: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  width: {\r\n    type: Number,\r\n    default: 664\r\n  },\r\n  height: {\r\n    type: Number,\r\n    default: 150\r\n  }\r\n})\r\n\r\nwatch(\r\n  () => props.value,\r\n  (val) => {\r\n    code.value = val\r\n  },\r\n  {\r\n    immediate: true\r\n  }\r\n)\r\n\r\nconst cmOptions = {\r\n  mode: 'text/javascript',\r\n  theme: 'dracula'\r\n}\r\n\r\nconst cmRef = ref(null)\r\n\r\nconst onChange = (val) => {\r\n  emit('update:value', val)\r\n}\r\n\r\nconst handleRefresh = ()=>{\r\n  cmRef.value.refresh()\r\n}\r\n\r\nconst onReady = () => {}\r\nconst onInput = () => {}\r\n\r\ndefineExpose({\r\n  handleRefresh\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped></style>","<template>\r\n  <div>\r\n    <a-modal\r\n      v-model:open=\"show\"\r\n      :title=\"t('title_run_test')\"\r\n      :footer=\"null\"\r\n      :width=\"820\"\r\n      wrapClassName=\"no-padding-modal\"\r\n    >\r\n      <div class=\"flex-content-box\">\r\n        <div class=\"test-model-box\">\r\n          <div class=\"top-title\" @click=\"handleOpenRecognizeModal\">{{ t('label_run_params') }}</div>\r\n          <a-form\r\n            :model=\"formState\"\r\n            ref=\"formRef\"\r\n            layout=\"vertical\"\r\n            :wrapper-col=\"{ span: 24 }\"\r\n            autocomplete=\"off\"\r\n          >\r\n            <a-form-item\r\n              v-for=\"(item, index) in formState.test_params\"\r\n              :key=\"item.key\"\r\n              :name=\"['test_params', index, 'value']\"\r\n              :rules=\"[{ required: true, message: `${t('ph_input')}${item.field}` }]\"\r\n            >\r\n              <template #label>\r\n                <a-flex :gap=\"8\"\r\n                  >{{ item.field }}<a-tag style=\"margin: 0\">{{ item.typ }}</a-tag>\r\n                  <a v-if=\"item.typ.includes('array')\" @click=\"handleOpenRecognizeModal(index)\">\r\n                    <ImportOutlined />\r\n                    {{ t('btn_one_click_import') }}\r\n                  </a>\r\n                </a-flex>\r\n              </template>\r\n              <template v-if=\"item.typ != 'number' && !item.typ.includes('array')\">\r\n                <a-input :placeholder=\"t('ph_input')\" v-model:value=\"item.value\" />\r\n              </template>\r\n              <template v-if=\"item.typ == 'number'\">\r\n                <a-input-number\r\n                  style=\"width: 100%\"\r\n                  :placeholder=\"t('ph_input')\"\r\n                  v-model:value=\"item.value\"\r\n                />\r\n              </template>\r\n              <template v-if=\"item.typ.includes('array')\">\r\n                <div class=\"input-list-box\">\r\n                  <div class=\"input-list-item\" v-for=\"(input, i) in item.value\" :key=\"i\">\r\n                    <a-form-item-rest\r\n                      ><a-input :placeholder=\"t('ph_input')\" v-model:value=\"input.value\"\r\n                    /></a-form-item-rest>\r\n\r\n                    <CloseCircleOutlined\r\n                      v-if=\"item.value.length > 1\"\r\n                      @click=\"handleDelItem(item.value, i)\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"add-btn-box\">\r\n                    <a-button @click=\"handleAddItem(item.value)\" block type=\"dashed\">{{ t('btn_add') }}</a-button>\r\n                  </div>\r\n                </div>\r\n              </template>\r\n            </a-form-item>\r\n          </a-form>\r\n          <div class=\"save-btn-box\">\r\n            <a-button\r\n              :loading=\"loading\"\r\n              @click=\"handleSubmit\"\r\n              style=\"background-color: #00ad3a\"\r\n              type=\"primary\"\r\n              ><CaretRightOutlined />{{ t('btn_run_test') }}</a-button>\r\n          </div>\r\n        </div>\r\n        <div class=\"preview-box\">\r\n          <template v-if=\"resultStr\">\r\n            <div class=\"preview-title\">\r\n              <div class=\"title-text\">{{ t('label_log_details') }}</div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_run_log') }}<CopyOutlined @click=\"handleCopy\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"resultStr\" />\r\n              </div>\r\n            </div>\r\n          </template>\r\n          <template v-if=\"isErrorStatus\">\r\n            <div class=\"preview-title\">\r\n              <div class=\"title-text\">{{ t('label_log_details') }}</div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_run_log') }}</div>\r\n              <div class=\"error-box\" style=\"margin-top: 12px;\">\r\n                 <a-alert :message=\"errorMsg\" type=\"error\" />\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n\r\n    <a-modal v-model:open=\"recognizeOpen\" :width=\"820\" :title=\"t('title_batch_import')\" @ok=\"handleSaveValue\">\r\n      <a-textarea\r\n        v-model:value.trim=\"jsonData\"\r\n        :placeholder=\"t('ph_input_json')\"\r\n        style=\"min-height: 200px\"\r\n      />\r\n\r\n      <div v-if=\"showJsonError\" style=\"color: #f50\">\r\n        {{ t('msg_json_error') }}\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport {\r\n  CaretRightOutlined,\r\n  CloseCircleOutlined,\r\n  CopyOutlined,\r\n  ImportOutlined\r\n} from '@ant-design/icons-vue'\r\nimport VueJsonPretty from 'vue-json-pretty'\r\nimport 'vue-json-pretty/lib/styles.css'\r\nimport { reactive, ref } from 'vue'\r\nimport { testCodeRun } from '@/api/robot/index'\r\nimport { message } from 'ant-design-vue'\r\nimport { copyText } from '@/utils/index'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.code-run-node.run-test')\r\n\r\nconst emit = defineEmits(['save'])\r\n\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst show = ref(false)\r\n\r\nconst loading = ref(false)\r\n\r\nlet is_in_loop_node = false // 该节点是否在循环节点中\r\n\r\nconst formState = reactive({\r\n  language: 'javaScript',\r\n  main_func: '',\r\n  test_params: []\r\n})\r\n\r\nfunction matchAngleBrackets(str) {\r\n  if (typeof str !== 'string') {\r\n    return null;\r\n  }\r\n  \r\n  // 匹配第一个 < > 内的内容\r\n  const regex = /<([^<>]+)>/;\r\n  const match = str.match(regex);\r\n  \r\n  return match ? match[1] : null;\r\n}\r\n\r\nfunction foundFieldTyp(value) {\r\n  // 匹配字段的类型  如果节点在循环里面 则需要将数组类型 转为非数组类型\r\n  if (value && value.length == 2) {\r\n    let filterItem = props.variableOptions.filter((item) => item.value == value[0])\r\n    if (filterItem.length > 0) {\r\n      let type = filterItem[0].children.filter((item) => item.value == value[1])[0]?.typ || 'string'\r\n      if(type.includes('array') && is_in_loop_node){\r\n        return matchAngleBrackets(type)\r\n      }\r\n      return type\r\n    }\r\n  }\r\n\r\n  return 'string'\r\n}\r\nlet local_test_params = []\r\nconst handleOpenTestModal = async (data) => {\r\n  resultStr.value = ''\r\n  formState.main_func = data.main_func\r\n  formState.language = data.language || 'javaScript'\r\n  let localFormData = localStorage.getItem('code_run_node_test_modal_data') || '{}'\r\n  local_test_params = JSON.parse(localFormData).test_params || []\r\n\r\n  let params = data.params.filter((item) => item.field && item.variable && item.variable.length > 0)\r\n  formState.test_params = params.map((item) => {\r\n    let typ = foundFieldTyp(item.variable)\r\n    return {\r\n      key: Math.random() * 1000,\r\n      field: item.field,\r\n      typ,\r\n      value: setGlobalDefaultVal(typ, item)\r\n    }\r\n  })\r\n\r\n  // console.log(json)\r\n\r\n  show.value = true\r\n}\r\n\r\nfunction setGlobalDefaultVal(typ, item) {\r\n  // 设置默认值  先去缓存里找\r\n  let filetrLocalData = local_test_params.filter((it) => it.field == item.field)\r\n  if (!typ.includes('array')) {\r\n    if (filetrLocalData.length && typeof filetrLocalData[0].value == 'string') {\r\n      return filetrLocalData[0].value\r\n    }\r\n    return ''\r\n  }\r\n\r\n  if (filetrLocalData.length && typeof filetrLocalData[0].value == 'object') {\r\n    return filetrLocalData[0].value\r\n  }\r\n\r\n  return [\r\n    {\r\n      value: '',\r\n      key: Math.random() * 10000\r\n    }\r\n  ]\r\n}\r\n\r\nconst handleDelItem = (item, index) => {\r\n  item.splice(index, 1)\r\n}\r\nconst handleAddItem = (item) => {\r\n  item.push({\r\n    value: '',\r\n    key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst formRef = ref(null)\r\n\r\nconst resultStr = ref('')\r\n\r\nconst isErrorStatus = ref(false)\r\nconst errorMsg = ref('')\r\nconst handleSubmit = () => {\r\n  formRef.value.validate().then(() => {\r\n    let postData = { ...formState }\r\n    let test_params_data = JSON.parse(JSON.stringify(formState.test_params))\r\n    let params = {}\r\n\r\n    test_params_data.forEach((item) => {\r\n      params[item.field] = item.value\r\n      if (item.typ.includes('array')) {\r\n        params[item.field] = item.value.map((it) => {\r\n          it.value = it.value.trim()\r\n          if (isJson(it.value)) {\r\n            return JSON.parse(it.value)\r\n          } else {\r\n            return it.value\r\n          }\r\n        })\r\n        params[item.field] = params[item.field].filter((it) => it)\r\n      }\r\n      if(item.typ === 'object'){\r\n        if(isJson(item.value)){\r\n          params[item.field] = JSON.parse(item.value)\r\n        }\r\n      }\r\n    })\r\n\r\n    postData.params = JSON.stringify(params)\r\n    delete postData.test_params\r\n\r\n    localStorage.setItem('code_run_node_test_modal_data', JSON.stringify(formState))\r\n\r\n    loading.value = true\r\n    isErrorStatus.value = false\r\n    testCodeRun({\r\n      ...postData\r\n    })\r\n      .then((res) => {\r\n        message.success(t('msg_test_success'))\r\n        resultStr.value = JSON.parse(res.data)\r\n      })\r\n      .catch((res) => {\r\n        // resultStr.value = JSON.parse(res.data)\r\n        isErrorStatus.value = true\r\n        errorMsg.value = res.msg\r\n      })\r\n      .finally(() => {\r\n        loading.value = false\r\n      })\r\n  })\r\n}\r\n\r\nfunction isJson(str) {\r\n  // 检查是否为字符串类型\r\n  if (typeof str !== 'string') {\r\n    return false\r\n  }\r\n\r\n  // 去除首尾空格\r\n  const trimmedStr = str.trim()\r\n\r\n  // 检查是否以 { 开头、} 结尾 或者 [ 开头、] 结尾\r\n  const isValidFormat =\r\n    (trimmedStr.startsWith('{') && trimmedStr.endsWith('}')) ||\r\n    (trimmedStr.startsWith('[') && trimmedStr.endsWith(']'))\r\n\r\n  if (!isValidFormat) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    // 尝试解析 JSON\r\n    const parsed = JSON.parse(trimmedStr)\r\n    // 确保解析结果是对象或数组\r\n    return typeof parsed === 'object' && parsed !== null\r\n  } catch (e) {\r\n    // 如果解析失败，则不是有效 JSON\r\n    return false\r\n  }\r\n}\r\n\r\nconst handleCopy = () => {\r\n  copyText(JSON.stringify(resultStr.value))\r\n  message.success(t('msg_copy_success'))\r\n}\r\n\r\nconst open = (data, isInLoopNode) => {\r\n  isErrorStatus.value = false\r\n  is_in_loop_node = isInLoopNode\r\n  handleOpenTestModal(data)\r\n}\r\n\r\nconst recognizeOpen = ref(false)\r\nconst showJsonError = ref(false)\r\nconst editIndex = ref(null)\r\nconst jsonData = ref('')\r\n\r\nconst handleOpenRecognizeModal = (index) => {\r\n  editIndex.value = index\r\n  showJsonError.value = false\r\n  recognizeOpen.value = true\r\n}\r\n\r\nconst handleSaveValue = () => {\r\n  if (isJson(jsonData.value)) {\r\n    let lists = JSON.parse(jsonData.value).map((it) => {\r\n      return {\r\n        value: typeof it == 'string' ? it : JSON.stringify(it)\r\n      }\r\n    })\r\n    let data = formState.test_params[editIndex.value]\r\n    let newData = {\r\n      ...data,\r\n      value: [...data.value.filter(it => it.value != ''), ...lists]\r\n    }\r\n    formState.test_params.splice(editIndex.value, 1, newData)\r\n    recognizeOpen.value = false\r\n  } else {\r\n    showJsonError.value = true\r\n  }\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.flex-content-box {\r\n  display: flex;\r\n  max-height: 600px;\r\n  overflow: hidden;\r\n}\r\n.test-model-box {\r\n  flex: 1;\r\n  margin: 24px 0 0 0;\r\n  padding-right: 16px;\r\n  overflow-y: auto;\r\n  .top-title {\r\n    font-weight: 600;\r\n    margin-bottom: 16px;\r\n  }\r\n  .save-btn-box {\r\n    margin: 32px 0;\r\n    margin-top: 50px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n.tooltip-content {\r\n  white-space: pre-wrap;\r\n}\r\n.loading-box {\r\n  height: 100px;\r\n  justify-content: center;\r\n}\r\n.result-list-box {\r\n  margin: 24px 0;\r\n  width: 100%;\r\n  border: 1px solid #ebebeb;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 8px;\r\n  .list-item-block {\r\n    display: flex;\r\n    align-items: center;\r\n    overflow: hidden;\r\n    gap: 8px;\r\n    padding: 8px;\r\n    color: #333;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\r\n    .right-active-icon {\r\n      margin-left: auto;\r\n      color: #2475fc;\r\n      opacity: 0;\r\n    }\r\n    &:hover {\r\n      background: #f2f4f7;\r\n      .right-active-icon {\r\n        opacity: 1;\r\n      }\r\n    }\r\n    &.active {\r\n      color: #2475fc;\r\n      background: #e6efff;\r\n      .right-active-icon {\r\n        opacity: 0;\r\n      }\r\n    }\r\n    .status-block {\r\n      font-size: 20px;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      font-weight: 600;\r\n      img {\r\n        width: 24px;\r\n        height: 24px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n    .out-put-box {\r\n      flex: 1;\r\n      margin-left: 24px;\r\n      overflow: hidden;\r\n      .out-text-box {\r\n        background: #f2f2f2;\r\n        border-radius: 6px;\r\n        padding: 8px;\r\n        width: 100%;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.input-list-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  .input-list-item {\r\n    display: flex;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n.preview-box {\r\n  flex: 1;\r\n  border-left: 1px solid #d9d9d9;\r\n  padding: 16px;\r\n  overflow-y: auto;\r\n  .preview-title {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    .title-text {\r\n      font-size: 15px;\r\n      font-weight: 600;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      margin-left: 12px;\r\n      img {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n  .preview-content-block {\r\n    margin-top: 16px;\r\n    .title-block {\r\n      font-size: 15px;\r\n      color: #262626;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      .anticon-copy {\r\n        cursor: pointer;\r\n        &:hover {\r\n          color: #2475fc;\r\n        }\r\n      }\r\n    }\r\n    .preview-code-box {\r\n      width: fit-content;\r\n      margin-top: 16px;\r\n      padding: 8px;\r\n      border-radius: 8px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &::v-deep(.vjs-tree) {\r\n        width: fit-content;\r\n      }\r\n\r\n      &::v-deep(.vjs-tree-node) {\r\n        width: calc(100% + 16px);\r\n        padding-right: 16px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_code_run')\"\r\n        @close=\"handleClose\"\r\n      >\r\n        <template #runBtn>\r\n          <a-tooltip>\r\n            <template #title>{{ t('tip_run_test') }}</template>\r\n            <div class=\"action-btn\" @click=\"handleOpenTestModal\">\r\n              <CaretRightOutlined style=\"color: rgb(0, 173, 58)\" />\r\n            </div>\r\n          </a-tooltip>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('label_input') }}</div>\r\n            <div class=\"array-form-box\">\r\n              <div class=\"form-item-label\">{{ t('label_custom_input_params') }}</div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.params\" :key=\"index\">\r\n                <a-form-item :label=\"null\" :name=\"['params', index, 'variable']\">\r\n                  <div class=\"flex-block-item\">\r\n                    <a-form-item-rest>\r\n                      <a-input\r\n                        style=\"width: 190px\"\r\n                        v-model:value=\"item.field\"\r\n                        :placeholder=\"t('ph_input_key')\"\r\n                      ></a-input>\r\n                    </a-form-item-rest>\r\n\r\n                    <a-cascader\r\n                      v-model:value=\"item.variable\"\r\n                      @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                      style=\"width: 400px; max-width: calc(100% - 190px);\"\r\n                      :options=\"variableOptions\"\r\n                      :allowClear=\"false\"\r\n                      :displayRender=\"({ labels }) => labels.join('/')\"\r\n                      :field-names=\"{ children: 'children' }\"\r\n                      :placeholder=\"t('ph_select')\"\r\n                    />\r\n\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelParams(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddParams\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >{{ t('btn_add_param') }}</a-button\r\n              >\r\n            </div>\r\n\r\n            <div class=\"code-edit-box\">\r\n              <div class=\"title-block\">\r\n                <div>\r\n                  <a-select @change=\"handleChangeLanguage\" v-model:value=\"formState.language\" style=\"width: 160px\">\r\n                    <a-select-option value=\"javaScript\">javaScript</a-select-option>\r\n                    <a-select-option value=\"python\">python</a-select-option>\r\n                  </a-select>\r\n                </div>\r\n                <a-flex :gap=\"16\" align=\"center\">\r\n                  <a @click=\"resetTemp\">{{ t('btn_restore_template') }}</a>\r\n                  <div class=\"btn-hover-wrap\" @click=\"openEditCodeBox\"><FullscreenOutlined /></div>\r\n                </a-flex>\r\n              </div>\r\n              <div class=\"code-box\">\r\n                <CodeEditBox v-model:value=\"formState.main_func\" :width=\"410\" :height=\"170\" />\r\n              </div>\r\n            </div>\r\n\r\n            <a-form-item name=\"timeout\" class=\"mt16\">\r\n              <template #label>\r\n                <a-flex :gap=\"2\">{{ t('label_timeout') }}</a-flex>\r\n              </template>\r\n              <div class=\"flex-block-item\">\r\n                <a-input-number\r\n                  :placeholder=\"t('ph_input_url')\"\r\n                  style=\"width: 138px\"\r\n                  :precision=\"0\"\r\n                  v-model:value=\"formState.timeout\"\r\n                  :min=\"0\"\r\n                  :max=\"3000\"\r\n                />\r\n                {{ t('label_second') }}\r\n              </div>\r\n            </a-form-item>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_output_custom') }}</div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\">{{ t('label_type') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\" @mousedown.stop=\"\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n                  <a-form-item :label=\"null\" :name=\"['output', index, 'key']\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 214px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-select\r\n                          @change=\"onTypeChange(item)\"\r\n                          v-model:value=\"item.typ\"\r\n                          :placeholder=\"t('ph_select')\"\r\n                          style=\"width: 214px\"\r\n                        >\r\n                          <a-select-option\r\n                            v-for=\"op in typOptions\"\r\n                            :value=\"op.value\"\r\n                            :key=\"op.value\"\r\n                            >{{ op.value }}</a-select-option\r\n                          >\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n\r\n                      <div\r\n                        class=\"btn-hover-wrap\"\r\n                        v-if=\"item.typ == 'object'\"\r\n                        @click=\"onAddSubs(index)\"\r\n                      >\r\n                        <PlusCircleOutlined />\r\n                      </div>\r\n\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                      <a-form-item-rest>\r\n                        <SubKey :data=\"item.subs\" :level=\"2\" :typOptions=\"typOptions\" />\r\n                      </a-form-item-rest>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleAddOutPut\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_exception_handling') }}</div>\r\n            <div>{{ t('msg_exception_handling_desc') }}</div>\r\n          </div>\r\n\r\n          <a-modal v-model:open=\"open\" :title=\"t('title_edit_code')\" :width=\"746\">\r\n            <template #footer>\r\n              <a-button type=\"primary\" @click=\"handleOk\">{{ t('btn_confirm') }}</a-button>\r\n            </template>\r\n            <div style=\"margin: 40px 0 24px 0\">\r\n              <CodeEditBox\r\n                ref=\"codeEditBoxRef\"\r\n                v-model:value=\"formState.main_func\"\r\n                :width=\"698\"\r\n                :height=\"472\"\r\n              />\r\n            </div>\r\n          </a-modal>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n    <RunTest :variableOptions=\"variableOptions\" ref=\"runTestRef\" />\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, h, onMounted } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  PlusOutlined,\r\n  PlusCircleOutlined,\r\n  FullscreenOutlined,\r\n  CaretRightOutlined\r\n} from '@ant-design/icons-vue'\r\nimport { Modal } from 'ant-design-vue'\r\n\r\nimport SubKey from './subs-key.vue'\r\nimport CodeEditBox from './code-edit-box.vue'\r\nimport RunTest from './run-test.vue'\r\nimport { specialNodeList } from '@/views/workflow/components/util.js'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.code-run-node.code-run-node-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst defaultCode = `function main({data1, data2}){\r\n\treturn {\r\n\t\tdata1,\r\n    \tdata2\r\n\t}\r\n}`\r\n\r\nconst pythonCode = `def main(data1, data2):\r\n\treturn {\r\n        'data1': data1,\r\n        'data2': data2\r\n\t}`\r\n\r\nconst getDefaultCode = () => {\r\n  if (formState.language == 'python') {\r\n    return pythonCode\r\n  }\r\n  return defaultCode\r\n}\r\n\r\nconst handleChangeLanguage = () => {\r\n  formState.main_func = getDefaultCode()\r\n}\r\n\r\nfunction getOptions() {\r\n  // const node = props.lf.getNodeDataById(props.nodeId)\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    variableOptions.value = handleOptions(list)\r\n  }\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  language: 'javaScript',\r\n  main_func: '',\r\n  params: [\r\n    {\r\n      field: '',\r\n      variable: ''\r\n    }\r\n  ],\r\n  timeout: 30,\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      subs: []\r\n    }\r\n  ],\r\n  exception: ''\r\n})\r\n\r\nconst resetTemp = () => {\r\n  Modal.confirm({\r\n    title: t('msg_confirm_restore'),\r\n    content: t('msg_restore_desc'),\r\n    okText: t('btn_confirm'),\r\n    cancelText: t('btn_cancel'),\r\n    onOk() {\r\n      formState.main_func = getDefaultCode()\r\n    }\r\n  })\r\n}\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = Math.random() * 10000\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    code_run: {\r\n      ...formState,\r\n      params: formatParams()\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nfunction formatParams() {\r\n  let list = []\r\n  formState.params.forEach((item) => {\r\n    list.push({\r\n      field: item.field,\r\n      variable: item.variable && item.variable.length > 0 ? item.variable.join('.') : ''\r\n    })\r\n  })\r\n  return list\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let code_run = JSON.parse(dataRaw).code_run || {}\r\n\r\n    code_run = JSON.parse(JSON.stringify(code_run))\r\n\r\n    console.log(code_run, '===')\r\n    getOptions()\r\n\r\n    for (let key in code_run) {\r\n      if (key == 'params') {\r\n        if (code_run[key] && code_run[key].length > 0) {\r\n          formState[key] = code_run[key].map((item) => {\r\n            return {\r\n              ...item,\r\n              cu_key: Math.random() * 10000\r\n            }\r\n          })\r\n        } else {\r\n          formState[key] = []\r\n        }\r\n        continue\r\n      }\r\n\r\n      if (key == 'output') {\r\n        formState['output'] = recursionData(code_run[key])\r\n        continue\r\n      }\r\n      formState[key] = code_run[key]\r\n    }\r\n    formState.language = formState.language || 'javaScript'\r\n    formState.main_func = formState.main_func || getDefaultCode()\r\n\r\n\r\n    formState.params = formState.params.map((it) => {\r\n      let specialKey = ''\r\n      for (let i = 0; i < specialNodeList.length; i++) {\r\n        if (it.variable.indexOf(specialNodeList[i]) > -1) {\r\n          specialKey = specialNodeList[i]\r\n          break\r\n        }\r\n      }\r\n      if (specialKey != '') {\r\n        let arr = it.variable.split('.')\r\n        it.variable = [arr[0], specialKey]\r\n      } else {\r\n        it.variable = it.variable.split('.')\r\n      }\r\n      return {\r\n        ...it,\r\n        key: Math.random() * 10000\r\n      }\r\n    })\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddParams = () => {\r\n  formState.params.push({\r\n    key: '',\r\n    value: '',\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelParams = (index) => {\r\n  formState.params.splice(index, 1)\r\n}\r\n\r\nconst handleAddOutPut = () => {\r\n  formState.output.push({\r\n    key: '',\r\n    typ: 'string',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  formState.output[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst open = ref(false)\r\nconst codeEditBoxRef = ref(null)\r\nconst openEditCodeBox = () => {\r\n  open.value = true\r\n  codeEditBoxRef.value && codeEditBoxRef.value.handleRefresh()\r\n}\r\nconst handleOk = () => {\r\n  open.value = false\r\n}\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nconst runTestRef = ref(null)\r\nconst handleOpenTestModal = () => {\r\n  runTestRef.value.open(JSON.parse(JSON.stringify(formState)), props.node.loop_parent_key != '')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.code-edit-box {\r\n  margin-top: 12px;\r\n  .title-block {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    margin-bottom: 8px;\r\n  }\r\n}\r\n.action-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in;\r\n  margin-left: 8px;\r\n  &:hover {\r\n    background: #e4e6eb;\r\n  }\r\n}\r\n\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <a-modal v-model:open=\"open\" :title=\"t('title_auth_param')\" :width=\"700\">\r\n      <div class=\"mt24\">\r\n        <a-alert\r\n          class=\"zm-alert-info\"\r\n          :message=\"t('msg_auth_param_tip')\"\r\n          type=\"info\"\r\n        />\r\n      </div>\r\n      <div class=\"add-btn-block\">\r\n        <a-button type=\"primary\" :icon=\"h(PlusOutlined)\" ghost @click=\"handleAddKey\"\r\n          >{{ t('btn_add_param') }}</a-button\r\n        >\r\n      </div>\r\n      <div class=\"list-box\">\r\n        <a-table\r\n          :row-selection=\"{ selectedRowKeys: state.selectedRowKeys, onChange: onSelectChange }\"\r\n          :columns=\"columns\"\r\n          :pagination=\"false\"\r\n          :data-source=\"tableData\"\r\n          row-key=\"uni_key\"\r\n          :scroll=\"{ y: 550 }\"\r\n        >\r\n          <template #bodyCell=\"{ column, record }\">\r\n            <template v-if=\"column.dataIndex === 'auth_key'\">\r\n              <a-input v-model:value=\"record.auth_key\" :placeholder=\"t('ph_input')\" />\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'auth_value'\">\r\n              <a-input v-model:value=\"record.auth_value\" :placeholder=\"t('ph_input')\" />\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'auth_value_addto'\">\r\n              <a-select v-model:value=\"record.auth_value_addto\" style=\"width: 100%\">\r\n                <a-select-option value=\"HEADERS\">HEADERS</a-select-option>\r\n                <a-select-option value=\"PARAMS\">PARAMS</a-select-option>\r\n                <a-select-option value=\"BODY\">BODY</a-select-option>\r\n              </a-select>\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'auth_remark'\">\r\n              <a-input :maxLength=\"10\" v-model:value=\"record.auth_remark\" :placeholder=\"t('ph_input')\" />\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'action'\">\r\n              <a-popconfirm\r\n                :title=\"t('msg_confirm_delete')\"\r\n                :ok-text=\"t('btn_confirm')\"\r\n                :cancel-text=\"t('btn_cancel')\"\r\n                @confirm=\"handleDel(record)\"\r\n              >\r\n                <a>{{ t('label_delete') }}</a>\r\n              </a-popconfirm>\r\n            </template>\r\n          </template>\r\n        </a-table>\r\n      </div>\r\n\r\n      <template #footer>\r\n        <a-button @click=\"open = false\">{{ t('btn_cancel') }}</a-button>\r\n        <a-button @click=\"handleSave\">{{ t('btn_only_save') }}</a-button>\r\n        <a-button type=\"primary\" @click=\"handleOk\">{{ t('btn_save_and_add') }}</a-button>\r\n      </template>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { getUuid } from '@/utils/index'\r\nimport { ref, h, reactive } from 'vue'\r\nimport { PlusOutlined } from '@ant-design/icons-vue'\r\nimport { getHttpAuthConfig, saveHttpAuthConfig } from '@/api/robot/index'\r\nimport { message } from 'ant-design-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.http-node.add-authentication-modal')\r\nconst open = ref(false)\r\n\r\nconst tableData = ref([])\r\n\r\nconst emit = defineEmits(['ok'])\r\n\r\nconst columns = [\r\n  {\r\n    title: t('label_key'),\r\n    dataIndex: 'auth_key'\r\n  },\r\n  {\r\n    title: t('label_value'),\r\n    dataIndex: 'auth_value'\r\n  },\r\n  {\r\n    title: t('label_add_to'),\r\n    dataIndex: 'auth_value_addto'\r\n  },\r\n  {\r\n    title: t('label_remark'),\r\n    dataIndex: 'auth_remark'\r\n  },\r\n  {\r\n    title: t('label_operation'),\r\n    dataIndex: 'action',\r\n    width: 80\r\n  }\r\n]\r\n\r\nconst state = reactive({\r\n  selectedRowKeys: []\r\n})\r\n\r\nconst onSelectChange = (selectedRowKeys) => {\r\n  console.log('selectedRowKeys changed: ', selectedRowKeys)\r\n  state.selectedRowKeys = selectedRowKeys\r\n}\r\nconst show = () => {\r\n  open.value = true\r\n  state.selectedRowKeys = []\r\n  getConfigList()\r\n}\r\n\r\nconst handleAddKey = () => {\r\n  if (tableData.value.length >= 100) {\r\n    return message.error(t('msg_max_100'))\r\n  }\r\n  tableData.value.push({\r\n    auth_key: '',\r\n    auth_value: '',\r\n    auth_value_addto: 'HEADERS',\r\n    auth_remark: '',\r\n    uni_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst handleDel = (record) => {\r\n  tableData.value = tableData.value.filter((item) => item.uni_key !== record.uni_key)\r\n}\r\n\r\nconst getConfigList = () => {\r\n  getHttpAuthConfig().then((res) => {\r\n    let list = res.data || []\r\n    tableData.value = list.map((item) => {\r\n      return {\r\n        ...item,\r\n        uni_key: getUuid(16)\r\n      }\r\n    })\r\n  })\r\n}\r\nfunction getParmas() {\r\n  let errorIndex = []\r\n  let resultList = []\r\n\r\n  tableData.value.forEach((item, index) => {\r\n    resultList.push({\r\n      auth_key: item.auth_key,\r\n      auth_value: item.auth_value,\r\n      auth_value_addto: item.auth_value_addto,\r\n      auth_remark: item.auth_remark\r\n    })\r\n    if (item.auth_key == '' || item.auth_value == '') {\r\n      errorIndex.push(index + 1)\r\n    }\r\n  })\r\n\r\n  if (errorIndex.length > 0) {\r\n    message.error(t('msg_fill_params', { index: errorIndex.join(',') }))\r\n    return false\r\n  }\r\n  if (resultList.length == 0) {\r\n    message.error(t('msg_add_param'))\r\n    return false\r\n  }\r\n\r\n  return resultList\r\n}\r\nconst handleOk = () => {\r\n  let http_auth_config_list = getParmas()\r\n  if (http_auth_config_list == false) {\r\n    return\r\n  }\r\n  let list = []\r\n  state.selectedRowKeys.forEach((uni_key) => {\r\n    list.push(tableData.value.find((it) => it.uni_key == uni_key))\r\n  })\r\n  emit('ok', list)\r\n  saveHttpAuthConfig({\r\n    http_auth_config_list: JSON.stringify(http_auth_config_list)\r\n  })\r\n    .then((res) => {\r\n      message.success(t('msg_save_success'))\r\n    })\r\n    .finally(() => {\r\n      state.selectedRowKeys = []\r\n      open.value = false\r\n    })\r\n}\r\n\r\nconst handleSave = () => {\r\n  let http_auth_config_list = getParmas()\r\n  if (http_auth_config_list == false) {\r\n    return\r\n  }\r\n  saveHttpAuthConfig({\r\n    http_auth_config_list: JSON.stringify(http_auth_config_list)\r\n  }).then((res) => {\r\n    message.success(t('msg_save_success'))\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  show\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.mt24 {\r\n  margin-top: 24px;\r\n}\r\n.add-btn-block {\r\n  margin-top: 16px;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.list-box {\r\n  margin-bottom: 24px;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <a-modal\r\n      v-model:open=\"show\"\r\n      :footer=\"null\"\r\n      :width=\"820\"\r\n      wrapClassName=\"no-padding-modal\"\r\n    >\r\n      <template #title>\r\n        <div class=\"modal-title-block\">\r\n           <span>{{ t('title_run_test') }}</span>\r\n        </div>\r\n      </template>\r\n      <div class=\"flex-content-box\">\r\n        <div class=\"test-model-box\">\r\n          <div class=\"auto-extract-tip\"><a-alert :message=\"t('msg_auto_extract_tip')\" type=\"info\" show-icon /></div>\r\n          <a-form\r\n            :model=\"formState\"\r\n            ref=\"formRef\"\r\n            layout=\"vertical\"\r\n            :wrapper-col=\"{ span: 24 }\"\r\n            autocomplete=\"off\"\r\n          >\r\n            <a-form-item\r\n              v-for=\"item in test_params\"\r\n              :key=\"item.node_key\"\r\n              :rules=\"[{ required: item.field.required, message: t('msg_required_field', { label: item.field.label }) }]\"\r\n            >\r\n              <template #label>\r\n                <a-flex :gap=\"4\" >\r\n                    <span>{{ item.field.label }}</span>\r\n                    <a-tag style=\"margin: 0\">{{ item.field.typ }}</a-tag>\r\n                </a-flex>\r\n              </template>\r\n              <template v-if=\"item.field.typ == 'string'\">\r\n                <a-input :placeholder=\"t('ph_input')\" v-model:value=\"item.field.Vals\" />\r\n              </template>\r\n              <template v-if=\"item.field.typ == 'number'\">\r\n                <a-input-number\r\n                  style=\"width: 100%\"\r\n                  :placeholder=\"t('ph_input')\"\r\n                  v-model:value=\"item.field.Vals\"\r\n                />\r\n              </template>\r\n              <template v-if=\"item.field.typ.includes('array')\">\r\n                <div class=\"input-list-box\">\r\n                  <div class=\"input-list-item\" v-for=\"(input, i) in item.field.Vals\" :key=\"i\">\r\n                    <a-form-item-rest\r\n                      ><a-input :placeholder=\"t('ph_input')\" v-model:value=\"input.value\"\r\n                    /></a-form-item-rest>\r\n\r\n                    <CloseCircleOutlined\r\n                      v-if=\"item.field.Vals.length > 1\"\r\n                      @click=\"handleDelItem(item.field.Vals, i)\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"add-btn-box\">\r\n                    <a-button @click=\"handleAddItem(item.field.Vals)\" block type=\"dashed\"\r\n                      >{{ t('btn_add') }}</a-button\r\n                    >\r\n                  </div>\r\n                </div>\r\n              </template>\r\n            </a-form-item>\r\n          </a-form>\r\n\r\n          <div class=\"save-btn-box\">\r\n            <a-button\r\n              :loading=\"loading\"\r\n              @click=\"handleSubmit\"\r\n              style=\"background-color: #00ad3a\"\r\n              type=\"primary\"\r\n              >\r\n              <span v-if=\"!loading\"><CaretRightOutlined />{{ t('btn_run_test') }}</span>\r\n              <span v-if=\"loading\">{{ t('msg_generating') }}</span>\r\n            </a-button>\r\n\r\n            <a-button style=\"margin-left: 16px\" type=\"primary\" v-if=\"runTestStatus === 'success'\" @click=\"handleAutoExtractOutput\">{{ t('btn_auto_extract') }}</a-button>\r\n          </div>\r\n        </div>\r\n        <div class=\"preview-box\">\r\n          <template v-if=\"runTestStatus === 'success'\">\r\n            <div class=\"preview-title\">\r\n              <div class=\"title-text\">{{ t('label_log_details') }}</div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_raw_output') }}<CopyOutlined @click=\"handleCopy('result')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"testResult.result\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_run_log') }}<CopyOutlined @click=\"handleCopy('output')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"testResult.output\" />\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport {\r\n  CaretRightOutlined,\r\n  CloseCircleOutlined,\r\n  CopyOutlined\r\n} from '@ant-design/icons-vue'\r\nimport VueJsonPretty from 'vue-json-pretty'\r\nimport 'vue-json-pretty/lib/styles.css'\r\nimport { reactive, ref, computed } from 'vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { callWorkFlowHttpTest } from '@/api/robot/index'\r\nimport { message } from 'ant-design-vue'\r\nimport { copyText, generateRandomId } from '@/utils/index'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.http-node.run-test')\r\n\r\n\r\nconst props = defineProps({\r\n  node_key: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n})\r\n\r\nconst emit = defineEmits(['save', 'autoExtract'])\r\n\r\nconst robotStore = useRobotStore()\r\n\r\nconst isLockedByOther = computed(() => {\r\n  return robotStore.robotInfo.isLockedByOther\r\n})\r\n\r\n\r\nconst show = ref(false)\r\nconst test_params = ref([])\r\nconst testResult = ref({\r\n    fields: [],\r\n    output: {},\r\n    result: {}\r\n})\r\nconst loading = ref(false)\r\nconst runTestStatus = ref('')\r\nconst formState = reactive({\r\n  is_draft: true,\r\n  robot_key: robotStore.robotInfo.robot_key,\r\n})\r\n\r\n\r\nconst handleOpenTestModal = async (fields) => {\r\n  if (isLockedByOther.value) {\r\n    message.warning(t('msg_locked_by_other'))\r\n    return\r\n  }\r\n  \r\n  testResult.value = {\r\n    fields: [],\r\n    output: {},\r\n    result: {}\r\n  }\r\n  runTestStatus.value = ''\r\n  test_params.value = fields\r\n  show.value = true\r\n\r\n  test_params.value.forEach((item) => {\r\n    if (item.field.typ.includes('array')) {\r\n      handleAddItem(item.field.Vals)\r\n    }\r\n  })\r\n}\r\n\r\n\r\nconst handleDelItem = (item, index) => {\r\n  item.splice(index, 1)\r\n}\r\n\r\nconst handleAddItem = (item) => {\r\n  item.push({\r\n    value: '',\r\n    key: generateRandomId(16)\r\n  })\r\n}\r\n\r\nconst formRef = ref(null)\r\n\r\nconst handleSubmit = () => {\r\n  formRef.value.validate().then(() => {\r\n    const postData = { ...formState, curl_node_key: props.node_key }\r\n    const test_params_data = JSON.parse(JSON.stringify(test_params.value))\r\n\r\n    test_params_data.forEach((item) => {\r\n      if (item.field.typ.includes('array')) {\r\n        item.field.Vals = item.field.Vals.map((it) => it.value)\r\n      }\r\n    })\r\n\r\n    postData.test_params = JSON.stringify(test_params_data)\r\n\r\n    loading.value = true\r\n    runTestStatus.value = 'loading'\r\n\r\n    callWorkFlowHttpTest({\r\n      ...postData\r\n    })\r\n      .then((res) => {\r\n        message.success(t('msg_test_success'))\r\n        testResult.value = res.data;\r\n        runTestStatus.value = 'success'\r\n      })\r\n      .catch((err) => {\r\n        message.error(t('msg_test_failed'))\r\n        runTestStatus.value = 'error'\r\n      })\r\n      .finally(() => {\r\n        loading.value = false\r\n      })\r\n  })\r\n}\r\n\r\n\r\nconst handleCopy = (key) => {\r\n  copyText(JSON.stringify(testResult.value[key]))\r\n\r\n  message.success(t('msg_copy_success'))\r\n}\r\n\r\nconst handleAutoExtractOutput = () => {\r\n  emit('autoExtract', JSON.parse(JSON.stringify(testResult.value.fields)))\r\n}\r\n\r\nconst open = (fields) => {\r\n  handleOpenTestModal(fields)\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.flex-content-box {\r\n  display: flex;\r\n  max-height: 600px;\r\n  overflow: hidden;\r\n}\r\n.test-model-box {\r\n  flex: 1;\r\n  margin: 24px 0 0 0;\r\n  padding-right: 16px;\r\n  overflow-y: auto;\r\n  .top-title {\r\n    font-weight: 600;\r\n    margin-bottom: 16px;\r\n  }\r\n  .auto-extract-tip{\r\n    margin-bottom: 16px;\r\n  }\r\n  .save-btn-box {\r\n    margin: 32px 0;\r\n    margin-top: 50px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n.tooltip-content {\r\n  white-space: pre-wrap;\r\n}\r\n.loading-box {\r\n  height: 100px;\r\n  justify-content: center;\r\n}\r\n.result-list-box {\r\n  margin: 24px 0;\r\n  width: 100%;\r\n  border: 1px solid #ebebeb;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 8px;\r\n  .list-item-block {\r\n    display: flex;\r\n    align-items: center;\r\n    overflow: hidden;\r\n    gap: 8px;\r\n    padding: 8px;\r\n    color: #333;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\r\n    .right-active-icon {\r\n      margin-left: auto;\r\n      color: #2475fc;\r\n      opacity: 0;\r\n    }\r\n    &:hover {\r\n      background: #f2f4f7;\r\n      .right-active-icon {\r\n        opacity: 1;\r\n      }\r\n    }\r\n    &.active {\r\n      color: #2475fc;\r\n      background: #e6efff;\r\n      .right-active-icon {\r\n        opacity: 0;\r\n      }\r\n    }\r\n    .status-block {\r\n      font-size: 20px;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      font-weight: 600;\r\n      img {\r\n        width: 24px;\r\n        height: 24px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n    .out-put-box {\r\n      flex: 1;\r\n      margin-left: 24px;\r\n      overflow: hidden;\r\n      .out-text-box {\r\n        background: #f2f2f2;\r\n        border-radius: 6px;\r\n        padding: 8px;\r\n        width: 100%;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.input-list-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  .input-list-item {\r\n    display: flex;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n.preview-box {\r\n  flex: 1;\r\n  border-left: 1px solid #d9d9d9;\r\n  padding: 16px;\r\n  overflow-y: auto;\r\n  .preview-title {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    .title-text {\r\n      font-size: 15px;\r\n      font-weight: 600;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      margin-left: 12px;\r\n      img {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n  .preview-content-block {\r\n    margin-top: 16px;\r\n    .title-block {\r\n      font-size: 15px;\r\n      color: #262626;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      .anticon-copy {\r\n        cursor: pointer;\r\n        &:hover {\r\n          color: #2475fc;\r\n        }\r\n      }\r\n    }\r\n    .preview-code-box {\r\n      width: fit-content;\r\n      margin-top: 16px;\r\n      padding: 8px;\r\n      border-radius: 8px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &::v-deep(.vjs-tree) {\r\n        width: fit-content;\r\n      }\r\n\r\n      &::v-deep(.vjs-tree-node) {\r\n        width: calc(100% + 16px);\r\n        padding-right: 16px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.modal-title-block{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  .run-detail{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 16px;\r\n    background: #BFFBD7;\r\n    padding: 4px 16px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n    border-radius: 8px;\r\n  }\r\n}\r\n\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_http_node')\"\r\n        @close=\"handleClose\"\r\n      >\r\n        <template #runBtn>\r\n          <a-tooltip>\r\n            <template #title>{{ t('btn_run_test') }}</template>\r\n            <div class=\"run-test-btn\" @click=\"handleOpenTestModal\">\r\n              <CaretRightOutlined style=\"color: rgb(0, 173, 58)\" />\r\n            </div>\r\n          </a-tooltip>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title  export-curl-title\">\r\n            <span>{{ t('title_input') }}</span>\r\n            <a-button ghost type=\"primary\" size=\"small\" @click=\"showParseModal\">\r\n              <CodeOutlined /> {{ t('btn_import_curl') }}\r\n            </a-button>\r\n            </div>\r\n\r\n            <a-form-item\r\n              :label=\"t('label_request_url')\"\r\n              name=\"rawurl\"\r\n              :rules=\"[{ required: true, message: t('msg_input_request_url') }]\"\r\n            >\r\n              <div class=\"flex-block-item\">\r\n                <a-form-item-rest>\r\n                  <a-select v-model:value=\"formState.method\" style=\"width: 120px\">\r\n                    <a-select-option value=\"POST\">POST</a-select-option>\r\n                    <a-select-option value=\"GET\">GET</a-select-option>\r\n                  </a-select>\r\n                </a-form-item-rest>\r\n                <a-input\r\n                  class=\"flex1\"\r\n                  v-model:value=\"formState.rawurl\"\r\n                  :placeholder=\"t('msg_input_request_url')\"\r\n                ></a-input>\r\n              </div>\r\n            </a-form-item>\r\n\r\n            <div class=\"array-form-box\">\r\n              <div class=\"form-item-label\">{{ t('title_headers') }}</div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.headers\" :key=\"index\">\r\n                <a-form-item :label=\"null\" :name=\"['headers', index, 'value']\">\r\n                  <div class=\"flex-block-item\">\r\n                    <a-form-item-rest>\r\n                      <a-input\r\n                        style=\"width: 120px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input_param_key')\"\r\n                      ></a-input>\r\n                    </a-form-item-rest>\r\n\r\n                    <div class=\"at-input-flex1\">\r\n                      <at-input\r\n                        inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                        :ref=\"(el) => setAtInputRef(el, 'headers', index)\"\r\n                        :options=\"variableOptions\"\r\n                        :defaultSelectedList=\"item.tags\"\r\n                        :defaultValue=\"item.value\"\r\n                        @open=\"getVlaueVariableList\"\r\n                        @change=\"\r\n                          (text, selectedList) =>\r\n                            changeValue('headers', text, selectedList, item, index)\r\n                        \"\r\n                        :placeholder=\"t('ph_input_variable_value')\"\r\n                      >\r\n                        <template #option=\"{ label, payload }\">\r\n                          <div class=\"field-list-item\">\r\n                            <div class=\"field-label\">{{ label }}</div>\r\n                            <div class=\"field-type\">{{ payload.typ }}</div>\r\n                          </div>\r\n                        </template>\r\n                      </at-input>\r\n                    </div>\r\n\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelHeader(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddHeader\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >{{ t('btn_add_param') }}</a-button\r\n              >\r\n            </div>\r\n            <div class=\"array-form-box\">\r\n              <div class=\"form-item-label\">{{ t('title_params') }}</div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.params\" :key=\"index\">\r\n                <a-form-item :label=\"null\" :name=\"['params', index, 'value']\">\r\n                  <div class=\"flex-block-item\">\r\n                    <a-form-item-rest>\r\n                      <a-input\r\n                        style=\"width: 120px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input_param_key')\"\r\n                      ></a-input>\r\n                    </a-form-item-rest>\r\n                    <div class=\"at-input-flex1\">\r\n                      <at-input\r\n                        inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                        :ref=\"(el) => setAtInputRef(el, 'params', index)\"\r\n                        :options=\"variableOptions\"\r\n                        :defaultSelectedList=\"item.tags\"\r\n                        :defaultValue=\"item.value\"\r\n                        @open=\"getVlaueVariableList\"\r\n                        @change=\"\r\n                          (text, selectedList) =>\r\n                            changeValue('params', text, selectedList, item, index)\r\n                        \"\r\n                        :placeholder=\"t('ph_input_variable_value')\"\r\n                      >\r\n                        <template #option=\"{ label, payload }\">\r\n                          <div class=\"field-list-item\">\r\n                            <div class=\"field-label\">{{ label }}</div>\r\n                            <div class=\"field-type\">{{ payload.typ }}</div>\r\n                          </div>\r\n                        </template>\r\n                      </at-input>\r\n                    </div>\r\n\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelParams(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddParams\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >{{ t('btn_add_param') }}</a-button\r\n              >\r\n            </div>\r\n\r\n            <div v-if=\"formState.method == 'POST'\">\r\n              <a-form-item :label=\"t('title_body')\" name=\"type\" class=\"line-height-22\">\r\n                <a-radio-group v-model:value=\"formState.type\">\r\n                  <a-radio :value=\"0\">{{ t('label_body_none') }}</a-radio>\r\n                  <a-radio :value=\"1\">{{ t('label_body_form_urlencoded') }}</a-radio>\r\n                  <a-radio :value=\"2\">{{ t('label_body_json') }}</a-radio>\r\n                </a-radio-group>\r\n              </a-form-item>\r\n              <div class=\"array-form-box\" v-if=\"formState.type == 1\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.body\" :key=\"index\">\r\n                  <a-form-item\r\n                    :label=\"null\"\r\n                    :name=\"['body', index, 'value']\"\r\n                    :rules=\"{\r\n                      required: true\r\n                    }\"\r\n                  >\r\n                    <div class=\"flex-block-item\">\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 120px\"\r\n                          v-model:value=\"item.key\"\r\n                          :placeholder=\"t('ph_input_param_key')\"\r\n                        ></a-input>\r\n                      </a-form-item-rest>\r\n                      <div class=\"at-input-flex1\">\r\n                        <at-input\r\n                          inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                          :ref=\"(el) => setAtInputRef(el, 'body', index)\"\r\n                          :options=\"variableOptions\"\r\n                          :defaultSelectedList=\"item.tags\"\r\n                          :defaultValue=\"item.value\"\r\n                          @open=\"getVlaueVariableList\"\r\n                          @change=\"\r\n                            (text, selectedList) =>\r\n                              changeValue('body', text, selectedList, item, index)\r\n                          \"\r\n                          :placeholder=\"t('ph_input_variable_value')\"\r\n                        >\r\n                          <template #option=\"{ label, payload }\">\r\n                            <div class=\"field-list-item\">\r\n                              <div class=\"field-label\">{{ label }}</div>\r\n                              <div class=\"field-type\">{{ payload.typ }}</div>\r\n                            </div>\r\n                          </template>\r\n                        </at-input>\r\n                      </div>\r\n\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelBody(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleAddBody\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n              <a-form-item :label=\"null\" name=\"body_raw\" v-if=\"formState.type == 2\">\r\n                <at-input\r\n                  type=\"textarea\"\r\n                  :options=\"variableOptions\"\r\n                  :defaultSelectedList=\"formState.body_raw_tags\"\r\n                  :defaultValue=\"formState.body_raw\"\r\n                  :ref=\"(el) => setAtInputRef(el, 'body', 'body_raw')\"\r\n                  @open=\"getVlaueVariableList\"\r\n                  @change=\"(text, selectedList) => changeValue('body_raw', text, selectedList)\"\r\n                  :placeholder=\"t('ph_input_variable_value')\"\r\n                >\r\n                  <template #option=\"{ label, payload }\">\r\n                    <div class=\"field-list-item\">\r\n                      <div class=\"field-label\">{{ label }}</div>\r\n                      <div class=\"field-type\">{{ payload.typ }}</div>\r\n                    </div>\r\n                  </template>\r\n                </at-input>\r\n              </a-form-item>\r\n            </div>\r\n\r\n            <a-form-item name=\"timeout\">\r\n              <template #label>\r\n                <a-flex :gap=\"2\">{{ t('label_timeout') }}</a-flex>\r\n              </template>\r\n              <div class=\"flex-block-item\">\r\n                <a-input-number\r\n                  :placeholder=\"t('msg_input_request_url')\"\r\n                  style=\"width: 120px\"\r\n                  :precision=\"0\"\r\n                  v-model:value=\"formState.timeout\"\r\n                  :min=\"0\"\r\n                  :max=\"3000\"\r\n                />\r\n                {{ t('label_second') }}\r\n              </div>\r\n            </a-form-item>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('title_authentication') }}\r\n              <a-tooltip>\r\n                <template #title>{{ t('tip_authentication_params') }}</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\" style=\"width: 124px\">Key</div>\r\n                <div class=\"output-item\" style=\"width: 124px\">Value</div>\r\n                <div class=\"output-item\" style=\"width: 124px\">Add To</div>\r\n              </div>\r\n              <div class=\"array-form-box\" @mousedown.stop=\"\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.http_auth\" :key=\"index\">\r\n                  <a-form-item :label=\"null\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 124px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input_value')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 124px\"\r\n                          v-model:value=\"item.value\"\r\n                          :placeholder=\"t('ph_input_value')\"\r\n                        ></a-input>\r\n                        <a-select v-model:value=\"item.add_to\" style=\"width: 124px\">\r\n                          <a-select-option value=\"HEADERS\">HEADERS</a-select-option>\r\n                          <a-select-option value=\"PARAMS\">PARAMS</a-select-option>\r\n                          <a-select-option value=\"BODY\">BODY</a-select-option>\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n                      <div class=\"btn-hover-wrap\" @click=\"handleDelAuthentication(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleOpenAuthenticationModal\" :icon=\"h(PlusOutlined)\" block type=\"dashed\">{{ t('btn_add_param') }}</a-button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title output-title\" @click=\"test\">\r\n              <span>{{ t('title_output_extraction') }}</span>\r\n              <a-button type=\"primary\" size=\"small\" @click=\"handleOpenTestModal\">{{ t('btn_auto_extract_output') }}</a-button>\r\n            </div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\">{{ t('label_type') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\" @mousedown.stop=\"\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n                  <a-form-item :label=\"null\" :name=\"['output', index, 'key']\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 214px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input_value')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-select\r\n                          @change=\"onTypeChange(item)\"\r\n                          v-model:value=\"item.typ\"\r\n                          :placeholder=\"t('ph_select_value')\"\r\n                          style=\"width: 214px\"\r\n                        >\r\n                          <a-select-option v-for=\"op in typOptions\" :value=\"op.value\" :key=\"op.value\">{{\r\n                            op.value\r\n                          }}</a-select-option>\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n\r\n                      <div\r\n                        class=\"btn-hover-wrap\"\r\n                        v-if=\"item.typ == 'object'\"\r\n                        @click=\"onAddSubs(index)\"\r\n                      >\r\n                        <PlusCircleOutlined />\r\n                      </div>\r\n\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                      <a-form-item-rest>\r\n                        <SubKey :data=\"item.subs\" :level=\"2\" :typOptions=\"typOptions\" />\r\n                      </a-form-item-rest>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleAddOutPut\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n    <ParseCurlModal \r\n      ref=\"parseCurlModalRef\" \r\n      @parse=\"handleParseResult\" \r\n    />\r\n    <AddAuthenticationModal @ok=\"handleSaveAuthentication\" ref=\"addAuthenticationModalRef\" />\r\n    <RunTest ref=\"runTestRef\" :node_key=\"nodeId\" @autoExtract=\"handleAutoExtract\" />\r\n  </NodeFormLayout>\r\n  \r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, h, onMounted, inject } from 'vue'\r\nimport { CloseCircleOutlined, PlusOutlined, PlusCircleOutlined, CodeOutlined, QuestionCircleOutlined, CaretRightOutlined, } from '@ant-design/icons-vue'\r\nimport { message } from 'ant-design-vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport SubKey from './subs-key.vue'\r\nimport ParseCurlModal from './parse-curl-modal.vue'\r\nimport { getUuid } from '@/utils/index'\r\nimport AddAuthenticationModal from './add-authentication-modal.vue'\r\nimport RunTest from './run-test.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.http-node.http-node-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst handleAutoSaveDraft = inject('handleAutoSaveDraft')\r\n\r\nconst variableOptions = ref([])\r\nconst atInputRefs = reactive({})\r\nconst runTestRef = ref(null)\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  method: 'POST',\r\n  rawurl: '',\r\n  headers: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  params: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  type: 1,\r\n  body: [],\r\n  body_raw: '',\r\n  body_raw_tags: [],\r\n  timeout: 30,\r\n  output: [],\r\n  http_auth:[],\r\n})\r\n\r\nconst parseCurlModalRef = ref()\r\n\r\nconst showParseModal = () => {\r\n  parseCurlModalRef.value.show()\r\n}\r\n\r\nconst handleParseResult = (parsedData) => {\r\n  // 将解析结果填充到表单\r\n  let headers = [{\r\n    key: '',\r\n    value: ''\r\n  }]\r\n  let params = [{\r\n    key: '',\r\n    value: ''\r\n  }]\r\n  let body = []\r\n  let body_raw = ''\r\n  let isJson = false\r\n\r\n  formState.method = parsedData.method\r\n  formState.rawurl = parsedData.url\r\n  // 处理value\r\n  function handleValue(value) {\r\n    if (typeof value == 'string') {\r\n      return value\r\n    }\r\n    return JSON.stringify(value)\r\n  }\r\n\r\n  if(parsedData.header && typeof parsedData.header == 'object') {\r\n    headers = Object.keys(parsedData.header).map((key) => {\r\n      if(key.toLowerCase() == 'content-type' && parsedData.header[key].indexOf('application/json') !== -1) {\r\n        isJson = true\r\n      }\r\n\r\n      return {\r\n        key: key,\r\n        value: handleValue(parsedData.header[key]),\r\n        cu_key: getUuid(16)\r\n      }\r\n    })\r\n\r\n    headers = headers.filter(item => item.key.toLowerCase() !== 'content-type')\r\n  }\r\n  \r\n  if(parsedData.data && typeof parsedData.data == 'object') {\r\n    body = Object.keys(parsedData.data).map((key) => {\r\n      return {\r\n        key: key,\r\n        value: handleValue(parsedData.data[key]),\r\n        cu_key: getUuid(16)\r\n      }\r\n    })\r\n\r\n    body_raw = JSON.stringify(parsedData.data)\r\n  }\r\n\r\n  if(parsedData.params && typeof parsedData.params == 'object') {\r\n    params = Object.keys(parsedData.params).map((key) => {\r\n      return {\r\n        key: key,\r\n        value: handleValue(parsedData.params[key]),\r\n        cu_key: getUuid(16)\r\n      }\r\n    })\r\n  }\r\n\r\n  if(isJson) {\r\n    formState.type = 2\r\n    formState.body_raw = body_raw\r\n  }else {\r\n    formState.type = 1\r\n    formState.body = body\r\n  }\r\n\r\n  formState.headers = headers\r\n  formState.params = params\r\n}\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = getUuid(16)\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nfunction getFieldDefaultValue(item) {\r\n  if(item.typ.includes('array')) {\r\n    return []\r\n  }\r\n\r\n  return null\r\n}\r\n\r\nconst handleOpenTestModal = async () => {\r\n  let data = JSON.parse(JSON.stringify(formState))\r\n  \r\n  await handleAutoSaveDraft()\r\n  \r\n  let fields = []\r\n\r\n  data.headers.forEach((item) => {\r\n    if(item.tags && item.tags.length){\r\n      fields = fields.concat(item.tags)\r\n    }\r\n  })\r\n\r\n  data.params.forEach((item) => {\r\n    if(item.tags && item.tags.length){\r\n      fields = fields.concat(item.tags)\r\n    }\r\n  })\r\n\r\n  if(formState.type == 1) {\r\n    data.body.forEach((item) => {\r\n    if(item.tags && item.tags.length){\r\n        fields = fields.concat(item.tags)\r\n      }\r\n    })\r\n  }else if(formState.type == 2) {\r\n    if(data.body_raw_tags.length){\r\n      fields = fields.concat(data.body_raw_tags)\r\n    }\r\n  }\r\n\r\n  fields = fields.map(item => ({\r\n    node_key: item.node_id,\r\n    field: {\r\n      key: item.original_value,\r\n      label: item.label,\r\n      typ: item.typ,\r\n      Vals: getFieldDefaultValue(item),\r\n      required: false,\r\n      sys:false,\r\n    }\r\n  }))\r\n\r\n  runTestRef.value?.open(fields)\r\n}\r\n\r\nconst handleAutoExtract = (fields) => {\r\n  formState.output = fields\r\n  message.success(t('msg_auto_extract_success'))\r\n}\r\n\r\nconst setAtInputRef = (el, name, index) => {\r\n  if (el) {\r\n    let key = `at_input_${name}_${index}`\r\n    atInputRefs[key] = el\r\n  }\r\n}\r\n\r\nconst changeValue = (type, text, selectedList, item) => {\r\n  if (type == 'body_raw') {\r\n    formState.body_raw = text\r\n    formState.body_raw_tags = selectedList\r\n  } else {\r\n    item.tags = selectedList\r\n    item.value = text\r\n  }\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n    list.forEach((item) => {\r\n      item.tags = item.tags || []\r\n    })\r\n\r\n    variableOptions.value = list\r\n  }\r\n}\r\n\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    curl: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let curl = JSON.parse(dataRaw).curl || {}\r\n\r\n    curl = JSON.parse(JSON.stringify(curl))\r\n\r\n    getVlaueVariableList()\r\n\r\n    for (let key in curl) {\r\n      if (key == 'headers' || key == 'params' || key == 'body') {\r\n        if (curl[key] && curl[key].length > 0) {\r\n          formState[key] = curl[key].map((item) => {\r\n            return {\r\n              ...item,\r\n              cu_key: getUuid(16)\r\n            }\r\n          })\r\n        } else {\r\n          formState[key] = []\r\n        }\r\n        continue\r\n      }\r\n      if (key == 'output') {\r\n        formState['output'] = recursionData(curl[key])\r\n        continue\r\n      }\r\n      formState[key] = curl[key]\r\n    }\r\n    formState.http_auth = curl.http_auth || []\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddHeader = () => {\r\n  formState.headers.push({\r\n    key: '',\r\n    value: '',\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelHeader = (index) => {\r\n  formState.headers.splice(index, 1)\r\n}\r\n\r\nconst handleAddParams = () => {\r\n  formState.params.push({\r\n    key: '',\r\n    value: '',\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelParams = (index) => {\r\n  formState.params.splice(index, 1)\r\n}\r\n\r\nconst handleAddBody = () => {\r\n  formState.body.push({\r\n    key: '',\r\n    value: '',\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelBody = (index) => {\r\n  formState.body.splice(index, 1)\r\n}\r\n\r\nconst handleAddOutPut = () => {\r\n  formState.output.push({\r\n    key: '',\r\n    typ: 'string',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  if(!formState.output[index].subs || !Array.isArray(formState.output[index].subs)){\r\n    formState.output[index].subs = []\r\n  }\r\n\r\n  formState.output[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\n\r\nconst addAuthenticationModalRef = ref(null)\r\nconst handleOpenAuthenticationModal = () => {\r\n  addAuthenticationModalRef.value.show()\r\n}\r\n\r\nconst handleSaveAuthentication = (list) => {\r\n  let data = list.map(item => {\r\n    return {\r\n      key: item.auth_key,\r\n      value: item.auth_value,\r\n      add_to: item.auth_value_addto\r\n    }\r\n  })\r\n  formState.http_auth = [...formState.http_auth, ...data]\r\n}\r\n\r\nconst handleDelAuthentication = (index) => {\r\n  formState.http_auth.splice(index, 1)\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.run-test-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in;\r\n  margin-left: 8px;\r\n  &:hover {\r\n    background: #e4e6eb;\r\n  }\r\n}\r\n\r\n.output-title{\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.export-curl-title{\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.at-input-flex1 {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    :class=\"['sub-field-item-box', `sub-field-item-box_${props.level}`]\"\r\n    v-for=\"(item, index) in props.data\"\r\n    :key=\"item.cu_key\"\r\n  >\r\n    <div class=\"sub-field-item\">\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-input\r\n        class=\"mr12\"\r\n        :style=\"{ width: widthPx }\"\r\n        v-model:value=\"item.key\"\r\n        placeholder=\"请输入\"\r\n      ></a-input>\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-select\r\n        class=\"mr12\"\r\n        @change=\"onTypeChange(item)\"\r\n        v-model:value=\"item.typ\"\r\n        placeholder=\"请选择\"\r\n        :style=\"{ width: widthPx }\"\r\n      >\r\n        <a-select-option v-for=\"op in filterTypOptions\" :value=\"op.value\">{{\r\n          op.value\r\n        }}</a-select-option>\r\n      </a-select>\r\n      <div\r\n        class=\"btn-hover-wrap mr12\"\r\n        @click=\"onAddSubs(index, props.data)\"\r\n        v-if=\"showAddBtn(item)\"\r\n      >\r\n        <PlusCircleOutlined />\r\n      </div>\r\n\r\n      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index, props.data)\">\r\n        <CloseCircleOutlined />\r\n      </div>\r\n    </div>\r\n    <template v-if=\"item.subs && item.subs.length > 0\">\r\n      <SubsKey :level=\"props.level + 1\" :typOptions=\"props.typOptions\" :data=\"item.subs\" />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed } from 'vue'\r\nimport { CloseCircleOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\nconst props = defineProps({\r\n  data: {},\r\n  level: {\r\n    type: Number\r\n  },\r\n  typOptions: {\r\n    type: Array\r\n  }\r\n})\r\n\r\nconst filterTypOptions = computed(() => {\r\n  if (props.level > 2) {\r\n    return props.typOptions.filter((item) => item.value != 'object')\r\n  }\r\n  return props.typOptions\r\n})\r\n\r\nconst widthPx = computed(() => {\r\n  if (props.level == 2) {\r\n    return '180px'\r\n  }\r\n  return '146px'\r\n})\r\n\r\nconst onAddSubs = (index, data) => {\r\n  data[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index, data) => {\r\n  data.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst showAddBtn = (item) => {\r\n  return item.typ == 'object' && props.level <= 2\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sub-field-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 4px;\r\n  .btn-hover-wrap {\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    width: 24px;\r\n    height: 24px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n.mr12 {\r\n  margin-right: 12px;\r\n}\r\n.sub-field-item-box_3 .fork-icon {\r\n  margin-left: 34px;\r\n}\r\n.fork-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n  margin-right: 2px;\r\n}\r\n</style>\r\n","<template>\r\n  <a-modal\r\n    v-model:open=\"open\"\r\n    title=\"解析 cURL\"\r\n    :width=\"680\"\r\n    :confirm-loading=\"loading\"\r\n    @ok=\"handleParse\"\r\n    @cancel=\"handleClose\"\r\n    okText=\"解析\"\r\n    cancelText=\"取消\"\r\n  >\r\n    <div class=\"parse-curl-modal\">\r\n      <a-alert\r\n        message=\"请粘贴 cURL 命令，系统将自动解析并填充到 HTTP 请求配置中。只支持 GET、POST 请求。\"\r\n        type=\"info\"\r\n        show-icon\r\n        class=\"mb16\"\r\n      />\r\n      <a-form-item label=\"\">\r\n        <a-textarea\r\n          class=\"curl-textarea\"\r\n          v-model:value=\"curlInput\"\r\n          :placeholder=\"placeholderText\"\r\n          :auto-size=\"{ minRows: 8, maxRows: 8 }\"\r\n          :maxlength=\"50000\"\r\n          show-count\r\n        />\r\n      </a-form-item>\r\n      <div v-if=\"parseError\" class=\"parse-error\">\r\n        <a-alert :message=\"parseError\" type=\"error\" show-icon closable @close=\"parseError = ''\" />\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport parseCurl from '@bany/curl-to-json';\r\n\r\nconst emit = defineEmits(['parse', 'close'])\r\n\r\nconst open = ref(false)\r\nconst loading = ref(false)\r\nconst curlInput = ref('')\r\nconst parseError = ref('')\r\nconst placeholderText = ref(`请粘贴 cURL 命令，例如：curl -X POST https://api.example.com/data -H 'Content-Type: application/json' -d '{\"key\":\"value\"}'`)\r\n\r\nconst show = () => {\r\n  open.value = true\r\n  curlInput.value = ''\r\n  parseError.value = ''\r\n  loading.value = false\r\n}\r\n\r\nconst handleClose = () => {\r\n  open.value = false\r\n  curlInput.value = ''\r\n  parseError.value = ''\r\n  emit('close')\r\n}\r\n\r\nconst hide = () => {\r\n  open.value = false\r\n}\r\n\r\nconst handleParse = async () => {\r\n  if (!curlInput.value.trim()) {\r\n    parseError.value = '请输入 cURL 命令'\r\n    return\r\n  }\r\n\r\n  parseError.value = ''\r\n\r\n  try {\r\n    let curlCommand = curlInput.value.trim()\r\n    // 1. 预处理：将 shell 转义的单引号 ('\\'') 替换回普通的单引号 (')\r\n    // 注意：这步操作是为了把 Shell 语法变成 JS 库容易理解的纯字符串\r\n    // 很多简单的 parser 不支持 shell 的拼接语法\r\n    const PLACEHOLDER = \"__SINGLE_QUOTE_PLACEHOLDER__\";\r\n    // 匹配 Shell 语法的转义结构: ' + \\ + ' + '\r\n    let cleanCommand = curlCommand.replace(/'\\\\''/g, PLACEHOLDER);\r\n\r\n    // Step 2: 移除换行符 (常规清洗)\r\n    cleanCommand = cleanCommand.replace(/\\\\\\n/g, \" \").replace(/\\\\/g, \"\");\r\n \r\n    let out = parseCurl(decodeURIComponent(cleanCommand));\r\n   \r\n    // 处理查询参数：解码被 parseCurl 编码的特殊字符\r\n    if (out.params) {\r\n      const decodedQuery = {};\r\n      for (const [key, value] of Object.entries(out.params)) {\r\n        // 对键进行解码，将 a%5B0%5D 转回 a[0]\r\n        const decodedKey = decodeURIComponent(key);\r\n        // 对值也进行解码（以防值中也有编码字符）\r\n        const decodedValue = typeof value === 'string' ? decodeURIComponent(value) : value;\r\n        decodedQuery[decodedKey] = decodedValue;\r\n      }\r\n      out.params = decodedQuery;\r\n    }\r\n\r\n    // 处理 POST 请求体数据：解码被 parseCurl 编码的特殊字符\r\n    // 只对 application/x-www-form-urlencoded 类型的数据进行解码\r\n    // JSON 类型不需要解码\r\n    if (out.data) {\r\n      const contentType = out.header && out.header['Content-Type'] \r\n        ? out.header['Content-Type'].toLowerCase() \r\n        : '';\r\n      \r\n      // 判断是否是 x-www-form-urlencoded 类型\r\n      const isFormUrlEncoded = contentType.includes('application/x-www-form-urlencoded');\r\n      \r\n      if (isFormUrlEncoded && typeof out.data === 'object') {\r\n        const decodedData = {};\r\n        for (const [key, value] of Object.entries(out.data)) {\r\n          // 对键进行解码\r\n          const decodedKey = decodeURIComponent(key);\r\n          // 对值也进行解码\r\n          const decodedValue = typeof value === 'string' ? decodeURIComponent(value) : value;\r\n          decodedData[decodedKey] = decodedValue;\r\n        }\r\n        out.data = decodedData;\r\n      }\r\n      // JSON 类型的数据不需要解码，保持原样\r\n    }\r\n\r\n    out = JSON.stringify(out).split(PLACEHOLDER).join(\"'\");;\r\n\r\n    out = JSON.parse(out);\r\n    \r\n    if (out.method !== 'GET' && out.method !== 'POST') {\r\n      parseError.value = '只支持 GET、POST 请求'\r\n      return\r\n    }\r\n\r\n    emit('parse', out)\r\n  } catch (error) {\r\n    parseError.value = error.message\r\n  }\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n  hide,\r\n  handleClose\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.parse-curl-modal {\r\n  .mb16 {\r\n    margin-bottom: 16px;\r\n  }\r\n\r\n  .curl-textarea {\r\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\r\n    font-size: 12px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <a-modal v-model:open=\"open\" title=\"鉴权参数\" :width=\"700\">\r\n      <div class=\"mt24\">\r\n        <a-alert\r\n          class=\"zm-alert-info\"\r\n          message=\"选择的参数会自动填充到http节点，鉴权参数在导出CSL或上架模板时会自动清空\"\r\n          type=\"info\"\r\n        />\r\n      </div>\r\n      <div class=\"add-btn-block\">\r\n        <a-button type=\"primary\" :icon=\"h(PlusOutlined)\" ghost @click=\"handleAddKey\"\r\n          >添加参数</a-button\r\n        >\r\n      </div>\r\n      <div class=\"list-box\">\r\n        <a-table\r\n          :row-selection=\"{ selectedRowKeys: state.selectedRowKeys, onChange: onSelectChange }\"\r\n          :columns=\"columns\"\r\n          :pagination=\"false\"\r\n          :data-source=\"tableData\"\r\n          row-key=\"uni_key\"\r\n          :scroll=\"{ y: 550 }\"\r\n        >\r\n          <template #bodyCell=\"{ column, record }\">\r\n            <template v-if=\"column.dataIndex === 'auth_key'\">\r\n              <a-input v-model:value=\"record.auth_key\" placeholder=\"请输入\" />\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'auth_value'\">\r\n              <a-input v-model:value=\"record.auth_value\" placeholder=\"请输入\" />\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'auth_value_addto'\">\r\n              <a-select v-model:value=\"record.auth_value_addto\" style=\"width: 100%\">\r\n                <a-select-option value=\"HEADERS\">HEADERS</a-select-option>\r\n                <a-select-option value=\"PARAMS\">PARAMS</a-select-option>\r\n                <a-select-option value=\"BODY\">BODY</a-select-option>\r\n              </a-select>\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'auth_remark'\">\r\n              <a-input :maxLength=\"10\" v-model:value=\"record.auth_remark\" placeholder=\"请输入\" />\r\n            </template>\r\n            <template v-if=\"column.dataIndex === 'action'\">\r\n              <a-popconfirm\r\n                title=\"确认删除该字段?\"\r\n                ok-text=\"确定\"\r\n                cancel-text=\"取消\"\r\n                @confirm=\"handleDel(record)\"\r\n              >\r\n                <a>删除</a>\r\n              </a-popconfirm>\r\n            </template>\r\n          </template>\r\n        </a-table>\r\n      </div>\r\n\r\n      <template #footer>\r\n        <a-button @click=\"open = false\">取消</a-button>\r\n        <a-button @click=\"handleSave\">仅保存参数</a-button>\r\n        <a-button type=\"primary\" @click=\"handleOk\">保存并添加</a-button>\r\n      </template>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { getUuid } from '@/utils/index'\r\nimport { ref, h, reactive } from 'vue'\r\nimport { PlusOutlined } from '@ant-design/icons-vue'\r\nimport { getHttpAuthConfig, saveHttpAuthConfig } from '@/api/robot/index'\r\nimport { message } from 'ant-design-vue'\r\nconst open = ref(false)\r\n\r\nconst tableData = ref([])\r\n\r\nconst emit = defineEmits(['ok'])\r\n\r\nconst columns = [\r\n  {\r\n    title: 'Key',\r\n    dataIndex: 'auth_key'\r\n  },\r\n  {\r\n    title: 'Value',\r\n    dataIndex: 'auth_value'\r\n  },\r\n  {\r\n    title: 'Add To',\r\n    dataIndex: 'auth_value_addto'\r\n  },\r\n  {\r\n    title: '备注',\r\n    dataIndex: 'auth_remark'\r\n  },\r\n  {\r\n    title: '操作',\r\n    dataIndex: 'action',\r\n    width: 80\r\n  }\r\n]\r\n\r\nconst state = reactive({\r\n  selectedRowKeys: []\r\n})\r\n\r\nconst onSelectChange = (selectedRowKeys) => {\r\n  console.log('selectedRowKeys changed: ', selectedRowKeys)\r\n  state.selectedRowKeys = selectedRowKeys\r\n}\r\nconst show = () => {\r\n  open.value = true\r\n  state.selectedRowKeys = []\r\n  getConfigList()\r\n}\r\n\r\nconst handleAddKey = () => {\r\n  if (tableData.value.length >= 100) {\r\n    return message.error('最多添加100条')\r\n  }\r\n  tableData.value.push({\r\n    auth_key: '',\r\n    auth_value: '',\r\n    auth_value_addto: 'HEADERS',\r\n    auth_remark: '',\r\n    uni_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst handleDel = (record) => {\r\n  tableData.value = tableData.value.filter((item) => item.uni_key !== record.uni_key)\r\n}\r\n\r\nconst getConfigList = () => {\r\n  getHttpAuthConfig().then((res) => {\r\n    let list = res.data || []\r\n    tableData.value = list.map((item) => {\r\n      return {\r\n        ...item,\r\n        uni_key: getUuid(16)\r\n      }\r\n    })\r\n  })\r\n}\r\nfunction getParmas() {\r\n  let errorIndex = []\r\n  let resultList = []\r\n\r\n  tableData.value.forEach((item, index) => {\r\n    resultList.push({\r\n      auth_key: item.auth_key,\r\n      auth_value: item.auth_value,\r\n      auth_value_addto: item.auth_value_addto,\r\n      auth_remark: item.auth_remark\r\n    })\r\n    if (item.auth_key == '' || item.auth_value == '') {\r\n      errorIndex.push(index + 1)\r\n    }\r\n  })\r\n\r\n  if (errorIndex.length > 0) {\r\n    message.error(`请填写第${errorIndex.join(',')}行参数`)\r\n    return false\r\n  }\r\n  if (resultList.length == 0) {\r\n    message.error('请添加参数')\r\n    return false\r\n  }\r\n\r\n  return resultList\r\n}\r\nconst handleOk = () => {\r\n  let http_auth_config_list = getParmas()\r\n  if (http_auth_config_list == false) {\r\n    return\r\n  }\r\n  let list = []\r\n  state.selectedRowKeys.forEach((uni_key) => {\r\n    list.push(tableData.value.find((it) => it.uni_key == uni_key))\r\n  })\r\n  emit('ok', list)\r\n  saveHttpAuthConfig({\r\n    http_auth_config_list: JSON.stringify(http_auth_config_list)\r\n  })\r\n    .then((res) => {\r\n      message.success('保存成功')\r\n    })\r\n    .finally(() => {\r\n      state.selectedRowKeys = []\r\n      open.value = false\r\n    })\r\n}\r\n\r\nconst handleSave = () => {\r\n  let http_auth_config_list = getParmas()\r\n  if (http_auth_config_list == false) {\r\n    return\r\n  }\r\n  saveHttpAuthConfig({\r\n    http_auth_config_list: JSON.stringify(http_auth_config_list)\r\n  }).then((res) => {\r\n    message.success('保存成功')\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  show\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.mt24 {\r\n  margin-top: 24px;\r\n}\r\n.add-btn-block {\r\n  margin-top: 16px;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.list-box {\r\n  margin-bottom: 24px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconUrl=\"node.node_icon\"\r\n        :desc=\"JSON.parse(node.node_params).curl?.http_tool_info?.http_tool_node_description || ''\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title  export-curl-title\">\r\n            <span> 输入</span>\r\n            <a-button ghost type=\"primary\" size=\"small\" @click=\"showParseModal\">\r\n              <CodeOutlined /> 导入cURL\r\n            </a-button>\r\n            </div>\r\n\r\n            <a-form-item\r\n              label=\"请求地址\"\r\n              name=\"rawurl\"\r\n              :rules=\"[{ required: true, message: '请输入请求地址' }]\"\r\n            >\r\n              <div class=\"flex-block-item\">\r\n                <a-form-item-rest>\r\n                  <a-select v-model:value=\"formState.method\" style=\"width: 120px\">\r\n                    <a-select-option value=\"POST\">POST</a-select-option>\r\n                    <a-select-option value=\"GET\">GET</a-select-option>\r\n                  </a-select>\r\n                </a-form-item-rest>\r\n                <a-input\r\n                  class=\"flex1\"\r\n                  v-model:value=\"formState.rawurl\"\r\n                  placeholder=\"请输入请求地址\"\r\n                ></a-input>\r\n              </div>\r\n            </a-form-item>\r\n\r\n            <div class=\"array-form-box\">\r\n              <div class=\"form-item-label\">HEADERS</div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.headers\" :key=\"index\">\r\n                <a-form-item :label=\"null\" :name=\"['headers', index, 'value']\">\r\n                  <div class=\"flex-block-item\">\r\n                    <a-form-item-rest>\r\n                      <a-input\r\n                        style=\"width: 120px\"\r\n                        v-model:value=\"item.key\"\r\n                        placeholder=\"请输入参数KEY\"\r\n                      ></a-input>\r\n                    </a-form-item-rest>\r\n\r\n                    <div class=\"at-input-flex1\">\r\n                      <at-input\r\n                        inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                        :ref=\"(el) => setAtInputRef(el, 'headers', index)\"\r\n                        :options=\"variableOptions\"\r\n                        :defaultSelectedList=\"item.tags\"\r\n                        :defaultValue=\"item.value\"\r\n                        @open=\"getVlaueVariableList\"\r\n                        @change=\"\r\n                          (text, selectedList) =>\r\n                            changeValue('headers', text, selectedList, item, index)\r\n                        \"\r\n                        placeholder=\"请输入变量值，键入“/”插入变量\"\r\n                      >\r\n                        <template #option=\"{ label, payload }\">\r\n                          <div class=\"field-list-item\">\r\n                            <div class=\"field-label\">{{ label }}</div>\r\n                            <div class=\"field-type\">{{ payload.typ }}</div>\r\n                          </div>\r\n                        </template>\r\n                      </at-input>\r\n                    </div>\r\n\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelHeader(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddHeader\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >添加参数</a-button\r\n              >\r\n            </div>\r\n            <div class=\"array-form-box\">\r\n              <div class=\"form-item-label\">PARAMS</div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.params\" :key=\"index\">\r\n                <a-form-item :label=\"null\" :name=\"['params', index, 'value']\">\r\n                  <div class=\"flex-block-item\">\r\n                    <a-form-item-rest>\r\n                      <a-input\r\n                        style=\"width: 120px\"\r\n                        v-model:value=\"item.key\"\r\n                        placeholder=\"请输入参数KEY\"\r\n                      ></a-input>\r\n                    </a-form-item-rest>\r\n                    <div class=\"at-input-flex1\">\r\n                      <at-input\r\n                        inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                        :ref=\"(el) => setAtInputRef(el, 'params', index)\"\r\n                        :options=\"variableOptions\"\r\n                        :defaultSelectedList=\"item.tags\"\r\n                        :defaultValue=\"item.value\"\r\n                        @open=\"getVlaueVariableList\"\r\n                        @change=\"\r\n                          (text, selectedList) =>\r\n                            changeValue('params', text, selectedList, item, index)\r\n                        \"\r\n                        placeholder=\"请输入变量值，键入“/”插入变量\"\r\n                      >\r\n                        <template #option=\"{ label, payload }\">\r\n                          <div class=\"field-list-item\">\r\n                            <div class=\"field-label\">{{ label }}</div>\r\n                            <div class=\"field-type\">{{ payload.typ }}</div>\r\n                          </div>\r\n                        </template>\r\n                      </at-input>\r\n                    </div>\r\n\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelParams(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddParams\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >添加参数</a-button\r\n              >\r\n            </div>\r\n\r\n            <div v-if=\"formState.method == 'POST'\">\r\n              <a-form-item label=\"BODY\" name=\"type\" class=\"line-height-22\">\r\n                <a-radio-group v-model:value=\"formState.type\">\r\n                  <a-radio :value=\"0\">none</a-radio>\r\n                  <a-radio :value=\"1\">x-www-form-urlencoded</a-radio>\r\n                  <a-radio :value=\"2\">JSON</a-radio>\r\n                </a-radio-group>\r\n              </a-form-item>\r\n              <div class=\"array-form-box\" v-if=\"formState.type == 1\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.body\" :key=\"index\">\r\n                  <a-form-item\r\n                    :label=\"null\"\r\n                    :name=\"['body', index, 'value']\"\r\n                    :rules=\"{\r\n                      required: true\r\n                    }\"\r\n                  >\r\n                    <div class=\"flex-block-item\">\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 120px\"\r\n                          v-model:value=\"item.key\"\r\n                          placeholder=\"请输入参数KEY\"\r\n                        ></a-input>\r\n                      </a-form-item-rest>\r\n                      <div class=\"at-input-flex1\">\r\n                        <at-input\r\n                          inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                          :ref=\"(el) => setAtInputRef(el, 'body', index)\"\r\n                          :options=\"variableOptions\"\r\n                          :defaultSelectedList=\"item.tags\"\r\n                          :defaultValue=\"item.value\"\r\n                          @open=\"getVlaueVariableList\"\r\n                          @change=\"\r\n                            (text, selectedList) =>\r\n                              changeValue('body', text, selectedList, item, index)\r\n                          \"\r\n                          placeholder=\"请输入变量值，键入“/”插入变量\"\r\n                        >\r\n                          <template #option=\"{ label, payload }\">\r\n                            <div class=\"field-list-item\">\r\n                              <div class=\"field-label\">{{ label }}</div>\r\n                              <div class=\"field-type\">{{ payload.typ }}</div>\r\n                            </div>\r\n                          </template>\r\n                        </at-input>\r\n                      </div>\r\n\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelBody(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleAddBody\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >添加参数</a-button\r\n                >\r\n              </div>\r\n              <a-form-item :label=\"null\" name=\"body_raw\" v-if=\"formState.type == 2\">\r\n                <at-input\r\n                  type=\"textarea\"\r\n                  :options=\"variableOptions\"\r\n                  :defaultSelectedList=\"formState.body_raw_tags\"\r\n                  :defaultValue=\"formState.body_raw\"\r\n                  :ref=\"(el) => setAtInputRef(el, 'body', 'body_raw')\"\r\n                  @open=\"getVlaueVariableList\"\r\n                  @change=\"(text, selectedList) => changeValue('body_raw', text, selectedList)\"\r\n                  placeholder=\"请输入变量值，键入“/”插入变量\"\r\n                >\r\n                  <template #option=\"{ label, payload }\">\r\n                    <div class=\"field-list-item\">\r\n                      <div class=\"field-label\">{{ label }}</div>\r\n                      <div class=\"field-type\">{{ payload.typ }}</div>\r\n                    </div>\r\n                  </template>\r\n                </at-input>\r\n              </a-form-item>\r\n            </div>\r\n\r\n            <a-form-item name=\"timeout\">\r\n              <template #label>\r\n                <a-flex :gap=\"2\">超时时长</a-flex>\r\n              </template>\r\n              <div class=\"flex-block-item\">\r\n                <a-input-number\r\n                  placeholder=\"请输入请求地址\"\r\n                  style=\"width: 120px\"\r\n                  :precision=\"0\"\r\n                  v-model:value=\"formState.timeout\"\r\n                  :min=\"0\"\r\n                  :max=\"3000\"\r\n                />\r\n                秒\r\n              </div>\r\n            </a-form-item>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">鉴权\r\n              <a-tooltip>\r\n                <template #title>鉴权参数：导出模板CSL文件，或者上架模板时，自动清空参数值</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\" style=\"width: 124px\">Key</div>\r\n                <div class=\"output-item\" style=\"width: 124px\">Value</div>\r\n                <div class=\"output-item\" style=\"width: 124px\">Add To</div>\r\n              </div>\r\n              <div class=\"array-form-box\" @mousedown.stop=\"\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.http_auth\" :key=\"index\">\r\n                  <a-form-item :label=\"null\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 124px\"\r\n                        v-model:value=\"item.key\"\r\n                        placeholder=\"请输入\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 124px\"\r\n                          v-model:value=\"item.value\"\r\n                          placeholder=\"请输入\"\r\n                        ></a-input>\r\n                        <a-select v-model:value=\"item.add_to\" style=\"width: 124px\">\r\n                          <a-select-option value=\"HEADERS\">HEADERS</a-select-option>\r\n                          <a-select-option value=\"PARAMS\">PARAMS</a-select-option>\r\n                          <a-select-option value=\"BODY\">BODY</a-select-option>\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n                      <div class=\"btn-hover-wrap\" @click=\"handleDelAuthentication(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleOpenAuthenticationModal\" :icon=\"h(PlusOutlined)\" block type=\"dashed\">添加参数</a-button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\" @click=\"test\">输出 (输出字段提取)</div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">参数Key</div>\r\n                <div class=\"output-item\">类型</div>\r\n              </div>\r\n              <div class=\"array-form-box\" @mousedown.stop=\"\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n                  <a-form-item :label=\"null\" :name=\"['output', index, 'key']\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 214px\"\r\n                        v-model:value=\"item.key\"\r\n                        placeholder=\"请输入\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-select\r\n                          @change=\"onTypeChange(item)\"\r\n                          v-model:value=\"item.typ\"\r\n                          placeholder=\"请选择\"\r\n                          style=\"width: 214px\"\r\n                        >\r\n                          <a-select-option v-for=\"op in typOptions\" :value=\"op.value\" :key=\"op.value\">{{\r\n                            op.value\r\n                          }}</a-select-option>\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n\r\n                      <div\r\n                        class=\"btn-hover-wrap\"\r\n                        v-if=\"item.typ == 'object'\"\r\n                        @click=\"onAddSubs(index)\"\r\n                      >\r\n                        <PlusCircleOutlined />\r\n                      </div>\r\n\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                      <a-form-item-rest>\r\n                        <SubKey :data=\"item.subs\" :level=\"2\" :typOptions=\"typOptions\" />\r\n                      </a-form-item-rest>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleAddOutPut\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >添加参数</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n    <ParseCurlModal \r\n      ref=\"parseCurlModalRef\" \r\n      @parse=\"handleParseResult\" \r\n    />\r\n    <AddAuthenticationModal @ok=\"handleSaveAuthentication\" ref=\"addAuthenticationModalRef\" />\r\n  </NodeFormLayout>\r\n  \r\n</template>\r\n\r\n<script setup>\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, h, onMounted } from 'vue'\r\nimport { CloseCircleOutlined, PlusOutlined, PlusCircleOutlined, CodeOutlined, QuestionCircleOutlined } from '@ant-design/icons-vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport SubKey from './subs-key.vue'\r\nimport ParseCurlModal from './parse-curl-modal.vue'\r\nimport { getUuid } from '@/utils/index'\r\nimport AddAuthenticationModal from './add-authentication-modal.vue'\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst atInputRefs = reactive({})\r\nconst setAtInputRef = (el, name, index) => {\r\n  if (el) {\r\n    let key = `at_input_${name}_${index}`\r\n    atInputRefs[key] = el\r\n  }\r\n}\r\n\r\nconst changeValue = (type, text, selectedList, item) => {\r\n  if (type == 'body_raw') {\r\n    formState.body_raw = text\r\n    formState.body_raw_tags = selectedList\r\n  } else {\r\n    item.tags = selectedList\r\n    item.value = text\r\n  }\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n    list.forEach((item) => {\r\n      item.tags = item.tags || []\r\n    })\r\n\r\n    variableOptions.value = list\r\n  }\r\n}\r\n\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  method: 'POST',\r\n  rawurl: '',\r\n  headers: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  params: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  type: 1,\r\n  body: [],\r\n  body_raw: '',\r\n  body_raw_tags: [],\r\n  timeout: 30,\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      subs: []\r\n    }\r\n  ],\r\n  http_auth:[],\r\n})\r\n\r\nconst parseCurlModalRef = ref()\r\nconst toolInfoRef = ref({})\r\n\r\nconst showParseModal = () => {\r\n  parseCurlModalRef.value.show()\r\n}\r\n\r\nconst handleParseResult = (parsedData) => {\r\n  // 将解析结果填充到表单\r\n  let headers = [{\r\n    key: '',\r\n    value: ''\r\n  }]\r\n  let params = [{\r\n    key: '',\r\n    value: ''\r\n  }]\r\n  let body = []\r\n  let body_raw = ''\r\n  let isJson = false\r\n\r\n  formState.method = parsedData.method\r\n  formState.rawurl = parsedData.url\r\n  // 处理value\r\n  function handleValue(value) {\r\n    if (typeof value == 'string') {\r\n      return value\r\n    }\r\n    return JSON.stringify(value)\r\n  }\r\n\r\n  if(parsedData.header && typeof parsedData.header == 'object') {\r\n    headers = Object.keys(parsedData.header).map((key) => {\r\n      if(key.toLowerCase() == 'content-type' && parsedData.header[key].indexOf('application/json') !== -1) {\r\n        isJson = true\r\n      }\r\n\r\n      return {\r\n        key: key,\r\n        value: handleValue(parsedData.header[key]),\r\n        cu_key: getUuid(16)\r\n      }\r\n    })\r\n\r\n    headers = headers.filter(item => item.key.toLowerCase() !== 'content-type')\r\n  }\r\n  \r\n  if(parsedData.data && typeof parsedData.data == 'object') {\r\n    body = Object.keys(parsedData.data).map((key) => {\r\n      return {\r\n        key: key,\r\n        value: handleValue(parsedData.data[key]),\r\n        cu_key: getUuid(16)\r\n      }\r\n    })\r\n\r\n    body_raw = JSON.stringify(parsedData.data)\r\n  }\r\n\r\n  if(parsedData.params && typeof parsedData.params == 'object') {\r\n    params = Object.keys(parsedData.params).map((key) => {\r\n      return {\r\n        key: key,\r\n        value: handleValue(parsedData.params[key]),\r\n        cu_key: getUuid(16)\r\n      }\r\n    })\r\n  }\r\n\r\n  if(isJson) {\r\n    formState.type = 2\r\n    formState.body_raw = body_raw\r\n  }else {\r\n    formState.type = 1\r\n    formState.body = body\r\n  }\r\n\r\n  formState.headers = headers\r\n  formState.params = params\r\n\r\n  parseCurlModalRef.value && parseCurlModalRef.value.hide()\r\n}\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = getUuid(16)\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nconst update = () => {\r\n  const curlData = { ...formState }\r\n  if (!Array.isArray(curlData.http_auth) || curlData.http_auth.length === 0) {\r\n    delete curlData.http_auth\r\n  }\r\n  const toolInfo = toolInfoRef.value || {}\r\n  if (toolInfo && Object.keys(toolInfo).length > 0) {\r\n    curlData.http_tool_info = toolInfo\r\n  }\r\n  const data = JSON.stringify({ curl: curlData })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let curl = JSON.parse(dataRaw).curl || {}\r\n\r\n    curl = JSON.parse(JSON.stringify(curl))\r\n    toolInfoRef.value = curl.http_tool_info || {}\r\n\r\n    getVlaueVariableList()\r\n\r\n    for (let key in curl) {\r\n      if (key == 'headers' || key == 'params' || key == 'body') {\r\n        if (curl[key] && curl[key].length > 0) {\r\n          formState[key] = curl[key].map((item) => {\r\n            return {\r\n              ...item,\r\n              cu_key: getUuid(16)\r\n            }\r\n          })\r\n        } else {\r\n          formState[key] = []\r\n        }\r\n        continue\r\n      }\r\n      if (key == 'output') {\r\n        formState['output'] = recursionData(curl[key])\r\n        continue\r\n      }\r\n      formState[key] = curl[key]\r\n    }\r\n    formState.http_auth = curl.http_auth || []\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddHeader = () => {\r\n  formState.headers.push({\r\n    key: '',\r\n    value: '',\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelHeader = (index) => {\r\n  formState.headers.splice(index, 1)\r\n}\r\n\r\nconst handleAddParams = () => {\r\n  formState.params.push({\r\n    key: '',\r\n    value: '',\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelParams = (index) => {\r\n  formState.params.splice(index, 1)\r\n}\r\n\r\nconst handleAddBody = () => {\r\n  formState.body.push({\r\n    key: '',\r\n    value: '',\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelBody = (index) => {\r\n  formState.body.splice(index, 1)\r\n}\r\n\r\nconst handleAddOutPut = () => {\r\n  formState.output.push({\r\n    key: '',\r\n    typ: 'string',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  formState.output[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\n\r\nconst addAuthenticationModalRef = ref(null)\r\nconst handleOpenAuthenticationModal = () => {\r\n  addAuthenticationModalRef.value.show()\r\n}\r\n\r\nconst handleSaveAuthentication = (list) => {\r\n  let data = list.map(item => {\r\n    return {\r\n      key: item.auth_key,\r\n      value: item.auth_value,\r\n      add_to: item.auth_value_addto\r\n    }\r\n  })\r\n  formState.http_auth = [...formState.http_auth, ...data]\r\n}\r\n\r\nconst handleDelAuthentication = (index) => {\r\n  formState.http_auth.splice(index, 1)\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.export-curl-title{\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.at-input-flex1 {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n","import { useI18n } from '@/hooks/web/useI18n'\r\n\r\n// 基础过滤规则定义\r\nconst FILTER_RULES = {\r\n  // 相等性规则\r\n  EQUALITY: {\r\n    EQ: { key: 'label_equal', value: 'eq' },\r\n    NEQ: { key: 'label_not_equal', value: 'neq' },\r\n    IS: { key: 'label_is', value: 'eq' },\r\n    IS_NOT: { key: 'label_is_not', value: 'neq' }\r\n  },\r\n\r\n  // 比较规则\r\n  COMPARISON: {\r\n    GT: { key: 'label_greater_than', value: 'gt' },\r\n    LT: { key: 'label_less_than', value: 'lt' },\r\n    GTE: { key: 'label_greater_than_or_equal', value: 'gte' },\r\n    LTE: { key: 'label_less_than_or_equal', value: 'lte' },\r\n    BETWEEN: { key: 'label_between', value: 'between' }\r\n  },\r\n\r\n  // 文本规则\r\n  TEXT: {\r\n    CONTAIN: { key: 'label_contain', value: 'contain' },\r\n    NOT_CONTAIN: { key: 'label_not_contain', value: 'not_contain' }\r\n  },\r\n\r\n  // 空值规则\r\n  NULLABILITY: {\r\n    EMPTY: { key: 'label_empty', value: 'empty' },\r\n    NOT_EMPTY: { key: 'label_not_empty', value: 'not_empty' }\r\n  },\r\n\r\n  // 布尔规则\r\n  BOOLEAN: {\r\n    TRUE: { key: 'label_is', value: 'true' },\r\n    FALSE: { key: 'label_is_not', value: 'false' }\r\n  }\r\n}\r\n\r\n// 获取带翻译的过滤规则\r\nexport const getFilterRules = () => {\r\n  const { t } = useI18n('constants.database')\r\n  return {\r\n    EQUALITY: {\r\n      EQ: { label: t('label_equal'), value: 'eq' },\r\n      NEQ: { label: t('label_not_equal'), value: 'neq' },\r\n      IS: { label: t('label_is'), value: 'eq' },\r\n      IS_NOT: { label: t('label_is_not'), value: 'neq' }\r\n    },\r\n    COMPARISON: {\r\n      GT: { label: t('label_greater_than'), value: 'gt' },\r\n      LT: { label: t('label_less_than'), value: 'lt' },\r\n      GTE: { label: t('label_greater_than_or_equal'), value: 'gte' },\r\n      LTE: { label: t('label_less_than_or_equal'), value: 'lte' },\r\n      BETWEEN: { label: t('label_between'), value: 'between' }\r\n    },\r\n    TEXT: {\r\n      CONTAIN: { label: t('label_contain'), value: 'contain' },\r\n      NOT_CONTAIN: { label: t('label_not_contain'), value: 'not_contain' }\r\n    },\r\n    NULLABILITY: {\r\n      EMPTY: { label: t('label_empty'), value: 'empty' },\r\n      NOT_EMPTY: { label: t('label_not_empty'), value: 'not_empty' }\r\n    },\r\n    BOOLEAN: {\r\n      TRUE: { label: t('label_is'), value: 'true' },\r\n      FALSE: { label: t('label_is_not'), value: 'false' }\r\n    }\r\n  }\r\n}\r\n\r\nexport const filterRules = getFilterRules()\r\n\r\n// 字段类型与规则映射\r\nexport const getFieldTypeRules = () => {\r\n  const rules = getFilterRules()\r\n\r\n  return {\r\n    string: [\r\n      rules.EQUALITY.IS,\r\n      rules.EQUALITY.IS_NOT,\r\n      rules.TEXT.CONTAIN,\r\n      rules.TEXT.NOT_CONTAIN,\r\n      rules.NULLABILITY.EMPTY,\r\n      rules.NULLABILITY.NOT_EMPTY\r\n    ],\r\n\r\n    integer: [\r\n      rules.COMPARISON.GT,\r\n      rules.COMPARISON.LT,\r\n      rules.COMPARISON.GTE,\r\n      rules.COMPARISON.LTE,\r\n      rules.EQUALITY.EQ,\r\n      rules.COMPARISON.BETWEEN\r\n    ],\r\n\r\n    number: [\r\n      rules.COMPARISON.GT,\r\n      rules.COMPARISON.LT,\r\n      rules.COMPARISON.GTE,\r\n      rules.COMPARISON.LTE,\r\n      rules.EQUALITY.EQ,\r\n      rules.COMPARISON.BETWEEN\r\n    ],\r\n\r\n    boolean: [\r\n      rules.BOOLEAN.TRUE,\r\n      rules.BOOLEAN.FALSE\r\n    ]\r\n  }\r\n}\r\n\r\nexport const fieldTypeRules = getFieldTypeRules()\r\n\r\n// 导出基础规则常量，便于其他模块使用\r\nexport { FILTER_RULES }\r\n\r\n// 工具函数：根据字段类型获取可用规则\r\nexport const getFilterRulesByType = (fieldType) => {\r\n  const rules = getFieldTypeRules()\r\n  return rules[fieldType] || []\r\n}\r\n\r\n// 工具函数：根据规则值获取规则标签\r\nexport const getFilterRuleLabel = (ruleValue, fieldType) => {\r\n  const rules = getFilterRulesByType(fieldType)\r\n  const rule = rules.find(r => r.value === ruleValue)\r\n  return rule?.label || ruleValue\r\n}","<template>\r\n  <div class=\"query-condition-filter-warpper\" :class=\"{ 'is-multiple': isMultiple }\">\r\n    <div class=\"query-condition-filter\">\r\n      <div class=\"auxiliary-line\"></div>\r\n      <div class=\"condition-select-box\">\r\n        <div class=\"select-wrapper\">\r\n          <a-dropdown>\r\n            <a class=\"ant-dropdown-link\" @click.prevent>\r\n              {{ state.type == 1 ? t('label_and') : t('label_or') }}\r\n              <DownOutlined />\r\n            </a>\r\n            <template #overlay>\r\n              <a-menu style=\"width: 100px\" @click=\"changeType\">\r\n                <a-menu-item :key=\"1\">\r\n                  <a href=\"javascript:;\">{{ t('label_and') }}</a>\r\n                </a-menu-item>\r\n                <a-menu-item :key=\"2\">\r\n                  <a href=\"javascript:;\">{{ t('label_or') }}</a>\r\n                </a-menu-item>\r\n              </a-menu>\r\n            </template>\r\n          </a-dropdown>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"field-items\">\r\n        <div class=\"field-item\" v-for=\"(row, index) in state.list\" :key=\"row.field\">\r\n          <div class=\"field-select-box\">\r\n            <!-- 绑定字段 -->\r\n            <a-select\r\n              style=\"width: 100px\"\r\n              v-model:value=\"row.form_field_id\"\r\n              @change=\"(value, option) => selectField(index, option)\"\r\n            >\r\n              <a-select-option :value=\"0\" type=\"integer\" name=\"ID\" key=\"id\">ID</a-select-option>\r\n              <a-select-option\r\n                :value=\"item.id\"\r\n                :type=\"item.type\"\r\n                :name=\"item.name\"\r\n                :key=\"item.id\"\r\n                v-for=\"item in props.fieldOptions\"\r\n              >\r\n                {{ item.name }}\r\n              </a-select-option>\r\n            </a-select>\r\n          </div>\r\n          <div class=\"operator-select-box\">\r\n            <!-- 绑定条件 -->\r\n            <a-select\r\n              v-model:value=\"row.rule\"\r\n              style=\"width: 150px\"\r\n              @change=\"(value, option) => selectRule(index, option)\"\r\n            >\r\n              <a-select-option\r\n                :value=\"item.value\"\r\n                style=\"width: 220px;\"\r\n                v-for=\"item in operatorOptionsMap[row.field_type]\"\r\n                :key=\"item.value\"\r\n                >{{ item.label }}</a-select-option\r\n              >\r\n            </a-select>\r\n          </div>\r\n          <div class=\"field-value-box\">\r\n            <!-- 绑定条件值 -->\r\n            <!-- 介于范围输入 -->\r\n            <div class=\"site-input-group-wrapper\" v-if=\"row.rule === 'between'\">\r\n              <div class=\"site-input-left\"  :title=\"t('ph_input_number_variable')\">\r\n                <AtInput\r\n                  :options=\"atInputOptions\"\r\n                  :defaultValue=\"row.rule_value1\"\r\n                  :defaultSelectedList=\"row.atTags\"\r\n                  @open=\"showAtList\"\r\n                  @change=\"\r\n                    (text, selectedList) => changeAtInputValue(text, selectedList, row, index)\r\n                  \"\r\n                  :placeholder=\"t('ph_input_number')\"\r\n                />\r\n              </div>\r\n\r\n              <span class=\"site-input-split\">~</span>\r\n              <div class=\"site-input-right\" :title=\"t('ph_input_number_variable')\">\r\n                <AtInput\r\n                  :options=\"atInputOptions\"\r\n                  :defaultValue=\"row.rule_value2\"\r\n                  :defaultSelectedList=\"row.atTags2\"\r\n                  @open=\"showAtList\"\r\n                  @change=\"\r\n                    (text, selectedList) => changeAtInputValue2(text, selectedList, row, index)\r\n                  \"\r\n                  :placeholder=\"t('ph_input_number')\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <!-- 布尔类型选择 -->\r\n            <!-- <a-select\r\n              v-else-if=\"row.field_type === 'boolean'\"\r\n              :value=\"row.rule_value1\"\r\n              @change=\"value => updateRuleValue(index, 'rule_value1', value)\"\r\n              style=\"width: 100%\"\r\n              :placeholder=\"t('ph_select')\"\r\n            >\r\n              <a-select-option value=\"true\">是/真</a-select-option>\r\n              <a-select-option value=\"false\">否/假</a-select-option>\r\n            </a-select> -->\r\n\r\n            <!-- 空值检查、布尔类型（无需输入） -->\r\n            <a-input\r\n              v-else-if=\"['empty', 'not_empty', 'boolean'].includes(row.field_type)\"\r\n              :placeholder=\"t('ph_no_value_required')\"\r\n              disabled\r\n            />\r\n\r\n            <!-- 数字类型输入 -->\r\n            <!-- <a-input\r\n              v-else-if=\"['integer', 'number'].includes(row.field_type)\"\r\n              :value=\"row.rule_value1\"\r\n              @input=\"e => updateRuleValueByNumber(index, 'rule_value1', e)\"\r\n              style=\"width: 100%\"\r\n              :placeholder=\"t('ph_input_number')\"\r\n            /> -->\r\n\r\n            <AtInput\r\n              v-else-if=\"['integer', 'number'].includes(row.field_type)\"\r\n              :options=\"atInputOptions\"\r\n              :defaultValue=\"row.rule_value1\"\r\n              :defaultSelectedList=\"row.atTags\"\r\n              @open=\"showAtList\"\r\n              @change=\"(text, selectedList) => changeAtInputValue(text, selectedList, row, index)\"\r\n              :placeholder=\"t('ph_input_number_variable')\"\r\n            />\r\n\r\n            <!-- 文本类型输入 -->\r\n            <AtInput\r\n              v-else\r\n              :options=\"atInputOptions\"\r\n              :defaultValue=\"row.rule_value1\"\r\n              :defaultSelectedList=\"row.atTags\"\r\n              @open=\"showAtList\"\r\n              @change=\"(text, selectedList) => changeAtInputValue(text, selectedList, row, index)\"\r\n              :placeholder=\"t('ph_input_value_variable')\"\r\n            />\r\n            <!-- <a-input\r\n              v-else\r\n              :value=\"row.rule_value1\"\r\n              @input=\"e => updateRuleValue(index, 'rule_value1', e)\"\r\n              :placeholder=\"请输入文本内容\"\r\n            /> -->\r\n          </div>\r\n          <span class=\"field-del-btn\" @click=\"removeCondition(index)\">\r\n            <svg-icon class=\"del-icon\" name=\"close-circle\"></svg-icon>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"add-btn-box\">\r\n      <a-tooltip :title=\"t('ph_select_database_first')\" style=\"width: 100%\" v-if=\"disabled\">\r\n        <span>\r\n          <a-button class=\"add-btn\" type=\"dashed\" disabled block>\r\n            <PlusOutlined /> {{ t('btn_add_condition') }}\r\n          </a-button>\r\n        </span>\r\n      </a-tooltip>\r\n\r\n      <a-button class=\"add-btn\" type=\"dashed\" block @click=\"addCondition\" v-else>\r\n        <PlusOutlined /> {{ t('btn_add_condition') }}\r\n      </a-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, inject, ref, watch, reactive, onMounted } from 'vue'\r\nimport { PlusOutlined, DownOutlined } from '@ant-design/icons-vue'\r\nimport { getFieldTypeRules, getFilterRulesByType } from '@/constants/database'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.query-condition-filter')\r\n\r\nconst emit = defineEmits(['change', 'changeType'])\r\n\r\nconst props = defineProps({\r\n  where: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  fieldOptions: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  disabled: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  type: {\r\n    type: [Number, String],\r\n    default: 1\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst state = reactive({\r\n  list: props.where,\r\n  type: props.type\r\n})\r\n\r\nwatch(\r\n  () => props.where,\r\n  (newVal) => {\r\n    state.list = newVal\r\n  }\r\n)\r\n\r\nwatch(\r\n  () => props.type,\r\n  (newVal) => {\r\n    state.type = newVal\r\n  }\r\n)\r\n\r\nconst isMultiple = computed(() => {\r\n  return props.where.length > 1\r\n})\r\n\r\n// 动态获取操作符选项的计算属性\r\nconst operatorOptionsMap = computed(() => {\r\n  return getFieldTypeRules()\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable();\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst showAtList = () => {\r\n  getAtInputOptions()\r\n}\r\n\r\nconst change = () => {\r\n  let data = {\r\n    type: state.type,\r\n    list: state.list\r\n  }\r\n\r\n  emit('change', data)\r\n}\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nconst updateRuleValue = (index, key, e) => {\r\n  let value = e.target.value\r\n\r\n  state.list[index][key] = value\r\n  change()\r\n}\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nconst updateRuleValueByNumber = (index, key, e) => {\r\n  let value = e.target.value\r\n  // 格式化数据，允许输入数字、小数点和负号\r\n  // 只保留数字、小数点和负号，其他字符都删除\r\n  value = value.replace(/[^\\d.-]/g, '')\r\n\r\n  // 确保负号只能出现在开头\r\n  if (value.indexOf('-') > 0) {\r\n    value = value.replace(/-/g, '')\r\n  }\r\n\r\n  // 确保只有一个小数点\r\n  const parts = value.split('.')\r\n  if (parts.length > 2) {\r\n    value = parts[0] + '.' + parts.slice(1).join('')\r\n  }\r\n\r\n  // 确保负号在最前面\r\n  if (value.includes('-') && !value.startsWith('-')) {\r\n    value = '-' + value.replace(/-/g, '')\r\n  }\r\n\r\n  state.list[index][key] = value\r\n  change()\r\n}\r\n\r\nconst changeAtInputValue = (text, selectedList, item, index) => {\r\n  // item.value = text\r\n  state.list[index].rule_value1 = text\r\n  state.list[index].atTags = selectedList\r\n\r\n  change()\r\n}\r\n\r\nconst changeAtInputValue2 = (text, selectedList, item, index) => {\r\n  // item.value = text\r\n  state.list[index].rule_value2 = text\r\n  state.list[index].atTags2 = selectedList\r\n\r\n  change()\r\n}\r\n\r\nconst addCondition = () => {\r\n  let rowData = {\r\n    form_field_id: '',\r\n    field_name: '',\r\n    field_type: '',\r\n    rule: '',\r\n    rule_value1: '',\r\n    rule_value2: '',\r\n    atTags: [],\r\n    atTags2: []\r\n  }\r\n\r\n  state.list.push(rowData)\r\n\r\n  change()\r\n}\r\n\r\nconst removeCondition = (index) => {\r\n  state.list.splice(index, 1)\r\n  change()\r\n}\r\n\r\nconst selectField = (index, option) => {\r\n  let ruleRows = getFilterRulesByType(option.type)\r\n\r\n  let data = {\r\n    form_field_id: option.value,\r\n    field_name: option.name,\r\n    field_type: option.type,\r\n    rule: ruleRows[0].value,\r\n    rule_value1: '',\r\n    rule_value2: '',\r\n    atTags: [],\r\n    atTags2: []\r\n  }\r\n\r\n  state.list[index] = data\r\n\r\n  change()\r\n}\r\n\r\nconst selectRule = (index, option) => {\r\n  let data = state.list[index]\r\n  data.rule = option.value\r\n  data.rule_value1 = ''\r\n  data.rule_value2 = ''\r\n  data.atTags = []\r\n  data.atTags2 = []\r\n\r\n  change()\r\n}\r\n\r\nconst changeType = ({ key }) => {\r\n  state.type = key\r\n\r\n  emit('changeType', key)\r\n  change()\r\n}\r\n\r\nonMounted(() => {\r\n  getAtInputOptions()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.query-condition-filter-warpper {\r\n  position: relative;\r\n  .query-condition-filter {\r\n    display: flex;\r\n    position: relative;\r\n    width: 100%;\r\n\r\n    .condition-select-box {\r\n      display: none;\r\n      position: absolute;\r\n      left: 0;\r\n      top: 50%;\r\n      transform: translateY(-50%) translateX(-50%);\r\n      background: #f2f4f7;\r\n      z-index: 10;\r\n    }\r\n    .auxiliary-line {\r\n      display: none;\r\n      position: absolute;\r\n      left: 0;\r\n      top: 15px;\r\n      bottom: 15px;\r\n      width: 48px;\r\n      border-radius: 8px;\r\n      border: 1px solid #bfbfbf;\r\n      border-right: 0;\r\n      border-top-right-radius: 0;\r\n      border-bottom-right-radius: 0;\r\n    }\r\n  }\r\n\r\n  &.is-multiple {\r\n    padding-left: 22px;\r\n    .query-condition-filter {\r\n      padding-left: 32px;\r\n    }\r\n    .auxiliary-line {\r\n      display: block;\r\n    }\r\n    .condition-select-box {\r\n      display: block;\r\n    }\r\n    .add-btn-box {\r\n      padding-left: 32px;\r\n    }\r\n  }\r\n\r\n  .field-items {\r\n    flex: 1;\r\n    .field-item {\r\n      display: flex;\r\n      align-items: center;\r\n      flex-wrap: nowrap;\r\n      margin-bottom: 8px;\r\n\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-select-box,\r\n    .operator-select-box {\r\n      flex: 1;\r\n      margin-right: 8px;\r\n    }\r\n    .field-value-box {\r\n      width: 178px;\r\n      overflow: hidden;\r\n    }\r\n    .field-del-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 24px;\r\n      height: 24px;\r\n      margin-left: 8px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  .add-btn-box {\r\n    margin-top: 8px;\r\n    .add-btn {\r\n      width: 100%;\r\n    }\r\n  }\r\n\r\n  .site-input-group-wrapper {\r\n    display: flex;\r\n\r\n    .site-input-split {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 30px;\r\n      border-bottom: 1px solid #d9d9d9;\r\n      border-top: 1px solid #d9d9d9;\r\n      pointer-events: none;\r\n      background-color: #fff;\r\n    }\r\n\r\n    .site-input-left,\r\n    .site-input-right {\r\n      flex: 1;\r\n      text-align: center;\r\n      overflow: hidden;\r\n    }\r\n\r\n    .site-input-left :deep(.mention-input-warpper) {\r\n      border-top-right-radius: 0;\r\n      border-bottom-right-radius: 0;\r\n    }\r\n\r\n    .site-input-right :deep(.mention-input-warpper) {\r\n      border-top-left-radius: 0;\r\n      border-bottom-left-radius: 0;\r\n    }\r\n  }\r\n}\r\n</style>","<style lang=\"less\" scoped>\r\n.delete-data-form {\r\n  .node-box-content {\r\n    margin-top: 16px;\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n\r\n  .node-box-title {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 48px;\r\n    padding: 0 12px;\r\n\r\n    .input-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .text {\r\n      font-weight: 600;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    padding: 0 12px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n\r\n  .setting-box {\r\n    padding: 0 12px;\r\n    margin-bottom: 12px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n       <NodeFormHeader :title=\"node.node_name\" :iconName=\"node.node_icon_name\">\r\n        <template #desc>\r\n          <span\r\n            >{{ t('title_desc_delete_data') }}\r\n            <a target=\"_blank\" href=\"/#/database/list\">{{ t('btn_go_manage') }}</a></span\r\n          >\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"delete-data-form\">\r\n      <div class=\"node-box-content\">\r\n        <div class=\"node-box-title\">\r\n          <img class=\"input-icon\" src=\"@/assets/img/workflow/input.svg\" alt=\"\" />\r\n          <span class=\"text\">{{ t('label_input') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-label\">\r\n          <span>{{ t('label_data_table') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-box\">\r\n          <DataTableSelect\r\n            :options=\"state.tableList\"\r\n            :title=\"state.formData.form_name\"\r\n            :description=\"state.formData.form_description\"\r\n            v-model:value=\"state.formData.form_id\"\r\n            @change=\"onSelectTable\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"setting-label\">\r\n          <span>{{ t('label_delete_condition') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-box\">\r\n          <QueryConditionFilter\r\n            :disabled=\"!state.formData.form_id\"\r\n            :where=\"state.formData.where\"\r\n            :field-options=\"state.fieldList\"\r\n            :type=\"state.formData.typ\"\r\n            @change=\"onConditionChagne\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, inject, toRaw, onMounted } from 'vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport DataTableSelect from '../data-table/database-selector/index.vue'\r\nimport QueryConditionFilter from '../data-table/query-condition-filter.vue'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.delete-data-form')\r\n\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeType: {\r\n    type: String\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst dataTableStore = useDataTableStore()\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    typ: 1,\r\n    where: []\r\n  },\r\n  fieldList: []\r\n})\r\n\r\nconst onConditionChagne = ({ type, list }) => {\r\n  state.formData.typ = type\r\n  state.formData.where = list\r\n\r\n  update()\r\n}\r\n\r\nconst onSelectTable = (value, record) => {\r\n  if (record) {\r\n    state.formData.form_name = record.name\r\n    state.formData.form_description = record.description\r\n    // state.formData.form_id = record.id\r\n    getFieldList(record.id)\r\n  } else {\r\n    state.formData.form_name = ''\r\n    state.formData.form_description = ''\r\n    // state.formData.form_id = ''\r\n    state.formData.where = []\r\n  }\r\n\r\n  update()\r\n}\r\n\r\nconst init = () => {\r\n  let dataRaw = props.node.dataRaw || '{}'\r\n\r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  let where = whereDataConditions(node_params.form_delete.where || [])\r\n\r\n  node_params.form_delete.where = where\r\n\r\n  state.formData = node_params.form_delete\r\n\r\n  if (state.formData.form_id) {\r\n    getFieldList(state.formData.form_id)\r\n  }\r\n\r\n  update()\r\n}\r\n\r\nconst update = () => {\r\n  let form = { ...toRaw(state.formData) }\r\n\r\n  form.where = whereDataFormatter(form.where)\r\n\r\n  node_params.form_delete = form\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst whereDataConditions = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n    let ruleArr = data.rule.split('_')\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.field_type = ruleArr[0]\r\n    // 删除数组的第一个\r\n    ruleArr.shift()\r\n    // 数组还原成字符串\r\n    data.rule = ruleArr.join('_')\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst whereDataFormatter = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.rule = item.field_type + '_' + item.rule\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst getTableList = async () => {\r\n  const list = await dataTableStore.getFormList()\r\n  if (list) {\r\n    state.tableList = list\r\n  }\r\n}\r\n\r\nconst getFieldList = async (form_id) => {\r\n  dataTableStore\r\n    .getFormFieldList({ form_id: form_id })\r\n    .then((list) => {\r\n      list.forEach((item) => {\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      state.fieldList = list\r\n    })\r\n    .catch(() => {})\r\n}\r\n\r\nonMounted(() => {\r\n  getTableList()\r\n  init()\r\n})\r\n</script>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_variable_assignment')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"variable-node\">\r\n      <div class=\"node-form-content\">\r\n        <div class=\"gray-block\">\r\n          <div class=\"field-items\">\r\n            <div class=\"field-item\" v-for=\"(item, index) in list\" :key=\"index\">\r\n              <div class=\"field-name-box\">\r\n                <a-select\r\n                  style=\"width: 100%\"\r\n                  :placeholder=\"t('ph_select_variable')\"\r\n                  v-model:value=\"item.variable\"\r\n                  @dropdownVisibleChange=\"dropdownVisibleChange\"\r\n                  @change=\"update\"\r\n                >\r\n                  <a-select-option :value=\"opt.value\" v-for=\"opt in options\" :key=\"opt.key\">\r\n                    <span>{{ opt.label }}</span>\r\n                  </a-select-option>\r\n                </a-select>\r\n              </div>\r\n              <div class=\"field-value-box\">\r\n                <at-input\r\n                  :ref=\"'atInput' + index\"\r\n                  inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                  :options=\"valueOptions\"\r\n                  :defaultSelectedList=\"item.tags\"\r\n                  :defaultValue=\"item.value\"\r\n                  @open=\"showAtList\"\r\n                  @change=\"(text, selectedList) => changeValue(text, selectedList, item, index)\"\r\n                  :placeholder=\"t('ph_input_variable_value')\"\r\n                >\r\n                  <template #option=\"{ label, payload }\">\r\n                    <div class=\"field-value-option\">\r\n                      <div class=\"option-label\">{{ label }}</div>\r\n                      <div class=\"option-type\">{{ payload.typ }}</div>\r\n                    </div>\r\n                  </template>\r\n                </at-input>\r\n              </div>\r\n              <div class=\"field-actions\">\r\n                <CloseCircleOutlined class=\"action-btn\" @click=\"handleDel(index)\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <a-button style=\"width: 100%\" class=\"add-btn\" type=\"dashed\" @click=\"handleAdd\">\r\n              <template #icon>\r\n                <PlusOutlined />\r\n              </template>\r\n              {{ t('btn_add_assign_variable') }}\r\n            </a-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { ref, onMounted } from 'vue'\r\nimport { CloseCircleOutlined, PlusOutlined } from '@ant-design/icons-vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.variable-assignment-node-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst valueOptions = ref([])\r\nconst options = ref([])\r\n\r\nfunction getOptions() {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let loop_parent_key = nodeModel.properties.loop_parent_key\r\n    if (loop_parent_key) {\r\n      const gropModel = props.lf.getNodeModelById(loop_parent_key)\r\n      \r\n      if (gropModel) {\r\n        let dataRaw = gropModel.properties.dataRaw || gropModel.properties.node_params || '{}'\r\n        let loop = JSON.parse(dataRaw).loop || {}\r\n\r\n        options.value =loop.intermediate_params.map((item) => {\r\n          return {\r\n            label: item.key,\r\n            value: loop_parent_key + '.' + item.key\r\n          }\r\n        })\r\n        \r\n        return\r\n      }\r\n    }\r\n    let globalVariable = nodeModel.getGlobalVariable()\r\n    let diy_global = globalVariable.diy_global || []\r\n    diy_global.forEach((item) => {\r\n      item.label = item.key\r\n      item.value = 'global.' + item.key\r\n    })\r\n\r\n    options.value = diy_global || []\r\n  }\r\n}\r\nfunction getValueOptions() {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n    valueOptions.value = list\r\n  }\r\n}\r\n\r\nconst list = ref([])\r\n\r\nconst update = () => {\r\n  let node_params = JSON.parse(props.node.node_params)\r\n  node_params.assign = [...list.value]\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let assign = JSON.parse(dataRaw).assign || []\r\n\r\n    assign = JSON.parse(JSON.stringify(assign))\r\n\r\n    assign.forEach((item) => {\r\n      item.tags = item.tags || []\r\n    })\r\n\r\n    list.value = assign\r\n\r\n    getOptions()\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst showAtList = (val) => {\r\n  if (val) {\r\n    getValueOptions()\r\n  }\r\n}\r\n\r\nconst changeValue = (text, selectedList, item) => {\r\n  item.tags = selectedList\r\n  item.value = text\r\n  update()\r\n}\r\n\r\nconst handleAdd = () => {\r\n  list.value.push({\r\n    variable: void 0,\r\n    value: ''\r\n  })\r\n  update()\r\n}\r\n\r\nconst handleDel = (index) => {\r\n  list.value.splice(index, 1)\r\n  update()\r\n}\r\n\r\nconst dropdownVisibleChange = (visible) => {\r\n  if (visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import './form-block.less';\r\n.variable-node {\r\n  .field-items {\r\n    .field-item {\r\n      display: flex;\r\n      align-items: center;\r\n      margin-bottom: 8px;\r\n    }\r\n\r\n    .field-name-box {\r\n      width: 130px;\r\n      margin-right: 8px;\r\n    }\r\n    .field-value-box {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n    .field-actions {\r\n      margin-left: 12px;\r\n      .action-btn {\r\n        cursor: pointer;\r\n        font-size: 16px;\r\n        color: #595959;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.field-value-option {\r\n  display: flex;\r\n  align-items: center;\r\n  color: #595959;\r\n  font-size: 14px;\r\n  font-weight: 400;\r\n  .option-label {\r\n    font-weight: 400;\r\n    margin-right: 6px;\r\n  }\r\n  .option-type {\r\n    width: fit-content;\r\n    padding: 1px 8px;\r\n    border-radius: 6px;\r\n    border: 1px solid #00000026;\r\n    background: var(--10, #fff);\r\n    display: flex;\r\n    align-items: center;\r\n    font-size: 12px;\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.update-data-form {\r\n  .node-box-content {\r\n    margin-top: 16px;\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n  .node-box-title {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 48px;\r\n    padding: 0 12px;\r\n\r\n    .input-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .text {\r\n      font-weight: 600;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    padding: 0 12px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n\r\n  .setting-box {\r\n    padding: 0 12px;\r\n    margin-bottom: 12px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :iconName=\"node.node_icon_name\">\r\n        <template #desc>\r\n          <span >{{ t('title_desc_update_data') }}\r\n            <a target=\"_blank\" href=\"/#/database/list\">{{ t('btn_go_manage') }}</a>\r\n          </span>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"update-data-form\">\r\n      <div class=\"node-box-content\">\r\n        <div class=\"node-box-title\">\r\n          <img class=\"input-icon\" src=\"@/assets/img/workflow/input.svg\" alt=\"\" />\r\n          <span class=\"text\">{{ t('label_input') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-label\">\r\n          <span>{{ t('label_data_table') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-box\">\r\n          <DataTableSelect\r\n            :options=\"state.tableList\"\r\n            :title=\"state.formData.form_name\"\r\n            :description=\"state.formData.form_description\"\r\n            v-model:value=\"state.formData.form_id\"\r\n            @change=\"onSelectTable\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"setting-label\">\r\n          <span>{{ t('label_update_condition') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-box\">\r\n          <QueryConditionFilter\r\n            :disabled=\"!state.formData.form_id\"\r\n            :where=\"state.formData.where\"\r\n            :field-options=\"state.fieldList\"\r\n            :type=\"state.formData.typ\"\r\n            @change=\"onConditionChagne\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"setting-label\">\r\n          <span>{{ t('label_update_data') }}</span>\r\n        </div>\r\n\r\n        <div class=\"setting-box\">\r\n          <FieldListSelect\r\n            :form-id=\"state.formData.form_id\"\r\n            :showAdd=\"state.formData.form_id != ''\"\r\n            :showEmptyFieldRow=\"state.formData.form_id == ''\"\r\n            :list=\"state.formData.datas\"\r\n            @change=\"onChangeFields\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n  \r\n</template>\r\n\r\n<script setup>\r\nimport { inject, onMounted, reactive, toRaw } from 'vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport FieldListSelect from '../data-table/field-selector/index.vue'\r\nimport DataTableSelect from '../data-table/database-selector/index.vue'\r\nimport QueryConditionFilter from '../data-table/query-condition-filter.vue'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.update-data-form')\r\n\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\n\r\nconst dataTableStore = useDataTableStore()\r\n\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    typ: 1,\r\n    datas: [],\r\n    where: []\r\n  },\r\n  fieldList: []\r\n})\r\n\r\nconst onConditionChagne = ({type, list}) => {\r\n  state.formData.typ = type\r\n  state.formData.where = list\r\n\r\n  update()\r\n}\r\n\r\nconst onSelectTable = (value, record) => {\r\n  if (record) {\r\n    state.formData.form_name = record.name\r\n    state.formData.form_description = record.description\r\n    // state.formData.form_id = record.id\r\n    getFieldList(record.id)\r\n  } else {\r\n    state.formData.form_name = ''\r\n    state.formData.form_description = ''\r\n    // state.formData.form_id = ''\r\n    state.formData.datas = []\r\n    state.formData.where = []\r\n    state.formData.typ = 1\r\n  }\r\n\r\n  update()\r\n}\r\n\r\nconst onChangeFields = (selectedRows) => {\r\n  state.formData.datas = selectedRows\r\n  update()\r\n}\r\n\r\nconst init = () => {\r\n  let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n\r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  let where = whereDataConditions(node_params.form_update.where || [])\r\n\r\n  node_params.form_update.where = where\r\n\r\n  state.formData = node_params.form_update\r\n\r\n  if (state.formData.form_id) {\r\n    getFieldList(state.formData.form_id)\r\n  }\r\n\r\n  update()\r\n}\r\n\r\nconst update = () => {\r\n  let form = { ...toRaw(state.formData) }\r\n\r\n  form.where = whereDataFormatter(form.where)\r\n\r\n  node_params.form_update = form\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst whereDataConditions = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n    let ruleArr = data.rule.split('_')\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.field_type = ruleArr[0]\r\n    // 删除数组的第一个\r\n    ruleArr.shift()\r\n    // 数组还原成字符串\r\n    data.rule = ruleArr.join('_')\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst whereDataFormatter = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.rule = item.field_type + '_' + item.rule\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst getTableList = async () => {\r\n  const list = await dataTableStore.getFormList()\r\n  if (list) {\r\n    state.tableList = list\r\n  }\r\n}\r\n\r\nconst getFieldList = async (form_id) => {\r\n  dataTableStore.getFormFieldList({ form_id: form_id })\r\n    .then((list) => {\r\n      list.forEach(item => {\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      state.fieldList = list\r\n    })\r\n    .catch(() => {})\r\n}\r\n\r\nonMounted(() => {\r\n  getTableList()\r\n  init()\r\n})\r\n</script>\r\n","<template>\r\n  <div>\r\n    <a-modal\r\n      v-model:open=\"open\"\r\n      :title=\"modalTitle\"\r\n      @ok=\"handleOk\"\r\n      :width=\"472\"\r\n      :ok-text=\"t('btn_confirm')\"\r\n      :cancel-text=\"t('btn_cancel')\"\r\n    >\r\n      <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\" style=\"margin: 24px 0\">\r\n        <a-form-item\r\n          :label=\"t('label_param_key')\"\r\n          name=\"key\"\r\n          :rules=\"[\r\n            {\r\n              required: true,\r\n              validator: (rule, value) => checkKey(rule, value)\r\n            }\r\n          ]\"\r\n        >\r\n          <a-input\r\n            v-model:value=\"formState.key\"\r\n            :maxlength=\"20\"\r\n            :placeholder=\"t('ph_param_key_tip')\"\r\n          />\r\n        </a-form-item>\r\n        <a-form-item\r\n          :label=\"t('label_param_type')\"\r\n          name=\"typ\"\r\n          :rules=\"[{ required: true, message: t('msg_select_type') }]\"\r\n        >\r\n          <a-select v-model:value=\"formState.typ\" :placeholder=\"t('ph_select')\" style=\"width: 100%\">\r\n            <a-select-option v-for=\"op in typOptions\" :value=\"op.value\">{{\r\n              op.value\r\n            }}</a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item\r\n          :label=\"t('label_required')\"\r\n          name=\"required\"\r\n          :rules=\"[{ required: true, message: t('msg_select_required') }]\"\r\n        >\r\n          <a-switch v-model:checked=\"formState.required\" />\r\n        </a-form-item>\r\n        <a-form-item\r\n          :label=\"t('label_default_value')\"\r\n          name=\"default\"\r\n          :rules=\"[{ required: formState.required, message: t('msg_enter_default') }]\"\r\n        >\r\n          <a-input v-model:value=\"formState.default\" :placeholder=\"t('msg_enter_default')\" />\r\n        </a-form-item>\r\n        <a-form-item :label=\"t('label_enum_values')\" name=\"enum\">\r\n          <a-textarea\r\n            style=\"height: 80px\"\r\n            v-model:value=\"formState.enum\"\r\n            :placeholder=\"t('ph_enum_tip')\"\r\n          />\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { message } from 'ant-design-vue'\r\nimport { ref, reactive } from 'vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.parameter-extraction-form.add-params-modal')\r\n\r\nconst emit = defineEmits(['add', 'edit', 'addSub'])\r\n\r\nconst open = ref(false)\r\nconst modalTitle = ref(t('title_add_param'))\r\n\r\nlet oprateType = 'add'\r\n\r\nconst checkKey = (rule, value) => {\r\n  if (!value) {\r\n    return Promise.reject(t('msg_enter_key'))\r\n  }\r\n  // 校验是否只包含英文字母和下划线\r\n  const regex = /^[a-zA-Z_]+$/\r\n  if (!regex.test(value)) {\r\n    return Promise.reject(t('msg_only_letters_underscore'))\r\n  }\r\n  return Promise.resolve()\r\n}\r\nlet INDEX = 0\r\nconst formState = reactive({\r\n  key: '',\r\n  typ: 'string',\r\n  required: false,\r\n  default: '',\r\n  enum: '',\r\n  cu_key: '',\r\n  subs: [],\r\n})\r\nconst show = () => {\r\n  open.value = true\r\n}\r\n\r\nconst add = () => {\r\n  Object.assign(formState, {\r\n    key: '',\r\n    typ: 'string',\r\n    required: false,\r\n    default: '',\r\n    enum: '',\r\n    cu_key: Math.random() * 10000,\r\n    subs: []\r\n  })\r\n  oprateType = 'add'\r\n  modalTitle.value = t('title_add_param')\r\n  open.value = true\r\n}\r\n\r\nconst addSub = (index) => {\r\n  INDEX = index\r\n  Object.assign(formState, {\r\n    key: '',\r\n    typ: 'string',\r\n    required: false,\r\n    default: '',\r\n    enum: '',\r\n    cu_key: Math.random() * 10000,\r\n    subs: []\r\n  })\r\n  oprateType = 'addSub'\r\n  modalTitle.value = t('title_add_param')\r\n  open.value = true\r\n}\r\n\r\nconst edit = (data, index) => {\r\n  INDEX = index\r\n  Object.assign(formState, {\r\n    key: '',\r\n    typ: 'string',\r\n    required: false,\r\n    default: '',\r\n    enum: '',\r\n    cu_key: Math.random() * 10000,\r\n    subs: []\r\n  })\r\n  Object.assign(formState, {\r\n    ...data\r\n  })\r\n  oprateType = 'edit'\r\n  modalTitle.value = t('title_edit_param')\r\n  open.value = true\r\n}\r\n\r\nconst formRef = ref(null)\r\nconst handleOk = () => {\r\n  formRef.value.validate().then(() => {\r\n    if (oprateType == 'add') {\r\n      emit('add', {\r\n        ...formState\r\n      })\r\n    }\r\n    if (oprateType == 'addSub') {\r\n      emit(\r\n        'addSub',\r\n        {\r\n          ...formState\r\n        },\r\n        INDEX\r\n      )\r\n    }\r\n    if (oprateType == 'edit') {\r\n      emit(\r\n        'edit',\r\n        {\r\n          ...formState\r\n        },\r\n        INDEX\r\n      )\r\n    }\r\n    open.value = false\r\n  })\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\ndefineExpose({\r\n  show,\r\n  add,\r\n  edit,\r\n  addSub\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped></style>\r\n","<template>\r\n  <div\r\n    :class=\"['sub-field-item-box', `sub-field-item-box_${props.level}`]\"\r\n    v-for=\"(item, index) in props.data\"\r\n    :key=\"item.cu_key\"\r\n  >\r\n    <div class=\"sub-field-item\">\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-input\r\n        class=\"mr12\"\r\n        :style=\"{ width: widthPx }\"\r\n        v-model:value=\"item.key\"\r\n        :placeholder=\"t('ph_input')\"\r\n      ></a-input>\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-select\r\n        class=\"mr12\"\r\n        @change=\"onTypeChange(item)\"\r\n        v-model:value=\"item.typ\"\r\n        :placeholder=\"t('ph_select')\"\r\n        :style=\"{ width: widthPx }\"\r\n      >\r\n        <a-select-option v-for=\"op in filterTypOptions\" :value=\"op.value\">{{\r\n          op.value\r\n        }}</a-select-option>\r\n      </a-select>\r\n      <div\r\n        class=\"btn-hover-wrap mr12\"\r\n        @click=\"handleAddOutPut(index, props.data)\"\r\n        v-if=\"showAddBtn(item)\"\r\n      >\r\n        <PlusCircleOutlined />\r\n      </div>\r\n      <div class=\"btn-hover-wrap mr12\" @click=\"handleEditOutput(item, index)\">\r\n        <EditOutlined />\r\n      </div>\r\n\r\n      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index, props.data)\">\r\n        <CloseCircleOutlined />\r\n      </div>\r\n    </div>\r\n    <template v-if=\"item.subs && item.subs.length > 0\">\r\n      <SubsKey :level=\"props.level + 1\" :typOptions=\"props.typOptions\" :data=\"item.subs\" />\r\n    </template>\r\n  </div>\r\n  <AddParamsModal @add=\"onOutputAdd\" @edit=\"onOutputEdit\" ref=\"addParamsModalRef\" />\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { computed, ref } from 'vue'\r\nimport { CloseCircleOutlined, PlusCircleOutlined, EditOutlined} from '@ant-design/icons-vue'\r\nimport AddParamsModal from './add-params-modal.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.parameter-extraction-form.subs-key')\r\nconst props = defineProps({\r\n  data: {},\r\n  level: {\r\n    type: Number\r\n  },\r\n  typOptions: {\r\n    type: Array\r\n  }\r\n})\r\nconst filterTypOptions = computed(() => {\r\n  if (props.level > 2) {\r\n    return props.typOptions.filter((item) => item.value != 'object')\r\n  }\r\n  return props.typOptions\r\n})\r\n\r\nconst widthPx = computed(() => {\r\n  if (props.level == 2) {\r\n    return '180px'\r\n  }\r\n  return '146px'\r\n})\r\n\r\nlet currentIndex = 0\r\n\r\nconst onAddSubs = (index, data) => {\r\n  data[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index, data) => {\r\n  data.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst addParamsModalRef = ref(null)\r\n\r\nconst handleAddOutPut = (index) => {\r\n  currentIndex = index\r\n  addParamsModalRef.value.add()\r\n}\r\nconst handleEditOutput = (data, index) => {\r\n  addParamsModalRef.value.edit(data, index)\r\n}\r\nconst onOutputAdd = (data) => {\r\n  props.data[currentIndex].subs.push(data)\r\n}\r\n\r\nconst onOutputEdit = (data, index) => {\r\n  props.data.splice(index, 1, data)\r\n}\r\n\r\nconst showAddBtn = (item) => {\r\n  return item.typ == 'object' && props.level <= 2\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sub-field-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 4px;\r\n  .btn-hover-wrap {\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    width: 24px;\r\n    height: 24px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n.mr12 {\r\n  margin-right: 12px;\r\n}\r\n.sub-field-item-box_3 .fork-icon {\r\n  margin-left: 34px;\r\n}\r\n.fork-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n  margin-right: 2px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_param_extraction')\"\r\n        @close=\"handleClose\"\r\n      ></NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('label_input') }}</div>\r\n            <a-form-item :label=\"t('label_llm_model')\" name=\"use_model\">\r\n              <div class=\"flex-block-item\">\r\n                <ModelSelect\r\n                  modelType=\"LLM\"\r\n                  v-model:modeName=\"formState.use_model\"\r\n                  v-model:modeId=\"formState.model_config_id\"\r\n                  @loaded=\"onVectorModelLoaded\"\r\n                  @change=\"handleModelChange\"\r\n                  style=\"width: 348px\"\r\n                />\r\n                <!-- <DownOutlined /> -->\r\n                <a-button @click=\"hanldeShowMore\"\r\n                  >{{ t('btn_advanced_settings') }}\r\n                  <DownOutlined v-if=\"showMoreBtn\" />\r\n                  <UpOutlined v-else />\r\n                </a-button>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"role\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_prompt_role') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>\r\n                    <div>\r\n                      {{ t('tip_prompt_role_desc') }}\r\n                      <div>{{ t('label_system_role_example') }}</div>\r\n                      <div>{\"role\": \"system\", \"content\": \"{{ t('sample_custom_prompt') }}\"}</div>\r\n                    </div>\r\n                  </template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <a-radio-group v-model:value=\"formState.role\">\r\n                <a-radio :value=\"1\">{{ t('label_system_role') }}</a-radio>\r\n                <a-radio :value=\"2\">{{ t('label_user_role') }}</a-radio>\r\n              </a-radio-group>\r\n            </a-form-item>\r\n            <a-form-item name=\"temperature\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_temperature') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_temperature') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.temperature\"\r\n                      :min=\"0\"\r\n                      :max=\"2\"\r\n                      :step=\"0.1\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number\r\n                    v-model:value=\"formState.temperature\"\r\n                    :min=\"0\"\r\n                    :max=\"2\"\r\n                    :step=\"0.1\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"max_token\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_max_token') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_max_token') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.max_token\"\r\n                      :min=\"0\"\r\n                      :max=\"100 * 1024\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.max_token\" :min=\"0\" :max=\"100 * 1024\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"enable_thinking\" v-if=\"showMoreBtn && show_enable_thinking\">\r\n              <template #label>\r\n                <span>{{ t('label_deep_thinking') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_deep_thinking') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <a-switch v-model:checked=\"formState.enable_thinking\" />\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"context_pair\">\r\n              <template #label>\r\n                <span>{{ t('label_context_count') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_context_count') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.context_pair\"\r\n                      :min=\"0\"\r\n                      :max=\"50\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.context_pair\" :min=\"0\" :max=\"50\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n\r\n            <a-form-item name=\"prompt\" class=\"width-100\">\r\n              <template #label>\r\n                <div class=\"space-between-box\">\r\n                  <div>{{ t('label_prompt') }}</div>\r\n                </div>\r\n              </template>\r\n              <!-- {{ formState.prompt }} -->\r\n              <at-input\r\n                type=\"textarea\"\r\n                inputStyle=\"height: 100px;\"\r\n                :options=\"variableOptions\"\r\n                :defaultSelectedList=\"formState.prompt_tags\"\r\n                :defaultValue=\"formState.prompt\"\r\n                ref=\"atInputRef\"\r\n                @open=\"getVlaueVariableList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n                :placeholder=\"t('ph_input_message')\"\r\n              >\r\n                <template #option=\"{ label, payload }\">\r\n                  <div class=\"field-list-item\">\r\n                    <div class=\"field-label\">{{ label }}</div>\r\n                    <div class=\"field-type\">{{ payload.typ }}</div>\r\n                  </div>\r\n                </template>\r\n              </at-input>\r\n              <div class=\"form-tip\">{{ t('tip_input_variable') }}</div>\r\n            </a-form-item>\r\n            <div class=\"diy-form-item\">\r\n              <div class=\"form-label\">{{ t('label_user_question') }}</div>\r\n              <div class=\"form-content\">\r\n                <a-cascader\r\n                  v-model:value=\"formState.question_value\"\r\n                  @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                  style=\"width: 220px\"\r\n                  :options=\"variableOptionsSelect\"\r\n                  :allowClear=\"false\"\r\n                  :displayRender=\"({ labels }) => labels.join('/')\"\r\n                  :field-names=\"{ children: 'children' }\"\r\n                  :placeholder=\"t('ph_select')\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\" @click=\"test\">{{ t('label_output_extract') }}</div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\">{{ t('label_type') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n                  <a-form-item :label=\"null\" :name=\"['output', index, 'key']\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 214px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-select\r\n                          @change=\"onTypeChange(item)\"\r\n                          v-model:value=\"item.typ\"\r\n                          :placeholder=\"t('ph_select')\"\r\n                          style=\"width: 214px\"\r\n                        >\r\n                          <a-select-option\r\n                            v-for=\"op in typOptions\"\r\n                            :value=\"op.value\"\r\n                            :key=\"op.value\"\r\n                            >{{ op.value }}</a-select-option\r\n                          >\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n\r\n                      <div\r\n                        class=\"btn-hover-wrap\"\r\n                        v-if=\"item.typ == 'object'\"\r\n                        @click=\"onAddSubs(index)\"\r\n                      >\r\n                        <PlusCircleOutlined />\r\n                      </div>\r\n                      <div class=\"btn-hover-wrap\" @click=\"handleEditOutput(item, index)\">\r\n                        <EditOutlined />\r\n                      </div>\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                      <a-form-item-rest>\r\n                        <SubKey :data=\"item.subs\" :level=\"2\" :typOptions=\"typOptions\" />\r\n                      </a-form-item-rest>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button @click=\"handleAddOutPut\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n      <AddParamsModal\r\n        @add=\"onOutputAdd\"\r\n        @edit=\"onOutputEdit\"\r\n        @addSub=\"onOutputAddSub\"\r\n        ref=\"addParamsModalRef\"\r\n      />\r\n    </div>\r\n\r\n    \r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { ref, reactive, watch, h, computed, onMounted } from 'vue'\r\nimport {\r\n  PlusOutlined,\r\n  PlusCircleOutlined,\r\n  DownOutlined,\r\n  QuestionCircleOutlined,\r\n  UpOutlined,\r\n  CloseCircleOutlined,\r\n  EditOutlined\r\n} from '@ant-design/icons-vue'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport SubKey from './subs-key.vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport ModelSelect from '@/components/model-select/model-select.vue'\r\nimport AddParamsModal from './add-params-modal.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.parameter-extraction-form.index')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst robotStore = useRobotStore()\r\nconst atInputRef = ref(null)\r\nconst modelList = computed(() => {\r\n  return robotStore.modelList\r\n})\r\nconst variableOptions = ref([])\r\nconst variableOptionsSelect = ref([])\r\nconst showMoreBtn = ref(false)\r\n\r\nconst hanldeShowMore = () => {\r\n  showMoreBtn.value = !showMoreBtn.value\r\n}\r\n\r\nconst changeValue = (text, selectedList) => {\r\n  formState.prompt = text\r\n  formState.prompt_tags = selectedList\r\n}\r\n\r\nfunction getOptions() {\r\n  // const node = props.lf.getNodeDataById(props.nodeId)\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    variableOptionsSelect.value = handleOptions(list)\r\n  }\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    variableOptions.value = list\r\n  }\r\n}\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  model_config_id: void 0,\r\n  use_model: void 0,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  question_value: '',\r\n  enable_thinking: false,\r\n  output: [],\r\n  role: 1\r\n})\r\n\r\nconst handleModelChange = () => {\r\n  if (formState.use_model && formState.use_model.toLowerCase().includes('deepseek-r1')) {\r\n    formState.role = 2\r\n  } else {\r\n    formState.role = 1\r\n  }\r\n}\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    params_extractor: {\r\n      ...formState,\r\n      question_value: formState.question_value.join('.'),\r\n      model_config_id: formState.model_config_id\r\n        ? +formState.model_config_id\r\n        : formState.model_config_id\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let params_extractor = JSON.parse(dataRaw).params_extractor || {}\r\n\r\n    params_extractor = JSON.parse(JSON.stringify(params_extractor))\r\n\r\n    getVlaueVariableList()\r\n    getOptions()\r\n\r\n    for (let key in params_extractor) {\r\n      if (key == 'output') {\r\n        formState['output'] = recursionData(params_extractor[key])\r\n        continue\r\n      }\r\n      if (key == 'question_value') {\r\n        formState.question_value = formatQuestionValue(params_extractor[key])\r\n        continue\r\n      }\r\n      formState[key] = params_extractor[key]\r\n    }\r\n    formState.role = +params_extractor.role || 1\r\n    if (!formState.model_config_id && modelList.value.length > 0) {\r\n      formState.model_config_id = modelList.value[0].id\r\n      formState.use_model = modelList.value[0].children[0].name\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = Math.random() * 10000\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nconst addParamsModalRef = ref(null)\r\nconst handleAddOutPut = () => {\r\n  addParamsModalRef.value.add()\r\n}\r\n\r\nconst handleEditOutput = (data, index) => {\r\n  addParamsModalRef.value.edit(data, index)\r\n}\r\n\r\nconst onOutputAdd = (data) => {\r\n  formState.output.push(data)\r\n}\r\n\r\nconst onOutputEdit = (data, index) => {\r\n  formState.output.splice(index, 1, data)\r\n}\r\n\r\nconst onDelOutput = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  addParamsModalRef.value.addSub(index)\r\n}\r\nconst onOutputAddSub = (data, index) => {\r\n  formState.output[index].subs.push(data)\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst choosable_thinking = ref({})\r\nconst onVectorModelLoaded = (list, choosable_thinking_map) => {\r\n  choosable_thinking.value = choosable_thinking_map\r\n}\r\n\r\nconst show_enable_thinking = computed(() => {\r\n  if (!formState.model_config_id) {\r\n    return false\r\n  }\r\n  let key = formState.model_config_id + '#' + formState.use_model\r\n  return choosable_thinking.value[key]\r\n})\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n.number-box {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  .number-slider-box {\r\n    width: 244px;\r\n  }\r\n\r\n  .number-input-box {\r\n    margin-left: 24px;\r\n  }\r\n}\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n</style>\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1.7002%207.99609L11%207.99609'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M5.6665%2012L1.6665%208L5.6665%204'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1.7002%207.99609L11%207.99609'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M5.6665%2012L1.6665%208L5.6665%204'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","<style lang=\"less\" scoped>\r\n.collapse-panel-warpper {\r\n  position: relative;\r\n  width: 100%;\r\n  overflow: hidden;\r\n}\r\n\r\n.collapse-panel-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.collapse-panel-title {\r\n  display: flex;\r\n  align-items: center;\r\n  height: 24px;\r\n  padding: 0 4px;\r\n  cursor: pointer;\r\n  color: #1d2129;\r\n  transition: all 0.3s ease;\r\n\r\n  &:hover {\r\n    border-radius: 6px;\r\n    background: #E4E6EB;\r\n  }\r\n\r\n  .title-text {\r\n    display: flex;\r\n    align-items: center;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: #262626;\r\n  }\r\n}\r\n\r\n.collapse-panel-body {\r\n  transition: height 0.3s ease;\r\n  overflow: hidden;\r\n  margin-top: 8px;\r\n}\r\n\r\n.arrow-icon {\r\n  transition: transform 0.3s;\r\n}\r\n\r\n.arrow-icon.collapsed {\r\n  transform: rotate(-90deg);\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"collapse-panel-warpper\">\r\n    <div class=\"collapse-panel-header\" >\r\n      <div class=\"collapse-panel-title\" @click.stop=\"toggleCollapse\">\r\n        <span class=\"title-text\">{{ title }} <template v-if=\"count\">（{{ count }}）</template></span>\r\n        <svg-icon\r\n          name=\"arrow-down\"\r\n          class=\"arrow-icon\"\r\n          :class=\"{ 'collapsed': collapsed }\"\r\n          style=\"font-size: 16px;color: #000;\"\r\n        ></svg-icon>\r\n      </div>\r\n      <div>\r\n        <slot name=\"extra\"></slot>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"collapse-panel-body\" v-show=\"!collapsed\">\r\n      <slot></slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\n\r\n// 定义props\r\nconst props = defineProps({\r\n  title: {\r\n    type: String,\r\n  },\r\n  count: {\r\n    type: [Number, String],\r\n    default: 0\r\n  },\r\n  defaultCollapsed: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n});\r\n\r\n// 折叠状态\r\nconst collapsed = ref(props.defaultCollapsed);\r\n\r\n// 切换折叠状态\r\nconst toggleCollapse = () => {\r\n  collapsed.value = !collapsed.value;\r\n};\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n.library-checkbox-box {\r\n  padding-top: 16px;\r\n\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n\r\n  .list-box {\r\n    display: flex;\r\n    flex-flow: row wrap;\r\n    height: 388px;\r\n    width: 100%;\r\n    overflow-y: auto;\r\n    align-content: flex-start;\r\n    margin: 0 -8px;\r\n\r\n    .list-item-wraapper {\r\n      padding: 8px;\r\n      width: 50%;\r\n    }\r\n\r\n    .list-item {\r\n      width: 100%;\r\n      padding: 14px 12px;\r\n      border: 1px solid #f0f0f0;\r\n      border-radius: 2px;\r\n\r\n      &:hover {\r\n        cursor: pointer;\r\n        box-shadow: 0 4px 16px 0 #1b3a6929;\r\n      }\r\n\r\n      .library-name {\r\n        line-height: 22px;\r\n        font-size: 14px;\r\n        font-weight: 600;\r\n        color: #262626;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n\r\n      .library-desc {\r\n        line-height: 20px;\r\n        margin-top: 2px;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        color: #8c8c8c;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n\r\n    .list-item :deep(span:last-child) {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n.empty-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  padding-top: 40px;\r\n  padding-bottom: 40px;\r\n  color: #8c8c8c;\r\n  img {\r\n    width: 150px;\r\n    height: 150px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal width=\"746px\" v-model:open=\"state.show\" :title=\"t('title_relate_data_table')\" @ok=\"handleOk\" :ok-text=\"t('btn_confirm')\" :cancel-text=\"t('btn_cancel')\">\r\n    <div class=\"field-select-box\">\r\n      <div class=\"field-list-box\" v-if=\"dataSource.length\">\r\n        <a-table rowKey=\"name\" :row-selection=\"{ selectedRowKeys: state.selectedRowKeys, onChange: onSelectChange }\" :dataSource=\"dataSource\" :columns=\"columns\" :pagination=\"false\" />\r\n      </div>\r\n      <div class=\"empty-box\" v-if=\"!dataSource.length\">\r\n        <img src=\"@/assets/img/library/preview/empty.png\" alt=\"\" />\r\n        <div>\r\n          {{ t('msg_no_fields_add') }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.sort-selector.field-select-alert')\r\n\r\nconst emit = defineEmits(['ok'])\r\n\r\nconst state = reactive({\r\n  show: false,\r\n  formId: '',\r\n  selectedRowKeys: [],\r\n  selectedRows: []\r\n})\r\n\r\nconst columns = ref([\r\n  {\r\n    title: t('label_field_name'),\r\n    dataIndex: 'name',\r\n    key: 'name'\r\n  },\r\n  {\r\n    title: t('label_data_type'),\r\n    dataIndex: 'type',\r\n    key: 'type'\r\n  },\r\n  {\r\n    title: t('label_field_desc'),\r\n    dataIndex: 'description',\r\n    key: 'description'\r\n  }\r\n])\r\n\r\nconst dataSource = ref([\r\n  {\r\n    name: 'create_time',\r\n    type: 'integer',\r\n    description: 'create_time',\r\n    is_asc: 0\r\n  },\r\n  {\r\n    name: 'update_time',\r\n    type: 'integer',\r\n    description: 'update_time',\r\n    is_asc: 0,\r\n  },\r\n])\r\n\r\nconst onSelectChange = (selectedRowKeys, selectedRows) => {\r\n  state.selectedRowKeys = selectedRowKeys;\r\n  state.selectedRows = selectedRows\r\n};\r\n\r\nconst open = ({\r\n  formId,\r\n  selectedRowKeys,\r\n  selectedRows\r\n}) => {\r\n  state.formId = formId\r\n  state.selectedRowKeys = selectedRowKeys\r\n  state.selectedRows = selectedRows\r\n\r\n  state.show = true\r\n}\r\n\r\n\r\nconst handleOk = () => {\r\n  emit('ok', state.selectedRowKeys, state.selectedRows)\r\n  state.show = false;\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>","<style lang=\"less\" scoped>\r\n.field-list {\r\n  .field-list-row {\r\n    position: relative;\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    align-items: center;\r\n    margin-bottom: 4px;\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n  .field-list-col {\r\n    padding: 0 4px;\r\n  }\r\n  .field-value-col {\r\n    width: 208px;\r\n  }\r\n  .field-name-col {\r\n    width: 220px;\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n  }\r\n  .field-del-head,\r\n  .field-del-col {\r\n    width: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .field-del-col {\r\n    .del-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 16px;\r\n      height: 16px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n  .field-drag-col {\r\n    width: 24px;\r\n    margin-right: 8px;\r\n    .drag-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 24px;\r\n      height: 24px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n      &:hover {\r\n        border-radius: 6px;\r\n        background: #d9d9d9;\r\n      }\r\n    }\r\n  }\r\n  .field-name-box {\r\n    display: flex;\r\n    .field-type-tag {\r\n      padding: 0 6px;\r\n      margin-left: 8px;\r\n      border-radius: 6px;\r\n      font-size: 12px;\r\n      line-height: 16px;\r\n      font-weight: 400;\r\n      color: rgb(89, 89, 89);\r\n      border: 1px solid rgba(0, 0, 0, 0.15);\r\n      background: #fff;\r\n    }\r\n  }\r\n}\r\n.field-list-row:hover {\r\n  border-radius: 6px;\r\n  background: #e4e6eb;\r\n}\r\n.add-btn-box {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div>\r\n    <div class=\"field-list\">\r\n      <div class=\"field-list-row\" v-for=\"item in conditions\" :key=\"item.name\">\r\n        <div class=\"field-list-col field-drag-col\">\r\n          <span class=\"drag-btn\">\r\n            <HolderOutlined />\r\n          </span>\r\n        </div>\r\n        <div class=\"field-list-col field-name-col\">\r\n          <div class=\"field-name-box\">\r\n            <span class=\"field-name\">{{ item.name }}</span>\r\n            <span class=\"field-type-tag\">{{ item.type }}</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-list-col field-value-col\">\r\n          <a-select v-model:value=\"item.is_asc\" style=\"width: 100%\" @change=\"changeValue\">\r\n            <a-select-option :value=\"opt.value\" v-for=\"opt in operatorOptions\" :key=\"opt.key\">\r\n              {{ t(opt.label) }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n        <div class=\"field-list-col field-del-col\" v-if=\"props.showDelete\">\r\n          <span class=\"del-btn\" @click=\"removeCondition(index)\">\r\n            <svg-icon class=\"del-icon\" name=\"close-circle\"></svg-icon>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"add-btn-box\">\r\n      <a-tooltip :title=\"t('ph_select_database_first')\" style=\"width: 100%\" v-if=\"disabled\">\r\n        <span>\r\n          <a-button class=\"add-btn\" type=\"dashed\" disabled block>\r\n            <PlusOutlined /> {{ t('btn_add_sort_field') }}\r\n          </a-button>\r\n        </span>\r\n      </a-tooltip>\r\n\r\n      <a-button class=\"add-btn\" type=\"dashed\" block @click=\"handleAddField\" v-else>\r\n        <PlusOutlined /> {{ t('btn_add_sort_field') }}\r\n      </a-button>\r\n    </div>\r\n\r\n    <FieldSelectAlert :formId=\"formId\" ref=\"fieldSelectAlertRef\" @ok=\"onChangeSelect\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue'\r\nimport { PlusOutlined, HolderOutlined } from '@ant-design/icons-vue'\r\nimport FieldSelectAlert from './field-select-alert.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.sort-selector.index')\r\n\r\nconst emit = defineEmits(['change'])\r\n\r\nconst props = defineProps({\r\n  showAdd: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showDelete: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  formId: {\r\n    type: [String, Number],\r\n    default: ''\r\n  },\r\n  list: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  disabled: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nconst operatorOptions = [\r\n  { label: 'label_asc', value: 1, key: 'asc' },\r\n  { label: 'label_desc', value: 0, key: 'desc' }\r\n]\r\n\r\nconst conditions = ref([])\r\n\r\nwatch(\r\n  () => props.list,\r\n  (newVal) => {\r\n    conditions.value = newVal.map(item => {\r\n      return {\r\n        ...item,\r\n        is_asc: item.is_asc ? 1 : 0\r\n      }\r\n    })\r\n  }\r\n)\r\n\r\nconst removeCondition = (index) => {\r\n  conditions.value.splice(index, 1)\r\n\r\n  change()\r\n}\r\n\r\nconst onChangeSelect = (selectedRowKeys, selectedRows) => {\r\n  conditions.value = selectedRows.map((item) => {\r\n    return { ...item }\r\n  })\r\n  change()\r\n}\r\n\r\nconst changeValue = () => {\r\n  change()\r\n}\r\n\r\nconst change = () => {\r\n  let data = conditions.value.map(item => {\r\n    return {\r\n      ...item,\r\n      is_asc: item.is_asc == 1 ? true : false\r\n    }\r\n  })\r\n  emit('change', data)\r\n}\r\n\r\nconst fieldSelectAlertRef = ref()\r\n\r\nconst handleAddField = () => {\r\n  fieldSelectAlertRef.value.open({\r\n    formId: props.formId,\r\n    selectedRows: props.list,\r\n    selectedRowKeys: props.list.map((item) => {\r\n      return item.name\r\n    })\r\n  })\r\n}\r\n</script>","<template>\r\n  <div class=\"field-tree-wrapper\" @wheel.stop @touchmove.stop>\r\n    <a-tree\r\n      v-model:selectedKeys=\"selectedKeys\"\r\n      blockNode\r\n      :defaultExpandAll=\"true\"\r\n      :height=\"224\"\r\n      :tree-data=\"props.treeData\"\r\n    >\r\n      <template #switcherIcon=\"{ switcherCls }\">\r\n        <span :class=\"switcherCls\">\r\n          <svg-icon\r\n            class=\"switcher-btn\"\r\n            name=\"arrow-down\"\r\n            style=\"font-size: 14px; color: #333\"\r\n          ></svg-icon>\r\n        </span>\r\n      </template>\r\n\r\n      <template #title=\"{ dataRef }\">\r\n        <div class=\"field-item\">\r\n          <span class=\"field-name\">{{ dataRef.title }}</span>\r\n          <span class=\"field-type\">{{ dataRef.type }}</span>\r\n        </div>\r\n      </template>\r\n    </a-tree>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\n// const expandedKeys = ref(['0-0-0'])\r\n\r\nconst props = defineProps({\r\n  treeData: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst selectedKeys = ref([])\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.field-tree-wrapper {\r\n  position: relative;\r\n  height: 224px;\r\n  :deep(.ant-tree) {\r\n    background: none;\r\n  }\r\n  .switcher-btn {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 16px;\r\n    border-radius: 6px;\r\n    color: #000;\r\n\r\n    &:hover {\r\n      cursor: pointer;\r\n      background-color: #d9d9d9;\r\n    }\r\n  }\r\n\r\n  .field-item{\r\n    display: flex;\r\n    align-items: center;\r\n    .field-name{\r\n      line-height: 22px;\r\n      font-size: 14px;\r\n      color: rgb(38, 38, 38);\r\n    }\r\n    .field-type{\r\n      height: 22px;\r\n      line-height: 20px;\r\n      padding: 0 8px;\r\n      margin-left: 8px;\r\n      border-radius: 6px;\r\n      background: #FFFFFF;\r\n      border: 1px solid rgba(0, 0, 0, 0.15);\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.select-data-form {\r\n  .node-box-content {\r\n    margin-top: 16px;\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n  .node-box-title {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 48px;\r\n    padding: 0 12px;\r\n\r\n    .input-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .text {\r\n      font-weight: 600;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    padding: 0 12px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n\r\n  .setting-box {\r\n    padding: 0 12px;\r\n    margin-bottom: 12px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :iconName=\"node.node_icon_name\">\r\n        <template #desc>\r\n          <span >{{ t('title_desc_select_data') }}\r\n            <a target=\"_blank\" href=\"/#/database/list\">{{ t('btn_go_manage') }}</a>\r\n          </span>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"select-data-form\">\r\n      <div class=\"node-box-content\">\r\n          <div class=\"node-box-title\">\r\n            <img class=\"input-icon\" src=\"@/assets/img/workflow/input.svg\" alt=\"\" />\r\n            <span class=\"text\">{{ t('label_input') }}</span>\r\n          </div>\r\n\r\n          <div class=\"setting-label\">\r\n            <span>{{ t('label_data_table') }}</span>\r\n          </div>\r\n\r\n          <div class=\"setting-box\">\r\n            <DataTableSelect\r\n              :options=\"state.tableList\"\r\n              :title=\"state.formData.form_name\"\r\n              :description=\"state.formData.form_description\"\r\n              v-model:value=\"state.formData.form_id\"\r\n              @change=\"onSelectTable\"\r\n            />\r\n          </div>\r\n\r\n          <div class=\"setting-box\">\r\n            <collapse-panel :title=\"t('label_query_condition')\" :count=\"state.formData.where.length\">\r\n              <QueryConditionFilter\r\n                :disabled=\"!state.formData.form_id\"\r\n                :where=\"state.formData.where\"\r\n                :field-options=\"state.fieldList\"\r\n                :type=\"state.formData.typ\"\r\n                @change=\"onConditionChagne\"\r\n              />\r\n            </collapse-panel>\r\n          </div>\r\n\r\n          <div class=\"setting-box\" @wheel.stop @touchmove.stop>\r\n            <collapse-panel :title=\"t('label_query_fields')\" :count=\"state.formData.fields.length\">\r\n              <FieldListSelect\r\n                :form-id=\"state.formData.form_id\"\r\n                :showAdd=\"state.formData.form_id != ''\"\r\n                :showInput=\"false\"\r\n                :showEmptyFieldRow=\"state.formData.form_id == ''\"\r\n                :list=\"state.formData.fields\"\r\n                @change=\"onChangeFields\"\r\n              />\r\n            </collapse-panel>\r\n          </div>\r\n\r\n          <div class=\"setting-box\" @wheel.stop @touchmove.stop>\r\n            <collapse-panel :title=\"t('label_sort')\" :count=\"state.formData.order.length\">\r\n              <SortSelector\r\n                :form-id=\"state.formData.form_id\"\r\n                :disabled=\"!state.formData.form_id\"\r\n                :list=\"state.formData.order\"\r\n                @change=\"changeSoreField\"\r\n              />\r\n            </collapse-panel>\r\n          </div>\r\n\r\n          <div class=\"setting-label\">\r\n            <span>{{ t('label_query_count') }}</span>\r\n          </div>\r\n\r\n          <div class=\"setting-box\" @wheel.stop @touchmove.stop>\r\n            <a-input-number :min=\"1\" :max=\"1000\" v-model:value=\"state.formData.limit\" :disabled=\"!state.formData.form_id\" style=\"width: 205px\" @change=\"changeLimit\" />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"node-box-content\">\r\n          <div class=\"node-box-title\">\r\n            <img class=\"input-icon\" src=\"@/assets/img/workflow/output.svg\" alt=\"\" />\r\n            <span class=\"text\">{{ t('label_output') }}</span>\r\n          </div>\r\n\r\n          <div class=\"setting-box\">\r\n            <OutputFields :treeData=\"outputFields\" />\r\n          </div>\r\n        </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport {reactive, inject, onMounted, toRaw, computed } from 'vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport CollapsePanel from '../data-table/collapse-panel.vue'\r\nimport FieldListSelect from '../data-table/field-selector/index.vue'\r\nimport DataTableSelect from '../data-table/database-selector/index.vue'\r\nimport QueryConditionFilter from '../data-table/query-condition-filter.vue'\r\nimport SortSelector from '../data-table/sort-selector/index.vue'\r\nimport OutputFields from '../data-table/output-fields.vue'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.select-data-form')\r\n\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n})\r\n\r\nconst setData = inject('setData')\r\n\r\nconst dataTableStore = useDataTableStore()\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    typ: 1,\r\n    fields: [],\r\n    where: [],\r\n    order: [],\r\n    limit: 100\r\n  },\r\n  fieldList: []\r\n})\r\n\r\nconst outputFields = computed(() => {\r\n  let fields = state.formData.fields.map((item) => {\r\n    return {\r\n      title: item.name,\r\n      key: item.name,\r\n      type: item.type\r\n    }\r\n  })\r\n\r\n  return [\r\n    {\r\n      title: 'output_list',\r\n      key: 'output_list',\r\n      type: 'array<object>',\r\n      children: fields\r\n    }, {\r\n      title: 'row_num',\r\n      key: 'row_num',\r\n      type: 'integer',\r\n    }\r\n  ]\r\n})\r\n\r\nconst onConditionChagne = ({type, list}) => {\r\n  state.formData.typ = type\r\n  state.formData.where = list\r\n\r\n  update()\r\n}\r\n\r\nconst changeSoreField = (list) => {\r\n  state.formData.order = [...list]\r\n\r\n  update()\r\n}\r\n\r\nconst onSelectTable = (value, record) => {\r\n  if (record) {\r\n    state.formData.form_name = record.name\r\n    state.formData.form_description = record.description\r\n    // state.formData.form_id = record.id\r\n    getFieldList(record.id)\r\n  } else {\r\n    state.formData.form_name = ''\r\n    state.formData.form_description = ''\r\n    state.formData.typ = 1\r\n    state.formData.fields = []\r\n    state.formData.where = []\r\n    state.formData.order = []\r\n    state.formData.limit = 100\r\n    // state.formData.form_id = ''\r\n  }\r\n\r\n  update()\r\n}\r\n\r\nconst onChangeFields = (selectedRows) => {\r\n  state.formData.fields = selectedRows\r\n  update()\r\n}\r\n\r\nconst changeLimit = () => {\r\n  update()\r\n}\r\n\r\nconst init = () => {\r\n  let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n\r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  let where = whereDataConditions(node_params.form_select.where || [])\r\n\r\n  node_params.form_select.where = where\r\n\r\n  state.formData = node_params.form_select\r\n\r\n  if (state.formData.form_id) {\r\n    getFieldList(state.formData.form_id)\r\n  }\r\n\r\n  update()\r\n}\r\n\r\nconst update = () => {\r\n  let form = { ...toRaw(state.formData) }\r\n\r\n  form.where = whereDataFormatter(form.where)\r\n\r\n  node_params.form_select = form\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst whereDataConditions = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n    let ruleArr = data.rule.split('_')\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.field_type = ruleArr[0]\r\n    // 删除数组的第一个\r\n    ruleArr.shift()\r\n    // 数组还原成字符串\r\n    data.rule = ruleArr.join('_')\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst whereDataFormatter = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.rule = item.field_type + '_' + item.rule\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst getTableList = async () => {\r\n  const list = await dataTableStore.getFormList()\r\n  if (list) {\r\n    state.tableList = list\r\n  }\r\n}\r\n\r\nconst getFieldList = async (form_id) => {\r\n  dataTableStore.getFormFieldList({ form_id: form_id })\r\n    .then((list) => {\r\n      list.forEach((item) => {\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      state.fieldList = list\r\n    })\r\n    .catch(() => {})\r\n}\r\n\r\nonMounted(() => {\r\n  getTableList()\r\n  init()\r\n})\r\n</script>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_question_classification')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\" @mousedown.stop=\"\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('label_input') }}</div>\r\n            <a-form-item :label=\"t('label_llm_model')\" name=\"use_model\">\r\n              <div class=\"flex-block-item\">\r\n                <ModelSelect\r\n                  modelType=\"LLM\"\r\n                  v-model:modeName=\"formState.use_model\"\r\n                  v-model:modeId=\"formState.model_config_id\"\r\n                  @loaded=\"onVectorModelLoaded\"\r\n                  @change=\"handleModelChange\"\r\n                  style=\"width: 348px\"\r\n                />\r\n                <a-button @click=\"hanldeShowMore\"\r\n                  >{{ t('btn_advanced_settings') }}\r\n                  <DownOutlined v-if=\"showMoreBtn\" />\r\n                  <UpOutlined v-else />\r\n                </a-button>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"role\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_prompt_role') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>\r\n                    <div>\r\n                      {{ t('tip_prompt_role_desc') }}\r\n                      <div>{{ t('label_system_role_example') }}</div>\r\n                      <div>{\"role\": \"system\", \"content\": \"{{ t('sample_custom_prompt') }}\"}</div>\r\n                    </div>\r\n                  </template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <a-radio-group v-model:value=\"formState.role\">\r\n                <a-radio :value=\"1\">{{ t('label_system_role') }}</a-radio>\r\n                <a-radio :value=\"2\">{{ t('label_user_role') }}</a-radio>\r\n              </a-radio-group>\r\n            </a-form-item>\r\n            <a-form-item name=\"temperature\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_temperature') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_temperature_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.temperature\"\r\n                      :min=\"0\"\r\n                      :max=\"2\"\r\n                      :step=\"0.1\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number\r\n                    v-model:value=\"formState.temperature\"\r\n                    :min=\"0\"\r\n                    :max=\"2\"\r\n                    :step=\"0.1\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"max_token\" v-if=\"showMoreBtn\">\r\n              <template #label>\r\n                <span>{{ t('label_max_token') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_max_token_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.max_token\"\r\n                      :min=\"0\"\r\n                      :max=\"100 * 1024\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.max_token\" :min=\"0\" :max=\"100 * 1024\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"enable_thinking\" v-if=\"showMoreBtn && show_enable_thinking\">\r\n              <template #label>\r\n                <span>{{ t('label_deep_thinking') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_deep_thinking_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <a-switch v-model:checked=\"formState.enable_thinking\" />\r\n              </div>\r\n            </a-form-item>\r\n            <a-form-item name=\"context_pair\">\r\n              <template #label>\r\n                <span>{{ t('label_context_pair') }}&nbsp;</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_context_pair_desc') }}</template>\r\n                  <QuestionCircleOutlined class=\"question-icon\" />\r\n                </a-tooltip>\r\n              </template>\r\n              <div class=\"number-box\">\r\n                <div class=\"number-slider-box\">\r\n                  <a-form-item-rest>\r\n                    <a-slider\r\n                      class=\"custom-slider\"\r\n                      v-model:value=\"formState.context_pair\"\r\n                      :min=\"0\"\r\n                      :max=\"50\"\r\n                    />\r\n                  </a-form-item-rest>\r\n                </div>\r\n                <div class=\"number-input-box\">\r\n                  <a-input-number v-model:value=\"formState.context_pair\" :min=\"0\" :max=\"50\" />\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n            <div class=\"diy-form-item\">\r\n              <div class=\"form-label\">{{ t('label_user_question') }}</div>\r\n              <div class=\"form-content\">\r\n                <a-cascader\r\n                  v-model:value=\"formState.question_value\"\r\n                  @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                  style=\"width: 220px\"\r\n                  :options=\"variableOptionsSelect\"\r\n                  :allowClear=\"false\"\r\n                  :displayRender=\"({ labels }) => labels.join('/')\"\r\n                  :field-names=\"{ children: 'children' }\"\r\n                  :placeholder=\"t('ph_select')\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_question_classification_settings') }}</div>\r\n            <div class=\"array-form-box\">\r\n              <div\r\n                class=\"form-item-list\"\r\n                v-for=\"(item, index) in formState.categorys\"\r\n                :key=\"item.key\"\r\n              >\r\n                <a-form-item\r\n                  :label=\"null\"\r\n                  :name=\"['categorys', index, 'category']\"\r\n                  :rules=\"{ required: true, validator: (rule, value) => checkedHeader(rule, value) }\"\r\n                >\r\n                  <div class=\"flex-block-item\">\r\n                    <a-input class=\"flex1\" v-model:value=\"item.category\" :placeholder=\"t('ph_input')\"></a-input>\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelcategory(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n\r\n              <div class=\"form-item-list\">\r\n                <a-form-item :label=\"null\">\r\n                  <div class=\"flex-block-item\">\r\n                    <a-input class=\"flex1\" :value=\"t('label_default_category')\" readonly></a-input>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddcategory\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >{{ t('btn_add_question_category') }}</a-button\r\n              >\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { getUuid } from '@/utils/index'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { ref, reactive, watch, computed, onMounted, h, inject  } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  QuestionCircleOutlined,\r\n  UpOutlined,\r\n  DownOutlined,\r\n  PlusOutlined\r\n} from '@ant-design/icons-vue'\r\nimport ModelSelect from '@/components/model-select/model-select.vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.question-node-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst robotStore = useRobotStore()\r\nconst modelList = computed(() => {\r\n  return robotStore.modelList\r\n})\r\nconst showMoreBtn = ref(false)\r\n\r\nconst hanldeShowMore = () => {\r\n  showMoreBtn.value = !showMoreBtn.value\r\n}\r\n\r\n// const variableOptions = ref([])\r\n\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  model_config_id: void 0,\r\n  use_model: void 0,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  question_value: '',\r\n  enable_thinking: false,\r\n  categorys: [],\r\n  role: 1\r\n})\r\n\r\n\r\nconst handleModelChange = () => {\r\n  if (formState.use_model && formState.use_model.toLowerCase().includes('deepseek-r1')) {\r\n    formState.role = 2\r\n  } else {\r\n    formState.role = 1\r\n  }\r\n}\r\n\r\nconst variableOptionsSelect = ref([])\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptionsSelect.value = handleOptions(list)\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val ) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst update = () => {\r\n  const model_config_id = formState.model_config_id ? +formState.model_config_id : formState.model_config_id;\r\n  const data = JSON.stringify({\r\n    cate: {\r\n      ...formState,\r\n      question_value: formState.question_value.join('.'),\r\n      model_config_id: model_config_id\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  getOptions()\r\n\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let cate = JSON.parse(dataRaw).cate || {}\r\n\r\n    cate = JSON.parse(JSON.stringify(cate))\r\n    \r\n    for (let key in cate) {\r\n      if(key === 'question_value'){\r\n      formState.question_value = formatQuestionValue(cate['question_value'])\r\n    }else if (key == 'categorys') {\r\n        if (cate.categorys && cate.categorys.length > 0) {\r\n          let items = cate.categorys.map((item) => {\r\n            return {\r\n              ...item,\r\n            }\r\n          })\r\n          formState[key] = items\r\n        } else {\r\n          formState[key] = [\r\n            {\r\n              category: '',\r\n              next_node_key: '',\r\n              key: getUuid(16)\r\n            }\r\n          ]\r\n        }\r\n      } else {\r\n        formState[key] = cate[key]\r\n      }\r\n    }\r\n\r\n    formState.role = +cate.role || 1\r\n\r\n    if (!formState.model_config_id && modelList.value.length > 0) {\r\n      formState.model_config_id = modelList.value[0].id\r\n      formState.use_model = modelList.value[0].children[0].name\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddcategory = () => {\r\n  formState.categorys.push({\r\n    category: '',\r\n    next_node_key: '',\r\n    key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelcategory = (index) => {\r\n  formState.categorys.splice(index, 1)\r\n}\r\n\r\nconst checkedHeader = () => {\r\n  // if (value == null) {\r\n  //   return Promise.reject('请输入延迟发送时间')\r\n  // }\r\n  // if (!Number.isInteger(value / 0.5)) {\r\n  //   return Promise.reject('必须为0.5秒的倍数')\r\n  // }\r\n  return Promise.resolve()\r\n}\r\n\r\nconst choosable_thinking = ref({})\r\nconst onVectorModelLoaded = (list, choosable_thinking_map) => {\r\n  choosable_thinking.value = choosable_thinking_map\r\n}\r\n\r\nconst show_enable_thinking = computed(() => {\r\n  if (!formState.model_config_id) {\r\n    return false\r\n  }\r\n  let key = formState.model_config_id + '#' + formState.use_model\r\n  return choosable_thinking.value[key]\r\n})\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import './form-block.less';\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n}\r\n.number-box {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  .number-slider-box {\r\n    width: 244px;\r\n  }\r\n\r\n  .number-input-box {\r\n    margin-left: 24px;\r\n  }\r\n}\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :iconName=\"node.node_icon_name\">\r\n        <template #desc>\r\n          <span>{{ t('desc_judge_condition') }}</span>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"judge-node-form\">\r\n      <div class=\"form-block\" @mousedown.stop=\"\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <draggable\r\n            style=\"display: flex; flex-direction: column; gap: 8px\"\r\n            handle=\".drag-btn\"\r\n            v-model=\"formState.term\"\r\n            item-key=\"key\"\r\n          >\r\n            <template #item=\"{ element: item, index }\">\r\n              <div class=\"gray-block\" :key=\"item.key\">\r\n                <div class=\"gray-block-title\">\r\n                  <a-flex :gap=\"8\"\r\n                    ><HolderOutlined class=\"icon drag-btn\" />{{ index == 0 ? t('label_if') : t('label_else_if') }}\r\n                  </a-flex>\r\n                  <div\r\n                    v-if=\"formState.term.length > 1\"\r\n                    class=\"btn-hover-wrap\"\r\n                    @click=\"handleDelBranch(index)\"\r\n                  >\r\n                    <CloseCircleOutlined />\r\n                  </div>\r\n                </div>\r\n                <div class=\"condition-list-box\">\r\n                  <div class=\"left-select-box\">\r\n                    <a-select\r\n                      size=\"small\"\r\n                      v-model:value=\"item.is_or\"\r\n                      :bordered=\"false\"\r\n                      style=\"width: 64px\"\r\n                    >\r\n                      <a-select-option :value=\"0\">{{ t('label_and') }}</a-select-option>\r\n                      <a-select-option :value=\"1\">{{ t('label_or') }}</a-select-option>\r\n                    </a-select>\r\n                  </div>\r\n                  <div class=\"condition-body\">\r\n                    <div class=\"condition-item\" v-for=\"(term, i) in item.terms\" :key=\"term.key\">\r\n                      <!-- <a-select\r\n                      placeholder=\"请选择\"\r\n                      v-model:value=\"term.variable\"\r\n                      style=\"width: 100px\"\r\n                      @change=\"handleVariableChange(term)\"\r\n                    >\r\n                      <a-select-option v-for=\"option in variableOptions\" :value=\"option.key\">{{\r\n                        option.label || option.key\r\n                      }}</a-select-option>\r\n                    </a-select> -->\r\n                      <a-cascader\r\n                        v-model:value=\"term.variable\"\r\n                        @change=\"handleVariableChange(term)\"\r\n                        @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                        style=\"width: 160px\"\r\n                        :options=\"variableOptions\"\r\n                        :allowClear=\"false\"\r\n                        :displayRender=\"({ labels }) => labels.join('/')\"\r\n                        :field-names=\"{ children: 'children' }\"\r\n                      :placeholder=\"t('ph_select')\"\r\n                    />\r\n                      <a-select v-model:value=\"term.type\" style=\"width: 120px\" :placeholder=\"t('ph_select')\">\r\n                        <a-select-option\r\n                          v-for=\"option in getTypeOptions(term)\"\r\n                          :value=\"option.value\"\r\n                          :key=\"option.value\"\r\n                          >{{ option.label }}</a-select-option\r\n                        >\r\n                      </a-select>\r\n                      <a-input\r\n                        v-if=\"term.type != 5 && term.type != 6\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                        v-model:value=\"term.value\"\r\n                        style=\"width: 150px\"\r\n                      ></a-input>\r\n                      <div class=\"btn-hover-wrap\" @click=\"handleDelCondition(index, i)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"btn-wrap\">\r\n                  <a-button\r\n                    @click=\"handleAddCondition(index)\"\r\n                    :icon=\"h(PlusOutlined)\"\r\n                    block\r\n                    type=\"dashed\"\r\n                    >{{ t('label_add_condition') }}</a-button\r\n                  >\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </draggable>\r\n\r\n          <div class=\"add-btn-block\">\r\n            <a-button @click=\"handleAddBranch\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n              >{{ t('label_add_branch') }}</a-button\r\n            >\r\n          </div>\r\n          <div class=\"gray-block mt8\">\r\n            <div class=\"gray-block-title\">{{ t('label_else') }}</div>\r\n            <div class=\"main-text\">{{ t('msg_else_default_branch') }}</div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, h, inject, onMounted } from 'vue'\r\nimport draggable from 'vuedraggable'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { CloseCircleOutlined, PlusOutlined, HolderOutlined } from '@ant-design/icons-vue'\r\nimport { specialNodeList } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.judge-node-form')\r\n\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  }\r\n})\r\n\r\n// const graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst setData = inject('setData')\r\n\r\nconst formRef = ref()\r\n\r\nconst formState = reactive({\r\n  term: []\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  let loop_parent_key = nodeModel.properties.loop_parent_key\r\n  let result = handleOptions(list)\r\n  if (loop_parent_key) {\r\n    list = list.filter((item) => item.node_type != '25')\r\n    result = handleOptions(list)\r\n    const gropModel = props.lf.getNodeModelById(loop_parent_key)\r\n    if (gropModel) {\r\n      let dataRaw = gropModel.properties.dataRaw || gropModel.properties.node_params || '{}'\r\n      let loop = JSON.parse(dataRaw).loop || {}\r\n      const intermediateChildren = handleIntermediateOption(loop.intermediate_params, gropModel)\r\n      const existing = result.find((item) => (item.node_id || item.value) == gropModel.id)\r\n\r\n      // 修复重复数据问题，判断是否已存在该父分组\r\n      // - 已存在：把中间变量 intermediateChildren 合并进原节点的 children （并按 original_value/value/key 去重）\r\n      // - 不存在：才 push 新节点\r\n      if (existing) {\r\n        const merged = []\r\n        const seen = new Set();\r\n        [...(existing.children || []), ...intermediateChildren].forEach((child) => {\r\n          const key = child.original_value || child.value || child.key\r\n          if (!seen.has(key)) {\r\n            seen.add(key)\r\n            merged.push(child)\r\n          }\r\n        })\r\n        existing.children = merged\r\n      } else {\r\n        result.push({\r\n          label: gropModel.properties.node_name,\r\n          node_id: gropModel.id,\r\n          node_type: gropModel.properties.node_type,\r\n          typ: 'node',\r\n          value: gropModel.id,\r\n          children: intermediateChildren\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  variableOptions.value = result\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nfunction handleIntermediateOption(options, gropModel) {\r\n  let result = []\r\n\r\n  if (options && options.length) {\r\n    options.forEach((item) => {\r\n      if (item.key) {\r\n        result.push({\r\n          id: gropModel.id,\r\n          key: item.key,\r\n          value: item.key,\r\n          label: item.key,\r\n          node_id: gropModel.id,\r\n          node_name: gropModel.properties.node_name,\r\n          node_type: gropModel.properties.node_type,\r\n          original_value: gropModel.id + '.' + item.key,\r\n          text: item.key,\r\n          typ: item.typ\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  return result\r\n}\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let term = JSON.parse(props.node.node_params).term || []\r\n\r\n    term = term.map((item) => {\r\n      let terms = item.terms.map((it) => {\r\n        // 判断是不是特殊节点\r\n        let specialKey = ''\r\n\r\n        for (let i = 0; i < specialNodeList.length; i++) {\r\n          if (it.variable.indexOf(specialNodeList[i]) > -1) {\r\n            specialKey = specialNodeList[i]\r\n            break\r\n          }\r\n        }\r\n\r\n        if (specialKey != '') {\r\n          let arr = it.variable.split('.')\r\n          it.variable = [arr[0], specialKey]\r\n        } else {\r\n          it.variable = it.variable.split('.')\r\n        }\r\n        return {\r\n          ...it,\r\n          type: it.type > 0 ? it.type : 1,\r\n          key: Math.random() * 10000\r\n        }\r\n      })\r\n\r\n      return {\r\n        ...item,\r\n        is_or: item.is_or ? 1 : 0,\r\n        terms,\r\n        key: Math.random() * 10000\r\n      }\r\n    })\r\n\r\n    formState.term = term\r\n\r\n    update()\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst update = () => {\r\n  let term = JSON.parse(JSON.stringify(formState.term))\r\n\r\n  term = term.map((item) => {\r\n    return {\r\n      is_or: item.is_or == 1,\r\n      next_node_key: item.next_node_key,\r\n      terms: item.terms.map((it) => {\r\n        let variable = it.variable.join('.')\r\n        return {\r\n          variable: variable,\r\n          is_mult: it.is_mult,\r\n          type: it.type,\r\n          value: it.value\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    term,\r\n    node_params: JSON.stringify({\r\n      term: term\r\n    })\r\n  })\r\n}\r\n\r\nconst handleAddCondition = (index) => {\r\n  formState.term[index].terms.push({\r\n    is_mult: false,\r\n    type: void 0,\r\n    value: '',\r\n    variable: [],\r\n    key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst handleDelCondition = (index, i) => {\r\n  formState.term[index].terms.splice(i, 1)\r\n}\r\n\r\nconst handleAddBranch = () => {\r\n  formState.term.push({\r\n    is_or: 0,\r\n    key: Math.random() * 10000,\r\n    next_node_key: '',\r\n    terms: [\r\n      {\r\n        is_mult: false,\r\n        type: void 0,\r\n        value: '',\r\n        variable: [],\r\n        key: Math.random() * 10000\r\n      }\r\n    ]\r\n  })\r\n}\r\n\r\nconst handleDelBranch = (index) => {\r\n  formState.term.splice(index, 1)\r\n}\r\n\r\nconst handleVariableChange = (term) => {\r\n  let typ = getTypeByVariable(term)\r\n  term.is_mult = typ.includes('array')\r\n  term.type = void 0\r\n}\r\n\r\nlet baseTypeOptions = [\r\n  {\r\n    label: t('opt_equal'),\r\n    value: 1\r\n  },\r\n  {\r\n    label: t('opt_not_equal'),\r\n    value: 2\r\n  },\r\n  {\r\n    label: t('opt_contain'),\r\n    value: 3\r\n  },\r\n  {\r\n    label: t('opt_not_contain'),\r\n    value: 4\r\n  },\r\n  {\r\n    label: t('opt_is_empty'),\r\n    value: 5\r\n  },\r\n  {\r\n    label: t('opt_not_empty'),\r\n    value: 6\r\n  }\r\n]\r\n\r\nlet baseTypeOptions2 = [\r\n  {\r\n    label: t('opt_contain_one'),\r\n    value: 3\r\n  },\r\n  {\r\n    label: t('opt_not_contain_one'),\r\n    value: 4\r\n  },\r\n  {\r\n    label: t('opt_is_empty'),\r\n    value: 5\r\n  },\r\n  {\r\n    label: t('opt_not_empty'),\r\n    value: 6\r\n  }\r\n]\r\n\r\nfunction getTypeByVariable(data) {\r\n  let typ = ''\r\n  if (data.variable && data.variable.length > 0) {\r\n    let slectItem = variableOptions.value.filter((item) => item.key == data.variable[0])\r\n    if (slectItem && slectItem.length) {\r\n      typ = slectItem[0].typ\r\n    }\r\n    if (typ == 'object') {\r\n      if (slectItem[0] && slectItem[0].children) {\r\n        slectItem = slectItem[0].subs.filter((item) => item.key == data.variable[1])\r\n      }\r\n      if (slectItem && slectItem.length) {\r\n        typ = slectItem[0].typ\r\n      }\r\n\r\n      if (typ == 'object') {\r\n        if (slectItem[0] && slectItem[0].children) {\r\n          slectItem = slectItem[0].subs.filter((item) => item.key == data.variable[2])\r\n        }\r\n        if (slectItem && slectItem.length) {\r\n          typ = slectItem[0].typ\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return typ\r\n}\r\n\r\nfunction getTypeOptions(data) {\r\n  if (!data.variable) {\r\n    return []\r\n  }\r\n  let typ = getTypeByVariable(data)\r\n\r\n  if (typ == '') {\r\n    if (data.is_mult) {\r\n      return baseTypeOptions2\r\n    } else {\r\n      return baseTypeOptions\r\n    }\r\n  }\r\n\r\n  if (typ == 'boole') {\r\n    return [\r\n      {\r\n        label: t('opt_equal'),\r\n        value: 1\r\n      },\r\n      {\r\n        label: t('opt_not_equal'),\r\n        value: 2\r\n      }\r\n    ]\r\n  }\r\n\r\n  if (typ.includes('array')) {\r\n    return baseTypeOptions2\r\n  }\r\n\r\n  return baseTypeOptions\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nonMounted(() => {\r\n  getOptions()\r\n\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import './form-block.less';\r\n\r\n.main-text {\r\n  color: #595959;\r\n}\r\n.btn-wrap {\r\n  margin-top: 8px;\r\n  padding-left: 65px;\r\n  padding-right: 28px;\r\n}\r\n.condition-list-box {\r\n  display: flex;\r\n  align-items: center;\r\n  .left-select-box {\r\n    width: 90px;\r\n    ::v-deep(.ant-select) {\r\n      border-radius: 6px;\r\n      transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\r\n      &:hover {\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n    ::v-deep(.ant-select-selector) {\r\n      color: #2475fc;\r\n    }\r\n    ::v-deep(.ant-select-arrow) {\r\n      color: #2475fc;\r\n    }\r\n  }\r\n  .condition-body {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 4px;\r\n    .condition-item {\r\n      display: flex;\r\n      gap: 4px;\r\n\r\n      .btn-hover-wrap {\r\n        width: 28px;\r\n      }\r\n    }\r\n  }\r\n}\r\n.gray-block {\r\n  margin-top: 8px;\r\n}\r\n.gray-block-title {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.add-btn-block {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.specify-reply-form {\r\n  position: relative;\r\n\r\n  .node-content {\r\n    background: #f2f4f7;\r\n    border-radius: 6px;\r\n    padding: 12px;\r\n    margin-top: 16px;\r\n  }\r\n\r\n  .form-label {\r\n    margin-bottom: 12px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    line-height: 22px;\r\n    font-weight: 600;\r\n  }\r\n\r\n  .form-item {\r\n    .form-item-label {\r\n      line-height: 22px;\r\n      margin-bottom: 2px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n  .flex-between-box {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n  .btn-hover-wrap {\r\n    width: 32px;\r\n    height: 32px;\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_specify_reply')\"\r\n      ></NodeFormHeader>\r\n    </template>\r\n    <div class=\"specify-reply-form\">\r\n      <div class=\"node-content\">\r\n          <div class=\"form-label\">{{ t('label_output') }}</div>\r\n          <div class=\"form-item\" @mousedown.stop=\"\">\r\n            <div class=\"form-item-label\">\r\n              <div class=\"flex-between-box\">\r\n                <div>{{ t('label_message_content') }}</div>\r\n                <div class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal\">\r\n                  <FullscreenOutlined />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item-body\">\r\n              <AtInput\r\n                inputStyle=\"height: 100px;\"\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.content_tags\"\r\n                :defaultValue=\"formState.content\"\r\n                ref=\"atInputRef\"\r\n                :placeholder=\"t('ph_input_message_content')\"\r\n                input-style=\"height: 130px\"\r\n                type=\"textarea\"\r\n                @open=\"showAtList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <FullAtInput\r\n          :options=\"valueOptions\"\r\n          :defaultSelectedList=\"formState.content_tags\"\r\n          :defaultValue=\"formState.content\"\r\n          :placeholder=\"t('ph_input_message_content')\"\r\n          type=\"textarea\"\r\n          @open=\"showAtList\"\r\n          @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n          @ok=\"handleRefreshAtInput\"\r\n          ref=\"fullAtInputRef\"\r\n        />\r\n    </div>\r\n  </NodeFormLayout>\r\n\r\n</template>\r\n\r\n<script>\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { FullscreenOutlined } from '@ant-design/icons-vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport FullAtInput from '../at-input/full-at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'SpecifyReplyNode',\r\n  inject: ['getNode', 'getGraph', 'setData'],\r\n  components: {\r\n    NodeFormHeader,\r\n    AtInput,\r\n    FullscreenOutlined,\r\n    FullAtInput,\r\n    NodeFormLayout\r\n  },\r\n  props: {\r\n    node: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.node-form-drawer.specify-reply-form')\r\n    return {\r\n      t\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      valueOptions: [],\r\n      formState: {\r\n        content: '',\r\n        content_tags: []\r\n      }\r\n    }\r\n  },\r\n  computed: {},\r\n  watch:  {\r\n    formState(){\r\n      this.$nextTick(() => {\r\n        this.update()\r\n      })\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getValueOptions()\r\n\r\n    const graphModel = this.getGraph()\r\n\r\n    let dataRaw = this.node.dataRaw || this.node.node_params || '{}'\r\n    let node_params = JSON.parse(dataRaw)\r\n\r\n    const reply = node_params.reply || {\r\n      content: '',\r\n      content_tags: []\r\n    }\r\n\r\n    this.formState.content = reply.content\r\n\r\n    this.formState.content_tags = reply.content_tags || []\r\n\r\n    this.$nextTick(() => {\r\n      this.$refs[`atInputRef`].refresh()\r\n    })\r\n\r\n    this.update()\r\n\r\n    graphModel.eventCenter.on('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  onBeforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  methods: {\r\n    onUpatateNodeName (data) {\r\n      if (!this.$refs[`atInputRef`]) return\r\n      if(!haveOutKeyNode.includes(data.node_type)){\r\n        return\r\n      }\r\n\r\n      this.getValueOptions()\r\n\r\n      this.$nextTick(() => {\r\n        if (this.formState.content_tags && this.formState.content_tags.length > 0) {\r\n          this.formState.content_tags.forEach((tag) => {\r\n            if (tag.node_id == data.node_id) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n              tag.node_name = data.node_name\r\n            }\r\n          })\r\n        }\r\n\r\n        this.$refs[`atInputRef`].refresh()\r\n      })\r\n    },\r\n    getValueOptions() {\r\n      let options = this.getNode().getAllParentVariable()\r\n\r\n      this.valueOptions = options || []\r\n    },\r\n    update() {\r\n      let node_params = JSON.parse(this.node.node_params)\r\n\r\n      node_params.reply = { ...this.formState }\r\n\r\n      this.setData({\r\n        ...this.node,\r\n        node_params: JSON.stringify(node_params)\r\n      })\r\n    },\r\n    showAtList(val) {\r\n      if (val) {\r\n        this.getValueOptions()\r\n      }\r\n    },\r\n    changeValue(text, selectedList) {\r\n      this.formState.content_tags = selectedList\r\n      this.formState.content = text\r\n\r\n      this.update()\r\n    },\r\n    handleOpenFullAtModal() {\r\n      this.$refs.fullAtInputRef.show()\r\n    },\r\n    handleRefreshAtInput(){\r\n      this.$refs[`atInputRef`].refresh()\r\n    },\r\n  }\r\n}\r\n</script>","<style lang=\"less\" scoped>\r\n.specify-reply-form {\r\n  position: relative;\r\n\r\n  .node-content {\r\n    background: #f2f4f7;\r\n    border-radius: 6px;\r\n    padding: 12px;\r\n    margin-top: 16px;\r\n  }\r\n\r\n  .form-label {\r\n    margin-bottom: 12px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    line-height: 22px;\r\n    font-weight: 600;\r\n  }\r\n\r\n  .form-item {\r\n    .form-item-label {\r\n      line-height: 22px;\r\n      margin-bottom: 2px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n  .flex-between-box {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n  .btn-hover-wrap {\r\n    width: 32px;\r\n    height: 32px;\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_immediately_reply')\"\r\n      ></NodeFormHeader>\r\n    </template>\r\n    <div class=\"specify-reply-form\">\r\n      <div class=\"node-content\">\r\n          <div class=\"form-label\">{{ t('label_output') }}</div>\r\n          <div class=\"form-item\" @mousedown.stop=\"\">\r\n            <div class=\"form-item-label\">\r\n              <div class=\"flex-between-box\">\r\n                <div>{{ t('label_message_content') }}</div>\r\n                <div class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal\">\r\n                  <FullscreenOutlined />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item-body\">\r\n              <AtInput\r\n                inputStyle=\"height: 100px;\"\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.content_tags\"\r\n                :defaultValue=\"formState.content\"\r\n                ref=\"atInputRef\"\r\n                :placeholder=\"t('ph_input_message_content')\"\r\n                input-style=\"height: 130px\"\r\n                type=\"textarea\"\r\n                @open=\"showAtList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <FullAtInput\r\n          :options=\"valueOptions\"\r\n          :defaultSelectedList=\"formState.content_tags\"\r\n          :defaultValue=\"formState.content\"\r\n          :placeholder=\"t('ph_input_message_content')\"\r\n          type=\"textarea\"\r\n          @open=\"showAtList\"\r\n          @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n          @ok=\"handleRefreshAtInput\"\r\n          ref=\"fullAtInputRef\"\r\n        />\r\n    </div>\r\n  </NodeFormLayout>\r\n\r\n</template>\r\n\r\n<script>\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { FullscreenOutlined } from '@ant-design/icons-vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport FullAtInput from '../at-input/full-at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'SpecifyReplyNode',\r\n  inject: ['getNode', 'getGraph', 'setData'],\r\n  components: {\r\n    NodeFormHeader,\r\n    AtInput,\r\n    FullscreenOutlined,\r\n    FullAtInput,\r\n    NodeFormLayout\r\n  },\r\n  props: {\r\n    node: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.node-form-drawer.immediately-reply-form')\r\n    return {\r\n      t\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      valueOptions: [],\r\n      formState: {\r\n        content: '',\r\n        content_tags: []\r\n      }\r\n    }\r\n  },\r\n  computed: {},\r\n  watch:  {\r\n    formState(){\r\n      this.$nextTick(() => {\r\n        this.update()\r\n      })\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getValueOptions()\r\n\r\n    const graphModel = this.getGraph()\r\n\r\n    let dataRaw = this.node.dataRaw || this.node.node_params || '{}'\r\n    let node_params = JSON.parse(dataRaw)\r\n\r\n    const reply = node_params.immediately_reply || {\r\n      content: '',\r\n      content_tags: []\r\n    }\r\n\r\n    this.formState.content = reply.content\r\n    this.formState.content_tags = reply.content_tags || []\r\n\r\n    this.$nextTick(() => {\r\n      this.$refs[`atInputRef`].refresh()\r\n    })\r\n\r\n    this.update()\r\n\r\n    graphModel.eventCenter.on('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  onBeforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  methods: {\r\n    onUpatateNodeName (data) {\r\n      if (!this.$refs[`atInputRef`]) return\r\n      if(!haveOutKeyNode.includes(data.node_type)){\r\n        return\r\n      }\r\n\r\n      this.getValueOptions()\r\n\r\n      this.$nextTick(() => {\r\n        if (this.formState.content_tags && this.formState.content_tags.length > 0) {\r\n          this.formState.content_tags.forEach((tag) => {\r\n            if (tag.node_id == data.node_id) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n              tag.node_name = data.node_name\r\n            }\r\n          })\r\n        }\r\n\r\n        this.$refs[`atInputRef`].refresh()\r\n      })\r\n    },\r\n    getValueOptions() {\r\n      let options = this.getNode().getAllParentVariable()\r\n\r\n      this.valueOptions = options || []\r\n    },\r\n    update() {\r\n      let node_params = JSON.parse(this.node.node_params)\r\n\r\n      node_params.immediately_reply = { ...this.formState }\r\n\r\n      this.setData({\r\n        ...this.node,\r\n        node_params: JSON.stringify(node_params)\r\n      })\r\n    },\r\n    showAtList(val) {\r\n      if (val) {\r\n        this.getValueOptions()\r\n      }\r\n    },\r\n    changeValue(text, selectedList) {\r\n      this.formState.content_tags = selectedList\r\n      this.formState.content = text\r\n\r\n      this.update()\r\n    },\r\n    handleOpenFullAtModal() {\r\n      this.$refs.fullAtInputRef.show()\r\n    },\r\n    handleRefreshAtInput(){\r\n      this.$refs[`atInputRef`].refresh()\r\n    },\r\n  }\r\n}\r\n</script>","<style lang=\"less\" scoped>\r\n@import \"./components/node-options\";\r\n.node-icon{\r\n  display: block;\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 6px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :iconName=\"node.node_icon_name\">\r\n         <template #node-icon>\r\n          <img class=\"node-icon\" :src=\"state.mcpInfo.avatar\" alt=\"\">\r\n        </template>\r\n        <template #desc>\r\n          <span>{{ state.toolInfo.description }}</span>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"mcp-form\">\r\n      <div class=\"node-options\">\r\n        <div class=\"options-title\">\r\n          <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\" />{{ t('label_input') }}</div>\r\n        </div>\r\n        <div\r\n          v-for=\"(item, key) in formState.params\"\r\n          :key=\"key\"\r\n          :class=\"['options-item', { 'is-required': item.required }]\"\r\n        >\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ key }}</div>\r\n            <div class=\"option-type\">{{ item.type }}</div>\r\n          </div>\r\n          <div>\r\n            <!--          <a-input v-model:value=\"item.value\" @change=\"update\" placeholder=\"键入/插入变量\"/>-->\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"min-height: 32px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"item.tags\"\r\n              :defaultValue=\"item.value\"\r\n              ref=\"atInputRef\"\r\n              @open=\"getValueVariableList\"\r\n              @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"\r\n              :placeholder=\"t('ph_input_content')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n          </div>\r\n          <div class=\"desc\">{{ item.description }}</div>\r\n        </div>\r\n      </div>\r\n      <div class=\"node-options\">\r\n        <div class=\"options-title\">\r\n          <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\" />{{ t('label_output') }}</div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_output_text') }}</div>\r\n          </div>\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">text</div>\r\n            <div class=\"option-type\">string</div>\r\n          </div>\r\n          <div class=\"desc\">{{ t('msg_tool_generated_content') }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { jsonDecode } from '@/utils/index'\r\nimport { getTMcpProviderInfo } from '@/api/robot/thirdMcp.js'\r\nimport { ref, reactive, inject, onMounted, computed } from 'vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.mcp-form')\r\nconst getNode = inject('getNode')\r\nconst setData = inject('setData')\r\n\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\nconst state = reactive({\r\n  mcpInfo: {},\r\n  toolInfo: {}\r\n})\r\n\r\nconst formState = reactive({\r\n  params: {},\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst nodeParams = reactive({\r\n  mcp: {}\r\n})\r\n\r\nfunction init() {\r\n  getValueVariableList();\r\n\r\n  const np = JSON.parse(props.node.node_params)\r\n  Object.assign(nodeParams, np)\r\n\r\n  loadProvider()\r\n}\r\n\r\nfunction getValueVariableList() {\r\n  variableOptions.value = getNode().getAllParentVariable()\r\n}\r\n\r\nfunction changeValue(item, text, selectedList){\r\n  item.value = text;\r\n  item.tags = selectedList\r\n\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  let data = {\r\n    arguments: {},\r\n    tag_map: {}\r\n  }\r\n\r\n  for (let key in formState.params) {\r\n    let value = formState.params[key].value\r\n    let field = state.toolInfo.inputSchema.properties[key] || {}\r\n\r\n    if(field.type == 'string'){\r\n      value = String(value)\r\n    }else if(['number', 'integer'].includes(field.type)){\r\n      value = Number(value)\r\n    }\r\n\r\n    data.arguments[key] = value\r\n    data.tag_map[key] = formState.params[key].tags\r\n  }\r\n\r\n  nodeParams.mcp.arguments = data.arguments\r\n  nodeParams.mcp.tag_map = data.tag_map || []\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nconst loadProvider = () => {\r\n  getTMcpProviderInfo({\r\n    provider_id: nodeParams.mcp.provider_id\r\n  }).then((res) => {\r\n    state.mcpInfo = res?.data || {}\r\n\r\n    let tools = jsonDecode(state.mcpInfo?.tools, [])\r\n\r\n    state.toolInfo = tools.find((item) => item.name == nodeParams.mcp.tool_name)\r\n\r\n    let inputSchema = state.toolInfo.inputSchema || {}\r\n    let params = inputSchema?.properties || {}\r\n    let requireds = inputSchema?.required || []\r\n\r\n    params = JSON.parse(JSON.stringify(params))\r\n\r\n    for (let key in params) {\r\n      params[key].value = String(nodeParams.mcp.arguments[key] || '')\r\n      params[key].tags = nodeParams.mcp.tag_map ? nodeParams.mcp.tag_map[key] : []\r\n      params[key].required = requireds.includes(key)\r\n    }\r\n\r\n    formState.params = params\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cg%20clip-path='url(%2331gmof37u__clip0_10933_119689)'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M4.33325%2011.6719H2.33325V13.6719'/%3e%3cpath%20d='M13.6667%2013.6719H11.6667V11.6719'/%3e%3cpath%20d='M11.6667%204.32813H13.6667V2.32812'/%3e%3cpath%20d='M2.33325%202.32812H4.33325V4.32813'/%3e%3cpath%20d='M4.33325%202.42969C2.52585%203.62217%201.33325%205.67097%201.33325%207.99834C1.33325%208.3382%201.35869%208.67214%201.40775%208.99834'/%3e%3cpath%20d='M9.00005%2014.5974C8.67385%2014.6464%208.33991%2014.6719%208.00005%2014.6719C5.67268%2014.6719%203.62388%2013.4793%202.4314%2011.6719'/%3e%3cpath%20d='M14.5922%207C14.6413%207.3262%2014.6667%207.66013%2014.6667%208C14.6667%2010.3274%2013.4741%2012.3762%2011.6667%2013.5687'/%3e%3cpath%20d='M7%201.40262C7.3262%201.35356%207.66013%201.32812%208%201.32812C10.3274%201.32812%2012.3762%202.52072%2013.5687%204.32813'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='31gmof37u__clip0_10933_119689'%3e%3cpath%20fill='%23fff'%20d='M0%200H16V16H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_12353_121923)'%3e%3cpath%20d='M3.99992%201.33594H1.33325V4.0026H3.99992V1.33594Z'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linejoin='round'/%3e%3cpath%20d='M14.6667%2012H12V14.6667H14.6667V12Z'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linejoin='round'/%3e%3cpath%20d='M3.99992%2012H1.33325V14.6667H3.99992V12Z'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linejoin='round'/%3e%3cpath%20d='M14.6667%201.33594H12V4.0026H14.6667V1.33594Z'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linejoin='round'/%3e%3cpath%20d='M2.66675%2012V4'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M13.3333%2012V4'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M4%202.66406H12'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M4%2013.3359H12'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.33325%205.33594H8.53325V7.46927H10.6666V10.6693H7.46659V8.53594H5.33325V5.33594Z'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_12353_121923'%3e%3crect%20width='16'%20height='16'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2010.3307H12.6667V1.66406'%20stroke='%23091E41'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9.99992%207H3.33325V14.3333'%20stroke='%23091E41'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M14.6667%203.66406L12.6667%201.66406L10.6667%203.66406'%20stroke='%23091E41'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M5.33325%2012.3359L3.33325%2014.3359L1.33325%2012.3359'%20stroke='%23091E41'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1.7002%207.99609L11%207.99609'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M5.6665%2012L1.6665%208L5.6665%204'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1.7002%207.99609L11%207.99609'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M5.6665%2012L1.6665%208L5.6665%204'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","<template>\r\n  <div class=\"preview-img-box\">\r\n    <a-carousel arrows :dots=\"false\">\r\n      <template #prevArrow>\r\n        <div class=\"custom-slick-arrow\" style=\"left: 10px; z-index: 1\">\r\n          <LeftCircleOutlined />\r\n        </div>\r\n      </template>\r\n      <template #nextArrow>\r\n        <div class=\"custom-slick-arrow\" style=\"right: 10px\">\r\n          <RightCircleOutlined />\r\n        </div>\r\n      </template>\r\n      <div class=\"img-list-item\" v-for=\"(item, index) in props.currentImageList\" :key=\"item\">\r\n        <img @click=\"handleShowImg(index)\" :src=\"item\" alt=\"\" />\r\n      </div>\r\n    </a-carousel>\r\n    <div style=\"display: none\">\r\n      <a-image-preview-group\r\n        :preview=\"{ visible, current, onVisibleChange: (vis) => (visible = vis) }\"\r\n      >\r\n        <a-image v-for=\"item in props.currentImageList\" :key=\"item\" :src=\"item\" />\r\n      </a-image-preview-group>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { LeftCircleOutlined, RightCircleOutlined } from '@ant-design/icons-vue'\r\nimport { ref } from 'vue'\r\n\r\nconst props = defineProps({\r\n  currentImageList: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst visible = ref(false)\r\nconst current = ref(0)\r\n\r\nconst handleShowImg = (index) => {\r\n  current.value = index\r\n  visible.value = true\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.preview-img-box {\r\n  &::v-deep(.ant-carousel) {\r\n    .slick-slide {\r\n      text-align: center;\r\n      height: 220px;\r\n    }\r\n\r\n    .slick-arrow.custom-slick-arrow {\r\n      width: 25px;\r\n      height: 25px;\r\n      font-size: 25px;\r\n      color: #fff;\r\n      background-color: rgba(31, 45, 61, 0.11);\r\n      transition: ease all 0.3s;\r\n      opacity: 0.3;\r\n      z-index: 1;\r\n    }\r\n    .slick-arrow.custom-slick-arrow:before {\r\n      display: none;\r\n    }\r\n    .slick-arrow.custom-slick-arrow:hover {\r\n      color: #fff;\r\n      opacity: 0.5;\r\n    }\r\n\r\n    .slick-slide .img-list-item {\r\n      color: #fff;\r\n      width: 100%;\r\n      height: 100%;\r\n      img {\r\n        width: 100%;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <!-- <a-button @click=\"handleOpenTestModal\" style=\"background-color: #00ad3a\" type=\"primary\"\r\n      ><CaretRightOutlined />运行测试</a-button\r\n    > -->\r\n    <a-modal\r\n      v-model:open=\"show\"\r\n      :footer=\"null\"\r\n      :width=\"820\"\r\n      wrapClassName=\"no-padding-modal\"\r\n    >\r\n\r\n      <template #title>\r\n        <div class=\"modal-title-block\">{{ t('btn_run_test') }}\r\n          <div class=\"run-detail\" v-if=\"resultList.length\">\r\n            <span>{{ t('label_total_time') }}{{ formatTime(use_mills) }}</span>\r\n            <span>{{ t('label_token_consumption') }}{{ use_token }} {{ t('unit_tokens') }}</span>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <div class=\"flex-content-box\">\r\n        <div class=\"test-model-box\">\r\n          <div class=\"top-title\">{{ t('title_start_node_params') }}</div>\r\n          <a-form\r\n            :model=\"formState\"\r\n            ref=\"formRef\"\r\n            layout=\"vertical\"\r\n            :wrapper-col=\"{ span: 24 }\"\r\n            autocomplete=\"off\"\r\n          >\r\n            <a-form-item\r\n              v-if=\"is_need_question\"\r\n              name=\"question\"\r\n              :rules=\"[{ required: true, message: t('msg_input_question') }]\"\r\n            >\r\n              <template #label>\r\n                <a-flex :gap=\"4\">question <a-tag style=\"margin: 0\">string</a-tag> </a-flex>\r\n              </template>\r\n              <a-input :placeholder=\"t('ph_input')\" v-model:value=\"formState.question\" />\r\n            </a-form-item>\r\n            <a-form-item name=\"openid\" :rules=\"[{ required: true, message: t('msg_input_openid') }]\" v-if=\"is_need_openid \">\r\n              <template #label>\r\n                <a-flex :gap=\"4\">openid <a-tag style=\"margin: 0\">string</a-tag> </a-flex>\r\n              </template>\r\n              <a-input :placeholder=\"t('ph_input')\" v-model:value=\"formState.openid\" />\r\n            </a-form-item>\r\n            <a-form-item\r\n              v-for=\"item in loop_test_params\"\r\n              :key=\"item.node_key\"\r\n              :rules=\"[{ required: item.field.required, message: t('msg_input_field', { field: item.node_name }) }]\"\r\n            >\r\n              <template #label>\r\n                <a-flex :gap=\"4\"\r\n                  >{{ item.node_name }} {{ formatStr(item)\r\n                  }}<a-tag style=\"margin: 0\">{{ item.field.typ }}</a-tag>\r\n                </a-flex>\r\n              </template>\r\n              <template v-if=\"item.field.typ == 'string'\">\r\n                <a-input :placeholder=\"t('ph_input')\" v-model:value=\"item.field.Vals\" />\r\n              </template>\r\n              <template v-if=\"item.field.typ == 'number'\">\r\n                <a-input-number\r\n                  style=\"width: 100%\"\r\n                  :placeholder=\"t('ph_input')\"\r\n                  v-model:value=\"item.field.Vals\"\r\n                />\r\n              </template>\r\n              <template v-if=\"item.field.typ.includes('array')\">\r\n                <div class=\"input-list-box\">\r\n                  <div class=\"input-list-item\" v-for=\"(input, i) in item.field.Vals\" :key=\"i\">\r\n                    <a-form-item-rest\r\n                      ><a-input :placeholder=\"t('ph_input')\" v-model:value=\"input.value\"\r\n                    /></a-form-item-rest>\r\n\r\n                    <CloseCircleOutlined\r\n                      v-if=\"item.field.Vals.length > 1\"\r\n                      @click=\"handleDelItem(item.field.Vals, i)\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"add-btn-box\">\r\n                    <a-button @click=\"handleAddItem(item.field.Vals)\" block type=\"dashed\"\r\n                      >{{ t('btn_add') }}</a-button\r\n                    >\r\n                  </div>\r\n                </div>\r\n              </template>\r\n            </a-form-item>\r\n          </a-form>\r\n\r\n          <div class=\"result-list-box loading-box\" v-if=\"loading\">\r\n            <a-spin v-if=\"loading\" :tip=\"t('msg_test_generating')\" />\r\n          </div>\r\n\r\n          <div class=\"result-list-box\" v-if=\"resultList.length > 0\">\r\n            <div\r\n              class=\"list-item-block\"\r\n              :class=\"{ active: currentNodeKey == item.node_key }\"\r\n              v-for=\"(item, index) in resultList\"\r\n              @click=\"handleChangeNodeKey(item)\"\r\n              :key=\"index\"\r\n            >\r\n              <div class=\"status-block\">\r\n                <CheckCircleFilled v-if=\"item.is_success\" style=\"color: #138b1b\" />\r\n                <CloseCircleFilled v-else style=\"color: #d81e06\" />\r\n              </div>\r\n              <div class=\"icon-name-box\">\r\n                <img :src=\"item.node_icon\" alt=\"\" />\r\n                <div class=\"node-name\">{{ item.node_name }}</div>\r\n              </div>\r\n              <div class=\"time-tag\" v-if=\"item.is_success\">{{ item.use_time }}ms</div>\r\n              <div class=\"right-active-icon\"><RightCircleOutlined /></div>\r\n              <!-- <div class=\"out-put-box\" v-if=\"item.is_success\">\r\n                <a-tooltip>\r\n                  <template #title>{{ item.output }}</template>\r\n                  <div class=\"out-text-box\">{{ item.output }}</div>\r\n                </a-tooltip>\r\n              </div> -->\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"save-btn-box\">\r\n            <a-button\r\n              :loading=\"loading\"\r\n              @click=\"handleSubmit\"\r\n              style=\"background-color: #00ad3a\"\r\n              type=\"primary\"\r\n              ><CaretRightOutlined />{{ t('btn_run_test') }}</a-button\r\n            >\r\n          </div>\r\n        </div>\r\n        <div class=\"preview-box\">\r\n          <template v-if=\"cuttentItem\">\r\n            <div class=\"preview-title\">\r\n              <div class=\"title-text\">{{ t('title_log_details') }}</div>\r\n              <div class=\"icon-name-box\">\r\n                <img :src=\"cuttentItem.node_icon\" alt=\"\" />\r\n                <div class=\"node-name\">{{ cuttentItem.node_name }}</div>\r\n              </div>\r\n              <div class=\"time-tag\" v-if=\"cuttentItem.is_success\">{{ cuttentItem.use_time }}ms</div>\r\n            </div>\r\n            <div class=\"preview-content-block\" v-if=\"currentImageList.length > 0\">\r\n              <div class=\"title-block\">{{ t('title_generated_image_logs') }}</div>\r\n              <div class=\"preview-img-box\">\r\n                <ImageLogs :currentImageList=\"currentImageList\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('title_input') }}<CopyOutlined @click=\"handleCopy('input')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.input\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('title_output') }}<CopyOutlined @click=\"handleCopy('node_output')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.node_output\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('title_run_log') }}<CopyOutlined @click=\"handleCopy('output')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.output\" />\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  CaretRightOutlined,\r\n  CheckCircleFilled,\r\n  CloseCircleFilled,\r\n  CloseCircleOutlined,\r\n  RightCircleOutlined,\r\n  CopyOutlined\r\n} from '@ant-design/icons-vue'\r\nimport VueJsonPretty from 'vue-json-pretty'\r\nimport 'vue-json-pretty/lib/styles.css'\r\nimport { reactive, ref, computed, nextTick } from 'vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { callLoopWorkFlow, callLoopWorkFlowParams } from '@/api/robot/index'\r\nimport { getImageUrl, formatTime } from '../../../util'\r\nimport { message } from 'ant-design-vue'\r\nimport { copyText } from '@/utils/index'\r\nimport ImageLogs from '@/views/workflow/components/image-logs/index.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.custom-group-node.components.run-test')\r\nconst robotStore = useRobotStore()\r\n\r\nconst isLockedByOther = computed(() => {\r\n  return robotStore.robotInfo.isLockedByOther\r\n})\r\n\r\nconst props = defineProps({\r\n  loop_node_key: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n})\r\nconst diy_global = computed(() => {\r\n  return []\r\n})\r\n\r\nconst emit = defineEmits(['save'])\r\n\r\nconst show = ref(false)\r\nconst currentNodeKey = ref('')\r\nconst resultList = ref([])\r\n\r\nconst cuttentItem = computed(() => {\r\n  if (!currentNodeKey.value) {\r\n    return null\r\n  }\r\n  return resultList.value.filter((item) => item.node_key == currentNodeKey.value)[0]\r\n})\r\n\r\nconst currentImageList = computed(()=>{\r\n  let list = []\r\n  if(cuttentItem.value && cuttentItem.value.node_type == 33){\r\n    let output = cuttentItem.value.output\r\n    for(let key in output){\r\n      if(key.includes('picture_url_')){\r\n        list.push(output[key])\r\n      }\r\n    }\r\n  }\r\n  return list\r\n})\r\n\r\nconst loading = ref(false)\r\n\r\nconst formState = reactive({\r\n  is_draft: true,\r\n  robot_key: robotStore.robotInfo.robot_key,\r\n  question: '',\r\n  openid: ''\r\n})\r\n\r\nconst handleOpenTestModal = async () => {\r\n  if (isLockedByOther.value) {\r\n    message.warning(t('msg_locked_by_other'))\r\n    return\r\n  }\r\n  robotStore.robotInfo.loop_save_canvas_status++ // 触发保存草稿操作\r\n\r\n  await nextTick()\r\n\r\n  let localData = localStorage.getItem('workflow_loop_run_test_data') || '{}'\r\n\r\n  localData = JSON.parse(localData)\r\n\r\n  formState.question = localData.question || ''\r\n  formState.openid = localData.openid || ''\r\n  formState.global = localData.global || ''\r\n\r\n  resultList.value = []\r\n  currentNodeKey.value = ''\r\n  setTimeout(() => {\r\n    getFieldLists()\r\n  }, 1000)\r\n  show.value = true\r\n}\r\n\r\nconst loop_test_params = ref([])\r\nconst is_need_question = ref(false)\r\nconst is_need_openid = ref(false)\r\n\r\nconst getFieldLists = () => {\r\n  callLoopWorkFlowParams({\r\n    robot_key: formState.robot_key,\r\n    loop_node_key: props.loop_node_key,\r\n  }).then((res) => {\r\n    is_need_question.value = res.data.is_need_question\r\n    is_need_openid.value = res.data.is_need_openid\r\n    \r\n    if (!is_need_question.value) {\r\n      formState.question = ''\r\n    }\r\n    loop_test_params.value = res.data.loop_test_params.map((item) => {\r\n      return {\r\n        ...item,\r\n        field: {\r\n          ...item.field,\r\n          Vals: setGlobalDefaultVal(item.field)\r\n        }\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction setGlobalDefaultVal(item) {\r\n  if (item.typ == 'string' || item.typ == 'number') {\r\n    return ''\r\n  }\r\n  return [\r\n    {\r\n      value: '',\r\n      key: Math.random() * 10000\r\n    }\r\n  ]\r\n}\r\n\r\nconst handleDelItem = (item, index) => {\r\n  item.splice(index, 1)\r\n}\r\nconst handleAddItem = (item) => {\r\n  item.push({\r\n    value: '',\r\n    key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst formRef = ref(null)\r\n\r\nconst use_token = ref(0)\r\nconst use_mills = ref(0)\r\n\r\nconst handleSubmit = () => {\r\n  formRef.value.validate().then(() => {\r\n    let postData = { ...formState, loop_node_key: props.loop_node_key }\r\n    let loop_test_params_data = JSON.parse(JSON.stringify(loop_test_params.value))\r\n\r\n    loop_test_params_data.forEach((item) => {\r\n      if (item.field.typ.includes('array')) {\r\n        item.field.Vals = item.field.Vals.map((it) => it.value)\r\n      }\r\n    })\r\n\r\n    postData.loop_test_params = JSON.stringify(loop_test_params_data)\r\n\r\n    loading.value = true\r\n    resultList.value = []\r\n    localStorage.setItem('workflow_loop_run_test_data', JSON.stringify({ ...postData }))\r\n    callLoopWorkFlow({\r\n      ...postData\r\n    })\r\n      .then((res) => {\r\n        message.success(t('msg_test_completed'))\r\n\r\n        let node_logs = res.data.node_logs || []\r\n        use_token.value = res.data.use_token\r\n        use_mills.value = res.data.use_mills\r\n        formateData(node_logs)\r\n      })\r\n      .catch((res) => {\r\n        resultList.value = []\r\n        let node_logs = res.data.node_logs || []\r\n        if (node_logs && node_logs.length) {\r\n          formateData(node_logs)\r\n        }\r\n      })\r\n      .finally(() => {\r\n        loading.value = false\r\n      })\r\n  })\r\n}\r\n\r\nconst formateData = (data) => {\r\n  resultList.value = data.map((item) => {\r\n    return {\r\n      ...item,\r\n      is_success: item.error_msg === '<nil>',\r\n      node_icon: getImageUrl(item.node_type)\r\n    }\r\n  })\r\n  currentNodeKey.value = resultList.value[0]?.node_key\r\n}\r\n\r\nconst handleChangeNodeKey = (item) => {\r\n  currentNodeKey.value = item.node_key\r\n}\r\n\r\nconst handleCopy = (key) => {\r\n  copyText(JSON.stringify(cuttentItem.value[key]))\r\n  message.success(t('msg_copy_success'))\r\n}\r\n\r\nfunction formatStr(item) {\r\n  return item.field.key.replace(item.node_key + '.', '')\r\n}\r\n\r\nconst open = () => {\r\n  handleOpenTestModal()\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.flex-content-box {\r\n  display: flex;\r\n  max-height: 600px;\r\n  overflow: hidden;\r\n}\r\n.test-model-box {\r\n  flex: 1;\r\n  margin: 24px 0 0 0;\r\n  padding-right: 16px;\r\n  overflow-y: auto;\r\n  .top-title {\r\n    font-weight: 600;\r\n    margin-bottom: 16px;\r\n  }\r\n  .save-btn-box {\r\n    margin: 32px 0;\r\n    margin-top: 50px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n.tooltip-content {\r\n  white-space: pre-wrap;\r\n}\r\n.loading-box {\r\n  height: 100px;\r\n  justify-content: center;\r\n}\r\n.result-list-box {\r\n  margin: 24px 0;\r\n  width: 100%;\r\n  border: 1px solid #ebebeb;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 8px;\r\n  .list-item-block {\r\n    display: flex;\r\n    align-items: center;\r\n    overflow: hidden;\r\n    gap: 8px;\r\n    padding: 8px;\r\n    color: #333;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\r\n    .right-active-icon {\r\n      margin-left: auto;\r\n      color: #2475fc;\r\n      opacity: 0;\r\n    }\r\n    &:hover {\r\n      background: #f2f4f7;\r\n      .right-active-icon {\r\n        opacity: 1;\r\n      }\r\n    }\r\n    &.active {\r\n      color: #2475fc;\r\n      background: #e6efff;\r\n      .right-active-icon {\r\n        opacity: 0;\r\n      }\r\n    }\r\n    .status-block {\r\n      font-size: 20px;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      font-weight: 600;\r\n      img {\r\n        width: 24px;\r\n        height: 24px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n    .out-put-box {\r\n      flex: 1;\r\n      margin-left: 24px;\r\n      overflow: hidden;\r\n      .out-text-box {\r\n        background: #f2f2f2;\r\n        border-radius: 6px;\r\n        padding: 8px;\r\n        width: 100%;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.input-list-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  .input-list-item {\r\n    display: flex;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n.preview-box {\r\n  flex: 1;\r\n  border-left: 1px solid #d9d9d9;\r\n  padding: 16px;\r\n  overflow-y: auto;\r\n  .preview-title {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    .title-text {\r\n      font-size: 15px;\r\n      font-weight: 600;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      margin-left: 12px;\r\n      img {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n  .preview-content-block {\r\n    margin-top: 16px;\r\n    .title-block {\r\n      font-size: 15px;\r\n      color: #262626;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      .anticon-copy {\r\n        cursor: pointer;\r\n        &:hover {\r\n          color: #2475fc;\r\n        }\r\n      }\r\n    }\r\n    .preview-code-box {\r\n      width: fit-content;\r\n      min-width: 100%;\r\n      margin-top: 16px;\r\n      padding: 8px;\r\n      border-radius: 8px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &::v-deep(.vjs-tree) {\r\n        width: fit-content;\r\n      }\r\n\r\n      &::v-deep(.vjs-tree-node) {\r\n        width: calc(100% + 16px);\r\n        padding-right: 16px;\r\n      }\r\n    }\r\n  }\r\n}\r\n.modal-title-block{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  .run-detail{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 16px;\r\n    background: #BFFBD7;\r\n    padding: 4px 16px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n    border-radius: 8px;\r\n  }\r\n}\r\n\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_custom_group')\"\r\n        @close=\"handleClose\"\r\n      >\r\n        <template #runBtn>\r\n          <a-tooltip>\r\n            <template #title>{{ t('tooltip_run_test') }}</template>\r\n            <div class=\"action-btn\" @click=\"handleOpenTestModal\">\r\n              <CaretRightOutlined style=\"color: rgb(0, 173, 58)\" />\r\n            </div>\r\n          </a-tooltip>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/loop-icon.svg\" alt=\"\" />\r\n              {{ t('label_loop_settings') }}\r\n              <a-tooltip>\r\n                <template #title>{{ t('tip_loop_settings') }}</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n            <div class=\"flex-form-item\">\r\n              <div class=\"form-label\">{{ t('label_loop_type') }}</div>\r\n              <a-select v-model:value=\"formState.loop_type\" style=\"width: 170px\">\r\n                <a-select-option value=\"array\">{{ t('label_use_array') }}</a-select-option>\r\n                <a-select-option value=\"number\">{{ t('label_specify_count') }}</a-select-option>\r\n              </a-select>\r\n              <a-input-number\r\n                :placeholder=\"t('ph_input')\"\r\n                v-if=\"formState.loop_type == 'number'\"\r\n                style=\"flex: 1\"\r\n                v-model:value=\"formState.loop_number\"\r\n                :min=\"1\"\r\n                :max=\"100\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div class=\"gray-block\" v-if=\"formState.loop_type == 'array'\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/loop-2.svg\" alt=\"\" />\r\n              {{ t('label_loop_array') }}\r\n              <a-tooltip>\r\n                <template #title>{{ t('tip_loop_array') }}</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\">{{ t('label_type') }}</div>\r\n                <div class=\"output-item\" style=\"flex: 1\">{{ t('label_param_value') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\">\r\n                <div\r\n                  class=\"form-item-list\"\r\n                  v-for=\"(item, index) in formState.loop_arrays\"\r\n                  :key=\"item.cu_key\"\r\n                >\r\n                  <a-form-item :label=\"null\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 25%\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 25%\"\r\n                          v-model:value=\"item.typ\"\r\n                          placeholder=\"\"\r\n                          readonly\r\n                        ></a-input>\r\n                        <a-cascader\r\n                          v-model:value=\"item.value\"\r\n                          @change=\"(val, selectedOptions) => handleLoopArrChange(val, item, selectedOptions)\"\r\n                          @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                          style=\"width: 50%\"\r\n                          :options=\"loopArraysOptions\"\r\n                          :allowClear=\"false\"\r\n                          :displayRender=\"({ labels }) => labels.join('/')\"\r\n                          :field-names=\"{ children: 'children' }\"\r\n                          :placeholder=\"t('ph_select')\"\r\n                        />\r\n                      </a-form-item-rest>\r\n                      <div class=\"btn-hover-wrap\" v-if=\"false\" @click=\"onDelLoopArrays(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button\r\n                  v-if=\"formState.loop_arrays.length == 0\"\r\n                  @click=\"handleAddLoopArrays\"\r\n                  :icon=\"h(PlusOutlined)\"\r\n                  block\r\n                  type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/loop-3.svg\" alt=\"\" />\r\n              {{ t('label_intermediate_variable') }}\r\n              <a-tooltip>\r\n                <template #title>{{ t('tip_intermediate_variable') }}</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\" style=\"margin-left: 4px;\">{{ t('label_type') }}</div>\r\n                <div class=\"output-item\" style=\"flex: 1\">{{ t('label_param_value') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\">\r\n                <div\r\n                  class=\"form-item-list\"\r\n                  v-for=\"(item, index) in formState.intermediate_params\"\r\n                  :key=\"item.cu_key\"\r\n                >\r\n                  <a-form-item :label=\"null\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 25%\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-select v-model:value=\"item.typ\" :placeholder=\"t('ph_select')\" style=\"width: 25%\">\r\n                          <a-select-option\r\n                            v-for=\"op in typOptions\"\r\n                            :value=\"op.value\"\r\n                            :key=\"op.value\"\r\n                            >{{ op.value }}</a-select-option\r\n                          >\r\n                        </a-select>\r\n                        <div style=\"width: 40%\">\r\n                          <at-input\r\n                            inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                            :ref=\"(el) => setAtInputRef(el, 'intermediate_params', index)\"\r\n                            :options=\"variableOptions\"\r\n                            :defaultSelectedList=\"item.tags\"\r\n                            :defaultValue=\"item.value\"\r\n                            @open=\"getVlaueVariableList\"\r\n                            @change=\"\r\n                              (text, selectedList) => changeValue(text, selectedList, item, index)\r\n                            \"\r\n                            :placeholder=\"t('ph_input_variable_value')\"\r\n                          >\r\n                            <template #option=\"{ label, payload }\">\r\n                              <div class=\"field-list-item\">\r\n                                <div class=\"field-label\">{{ label }}</div>\r\n                                <div class=\"field-type\">{{ payload.typ }}</div>\r\n                              </div>\r\n                            </template>\r\n                          </at-input>\r\n                        </div>\r\n                      </a-form-item-rest>\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelIntermediateParams(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button\r\n                  @click=\"handleAddIntermediateParams\"\r\n                  :icon=\"h(PlusOutlined)\"\r\n                  block\r\n                  type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/output.svg\" alt=\"\" />\r\n              {{ t('label_output') }}\r\n              <a-tooltip>\r\n                <template #title>{{ t('tip_output') }}</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\" style=\"margin-left: 4px;\">{{ t('label_type') }}</div>\r\n                <div class=\"output-item\" style=\"width: 38%\">{{ t('label_param_value') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\">\r\n                <div\r\n                  class=\"form-item-list\"\r\n                  v-for=\"(item, index) in formState.output\"\r\n                  :key=\"item.cu_key\"\r\n                >\r\n                  <a-form-item :label=\"null\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 25%\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 25%\"\r\n                          v-model:value=\"item.typ\"\r\n                          placeholder=\"\"\r\n                          readonly\r\n                        ></a-input>\r\n                        <a-cascader\r\n                          @change=\"(val) => handleOutputArrChange(val, item)\"\r\n                          v-model:value=\"item.value\"\r\n                          @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                          style=\"width: 40%\"\r\n                          :options=\"outputOptions\"\r\n                          :allowClear=\"false\"\r\n                          :displayRender=\"({ labels }) => labels.join('/')\"\r\n                          :field-names=\"{ children: 'children' }\"\r\n                          :placeholder=\"t('ph_select')\"\r\n                        />\r\n                      </a-form-item-rest>\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelOutputArrays(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button\r\n                  @click.stop=\"handleAddOutputArrays\"\r\n                  :icon=\"h(PlusOutlined)\"\r\n                  block\r\n                  type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n    <RunTest :loop_node_key=\"nodeId\" ref=\"runTestRef\" />\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, h, onMounted, inject, computed } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  PlusOutlined,\r\n  QuestionCircleOutlined,\r\n  CaretRightOutlined\r\n} from '@ant-design/icons-vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport RunTest from '../../nodes/custom-group-node/components/run-test.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.custom-group-node.custom-group-node-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst loopArraysOptions = ref([])\r\n\r\nconst outputArrarysOptions = ref([])\r\nconst runTestRef = ref(null)\r\nconst atInputRefs = reactive({})\r\n\r\nconst handleOpenTestModal = () => {\r\n  runTestRef.value.open()\r\n}\r\n\r\nconst setAtInputRef = (el, name, index) => {\r\n  if (el) {\r\n    let key = `at_input_${name}_${index}`\r\n    atInputRefs[key] = el\r\n  }\r\n}\r\n\r\nconst changeValue = (text, selectedList, item) => {\r\n  item.tags = selectedList\r\n  item.value = text\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n  list.forEach((item) => {\r\n    item.tags = item.tags || []\r\n  })\r\n  // 需要当前分组外面的变量\r\n  list = list\r\n    .filter((item) => item.group_node_key != item.loop_parent_key)\r\n    .filter((item) => item.node_id != item.group_node_key)\r\n  variableOptions.value = list\r\n}\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  list = handleOptions(list)\r\n  list = list.filter((item) => item.group_node_key != item.loop_parent_key).filter((item) => item.node_id != item.group_node_key)\r\n  \r\n  loopArraysOptions.value = filterArrayFields(list)\r\n}\r\n\r\nfunction filterArrayFields(list) {\r\n  const filterNodes = (nodes) => {\r\n    if (!nodes || nodes.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    return nodes.map(node => {\r\n      // 递归过滤子节点\r\n      const filteredChildren = filterNodes(node.children);\r\n\r\n      // 检查当前节点是否包含 'array' 类型，或者其子节点过滤后是否还有内容\r\n      if (node.typ.includes('array') || (filteredChildren && filteredChildren.length > 0)) {\r\n        return {\r\n          ...node,\r\n          children: filteredChildren\r\n        };\r\n      }\r\n\r\n      return null;\r\n    }).filter(Boolean); // 过滤掉 null 值\r\n  };\r\n\r\n  return filterNodes(list);\r\n}\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst formRef = ref()\r\n\r\nconst loop_arrays_default = {\r\n  key: '',\r\n  typ: '',\r\n  value: '',\r\n  cu_key: Math.random() * 10000\r\n}\r\n\r\nconst intermediate_params_default = {\r\n  key: '',\r\n  typ: '',\r\n  value: '',\r\n  cu_key: Math.random() * 10000\r\n}\r\n\r\nconst output_default = {\r\n  key: '',\r\n  typ: '',\r\n  value: '',\r\n  cu_key: Math.random() * 10000\r\n}\r\n\r\nconst formState = reactive({\r\n  loop_type: 'array',\r\n  loop_number: '',\r\n  loop_arrays: [],\r\n  intermediate_params: [],\r\n  output: []\r\n})\r\n\r\nconst outputOptions = computed(() => {\r\n  let list = formState.intermediate_params\r\n  let childList = []\r\n  \r\n  list.forEach((item) => {\r\n    if (item.key) {\r\n      childList.push({\r\n        children: [],\r\n        id: props.nodeId,\r\n        key: item.key,\r\n        label: item.key,\r\n        node_id: props.nodeId,\r\n        node_name: props.node.node_name,\r\n        node_type: '25',\r\n        original_value: props.nodeId + '.' + item.key,\r\n        text: item.key,\r\n        typ: item.typ,\r\n        value: item.key\r\n      })\r\n    }\r\n  })\r\n\r\n  if (childList.length > 0) {\r\n    return [\r\n      {\r\n        label: props.node.node_name,\r\n        node_id: props.nodeId,\r\n        node_type: '25',\r\n        typ: 'node',\r\n        value: props.nodeId,\r\n        children: childList\r\n      }\r\n    ]\r\n  }\r\n\r\n  return []\r\n})\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    loop: {\r\n      ...formState,\r\n      loop_arrays: formState.loop_arrays.map((item) => {\r\n        return {\r\n          ...item,\r\n          value: item.value ? item.value.join('.') : ''\r\n        }\r\n      }),\r\n      output: formState.output.map((item) => {\r\n        return {\r\n          ...item,\r\n          value: item.value ? item.value.join('.') : ''\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return []\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let loop = JSON.parse(dataRaw).loop || {}\r\n\r\n    loop = JSON.parse(JSON.stringify(loop))\r\n\r\n    getVlaueVariableList()\r\n    getOptions()\r\n    formState.loop_type = loop.loop_type\r\n    formState.loop_number = loop.loop_number\r\n    formState.loop_arrays = loop.loop_arrays.map((item) => {\r\n      return {\r\n        ...item,\r\n        value: formatQuestionValue(item.value)\r\n      }\r\n    })\r\n    formState.intermediate_params = loop.intermediate_params.map((item) => {\r\n      return {\r\n        ...item\r\n      }\r\n    })\r\n    formState.output = loop.output.map((item) => {\r\n      return {\r\n        ...item,\r\n        value: formatQuestionValue(item.value)\r\n      }\r\n    })\r\n\r\n    if (formState.loop_arrays.length == 0) {\r\n      formState.loop_arrays = [loop_arrays_default]\r\n    }\r\n\r\n    if (formState.intermediate_params.length == 0) {\r\n      formState.intermediate_params = [intermediate_params_default]\r\n    }\r\n    if (formState.output.length == 0) {\r\n      formState.output = [output_default]\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddLoopArrays = () => {\r\n  formState.loop_arrays.push({\r\n    key: '',\r\n    typ: '',\r\n    value: '',\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\nconst onDelLoopArrays = (index) => {\r\n  formState.loop_arrays.splice(index, 1)\r\n}\r\n\r\nconst handleLoopArrChange = (val, item, selectedOptions) => {\r\n  if(selectedOptions){\r\n    item.typ = selectedOptions[selectedOptions.length - 1].typ \r\n  }else{\r\n    item.typ = ''\r\n  }\r\n}\r\n\r\nconst handleAddIntermediateParams = () => {\r\n  formState.intermediate_params.push({\r\n    key: '',\r\n    typ: '',\r\n    value: '',\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\nconst onDelIntermediateParams = (index) => {\r\n  formState.intermediate_params.splice(index, 1)\r\n}\r\n\r\nconst handleAddOutputArrays = () => {\r\n  formState.output.push({\r\n    key: '',\r\n    typ: '',\r\n    value: '',\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\nconst onDelOutputArrays = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst handleOutputArrChange = (val, item) => {\r\n  if (val && val.length) {\r\n    let filterItem1 = outputOptions.value.filter((it) => it.value == val[0])[0].children\r\n    if (filterItem1 && filterItem1.length) {\r\n      item.typ = filterItem1.filter((it) => it.value == val[1])[0].typ\r\n    }\r\n  } else {\r\n    item.typ = ''\r\n  }\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.flex-form-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.gray-block {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.gray-block-title {\r\n  img {\r\n    width: 16px;\r\n    height: 16px;\r\n  }\r\n}\r\n\r\n.at-input-flex1 {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.action-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in;\r\n  margin-left: 8px;\r\n  &:hover {\r\n    background: #e4e6eb;\r\n  }\r\n}\r\n\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 24%;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.library-checkbox-box {\r\n  padding-top: 16px;\r\n\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n\r\n  .list-box {\r\n    display: flex;\r\n    flex-flow: row wrap;\r\n    height: 388px;\r\n    width: 100%;\r\n    overflow-y: auto;\r\n    align-content: flex-start;\r\n    margin: 0 -8px;\r\n\r\n    .list-item-wraapper {\r\n      padding: 8px;\r\n      width: 50%;\r\n    }\r\n\r\n    .list-item {\r\n      width: 100%;\r\n      padding: 14px 12px;\r\n      border: 1px solid #f0f0f0;\r\n      border-radius: 2px;\r\n\r\n      &:hover {\r\n        cursor: pointer;\r\n        box-shadow: 0 4px 16px 0 #1b3a6929;\r\n      }\r\n\r\n      .library-name {\r\n        line-height: 22px;\r\n        font-size: 14px;\r\n        font-weight: 600;\r\n        color: #262626;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n\r\n      .library-desc {\r\n        line-height: 20px;\r\n        margin-top: 2px;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        color: #8c8c8c;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n\r\n    .list-item :deep(span:last-child) {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n\r\n.empty-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  padding-top: 40px;\r\n  padding-bottom: 40px;\r\n  color: #8c8c8c;\r\n\r\n  img {\r\n    width: 150px;\r\n    height: 150px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal width=\"746px\" v-model:open=\"state.show\" :title=\"t('title_relate_data_table')\" @ok=\"handleOk\" :ok-text=\"t('btn_confirm')\" :cancel-text=\"t('btn_cancel')\">\r\n    <div class=\"field-select-box\">\r\n      <div class=\"field-list-box\" v-if=\"fields.length\">\r\n        <a-table rowKey=\"field_name\"\r\n                 :row-selection=\"{ selectedRowKeys: state.selectedRowKeys, onChange: onSelectChange }\"\r\n                 :dataSource=\"fields\"\r\n                 :columns=\"columns\"\r\n                 :loading=\"loading\"\r\n                 :pagination=\"false\"/>\r\n      </div>\r\n      <div class=\"empty-box\" v-if=\"!fields.length\">\r\n        <img src=\"@/assets/img/library/preview/empty.png\" alt=\"\"/>\r\n        <div>{{ t('msg_no_fields_add') }}</div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive} from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.feishu-table.field-selector.field-select-alert')\r\n\r\nconst emit = defineEmits(['ok'])\r\nconst props = defineProps({\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  }\r\n})\r\n\r\nconst loading = ref(false)\r\nconst state = reactive({\r\n  show: false,\r\n  selectedRowKeys: [],\r\n  selectedRows: []\r\n})\r\n\r\nconst columns = ref([\r\n  {\r\n    title: t('label_field_name'),\r\n    dataIndex: 'field_name',\r\n  },\r\n  {\r\n    title: t('label_data_type'),\r\n    dataIndex: 'ui_type',\r\n  },\r\n  // {\r\n  //   title: '字段描述',\r\n  //   dataIndex: 'field_name',\r\n  // }\r\n])\r\n\r\nconst dataSource = ref([])\r\n\r\nconst onSelectChange = (selectedRowKeys, selectedRows) => {\r\n  state.selectedRowKeys = selectedRowKeys;\r\n  state.selectedRows = selectedRows\r\n};\r\n\r\nconst open = ({\r\n                selectedRowKeys,\r\n                selectedRows\r\n              }) => {\r\n  state.selectedRowKeys = selectedRowKeys\r\n  state.selectedRows = selectedRows\r\n  state.show = true\r\n}\r\n\r\nconst openAddLibrary = () => {\r\n  window.open('/#/database/details/field-manage?form_id=' + state.formId)\r\n}\r\n\r\nconst handleOk = () => {\r\n  emit('ok', state.selectedRowKeys, state.selectedRows)\r\n  state.show = false;\r\n}\r\ndefineExpose({\r\n  open\r\n})\r\n</script>","<style lang=\"less\" scoped>\r\n.field-list {\r\n  .field-list-row {\r\n    position: relative;\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    align-items: center;\r\n    margin-bottom: 4px;\r\n\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n\r\n  .field-list-col {\r\n    padding: 0 4px;\r\n  }\r\n\r\n  .field-name-col,\r\n  .field-type-col,\r\n  .field-name-head,\r\n  .field-type-head {\r\n    flex: 1;\r\n  }\r\n\r\n  .field-value-col,\r\n  .field-value-head {\r\n    width: 256px;\r\n  }\r\n\r\n  .field-list-col-head {\r\n    line-height: 22px;\r\n    margin-bottom: 4px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n  }\r\n\r\n  .field-name-col,\r\n  .field-type-col {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n  }\r\n\r\n  .field-del-head,\r\n  .field-del-col {\r\n    width: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  .field-del-col {\r\n    text-align: right;\r\n\r\n    .del-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 16px;\r\n      height: 16px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n}\r\n\r\n.add-btn-box {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div>\r\n    <div class=\"field-list\">\r\n      <div class=\"field-list-row\">\r\n        <div class=\"field-list-col field-list-col-head field-name-head\">{{ t('label_field_name') }}</div>\r\n        <div class=\"field-list-col field-list-col-head field-type-head\">{{ t('label_type') }}</div>\r\n        <div class=\"field-list-col field-list-col-head field-value-head\" v-if=\"showInput\">{{ t('label_field_value') }}</div>\r\n        <div\r\n          class=\"field-list-col field-list-col-head field-del-head\"\r\n          v-if=\"props.showDelete\"\r\n        ></div>\r\n      </div>\r\n\r\n      <div class=\"field-list-row\" v-if=\"showEmptyFieldRow\">\r\n        <div class=\"field-list-col field-name-col\">--</div>\r\n        <div class=\"field-list-col field-type-col\">--</div>\r\n        <div class=\"field-list-col field-value-col\">\r\n          <a-tooltip :title=\"t('ph_select_database_first')\">\r\n            <a-input :disabled=\"true\" :placeholder=\"t('ph_input_value_variable')\"/>\r\n          </a-tooltip>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"field-list-row\" v-for=\"(item, index) in state.list\" :key=\"item.field_name\">\r\n        <div class=\"field-list-col field-name-col\">{{ item.field_name }}</div>\r\n        <div class=\"field-list-col field-type-col\">{{ item.ui_type || fieldMap[item.field_name]?.ui_type }}</div>\r\n        <div class=\"field-list-col field-value-col\" v-if=\"showInput\">\r\n<!--          <a-checkbox v-if=\"item.ui_type === 'Checkbox'\" v-model:checked=\"item.value\"/>-->\r\n<!--          <a-select-->\r\n<!--            v-else-if=\"item.ui_type === 'SingleSelect'\"-->\r\n<!--            :placeholder=\"t('ph_select')\"-->\r\n<!--            v-model:value=\"item.value\"-->\r\n<!--            style=\"width: 100%;\"-->\r\n<!--          >-->\r\n<!--            <a-select-option v-for=\"opt in item.property.options\" :value=\"opt.id\" :key=\"opt.id\">{{opt.name}}</a-select-option>-->\r\n<!--          </a-select>-->\r\n<!--          <a-select-->\r\n<!--            v-else-if=\"item.ui_type === 'MultiSelect'\"-->\r\n<!--            :placeholder=\"请选择（多选）\"-->\r\n<!--            v-model:value=\"item.value\"-->\r\n<!--            style=\"width: 100%;\"-->\r\n<!--            mode=\"multiple\"-->\r\n<!--          >-->\r\n<!--            <a-select-option v-for=\"opt in item.property.options\" :value=\"opt.id\" :key=\"opt.id\">{{opt.name}}</a-select-option>-->\r\n<!--          </a-select>-->\r\n          <AtInput\r\n            :options=\"atInputOptions\"\r\n            :defaultValue=\"item.value\"\r\n            :defaultSelectedList=\"item.atTags\"\r\n            @open=\"showAtList\"\r\n            @change=\"(text, selectedList) => changeAtInputValue(text, selectedList, item, index)\"\r\n            :placeholder=\"formatPlaceholder(item)\"/>\r\n        </div>\r\n        <div class=\"field-list-col field-del-col\" v-if=\"props.showDelete\">\r\n          <span class=\"del-btn\" @click=\"handleDel(index)\">\r\n            <svg-icon class=\"del-icon\" name=\"close-circle\"></svg-icon>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"add-btn-box\" v-if=\"props.showAdd\">\r\n      <a-button class=\"add-btn\" type=\"dashed\" block @click=\"handleAddField\">\r\n        <PlusOutlined/>\r\n        {{ t('btn_add_field') }}\r\n      </a-button>\r\n    </div>\r\n\r\n    <FieldSelectAlert ref=\"fieldSelectAlertRef\" :fields=\"fields\" @ok=\"onChangeSelect\"/>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, watch, inject, onMounted, computed} from 'vue'\r\nimport {PlusOutlined} from '@ant-design/icons-vue'\r\nimport FieldSelectAlert from './field-select-alert.vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.feishu-table.field-selector.index')\r\n\r\nconst emit = defineEmits(['change'])\r\n\r\nconst props = defineProps({\r\n  showAdd: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  showDelete: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showInput: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showEmptyFieldRow: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  },\r\n  list: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst state = reactive({\r\n  list: [],\r\n  keys: [],\r\n})\r\n\r\nconst fieldMap = computed(() => {\r\n  return Object.fromEntries(\r\n    props.fields.map(item => [item.field_name, item])\r\n  )\r\n})\r\n\r\nwatch(() => props.list, (newVal) => {\r\n  state.list = newVal\r\n  state.keys = newVal.map(i => i.field_name)\r\n}, {\r\n  immediate: true\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable();\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst showAtList = () => {\r\n  getAtInputOptions()\r\n}\r\n\r\nconst changeAtInputValue = (text, selectedList, item, index) => {\r\n  // item.value = text\r\n  state.list[index].value = text\r\n  state.list[index].atTags = selectedList\r\n\r\n  change()\r\n}\r\n\r\n\r\nconst onChangeSelect = (selectedRowKeys, selectedRows) => {\r\n  state.list = [...selectedRows]\r\n  state.keys = [...selectedRowKeys]\r\n  change()\r\n}\r\n\r\nconst handleDel = (index) => {\r\n  state.list.splice(index, 1)\r\n\r\n  change()\r\n}\r\n\r\nconst change = () => {\r\n  emit('change', [...state.list], [...state.keys])\r\n}\r\n\r\nconst fieldSelectAlertRef = ref()\r\n\r\nconst handleAddField = () => {\r\n  fieldSelectAlertRef.value.open({\r\n    selectedRows: props.list,\r\n    selectedRowKeys: props.list.map(item => {\r\n      return item.field_name\r\n    })\r\n  })\r\n}\r\n\r\nconst formatPlaceholder = item => {\r\n  switch (item.ui_type) {\r\n    case 'Checkbox':\r\n      return t('ph_input_true_false')\r\n    case 'MultiSelect':\r\n      return t('ph_input_multi_select')\r\n      break\r\n  }\r\n  return t('ph_input_value_variable')\r\n}\r\n\r\nonMounted(() => {\r\n  getAtInputOptions()\r\n})\r\n</script>","<template>\r\n  <div class=\"_full-input-box\">\r\n    <FullscreenOutlined v-if=\"canFull\" class=\"full-icon\" @click=\"showFull\"/>\r\n    <AtInput\r\n      :type=\"type\"\r\n      :inputStyle=\"inputStyle\"\r\n      :options=\"options\"\r\n      :defaultValue=\"innerValue\"\r\n      :defaultSelectedList=\"innerTags\"\r\n      :placeholder=\"computedPlaceholder\"\r\n      :canRepeat=\"canRepeat\"\r\n      :isContain=\"isContain\"\r\n      :checkAnyLevel=\"checkAnyLevel\"\r\n      ref=\"atInputRef\"\r\n      @open=\"emit('open')\"\r\n      @change=\"handleChange\"\r\n    >\r\n      <template #option=\"{ label, payload }\">\r\n        <div class=\"field-list-item\">\r\n          <div class=\"field-label\">{{ label }}</div>\r\n          <div class=\"field-type\">{{ payload.typ }}</div>\r\n        </div>\r\n      </template>\r\n    </AtInput>\r\n\r\n    <FullAtInput\r\n      :options=\"options\"\r\n      :defaultValue=\"innerValue\"\r\n      :defaultSelectedList=\"innerTags\"\r\n      :placeholder=\"t('ph_input_content_with_variable')\"\r\n      :type=\"type\"\r\n      @open=\"emit('open')\"\r\n      @change=\"handleChange\"\r\n      @ok=\"handleRefreshAtInput\"\r\n      ref=\"fullAtInputRef\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, watch, computed} from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport {FullscreenOutlined} from '@ant-design/icons-vue'\r\nimport AtInput from \"./at-input.vue\";\r\nimport FullAtInput from \"@/views/workflow/components/at-input/full-at-input.vue\";\r\n\r\nconst { t } = useI18n('views.workflow.components.at-input.at-full-input')\r\nconst emit = defineEmits(['open', 'change'])\r\nconst props = defineProps({\r\n  type: {\r\n    type: String,\r\n    default: \"input\", // input, textarea\r\n    validator(value) {\r\n      return [\"input\", \"textarea\"].includes(value);\r\n    },\r\n  },\r\n  placeholder: {\r\n    type: String,\r\n    default: \"ph_input\",\r\n  },\r\n  defaultValue: {\r\n    type: [String, Number],\r\n    default: \"\",\r\n  },\r\n  options: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n  defaultSelectedList: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n  canRepeat: {\r\n    type: Boolean,\r\n    default: true,\r\n  },\r\n  isContain: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  inputStyle: {\r\n    type: String,\r\n    default: \"\",\r\n  },\r\n  checkAnyLevel:{\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  canFull:{\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nconst atInputRef = ref(null)\r\nconst fullAtInputRef = ref(null)\r\nconst innerValue = ref(props.defaultValue)\r\nconst innerTags = ref(props.defaultSelectedList)\r\nconst computedPlaceholder = computed(() => {\r\n  return props.placeholder === 'ph_input' ? t('ph_input') : props.placeholder\r\n})\r\n\r\nwatch(\r\n  () => props.defaultValue,\r\n  (val) => {\r\n    innerValue.value = val\r\n    //atInputRef.value?.refresh()\r\n  }\r\n)\r\n\r\nwatch(\r\n  () => props.defaultSelectedList,\r\n  (val) => {\r\n    innerTags.value = val\r\n  }\r\n)\r\n\r\nfunction handleChange(val, tags) {\r\n  innerValue.value = val\r\n  innerTags.value = tags\r\n  emit('change', val, tags)\r\n}\r\n\r\nfunction handleRefreshAtInput() {\r\n  atInputRef.value.refresh()\r\n}\r\n\r\nfunction showFull() {\r\n  fullAtInputRef.value.show()\r\n}\r\n\r\ndefineExpose({\r\n  showFull\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n._full-input-box {\r\n  width: 100%;\r\n  position: relative;\r\n\r\n  .full-icon {\r\n    position: absolute;\r\n    bottom: 8px;\r\n    right: 8px;\r\n    cursor: pointer;\r\n    z-index: 999;\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.add-data-form {\r\n  .desc {\r\n    color: var(--wf-color-text-2);\r\n    margin-top: 4px;\r\n    word-break: break-all;\r\n  }\r\n\r\n  .node-box-content {\r\n    margin-top: 16px;\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    &.is-required::before {\r\n      content: '*';\r\n      color: #FB363F;\r\n      display: inline-block;\r\n      margin-right: 2px;\r\n    }\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n}\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12px;\r\n}\r\n\r\n.mt8 {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"add-data-form\">\r\n    <div class=\"node-box-content\">\r\n      <div class=\"flex-between\">\r\n        <div class=\"setting-label is-required\">\r\n          <span>{{ t('label_insert_data') }}</span>\r\n          <span class=\"tip\">{{ t('tip_empty_field') }}</span>\r\n        </div>\r\n        <div class=\"flex-between\">\r\n          <FullscreenOutlined v-if=\"state.input_type_map.fields == 2\" class=\"zm-pointer\" @click=\"showFull('fields')\"/>\r\n          <a-select v-model:value=\"state.input_type_map.fields\" style=\"width: 130px;\" @change=\"update\">\r\n            <a-select-option :value=\"1\">{{ t('opt_select_add_data') }}</a-select-option>\r\n            <a-select-option :value=\"2\">{{ t('opt_input_variable') }}</a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n      <div class=\"setting-box mt8\">\r\n        <FieldListSelect\r\n          v-if=\"state.input_type_map.fields == 1\"\r\n          :showEmptyFieldRow=\"!tableId\"\r\n          :list=\"state.fields\"\r\n          :fields=\"fields\"\r\n          :showAdd=\"false\"\r\n          :showDelete=\"false\"\r\n          @change=\"onChangeFields\"\r\n        />\r\n        <template v-else>\r\n          <AtFullInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"state.tag_map?.fields_json || []\"\r\n            :defaultValue=\"state.fields_json\"\r\n            :ref=\"el => atInputRef['fields'] = el\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(val, tags) => changeValue('fields_json', val, tags)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          />\r\n          <div class=\"desc\">{{ t('desc_data_example') }}</div>\r\n        </template>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport {FullscreenOutlined} from '@ant-design/icons-vue'\r\nimport FieldListSelect from \"@/views/workflow/components/feishu-table/field-selector/index.vue\";\r\nimport AtFullInput from \"@/views/workflow/components/at-input/at-full-input.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-insert-data')\r\n\r\nconst emit = defineEmits(['update'])\r\nconst props = defineProps({\r\n  tableId: {\r\n    type: [String, Number]\r\n  },\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  },\r\n})\r\n\r\nconst atInputRef = ref({})\r\nconst state = reactive({\r\n  fields: [],\r\n  fields_json: \"\",\r\n  input_type_map: {\r\n    fields: 1\r\n  },\r\n  tag_map: {\r\n    fields: []\r\n  },\r\n})\r\n\r\nfunction init(nodeParams=null) {\r\n  state.fields = []\r\n  if (nodeParams) {\r\n    let { fields, input_type_map, tag_map} = nodeParams?.plugin?.params?.arguments || {}\r\n    fields.map(item => {\r\n      item.value = item.value ? item.value.toString() : \"\"\r\n    })\r\n    state.fields = fields\r\n    state.tag_map = tag_map || {}\r\n    if (input_type_map){\r\n      state.input_type_map = input_type_map\r\n      for (let f in input_type_map) {\r\n        if (input_type_map[f] == 2 && !state[`${f}_json`]) {\r\n          let d = JSON.stringify(state[f])\r\n          state[`${f}_json`] = d\r\n        }\r\n      }\r\n    }\r\n  }\r\n  if (!state.fields.length) {\r\n    props.fields.map(item => {\r\n      state.fields.push({\r\n        value: '',\r\n        atTags: [],\r\n        ...item\r\n      })\r\n    })\r\n  }\r\n  update()\r\n}\r\nconst onChangeFields = (selectedRows) => {\r\n  state.fields = selectedRows\r\n  update()\r\n}\r\n\r\nfunction showFull(field) {\r\n  atInputRef.value[field]?.showFull()\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  state[field] = val\r\n  state.tag_map[field] = tags\r\n  update()\r\n}\r\n\r\nconst update = () => {\r\n  emit('update', {\r\n    ...state\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  clear() {\r\n    update()\r\n  }\r\n})\r\n</script>\r\n\r\n","<style lang=\"less\" scoped>\r\n.add-data-form {\r\n  .node-box-content {\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    padding: 0 12px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n\r\n  .setting-box {\r\n\r\n  }\r\n}\r\n\r\n.options-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  line-height: 22px;\r\n  gap: 4px;\r\n\r\n  .options-item-tit {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  .option-label {\r\n    color: var(--wf-color-text-1);\r\n    font-size: 14px;\r\n    margin-right: 8px;\r\n  }\r\n\r\n  .desc {\r\n    color: var(--wf-color-text-2);\r\n    word-break: break-all;\r\n  }\r\n\r\n\r\n  &.is-required .option-label::before {\r\n    content: '*';\r\n    color: #FB363F;\r\n    display: inline-block;\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .option-type {\r\n    height: 22px;\r\n    line-height: 18px;\r\n    padding: 0 8px;\r\n    border-radius: 6px;\r\n    border: 1px solid rgba(0, 0, 0, 0.15);\r\n    background-color: #fff;\r\n    color: var(--wf-color-text-3);\r\n    font-size: 12px;\r\n  }\r\n\r\n  .item-actions-box {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .action-btn {\r\n      margin-left: 12px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n}\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12px;\r\n}\r\n\r\n.mt8 {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"add-data-form\">\r\n    <div class=\"node-box-content\">\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_record_id') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"state.record_tags\"\r\n            :defaultValue=\"state.record_id\"\r\n            :ref=\"el => atInputRef['record_id'] = el\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(val, tags) => changeValue('record_id', val, tags)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{ t('desc_update_record_id') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"flex-between\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_update_data') }}</div>\r\n          </div>\r\n          <div class=\"flex-between\">\r\n            <FullscreenOutlined v-if=\"state.input_type_map.fields == 2\" class=\"zm-pointer\" @click=\"showFull('fields')\"/>\r\n            <a-select v-model:value=\"state.input_type_map.fields\" style=\"width: 130px;\" @change=\"update\">\r\n              <a-select-option :value=\"1\">{{ t('opt_select_update_data') }}</a-select-option>\r\n              <a-select-option :value=\"2\">{{ t('opt_input_variable') }}</a-select-option>\r\n            </a-select>\r\n          </div>\r\n        </div>\r\n        <div class=\"setting-box\">\r\n          <FieldListSelect\r\n            v-if=\"state.input_type_map.fields == 1\"\r\n            :showEmptyFieldRow=\"!tableId\"\r\n            :list=\"state.fields\"\r\n            :fields=\"fields\"\r\n            :showAdd=\"true\"\r\n            :showDelete=\"true\"\r\n            @change=\"onChangeFields\"\r\n          />\r\n          <template v-else>\r\n            <AtFullInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 64px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"state.tag_map?.fields_json || []\"\r\n              :defaultValue=\"state.fields_json\"\r\n              :ref=\"el => atInputRef['fields'] = el\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(val, tags) => changeValue('fields_json', val, tags)\"\r\n              :placeholder=\"t('ph_input_content')\"\r\n            />\r\n            <div class=\"desc\">{{ t('desc_update_data_example') }}</div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, toRaw } from 'vue'\r\nimport {FullscreenOutlined} from '@ant-design/icons-vue'\r\nimport FieldListSelect from \"@/views/workflow/components/feishu-table/field-selector/index.vue\";\r\nimport AtFullInput from \"@/views/workflow/components/at-input/at-full-input.vue\";\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-update-data')\r\n\r\nconst emit = defineEmits(['update', 'updateVar'])\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n  },\r\n  tableId: {\r\n    type: [String, Number]\r\n  },\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  },\r\n})\r\n\r\nconst atInputRef = ref({})\r\nconst state = reactive({\r\n  record_id: '',\r\n  record_tags: [],\r\n  fields: [],\r\n  fields_json: \"\",\r\n  input_type_map: {\r\n    fields: 1\r\n  },\r\n  tag_map: {\r\n    fields: []\r\n  },\r\n})\r\n\r\nfunction init(nodeParams = null) {\r\n  state.fields = []\r\n  if (nodeParams) {\r\n    let { fields, input_type_map, tag_map} = nodeParams?.plugin?.params?.arguments || {}\r\n    fields.map(item => {\r\n      item.value = item.value ? item.value.toString() : \"\"\r\n    })\r\n    state.fields = fields\r\n    state.tag_map = tag_map || {}\r\n    if (input_type_map){\r\n      state.input_type_map = input_type_map\r\n      for (let f in input_type_map) {\r\n        if (input_type_map[f] == 2 && !state[`${f}_json`]) {\r\n          let d = JSON.stringify(state[f])\r\n          state[`${f}_json`] = d\r\n        }\r\n      }\r\n    }\r\n  }\r\n  if (nodeParams && nodeParams?.plugin?.params?.arguments?.record_id) {\r\n    state.record_id = nodeParams.plugin.params.arguments.record_id\r\n    state.record_tags = nodeParams.plugin.params.arguments.record_tags || []\r\n  }\r\n  update()\r\n}\r\n\r\nconst onChangeFields = (selectedRows) => {\r\n  state.fields = selectedRows\r\n  update()\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  state[field] = val\r\n  if (field == 'record_id') {\r\n    state.record_tags = tags\r\n  } else {\r\n    state.tag_map[field] = tags\r\n  }\r\n  update()\r\n}\r\n\r\nfunction showFull(field) {\r\n  atInputRef.value[field]?.showFull()\r\n}\r\n\r\nconst update = () => {\r\n  emit('update', {\r\n    ...state\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  init\r\n})\r\n</script>\r\n\r\n","<template>\r\n  <div class=\"options-item is-required\">\r\n    <div class=\"options-item-tit\">\r\n      <div class=\"option-label\">{{ t('label_record_id') }}</div>\r\n      <div class=\"option-type\">string</div>\r\n    </div>\r\n    <div>\r\n      <AtInput\r\n        type=\"textarea\"\r\n        inputStyle=\"height: 64px;\"\r\n        :options=\"variableOptions\"\r\n        :defaultSelectedList=\"state.tags\"\r\n        :defaultValue=\"state.value\"\r\n        ref=\"atInputRef\"\r\n        @open=\"emit('updateVar')\"\r\n        @change=\"changeValue\"\r\n        :placeholder=\"t('ph_input_content')\"\r\n      >\r\n        <template #option=\"{ label, payload }\">\r\n          <div class=\"field-list-item\">\r\n            <div class=\"field-label\">{{ label }}</div>\r\n            <div class=\"field-type\">{{ payload.typ }}</div>\r\n          </div>\r\n        </template>\r\n      </AtInput>\r\n    </div>\r\n    <div class=\"desc\">{{ t('desc_record_id') }}</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, toRaw} from 'vue'\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-del-data')\r\n\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\nconst emit = defineEmits(['update', 'updateVar'])\r\nconst state = reactive({\r\n  tags: [],\r\n  value: '',\r\n})\r\n\r\nfunction init(nodeParams=null) {\r\n  if (nodeParams && nodeParams?.plugin?.params?.arguments?.record_id) {\r\n    state.value = nodeParams.plugin.params.arguments.record_id\r\n    state.tags = nodeParams.plugin.params.arguments.record_tags || []\r\n  }\r\n}\r\n\r\nfunction changeValue(val, tags) {\r\n  state.value = val\r\n  state.tags = tags\r\n  emit('update', {\r\n    record_id: val,\r\n    record_tags: tags,\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"common\";\r\n</style>\r\n","import { useI18n } from '@/hooks/web/useI18n'\r\n\r\n// 获取带翻译的操作符列表\r\nexport const getFeiShuOperator = () => {\r\n  const { t } = useI18n('constants.database')\r\n  return [\r\n    {key: \"is\", label: t('label_is')},\r\n    {key: \"isNot\", label: t('label_is_not')},\r\n    {key: \"contains\", label: t('label_contain')},\r\n    {key: \"doesNotContain\", label: t('label_not_contain')},\r\n    {key: \"isEmpty\", label: t('label_empty')},\r\n    {key: \"isNotEmpty\", label: t('label_not_empty')},\r\n    {key: \"isGreater\", label: t('label_greater_than')},\r\n    {key: \"isGreaterEqual\", label: t('label_greater_than_or_equal')},\r\n    {key: \"isLess\", label: t('label_less_than')},\r\n    {key: \"isLessEqual\", label: t('label_less_than_or_equal')},\r\n    // {key: \"like\", label: \"LIKE\"},\r\n    // {key: \"in\", label: \"IN\"}\r\n  ]\r\n}\r\n\r\n// 带翻译的操作符列表常量\r\nexport const FeiShuOperator = getFeiShuOperator()\r\n\r\n// 保持向后兼容的映射函数（使用原始中文 label）\r\nexport function FeiShuOperatorMap() {\r\n  let map = {}\r\n  for (let item of FeiShuOperator) {\r\n    map[item.key] = item\r\n  }\r\n  return map\r\n}\r\n\r\n// 获取带翻译的操作符映射\r\nexport const getFeiShuOperatorMap = () => {\r\n  let map = {}\r\n  for (let item of getFeiShuOperator()) {\r\n    map[item.key] = item\r\n  }\r\n  return map\r\n}\r\n\r\n// 带翻译的操作符映射常量\r\nexport const feiShuOperatorMap = getFeiShuOperatorMap()\r\n\r\nexport const ShowFieldTypes = ['Text', 'SingleSelect', 'MultiSelect', 'DateTime', 'Number', 'Checkbox']\r\n\r\nexport const FieldTypesOperatorMap = {\r\n  Text: ['is', 'isNot', 'isEmpty', 'isNotEmpty', 'contains', 'doesNotContain'],\r\n  Number: ['is', 'isNot', 'isEmpty', 'isNotEmpty', 'isGreater', 'isGreaterEqual', 'isLess', 'isLessEqual'],\r\n  SingleSelect: ['is', 'isNot', 'isEmpty', 'isNotEmpty', 'contains', 'doesNotContain'],\r\n  MultiSelect: ['is', 'isNot', 'isEmpty', 'isNotEmpty', 'contains', 'doesNotContain'],\r\n  DateTime: ['is', 'isEmpty', 'isNotEmpty', 'isGreater', 'isLess'],\r\n  Checkbox: ['is']\r\n}\r\n\r\nexport function getFieldOperator(type) {\r\n  let arr = FieldTypesOperatorMap[type] || []\r\n  return FeiShuOperator.filter(i => arr.includes(i.key))\r\n}\r\n\r\nexport const BatchActions = [\r\n  'batch_create_record',\r\n  'batch_delete_record',\r\n  'batch_get_record',\r\n  'batch_update_record',\r\n]\r\n\r\nexport function getBatchActionParams(params) {\r\n  const filterKeys = ['app_id', 'app_secret', 'app_token', 'table_id']\r\n  const formState = {}\r\n  for (let key in params) {\r\n    if (!filterKeys.includes(key) && params[key].required) formState[key] = JSON.parse(JSON.stringify(params[key]))\r\n  }\r\n  return formState\r\n}\r\n","<template>\r\n  <div class=\"query-condition-filter-warpper\" :class=\"{ 'is-multiple': isMultiple }\">\r\n    <div class=\"query-condition-filter\">\r\n      <div class=\"auxiliary-line\"></div>\r\n      <div class=\"condition-select-box\">\r\n        <div class=\"select-wrapper\">\r\n          <a-dropdown>\r\n            <a class=\"ant-dropdown-link\" @click.prevent>\r\n              {{ state.conjunction == 'and' ? t('label_and') : t('label_or') }}\r\n              <DownOutlined />\r\n            </a>\r\n            <template #overlay>\r\n              <a-menu style=\"width: 100px\" @click=\"changeType\">\r\n                <a-menu-item key=\"and\">\r\n                  <a href=\"javascript:;\">{{ t('label_and') }}</a>\r\n                </a-menu-item>\r\n                <a-menu-item key=\"or\">\r\n                  <a href=\"javascript:;\">{{ t('label_or') }}</a>\r\n                </a-menu-item>\r\n              </a-menu>\r\n            </template>\r\n          </a-dropdown>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"field-items\">\r\n        <div class=\"field-item\" v-for=\"(row, index) in state.list\" :key=\"row.field\">\r\n          <div class=\"field-select-box\">\r\n            <!-- 绑定字段 -->\r\n            <a-select\r\n              style=\"width: 100px\"\r\n              v-model:value=\"row.field_name\"\r\n              @change=\"(value, option) => selectField(index, option)\"\r\n            >\r\n              <a-select-option\r\n                :value=\"item.field_name\"\r\n                :type=\"item.ui_type\"\r\n                :key=\"item.field_id\"\r\n                v-for=\"item in props.fieldOptions\"\r\n              >\r\n                {{ item.field_name }}\r\n              </a-select-option>\r\n            </a-select>\r\n          </div>\r\n          <div class=\"operator-select-box\">\r\n            <!-- 绑定条件 -->\r\n            <a-select\r\n              v-model:value=\"row.operator\"\r\n              style=\"width: 180px\"\r\n              @change=\"() => changeOperator(row, index)\"\r\n            >\r\n              <a-select-option\r\n                style=\"width: 220px;\"\r\n                v-for=\"item in getFieldOperator(row.field_type)\"\r\n                :value=\"item.key\"\r\n                :key=\"item.key\"\r\n              >{{ item.label }}</a-select-option>\r\n            </a-select>\r\n          </div>\r\n          <div class=\"field-value-box\">\r\n            <!-- 绑定条件值 -->\r\n\r\n            <!-- 空值检查、布尔类型（无需输入） -->\r\n            <a-input\r\n              v-if=\"['isEmpty', 'isNotEmpty'].includes(row.operator)\"\r\n              :placeholder=\"t('ph_no_value_required')\"\r\n              disabled\r\n            />\r\n            <!-- 文本类型输入 -->\r\n            <AtInput\r\n              v-else\r\n              :options=\"atInputOptions\"\r\n              :defaultValue=\"row.value\"\r\n              :defaultSelectedList=\"row.atTags\"\r\n              @open=\"showAtList\"\r\n              @change=\"(text, selectedList) => changeAtInputValue(text, selectedList, row, index)\"\r\n              :placeholder=\"t('ph_input_value_variable')\"\r\n            />\r\n          </div>\r\n          <span class=\"field-del-btn\" @click=\"removeCondition(index)\">\r\n            <svg-icon class=\"del-icon\" name=\"close-circle\"></svg-icon>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"add-btn-box\">\r\n      <a-tooltip :title=\"t('ph_select_database_first')\" style=\"width: 100%\" v-if=\"disabled\">\r\n        <span>\r\n          <a-button class=\"add-btn\" type=\"dashed\" disabled block>\r\n            <PlusOutlined /> {{ t('btn_add_condition') }}\r\n          </a-button>\r\n        </span>\r\n      </a-tooltip>\r\n\r\n      <a-button class=\"add-btn\" type=\"dashed\" block @click=\"addCondition\" v-else>\r\n        <PlusOutlined /> {{ t('btn_add_condition') }}\r\n      </a-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, inject, ref, watch, reactive, onMounted } from 'vue'\r\nimport { PlusOutlined, DownOutlined } from '@ant-design/icons-vue'\r\nimport { getFilterRulesByType } from '@/constants/database'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport { getFieldOperator } from \"@/constants/feishu-table.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.feishu-table.query-condition-filter')\r\n\r\nconst emit = defineEmits(['change'])\r\n\r\nconst props = defineProps({\r\n  where: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  fieldOptions: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  disabled: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  conjunction: {\r\n    type: String,\r\n    default: 'and'\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst state = reactive({\r\n  list: [],\r\n  conjunction: 'and'\r\n})\r\n\r\nwatch(\r\n  () => props.where,\r\n  (newVal) => {\r\n    state.list = newVal\r\n  },\r\n  {immediate: true}\r\n)\r\n\r\nwatch(\r\n  () => props.conjunction,\r\n  (newVal) => {\r\n    state.conjunction = newVal\r\n  },\r\n  {immediate: true}\r\n)\r\n\r\nconst isMultiple = computed(() => {\r\n  return props.where.length > 1\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable();\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst showAtList = () => {\r\n  getAtInputOptions()\r\n}\r\n\r\nconst change = () => {\r\n  let data = {\r\n    conjunction: state.conjunction,\r\n    list: state.list\r\n  }\r\n\r\n  emit('change', data)\r\n}\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nconst updateRuleValue = (index, key, e) => {\r\n  let value = e.target.value\r\n\r\n  state.list[index][key] = value\r\n  change()\r\n}\r\n\r\nconst changeAtInputValue = (text, selectedList, item, index) => {\r\n  // item.value = text\r\n  state.list[index].value = text\r\n  state.list[index].atTags = selectedList\r\n\r\n  change()\r\n}\r\n\r\nconst changeOperator = (item, index) => {\r\n  state.list[index].value = ''\r\n\r\n  change()\r\n}\r\n\r\nconst addCondition = () => {\r\n  let rowData = {\r\n    field_id: '',\r\n    field_name: '',\r\n    field_type: '',\r\n    operator: undefined,\r\n    value: '',\r\n    atTags: [],\r\n  }\r\n\r\n  state.list.push(rowData)\r\n\r\n  change()\r\n}\r\n\r\nconst removeCondition = (index) => {\r\n  state.list.splice(index, 1)\r\n  change()\r\n}\r\n\r\nconst selectField = (index, option) => {\r\n  let data = {\r\n    field_id: option.key,\r\n    field_name: option.value,\r\n    field_type: option.type,\r\n    operator: undefined,\r\n    value: '',\r\n    atTags: [],\r\n  }\r\n\r\n  state.list[index] = data\r\n  change()\r\n}\r\n\r\nconst changeType = ({ key }) => {\r\n  state.conjunction = key\r\n  change()\r\n}\r\n\r\nonMounted(() => {\r\n  getAtInputOptions()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.query-condition-filter-warpper {\r\n  position: relative;\r\n  .query-condition-filter {\r\n    display: flex;\r\n    position: relative;\r\n    width: 100%;\r\n\r\n    .condition-select-box {\r\n      display: none;\r\n      position: absolute;\r\n      left: 0;\r\n      top: 50%;\r\n      transform: translateY(-50%) translateX(-50%);\r\n      background: #f2f4f7;\r\n      z-index: 10;\r\n    }\r\n    .auxiliary-line {\r\n      display: none;\r\n      position: absolute;\r\n      left: 0;\r\n      top: 15px;\r\n      bottom: 15px;\r\n      width: 48px;\r\n      border-radius: 8px;\r\n      border: 1px solid #bfbfbf;\r\n      border-right: 0;\r\n      border-top-right-radius: 0;\r\n      border-bottom-right-radius: 0;\r\n    }\r\n  }\r\n\r\n  &.is-multiple {\r\n    padding-left: 20px;\r\n    .query-condition-filter {\r\n      padding-left: 32px;\r\n    }\r\n    .auxiliary-line {\r\n      display: block;\r\n    }\r\n    .condition-select-box {\r\n      display: block;\r\n    }\r\n    .add-btn-box {\r\n      padding-left: 32px;\r\n    }\r\n  }\r\n\r\n  .field-items {\r\n    flex: 1;\r\n    .field-item {\r\n      display: flex;\r\n      align-items: center;\r\n      flex-wrap: nowrap;\r\n      margin-bottom: 8px;\r\n\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-select-box,\r\n    .operator-select-box {\r\n      flex: 1;\r\n      margin-right: 8px;\r\n    }\r\n    .field-value-box {\r\n      width: 210px;\r\n      overflow: hidden;\r\n    }\r\n    .field-del-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 24px;\r\n      height: 24px;\r\n      margin-left: 8px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  .add-btn-box {\r\n    margin-top: 8px;\r\n    .add-btn {\r\n      width: 100%;\r\n    }\r\n  }\r\n\r\n  .site-input-group-wrapper {\r\n    display: flex;\r\n\r\n    .site-input-split {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 30px;\r\n      border-bottom: 1px solid #d9d9d9;\r\n      border-top: 1px solid #d9d9d9;\r\n      pointer-events: none;\r\n      background-color: #fff;\r\n    }\r\n\r\n    .site-input-left,\r\n    .site-input-right {\r\n      flex: 1;\r\n      text-align: center;\r\n      overflow: hidden;\r\n    }\r\n\r\n    .site-input-left :deep(.mention-input-warpper) {\r\n      border-top-right-radius: 0;\r\n      border-bottom-right-radius: 0;\r\n    }\r\n\r\n    .site-input-right :deep(.mention-input-warpper) {\r\n      border-top-left-radius: 0;\r\n      border-bottom-left-radius: 0;\r\n    }\r\n  }\r\n}\r\n</style>","<style lang=\"less\" scoped>\r\n.library-checkbox-box {\r\n  padding-top: 16px;\r\n\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n\r\n  .list-box {\r\n    display: flex;\r\n    flex-flow: row wrap;\r\n    height: 388px;\r\n    width: 100%;\r\n    overflow-y: auto;\r\n    align-content: flex-start;\r\n    margin: 0 -8px;\r\n\r\n    .list-item-wraapper {\r\n      padding: 8px;\r\n      width: 50%;\r\n    }\r\n\r\n    .list-item {\r\n      width: 100%;\r\n      padding: 14px 12px;\r\n      border: 1px solid #f0f0f0;\r\n      border-radius: 2px;\r\n\r\n      &:hover {\r\n        cursor: pointer;\r\n        box-shadow: 0 4px 16px 0 #1b3a6929;\r\n      }\r\n\r\n      .library-name {\r\n        line-height: 22px;\r\n        font-size: 14px;\r\n        font-weight: 600;\r\n        color: #262626;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n\r\n      .library-desc {\r\n        line-height: 20px;\r\n        margin-top: 2px;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        color: #8c8c8c;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n\r\n    .list-item :deep(span:last-child) {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n\r\n.empty-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  padding-top: 40px;\r\n  padding-bottom: 40px;\r\n  color: #8c8c8c;\r\n\r\n  img {\r\n    width: 150px;\r\n    height: 150px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal width=\"746px\" v-model:open=\"state.show\" :title=\"t('title_relate_data_table')\" @ok=\"handleOk\" :ok-text=\"t('btn_confirm')\" :cancel-text=\"t('btn_cancel')\">\r\n    <div class=\"field-select-box\">\r\n      <div class=\"field-list-box\" v-if=\"fields.length\">\r\n        <a-table\r\n          rowKey=\"field_name\"\r\n          :row-selection=\"{ selectedRowKeys: state.selectedRowKeys, onChange: onSelectChange }\"\r\n          :dataSource=\"fields\"\r\n          :columns=\"columns\"\r\n          :pagination=\"false\"/>\r\n      </div>\r\n      <div class=\"empty-box\" v-if=\"!fields.length\">\r\n        <img src=\"@/assets/img/library/preview/empty.png\" alt=\"\"/>\r\n        <div>{{ t('msg_no_fields_add') }}</div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive} from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.feishu-table.sort-selector.field-select-alert')\r\n\r\nconst emit = defineEmits(['ok'])\r\nconst props = defineProps({\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  }\r\n})\r\n\r\nconst state = reactive({\r\n  show: false,\r\n  selectedRowKeys: [],\r\n  selectedRows: []\r\n})\r\n\r\nconst columns = ref([\r\n  {\r\n    title: t('label_field_name'),\r\n    dataIndex: 'field_name',\r\n  },\r\n  {\r\n    title: t('label_data_type'),\r\n    dataIndex: 'ui_type',\r\n  },\r\n])\r\n\r\nconst onSelectChange = (selectedRowKeys, selectedRows) => {\r\n  state.selectedRowKeys = selectedRowKeys;\r\n  state.selectedRows = selectedRows\r\n};\r\n\r\nconst open = ({selectedRowKeys, selectedRows}) => {\r\n  state.selectedRowKeys = selectedRowKeys\r\n  state.selectedRows = selectedRows\r\n\r\n  state.show = true\r\n}\r\n\r\n\r\nconst handleOk = () => {\r\n  emit('ok', state.selectedRowKeys, state.selectedRows)\r\n  state.show = false;\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>","<style lang=\"less\" scoped>\r\n.field-list {\r\n  .field-list-row {\r\n    position: relative;\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    align-items: center;\r\n    margin-bottom: 4px;\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n  .field-list-col {\r\n    padding: 0 4px;\r\n  }\r\n  .field-value-col {\r\n    width: 208px;\r\n  }\r\n  .field-name-col {\r\n    width: 220px;\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n  }\r\n  .field-del-head,\r\n  .field-del-col {\r\n    width: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .field-del-col {\r\n    .del-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 16px;\r\n      height: 16px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n  .field-drag-col {\r\n    width: 24px;\r\n    margin-right: 8px;\r\n    .drag-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 24px;\r\n      height: 24px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n      &:hover {\r\n        border-radius: 6px;\r\n        background: #d9d9d9;\r\n      }\r\n    }\r\n  }\r\n  .field-name-box {\r\n    display: flex;\r\n    .field-type-tag {\r\n      padding: 0 6px;\r\n      margin-left: 8px;\r\n      border-radius: 6px;\r\n      font-size: 12px;\r\n      line-height: 16px;\r\n      font-weight: 400;\r\n      color: rgb(89, 89, 89);\r\n      border: 1px solid rgba(0, 0, 0, 0.15);\r\n      background: #fff;\r\n    }\r\n  }\r\n}\r\n.field-list-row:hover {\r\n  border-radius: 6px;\r\n  background: #e4e6eb;\r\n}\r\n.add-btn-box {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div>\r\n    <div class=\"field-list\">\r\n      <div class=\"field-list-row\" v-for=\"item in conditions\" :key=\"item.name\">\r\n        <div class=\"field-list-col field-drag-col\">\r\n          <span class=\"drag-btn\">\r\n            <HolderOutlined />\r\n          </span>\r\n        </div>\r\n        <div class=\"field-list-col field-name-col\">\r\n          <div class=\"field-name-box\">\r\n            <span class=\"field-name\">{{ item.field_name }}</span>\r\n            <span class=\"field-type-tag\">{{ item.ui_type }}</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-list-col field-value-col\">\r\n          <a-select v-model:value=\"item.is_asc\" style=\"width: 100%\" @change=\"changeValue\">\r\n            <a-select-option :value=\"opt.value\" v-for=\"opt in operatorOptions\" :key=\"opt.key\">\r\n              {{ t(opt.label) }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n        <div class=\"field-list-col field-del-col\" v-if=\"props.showDelete\">\r\n          <span class=\"del-btn\" @click=\"removeCondition(index)\">\r\n            <svg-icon class=\"del-icon\" name=\"close-circle\"></svg-icon>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"add-btn-box\">\r\n      <a-tooltip :title=\"t('ph_select_database_first')\" style=\"width: 100%\" v-if=\"disabled\">\r\n        <span>\r\n          <a-button class=\"add-btn\" type=\"dashed\" disabled block>\r\n            <PlusOutlined /> {{ t('btn_add_sort_field') }}\r\n          </a-button>\r\n        </span>\r\n      </a-tooltip>\r\n\r\n      <a-button class=\"add-btn\" type=\"dashed\" block @click=\"handleAddField\" v-else>\r\n        <PlusOutlined /> {{ t('btn_add_sort_field') }}\r\n      </a-button>\r\n    </div>\r\n\r\n    <FieldSelectAlert :fields=\"fields\" ref=\"fieldSelectAlertRef\" @ok=\"onChangeSelect\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue'\r\nimport { PlusOutlined, HolderOutlined } from '@ant-design/icons-vue'\r\nimport FieldSelectAlert from './field-select-alert.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.feishu-table.sort-selector.index')\r\n\r\nconst emit = defineEmits(['change'])\r\n\r\nconst props = defineProps({\r\n  showAdd: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showDelete: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  fields: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  list: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  disabled: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nconst operatorOptions = [\r\n  { label: 'label_asc', value: 1, key: 'asc' },\r\n  { label: 'label_desc', value: 0, key: 'desc' }\r\n]\r\n\r\nconst fieldSelectAlertRef = ref()\r\nconst conditions = ref([])\r\n\r\nwatch(\r\n  () => props.list,\r\n  (newVal) => {\r\n    conditions.value = newVal.map(item => {\r\n      return {\r\n        ...item,\r\n        is_asc: item.is_asc ? 1 : 0\r\n      }\r\n    })\r\n  }\r\n)\r\n\r\nconst removeCondition = (index) => {\r\n  conditions.value.splice(index, 1)\r\n\r\n  change()\r\n}\r\n\r\nconst onChangeSelect = (selectedRowKeys, selectedRows) => {\r\n  conditions.value = selectedRows.map((item) => {\r\n    return { ...item }\r\n  })\r\n  change()\r\n}\r\n\r\nconst changeValue = () => {\r\n  change()\r\n}\r\n\r\nconst change = () => {\r\n  let data = conditions.value.map(item => {\r\n    return {\r\n      ...item,\r\n      is_asc: item.is_asc == 1 ? true : false\r\n    }\r\n  })\r\n  emit('change', data)\r\n}\r\n\r\nconst handleAddField = () => {\r\n  fieldSelectAlertRef.value.open({\r\n    selectedRows: props.list,\r\n    selectedRowKeys: props.list.map((item) => {\r\n      return item.field_name\r\n    })\r\n  })\r\n}\r\n</script>","<template>\r\n  <div class=\"select-data-form\">\r\n    <div class=\"node-box-content\">\r\n      <div class=\"setting-box\">\r\n        <collapse-panel :title=\"t('title_query_conditions')\" :count=\"state.filter.conditions.length\">\r\n          <template #extra>\r\n            <div class=\"flex-between\">\r\n              <div v-if=\"state.input_type_map.filter != 1\" class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal('filter_json')\">\r\n                <FullscreenOutlined/>\r\n              </div>\r\n              <a-select v-model:value=\"state.input_type_map.filter\" style=\"width: 130px;\" @change=\"update\">\r\n                <a-select-option :value=\"1\">{{ t('opt_select_query_condition') }}</a-select-option>\r\n                <a-select-option :value=\"2\">{{ t('opt_input_variable') }}</a-select-option>\r\n              </a-select>\r\n            </div>\r\n          </template>\r\n          <template v-if=\"state.input_type_map.filter != 1\">\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 64px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"state.tag_map?.filter_json || []\"\r\n              :defaultValue=\"state.filter_json\"\r\n              :ref=\"el => atInputRef['filter_json'] = el\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(val, tags) => changeValue('filter_json', val, tags)\"\r\n              :placeholder=\"t('ph_input_content')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n            <div class=\"desc\">{{ t('desc_filter_example') }}</div>\r\n          </template>\r\n          <QueryConditionFilter\r\n            v-else\r\n            :disabled=\"!tableId\"\r\n            :where=\"state.filter.conditions\"\r\n            :field-options=\"fields\"\r\n            :conjunction=\"state.filter.conjunction\"\r\n            @change=\"onConditionChange\"\r\n          />\r\n        </collapse-panel>\r\n      </div>\r\n\r\n      <div class=\"setting-box\" @wheel.stop @touchmove.stop>\r\n        <collapse-panel :title=\"t('title_query_fields')\" :count=\"state.field_names.length\">\r\n          <template #extra>\r\n            <div class=\"flex-between\">\r\n              <div v-if=\"state.input_type_map.field_names != 1\" class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal('field_names_json')\">\r\n                <FullscreenOutlined/>\r\n              </div>\r\n              <a-select v-model:value=\"state.input_type_map.field_names\" style=\"width: 130px;\" @change=\"update\">\r\n                <a-select-option :value=\"1\">{{ t('opt_select_query_fields') }}</a-select-option>\r\n                <a-select-option :value=\"2\">{{ t('opt_input_variable') }}</a-select-option>\r\n              </a-select>\r\n            </div>\r\n          </template>\r\n          <template  v-if=\"state.input_type_map.field_names != 1\">\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 64px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"state.tag_map?.field_names_json || []\"\r\n              :defaultValue=\"state.field_names_json\"\r\n              :ref=\"el => atInputRef['field_names_json'] = el\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(val, tags) => changeValue('field_names_json', val, tags)\"\r\n              :placeholder=\"t('ph_input_content')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n            <div class=\"desc\">{{ t('desc_field_names_example') }}</div>\r\n          </template>\r\n          <FieldListSelect\r\n            v-else\r\n            :showAdd=\"!!tableId\"\r\n            :showInput=\"false\"\r\n            :showEmptyFieldRow=\"!tableId\"\r\n            :list=\"state.field_names\"\r\n            :fields=\"fields\"\r\n            @change=\"onChangeFields\"\r\n\r\n          />\r\n        </collapse-panel>\r\n      </div>\r\n\r\n      <div class=\"setting-box\" @wheel.stop @touchmove.stop>\r\n        <collapse-panel :title=\"t('title_sort')\" :count=\"state.sort.length\">\r\n          <template #extra>\r\n            <div class=\"flex-between\">\r\n              <div v-if=\"state.input_type_map.sort != 1\" class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal('sort_json')\">\r\n                <FullscreenOutlined/>\r\n              </div>\r\n              <a-select v-model:value=\"state.input_type_map.sort\" style=\"width: 130px;\" @change=\"update\">\r\n                <a-select-option :value=\"1\">{{ t('opt_select_sort') }}</a-select-option>\r\n                <a-select-option :value=\"2\">{{ t('opt_input_variable') }}</a-select-option>\r\n              </a-select>\r\n            </div>\r\n          </template>\r\n          <template v-if=\"state.input_type_map.sort != 1\">\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 64px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"state.tag_map?.sort_json || []\"\r\n              :defaultValue=\"state.sort_json\"\r\n              :ref=\"el => atInputRef['sort_json'] = el\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(val, tags) => changeValue('sort_json', val, tags)\"\r\n              :placeholder=\"t('ph_input_content')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n            <div class=\"desc\">{{ t('desc_sort_example') }}</div>\r\n          </template>\r\n          <SortSelector\r\n            v-else\r\n            :disabled=\"!tableId\"\r\n            :list=\"state.sort\"\r\n            :fields=\"fields\"\r\n            @change=\"changeSoreField\"\r\n          />\r\n        </collapse-panel>\r\n      </div>\r\n\r\n      <div class=\"setting-label\">\r\n        <span>{{ t('label_query_count') }}</span>\r\n      </div>\r\n\r\n      <div class=\"setting-box\" @wheel.stop @touchmove.stop>\r\n        <a-input-number\r\n          v-model:value=\"state.page_size\"\r\n          :disabled=\"!tableId\"\r\n          :min=\"20\"\r\n          :max=\"500\"\r\n          style=\"width: 205px\"\r\n          @change=\"update\"/>\r\n      </div>\r\n    </div>\r\n    <FullAtInput\r\n      :options=\"variableOptions\"\r\n      :defaultSelectedList=\"fullDefaultTags\"\r\n      :defaultValue=\"fullDefaultValue\"\r\n      :placeholder=\"t('ph_input_content')\"\r\n      type=\"textarea\"\r\n      @open=\"emit('updateVar')\"\r\n      @change=\"(val, tags) => changeValueByFull(val, tags)\"\r\n      @ok=\"handleRefreshAtInput\"\r\n      ref=\"fullAtInputRef\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {reactive, ref} from 'vue';\r\nimport FieldListSelect from \"@/views/workflow/components/feishu-table/field-selector/index.vue\";\r\nimport QueryConditionFilter from \"@/views/workflow/components/feishu-table/query-condition-filter.vue\";\r\nimport SortSelector from \"@/views/workflow/components/feishu-table/sort-selector/index.vue\";\r\nimport CollapsePanel from \"@/views/workflow/components/data-table/collapse-panel.vue\";\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport FullAtInput from \"@/views/workflow/components/at-input/full-at-input.vue\";\r\nimport { FullscreenOutlined } from '@ant-design/icons-vue'\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-search-data')\r\n\r\nconst emit = defineEmits(['update', 'updateVar'])\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n  },\r\n  tableId: {\r\n    type: [String, Number]\r\n  },\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  },\r\n})\r\n\r\nconst stateStruct = {\r\n  field_names: [],\r\n  filter: {\r\n    conjunction:'and',\r\n    conditions: [],\r\n  },\r\n  sort: [],\r\n  page_size: 100,\r\n\r\n  field_names_json: \"\",\r\n  filter_json: \"\",\r\n  sort_json: \"\",\r\n\r\n  input_type_map: { // 1选择 2 输入\r\n    field_names: 1,\r\n    filter: 1,\r\n    sort: 1,\r\n  },\r\n  tag_map: {},\r\n}\r\nconst state = reactive(JSON.parse(JSON.stringify(stateStruct)))\r\nconst fullAtInputRef = ref(null)\r\nconst atInputRef = ref({})\r\nconst activeField = ref('')\r\nconst fullDefaultValue = ref('')\r\nconst fullDefaultTags = ref([])\r\n\r\nfunction init(nodeParams= null) {\r\n  if (!nodeParams) {\r\n    Object.assign(state, JSON.parse(JSON.stringify(stateStruct)))\r\n  } else {\r\n    let {field_names, filter, sort, page_size, input_type_map, tag_map} = nodeParams?.plugin?.params?.arguments || {}\r\n    if (Array.isArray(filter.conditions) && filter.conditions.length) {\r\n      for (let item of filter.conditions) {\r\n        if ('DateTime' === item.field_type) {\r\n          // 后端要求DateTime添加了特殊标记 输入时移除标记\r\n          item.value = item.value.replace(/\\D/g, '')\r\n        }\r\n      }\r\n      state.filter = filter\r\n    } else {\r\n      state.filter = {\r\n        conjunction:'and',\r\n        conditions: [],\r\n      }\r\n    }\r\n\r\n    if (Array.isArray(field_names) && input_type_map?.field_names != 2) {\r\n      field_names.map(name => {\r\n        let find = props.fields.find(i => i.field_name == name)\r\n        find && state.field_names.push(find)\r\n      })\r\n    } else {\r\n      state.field_names = Array.isArray(field_names) ? field_names : []\r\n    }\r\n    if (Array.isArray(sort) && input_type_map?.sort != 2) {\r\n      state.sort = sort.map(item => {\r\n        let find = props.fields.find(i => i.field_name == item.field_name)\r\n        return {\r\n          ...find,\r\n          is_asc: item.desc ? 0 : 1\r\n        }\r\n      })\r\n    } else {\r\n      state.sort = Array.isArray(sort) ? sort : []\r\n    }\r\n    if (input_type_map) state.input_type_map = input_type_map\r\n    for (let f in input_type_map) {\r\n      if (input_type_map[f] == 2) {\r\n        let d = JSON.stringify(state[f])\r\n        if (Array.isArray(state[f])) {\r\n          if (!state[f].length) d = ''\r\n        } else if (!state[f]?.conditions?.length) {\r\n          d = ''\r\n        }\r\n        state[`${f}_json`] = d\r\n      }\r\n    }\r\n\r\n    state.tag_map = tag_map || {}\r\n    state.page_size = page_size || 100\r\n  }\r\n  //update()\r\n}\r\n\r\nconst onConditionChange = ({conjunction, list}) => {\r\n  state.filter.conjunction = conjunction\r\n  state.filter.conditions = list\r\n  update()\r\n}\r\n\r\nconst changeSoreField = (list) => {\r\n  state.sort = [...list]\r\n  update()\r\n}\r\n\r\nconst onChangeFields = (selectedRows) => {\r\n  state.field_names = selectedRows\r\n  update()\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  state[field] = val\r\n  state.tag_map[field] = tags\r\n  update()\r\n}\r\n\r\nfunction changeValueByFull(val, tags) {\r\n  const field = activeField.value\r\n  if (!field) return\r\n  state[field] = val\r\n  state.tag_map[field] = tags\r\n  update()\r\n}\r\n\r\nfunction handleOpenFullAtModal(field) {\r\n  activeField.value = field\r\n  fullDefaultValue.value = state[field] || ''\r\n  fullDefaultTags.value = state.tag_map?.[field] || []\r\n  fullAtInputRef.value.show()\r\n}\r\n\r\nfunction update() {\r\n  emit('update', JSON.parse(JSON.stringify(state)))\r\n}\r\n\r\nfunction handleRefreshAtInput() {\r\n  const field = activeField.value\r\n  const target = atInputRef.value?.[field]\r\n  target && target.refresh && target.refresh()\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  clearSelections() {\r\n    if (state.input_type_map?.filter == 1) {\r\n      state.filter.conditions = []\r\n    }\r\n    if (state.input_type_map?.field_names == 1) {\r\n      state.field_names = []\r\n    }\r\n    if (state.input_type_map?.sort == 1) {\r\n      state.sort = []\r\n    }\r\n    update()\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.select-data-form {\r\n  :deep(.type-textarea){\r\n    word-break: break-all;\r\n  }\r\n\r\n  .desc {\r\n    color: var(--wf-color-text-2);\r\n    margin-top: 4px;\r\n    word-break: break-all;\r\n  }\r\n\r\n  .node-box-content {\r\n    margin-top: 16px;\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n\r\n  .node-box-title {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 48px;\r\n    padding: 0 12px;\r\n\r\n    .input-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .text {\r\n      font-weight: 600;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    padding: 0 12px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n\r\n  .setting-box {\r\n    //padding: 0 12px;\r\n    margin-bottom: 12px;\r\n  }\r\n}\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12px;\r\n}\r\n.btn-hover-wrap {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  cursor: pointer;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"field-tree-wrapper\" @wheel.stop @touchmove.stop>\r\n    <a-tree\r\n      v-model:selectedKeys=\"selectedKeys\"\r\n      blockNode\r\n      :defaultExpandAll=\"true\"\r\n      :height=\"224\"\r\n      :tree-data=\"props.treeData\"\r\n      :fieldNames=\"{children: 'subs', key: 'cu_key'}\"\r\n    >\r\n      <template #switcherIcon=\"{ switcherCls }\">\r\n        <span :class=\"switcherCls\">\r\n          <svg-icon\r\n            class=\"switcher-btn\"\r\n            name=\"arrow-down\"\r\n            style=\"font-size: 14px; color: #333\"\r\n          ></svg-icon>\r\n        </span>\r\n      </template>\r\n\r\n      <template #title=\"{ dataRef }\">\r\n        <div class=\"field-item\">\r\n          <span class=\"field-key\">{{ dataRef.key }}</span>\r\n          <a-tooltip v-if=\"dataRef.tip\" :overlayStyle=\"{ maxWidth: '800px' }\">\r\n            <template #title>\r\n              <div class=\"tip-content\">{{ dataRef.tip }}</div>\r\n            </template>\r\n            <QuestionCircleOutlined style=\"margin-left: 4px;\" />\r\n          </a-tooltip>\r\n          <span class=\"field-type\">{{ dataRef.typ }}</span>\r\n          <span class=\"field-name\">{{ dataRef.name }}</span>\r\n        </div>\r\n      </template>\r\n    </a-tree>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue';\r\nimport { ref } from 'vue'\r\n// const expandedKeys = ref(['0-0-0'])\r\n\r\nconst props = defineProps({\r\n  treeData: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst selectedKeys = ref([])\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.field-tree-wrapper {\r\n  position: relative;\r\n  height: 224px;\r\n  :deep(.ant-tree) {\r\n    background: none;\r\n  }\r\n  .switcher-btn {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 16px;\r\n    border-radius: 6px;\r\n    color: #000;\r\n\r\n    &:hover {\r\n      cursor: pointer;\r\n      background-color: #d9d9d9;\r\n    }\r\n  }\r\n\r\n  .field-item{\r\n    display: flex;\r\n    align-items: center;\r\n    .field-key{\r\n      color: #262626;\r\n      text-align: right;\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 22px;\r\n    }\r\n    .field-name{\r\n      color: #595959;\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 22px;\r\n    }\r\n    .field-type{\r\n      display: flex;\r\n      padding: 1px 8px;\r\n      align-items: center;\r\n      gap: 4px;\r\n      border-radius: 6px;\r\n      border: 1px solid #00000026;\r\n      background: #FFF;\r\n      color: #595959;\r\n      font-size: 12px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 20px;\r\n      margin: 0 12px 0 8px;\r\n    }\r\n  }\r\n}\r\n\r\n.tip-content {\r\n  white-space: pre-wrap;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"add-data-form\">\r\n    <div class=\"node-box-content\">\r\n      <div\r\n        v-for=\"(item, key, idx) in formState\"\r\n        :key=\"key\"\r\n        class=\"options-item is-required\"\r\n      >\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"flex-between\">\r\n            <div class=\"option-label\">{{ item.name || key }}</div>\r\n            <div class=\"option-type\">{{ item.type }}</div>\r\n          </div>\r\n          <div class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal(key, idx)\">\r\n            <FullscreenOutlined/>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"item.tags\"\r\n            :defaultValue=\"item.value\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{item.desc}}</div>\r\n      </div>\r\n    </div>\r\n    <FullAtInput\r\n      :options=\"variableOptions\"\r\n      :defaultSelectedList=\"fullDefaultTags\"\r\n      :defaultValue=\"fullDefaultValue\"\r\n      :placeholder=\"t('ph_input_content')\"\r\n      type=\"textarea\"\r\n      @open=\"emit('updateVar')\"\r\n      @change=\"(val, tags) => changeValueByFull(val, tags)\"\r\n      @ok=\"handleRefreshAtInput\"\r\n      ref=\"fullAtInputRef\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {FullscreenOutlined} from '@ant-design/icons-vue';\r\nimport {reactive, onMounted, ref} from 'vue';\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport FullAtInput from \"@/views/workflow/components/at-input/full-at-input.vue\";\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\nimport {getBatchActionParams} from \"@/constants/feishu-table.js\";\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.common')\r\n\r\nconst emit = defineEmits(['update', 'updateVar'])\r\nconst props = defineProps({\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\nconst formState = reactive({})\r\nconst fullAtInputRef = ref(null)\r\nconst atInputRef = ref([])\r\nconst activeKey = ref('')\r\nconst activeIdx = ref(-1)\r\nconst fullDefaultValue = ref('')\r\nconst fullDefaultTags = ref([])\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n\r\nfunction handleOpenFullAtModal(key, idx) {\r\n  activeKey.value = key\r\n  activeIdx.value = idx\r\n  const cur = formState[key] || {}\r\n  fullDefaultValue.value = cur.value || ''\r\n  fullDefaultTags.value = cur.tags || []\r\n  fullAtInputRef.value.show()\r\n}\r\n\r\nfunction init(nodePrams=null) {\r\n  const base = getBatchActionParams(props.action?.params || {})\r\n  for (let field in base) {\r\n    const old = formState[field] || {}\r\n    formState[field] = {\r\n      ...base[field],\r\n      value: old.value ?? base[field].value ?? \"\",\r\n      tags: old.tags ?? base[field].tags ?? []\r\n    }\r\n  }\r\n  if (nodePrams) {\r\n    let args = nodePrams?.plugin?.params?.arguments || {}\r\n    let tag_map = args?.tag_map || {}\r\n    for (let field in formState) {\r\n      const cur = formState[field] || {}\r\n      const hasUserInput = !!(String(cur.value || \"\").length) || (Array.isArray(cur.tags) && cur.tags.length > 0)\r\n      if (!hasUserInput) {\r\n        formState[field].value = args[field] ?? cur.value ?? \"\"\r\n        formState[field].tags = tag_map[field] ?? cur.tags ?? []\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction changeValue(item, val, tags) {\r\n  item.value = val\r\n  item.tags = tags\r\n  update()\r\n}\r\n\r\nfunction changeValueByFull(val, tags) {\r\n  const key = activeKey.value\r\n  if (!key) return\r\n  const item = formState[key]\r\n  if (!item) return\r\n  item.value = val\r\n  item.tags = tags\r\n  update()\r\n}\r\n\r\n\r\nconst update = () => {\r\n  let data = {\r\n    tag_map: {}\r\n  }\r\n  for (let field in formState) {\r\n    data[field] = formState[field].value\r\n    data.tag_map[field] = formState[field].tags\r\n  }\r\n  emit('update', data)\r\n}\r\n\r\nfunction handleRefreshAtInput() {\r\n  const idx = activeIdx.value\r\n  if (idx != null && idx > -1) {\r\n    const arr = atInputRef.value || []\r\n    const target = Array.isArray(arr) ? arr[idx] : arr\r\n    target && target.refresh && target.refresh()\r\n  }\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.options-item-tit {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.btn-hover-wrap {\r\n  cursor: pointer;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"options-item is-required\">\r\n    <div class=\"options-item-tit\">\r\n      <div class=\"option-label\">{{ t('label_bitable_name') }}</div>\r\n      <div class=\"option-type\">string</div>\r\n    </div>\r\n    <div class=\"min-input\">\r\n      <AtInput\r\n        type=\"textarea\"\r\n        inputStyle=\"height: 33px;\"\r\n        :options=\"variableOptions\"\r\n        :defaultSelectedList=\"state.tag_map.name || []\"\r\n        :defaultValue=\"state.name\"\r\n        ref=\"atInputRef\"\r\n        @open=\"emit('updateVar')\"\r\n        @change=\"changeValue\"\r\n        :placeholder=\"t('ph_input_content')\"\r\n      >\r\n        <template #option=\"{ label, payload }\">\r\n          <div class=\"field-list-item\">\r\n            <div class=\"field-label\">{{ label }}</div>\r\n            <div class=\"field-type\">{{ payload.typ }}</div>\r\n          </div>\r\n        </template>\r\n      </AtInput>\r\n    </div>\r\n    <div class=\"desc\">{{ t('desc_bitable_app_name') }}</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {reactive} from 'vue'\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-create-bitable')\r\n\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\nconst emit = defineEmits(['update', 'updateVar'])\r\nconst state = reactive({\r\n  tag_map: {},\r\n  name: '',\r\n})\r\n\r\nfunction init(nodeParams=null) {\r\n  if (nodeParams && nodeParams?.plugin?.params?.arguments?.name) {\r\n    state.name = nodeParams.plugin.params.arguments.name\r\n    state.tag_map = nodeParams.plugin.params.arguments.tag_map || {}\r\n  }\r\n}\r\n\r\nfunction changeValue(val, tags) {\r\n  state.name = val\r\n  state.tag_map.name = tags\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  emit('update', JSON.parse(JSON.stringify(state)))\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  update,\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"common\";\r\n</style>\r\n","<template>\r\n  <div>\r\n    <div class=\"options-item is-required\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_table_name') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 64px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"state?.tag_map?.name || []\"\r\n          :defaultValue=\"state.name\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(val, tags) => changeValue('name', val, tags)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_table_name') }}</div>\r\n    </div>\r\n    <div class=\"options-item\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_view_name') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 64px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"state?.tag_map?.default_view_name || []\"\r\n          :defaultValue=\"state.default_view_name\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(val, tags) => changeValue('default_view_name', val, tags)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_view_name') }}</div>\r\n    </div>\r\n    <div class=\"options-item\">\r\n      <div class=\"options-item-tit flex-between\">\r\n        <div class=\"flex-between\">\r\n          <div class=\"option-label\">{{ t('label_initial_fields') }}</div>\r\n          <div class=\"option-type\">jsonString</div>\r\n        </div>\r\n        <div class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal\">\r\n          <FullscreenOutlined/>\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 64px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"state?.tag_map?.fields || []\"\r\n          :defaultValue=\"state.fields\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(val, tags) => changeValue('fields', val, tags)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_initial_fields') }}</div>\r\n    </div>\r\n\r\n    <FullAtInput\r\n      :options=\"variableOptions\"\r\n      :defaultSelectedList=\"state?.tag_map?.fields || []\"\r\n      :defaultValue=\"state.fields\"\r\n      :placeholder=\"t('ph_input_content')\"\r\n      type=\"textarea\"\r\n      @open=\"emit('updateVar')\"\r\n      @change=\"(val, tags) => changeValue('fields', val, tags)\"\r\n      @ok=\"handleRefreshAtInput\"\r\n      ref=\"fullAtInputRef\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive} from 'vue'\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport FullAtInput from \"@/views/workflow/components/at-input/full-at-input.vue\";\r\nimport {FullscreenOutlined} from '@ant-design/icons-vue';\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-create-table')\r\n\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\nconst emit = defineEmits(['update', 'updateVar'])\r\nconst fullAtInputRef = ref(null)\r\nconst atInputRef = ref(null)\r\nconst state = reactive({\r\n  name: '',\r\n  default_view_name: '',\r\n  fields: '',\r\n  tag_map: {},\r\n})\r\n\r\nfunction init(nodeParams = null) {\r\n  if (nodeParams && nodeParams?.plugin?.params?.arguments) {\r\n    state.name = nodeParams.plugin.params.arguments?.name || \"\"\r\n    state.default_view_name = nodeParams.plugin.params.arguments?.default_view_name || \"\"\r\n    state.fields = nodeParams.plugin.params.arguments?.fields || \"\"\r\n    state.tag_map = nodeParams.plugin.params.arguments?.tag_map || {}\r\n  }\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  state[field] = val\r\n  state.tag_map[field] = tags\r\n  update()\r\n}\r\n\r\nfunction handleOpenFullAtModal() {\r\n  fullAtInputRef.value.show()\r\n}\r\n\r\nfunction handleRefreshAtInput() {\r\n  atInputRef.value.refresh()\r\n}\r\n\r\nfunction update() {\r\n  emit('update', JSON.parse(JSON.stringify(state)))\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  update\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"common\";\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <div class=\"options-item is-required\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_view_name') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 33px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"state?.tag_map?.view_name || []\"\r\n          :defaultValue=\"state.view_name\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(val, tags) => changeValue('view_name', val, tags)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_view_name') }}</div>\r\n    </div>\r\n    <div class=\"options-item\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_view_type') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <a-select\r\n          v-model:value=\"state.view_type\"\r\n          :options=\"VIEW_SELECT_OPTIONS\"\r\n          :placeholder=\"t('ph_select_view')\"\r\n          style=\"width: 100%;\"\r\n        />\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_view_type') }}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {reactive} from 'vue'\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-create-view')\r\n\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\nconst emit = defineEmits(['update', 'updateVar'])\r\nconst state = reactive({\r\n  view_name: '',\r\n  view_type: 'grid',\r\n  tag_map: {},\r\n})\r\n\r\nconst VIEW_SELECT_OPTIONS = [\r\n  { label: t('opt_grid_view'), value: 'grid' },\r\n  { label: t('opt_kanban_view'), value: 'kanban' },\r\n  { label: t('opt_gallery_view'), value: 'gallery' },\r\n  { label: t('opt_gantt_view'), value: 'gantt' },\r\n  { label: t('opt_form_view'), value: 'form' }\r\n]\r\n\r\nfunction init(nodeParams=null) {\r\n  if (nodeParams && nodeParams?.plugin?.params?.arguments) {\r\n    state.name = nodeParams.plugin.params.arguments?.name || \"\"\r\n    state.view_name = nodeParams.plugin.params.arguments?.view_name || \"\"\r\n    state.tag_map = nodeParams.plugin.params.arguments?.tag_map || {}\r\n  }\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  state[field] = val\r\n  state.tag_map[field] = tags\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  emit('update', JSON.parse(JSON.stringify(state)))\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  update,\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"common\";\r\n</style>\r\n","<template>\r\n  <div>\r\n      <div class=\"options-item is-required\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_select_role') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 64px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"state?.tag_map?.role_id || []\"\r\n          :defaultValue=\"state.role_id\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(val, tags) => changeValue('role_id', val, tags)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n    </div>\r\n    <div class=\"options-item is-required\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_member_id_type') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <a-select v-model:value=\"state.member_id_type\" :placeholder=\"t('ph_select')\" style=\"width: 100%;\">\r\n          <a-select-option v-for=\"key in roleIdType\" :key=\"key\">{{key}}</a-select-option>\r\n        </a-select>\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_member_id_type') }}</div>\r\n    </div>\r\n    <div class=\"options-item is-required\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_member_id') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 64px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"state?.tag_map?.member_id || []\"\r\n          :defaultValue=\"state.member_id\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(val, tags) => changeValue('member_id', val, tags)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n      <div class=\"desc\" v-html=\"t('desc_member_id_link')\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive} from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-add-members')\r\n\r\nconst props = defineProps({\r\n  config: {\r\n    type: Object,\r\n    default: () => ({\r\n      app_id: '',\r\n      app_secret: '',\r\n      app_token: '',\r\n    })\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\nconst emit = defineEmits(['update', 'updateVar'])\r\n//const roleIdType = ['open_id', 'union_id', 'user_id', 'chat_id', 'department_id', 'open_department_id']\r\nconst roleIdType = ['user_id']\r\n\r\nconst atInputRef = ref(null)\r\nconst roles = ref([])\r\nconst state = reactive({\r\n  member_id: \"\",\r\n  role_id: undefined,\r\n  role_name: '',\r\n  member_id_type: \"user_id\",\r\n  tag_map: {},\r\n})\r\n\r\nfunction init(nodeParams = null) {\r\n  if (nodeParams && nodeParams?.plugin?.params?.arguments) {\r\n    Object.assign(state, nodeParams.plugin.params.arguments)\r\n  }\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  state[field] = val\r\n  state.tag_map[field] = tags\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  emit('update', JSON.parse(JSON.stringify(state)))\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  update\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"common\";\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <div class=\"options-item is-required\">\r\n      <div class=\"options-item-tit\">\r\n        <div class=\"option-label\">{{ t('label_bitable_name') }}</div>\r\n        <div class=\"option-type\">string</div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 64px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"state?.tag_map?.name || []\"\r\n          :defaultValue=\"state.name\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(val, tags) => changeValue('name', val, tags)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_update_bitable_name') }}</div>\r\n    </div>\r\n    <div class=\"options-item is-required\">\r\n      <div class=\"flex-between\">\r\n        <div class=\"options-item-tit \">\r\n          <div class=\"option-label\">{{ t('label_enable_advanced_permission') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div>\r\n          <a-switch :checked=\"state.is_advanced > 0\" @change=\"advancedChange\"></a-switch>\r\n        </div>\r\n      </div>\r\n      <div class=\"min-input\">\r\n        <a-radio-group v-model:value=\"state.is_advanced\" :disabled=\"state.is_advanced < 1\" @change=\"update\">\r\n          <a-radio value=\"1\">{{ t('opt_enable') }}</a-radio>\r\n          <a-radio value=\"2\">{{ t('opt_disable') }}</a-radio>\r\n        </a-radio-group>\r\n      </div>\r\n      <div class=\"desc\">{{ t('desc_advanced_permission') }}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, watch} from 'vue'\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-update-advanced')\r\n\r\nconst props = defineProps({\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\nconst emit = defineEmits(['update', 'updateVar'])\r\n\r\nconst atInputRef = ref(null)\r\nconst state = reactive({\r\n  name: \"\",\r\n  is_advanced: '0',\r\n  tag_map: {},\r\n})\r\n\r\nfunction init(nodeParams = null) {\r\n  if (nodeParams && nodeParams?.plugin?.params?.arguments) {\r\n    Object.assign(state, nodeParams.plugin.params.arguments)\r\n  }\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  state[field] = val\r\n  state.tag_map[field] = tags\r\n  update()\r\n}\r\n\r\nfunction advancedChange(val) {\r\n  state.is_advanced = val ? '1' : '0'\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  emit('update', JSON.parse(JSON.stringify(state)))\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  update\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"common\";\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"main-box\">\r\n    <div v-if=\"loadingF || loading\" class=\"loading-box\">\r\n      <a-spin/>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('title_input') }}</div>\r\n        <a-select\r\n          v-if=\"Object.keys(configData).length\"\r\n          v-model:value=\"currentConfigName\"\r\n          @change=\"configChange\">\r\n          <a-select-option v-for=\"item in configData\" :key=\"item.name\" :value=\"item.name\">\r\n            {{ item.name }}\r\n          </a-select-option>\r\n        </a-select>\r\n        <a-button v-else @click=\"showConfigModal\">{{ t('btn_unauthorized') }} <DownOutlined/></a-button>\r\n      </div>\r\n      <template v-if=\"'create_bitable' != actionName\">\r\n        <div class=\"options-item is-required\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_multidimensional_table') }}</div>\r\n          </div>\r\n          <div class=\"min-input\">\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 33px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"formState.tag_map?.app_token || []\"\r\n              :defaultValue=\"formState.app_token\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(val, tags) => changeValue('app_token', val, tags)\"\r\n              :placeholder=\"t('ph_input_document_url')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n          </div>\r\n          <div class=\"desc\">{{ t('desc_multidimensional_table_id') }}</div>\r\n        </div>\r\n        <div v-if=\"!['table_add_members', 'update_advanced', 'roles_list', 'create_tables'].includes(actionName)\" class=\"options-item is-required\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_select_table') }}</div>\r\n          </div>\r\n          <div class=\"flex-center min-input\">\r\n            <a-select v-model:value=\"formState.table_set_type\" @change=\"tableSetChange\" style=\"width: 112px;flex-shrink: 0;\">\r\n              <a-select-option value=\"1\">{{ t('label_select_table') }}</a-select-option>\r\n              <a-select-option value=\"2\">{{ t('label_insert_variable') }}</a-select-option>\r\n            </a-select>\r\n            <a-select\r\n              v-if=\"formState.table_set_type == 1\"\r\n              v-model:value=\"formState.table_id\"\r\n              @change=\"tableChange\"\r\n              :placeholder=\"formState.app_token ? t('ph_select_table') : t('ph_input_multidimensional_url_first')\"\r\n              style=\"width: 100%;\">\r\n              <a-select-option\r\n                v-for=\"item in tables\"\r\n                :key=\"item.table_id\"\r\n                :value=\"item.table_id\">\r\n                {{ item.name }}\r\n              </a-select-option>\r\n            </a-select>\r\n            <AtInput\r\n              v-else\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 33px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"formState.tag_map?.table_id || []\"\r\n              :defaultValue=\"formState.table_id\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(val, tags) => changeValue('table_id', val, tags)\"\r\n              :placeholder=\"t('ph_input_table_id')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n          </div>\r\n          <div class=\"desc\">{{ t('desc_table_id_example') }}</div>\r\n        </div>\r\n      </template>\r\n      <FeishuBatchBox\r\n        v-if=\"BatchActions.includes(actionName)\"\r\n        ref=\"childRef\"\r\n        :variableOptions=\"variableOptions\"\r\n        :actionName=\"actionName\"\r\n        :action=\"action\"\r\n        @updateVar=\"emit('updateVar')\"\r\n        @update=\"update\"\r\n      />\r\n      <component\r\n        v-else\r\n        ref=\"childRef\"\r\n        :is=\"actionComponentMap[actionName]\"\r\n        :tableId=\"formState.table_id\"\r\n        :fields=\"fields\"\r\n        :variableOptions=\"variableOptions\"\r\n        :config=\"{\r\n           ...currentConfig,\r\n           ...formState\r\n        }\"\r\n        @update=\"update\"\r\n        @updateVar=\"emit('updateVar')\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('title_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n\r\n    <FeishuConfigModal ref=\"configModalRef\" @change=\"loadConfig(true)\"/>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, onMounted, computed, inject, nextTick} from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport FeishuInsertData from \"./feishu-insert-data.vue\";\r\nimport FeishuUpdateData from \"./feishu-update-data.vue\";\r\nimport FeishuDelData from \"./feishu-del-data.vue\";\r\nimport FeishuSearchData from \"./feishu-search-data.vue\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {BatchActions, ShowFieldTypes} from \"@/constants/feishu-table.js\";\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.feishu-bittable.feishu-bittable-box')\r\nimport FeishuBatchBox from \"./feishu-batch-box.vue\";\r\nimport {getPluginActionDefaultArguments, pluginOutputToTree, getPluginConfigData} from \"@/constants/plugin.js\";\r\nimport {DownOutlined} from '@ant-design/icons-vue';\r\nimport FeishuConfigModal from \"@/views/explore/plugins/components/feishu-config-modal.vue\";\r\nimport FeishuCreateBitable from \"./feishu-create-bitable.vue\";\r\nimport FeishuCreateTable from \"./feishu-create-table.vue\";\r\nimport FeishuCreateView from \"./feishu-create-view.vue\";\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport {isValidURL} from \"@/utils/validate.js\";\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\nimport FeishuAddMembers from \"./feishu-add-members.vue\";\r\nimport FeishuUpdateAdvanced from \"./feishu-update-advanced.vue\";\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst actionComponentMap = {\r\n  search_records: FeishuSearchData,\r\n  create_record: FeishuInsertData,\r\n  update_record: FeishuUpdateData,\r\n  delete_record: FeishuDelData,\r\n  create_bitable: FeishuCreateBitable,\r\n  create_tables: FeishuCreateTable,\r\n  create_views: FeishuCreateView,\r\n  table_add_members: FeishuAddMembers,\r\n  update_advanced: FeishuUpdateAdvanced,\r\n}\r\nconst pluginName = 'feishu_bitable'\r\n\r\nconst childRef = ref(null)\r\nconst configModalRef = ref(null)\r\nconst configData = ref({})\r\nconst currentConfigName = ref(null)\r\nconst formState = reactive({\r\n  app_token: '',\r\n  table_id: undefined,\r\n  tag_map: {},\r\n  table_set_type: '1',\r\n})\r\nconst loading = ref(false)\r\nconst loadingF = ref(false)\r\nconst tableData = ref({})\r\nconst tables = ref([])\r\nconst fields = ref([])\r\n\r\nconst currentConfig = computed(() => {\r\n  return configData.value?.[currentConfigName.value] || {}\r\n})\r\nconst outputData = ref([])\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n\r\nasync function init() {\r\n  await loadConfig()\r\n  nodeParamsAssign()\r\n  outputFormat()\r\n}\r\n\r\nfunction showConfigModal() {\r\n  configModalRef.value.show(configData.value)\r\n}\r\n\r\nasync function loadConfig(refresh=false) {\r\n  await getPluginConfigData(pluginName, refresh).then(res => {\r\n    configData.value = res || {}\r\n    for (let name in configData.value) {\r\n      if (configData.value[name].is_default) {\r\n        currentConfigName.value = name\r\n        break\r\n      }\r\n    }\r\n    if (!currentConfigName.value) currentConfigName.value = Object.keys(configData.value)[0]\r\n  })\r\n}\r\n\r\nfunction loadTables() {\r\n  loading.value = true\r\n  tableData.value = {}\r\n  tables.value = []\r\n  if (!isValidURL(formState.app_token) || (Array.isArray(formState.tag_map?.app_token) && formState.tag_map.app_token.length)) {\r\n    loading.value = false\r\n    return Promise.resolve(null)\r\n  }\r\n  return runPlugin({\r\n    name: 'feishu_bitable',\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'get_tables',\r\n      arguments: {\r\n        app_id: currentConfig.value.appid,\r\n        app_secret: currentConfig.value.app_secret,\r\n        app_token: formState.app_token\r\n      }\r\n    })\r\n  }).then(res => {\r\n    tableData.value = res?.data || {}\r\n    tables.value = tableData.value.items || []\r\n    if (!formState.table_id && tables.value.length == 1) {\r\n      formState.table_id = tables.value[0].table_id\r\n      tableChange()\r\n    }\r\n    return res\r\n  }).catch(() => {\r\n    tableData.value = {}\r\n    tables.value = []\r\n    if (formState.table_set_type == 1) {\r\n      formState.table_id = undefined\r\n    }\r\n    fields.value = []\r\n    return null\r\n  }).finally(() => {\r\n    loading.value = false\r\n  })\r\n}\r\n\r\nfunction loadFields() {\r\n  loadingF.value = true\r\n  if (!isValidURL(formState.app_token) || !formState.table_id || formState.tag_map?.table_id?.length) {\r\n    loadingF.value = false\r\n    return Promise.resolve(null)\r\n  }\r\n  return runPlugin({\r\n    name: 'feishu_bitable',\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'get_table_fields',\r\n      arguments: {\r\n        app_id: currentConfig.value.appid,\r\n        app_secret: currentConfig.value.app_secret,\r\n        app_token: formState.app_token,\r\n        table_id: formState.table_id\r\n      }\r\n    })\r\n  }).then(res => {\r\n    let items = res?.data?.items || []\r\n    fields.value = items.filter(i => ShowFieldTypes.includes(i.ui_type))\r\n    return res\r\n  }).finally(() => {\r\n    loadingF.value = false\r\n  })\r\n}\r\n\r\nfunction paramsFormat(val) {\r\n  if (!val) {\r\n    return getPluginActionDefaultArguments(pluginName, props.actionName)\r\n  }\r\n  val = JSON.parse(JSON.stringify(val))\r\n  for (let key in val) {\r\n    switch (key) {\r\n      case 'filter':\r\n        if (Array.isArray(val.filter.conditions) && val.filter.conditions.length) {\r\n          for (let item of val.filter.conditions) {\r\n            if ('DateTime' === item.field_type && item.value) {\r\n              if (item.value < 1e11) item.value *= 1000\r\n              // 后端要求DateTime添加了特殊标记\r\n              item.value = ['ExactDate', item.value].join(',')\r\n            }\r\n          }\r\n        }\r\n        break\r\n      case 'fields':\r\n        for (let item of val.fields) {\r\n          if (item?.atTags?.length) continue\r\n          if (item.value != '') {\r\n            if (['DateTime', 'Number', 'Rating', 'Progress', 'Currency'].includes(item.ui_type)) {\r\n              item.value = Number(item.value)\r\n            }\r\n            if ('Currency' === item.ui_type) item.value = item.value.toFixed(2)\r\n          }\r\n          if ('Checkbox' === item.ui_type) {\r\n            item.value = (item.value == 'true')\r\n          }\r\n          if ('MultiSelect' === item.ui_type) {\r\n            if (Array.isArray(item.value)) {\r\n              // 已经是数组，无需处理\r\n            } else if (typeof item.value === 'string') {\r\n              const v = item.value.trim()\r\n              item.value = v ? v.replace(/，/g, ',').split(',') : []\r\n            } else {\r\n              item.value = []\r\n            }\r\n          }\r\n          if ('DateTime' === item.ui_type) {\r\n            if (item.value < 1e11) item.value *= 1000\r\n          }\r\n        }\r\n        break\r\n      case 'field_names':\r\n        val.field_names = val.field_names.map(i => i.field_name)\r\n        break\r\n      case 'sort':\r\n        val.sort = val.sort.map(i => {\r\n          return {\r\n            field_name: i.field_name,\r\n            desc: (i.is_asc != 1)\r\n          }\r\n        })\r\n        break\r\n      case 'input_type_map':\r\n        // 查询条件的json输入\r\n        for (let f in val[key]) {\r\n          if (val[key][f] == 2) {\r\n            val[f] = jsonDecode(val[`${f}_json`], f == 'filter' ? {} : [])\r\n          }\r\n        }\r\n        break\r\n    }\r\n  }\r\n  if (val.tag_map) {\r\n    formState.tag_map = {\r\n      ...val.tag_map,\r\n      app_token: formState?.tag_map?.app_token || [],\r\n      table_id: formState?.tag_map?.table_id || [],\r\n    }\r\n  }\r\n\r\n  delete val.field_names_json\r\n  delete val.filter_json\r\n  delete val.sort_json\r\n  delete val.fields_json\r\n  return val\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let arg = nodeParams?.plugin?.params?.arguments || {}\r\n  if (arg.table_set_type) formState.table_set_type = arg.table_set_type\r\n  if (arg.tag_map) formState.tag_map = arg.tag_map\r\n  if (arg.app_token) formState.app_token = arg.app_token\r\n  if (arg.table_id) formState.table_id = arg.table_id\r\n  if (arg.app_id && arg.app_secret) {\r\n    for (let name in configData.value) {\r\n      let i = configData.value[name]\r\n      if (i.appid == arg.app_id && i.app_secret == arg.app_secret) {\r\n        currentConfigName.value = name\r\n      }\r\n    }\r\n  }\r\n  compInit(nodeParams)\r\n  if (formState.app_token\r\n    && !['table_add_members', 'update_advanced'].includes(props.actionName)) {\r\n    loadTables()\r\n  }\r\n  if (formState.table_id) {\r\n    loadFields().then(() => compInit(nodeParams))\r\n  }\r\n}\r\n\r\nfunction tableSetChange () {\r\n  if (formState.table_set_type == 1) {\r\n    formState.table_id = tables.value?.[0]?.table_id || undefined\r\n    formState.tag_map.table_id = []\r\n    fields.value = []\r\n    loadFields().then(() => compInit())\r\n  } else {\r\n    formState.table_id = ''\r\n    fields.value = []\r\n    if (props.actionName === 'create_record') {\r\n      compInit({ plugin: { params: { arguments: { fields: [] } } } })\r\n    } else {\r\n      compInit()\r\n    }\r\n  }\r\n  update({ fields: [] })\r\n}\r\n\r\nfunction changeValue(field, val, tags) {\r\n  formState[field] = val\r\n  formState.tag_map[field] = tags\r\n  if (field === 'app_token') {\r\n    tokenChange()\r\n  } else if (field === 'table_id') {\r\n    tableChange()\r\n  } else {\r\n    update()\r\n  }\r\n}\r\n\r\nfunction configChange() {\r\n  if (formState.app_token) {\r\n    loadTables().then(() => compInit())\r\n  } else {\r\n    compInit()\r\n  }\r\n  if (formState.table_id) {\r\n    loadFields().then(() => compInit())\r\n  }\r\n  update()\r\n}\r\n\r\nfunction tokenChange() {\r\n  const prevTableId = formState.table_id\r\n  fields.value = []\r\n  loadTables().then(() => {\r\n    const exists = tables.value.find(i => i.table_id == prevTableId)\r\n    if (formState.table_set_type == 2) {\r\n      formState.table_id = prevTableId\r\n      if (props.actionName === 'create_record') {\r\n        typeof childRef.value?.clear === 'function' && childRef.value.clear()\r\n      }\r\n      if (props.actionName === 'search_records') {\r\n        typeof childRef.value?.clearSelections === 'function' && childRef.value.clearSelections()\r\n      }\r\n      compInit()\r\n    } else {\r\n      if (exists) {\r\n        formState.table_id = prevTableId\r\n        loadFields().then(() => {\r\n          if (props.actionName === 'create_record') {\r\n            typeof childRef.value?.clear === 'function' && childRef.value.clear()\r\n          } else if (props.actionName !== 'create_tables' && props.actionName !== 'create_views' && props.actionName !== 'create_bitable') {\r\n            compInit({ plugin: { params: { arguments: { fields: [] } } } })\r\n          } else {\r\n            compInit()\r\n          }\r\n          if (props.actionName === 'search_records') {\r\n            typeof childRef.value?.clearSelections === 'function' && childRef.value.clearSelections()\r\n          }\r\n        })\r\n      } else {\r\n        formState.table_id = undefined\r\n        if (props.actionName === 'create_record') {\r\n          typeof childRef.value?.clear === 'function' && childRef.value.clear()\r\n        } else if (props.actionName !== 'create_tables' && props.actionName !== 'create_views' && props.actionName !== 'create_bitable') {\r\n          compInit({ plugin: { params: { arguments: { fields: [] } } } })\r\n        } else {\r\n          compInit()\r\n        }\r\n        if (props.actionName === 'search_records') {\r\n          typeof childRef.value?.clearSelections === 'function' && childRef.value.clearSelections()\r\n        }\r\n      }\r\n    }\r\n  }).catch(() => {\r\n    tables.value = []\r\n    fields.value = []\r\n    if (formState.table_set_type == 1) {\r\n      formState.table_id = undefined\r\n      if (props.actionName === 'create_record') {\r\n        typeof childRef.value?.clear === 'function' && childRef.value.clear()\r\n      } else if (props.actionName !== 'create_tables' && props.actionName !== 'create_views' && props.actionName !== 'create_bitable') {\r\n        compInit({ plugin: { params: { arguments: { fields: [] } } } })\r\n      } else {\r\n        compInit()\r\n      }\r\n    } else {\r\n      // 插入变量模式保持用户输入\r\n      if (props.actionName === 'create_record') {\r\n        typeof childRef.value?.clear === 'function' && childRef.value.clear()\r\n      } else {\r\n        compInit()\r\n      }\r\n    }\r\n    if (props.actionName === 'search_records') {\r\n      typeof childRef.value?.clearSelections === 'function' && childRef.value.clearSelections()\r\n    }\r\n  })\r\n  update()\r\n}\r\n\r\nfunction tableChange() {\r\n  fields.value = []\r\n  loadFields().then(() => {\r\n    update({ fields: [] })\r\n    compInit()\r\n  })\r\n}\r\n\r\nfunction compInit(nodeParams=null) {\r\n  nextTick(() => {\r\n    const np = nodeParams ?? JSON.parse(props.node.node_params)\r\n    typeof childRef.value?.init === \"function\" && childRef.value.init(np)\r\n  })\r\n}\r\n\r\nfunction update(val = null) {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let table = tables.value.find(i => i.table_id == formState.table_id)\r\n  const prevArgs = nodeParams?.plugin?.params?.arguments || {}\r\n  const nextPart = val ? paramsFormat(val) : {}\r\n  const mergedTagMap = {\r\n    ...(prevArgs?.tag_map || {}),\r\n    ...(nextPart?.tag_map || {}),\r\n    ...(formState?.tag_map || {})\r\n  }\r\n  const mergedArgs = {\r\n    ...prevArgs,\r\n    ...nextPart,\r\n    ...formState,\r\n    tag_map: mergedTagMap,\r\n    app_id: currentConfig.value.appid,\r\n    app_secret: currentConfig.value.app_secret,\r\n  }\r\n  nodeParams.plugin.output_obj = outputData.value\r\n  nodeParams.plugin.params = nodeParams.plugin.params || {}\r\n  nodeParams.plugin.params.config_name = currentConfigName.value\r\n  nodeParams.plugin.params.table_name = table?.name || ''\r\n  nodeParams.plugin.params.arguments = mergedArgs\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nfunction outputFormat() {\r\n  outputData.value = pluginOutputToTree(props.action.output)\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"common\";\r\n.loading-box {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 99;\r\n}\r\n.node-options {\r\n  background: #f2f4f7;\r\n  border-radius: 6px;\r\n  padding: 12px;\r\n  margin-top: 16px;\r\n\r\n  &:first-child {\r\n    margin-top: 0;\r\n  }\r\n\r\n  .options-title {\r\n    color: var(--wf-color-text-1);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    font-weight: 600;\r\n    height: 22px;;\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    margin-bottom: 16px;\r\n\r\n    .title-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      vertical-align: -3px;\r\n      margin-right: 8px;;\r\n    }\r\n\r\n    .acton-box {\r\n      font-weight: 400;\r\n    }\r\n  }\r\n}\r\n\r\n.flex-center {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('label_input') }}</div>\r\n        <slot name=\"input-title-extra\"></slot>\r\n      </div>\r\n      <template v-for=\"(item, key) in formState\" :key=\"key\">\r\n        <slot v-if=\"$slots[key]\" :state=\"formState\" :name=\"key\" :item=\"item\" :keyName=\"key\"></slot>\r\n        <div v-else :class=\"['options-item', {'is-required': item.required}]\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ getLabel(item, key) }}</div>\r\n            <div class=\"option-type\">{{ item.type }}</div>\r\n          </div>\r\n          <div>\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 64px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"item.tags\"\r\n              :defaultValue=\"item.value\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(text, selectedList) => changeValue(item, text, selectedList, key)\"\r\n              :placeholder=\"getPlaceholder(key)\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n          </div>\r\n          <div class=\"desc\">{{ item.desc }}</div>\r\n          <div v-if=\"item.__error\" class=\"desc\" style=\"color: #FB363F\">{{ item.__error }}</div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('label_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, watch, inject} from 'vue';\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {pluginOutputToTree} from \"@/constants/plugin.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.pluginFormRender')\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  params: {\r\n    type: Object,\r\n  },\r\n  output: {\r\n    type: Object,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  },\r\n  keepFormatField: {\r\n    type: Array,\r\n    default: () => ([])\r\n  }\r\n})\r\nconst setData = inject('setData')\r\n\r\nconst formState = reactive({})\r\nconst outputData = ref([])\r\nconst nodeParams = JSON.parse(props.node.node_params)\r\n\r\nconst fieldRules = {\r\n  url: {\r\n    label: (item, key) => item?.name || key,\r\n    placeholder: t('ph_url_param'),\r\n    validate: (item) => {\r\n      const hasVar = Array.isArray(item.tags) && item.tags.length > 0\r\n      if (hasVar) { item.__error = null; return true }\r\n      const v = String(item.value || '').trim()\r\n      const ok = v.startsWith('https:/')\r\n      item.__error = ok ? null : t('msg_invalid_url')\r\n      return ok\r\n    }\r\n  }\r\n}\r\n\r\nwatch(formState, (newVal) => {\r\n  update()\r\n}, {\r\n  deep: true,\r\n})\r\n\r\nwatch(() => props.params, (newVal) => {\r\n  Object.assign(formState, JSON.parse(JSON.stringify(newVal || '{}')))\r\n  let _args = nodeParams?.plugin?.params?.arguments || {}\r\n  let val\r\n  for (let key in formState) {\r\n    // 1、是否已设置值 2、是否存在默认值\r\n    val = _args[key] || ''\r\n    if (!val && Object.hasOwn(formState[key], 'default')) {\r\n      val = formState[key].default\r\n    }\r\n    if (!props.keepFormatField.includes(key)) val = String(val)\r\n    if (val === 'null') val = null\r\n    formState[key].value = val\r\n    formState[key].tags = _args?.tag_map?.[key] || []\r\n  }\r\n}, {\r\n  deep: true,\r\n  immediate: true\r\n})\r\n\r\nwatch(() => props.output, (newVal) => {\r\n  outputData.value = pluginOutputToTree(JSON.parse(JSON.stringify(props.output || '{}')))\r\n}, {\r\n  deep: true,\r\n  immediate: true\r\n})\r\n\r\n\r\n\r\nfunction changeValue(item, text, selectedList, key) {\r\n  item.value = text\r\n  item.tags = selectedList\r\n  validateField(key, item)\r\n  update()\r\n}\r\n\r\nfunction getLabel(item, key) {\r\n  const r = fieldRules[key]\r\n  if (r && r.label) return r.label(item, key)\r\n  return item?.name || key\r\n}\r\n\r\nfunction getPlaceholder(key) {\r\n  const r = fieldRules[key]\r\n  if (r && r.placeholder) return r.placeholder\r\n  return t('ph_input_content')\r\n}\r\n\r\nfunction validateField(key, item) {\r\n  const r = fieldRules[key]\r\n  if (r && r.validate) return r.validate(item)\r\n  item.__error = null\r\n  return true\r\n}\r\n\r\nfunction update() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  nodeParams.plugin.output_obj = outputData.value\r\n  let _args = {\r\n    tag_map: {}\r\n  }\r\n  let value\r\n  for (let key in formState) {\r\n    value = formState[key].value\r\n    if (formState[key]?.tags?.length) {\r\n      //\r\n    } else if(formState[key].type == 'string'){\r\n      value = String(value)\r\n    } else if(['number', 'integer'].includes(formState[key].type)){\r\n      value = Number(value)\r\n    }\r\n    _args[key] = value\r\n    _args.tag_map[key] = formState[key].tags\r\n  }\r\n  Object.assign(nodeParams.plugin.params, {\r\n    arguments: {\r\n      ..._args\r\n    }\r\n  })\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nfunction setState(d = {}) {\r\n  Object.assign(formState, d)\r\n  update()\r\n}\r\n\r\ndefineExpose({\r\n  setState,\r\n})\r\n</script>\r\n\r\n<style lang=\"less\">\r\n@import \"node-options\";\r\n</style>\r\n","<template>\r\n  <PluginFormRender\r\n    :node=\"node\"\r\n    :params=\"params\"\r\n    :output=\"action.output\"\r\n    :variableOptions=\"variableOptions\"\r\n    :keepFormatField=\"['tagid', 'tag_type']\"\r\n    @updateVar=\"emit('updateVar')\"\r\n  >\r\n    <template #tag_name></template>\r\n    <template #tag_type></template>\r\n\r\n    <template #app_name></template>\r\n    <template #app_secret></template>\r\n    <template #app_id=\"{ state, item, keyName}\">\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"item.value\"\r\n            :placeholder=\"t('ph_select_official_account')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"(value, option) => appChange(state, option)\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"app in apps\"\r\n              :key=\"app.app_id\"\r\n              :value=\"app.app_id\"\r\n              :name=\"app.app_name\"\r\n              :secret=\"app.app_secret\"\r\n            >\r\n              {{ app.app_name }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n    </template>\r\n    <template #tagid=\"{ state, item, keyName}\">\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account_tag') }}</div>\r\n          <a-tooltip :title=\"t('tooltip_sync_tags')\">\r\n            <a @click=\"syncTags\">{{ t('btn_sync') }} <a-spin v-if=\"syncing\" size=\"small\"/></a>\r\n          </a-tooltip>\r\n        </div>\r\n        <div class=\"tag-box\">\r\n          <a-select\r\n            v-model:value=\"state.tag_type.value\"\r\n            @change=\"tagTypeChange(state)\"\r\n            style=\"width: 120px;\"\r\n          >\r\n            <a-select-option :value=\"1\">{{ t('btn_select_tag') }}</a-select-option>\r\n            <a-select-option :value=\"2\">{{ t('btn_insert_variable') }}</a-select-option>\r\n          </a-select>\r\n          <a-select\r\n            v-if=\"state.tag_type.value == 1\"\r\n            v-model:value=\"item.value\"\r\n            :placeholder=\"t('ph_select_tag')\"\r\n            show-search\r\n            :filter-option=\"filterOption\"\r\n            style=\"width: 100%;\"\r\n            @change=\"(val,opt) => tagChange(state,val,opt)\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"item in tags\"\r\n              :key=\"item.id\"\r\n              :value=\"item.id\"\r\n              :name=\"item.name\"\r\n            >\r\n              {{ item.name }}\r\n            </a-select-option>\r\n          </a-select>\r\n          <AtInput\r\n            v-else\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 33px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"item.tags || []\"\r\n            :defaultValue=\"item.value\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </PluginFormRender>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, onMounted} from 'vue';\r\nimport { useI18n } from '@/hooks/web/useI18n';\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport {getWechatAppList} from \"@/api/robot/index.js\";\r\nimport PluginFormRender from \"../pluginFormRender.vue\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport {jsonDecode, sortObjectKeys} from \"@/utils/index.js\";\r\nimport {message} from 'ant-design-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.official-account.official-account-box');\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst apps = ref([])\r\nconst tags = ref([])\r\nconst params = ref({})\r\nconst syncing = ref(false)\r\nconst config = ref({\r\n  app_id: '',\r\n  app_secret: '',\r\n})\r\n\r\nonMounted(() => {\r\n  loadWxApps()\r\n  getParams()\r\n  if (props.actionName === 'getTagFans') {\r\n    let node_params = jsonDecode(props.node?.node_params)\r\n    if (node_params) {\r\n      let args = node_params?.plugin?.params?.arguments || {}\r\n      const {app_id, app_secret} = args\r\n      if (app_id && app_secret) {\r\n        config.value = {app_id, app_secret}\r\n        loadTags()\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nfunction getParams() {\r\n  const baseParams = {\r\n    ...props.action.params,\r\n    app_id: {\r\n      ...props.action.params.app_id,\r\n      default: null,\r\n    },\r\n    app_name: {\r\n      desc: t('label_official_account_name'),\r\n      type: 'string',\r\n    },\r\n  }\r\n\r\n  if (props.actionName === 'getTagFans') {\r\n    Object.assign(baseParams, {\r\n      tagid: {\r\n        ...props.action.params.tagid,\r\n        default: null,\r\n      },\r\n      tag_name: {\r\n        desc: t('label_tag_name'),\r\n        type: 'string',\r\n      },\r\n      tag_type: {\r\n        desc: t('label_tag_type'),\r\n        type: 'number',\r\n        default: 1,\r\n      }\r\n    })\r\n    params.value = sortObjectKeys(baseParams, ['app_id', 'tagid'])\r\n  } else {\r\n    params.value = baseParams\r\n  }\r\n}\r\n\r\n\r\nfunction loadWxApps() {\r\n  getWechatAppList({app_type: 'official_account'}).then(res => {\r\n    apps.value = res?.data || []\r\n  })\r\n}\r\n\r\nfunction syncTags() {\r\n  if (!config.value.app_secret || !config.value.app_id) {\r\n    return message.warning(t('msg_please_select_official_account'))\r\n  }\r\n  if (syncing.value) return\r\n  syncing.value = true\r\n  loadTags().then(() => {\r\n    message.success(t('msg_sync_completed'))\r\n  }).finally(() => {\r\n    syncing.value = false\r\n  })\r\n}\r\n\r\nfunction loadTags() {\r\n  return runPlugin({\r\n    name: 'official_account_profile',\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'getTags',\r\n      arguments:  config.value\r\n    })\r\n  }).then(res => {\r\n    tags.value = res?.data?.tags || []\r\n    return res\r\n  })\r\n}\r\n\r\nfunction appChange(state, option) {\r\n  state.app_secret.value = option.secret\r\n  state.app_name.value = option.name\r\n  if (props.actionName === 'getTagFans') {\r\n    config.value = {\r\n      app_id: option.key,\r\n      app_secret:  option.secret\r\n    }\r\n    loadTags()\r\n  }\r\n}\r\n\r\nfunction tagTypeChange(state) {\r\n  state.tag_name.value = ''\r\n  if (state.tag_type.value == 1) {\r\n    state.tagid.value = null\r\n  } else {\r\n    state.tagid.value = ''\r\n  }\r\n}\r\n\r\nfunction tagChange(state, val, opt) {\r\n  state.tag_name.value = opt.name\r\n  console.log('state', state)\r\n}\r\n\r\nfunction changeValue(item, text, selectedList) {\r\n  item.value = text\r\n  item.tags = selectedList\r\n}\r\n\r\nconst filterOption = (input, option) => {\r\n  return option.name.toLowerCase().indexOf(input.toLowerCase()) >= 0;\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.tag-box {\r\n  display: flex;\r\n  align-items: center;\r\n  :deep(.mention-input-warpper) {\r\n    height: 33px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"tpl-container\">\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('label_section_input') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"formState.app_id\"\r\n            :placeholder=\"t('ph_select_official_account')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"appChange\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"app in apps\"\r\n              :key=\"app.app_id\"\r\n              :name=\"app.app_name\"\r\n              :secret=\"app.app_secret\"\r\n            >\r\n              {{ app.app_name }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_template') }}</div>\r\n          <a-tooltip :title=\"t('tooltip_sync_templates')\">\r\n            <a @click=\"syncTemplates\">{{ t('btn_sync') }} <a-spin v-if=\"syncing\" size=\"small\"/></a>\r\n          </a-tooltip>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"formState.template_id\"\r\n            :placeholder=\"t('ph_select_template')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"templateChange\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"item in templates\"\r\n              :key=\"item.template_id\"\r\n              :name=\"item.title\"\r\n              :content=\"item.content\"\r\n            >\r\n              {{ item.title }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_receiver_openid') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.touser || []\"\r\n            :defaultValue=\"formState.touser\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('touser', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{ t('desc_receiver_openid') }}</div>\r\n      </div>\r\n      <div\r\n        v-for=\"(opt, key) in formState.data\"\r\n        class=\"options-item is-required\"\r\n        :key=\"key\"\r\n      >\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ opt.title }}</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"opt.tags\"\r\n            :defaultValue=\"opt.value\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeValue(opt, text, selectedList, key)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div v-if=\"opt.desc\" :class=\"['desc', {error: opt.format_err}]\">{{opt.desc}}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_jump_type') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-radio-group\r\n            v-model:value=\"formState.link_type\"\r\n            @change=\"linkTypeChange\"\r\n          >\r\n            <a-radio :value=\"0\">{{ t('opt_jump_none') }}</a-radio>\r\n            <a-radio :value=\"1\">{{ t('opt_jump_link') }}</a-radio>\r\n            <a-radio :value=\"2\">{{ t('opt_jump_miniprogram') }}</a-radio>\r\n          </a-radio-group>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"formState.link_type == 1\" class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_link') }}</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.url || []\"\r\n            :defaultValue=\"formState.url\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('url', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n      </div>\r\n      <template v-else-if=\"formState.link_type == 2\">\r\n        <div class=\"options-item is-required\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_miniprogram_appid') }}</div>\r\n          </div>\r\n          <div>\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 64px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultValue=\"formState.miniprogram.appid.value\"\r\n              :defaultSelectedList=\"formState.miniprogram.appid.tags\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(text, selectedList) => changeValue(formState.miniprogram.appid, text, selectedList)\"\r\n              :placeholder=\"t('ph_input_content')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n          </div>\r\n          <div class=\"desc\">{{ t('desc_miniprogram_appid') }}</div>\r\n        </div>\r\n        <div class=\"options-item is-required\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_miniprogram_path') }}</div>\r\n          </div>\r\n          <div>\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 64px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultValue=\"formState.miniprogram.pagepath.value\"\r\n              :defaultSelectedList=\"formState.miniprogram.pagepath.tags\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(text, selectedList) => changeValue(formState.miniprogram.pagepath, text, selectedList)\"\r\n              :placeholder=\"t('ph_input_content')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('label_section_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, onMounted, watch, inject} from 'vue';\r\nimport { useI18n } from 'vue-i18n';\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport {getWechatAppList} from \"@/api/robot/index.js\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport {pluginOutputToTree} from \"@/constants/plugin.js\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {message} from 'ant-design-vue';\r\n\r\nconst { t } = useI18n();\r\n\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst pluginName = 'official_send_template_message'\r\nconst outputData = ref([])\r\nconst apps = ref([])\r\nconst syncing = ref(false)\r\nconst templates = ref([])\r\nconst formState = reactive({\r\n  app_id: undefined,\r\n  template_id: undefined,\r\n  app_secret: '',\r\n  touser: '',\r\n  url: '',\r\n  data: {},\r\n  miniprogram: {\r\n    appid: {\r\n      value: '',\r\n      tags: [],\r\n    },\r\n    pagepath: {\r\n      value: '',\r\n      tags: [],\r\n    }\r\n  },\r\n  link_type: 0,\r\n  tag_map: {}\r\n})\r\n\r\n// Validation rules object\r\nconst getRegObj = () => ({\r\n  thing: {\r\n    reg: /^[\\u4e00-\\u9fa5a-zA-Z0-9\\W_]{1,20}$/,\r\n    txt: t('msg_validation_thing')\r\n  },\r\n  short_thing: {\r\n    reg: /^[\\u4e00-\\u9fa5a-zA-Z0-9\\W_]{1,5}$/,\r\n    txt: t('msg_validation_short_thing')\r\n  },\r\n  number: {\r\n    reg: /^\\d{1,32}(.\\d{1,2})?$/,\r\n    txt: t('msg_validation_number')\r\n  },\r\n  const: {\r\n    reg: /^[\\u4e00-\\u9fa5a-zA-Z0-9\\W_]{1,20}$/,\r\n    txt: t('msg_validation_const')\r\n  },\r\n  letter: {\r\n    reg: /^[a-zA-Z]{1,32}$/,\r\n    txt: t('msg_validation_letter')\r\n  },\r\n  symbol: {\r\n    reg: /^[\\W_]{1,5}$/,\r\n    txt: t('msg_validation_symbol')\r\n  },\r\n  character_string: {\r\n    reg: /^[a-zA-Z0-9\\W_]{1,32}$/,\r\n    txt: t('msg_validation_character_string')\r\n  },\r\n  time: {\r\n    reg: /^\\d{4}年\\d{1,2}月\\d{1,2}日\\s+\\d{1,2}:\\d{1,2}(:\\d{1,2})?(~\\d{4}年\\d{1,2}月\\d{1,2}日\\s+\\d{1,2}:\\d{1,2}(:\\d{1,2})?)?$/,\r\n    txt: t('msg_validation_time')\r\n  },\r\n  date: {\r\n    reg: /^\\d{4}年\\d{1,2}月\\d{1,2}日(\\s+\\d{1,2}:\\d{1,2}(:\\d{1,2})?)?(~\\d{4}年\\d{1,2}月\\d{1,2}日\\s+\\d{1,2}:\\d{1,2}(:\\d{1,2})?)?$/,\r\n    txt: t('msg_validation_date')\r\n  },\r\n  amount: {\r\n    reg: /^[$¥]?\\d{1,10}(.\\d{1,2})?[元]?$/,\r\n    txt: t('msg_validation_amount')\r\n  },\r\n  phone_number: {\r\n    reg: /^[0-9-+*# ]{5,17}$/,\r\n    txt: t('msg_validation_phone_number')\r\n  },\r\n  car_number: {\r\n    reg: /^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[a-zA-Z0-9]{6,7}[\\u4e00-\\u9fa5]{0,1}$/,\r\n    txt: t('msg_validation_car_number')\r\n  },\r\n  name: {\r\n    reg: /^(?:[\\u4e00-\\u9fa5]{1,10}|[a-zA-Z\\p{P}]{1,20})$/,\r\n    txt: t('msg_validation_name')\r\n  },\r\n  phrase: {\r\n    reg: /^[\\u4e00-\\u9fa5]{1,5}$/,\r\n    txt: t('msg_validation_phrase')\r\n  },\r\n})\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n\r\nwatch(() => props.action, () => {\r\n  outputData.value = pluginOutputToTree(JSON.parse(JSON.stringify(props.action?.output || '{}')))\r\n}, {\r\n  deep: true,\r\n  immediate: true\r\n})\r\n\r\nfunction init() {\r\n  loadWxApps()\r\n  nodeParamsAssign()\r\n}\r\n\r\nfunction loadWxApps() {\r\n  getWechatAppList({app_type: 'official_account'}).then(res => {\r\n    apps.value = res?.data || []\r\n  })\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let arg = nodeParams?.plugin?.params?.arguments || {}\r\n  Object.assign(formState, arg)\r\n  if (formState.template_id) {\r\n    loadTemplates()\r\n  }\r\n}\r\n\r\nfunction appChange(_, option) {\r\n  const {key, secret, name} = option\r\n  formState.app_secret = secret\r\n  formState.app_name = name\r\n  loadTemplates()\r\n}\r\n\r\nfunction templateChange(_, option) {\r\n  const {name, content} = option\r\n  formState.template_name = name\r\n  formState.data = parseWxTemplateToObj(content)\r\n}\r\n\r\nfunction syncTemplates() {\r\n  if (!formState.app_secret || !formState.app_id) {\r\n    return message.warning(t('msg_please_select_official_account'))\r\n  }\r\n  if (syncing.value) return\r\n  syncing.value = true\r\n  loadTemplates().then(() => {\r\n    message.success(t('msg_sync_completed'))\r\n  }).finally(() => {\r\n    syncing.value = false\r\n  })\r\n}\r\n\r\nfunction loadTemplates() {\r\n  return runPlugin({\r\n    name: pluginName,\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'getAllTemplates',\r\n      arguments: {\r\n        app_id: formState.app_id,\r\n        app_secret: formState.app_secret,\r\n      }\r\n    })\r\n  }).then(res => {\r\n    templates.value = res?.data?.template_list || []\r\n    return\r\n  })\r\n}\r\n\r\nfunction changeValue(item, text, selectedList, field=null) {\r\n  item.value = text;\r\n  item.tags = selectedList\r\n  if (field) {\r\n    // 模板内容进行正则校验\r\n    if (selectedList.length) {\r\n      item.format_err = false\r\n    } else {\r\n      wxTemplateContCheck(field, item)\r\n    }\r\n  }\r\n  update()\r\n}\r\n\r\nfunction changeFieldValue(field, text, selectedList) {\r\n  formState[field] = text\r\n  formState.tag_map[field] = selectedList\r\n  update()\r\n}\r\n\r\nfunction linkTypeChange() {\r\n  switch (formState.link_type) {\r\n    case 0:\r\n      formState.miniprogram.appid = {value: '', tags: []}\r\n      formState.miniprogram.pagepath = {value: '', tags: []}\r\n      formState.url = ''\r\n      break\r\n    case 1:\r\n      formState.miniprogram.appid = {value: '', tags: []}\r\n      formState.miniprogram.pagepath = {value: '', tags: []}\r\n      break\r\n    case 2:\r\n      formState.url = ''\r\n      break\r\n  }\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  nodeParams.plugin.output_obj = outputData.value\r\n  Object.assign(nodeParams.plugin.params, {\r\n    arguments: {\r\n      ...formState\r\n    }\r\n  })\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nfunction parseWxTemplateToObj(str) {\r\n  const obj = {};\r\n  const lines = str.split('\\n').map(s => s.trim()).filter(Boolean);\r\n  const regObj = getRegObj();\r\n\r\n  for (const line of lines) {\r\n    // 情况1：有标题，例如：标题:{{content.DATA}}\r\n    let match = line.match(/^(.*?):\\s*\\{\\{([\\w]+)\\.DATA\\}\\}$/);\r\n    if (match) {\r\n      let key = match[2].replace(/\\d/g, '')\r\n      obj[match[2]] = { title: match[1], value: '', tags: [], desc: regObj[key]?.txt || '', format_err: false};\r\n      continue;\r\n    }\r\n\r\n    // 情况2：无标题，例如：{{content.DATA}}\r\n    match = line.match(/^\\{\\{([\\w]+)\\.DATA\\}\\}$/);\r\n    if (match) {\r\n      obj[match[1]] = { title: match[1], value: '', tags: []};\r\n      continue;\r\n    }\r\n  }\r\n  return obj;\r\n}\r\n\r\nfunction wxTemplateContCheck(field, item) {\r\n  let key = field.replace(/\\d/g, '')\r\n  const regObj = getRegObj()\r\n  if(regObj[key] && !regObj[key].reg.test(item.value)) {\r\n    item.format_err = true\r\n  } else {\r\n    item.format_err = false\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"../node-options\";\r\n\r\n.tpl-container {\r\n  :deep(.mention-input-warpper) {\r\n    height: 48px;\r\n    .type-textarea {\r\n      height: 44px;\r\n      min-height: 44px;\r\n    }\r\n  }\r\n}\r\n\r\n.desc.error {\r\n  color: red !important;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"tag-container\">\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('label_section_input') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"formState.app_id\"\r\n            :placeholder=\"t('ph_select_official_account')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"appChange\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"app in apps\"\r\n              :key=\"app.app_id\"\r\n              :name=\"app.app_name\"\r\n              :secret=\"app.app_secret\"\r\n            >\r\n              {{ app.app_name }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account_tag') }}</div>\r\n          <a-tooltip :title=\"t('tooltip_sync_tags')\">\r\n            <a @click=\"syncTags\">{{ t('btn_sync') }} <a-spin v-if=\"syncing\" size=\"small\"/></a>\r\n          </a-tooltip>\r\n        </div>\r\n        <div class=\"tag-box\">\r\n          <a-select\r\n            v-model:value=\"formState.tag_type\"\r\n            @change=\"tagTypeChange\"\r\n            style=\"width: 120px;\"\r\n          >\r\n            <a-select-option :value=\"1\">{{ t('btn_select_tag') }}</a-select-option>\r\n            <a-select-option :value=\"2\">{{ t('btn_insert_variable') }}</a-select-option>\r\n          </a-select>\r\n          <a-select\r\n            v-if=\"formState.tag_type == 1\"\r\n            v-model:value=\"formState.tagid\"\r\n            :placeholder=\"t('ph_select_tag')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"tagChange\"\r\n            show-search\r\n            :filter-option=\"filterOption\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"item in tags\"\r\n              :key=\"item.id\"\r\n              :value=\"item.id\"\r\n              :name=\"item.name\"\r\n            >\r\n              {{ item.name }}\r\n            </a-select-option>\r\n          </a-select>\r\n          <AtInput\r\n            v-else\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 33px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.tagid || []\"\r\n            :defaultValue=\"formState.tagid\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('tagid', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_fans_openid_list') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.openid_list || []\"\r\n            :defaultValue=\"formState.openid_list\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('openid_list', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{ t('desc_fans_openid_list') }}</div>\r\n      </div>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('label_section_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, onMounted, watch, inject} from 'vue';\r\nimport { useI18n } from 'vue-i18n';\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport {getWechatAppList} from \"@/api/robot/index.js\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport {pluginOutputToTree} from \"@/constants/plugin.js\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {message} from 'ant-design-vue';\r\n\r\nconst { t } = useI18n();\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst pluginName = 'official_batch_tag'\r\nconst outputData = ref([])\r\nconst apps = ref([])\r\nconst tags = ref([])\r\nconst formState = reactive({\r\n  app_id: undefined,\r\n  app_secret: '',\r\n  openid_list: '',\r\n  tagid: '',\r\n  tag_type: 1,\r\n  tag_name: 1,\r\n  tag_map: {}\r\n})\r\nconst syncing = ref(false)\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n\r\nwatch(() => props.action, () => {\r\n  outputData.value = pluginOutputToTree(JSON.parse(JSON.stringify(props.action?.output || '{}')))\r\n}, {\r\n  deep: true,\r\n  immediate: true\r\n})\r\n\r\nfunction init() {\r\n  loadWxApps()\r\n  nodeParamsAssign()\r\n}\r\n\r\nfunction loadWxApps() {\r\n  getWechatAppList({app_type: 'official_account'}).then(res => {\r\n    apps.value = res?.data || []\r\n  })\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let arg = nodeParams?.plugin?.params?.arguments || {}\r\n  Object.assign(formState, arg)\r\n  if (formState.tagid) {\r\n    if (formState.tagid > 0) {\r\n      formState.tag_type = 1\r\n    } else {\r\n      formState.tag_type = 2\r\n    }\r\n    loadTags()\r\n  }\r\n}\r\n\r\nfunction appChange(_, option) {\r\n  const {key, secret, name} = option\r\n  formState.app_secret = secret\r\n  formState.app_name = name\r\n  loadTags()\r\n}\r\n\r\nfunction syncTags() {\r\n  if (!formState.app_secret || !formState.app_id) {\r\n    return message.warning(t('msg_please_select_official_account'))\r\n  }\r\n  if (syncing.value) return\r\n  syncing.value = true\r\n  loadTags().then(() => {\r\n    message.success(t('msg_sync_completed'))\r\n  }).finally(() => {\r\n    syncing.value = false\r\n  })\r\n}\r\n\r\n\r\nfunction loadTags() {\r\n  return runPlugin({\r\n    name: pluginName,\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'getTags',\r\n      arguments: {\r\n        app_id: formState.app_id,\r\n        app_secret: formState.app_secret,\r\n      }\r\n    })\r\n  }).then(res => {\r\n    tags.value = res?.data?.tags || []\r\n    return res\r\n  })\r\n}\r\n\r\nfunction changeFieldValue(field, text, selectedList) {\r\n  if (field === 'openid_list') {\r\n    text = text.trim()\r\n    text = text.replace(/，/g, ',')\r\n  }\r\n  formState[field] = text\r\n  formState.tag_map[field] = selectedList\r\n  update()\r\n}\r\n\r\nfunction tagChange(val, opt) {\r\n  formState.tag_name = opt.name\r\n  update()\r\n}\r\n\r\nfunction tagTypeChange() {\r\n  formState.tag_name = ''\r\n  if (formState.tag_type == 1) {\r\n    formState.tagid = null\r\n  } else {\r\n    formState.tagid = ''\r\n  }\r\n}\r\n\r\nfunction update() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  nodeParams.plugin.output_obj = outputData.value\r\n  Object.assign(nodeParams.plugin.params, {\r\n    arguments: {\r\n      ...formState\r\n    }\r\n  })\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nconst filterOption = (input, option) => {\r\n  return option.name.toLowerCase().indexOf(input.toLowerCase()) >= 0;\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"../node-options\";\r\n.tag-box {\r\n  display: flex;\r\n  align-items: center;\r\n  :deep(.mention-input-warpper) {\r\n    height: 33px;\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.field-list {\r\n  .field-list-row {\r\n    position: relative;\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    align-items: center;\r\n    margin-bottom: 4px;\r\n\r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n\r\n  .field-list-col {\r\n    padding: 0 4px;\r\n  }\r\n\r\n  .field-name-col,\r\n  .field-name-head {\r\n    flex: 1;\r\n  }\r\n\r\n  .field-type-col,\r\n  .field-type-head {\r\n    flex-basis: 90px;\r\n  }\r\n\r\n  .field-value-col,\r\n  .field-value-head {\r\n    width: 256px;\r\n  }\r\n\r\n  .field-list-col-head {\r\n    line-height: 22px;\r\n    margin-bottom: 4px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n  }\r\n\r\n  .field-name-col,\r\n  .field-type-col {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n  }\r\n\r\n  .field-del-head,\r\n  .field-del-col {\r\n    width: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  .field-del-col {\r\n    text-align: right;\r\n\r\n    .del-btn {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      width: 16px;\r\n      height: 16px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n}\r\n.wide-value-col {\r\n  .field-value-col,\r\n  .field-value-head {\r\n    width: 300px;\r\n  }\r\n}\r\n.field-value-inline {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2px;\r\n  min-width: 0;\r\n}\r\n.inline-input {\r\n  flex: 1;\r\n  min-width: 0;\r\n}\r\n.add-btn-box {\r\n  margin-top: 8px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div>\r\n    <div class=\"field-list\" :class=\"{'wide-value-col': hasObjectPropRows}\">\r\n      <div class=\"field-list-row\">\r\n        <div class=\"field-list-col field-list-col-head field-name-head\">{{ t('label_field_name') }}</div>\r\n        <div class=\"field-list-col field-list-col-head field-type-head\">{{ t('label_type') }}</div>\r\n        <div class=\"field-list-col field-list-col-head field-value-head\" v-if=\"showInput\">{{ t('label_field_value') }}</div>\r\n        <div\r\n          class=\"field-list-col field-list-col-head field-del-head\"\r\n          v-if=\"props.showDelete\"\r\n        ></div>\r\n      </div>\r\n\r\n      <div class=\"field-list-row\" v-if=\"showEmptyFieldRow\">\r\n        <div class=\"field-list-col field-name-col\">--</div>\r\n        <div class=\"field-list-col field-type-col\">--</div>\r\n        <div class=\"field-list-col field-value-col\">\r\n          <a-tooltip :title=\"t('ph_select_database_first')\">\r\n            <a-input :disabled=\"true\" :placeholder=\"t('ph_input_value_variable')\"/>\r\n          </a-tooltip>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"field-list-row\" v-for=\"(item, index) in state.list\" :key=\"item.field_name\">\r\n        <div class=\"field-list-col field-name-col\">\r\n          <span v-if=\"item.__required\" style=\"color:#FB363F; margin-right:2px;\">*</span>\r\n          {{ item.properties?.[item.current_properties_key]?.name ||  item.name }}\r\n          <a-tooltip v-if=\"item.__functionalTip\" :title=\"item.__functionalTip\">\r\n            <QuestionCircleOutlined style=\"cursor: pointer;\" />\r\n          </a-tooltip>\r\n        </div>\r\n        <div class=\"field-list-col field-type-col\">{{ item.ui_type }}</div>\r\n        <div class=\"field-list-col field-value-col\" v-if=\"showInput\">\r\n          <template v-if=\"isObjectWithProps(item)\">\r\n            <div class=\"field-value-inline\">\r\n              <a-select\r\n                v-model:value=\"item.current_properties_key\"\r\n                @change=\"(val) => onSelectObjectProp(item, val)\"\r\n              >\r\n                <a-select-option\r\n                  v-for=\"(prop, key) in (item.properties || {})\"\r\n                  :key=\"key\"\r\n                  :value=\"key\"\r\n                >{{ prop.name || key }}</a-select-option>\r\n              </a-select>\r\n              <div class=\"inline-input\">\r\n                <AtInput\r\n                  :options=\"atInputOptions\"\r\n                  :defaultValue=\"(item.properties?.[item.current_properties_key]?.value ?? '')\"\r\n                  :defaultSelectedList=\"(item.properties?.[item.current_properties_key]?.atTags ?? [])\"\r\n                  @open=\"showAtList\"\r\n                  @change=\"(text, selectedList) => changeAtInputValue(text, selectedList, item, index)\"\r\n                  :placeholder=\"t('ph_input_param_variable')\" />\r\n              </div>\r\n            </div>\r\n          </template>\r\n          <template v-else>\r\n            <AtInput\r\n              :options=\"atInputOptions\"\r\n              :defaultValue=\"item.value\"\r\n              :defaultSelectedList=\"item.atTags\"\r\n              @open=\"showAtList\"\r\n              @change=\"(text, selectedList) => changeAtInputValue(text, selectedList, item, index)\"\r\n              :placeholder=\"t('ph_input_param_variable')\" />\r\n          </template>\r\n          <div v-if=\"item.__error\" style=\"color:#FB363F; margin-top:4px;\">{{ item.__error }}</div>\r\n        </div>\r\n        <div class=\"field-list-col field-del-col\" v-if=\"props.showDelete\">\r\n          <span class=\"del-btn\" @click=\"handleDel(index)\">\r\n            <svg-icon class=\"del-icon\" name=\"close-circle\"></svg-icon>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue'\r\nimport {ref, reactive, watch, inject, onMounted, computed} from 'vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.data-table.reply-select.index')\r\n\r\nconst emit = defineEmits(['change'])\r\n\r\nconst props = defineProps({\r\n  showDelete: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showInput: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  showEmptyFieldRow: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  },\r\n  list: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  msgtype: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst state = reactive({\r\n  list: [],\r\n  keys: [],\r\n})\r\n\r\nconst hasObjectPropRows = computed(() => {\r\n  return state.list.some(it => isObjectWithProps(it))\r\n})\r\n\r\nfunction getReplyMode () {\r\n  const m = String(props.msgtype || '').toLowerCase()\r\n  if (m === 'link') return 'imageText'\r\n  if (m === 'miniprogrampage') return 'card'\r\n  if (['text','image','url'].includes(m)) return m\r\n  return 'text'\r\n}\r\n\r\nconst fieldRuleMap = {\r\n  imageText: {\r\n    url: {\r\n      required: true,\r\n      validator: (v) => {\r\n        // `【([a-f0-9]{32}\\.)?[a-zA-Z_][a-zA-Z0-9_\\-.]*】` 如果是这个正则表示是引用 就不用校验\r\n        const refRegex = /^【([a-f0-9]{32}\\.)?[a-zA-Z_][a-zA-Z0-9_\\-.]*】$/\r\n        if (refRegex.test(String(v||''))) return true\r\n        return /^https?:\\/\\//.test(String(v||''))\r\n      },\r\n      validationTip: t('validation_tip_url'),\r\n      functionalTip: t('functional_tip_url')\r\n    },\r\n    title: {\r\n      required: true,\r\n      validator: (v) => !!String(v||'').trim(),\r\n      validationTip: t('validation_tip_title'),\r\n      functionalTip: t('functional_tip_title')\r\n    },\r\n    description: {\r\n      required: true,\r\n      validator: (v) => String(v||'').trim().length > 0 && String(v||'').length <= 300,\r\n      validationTip: t('validation_tip_description'),\r\n      functionalTip: t('functional_tip_description')\r\n    },\r\n    thumb_url: {\r\n      required: true,\r\n      validator: (v) => !!String(v||'').trim(),\r\n      validationTip: t('validation_tip_thumb_url'),\r\n      functionalTip: t('functional_tip_thumb_url')\r\n    }\r\n  },\r\n  text: {\r\n    content: {\r\n      required: true,\r\n      validator: (v) => String(v||'').trim().length > 0 && String(v||'').length <= 300,\r\n      validationTip: t('validation_tip_content'),\r\n      functionalTip: t('functional_tip_content')\r\n    }\r\n  },\r\n  image: {\r\n    thumb_url: {\r\n      required: true,\r\n      validator: (v) => !!String(v||'').trim(),\r\n      validationTip: t('validation_tip_image_thumb_url'),\r\n      functionalTip: t('functional_tip_image_thumb_url')\r\n    }\r\n  },\r\n  url: {\r\n    title: {\r\n      required: true,\r\n      validator: (v) => !!String(v||'').trim(),\r\n      validationTip: t('validation_tip_title'),\r\n      functionalTip: t('functional_tip_title')\r\n    },\r\n    url: {\r\n      required: true,\r\n      validator: (v) => {\r\n        // `【([a-f0-9]{32}\\.)?[a-zA-Z_][a-zA-Z0-9_\\-.]*】` 如果是这个正则表示是引用 就不用校验\r\n        const refRegex = /^【([a-f0-9]{32}\\.)?[a-zA-Z_][a-zA-Z0-9_\\-.]*】$/\r\n        if (refRegex.test(String(v||''))) return true\r\n        return /^https?:\\/\\//.test(String(v||''))\r\n      },\r\n      validationTip: t('validation_tip_card_url'),\r\n      functionalTip: t('functional_tip_card_url')\r\n    }\r\n  },\r\n  card: {\r\n    title: {\r\n      required: true,\r\n      validator: (v) => !!String(v||'').trim(),\r\n      validationTip: t('validation_tip_card_title'),\r\n      functionalTip: t('functional_tip_card_title')\r\n    },\r\n    appid: {\r\n      required: true,\r\n      validator: (v) => !!String(v||'').trim(),\r\n      validationTip: t('validation_tip_appid'),\r\n      functionalTip: t('functional_tip_appid')\r\n    },\r\n    page_path: {\r\n      required: true,\r\n      validator: (v) => /^\\//.test(String(v||'')),\r\n      validationTip: t('validation_tip_page_path'),\r\n      functionalTip: t('functional_tip_page_path')\r\n    },\r\n    thumb_url: {\r\n      required: true,\r\n      validator: (v) => !!String(v||'').trim(),\r\n      validationTip: t('validation_tip_card_thumb_url'),\r\n      functionalTip: t('functional_tip_card_thumb_url')\r\n    }\r\n  }\r\n}\r\n\r\nfunction applyFunctionalTips () {\r\n  const mode = getReplyMode()\r\n  const rules = fieldRuleMap[mode] || {}\r\n  state.list.forEach((it, idx) => {\r\n    const key = (it.field_name || '').toLowerCase()\r\n    const rule = rules[key] || {}\r\n    let backendOuter = {}\r\n    if (typeof it.description !== 'undefined' || typeof it.desc !== 'undefined' || typeof it.required !== 'undefined') {\r\n      backendOuter = { functionalTip: it.description || it.desc, required: it.required }\r\n    }\r\n    let propMeta = {}\r\n    if (isObjectWithProps(it)) {\r\n      const p = it.properties?.[it.current_properties_key]\r\n      if (p && (typeof p.description !== 'undefined' || typeof p.desc !== 'undefined' || typeof p.required !== 'undefined')) {\r\n        propMeta = { functionalTip: p.description || p.desc, required: p.required }\r\n      }\r\n    }\r\n    const merged = {\r\n      functionalTip: propMeta.functionalTip ?? backendOuter.functionalTip ?? rule.functionalTip ?? '',\r\n      required: (propMeta.required ?? backendOuter.required ?? rule.required ?? it.required) ? true : false\r\n    }\r\n    state.list[idx].__functionalTip = merged.functionalTip\r\n    state.list[idx].__required = !!merged.required\r\n    state.list[idx].__error = null\r\n  })\r\n}\r\n\r\nfunction validateField (item) {\r\n  const mode = getReplyMode()\r\n  const rules = fieldRuleMap[mode] || {}\r\n  const key = (item.field_name || '').toLowerCase()\r\n  let r = rules[key]\r\n  if (!r && isObjectWithProps(item)) {\r\n    const p = item.properties?.[item.current_properties_key]\r\n    if (p) {\r\n      r = { required: !!p.required }\r\n    }\r\n  }\r\n  const val = isObjectWithProps(item) ? (item.properties?.[item.current_properties_key]?.value ?? '') : item.value\r\n  if (!r) {\r\n    item.__error = null\r\n    return true\r\n  }\r\n  const tags = isObjectWithProps(item) ? (item.properties?.[item.current_properties_key]?.atTags ?? []) : item.atTags\r\n  if (r.required && !String(val || '').trim() && (!Array.isArray(tags) || tags.length === 0)) {\r\n    item.__error = r.validationTip\r\n    return false\r\n  }\r\n  if (r.validator && !r.validator(val)) {\r\n    item.__error = r.validationTip\r\n    return false\r\n  }\r\n  item.__error = null\r\n  return true\r\n}\r\n\r\nwatch(() => props.list, (newVal) => {\r\n  state.list = newVal\r\n  state.keys = newVal.map(i => i.field_name)\r\n  state.list.forEach(initializeObjectField)\r\n  applyFunctionalTips()\r\n}, {\r\n  immediate: true\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable();\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst showAtList = () => {\r\n  getAtInputOptions()\r\n}\r\n\r\nconst changeAtInputValue = (text, selectedList, item, index) => {\r\n  if (isObjectWithProps(item)) {\r\n    const k = item.current_properties_key\r\n    if (!item.properties[k]) item.properties[k] = {}\r\n    item.properties[k].value = text\r\n    item.properties[k].atTags = selectedList\r\n  } else {\r\n    state.list[index].value = text\r\n    state.list[index].atTags = selectedList\r\n  }\r\n  change()\r\n}\r\n\r\nconst handleDel = (index) => {\r\n  state.list.splice(index, 1)\r\n\r\n  change()\r\n}\r\n\r\nconst change = () => {\r\n  state.keys = state.list.map(i => i.field_name)\r\n  emit('change', [...state.list], [...state.keys])\r\n}\r\n\r\nonMounted(() => {\r\n  getAtInputOptions()\r\n})\r\n\r\nfunction isObjectWithProps (item) {\r\n  return item.media_component\r\n}\r\n\r\nfunction onSelectObjectProp (item, key) {\r\n  const prop = item.properties?.[key]\r\n  item.current_properties_key = key\r\n  // 保持父字段名不变，仅更新显示类型与提示\r\n  item.ui_type = mapPropType(prop?.type)\r\n  item.__functionalTip = prop?.desc || ''\r\n  item.__required = !!prop?.required\r\n  // 重置当前子字段的值\r\n  if (!item.properties[key]) item.properties[key] = {}\r\n  item.properties[key].value = item.properties[key].value ?? ''\r\n  item.properties[key].atTags = item.properties[key].atTags ?? []\r\n  change()\r\n}\r\n\r\nfunction initializeObjectField (item) {\r\n  if (!isObjectWithProps(item)) return\r\n  const keys = Object.keys(item.properties)\r\n  if (!item.current_properties_key) {\r\n    const presetKey = keys[0]\r\n    onSelectObjectProp(item, presetKey)\r\n  }\r\n}\r\n\r\nfunction mapPropType(t) {\r\n  switch ((t || '').toLowerCase()) {\r\n    case 'string': return 'Text'\r\n    case 'number': return 'Number'\r\n    case 'integer': return 'Number'\r\n    case 'boolean': return 'Checkbox'\r\n    case 'array<string>': return 'MultiSelect'\r\n    default: return t || 'Text'\r\n  }\r\n}\r\n\r\nfunction validateAll () {\r\n  let ok = true\r\n  const errors = []\r\n  state.list.forEach(it => {\r\n    if (!validateField(it)) {\r\n      ok = false\r\n      const prop = isObjectWithProps(it) ? (it.properties?.[it.current_properties_key] || {}) : null\r\n      errors.push({\r\n        field_name: (prop?.name || it.name || it.field_name),\r\n        message: prop?.error || it.__error,\r\n        functionalTip: prop?.desc || it.__functionalTip\r\n      })\r\n    }\r\n  })\r\n  return { ok, errors }\r\n}\r\n\r\ndefineExpose({ validateAll })\r\n\r\n</script>","<style lang=\"less\" scoped>\r\n.add-data-form {\r\n  .node-box-content {\r\n    margin-top: 16px;\r\n    overflow: hidden;\r\n    border-radius: 6px;\r\n    background: #f2f4f7;\r\n  }\r\n\r\n  .setting-label {\r\n    line-height: 22px;\r\n    margin-bottom: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    .tip {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n\r\n  .setting-box {\r\n\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"add-data-form\">\r\n    <div class=\"node-box-content\">\r\n      <div class=\"setting-label\">\r\n        <span>{{ t('label_reply_content') }}</span>\r\n        <span class=\"tip\">{{ t('msg_empty_field_tip') }}</span>\r\n      </div>\r\n\r\n      <div class=\"setting-box\">\r\n        <FieldListSelect\r\n          ref=\"fieldRef\"\r\n          :showEmptyFieldRow=\"!tableId\"\r\n          :list=\"dataItems\"\r\n          :fields=\"fields\"\r\n          :msgtype=\"tableId\"\r\n          :showAdd=\"false\"\r\n          :showDelete=\"false\"\r\n          @change=\"onChangeFields\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, toRaw } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport FieldListSelect from \"@/views/workflow/components/data-table/reply-select/index.vue\";\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.official-send-message.reply-data')\r\n\r\nconst emit = defineEmits(['update'])\r\nconst props = defineProps({\r\n  tableId: {\r\n    type: [String, Number]\r\n  },\r\n  fields: {\r\n    type: Array,\r\n    default: () => ([])\r\n  },\r\n})\r\n\r\nconst dataItems = ref([])\r\nconst fieldRef = ref(null)\r\n\r\nfunction init(nodeParams=null) {\r\n  dataItems.value = []\r\n  if (Array.isArray(nodeParams?.plugin?.params?.arguments?.fields) && nodeParams.plugin.params.arguments.fields.length) {\r\n    nodeParams.plugin.params.arguments.fields.map(item => {\r\n      item.value = item.value.toString()\r\n    })\r\n    dataItems.value = nodeParams.plugin.params.arguments.fields\r\n  } else {\r\n    props.fields.map(item => {\r\n      dataItems.value.push({\r\n        value: '',\r\n        atTags: [],\r\n        ...item\r\n      })\r\n    })\r\n  }\r\n}\r\nconst onChangeFields = (selectedRows) => {\r\n  dataItems.value = selectedRows\r\n  update()\r\n}\r\n\r\nconst update = () => {\r\n  emit('update', {\r\n    fields: toRaw(dataItems.value)\r\n  })\r\n}\r\n\r\nfunction validateAll () {\r\n  return fieldRef.value?.validateAll?.()\r\n}\r\n\r\ndefineExpose({\r\n  init,\r\n  validateAll\r\n})\r\n</script>\r\n\r\n","<template>\r\n  <div class=\"main-box\">\r\n    <div v-if=\"loadingF || loading\" class=\"loading-box\">\r\n      <a-spin/>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('title_input') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"formState.app_id\"\r\n            :placeholder=\"t('ph_select_official_account')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"(value, option) => appChange(value, option)\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"app in apps\"\r\n              :key=\"app.app_id\"\r\n              :value=\"app.app_id\"\r\n              :name=\"app.app_name\"\r\n              :app_secret=\"app.app_secret\"\r\n            >\r\n              {{ app.app_name }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">\r\n            {{ t('label_receiver') }}\r\n            <a-tooltip :title=\"t('tooltip_receiver_openid')\">\r\n              <QuestionCircleOutlined />\r\n            </a-tooltip>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.receiver_tags\"\r\n            :defaultValue=\"formState.receiver\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => onChangeReceiver(text, selectedList)\"\r\n            :placeholder=\"t('ph_input_receiver')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_message_type') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"formState.msgtype\"\r\n            @change=\"msgTypeChange\"\r\n            :placeholder=\"formState.app_id ? t('ph_select_message_type') : t('ph_select_official_account_first')\"\r\n            style=\"width: 100%;\">\r\n            <a-select-option\r\n              v-for=\"item in tables\"\r\n              :key=\"item.msgtype\"\r\n              :value=\"item.msgtype\">\r\n              {{ item.name }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n      <ReplyData\r\n        ref=\"childRef\"\r\n        :tableId=\"formState.msgtype\"\r\n        :fields=\"fields\"\r\n        :variableOptions=\"variableOptions\"\r\n        @update=\"update\"\r\n        @updateVar=\"emit('updateVar')\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('title_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue';\r\nimport {ref, reactive, onMounted, watch, computed, inject, nextTick} from 'vue'\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport ReplyData from \"./reply-data.vue\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {getPluginActionDefaultArguments, pluginOutputToTree} from \"@/constants/plugin.js\";\r\nimport {getWechatAppList} from \"@/api/robot/index.js\";\r\nimport { useEventBus } from '@/hooks/event/useEventBus.js'\r\nimport AtInput from '@/views/workflow/components/at-input/at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.official-send-message.official-send-message-box')\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst plginName = 'official_send_message'\r\n\r\n\r\nconst childRef = ref(null)\r\nconst formState = reactive({\r\n  app_id: null,\r\n  msgtype: undefined,\r\n  receiver: '',\r\n  receiver_tags: [],\r\n  app_secret: '',\r\n  app_name: ''\r\n})\r\nconst loading = ref(false)\r\nconst loadingF = ref(false)\r\nconst tableData = ref({})\r\nconst apps = ref([])\r\nconst tables = ref([])\r\nconst fields = ref([])\r\n\r\nconst outputData = ref([])\r\n\r\n\r\nonMounted(() => {\r\n  init()\r\n  const bus = useEventBus({\r\n    name: 'workflow:validate',\r\n    callback: onWorkflowValidate\r\n  })\r\n})\r\n\r\nasync function init() {\r\n  await loadWxApps()\r\n  nodeParamsAssign()\r\n  outputFormat()\r\n}\r\n\r\nfunction loadWxApps() {\r\n  return getWechatAppList({app_type: 'official_account'}).then(res => {\r\n    apps.value = res?.data || []\r\n  })\r\n}\r\n\r\nfunction loadTables() {\r\n  loading.value = true\r\n  return runPlugin({\r\n    name: plginName,\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'getMsgType',\r\n      arguments: {\r\n        app_id: formState.app_id\r\n      }\r\n    })\r\n  }).then(res => {\r\n    tableData.value = res?.data || {}\r\n    tables.value = tableData.value.items || []\r\n    if (!formState.msgtype && tables.value.length == 1) {\r\n      formState.msgtype = tables.value[0].msgtype\r\n      msgTypeChange()\r\n    }\r\n    return res\r\n  }).finally(() => {\r\n    loading.value = false\r\n  })\r\n}\r\n\r\nfunction loadFields() {\r\n  loadingF.value = true\r\n  return runPlugin({\r\n    name: plginName,\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'getMsgInput',\r\n      arguments: {\r\n        app_id: formState.app_id,\r\n        app_secret: formState.app_secret,\r\n        msgtype: formState.msgtype\r\n      }\r\n    })\r\n  }).then(res => {\r\n    let items = res?.data?.items || []\r\n    fields.value = items.map(it => ({\r\n      field_name: it.field || it.name,\r\n      ui_type: mapMsgFieldType(it.type),\r\n      name: it.name,\r\n      description: it.desc,\r\n      required: !!it.required,\r\n      media_component: !!it.media_component,\r\n      properties: it.properties || null\r\n    }))\r\n    return res\r\n  }).finally(() => {\r\n    loadingF.value = false\r\n  })\r\n}\r\n\r\nfunction mapMsgFieldType(t) {\r\n  switch ((t || '').toLowerCase()) {\r\n    case 'string': return 'Text'\r\n    case 'number': return 'Number'\r\n    case 'integer': return 'Number'\r\n    case 'boolean': return 'Checkbox'\r\n    case 'array<string>': return 'MultiSelect'\r\n    default: return t || 'Text'\r\n  }\r\n}\r\n\r\nfunction paramsFormat(val) {\r\n  if (!val) {\r\n    return getPluginActionDefaultArguments(props.actionName)\r\n  }\r\n  val = JSON.parse(JSON.stringify(val))\r\n  for (let key in val) {\r\n    switch (key) {\r\n      case 'filter':\r\n        if (Array.isArray(val.filter.conditions) && val.filter.conditions.length) {\r\n          for (let item of val.filter.conditions) {\r\n            if ('DateTime' === item.field_type && item.value) {\r\n              if (item.value < 1e11) item.value *= 1000\r\n              // 后端要求DateTime添加了特殊标记\r\n              item.value = ['ExactDate', item.value].join(',')\r\n            }\r\n          }\r\n        }\r\n        break\r\n      case 'fields':\r\n        for (let item of val.fields) {\r\n          if (item.value != '') {\r\n            if (['DateTime', 'Number', 'Rating', 'Progress', 'Currency'].includes(item.ui_type)) {\r\n              item.value = Number(item.value)\r\n            }\r\n            if ('Currency' === item.ui_type) item.value = item.value.toFixed(2)\r\n          }\r\n          if ('Checkbox' === item.ui_type) {\r\n            item.value = (item.value == 'true')\r\n          }\r\n          if ('MultiSelect' === item.ui_type) {\r\n            item.value = item.value.replace(/，/g, ',').split(',')\r\n          }\r\n          if ('DateTime' === item.ui_type) {\r\n            if (item.value < 1e11) item.value *= 1000\r\n          }\r\n        }\r\n        break\r\n      case 'field_names':\r\n        val.field_names = val.field_names.map(i => i.field_name)\r\n        break\r\n      case 'sort':\r\n        val.sort = val.sort.map(i => {\r\n          return {\r\n            field_name: i.field_name,\r\n            desc: (i.is_asc != 1)\r\n          }\r\n        })\r\n        break\r\n    }\r\n  }\r\n  return val\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let arg = nodeParams?.plugin?.params?.arguments || {}\r\n  if (arg.app_id) formState.app_id = arg.app_id\r\n  if (arg.msgtype) formState.msgtype = arg.msgtype\r\n  if (arg.receiver) formState.receiver = String(arg.receiver)\r\n  if (arg.openid) formState.receiver = String(arg.openid)\r\n  if (arg.touser) formState.receiver = String(arg.touser)\r\n  if (arg.tag_map && arg.tag_map.receiver) formState.receiver_tags = arg.tag_map.receiver\r\n  if (arg.app_secret) formState.app_secret = String(arg.app_secret)\r\n  if (arg.app_name) formState.app_name = String(arg.app_name)\r\n  if (formState.app_id) {\r\n    loadTables()\r\n  }\r\n  if (formState.msgtype) {\r\n    loadFields().then(() => compInit(nodeParams))\r\n  }\r\n}\r\n\r\nfunction appChange(value, option) {\r\n  tableData.value = {}\r\n  tables.value = []\r\n  fields.value = []\r\n  formState.msgtype = undefined\r\n  if (option && option.app_secret) {\r\n    formState.app_secret = option.app_secret\r\n  }\r\n  if (option && option.name) {\r\n    formState.app_name = option.name\r\n  }\r\n  if (formState.app_id) {\r\n    loadTables().then(() => compInit())\r\n  } else {\r\n    compInit()\r\n  }\r\n  update()\r\n}\r\n\r\nfunction msgTypeChange() {\r\n  fields.value = []\r\n  loadFields().then(() => compInit())\r\n  update()\r\n}\r\n\r\nfunction compInit(nodeParams=null) {\r\n  nextTick(() => {\r\n    if (childRef.value && typeof childRef.value.init === 'function') {\r\n      childRef.value.init(nodeParams)\r\n    }\r\n  })\r\n}\r\n\r\nfunction onWorkflowValidate() {\r\n  const bus = useEventBus()\r\n  if (childRef.value && typeof childRef.value.validateAll === 'function') {\r\n    const res = childRef.value.validateAll()\r\n    const typeItem = tables.value.find(i => i.msgtype == formState.msgtype)\r\n    if (res && res.ok === false) {\r\n      bus.emit && bus.emit('workflow:validate:error', {\r\n        component: t('component_official_send_message'),\r\n        type: formState.msgtype,\r\n        typeDisplay: typeItem?.name || formState.msgtype,\r\n        message: t('msg_complete_required_fields'),\r\n        errors: res.errors || []\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nfunction update(val = null) {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let typeItem = tables.value.find(i => i.msgtype == formState.msgtype)\r\n  //let params = nodeParams?.plugin?.params || {}\r\n  nodeParams.plugin.output_obj = outputData.value\r\n  Object.assign(nodeParams.plugin.params, {\r\n    arguments: {\r\n      app_id: String(formState.app_id || ''),\r\n      app_secret: String(formState.app_secret || ''),\r\n      msgtype: String(formState.msgtype || ''),\r\n      touser: String(formState.receiver || ''),\r\n      fields: (paramsFormat(val) || {}).fields || [],\r\n      app_name: String(formState.app_name || ''),\r\n      msg_type_name: String(typeItem?.name || ''),\r\n    }\r\n  })\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nfunction onChangeReceiver (text, selectedList) {\r\n  formState.receiver = text\r\n  formState.receiver_tags = selectedList\r\n  update()\r\n}\r\n\r\n\r\nfunction outputFormat() {\r\n  outputData.value = pluginOutputToTree(props.action.output)\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.loading-box {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 99;\r\n}\r\n.node-options {\r\n  background: #f2f4f7;\r\n  border-radius: 6px;\r\n  padding: 12px;\r\n  margin-top: 16px;\r\n\r\n  &:first-child {\r\n    margin-top: 0;\r\n  }\r\n\r\n  .options-title {\r\n    color: var(--wf-color-text-1);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    font-weight: 600;\r\n    height: 22px;;\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    margin-bottom: 16px;\r\n\r\n    .title-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      vertical-align: -3px;\r\n      margin-right: 8px;;\r\n    }\r\n\r\n    .acton-box {\r\n      font-weight: 400;\r\n    }\r\n  }\r\n\r\n  .options-item {\r\n    display: flex;\r\n    flex-direction: column;\r\n    margin-top: 12px;\r\n    line-height: 22px;\r\n    gap: 4px;\r\n\r\n    .options-item-tit {\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-1);\r\n      font-size: 14px;\r\n      margin-right: 8px;\r\n    }\r\n\r\n    .desc {\r\n      color: var(--wf-color-text-2);\r\n    }\r\n\r\n\r\n    &.is-required .option-label::before {\r\n      content: '*';\r\n      color: #FB363F;\r\n      display: inline-block;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-type {\r\n      height: 22px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 6px;\r\n      border: 1px solid rgba(0, 0, 0, 0.15);\r\n      background-color: #fff;\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n    }\r\n\r\n    .item-actions-box {\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      .action-btn {\r\n        margin-left: 12px;\r\n        font-size: 16px;\r\n        color: #595959;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cpath%20d='M6.0946%2014.4079C4.97757%2014.0753%203.98327%2013.4579%203.19596%2012.6398C3.48967%2012.2917%203.66667%2011.8419%203.66667%2011.3508C3.66667%2010.2462%202.77124%209.35078%201.66667%209.35078C1.59985%209.35078%201.5338%209.35408%201.46867%209.36048C1.37993%208.92665%201.33334%208.47752%201.33334%208.01745C1.33334%207.32058%201.44026%206.64868%201.6386%206.01725C1.64794%206.01738%201.6573%206.01745%201.66667%206.01745C2.77124%206.01745%203.66667%205.12202%203.66667%204.01745C3.66667%203.70035%203.59287%203.40052%203.46154%203.13412C4.2325%202.41725%205.1735%201.88076%206.21737%201.5918C6.54814%202.24015%207.22224%202.68413%208%202.68413C8.77777%202.68413%209.45187%202.24015%209.78264%201.5918C10.8265%201.88076%2011.7675%202.41725%2012.5385%203.13412C12.4071%203.40052%2012.3333%203.70035%2012.3333%204.01745C12.3333%205.12202%2013.2288%206.01745%2014.3333%206.01745C14.3427%206.01745%2014.3521%206.01738%2014.3614%206.01725C14.5597%206.64868%2014.6667%207.32058%2014.6667%208.01745C14.6667%208.47752%2014.6201%208.92665%2014.5313%209.36048C14.4662%209.35408%2014.4002%209.35078%2014.3333%209.35078C13.2288%209.35078%2012.3333%2010.2462%2012.3333%2011.3508C12.3333%2011.8419%2012.5103%2012.2917%2012.804%2012.6398C12.0167%2013.4579%2011.0224%2014.0753%209.9054%2014.4079C9.6476%2013.6014%208.892%2013.0175%208%2013.0175C7.108%2013.0175%206.3524%2013.6014%206.0946%2014.4079Z'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linejoin='round'/%3e%3cpath%20d='M8%2010.3503C9.28866%2010.3503%2010.3333%209.30559%2010.3333%208.01693C10.3333%206.72826%209.28866%205.68359%208%205.68359C6.71133%205.68359%205.66666%206.72826%205.66666%208.01693C5.66666%209.30559%206.71133%2010.3503%208%2010.3503Z'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nfunction isObject(o) {\n  return Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (ctor === undefined) return true;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n}\n\nexport { isPlainObject };\n","function n(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];if(\"production\"!==process.env.NODE_ENV){var i=Y[n],o=i?\"function\"==typeof i?i.apply(null,t):i:\"unknown error nr: \"+n;throw Error(\"[Immer] \"+o)}throw Error(\"[Immer] minified error nr: \"+n+(t.length?\" \"+t.map((function(n){return\"'\"+n+\"'\"})).join(\",\"):\"\")+\". Find the full error at: https://bit.ly/3cXEKWf\")}function r(n){return!!n&&!!n[Q]}function t(n){var r;return!!n&&(function(n){if(!n||\"object\"!=typeof n)return!1;var r=Object.getPrototypeOf(n);if(null===r)return!0;var t=Object.hasOwnProperty.call(r,\"constructor\")&&r.constructor;return t===Object||\"function\"==typeof t&&Function.toString.call(t)===Z}(n)||Array.isArray(n)||!!n[L]||!!(null===(r=n.constructor)||void 0===r?void 0:r[L])||s(n)||v(n))}function e(t){return r(t)||n(23,t),t[Q].t}function i(n,r,t){void 0===t&&(t=!1),0===o(n)?(t?Object.keys:nn)(n).forEach((function(e){t&&\"symbol\"==typeof e||r(e,n[e],n)})):n.forEach((function(t,e){return r(e,t,n)}))}function o(n){var r=n[Q];return r?r.i>3?r.i-4:r.i:Array.isArray(n)?1:s(n)?2:v(n)?3:0}function u(n,r){return 2===o(n)?n.has(r):Object.prototype.hasOwnProperty.call(n,r)}function a(n,r){return 2===o(n)?n.get(r):n[r]}function f(n,r,t){var e=o(n);2===e?n.set(r,t):3===e?n.add(t):n[r]=t}function c(n,r){return n===r?0!==n||1/n==1/r:n!=n&&r!=r}function s(n){return X&&n instanceof Map}function v(n){return q&&n instanceof Set}function p(n){return n.o||n.t}function l(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var r=rn(n);delete r[Q];for(var t=nn(r),e=0;e<t.length;e++){var i=t[e],o=r[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]})}return Object.create(Object.getPrototypeOf(n),r)}function d(n,e){return void 0===e&&(e=!1),y(n)||r(n)||!t(n)||(o(n)>1&&(n.set=n.add=n.clear=n.delete=h),Object.freeze(n),e&&i(n,(function(n,r){return d(r,!0)}),!0)),n}function h(){n(2)}function y(n){return null==n||\"object\"!=typeof n||Object.isFrozen(n)}function b(r){var t=tn[r];return t||n(18,r),t}function m(n,r){tn[n]||(tn[n]=r)}function _(){return\"production\"===process.env.NODE_ENV||U||n(0),U}function j(n,r){r&&(b(\"Patches\"),n.u=[],n.s=[],n.v=r)}function g(n){O(n),n.p.forEach(S),n.p=null}function O(n){n===U&&(U=n.l)}function w(n){return U={p:[],l:U,h:n,m:!0,_:0}}function S(n){var r=n[Q];0===r.i||1===r.i?r.j():r.g=!0}function P(r,e){e._=e.p.length;var i=e.p[0],o=void 0!==r&&r!==i;return e.h.O||b(\"ES5\").S(e,r,o),o?(i[Q].P&&(g(e),n(4)),t(r)&&(r=M(e,r),e.l||x(e,r)),e.u&&b(\"Patches\").M(i[Q].t,r,e.u,e.s)):r=M(e,i,[]),g(e),e.u&&e.v(e.u,e.s),r!==H?r:void 0}function M(n,r,t){if(y(r))return r;var e=r[Q];if(!e)return i(r,(function(i,o){return A(n,e,r,i,o,t)}),!0),r;if(e.A!==n)return r;if(!e.P)return x(n,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=4===e.i||5===e.i?e.o=l(e.k):e.o,u=o,a=!1;3===e.i&&(u=new Set(o),o.clear(),a=!0),i(u,(function(r,i){return A(n,e,o,r,i,t,a)})),x(n,o,!1),t&&n.u&&b(\"Patches\").N(e,t,n.u,n.s)}return e.o}function A(e,i,o,a,c,s,v){if(\"production\"!==process.env.NODE_ENV&&c===o&&n(5),r(c)){var p=M(e,c,s&&i&&3!==i.i&&!u(i.R,a)?s.concat(a):void 0);if(f(o,a,p),!r(p))return;e.m=!1}else v&&o.add(c);if(t(c)&&!y(c)){if(!e.h.D&&e._<1)return;M(e,c),i&&i.A.l||x(e,c)}}function x(n,r,t){void 0===t&&(t=!1),!n.l&&n.h.D&&n.m&&d(r,t)}function z(n,r){var t=n[Q];return(t?p(t):n)[r]}function I(n,r){if(r in n)for(var t=Object.getPrototypeOf(n);t;){var e=Object.getOwnPropertyDescriptor(t,r);if(e)return e;t=Object.getPrototypeOf(t)}}function k(n){n.P||(n.P=!0,n.l&&k(n.l))}function E(n){n.o||(n.o=l(n.t))}function N(n,r,t){var e=s(r)?b(\"MapSet\").F(r,t):v(r)?b(\"MapSet\").T(r,t):n.O?function(n,r){var t=Array.isArray(n),e={i:t?1:0,A:r?r.A:_(),P:!1,I:!1,R:{},l:r,t:n,k:null,o:null,j:null,C:!1},i=e,o=en;t&&(i=[e],o=on);var u=Proxy.revocable(i,o),a=u.revoke,f=u.proxy;return e.k=f,e.j=a,f}(r,t):b(\"ES5\").J(r,t);return(t?t.A:_()).p.push(e),e}function R(e){return r(e)||n(22,e),function n(r){if(!t(r))return r;var e,u=r[Q],c=o(r);if(u){if(!u.P&&(u.i<4||!b(\"ES5\").K(u)))return u.t;u.I=!0,e=D(r,c),u.I=!1}else e=D(r,c);return i(e,(function(r,t){u&&a(u.t,r)===t||f(e,r,n(t))})),3===c?new Set(e):e}(e)}function D(n,r){switch(r){case 2:return new Map(n);case 3:return Array.from(n)}return l(n)}function F(){function t(n,r){var t=s[n];return t?t.enumerable=r:s[n]=t={configurable:!0,enumerable:r,get:function(){var r=this[Q];return\"production\"!==process.env.NODE_ENV&&f(r),en.get(r,n)},set:function(r){var t=this[Q];\"production\"!==process.env.NODE_ENV&&f(t),en.set(t,n,r)}},t}function e(n){for(var r=n.length-1;r>=0;r--){var t=n[r][Q];if(!t.P)switch(t.i){case 5:a(t)&&k(t);break;case 4:o(t)&&k(t)}}}function o(n){for(var r=n.t,t=n.k,e=nn(t),i=e.length-1;i>=0;i--){var o=e[i];if(o!==Q){var a=r[o];if(void 0===a&&!u(r,o))return!0;var f=t[o],s=f&&f[Q];if(s?s.t!==a:!c(f,a))return!0}}var v=!!r[Q];return e.length!==nn(r).length+(v?0:1)}function a(n){var r=n.k;if(r.length!==n.t.length)return!0;var t=Object.getOwnPropertyDescriptor(r,r.length-1);if(t&&!t.get)return!0;for(var e=0;e<r.length;e++)if(!r.hasOwnProperty(e))return!0;return!1}function f(r){r.g&&n(3,JSON.stringify(p(r)))}var s={};m(\"ES5\",{J:function(n,r){var e=Array.isArray(n),i=function(n,r){if(n){for(var e=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(e,\"\"+i,t(i,!0));return e}var o=rn(r);delete o[Q];for(var u=nn(o),a=0;a<u.length;a++){var f=u[a];o[f]=t(f,n||!!o[f].enumerable)}return Object.create(Object.getPrototypeOf(r),o)}(e,n),o={i:e?5:4,A:r?r.A:_(),P:!1,I:!1,R:{},l:r,t:n,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,Q,{value:o,writable:!0}),i},S:function(n,t,o){o?r(t)&&t[Q].A===n&&e(n.p):(n.u&&function n(r){if(r&&\"object\"==typeof r){var t=r[Q];if(t){var e=t.t,o=t.k,f=t.R,c=t.i;if(4===c)i(o,(function(r){r!==Q&&(void 0!==e[r]||u(e,r)?f[r]||n(o[r]):(f[r]=!0,k(t)))})),i(e,(function(n){void 0!==o[n]||u(o,n)||(f[n]=!1,k(t))}));else if(5===c){if(a(t)&&(k(t),f.length=!0),o.length<e.length)for(var s=o.length;s<e.length;s++)f[s]=!1;else for(var v=e.length;v<o.length;v++)f[v]=!0;for(var p=Math.min(o.length,e.length),l=0;l<p;l++)o.hasOwnProperty(l)||(f[l]=!0),void 0===f[l]&&n(o[l])}}}}(n.p[0]),e(n.p))},K:function(n){return 4===n.i?o(n):a(n)}})}function T(){function e(n){if(!t(n))return n;if(Array.isArray(n))return n.map(e);if(s(n))return new Map(Array.from(n.entries()).map((function(n){return[n[0],e(n[1])]})));if(v(n))return new Set(Array.from(n).map(e));var r=Object.create(Object.getPrototypeOf(n));for(var i in n)r[i]=e(n[i]);return u(n,L)&&(r[L]=n[L]),r}function f(n){return r(n)?e(n):n}var c=\"add\";m(\"Patches\",{$:function(r,t){return t.forEach((function(t){for(var i=t.path,u=t.op,f=r,s=0;s<i.length-1;s++){var v=o(f),p=i[s];\"string\"!=typeof p&&\"number\"!=typeof p&&(p=\"\"+p),0!==v&&1!==v||\"__proto__\"!==p&&\"constructor\"!==p||n(24),\"function\"==typeof f&&\"prototype\"===p&&n(24),\"object\"!=typeof(f=a(f,p))&&n(15,i.join(\"/\"))}var l=o(f),d=e(t.value),h=i[i.length-1];switch(u){case\"replace\":switch(l){case 2:return f.set(h,d);case 3:n(16);default:return f[h]=d}case c:switch(l){case 1:return\"-\"===h?f.push(d):f.splice(h,0,d);case 2:return f.set(h,d);case 3:return f.add(d);default:return f[h]=d}case\"remove\":switch(l){case 1:return f.splice(h,1);case 2:return f.delete(h);case 3:return f.delete(t.value);default:return delete f[h]}default:n(17,u)}})),r},N:function(n,r,t,e){switch(n.i){case 0:case 4:case 2:return function(n,r,t,e){var o=n.t,s=n.o;i(n.R,(function(n,i){var v=a(o,n),p=a(s,n),l=i?u(o,n)?\"replace\":c:\"remove\";if(v!==p||\"replace\"!==l){var d=r.concat(n);t.push(\"remove\"===l?{op:l,path:d}:{op:l,path:d,value:p}),e.push(l===c?{op:\"remove\",path:d}:\"remove\"===l?{op:c,path:d,value:f(v)}:{op:\"replace\",path:d,value:f(v)})}}))}(n,r,t,e);case 5:case 1:return function(n,r,t,e){var i=n.t,o=n.R,u=n.o;if(u.length<i.length){var a=[u,i];i=a[0],u=a[1];var s=[e,t];t=s[0],e=s[1]}for(var v=0;v<i.length;v++)if(o[v]&&u[v]!==i[v]){var p=r.concat([v]);t.push({op:\"replace\",path:p,value:f(u[v])}),e.push({op:\"replace\",path:p,value:f(i[v])})}for(var l=i.length;l<u.length;l++){var d=r.concat([l]);t.push({op:c,path:d,value:f(u[l])})}i.length<u.length&&e.push({op:\"replace\",path:r.concat([\"length\"]),value:i.length})}(n,r,t,e);case 3:return function(n,r,t,e){var i=n.t,o=n.o,u=0;i.forEach((function(n){if(!o.has(n)){var i=r.concat([u]);t.push({op:\"remove\",path:i,value:n}),e.unshift({op:c,path:i,value:n})}u++})),u=0,o.forEach((function(n){if(!i.has(n)){var o=r.concat([u]);t.push({op:c,path:o,value:n}),e.unshift({op:\"remove\",path:o,value:n})}u++}))}(n,r,t,e)}},M:function(n,r,t,e){t.push({op:\"replace\",path:[],value:r===H?void 0:r}),e.push({op:\"replace\",path:[],value:n})}})}function C(){function r(n,r){function t(){this.constructor=n}a(n,r),n.prototype=(t.prototype=r.prototype,new t)}function e(n){n.o||(n.R=new Map,n.o=new Map(n.t))}function o(n){n.o||(n.o=new Set,n.t.forEach((function(r){if(t(r)){var e=N(n.A.h,r,n);n.p.set(r,e),n.o.add(e)}else n.o.add(r)})))}function u(r){r.g&&n(3,JSON.stringify(p(r)))}var a=function(n,r){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t])})(n,r)},f=function(){function n(n,r){return this[Q]={i:2,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,R:void 0,t:n,k:this,C:!1,g:!1},this}r(n,Map);var o=n.prototype;return Object.defineProperty(o,\"size\",{get:function(){return p(this[Q]).size}}),o.has=function(n){return p(this[Q]).has(n)},o.set=function(n,r){var t=this[Q];return u(t),p(t).has(n)&&p(t).get(n)===r||(e(t),k(t),t.R.set(n,!0),t.o.set(n,r),t.R.set(n,!0)),this},o.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),e(r),k(r),r.t.has(n)?r.R.set(n,!1):r.R.delete(n),r.o.delete(n),!0},o.clear=function(){var n=this[Q];u(n),p(n).size&&(e(n),k(n),n.R=new Map,i(n.t,(function(r){n.R.set(r,!1)})),n.o.clear())},o.forEach=function(n,r){var t=this;p(this[Q]).forEach((function(e,i){n.call(r,t.get(i),i,t)}))},o.get=function(n){var r=this[Q];u(r);var i=p(r).get(n);if(r.I||!t(i))return i;if(i!==r.t.get(n))return i;var o=N(r.A.h,i,r);return e(r),r.o.set(n,o),o},o.keys=function(){return p(this[Q]).keys()},o.values=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.values()},n.next=function(){var n=t.next();return n.done?n:{done:!1,value:r.get(n.value)}},n},o.entries=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.entries()},n.next=function(){var n=t.next();if(n.done)return n;var e=r.get(n.value);return{done:!1,value:[n.value,e]}},n},o[V]=function(){return this.entries()},n}(),c=function(){function n(n,r){return this[Q]={i:3,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,t:n,k:this,p:new Map,g:!1,C:!1},this}r(n,Set);var t=n.prototype;return Object.defineProperty(t,\"size\",{get:function(){return p(this[Q]).size}}),t.has=function(n){var r=this[Q];return u(r),r.o?!!r.o.has(n)||!(!r.p.has(n)||!r.o.has(r.p.get(n))):r.t.has(n)},t.add=function(n){var r=this[Q];return u(r),this.has(n)||(o(r),k(r),r.o.add(n)),this},t.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),o(r),k(r),r.o.delete(n)||!!r.p.has(n)&&r.o.delete(r.p.get(n))},t.clear=function(){var n=this[Q];u(n),p(n).size&&(o(n),k(n),n.o.clear())},t.values=function(){var n=this[Q];return u(n),o(n),n.o.values()},t.entries=function(){var n=this[Q];return u(n),o(n),n.o.entries()},t.keys=function(){return this.values()},t[V]=function(){return this.values()},t.forEach=function(n,r){for(var t=this.values(),e=t.next();!e.done;)n.call(r,e.value,e.value,this),e=t.next()},n}();m(\"MapSet\",{F:function(n,r){return new f(n,r)},T:function(n,r){return new c(n,r)}})}function J(){F(),C(),T()}function K(n){return n}function $(n){return n}var G,U,W=\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol(\"x\"),X=\"undefined\"!=typeof Map,q=\"undefined\"!=typeof Set,B=\"undefined\"!=typeof Proxy&&void 0!==Proxy.revocable&&\"undefined\"!=typeof Reflect,H=W?Symbol.for(\"immer-nothing\"):((G={})[\"immer-nothing\"]=!0,G),L=W?Symbol.for(\"immer-draftable\"):\"__$immer_draftable\",Q=W?Symbol.for(\"immer-state\"):\"__$immer_state\",V=\"undefined\"!=typeof Symbol&&Symbol.iterator||\"@@iterator\",Y={0:\"Illegal state\",1:\"Immer drafts cannot have computed properties\",2:\"This object has been frozen and should not be mutated\",3:function(n){return\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \"+n},4:\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",5:\"Immer forbids circular references\",6:\"The first or second argument to `produce` must be a function\",7:\"The third argument to `produce` must be a function or undefined\",8:\"First argument to `createDraft` must be a plain object, an array, or an immerable object\",9:\"First argument to `finishDraft` must be a draft returned by `createDraft`\",10:\"The given draft is already finalized\",11:\"Object.defineProperty() cannot be used on an Immer draft\",12:\"Object.setPrototypeOf() cannot be used on an Immer draft\",13:\"Immer only supports deleting array indices\",14:\"Immer only supports setting array indices and the 'length' property\",15:function(n){return\"Cannot apply patch, path doesn't resolve: \"+n},16:'Sets cannot have \"replace\" patches.',17:function(n){return\"Unsupported patch operation: \"+n},18:function(n){return\"The plugin for '\"+n+\"' has not been loaded into Immer. To enable the plugin, import and call `enable\"+n+\"()` when initializing your application.\"},20:\"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\",21:function(n){return\"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '\"+n+\"'\"},22:function(n){return\"'current' expects a draft, got: \"+n},23:function(n){return\"'original' expects a draft, got: \"+n},24:\"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"},Z=\"\"+Object.prototype.constructor,nn=\"undefined\"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,rn=Object.getOwnPropertyDescriptors||function(n){var r={};return nn(n).forEach((function(t){r[t]=Object.getOwnPropertyDescriptor(n,t)})),r},tn={},en={get:function(n,r){if(r===Q)return n;var e=p(n);if(!u(e,r))return function(n,r,t){var e,i=I(r,t);return i?\"value\"in i?i.value:null===(e=i.get)||void 0===e?void 0:e.call(n.k):void 0}(n,e,r);var i=e[r];return n.I||!t(i)?i:i===z(n.t,r)?(E(n),n.o[r]=N(n.A.h,i,n)):i},has:function(n,r){return r in p(n)},ownKeys:function(n){return Reflect.ownKeys(p(n))},set:function(n,r,t){var e=I(p(n),r);if(null==e?void 0:e.set)return e.set.call(n.k,t),!0;if(!n.P){var i=z(p(n),r),o=null==i?void 0:i[Q];if(o&&o.t===t)return n.o[r]=t,n.R[r]=!1,!0;if(c(t,i)&&(void 0!==t||u(n.t,r)))return!0;E(n),k(n)}return n.o[r]===t&&(void 0!==t||r in n.o)||Number.isNaN(t)&&Number.isNaN(n.o[r])||(n.o[r]=t,n.R[r]=!0),!0},deleteProperty:function(n,r){return void 0!==z(n.t,r)||r in n.t?(n.R[r]=!1,E(n),k(n)):delete n.R[r],n.o&&delete n.o[r],!0},getOwnPropertyDescriptor:function(n,r){var t=p(n),e=Reflect.getOwnPropertyDescriptor(t,r);return e?{writable:!0,configurable:1!==n.i||\"length\"!==r,enumerable:e.enumerable,value:t[r]}:e},defineProperty:function(){n(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){n(12)}},on={};i(en,(function(n,r){on[n]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}})),on.deleteProperty=function(r,t){return\"production\"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&n(13),on.set.call(this,r,t,void 0)},on.set=function(r,t,e){return\"production\"!==process.env.NODE_ENV&&\"length\"!==t&&isNaN(parseInt(t))&&n(14),en.set.call(this,r[0],t,e,r[0])};var un=function(){function e(r){var e=this;this.O=B,this.D=!0,this.produce=function(r,i,o){if(\"function\"==typeof r&&\"function\"!=typeof i){var u=i;i=r;var a=e;return function(n){var r=this;void 0===n&&(n=u);for(var t=arguments.length,e=Array(t>1?t-1:0),o=1;o<t;o++)e[o-1]=arguments[o];return a.produce(n,(function(n){var t;return(t=i).call.apply(t,[r,n].concat(e))}))}}var f;if(\"function\"!=typeof i&&n(6),void 0!==o&&\"function\"!=typeof o&&n(7),t(r)){var c=w(e),s=N(e,r,void 0),v=!0;try{f=i(s),v=!1}finally{v?g(c):O(c)}return\"undefined\"!=typeof Promise&&f instanceof Promise?f.then((function(n){return j(c,o),P(n,c)}),(function(n){throw g(c),n})):(j(c,o),P(f,c))}if(!r||\"object\"!=typeof r){if(void 0===(f=i(r))&&(f=r),f===H&&(f=void 0),e.D&&d(f,!0),o){var p=[],l=[];b(\"Patches\").M(r,f,p,l),o(p,l)}return f}n(21,r)},this.produceWithPatches=function(n,r){if(\"function\"==typeof n)return function(r){for(var t=arguments.length,i=Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return e.produceWithPatches(r,(function(r){return n.apply(void 0,[r].concat(i))}))};var t,i,o=e.produce(n,r,(function(n,r){t=n,i=r}));return\"undefined\"!=typeof Promise&&o instanceof Promise?o.then((function(n){return[n,t,i]})):[o,t,i]},\"boolean\"==typeof(null==r?void 0:r.useProxies)&&this.setUseProxies(r.useProxies),\"boolean\"==typeof(null==r?void 0:r.autoFreeze)&&this.setAutoFreeze(r.autoFreeze)}var i=e.prototype;return i.createDraft=function(e){t(e)||n(8),r(e)&&(e=R(e));var i=w(this),o=N(this,e,void 0);return o[Q].C=!0,O(i),o},i.finishDraft=function(r,t){var e=r&&r[Q];\"production\"!==process.env.NODE_ENV&&(e&&e.C||n(9),e.I&&n(10));var i=e.A;return j(i,t),P(void 0,i)},i.setAutoFreeze=function(n){this.D=n},i.setUseProxies=function(r){r&&!B&&n(20),this.O=r},i.applyPatches=function(n,t){var e;for(e=t.length-1;e>=0;e--){var i=t[e];if(0===i.path.length&&\"replace\"===i.op){n=i.value;break}}e>-1&&(t=t.slice(e+1));var o=b(\"Patches\").$;return r(n)?o(n,t):this.produce(n,(function(n){return o(n,t)}))},e}(),an=new un,fn=an.produce,cn=an.produceWithPatches.bind(an),sn=an.setAutoFreeze.bind(an),vn=an.setUseProxies.bind(an),pn=an.applyPatches.bind(an),ln=an.createDraft.bind(an),dn=an.finishDraft.bind(an);export default fn;export{un as Immer,pn as applyPatches,K as castDraft,$ as castImmutable,ln as createDraft,R as current,J as enableAllPlugins,F as enableES5,C as enableMapSet,T as enablePatches,dn as finishDraft,d as freeze,L as immerable,r as isDraft,t as isDraftable,H as nothing,e as original,fn as produce,cn as produceWithPatches,sn as setAutoFreeze,vn as setUseProxies};\n//# sourceMappingURL=immer.esm.js.map\n","import { isPlainObject } from 'is-plain-object';\nimport { produce, createDraft, finishDraft, isDraft } from 'immer';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar DIRTY_PATHS = new WeakMap();\nvar DIRTY_PATH_KEYS = new WeakMap();\nvar FLUSHING = new WeakMap();\nvar NORMALIZING = new WeakMap();\nvar PATH_REFS = new WeakMap();\nvar POINT_REFS = new WeakMap();\nvar RANGE_REFS = new WeakMap();\n\nfunction ownKeys$9(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$9(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$9(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$9(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/**\r\n * Create a new Slate `Editor` object.\r\n */\n\nvar createEditor = () => {\n  var editor = {\n    children: [],\n    operations: [],\n    selection: null,\n    marks: null,\n    isInline: () => false,\n    isVoid: () => false,\n    onChange: () => {},\n    apply: op => {\n      for (var ref of Editor.pathRefs(editor)) {\n        PathRef.transform(ref, op);\n      }\n\n      for (var _ref of Editor.pointRefs(editor)) {\n        PointRef.transform(_ref, op);\n      }\n\n      for (var _ref2 of Editor.rangeRefs(editor)) {\n        RangeRef.transform(_ref2, op);\n      }\n\n      var oldDirtyPaths = DIRTY_PATHS.get(editor) || [];\n      var oldDirtyPathKeys = DIRTY_PATH_KEYS.get(editor) || new Set();\n      var dirtyPaths;\n      var dirtyPathKeys;\n\n      var add = path => {\n        if (path) {\n          var key = path.join(',');\n\n          if (!dirtyPathKeys.has(key)) {\n            dirtyPathKeys.add(key);\n            dirtyPaths.push(path);\n          }\n        }\n      };\n\n      if (Path.operationCanTransformPath(op)) {\n        dirtyPaths = [];\n        dirtyPathKeys = new Set();\n\n        for (var path of oldDirtyPaths) {\n          var newPath = Path.transform(path, op);\n          add(newPath);\n        }\n      } else {\n        dirtyPaths = oldDirtyPaths;\n        dirtyPathKeys = oldDirtyPathKeys;\n      }\n\n      var newDirtyPaths = getDirtyPaths(op);\n\n      for (var _path of newDirtyPaths) {\n        add(_path);\n      }\n\n      DIRTY_PATHS.set(editor, dirtyPaths);\n      DIRTY_PATH_KEYS.set(editor, dirtyPathKeys);\n      Transforms.transform(editor, op);\n      editor.operations.push(op);\n      Editor.normalize(editor); // Clear any formats applied to the cursor if the selection changes.\n\n      if (op.type === 'set_selection') {\n        editor.marks = null;\n      }\n\n      if (!FLUSHING.get(editor)) {\n        FLUSHING.set(editor, true);\n        Promise.resolve().then(() => {\n          FLUSHING.set(editor, false);\n          editor.onChange();\n          editor.operations = [];\n        });\n      }\n    },\n    addMark: (key, value) => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        if (Range.isExpanded(selection)) {\n          Transforms.setNodes(editor, {\n            [key]: value\n          }, {\n            match: Text.isText,\n            split: true\n          });\n        } else {\n          var marks = _objectSpread$9(_objectSpread$9({}, Editor.marks(editor) || {}), {}, {\n            [key]: value\n          });\n\n          editor.marks = marks;\n\n          if (!FLUSHING.get(editor)) {\n            editor.onChange();\n          }\n        }\n      }\n    },\n    deleteBackward: unit => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isCollapsed(selection)) {\n        Transforms.delete(editor, {\n          unit,\n          reverse: true\n        });\n      }\n    },\n    deleteForward: unit => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isCollapsed(selection)) {\n        Transforms.delete(editor, {\n          unit\n        });\n      }\n    },\n    deleteFragment: direction => {\n      var {\n        selection\n      } = editor;\n\n      if (selection && Range.isExpanded(selection)) {\n        Transforms.delete(editor, {\n          reverse: direction === 'backward'\n        });\n      }\n    },\n    getFragment: () => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        return Node.fragment(editor, selection);\n      }\n\n      return [];\n    },\n    insertBreak: () => {\n      Transforms.splitNodes(editor, {\n        always: true\n      });\n    },\n    insertFragment: fragment => {\n      Transforms.insertFragment(editor, fragment);\n    },\n    insertNode: node => {\n      Transforms.insertNodes(editor, node);\n    },\n    insertText: text => {\n      var {\n        selection,\n        marks\n      } = editor;\n\n      if (selection) {\n        if (marks) {\n          var node = _objectSpread$9({\n            text\n          }, marks);\n\n          Transforms.insertNodes(editor, node);\n        } else {\n          Transforms.insertText(editor, text);\n        }\n\n        editor.marks = null;\n      }\n    },\n    normalizeNode: entry => {\n      var [node, path] = entry; // There are no core normalizations for text nodes.\n\n      if (Text.isText(node)) {\n        return;\n      } // Ensure that block and inline nodes have at least one text child.\n\n\n      if (Element.isElement(node) && node.children.length === 0) {\n        var child = {\n          text: ''\n        };\n        Transforms.insertNodes(editor, child, {\n          at: path.concat(0),\n          voids: true\n        });\n        return;\n      } // Determine whether the node should have block or inline children.\n\n\n      var shouldHaveInlines = Editor.isEditor(node) ? false : Element.isElement(node) && (editor.isInline(node) || node.children.length === 0 || Text.isText(node.children[0]) || editor.isInline(node.children[0])); // Since we'll be applying operations while iterating, keep track of an\n      // index that accounts for any added/removed nodes.\n\n      var n = 0;\n\n      for (var i = 0; i < node.children.length; i++, n++) {\n        var currentNode = Node.get(editor, path);\n        if (Text.isText(currentNode)) continue;\n        var _child = node.children[i];\n        var prev = currentNode.children[n - 1];\n        var isLast = i === node.children.length - 1;\n        var isInlineOrText = Text.isText(_child) || Element.isElement(_child) && editor.isInline(_child); // Only allow block nodes in the top-level children and parent blocks\n        // that only contain block nodes. Similarly, only allow inline nodes in\n        // other inline nodes, or parent blocks that only contain inlines and\n        // text.\n\n        if (isInlineOrText !== shouldHaveInlines) {\n          Transforms.removeNodes(editor, {\n            at: path.concat(n),\n            voids: true\n          });\n          n--;\n        } else if (Element.isElement(_child)) {\n          // Ensure that inline nodes are surrounded by text nodes.\n          if (editor.isInline(_child)) {\n            if (prev == null || !Text.isText(prev)) {\n              var newChild = {\n                text: ''\n              };\n              Transforms.insertNodes(editor, newChild, {\n                at: path.concat(n),\n                voids: true\n              });\n              n++;\n            } else if (isLast) {\n              var _newChild = {\n                text: ''\n              };\n              Transforms.insertNodes(editor, _newChild, {\n                at: path.concat(n + 1),\n                voids: true\n              });\n              n++;\n            }\n          }\n        } else {\n          // Merge adjacent text nodes that are empty or match.\n          if (prev != null && Text.isText(prev)) {\n            if (Text.equals(_child, prev, {\n              loose: true\n            })) {\n              Transforms.mergeNodes(editor, {\n                at: path.concat(n),\n                voids: true\n              });\n              n--;\n            } else if (prev.text === '') {\n              Transforms.removeNodes(editor, {\n                at: path.concat(n - 1),\n                voids: true\n              });\n              n--;\n            } else if (_child.text === '') {\n              Transforms.removeNodes(editor, {\n                at: path.concat(n),\n                voids: true\n              });\n              n--;\n            }\n          }\n        }\n      }\n    },\n    removeMark: key => {\n      var {\n        selection\n      } = editor;\n\n      if (selection) {\n        if (Range.isExpanded(selection)) {\n          Transforms.unsetNodes(editor, key, {\n            match: Text.isText,\n            split: true\n          });\n        } else {\n          var marks = _objectSpread$9({}, Editor.marks(editor) || {});\n\n          delete marks[key];\n          editor.marks = marks;\n\n          if (!FLUSHING.get(editor)) {\n            editor.onChange();\n          }\n        }\n      }\n    }\n  };\n  return editor;\n};\n/**\r\n * Get the \"dirty\" paths generated from an operation.\r\n */\n\nvar getDirtyPaths = op => {\n  switch (op.type) {\n    case 'insert_text':\n    case 'remove_text':\n    case 'set_node':\n      {\n        var {\n          path\n        } = op;\n        return Path.levels(path);\n      }\n\n    case 'insert_node':\n      {\n        var {\n          node,\n          path: _path2\n        } = op;\n        var levels = Path.levels(_path2);\n        var descendants = Text.isText(node) ? [] : Array.from(Node.nodes(node), _ref3 => {\n          var [, p] = _ref3;\n          return _path2.concat(p);\n        });\n        return [...levels, ...descendants];\n      }\n\n    case 'merge_node':\n      {\n        var {\n          path: _path3\n        } = op;\n        var ancestors = Path.ancestors(_path3);\n        var previousPath = Path.previous(_path3);\n        return [...ancestors, previousPath];\n      }\n\n    case 'move_node':\n      {\n        var {\n          path: _path4,\n          newPath\n        } = op;\n\n        if (Path.equals(_path4, newPath)) {\n          return [];\n        }\n\n        var oldAncestors = [];\n        var newAncestors = [];\n\n        for (var ancestor of Path.ancestors(_path4)) {\n          var p = Path.transform(ancestor, op);\n          oldAncestors.push(p);\n        }\n\n        for (var _ancestor of Path.ancestors(newPath)) {\n          var _p = Path.transform(_ancestor, op);\n\n          newAncestors.push(_p);\n        }\n\n        var newParent = newAncestors[newAncestors.length - 1];\n        var newIndex = newPath[newPath.length - 1];\n        var resultPath = newParent.concat(newIndex);\n        return [...oldAncestors, ...newAncestors, resultPath];\n      }\n\n    case 'remove_node':\n      {\n        var {\n          path: _path5\n        } = op;\n\n        var _ancestors = Path.ancestors(_path5);\n\n        return [..._ancestors];\n      }\n\n    case 'split_node':\n      {\n        var {\n          path: _path6\n        } = op;\n\n        var _levels = Path.levels(_path6);\n\n        var nextPath = Path.next(_path6);\n        return [..._levels, nextPath];\n      }\n\n    default:\n      {\n        return [];\n      }\n  }\n};\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n// Character (grapheme cluster) boundaries are determined according to\n// the default grapheme cluster boundary specification, extended grapheme clusters variant[1].\n//\n// References:\n//\n// [1] https://www.unicode.org/reports/tr29/#Default_Grapheme_Cluster_Table\n// [2] https://www.unicode.org/Public/UCD/latest/ucd/auxiliary/GraphemeBreakProperty.txt\n// [3] https://www.unicode.org/Public/UCD/latest/ucd/auxiliary/GraphemeBreakTest.html\n// [4] https://www.unicode.org/Public/UCD/latest/ucd/auxiliary/GraphemeBreakTest.txt\n\n/**\r\n * Get the distance to the end of the first character in a string of text.\r\n */\nvar getCharacterDistance = function getCharacterDistance(str) {\n  var isRTL = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var isLTR = !isRTL;\n  var codepoints = isRTL ? codepointsIteratorRTL(str) : str;\n  var left = CodepointType.None;\n  var right = CodepointType.None;\n  var distance = 0; // Evaluation of these conditions are deferred.\n\n  var gb11 = null; // Is GB11 applicable?\n\n  var gb12Or13 = null; // Is GB12 or GB13 applicable?\n\n  for (var char of codepoints) {\n    var code = char.codePointAt(0);\n    if (!code) break;\n    var type = getCodepointType(char, code);\n    [left, right] = isLTR ? [right, type] : [type, left];\n\n    if (intersects(left, CodepointType.ZWJ) && intersects(right, CodepointType.ExtPict)) {\n      if (isLTR) {\n        gb11 = endsWithEmojiZWJ(str.substring(0, distance));\n      } else {\n        gb11 = endsWithEmojiZWJ(str.substring(0, str.length - distance));\n      }\n\n      if (!gb11) break;\n    }\n\n    if (intersects(left, CodepointType.RI) && intersects(right, CodepointType.RI)) {\n      if (gb12Or13 !== null) {\n        gb12Or13 = !gb12Or13;\n      } else {\n        if (isLTR) {\n          gb12Or13 = true;\n        } else {\n          gb12Or13 = endsWithOddNumberOfRIs(str.substring(0, str.length - distance));\n        }\n      }\n\n      if (!gb12Or13) break;\n    }\n\n    if (left !== CodepointType.None && right !== CodepointType.None && isBoundaryPair(left, right)) {\n      break;\n    }\n\n    distance += char.length;\n  }\n\n  return distance || 1;\n};\nvar SPACE = /\\s/;\nvar PUNCTUATION = /[\\u0021-\\u0023\\u0025-\\u002A\\u002C-\\u002F\\u003A\\u003B\\u003F\\u0040\\u005B-\\u005D\\u005F\\u007B\\u007D\\u00A1\\u00A7\\u00AB\\u00B6\\u00B7\\u00BB\\u00BF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0AF0\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E3B\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]/;\nvar CHAMELEON = /['\\u2018\\u2019]/;\n/**\r\n * Get the distance to the end of the first word in a string of text.\r\n */\n\nvar getWordDistance = function getWordDistance(text) {\n  var isRTL = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var dist = 0;\n  var started = false;\n\n  while (text.length > 0) {\n    var charDist = getCharacterDistance(text, isRTL);\n    var [char, remaining] = splitByCharacterDistance(text, charDist, isRTL);\n\n    if (isWordCharacter(char, remaining, isRTL)) {\n      started = true;\n      dist += charDist;\n    } else if (!started) {\n      dist += charDist;\n    } else {\n      break;\n    }\n\n    text = remaining;\n  }\n\n  return dist;\n};\n/**\r\n * Split a string in two parts at a given distance starting from the end when\r\n * `isRTL` is set to `true`.\r\n */\n\nvar splitByCharacterDistance = (str, dist, isRTL) => {\n  if (isRTL) {\n    var at = str.length - dist;\n    return [str.slice(at, str.length), str.slice(0, at)];\n  }\n\n  return [str.slice(0, dist), str.slice(dist)];\n};\n/**\r\n * Check if a character is a word character. The `remaining` argument is used\r\n * because sometimes you must read subsequent characters to truly determine it.\r\n */\n\nvar isWordCharacter = function isWordCharacter(char, remaining) {\n  var isRTL = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n  if (SPACE.test(char)) {\n    return false;\n  } // Chameleons count as word characters as long as they're in a word, so\n  // recurse to see if the next one is a word character or not.\n\n\n  if (CHAMELEON.test(char)) {\n    var charDist = getCharacterDistance(remaining, isRTL);\n    var [nextChar, nextRemaining] = splitByCharacterDistance(remaining, charDist, isRTL);\n\n    if (isWordCharacter(nextChar, nextRemaining, isRTL)) {\n      return true;\n    }\n  }\n\n  if (PUNCTUATION.test(char)) {\n    return false;\n  }\n\n  return true;\n};\n/**\r\n * Iterate on codepoints from right to left.\r\n */\n\n\nvar codepointsIteratorRTL = function* codepointsIteratorRTL(str) {\n  var end = str.length - 1;\n\n  for (var i = 0; i < str.length; i++) {\n    var char1 = str.charAt(end - i);\n\n    if (isLowSurrogate(char1.charCodeAt(0))) {\n      var char2 = str.charAt(end - i - 1);\n\n      if (isHighSurrogate(char2.charCodeAt(0))) {\n        yield char2 + char1;\n        i++;\n        continue;\n      }\n    }\n\n    yield char1;\n  }\n};\n/**\r\n * Is `charCode` a high surrogate.\r\n *\r\n * https://en.wikipedia.org/wiki/Universal_Character_Set_characters#Surrogates\r\n */\n\nvar isHighSurrogate = charCode => {\n  return charCode >= 0xd800 && charCode <= 0xdbff;\n};\n/**\r\n * Is `charCode` a low surrogate.\r\n *\r\n * https://en.wikipedia.org/wiki/Universal_Character_Set_characters#Surrogates\r\n */\n\n\nvar isLowSurrogate = charCode => {\n  return charCode >= 0xdc00 && charCode <= 0xdfff;\n};\n\nvar CodepointType;\n\n(function (CodepointType) {\n  CodepointType[CodepointType[\"None\"] = 0] = \"None\";\n  CodepointType[CodepointType[\"Extend\"] = 1] = \"Extend\";\n  CodepointType[CodepointType[\"ZWJ\"] = 2] = \"ZWJ\";\n  CodepointType[CodepointType[\"RI\"] = 4] = \"RI\";\n  CodepointType[CodepointType[\"Prepend\"] = 8] = \"Prepend\";\n  CodepointType[CodepointType[\"SpacingMark\"] = 16] = \"SpacingMark\";\n  CodepointType[CodepointType[\"L\"] = 32] = \"L\";\n  CodepointType[CodepointType[\"V\"] = 64] = \"V\";\n  CodepointType[CodepointType[\"T\"] = 128] = \"T\";\n  CodepointType[CodepointType[\"LV\"] = 256] = \"LV\";\n  CodepointType[CodepointType[\"LVT\"] = 512] = \"LVT\";\n  CodepointType[CodepointType[\"ExtPict\"] = 1024] = \"ExtPict\";\n  CodepointType[CodepointType[\"Any\"] = 2048] = \"Any\";\n})(CodepointType || (CodepointType = {}));\n\nvar reExtend = /^(?:[\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u07FD\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08D3-\\u08E1\\u08E3-\\u0902\\u093A\\u093C\\u0941-\\u0948\\u094D\\u0951-\\u0957\\u0962\\u0963\\u0981\\u09BC\\u09BE\\u09C1-\\u09C4\\u09CD\\u09D7\\u09E2\\u09E3\\u09FE\\u0A01\\u0A02\\u0A3C\\u0A41\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81\\u0A82\\u0ABC\\u0AC1-\\u0AC5\\u0AC7\\u0AC8\\u0ACD\\u0AE2\\u0AE3\\u0AFA-\\u0AFF\\u0B01\\u0B3C\\u0B3E\\u0B3F\\u0B41-\\u0B44\\u0B4D\\u0B55-\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE\\u0BC0\\u0BCD\\u0BD7\\u0C00\\u0C04\\u0C3E-\\u0C40\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81\\u0CBC\\u0CBF\\u0CC2\\u0CC6\\u0CCC\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D00\\u0D01\\u0D3B\\u0D3C\\u0D3E\\u0D41-\\u0D44\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D81\\u0DCA\\u0DCF\\u0DD2-\\u0DD4\\u0DD6\\u0DDF\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F71-\\u0F7E\\u0F80-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102D-\\u1030\\u1032-\\u1037\\u1039\\u103A\\u103D\\u103E\\u1058\\u1059\\u105E-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108D\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4\\u17B5\\u17B7-\\u17BD\\u17C6\\u17C9-\\u17D3\\u17DD\\u180B-\\u180D\\u1885\\u1886\\u18A9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193B\\u1A17\\u1A18\\u1A1B\\u1A56\\u1A58-\\u1A5E\\u1A60\\u1A62\\u1A65-\\u1A6C\\u1A73-\\u1A7C\\u1A7F\\u1AB0-\\u1AC0\\u1B00-\\u1B03\\u1B34-\\u1B3A\\u1B3C\\u1B42\\u1B6B-\\u1B73\\u1B80\\u1B81\\u1BA2-\\u1BA5\\u1BA8\\u1BA9\\u1BAB-\\u1BAD\\u1BE6\\u1BE8\\u1BE9\\u1BED\\u1BEF-\\u1BF1\\u1C2C-\\u1C33\\u1C36\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE0\\u1CE2-\\u1CE8\\u1CED\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF9\\u1DFB-\\u1DFF\\u200C\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69E\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA825\\uA826\\uA82C\\uA8C4\\uA8C5\\uA8E0-\\uA8F1\\uA8FF\\uA926-\\uA92D\\uA947-\\uA951\\uA980-\\uA982\\uA9B3\\uA9B6-\\uA9B9\\uA9BC\\uA9BD\\uA9E5\\uAA29-\\uAA2E\\uAA31\\uAA32\\uAA35\\uAA36\\uAA43\\uAA4C\\uAA7C\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEC\\uAAED\\uAAF6\\uABE5\\uABE8\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2F\\uFF9E\\uFF9F]|\\uD800[\\uDDFD\\uDEE0\\uDF76-\\uDF7A]|\\uD802[\\uDE01-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE0F\\uDE38-\\uDE3A\\uDE3F\\uDEE5\\uDEE6]|\\uD803[\\uDD24-\\uDD27\\uDEAB\\uDEAC\\uDF46-\\uDF50]|\\uD804[\\uDC01\\uDC38-\\uDC46\\uDC7F-\\uDC81\\uDCB3-\\uDCB6\\uDCB9\\uDCBA\\uDD00-\\uDD02\\uDD27-\\uDD2B\\uDD2D-\\uDD34\\uDD73\\uDD80\\uDD81\\uDDB6-\\uDDBE\\uDDC9-\\uDDCC\\uDDCF\\uDE2F-\\uDE31\\uDE34\\uDE36\\uDE37\\uDE3E\\uDEDF\\uDEE3-\\uDEEA\\uDF00\\uDF01\\uDF3B\\uDF3C\\uDF3E\\uDF40\\uDF57\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC38-\\uDC3F\\uDC42-\\uDC44\\uDC46\\uDC5E\\uDCB0\\uDCB3-\\uDCB8\\uDCBA\\uDCBD\\uDCBF\\uDCC0\\uDCC2\\uDCC3\\uDDAF\\uDDB2-\\uDDB5\\uDDBC\\uDDBD\\uDDBF\\uDDC0\\uDDDC\\uDDDD\\uDE33-\\uDE3A\\uDE3D\\uDE3F\\uDE40\\uDEAB\\uDEAD\\uDEB0-\\uDEB5\\uDEB7\\uDF1D-\\uDF1F\\uDF22-\\uDF25\\uDF27-\\uDF2B]|\\uD806[\\uDC2F-\\uDC37\\uDC39\\uDC3A\\uDD30\\uDD3B\\uDD3C\\uDD3E\\uDD43\\uDDD4-\\uDDD7\\uDDDA\\uDDDB\\uDDE0\\uDE01-\\uDE0A\\uDE33-\\uDE38\\uDE3B-\\uDE3E\\uDE47\\uDE51-\\uDE56\\uDE59-\\uDE5B\\uDE8A-\\uDE96\\uDE98\\uDE99]|\\uD807[\\uDC30-\\uDC36\\uDC38-\\uDC3D\\uDC3F\\uDC92-\\uDCA7\\uDCAA-\\uDCB0\\uDCB2\\uDCB3\\uDCB5\\uDCB6\\uDD31-\\uDD36\\uDD3A\\uDD3C\\uDD3D\\uDD3F-\\uDD45\\uDD47\\uDD90\\uDD91\\uDD95\\uDD97\\uDEF3\\uDEF4]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF4F\\uDF8F-\\uDF92\\uDFE4]|\\uD82F[\\uDC9D\\uDC9E]|\\uD834[\\uDD65\\uDD67-\\uDD69\\uDD6E-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44]|\\uD836[\\uDE00-\\uDE36\\uDE3B-\\uDE6C\\uDE75\\uDE84\\uDE9B-\\uDE9F\\uDEA1-\\uDEAF]|\\uD838[\\uDC00-\\uDC06\\uDC08-\\uDC18\\uDC1B-\\uDC21\\uDC23\\uDC24\\uDC26-\\uDC2A\\uDD30-\\uDD36\\uDEEC-\\uDEEF]|\\uD83A[\\uDCD0-\\uDCD6\\uDD44-\\uDD4A]|\\uD83C[\\uDFFB-\\uDFFF]|\\uDB40[\\uDC20-\\uDC7F\\uDD00-\\uDDEF])$/;\nvar rePrepend = /^(?:[\\u0600-\\u0605\\u06DD\\u070F\\u0890\\u0891\\u08E2\\u0D4E]|\\uD804[\\uDCBD\\uDCCD\\uDDC2\\uDDC3]|\\uD806[\\uDD3F\\uDD41\\uDE3A\\uDE84-\\uDE89]|\\uD807\\uDD46)$/;\nvar reSpacingMark = /^(?:[\\u0903\\u093B\\u093E-\\u0940\\u0949-\\u094C\\u094E\\u094F\\u0982\\u0983\\u09BF\\u09C0\\u09C7\\u09C8\\u09CB\\u09CC\\u0A03\\u0A3E-\\u0A40\\u0A83\\u0ABE-\\u0AC0\\u0AC9\\u0ACB\\u0ACC\\u0B02\\u0B03\\u0B40\\u0B47\\u0B48\\u0B4B\\u0B4C\\u0BBF\\u0BC1\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCC\\u0C01-\\u0C03\\u0C41-\\u0C44\\u0C82\\u0C83\\u0CBE\\u0CC0\\u0CC1\\u0CC3\\u0CC4\\u0CC7\\u0CC8\\u0CCA\\u0CCB\\u0D02\\u0D03\\u0D3F\\u0D40\\u0D46-\\u0D48\\u0D4A-\\u0D4C\\u0D82\\u0D83\\u0DD0\\u0DD1\\u0DD8-\\u0DDE\\u0DF2\\u0DF3\\u0E33\\u0EB3\\u0F3E\\u0F3F\\u0F7F\\u1031\\u103B\\u103C\\u1056\\u1057\\u1084\\u1715\\u1734\\u17B6\\u17BE-\\u17C5\\u17C7\\u17C8\\u1923-\\u1926\\u1929-\\u192B\\u1930\\u1931\\u1933-\\u1938\\u1A19\\u1A1A\\u1A55\\u1A57\\u1A6D-\\u1A72\\u1B04\\u1B3B\\u1B3D-\\u1B41\\u1B43\\u1B44\\u1B82\\u1BA1\\u1BA6\\u1BA7\\u1BAA\\u1BE7\\u1BEA-\\u1BEC\\u1BEE\\u1BF2\\u1BF3\\u1C24-\\u1C2B\\u1C34\\u1C35\\u1CE1\\u1CF7\\uA823\\uA824\\uA827\\uA880\\uA881\\uA8B4-\\uA8C3\\uA952\\uA953\\uA983\\uA9B4\\uA9B5\\uA9BA\\uA9BB\\uA9BE-\\uA9C0\\uAA2F\\uAA30\\uAA33\\uAA34\\uAA4D\\uAAEB\\uAAEE\\uAAEF\\uAAF5\\uABE3\\uABE4\\uABE6\\uABE7\\uABE9\\uABEA\\uABEC]|\\uD804[\\uDC00\\uDC02\\uDC82\\uDCB0-\\uDCB2\\uDCB7\\uDCB8\\uDD2C\\uDD45\\uDD46\\uDD82\\uDDB3-\\uDDB5\\uDDBF\\uDDC0\\uDDCE\\uDE2C-\\uDE2E\\uDE32\\uDE33\\uDE35\\uDEE0-\\uDEE2\\uDF02\\uDF03\\uDF3F\\uDF41-\\uDF44\\uDF47\\uDF48\\uDF4B-\\uDF4D\\uDF62\\uDF63]|\\uD805[\\uDC35-\\uDC37\\uDC40\\uDC41\\uDC45\\uDCB1\\uDCB2\\uDCB9\\uDCBB\\uDCBC\\uDCBE\\uDCC1\\uDDB0\\uDDB1\\uDDB8-\\uDDBB\\uDDBE\\uDE30-\\uDE32\\uDE3B\\uDE3C\\uDE3E\\uDEAC\\uDEAE\\uDEAF\\uDEB6\\uDF26]|\\uD806[\\uDC2C-\\uDC2E\\uDC38\\uDD31-\\uDD35\\uDD37\\uDD38\\uDD3D\\uDD40\\uDD42\\uDDD1-\\uDDD3\\uDDDC-\\uDDDF\\uDDE4\\uDE39\\uDE57\\uDE58\\uDE97]|\\uD807[\\uDC2F\\uDC3E\\uDCA9\\uDCB1\\uDCB4\\uDD8A-\\uDD8E\\uDD93\\uDD94\\uDD96\\uDEF5\\uDEF6]|\\uD81B[\\uDF51-\\uDF87\\uDFF0\\uDFF1]|\\uD834[\\uDD66\\uDD6D])$/;\nvar reL = /^[\\u1100-\\u115F\\uA960-\\uA97C]$/;\nvar reV = /^[\\u1160-\\u11A7\\uD7B0-\\uD7C6]$/;\nvar reT = /^[\\u11A8-\\u11FF\\uD7CB-\\uD7FB]$/;\nvar reLV = /^[\\uAC00\\uAC1C\\uAC38\\uAC54\\uAC70\\uAC8C\\uACA8\\uACC4\\uACE0\\uACFC\\uAD18\\uAD34\\uAD50\\uAD6C\\uAD88\\uADA4\\uADC0\\uADDC\\uADF8\\uAE14\\uAE30\\uAE4C\\uAE68\\uAE84\\uAEA0\\uAEBC\\uAED8\\uAEF4\\uAF10\\uAF2C\\uAF48\\uAF64\\uAF80\\uAF9C\\uAFB8\\uAFD4\\uAFF0\\uB00C\\uB028\\uB044\\uB060\\uB07C\\uB098\\uB0B4\\uB0D0\\uB0EC\\uB108\\uB124\\uB140\\uB15C\\uB178\\uB194\\uB1B0\\uB1CC\\uB1E8\\uB204\\uB220\\uB23C\\uB258\\uB274\\uB290\\uB2AC\\uB2C8\\uB2E4\\uB300\\uB31C\\uB338\\uB354\\uB370\\uB38C\\uB3A8\\uB3C4\\uB3E0\\uB3FC\\uB418\\uB434\\uB450\\uB46C\\uB488\\uB4A4\\uB4C0\\uB4DC\\uB4F8\\uB514\\uB530\\uB54C\\uB568\\uB584\\uB5A0\\uB5BC\\uB5D8\\uB5F4\\uB610\\uB62C\\uB648\\uB664\\uB680\\uB69C\\uB6B8\\uB6D4\\uB6F0\\uB70C\\uB728\\uB744\\uB760\\uB77C\\uB798\\uB7B4\\uB7D0\\uB7EC\\uB808\\uB824\\uB840\\uB85C\\uB878\\uB894\\uB8B0\\uB8CC\\uB8E8\\uB904\\uB920\\uB93C\\uB958\\uB974\\uB990\\uB9AC\\uB9C8\\uB9E4\\uBA00\\uBA1C\\uBA38\\uBA54\\uBA70\\uBA8C\\uBAA8\\uBAC4\\uBAE0\\uBAFC\\uBB18\\uBB34\\uBB50\\uBB6C\\uBB88\\uBBA4\\uBBC0\\uBBDC\\uBBF8\\uBC14\\uBC30\\uBC4C\\uBC68\\uBC84\\uBCA0\\uBCBC\\uBCD8\\uBCF4\\uBD10\\uBD2C\\uBD48\\uBD64\\uBD80\\uBD9C\\uBDB8\\uBDD4\\uBDF0\\uBE0C\\uBE28\\uBE44\\uBE60\\uBE7C\\uBE98\\uBEB4\\uBED0\\uBEEC\\uBF08\\uBF24\\uBF40\\uBF5C\\uBF78\\uBF94\\uBFB0\\uBFCC\\uBFE8\\uC004\\uC020\\uC03C\\uC058\\uC074\\uC090\\uC0AC\\uC0C8\\uC0E4\\uC100\\uC11C\\uC138\\uC154\\uC170\\uC18C\\uC1A8\\uC1C4\\uC1E0\\uC1FC\\uC218\\uC234\\uC250\\uC26C\\uC288\\uC2A4\\uC2C0\\uC2DC\\uC2F8\\uC314\\uC330\\uC34C\\uC368\\uC384\\uC3A0\\uC3BC\\uC3D8\\uC3F4\\uC410\\uC42C\\uC448\\uC464\\uC480\\uC49C\\uC4B8\\uC4D4\\uC4F0\\uC50C\\uC528\\uC544\\uC560\\uC57C\\uC598\\uC5B4\\uC5D0\\uC5EC\\uC608\\uC624\\uC640\\uC65C\\uC678\\uC694\\uC6B0\\uC6CC\\uC6E8\\uC704\\uC720\\uC73C\\uC758\\uC774\\uC790\\uC7AC\\uC7C8\\uC7E4\\uC800\\uC81C\\uC838\\uC854\\uC870\\uC88C\\uC8A8\\uC8C4\\uC8E0\\uC8FC\\uC918\\uC934\\uC950\\uC96C\\uC988\\uC9A4\\uC9C0\\uC9DC\\uC9F8\\uCA14\\uCA30\\uCA4C\\uCA68\\uCA84\\uCAA0\\uCABC\\uCAD8\\uCAF4\\uCB10\\uCB2C\\uCB48\\uCB64\\uCB80\\uCB9C\\uCBB8\\uCBD4\\uCBF0\\uCC0C\\uCC28\\uCC44\\uCC60\\uCC7C\\uCC98\\uCCB4\\uCCD0\\uCCEC\\uCD08\\uCD24\\uCD40\\uCD5C\\uCD78\\uCD94\\uCDB0\\uCDCC\\uCDE8\\uCE04\\uCE20\\uCE3C\\uCE58\\uCE74\\uCE90\\uCEAC\\uCEC8\\uCEE4\\uCF00\\uCF1C\\uCF38\\uCF54\\uCF70\\uCF8C\\uCFA8\\uCFC4\\uCFE0\\uCFFC\\uD018\\uD034\\uD050\\uD06C\\uD088\\uD0A4\\uD0C0\\uD0DC\\uD0F8\\uD114\\uD130\\uD14C\\uD168\\uD184\\uD1A0\\uD1BC\\uD1D8\\uD1F4\\uD210\\uD22C\\uD248\\uD264\\uD280\\uD29C\\uD2B8\\uD2D4\\uD2F0\\uD30C\\uD328\\uD344\\uD360\\uD37C\\uD398\\uD3B4\\uD3D0\\uD3EC\\uD408\\uD424\\uD440\\uD45C\\uD478\\uD494\\uD4B0\\uD4CC\\uD4E8\\uD504\\uD520\\uD53C\\uD558\\uD574\\uD590\\uD5AC\\uD5C8\\uD5E4\\uD600\\uD61C\\uD638\\uD654\\uD670\\uD68C\\uD6A8\\uD6C4\\uD6E0\\uD6FC\\uD718\\uD734\\uD750\\uD76C\\uD788]$/;\nvar reLVT = /^[\\uAC01-\\uAC1B\\uAC1D-\\uAC37\\uAC39-\\uAC53\\uAC55-\\uAC6F\\uAC71-\\uAC8B\\uAC8D-\\uACA7\\uACA9-\\uACC3\\uACC5-\\uACDF\\uACE1-\\uACFB\\uACFD-\\uAD17\\uAD19-\\uAD33\\uAD35-\\uAD4F\\uAD51-\\uAD6B\\uAD6D-\\uAD87\\uAD89-\\uADA3\\uADA5-\\uADBF\\uADC1-\\uADDB\\uADDD-\\uADF7\\uADF9-\\uAE13\\uAE15-\\uAE2F\\uAE31-\\uAE4B\\uAE4D-\\uAE67\\uAE69-\\uAE83\\uAE85-\\uAE9F\\uAEA1-\\uAEBB\\uAEBD-\\uAED7\\uAED9-\\uAEF3\\uAEF5-\\uAF0F\\uAF11-\\uAF2B\\uAF2D-\\uAF47\\uAF49-\\uAF63\\uAF65-\\uAF7F\\uAF81-\\uAF9B\\uAF9D-\\uAFB7\\uAFB9-\\uAFD3\\uAFD5-\\uAFEF\\uAFF1-\\uB00B\\uB00D-\\uB027\\uB029-\\uB043\\uB045-\\uB05F\\uB061-\\uB07B\\uB07D-\\uB097\\uB099-\\uB0B3\\uB0B5-\\uB0CF\\uB0D1-\\uB0EB\\uB0ED-\\uB107\\uB109-\\uB123\\uB125-\\uB13F\\uB141-\\uB15B\\uB15D-\\uB177\\uB179-\\uB193\\uB195-\\uB1AF\\uB1B1-\\uB1CB\\uB1CD-\\uB1E7\\uB1E9-\\uB203\\uB205-\\uB21F\\uB221-\\uB23B\\uB23D-\\uB257\\uB259-\\uB273\\uB275-\\uB28F\\uB291-\\uB2AB\\uB2AD-\\uB2C7\\uB2C9-\\uB2E3\\uB2E5-\\uB2FF\\uB301-\\uB31B\\uB31D-\\uB337\\uB339-\\uB353\\uB355-\\uB36F\\uB371-\\uB38B\\uB38D-\\uB3A7\\uB3A9-\\uB3C3\\uB3C5-\\uB3DF\\uB3E1-\\uB3FB\\uB3FD-\\uB417\\uB419-\\uB433\\uB435-\\uB44F\\uB451-\\uB46B\\uB46D-\\uB487\\uB489-\\uB4A3\\uB4A5-\\uB4BF\\uB4C1-\\uB4DB\\uB4DD-\\uB4F7\\uB4F9-\\uB513\\uB515-\\uB52F\\uB531-\\uB54B\\uB54D-\\uB567\\uB569-\\uB583\\uB585-\\uB59F\\uB5A1-\\uB5BB\\uB5BD-\\uB5D7\\uB5D9-\\uB5F3\\uB5F5-\\uB60F\\uB611-\\uB62B\\uB62D-\\uB647\\uB649-\\uB663\\uB665-\\uB67F\\uB681-\\uB69B\\uB69D-\\uB6B7\\uB6B9-\\uB6D3\\uB6D5-\\uB6EF\\uB6F1-\\uB70B\\uB70D-\\uB727\\uB729-\\uB743\\uB745-\\uB75F\\uB761-\\uB77B\\uB77D-\\uB797\\uB799-\\uB7B3\\uB7B5-\\uB7CF\\uB7D1-\\uB7EB\\uB7ED-\\uB807\\uB809-\\uB823\\uB825-\\uB83F\\uB841-\\uB85B\\uB85D-\\uB877\\uB879-\\uB893\\uB895-\\uB8AF\\uB8B1-\\uB8CB\\uB8CD-\\uB8E7\\uB8E9-\\uB903\\uB905-\\uB91F\\uB921-\\uB93B\\uB93D-\\uB957\\uB959-\\uB973\\uB975-\\uB98F\\uB991-\\uB9AB\\uB9AD-\\uB9C7\\uB9C9-\\uB9E3\\uB9E5-\\uB9FF\\uBA01-\\uBA1B\\uBA1D-\\uBA37\\uBA39-\\uBA53\\uBA55-\\uBA6F\\uBA71-\\uBA8B\\uBA8D-\\uBAA7\\uBAA9-\\uBAC3\\uBAC5-\\uBADF\\uBAE1-\\uBAFB\\uBAFD-\\uBB17\\uBB19-\\uBB33\\uBB35-\\uBB4F\\uBB51-\\uBB6B\\uBB6D-\\uBB87\\uBB89-\\uBBA3\\uBBA5-\\uBBBF\\uBBC1-\\uBBDB\\uBBDD-\\uBBF7\\uBBF9-\\uBC13\\uBC15-\\uBC2F\\uBC31-\\uBC4B\\uBC4D-\\uBC67\\uBC69-\\uBC83\\uBC85-\\uBC9F\\uBCA1-\\uBCBB\\uBCBD-\\uBCD7\\uBCD9-\\uBCF3\\uBCF5-\\uBD0F\\uBD11-\\uBD2B\\uBD2D-\\uBD47\\uBD49-\\uBD63\\uBD65-\\uBD7F\\uBD81-\\uBD9B\\uBD9D-\\uBDB7\\uBDB9-\\uBDD3\\uBDD5-\\uBDEF\\uBDF1-\\uBE0B\\uBE0D-\\uBE27\\uBE29-\\uBE43\\uBE45-\\uBE5F\\uBE61-\\uBE7B\\uBE7D-\\uBE97\\uBE99-\\uBEB3\\uBEB5-\\uBECF\\uBED1-\\uBEEB\\uBEED-\\uBF07\\uBF09-\\uBF23\\uBF25-\\uBF3F\\uBF41-\\uBF5B\\uBF5D-\\uBF77\\uBF79-\\uBF93\\uBF95-\\uBFAF\\uBFB1-\\uBFCB\\uBFCD-\\uBFE7\\uBFE9-\\uC003\\uC005-\\uC01F\\uC021-\\uC03B\\uC03D-\\uC057\\uC059-\\uC073\\uC075-\\uC08F\\uC091-\\uC0AB\\uC0AD-\\uC0C7\\uC0C9-\\uC0E3\\uC0E5-\\uC0FF\\uC101-\\uC11B\\uC11D-\\uC137\\uC139-\\uC153\\uC155-\\uC16F\\uC171-\\uC18B\\uC18D-\\uC1A7\\uC1A9-\\uC1C3\\uC1C5-\\uC1DF\\uC1E1-\\uC1FB\\uC1FD-\\uC217\\uC219-\\uC233\\uC235-\\uC24F\\uC251-\\uC26B\\uC26D-\\uC287\\uC289-\\uC2A3\\uC2A5-\\uC2BF\\uC2C1-\\uC2DB\\uC2DD-\\uC2F7\\uC2F9-\\uC313\\uC315-\\uC32F\\uC331-\\uC34B\\uC34D-\\uC367\\uC369-\\uC383\\uC385-\\uC39F\\uC3A1-\\uC3BB\\uC3BD-\\uC3D7\\uC3D9-\\uC3F3\\uC3F5-\\uC40F\\uC411-\\uC42B\\uC42D-\\uC447\\uC449-\\uC463\\uC465-\\uC47F\\uC481-\\uC49B\\uC49D-\\uC4B7\\uC4B9-\\uC4D3\\uC4D5-\\uC4EF\\uC4F1-\\uC50B\\uC50D-\\uC527\\uC529-\\uC543\\uC545-\\uC55F\\uC561-\\uC57B\\uC57D-\\uC597\\uC599-\\uC5B3\\uC5B5-\\uC5CF\\uC5D1-\\uC5EB\\uC5ED-\\uC607\\uC609-\\uC623\\uC625-\\uC63F\\uC641-\\uC65B\\uC65D-\\uC677\\uC679-\\uC693\\uC695-\\uC6AF\\uC6B1-\\uC6CB\\uC6CD-\\uC6E7\\uC6E9-\\uC703\\uC705-\\uC71F\\uC721-\\uC73B\\uC73D-\\uC757\\uC759-\\uC773\\uC775-\\uC78F\\uC791-\\uC7AB\\uC7AD-\\uC7C7\\uC7C9-\\uC7E3\\uC7E5-\\uC7FF\\uC801-\\uC81B\\uC81D-\\uC837\\uC839-\\uC853\\uC855-\\uC86F\\uC871-\\uC88B\\uC88D-\\uC8A7\\uC8A9-\\uC8C3\\uC8C5-\\uC8DF\\uC8E1-\\uC8FB\\uC8FD-\\uC917\\uC919-\\uC933\\uC935-\\uC94F\\uC951-\\uC96B\\uC96D-\\uC987\\uC989-\\uC9A3\\uC9A5-\\uC9BF\\uC9C1-\\uC9DB\\uC9DD-\\uC9F7\\uC9F9-\\uCA13\\uCA15-\\uCA2F\\uCA31-\\uCA4B\\uCA4D-\\uCA67\\uCA69-\\uCA83\\uCA85-\\uCA9F\\uCAA1-\\uCABB\\uCABD-\\uCAD7\\uCAD9-\\uCAF3\\uCAF5-\\uCB0F\\uCB11-\\uCB2B\\uCB2D-\\uCB47\\uCB49-\\uCB63\\uCB65-\\uCB7F\\uCB81-\\uCB9B\\uCB9D-\\uCBB7\\uCBB9-\\uCBD3\\uCBD5-\\uCBEF\\uCBF1-\\uCC0B\\uCC0D-\\uCC27\\uCC29-\\uCC43\\uCC45-\\uCC5F\\uCC61-\\uCC7B\\uCC7D-\\uCC97\\uCC99-\\uCCB3\\uCCB5-\\uCCCF\\uCCD1-\\uCCEB\\uCCED-\\uCD07\\uCD09-\\uCD23\\uCD25-\\uCD3F\\uCD41-\\uCD5B\\uCD5D-\\uCD77\\uCD79-\\uCD93\\uCD95-\\uCDAF\\uCDB1-\\uCDCB\\uCDCD-\\uCDE7\\uCDE9-\\uCE03\\uCE05-\\uCE1F\\uCE21-\\uCE3B\\uCE3D-\\uCE57\\uCE59-\\uCE73\\uCE75-\\uCE8F\\uCE91-\\uCEAB\\uCEAD-\\uCEC7\\uCEC9-\\uCEE3\\uCEE5-\\uCEFF\\uCF01-\\uCF1B\\uCF1D-\\uCF37\\uCF39-\\uCF53\\uCF55-\\uCF6F\\uCF71-\\uCF8B\\uCF8D-\\uCFA7\\uCFA9-\\uCFC3\\uCFC5-\\uCFDF\\uCFE1-\\uCFFB\\uCFFD-\\uD017\\uD019-\\uD033\\uD035-\\uD04F\\uD051-\\uD06B\\uD06D-\\uD087\\uD089-\\uD0A3\\uD0A5-\\uD0BF\\uD0C1-\\uD0DB\\uD0DD-\\uD0F7\\uD0F9-\\uD113\\uD115-\\uD12F\\uD131-\\uD14B\\uD14D-\\uD167\\uD169-\\uD183\\uD185-\\uD19F\\uD1A1-\\uD1BB\\uD1BD-\\uD1D7\\uD1D9-\\uD1F3\\uD1F5-\\uD20F\\uD211-\\uD22B\\uD22D-\\uD247\\uD249-\\uD263\\uD265-\\uD27F\\uD281-\\uD29B\\uD29D-\\uD2B7\\uD2B9-\\uD2D3\\uD2D5-\\uD2EF\\uD2F1-\\uD30B\\uD30D-\\uD327\\uD329-\\uD343\\uD345-\\uD35F\\uD361-\\uD37B\\uD37D-\\uD397\\uD399-\\uD3B3\\uD3B5-\\uD3CF\\uD3D1-\\uD3EB\\uD3ED-\\uD407\\uD409-\\uD423\\uD425-\\uD43F\\uD441-\\uD45B\\uD45D-\\uD477\\uD479-\\uD493\\uD495-\\uD4AF\\uD4B1-\\uD4CB\\uD4CD-\\uD4E7\\uD4E9-\\uD503\\uD505-\\uD51F\\uD521-\\uD53B\\uD53D-\\uD557\\uD559-\\uD573\\uD575-\\uD58F\\uD591-\\uD5AB\\uD5AD-\\uD5C7\\uD5C9-\\uD5E3\\uD5E5-\\uD5FF\\uD601-\\uD61B\\uD61D-\\uD637\\uD639-\\uD653\\uD655-\\uD66F\\uD671-\\uD68B\\uD68D-\\uD6A7\\uD6A9-\\uD6C3\\uD6C5-\\uD6DF\\uD6E1-\\uD6FB\\uD6FD-\\uD717\\uD719-\\uD733\\uD735-\\uD74F\\uD751-\\uD76B\\uD76D-\\uD787\\uD789-\\uD7A3]$/;\nvar reExtPict = /^(?:[\\xA9\\xAE\\u203C\\u2049\\u2122\\u2139\\u2194-\\u2199\\u21A9\\u21AA\\u231A\\u231B\\u2328\\u2388\\u23CF\\u23E9-\\u23F3\\u23F8-\\u23FA\\u24C2\\u25AA\\u25AB\\u25B6\\u25C0\\u25FB-\\u25FE\\u2600-\\u2605\\u2607-\\u2612\\u2614-\\u2685\\u2690-\\u2705\\u2708-\\u2712\\u2714\\u2716\\u271D\\u2721\\u2728\\u2733\\u2734\\u2744\\u2747\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2763-\\u2767\\u2795-\\u2797\\u27A1\\u27B0\\u27BF\\u2934\\u2935\\u2B05-\\u2B07\\u2B1B\\u2B1C\\u2B50\\u2B55\\u3030\\u303D\\u3297\\u3299]|\\uD83C[\\uDC00-\\uDCFF\\uDD0D-\\uDD0F\\uDD2F\\uDD6C-\\uDD71\\uDD7E\\uDD7F\\uDD8E\\uDD91-\\uDD9A\\uDDAD-\\uDDE5\\uDE01-\\uDE0F\\uDE1A\\uDE2F\\uDE32-\\uDE3A\\uDE3C-\\uDE3F\\uDE49-\\uDFFA]|\\uD83D[\\uDC00-\\uDD3D\\uDD46-\\uDE4F\\uDE80-\\uDEFF\\uDF74-\\uDF7F\\uDFD5-\\uDFFF]|\\uD83E[\\uDC0C-\\uDC0F\\uDC48-\\uDC4F\\uDC5A-\\uDC5F\\uDC88-\\uDC8F\\uDCAE-\\uDCFF\\uDD0C-\\uDD3A\\uDD3C-\\uDD45\\uDD47-\\uDEFF]|\\uD83F[\\uDC00-\\uDFFD])$/;\n\nvar getCodepointType = (char, code) => {\n  var type = CodepointType.Any;\n\n  if (char.search(reExtend) !== -1) {\n    type |= CodepointType.Extend;\n  }\n\n  if (code === 0x200d) {\n    type |= CodepointType.ZWJ;\n  }\n\n  if (code >= 0x1f1e6 && code <= 0x1f1ff) {\n    type |= CodepointType.RI;\n  }\n\n  if (char.search(rePrepend) !== -1) {\n    type |= CodepointType.Prepend;\n  }\n\n  if (char.search(reSpacingMark) !== -1) {\n    type |= CodepointType.SpacingMark;\n  }\n\n  if (char.search(reL) !== -1) {\n    type |= CodepointType.L;\n  }\n\n  if (char.search(reV) !== -1) {\n    type |= CodepointType.V;\n  }\n\n  if (char.search(reT) !== -1) {\n    type |= CodepointType.T;\n  }\n\n  if (char.search(reLV) !== -1) {\n    type |= CodepointType.LV;\n  }\n\n  if (char.search(reLVT) !== -1) {\n    type |= CodepointType.LVT;\n  }\n\n  if (char.search(reExtPict) !== -1) {\n    type |= CodepointType.ExtPict;\n  }\n\n  return type;\n};\n\nfunction intersects(x, y) {\n  return (x & y) !== 0;\n}\n\nvar NonBoundaryPairs = [// GB6\n[CodepointType.L, CodepointType.L | CodepointType.V | CodepointType.LV | CodepointType.LVT], // GB7\n[CodepointType.LV | CodepointType.V, CodepointType.V | CodepointType.T], // GB8\n[CodepointType.LVT | CodepointType.T, CodepointType.T], // GB9\n[CodepointType.Any, CodepointType.Extend | CodepointType.ZWJ], // GB9a\n[CodepointType.Any, CodepointType.SpacingMark], // GB9b\n[CodepointType.Prepend, CodepointType.Any], // GB11\n[CodepointType.ZWJ, CodepointType.ExtPict], // GB12 and GB13\n[CodepointType.RI, CodepointType.RI]];\n\nfunction isBoundaryPair(left, right) {\n  return NonBoundaryPairs.findIndex(r => intersects(left, r[0]) && intersects(right, r[1])) === -1;\n}\n\nvar endingEmojiZWJ = /(?:[\\xA9\\xAE\\u203C\\u2049\\u2122\\u2139\\u2194-\\u2199\\u21A9\\u21AA\\u231A\\u231B\\u2328\\u2388\\u23CF\\u23E9-\\u23F3\\u23F8-\\u23FA\\u24C2\\u25AA\\u25AB\\u25B6\\u25C0\\u25FB-\\u25FE\\u2600-\\u2605\\u2607-\\u2612\\u2614-\\u2685\\u2690-\\u2705\\u2708-\\u2712\\u2714\\u2716\\u271D\\u2721\\u2728\\u2733\\u2734\\u2744\\u2747\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2763-\\u2767\\u2795-\\u2797\\u27A1\\u27B0\\u27BF\\u2934\\u2935\\u2B05-\\u2B07\\u2B1B\\u2B1C\\u2B50\\u2B55\\u3030\\u303D\\u3297\\u3299]|\\uD83C[\\uDC00-\\uDCFF\\uDD0D-\\uDD0F\\uDD2F\\uDD6C-\\uDD71\\uDD7E\\uDD7F\\uDD8E\\uDD91-\\uDD9A\\uDDAD-\\uDDE5\\uDE01-\\uDE0F\\uDE1A\\uDE2F\\uDE32-\\uDE3A\\uDE3C-\\uDE3F\\uDE49-\\uDFFA]|\\uD83D[\\uDC00-\\uDD3D\\uDD46-\\uDE4F\\uDE80-\\uDEFF\\uDF74-\\uDF7F\\uDFD5-\\uDFFF]|\\uD83E[\\uDC0C-\\uDC0F\\uDC48-\\uDC4F\\uDC5A-\\uDC5F\\uDC88-\\uDC8F\\uDCAE-\\uDCFF\\uDD0C-\\uDD3A\\uDD3C-\\uDD45\\uDD47-\\uDEFF]|\\uD83F[\\uDC00-\\uDFFD])(?:[\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u07FD\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08D3-\\u08E1\\u08E3-\\u0902\\u093A\\u093C\\u0941-\\u0948\\u094D\\u0951-\\u0957\\u0962\\u0963\\u0981\\u09BC\\u09BE\\u09C1-\\u09C4\\u09CD\\u09D7\\u09E2\\u09E3\\u09FE\\u0A01\\u0A02\\u0A3C\\u0A41\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81\\u0A82\\u0ABC\\u0AC1-\\u0AC5\\u0AC7\\u0AC8\\u0ACD\\u0AE2\\u0AE3\\u0AFA-\\u0AFF\\u0B01\\u0B3C\\u0B3E\\u0B3F\\u0B41-\\u0B44\\u0B4D\\u0B55-\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE\\u0BC0\\u0BCD\\u0BD7\\u0C00\\u0C04\\u0C3E-\\u0C40\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81\\u0CBC\\u0CBF\\u0CC2\\u0CC6\\u0CCC\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D00\\u0D01\\u0D3B\\u0D3C\\u0D3E\\u0D41-\\u0D44\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D81\\u0DCA\\u0DCF\\u0DD2-\\u0DD4\\u0DD6\\u0DDF\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F71-\\u0F7E\\u0F80-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102D-\\u1030\\u1032-\\u1037\\u1039\\u103A\\u103D\\u103E\\u1058\\u1059\\u105E-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108D\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4\\u17B5\\u17B7-\\u17BD\\u17C6\\u17C9-\\u17D3\\u17DD\\u180B-\\u180D\\u1885\\u1886\\u18A9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193B\\u1A17\\u1A18\\u1A1B\\u1A56\\u1A58-\\u1A5E\\u1A60\\u1A62\\u1A65-\\u1A6C\\u1A73-\\u1A7C\\u1A7F\\u1AB0-\\u1AC0\\u1B00-\\u1B03\\u1B34-\\u1B3A\\u1B3C\\u1B42\\u1B6B-\\u1B73\\u1B80\\u1B81\\u1BA2-\\u1BA5\\u1BA8\\u1BA9\\u1BAB-\\u1BAD\\u1BE6\\u1BE8\\u1BE9\\u1BED\\u1BEF-\\u1BF1\\u1C2C-\\u1C33\\u1C36\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE0\\u1CE2-\\u1CE8\\u1CED\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF9\\u1DFB-\\u1DFF\\u200C\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69E\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA825\\uA826\\uA82C\\uA8C4\\uA8C5\\uA8E0-\\uA8F1\\uA8FF\\uA926-\\uA92D\\uA947-\\uA951\\uA980-\\uA982\\uA9B3\\uA9B6-\\uA9B9\\uA9BC\\uA9BD\\uA9E5\\uAA29-\\uAA2E\\uAA31\\uAA32\\uAA35\\uAA36\\uAA43\\uAA4C\\uAA7C\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEC\\uAAED\\uAAF6\\uABE5\\uABE8\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2F\\uFF9E\\uFF9F]|\\uD800[\\uDDFD\\uDEE0\\uDF76-\\uDF7A]|\\uD802[\\uDE01-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE0F\\uDE38-\\uDE3A\\uDE3F\\uDEE5\\uDEE6]|\\uD803[\\uDD24-\\uDD27\\uDEAB\\uDEAC\\uDF46-\\uDF50]|\\uD804[\\uDC01\\uDC38-\\uDC46\\uDC7F-\\uDC81\\uDCB3-\\uDCB6\\uDCB9\\uDCBA\\uDD00-\\uDD02\\uDD27-\\uDD2B\\uDD2D-\\uDD34\\uDD73\\uDD80\\uDD81\\uDDB6-\\uDDBE\\uDDC9-\\uDDCC\\uDDCF\\uDE2F-\\uDE31\\uDE34\\uDE36\\uDE37\\uDE3E\\uDEDF\\uDEE3-\\uDEEA\\uDF00\\uDF01\\uDF3B\\uDF3C\\uDF3E\\uDF40\\uDF57\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC38-\\uDC3F\\uDC42-\\uDC44\\uDC46\\uDC5E\\uDCB0\\uDCB3-\\uDCB8\\uDCBA\\uDCBD\\uDCBF\\uDCC0\\uDCC2\\uDCC3\\uDDAF\\uDDB2-\\uDDB5\\uDDBC\\uDDBD\\uDDBF\\uDDC0\\uDDDC\\uDDDD\\uDE33-\\uDE3A\\uDE3D\\uDE3F\\uDE40\\uDEAB\\uDEAD\\uDEB0-\\uDEB5\\uDEB7\\uDF1D-\\uDF1F\\uDF22-\\uDF25\\uDF27-\\uDF2B]|\\uD806[\\uDC2F-\\uDC37\\uDC39\\uDC3A\\uDD30\\uDD3B\\uDD3C\\uDD3E\\uDD43\\uDDD4-\\uDDD7\\uDDDA\\uDDDB\\uDDE0\\uDE01-\\uDE0A\\uDE33-\\uDE38\\uDE3B-\\uDE3E\\uDE47\\uDE51-\\uDE56\\uDE59-\\uDE5B\\uDE8A-\\uDE96\\uDE98\\uDE99]|\\uD807[\\uDC30-\\uDC36\\uDC38-\\uDC3D\\uDC3F\\uDC92-\\uDCA7\\uDCAA-\\uDCB0\\uDCB2\\uDCB3\\uDCB5\\uDCB6\\uDD31-\\uDD36\\uDD3A\\uDD3C\\uDD3D\\uDD3F-\\uDD45\\uDD47\\uDD90\\uDD91\\uDD95\\uDD97\\uDEF3\\uDEF4]|\\uD81A[\\uDEF0-\\uDEF4\\uDF30-\\uDF36]|\\uD81B[\\uDF4F\\uDF8F-\\uDF92\\uDFE4]|\\uD82F[\\uDC9D\\uDC9E]|\\uD834[\\uDD65\\uDD67-\\uDD69\\uDD6E-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44]|\\uD836[\\uDE00-\\uDE36\\uDE3B-\\uDE6C\\uDE75\\uDE84\\uDE9B-\\uDE9F\\uDEA1-\\uDEAF]|\\uD838[\\uDC00-\\uDC06\\uDC08-\\uDC18\\uDC1B-\\uDC21\\uDC23\\uDC24\\uDC26-\\uDC2A\\uDD30-\\uDD36\\uDEEC-\\uDEEF]|\\uD83A[\\uDCD0-\\uDCD6\\uDD44-\\uDD4A]|\\uD83C[\\uDFFB-\\uDFFF]|\\uDB40[\\uDC20-\\uDC7F\\uDD00-\\uDDEF])*\\u200D$/;\n\nvar endsWithEmojiZWJ = str => {\n  return str.search(endingEmojiZWJ) !== -1;\n};\n\nvar endingRIs = /(?:\\uD83C[\\uDDE6-\\uDDFF])+$/g;\n\nvar endsWithOddNumberOfRIs = str => {\n  var match = str.match(endingRIs);\n\n  if (match === null) {\n    return false;\n  } else {\n    // A RI is represented by a surrogate pair.\n    var numRIs = match[0].length / 2;\n    return numRIs % 2 === 1;\n  }\n};\n\n/**\r\n * Shared the function with isElementType utility\r\n */\n\nvar isElement = value => {\n  return isPlainObject(value) && Node.isNodeList(value.children) && !Editor.isEditor(value);\n};\n\nvar Element = {\n  /**\r\n   * Check if a value implements the 'Ancestor' interface.\r\n   */\n  isAncestor(value) {\n    return isPlainObject(value) && Node.isNodeList(value.children);\n  },\n\n  /**\r\n   * Check if a value implements the `Element` interface.\r\n   */\n  isElement,\n\n  /**\r\n   * Check if a value is an array of `Element` objects.\r\n   */\n  isElementList(value) {\n    return Array.isArray(value) && value.every(val => Element.isElement(val));\n  },\n\n  /**\r\n   * Check if a set of props is a partial of Element.\r\n   */\n  isElementProps(props) {\n    return props.children !== undefined;\n  },\n\n  /**\r\n   * Check if a value implements the `Element` interface and has elementKey with selected value.\r\n   * Default it check to `type` key value\r\n   */\n  isElementType: function isElementType(value, elementVal) {\n    var elementKey = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'type';\n    return isElement(value) && value[elementKey] === elementVal;\n  },\n\n  /**\r\n   * Check if an element matches set of properties.\r\n   *\r\n   * Note: this checks custom properties, and it does not ensure that any\r\n   * children are equivalent.\r\n   */\n  matches(element, props) {\n    for (var key in props) {\n      if (key === 'children') {\n        continue;\n      }\n\n      if (element[key] !== props[key]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n};\n\nvar _excluded$4 = [\"text\"],\n    _excluded2$3 = [\"text\"];\n\nfunction ownKeys$8(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$8(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$8(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$8(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar IS_EDITOR_CACHE = new WeakMap();\nvar Editor = {\n  /**\r\n   * Get the ancestor above a location in the document.\r\n   */\n  above(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      voids = false,\n      mode = 'lowest',\n      at = editor.selection,\n      match\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var path = Editor.path(editor, at);\n    var reverse = mode === 'lowest';\n\n    for (var [n, p] of Editor.levels(editor, {\n      at: path,\n      voids,\n      match,\n      reverse\n    })) {\n      if (!Text.isText(n) && !Path.equals(path, p)) {\n        return [n, p];\n      }\n    }\n  },\n\n  /**\r\n   * Add a custom property to the leaf text nodes in the current selection.\r\n   *\r\n   * If the selection is currently collapsed, the marks will be added to the\r\n   * `editor.marks` property instead, and applied when text is inserted next.\r\n   */\n  addMark(editor, key, value) {\n    editor.addMark(key, value);\n  },\n\n  /**\r\n   * Get the point after a location.\r\n   */\n  after(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var anchor = Editor.point(editor, at, {\n      edge: 'end'\n    });\n    var focus = Editor.end(editor, []);\n    var range = {\n      anchor,\n      focus\n    };\n    var {\n      distance = 1\n    } = options;\n    var d = 0;\n    var target;\n\n    for (var p of Editor.positions(editor, _objectSpread$8(_objectSpread$8({}, options), {}, {\n      at: range\n    }))) {\n      if (d > distance) {\n        break;\n      }\n\n      if (d !== 0) {\n        target = p;\n      }\n\n      d++;\n    }\n\n    return target;\n  },\n\n  /**\r\n   * Get the point before a location.\r\n   */\n  before(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var anchor = Editor.start(editor, []);\n    var focus = Editor.point(editor, at, {\n      edge: 'start'\n    });\n    var range = {\n      anchor,\n      focus\n    };\n    var {\n      distance = 1\n    } = options;\n    var d = 0;\n    var target;\n\n    for (var p of Editor.positions(editor, _objectSpread$8(_objectSpread$8({}, options), {}, {\n      at: range,\n      reverse: true\n    }))) {\n      if (d > distance) {\n        break;\n      }\n\n      if (d !== 0) {\n        target = p;\n      }\n\n      d++;\n    }\n\n    return target;\n  },\n\n  /**\r\n   * Delete content in the editor backward from the current selection.\r\n   */\n  deleteBackward(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      unit = 'character'\n    } = options;\n    editor.deleteBackward(unit);\n  },\n\n  /**\r\n   * Delete content in the editor forward from the current selection.\r\n   */\n  deleteForward(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      unit = 'character'\n    } = options;\n    editor.deleteForward(unit);\n  },\n\n  /**\r\n   * Delete the content in the current selection.\r\n   */\n  deleteFragment(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      direction = 'forward'\n    } = options;\n    editor.deleteFragment(direction);\n  },\n\n  /**\r\n   * Get the start and end points of a location.\r\n   */\n  edges(editor, at) {\n    return [Editor.start(editor, at), Editor.end(editor, at)];\n  },\n\n  /**\r\n   * Get the end point of a location.\r\n   */\n  end(editor, at) {\n    return Editor.point(editor, at, {\n      edge: 'end'\n    });\n  },\n\n  /**\r\n   * Get the first node at a location.\r\n   */\n  first(editor, at) {\n    var path = Editor.path(editor, at, {\n      edge: 'start'\n    });\n    return Editor.node(editor, path);\n  },\n\n  /**\r\n   * Get the fragment at a location.\r\n   */\n  fragment(editor, at) {\n    var range = Editor.range(editor, at);\n    var fragment = Node.fragment(editor, range);\n    return fragment;\n  },\n\n  /**\r\n   * Check if a node has block children.\r\n   */\n  hasBlocks(editor, element) {\n    return element.children.some(n => Editor.isBlock(editor, n));\n  },\n\n  /**\r\n   * Check if a node has inline and text children.\r\n   */\n  hasInlines(editor, element) {\n    return element.children.some(n => Text.isText(n) || Editor.isInline(editor, n));\n  },\n\n  /**\r\n   * Check if a node has text children.\r\n   */\n  hasTexts(editor, element) {\n    return element.children.every(n => Text.isText(n));\n  },\n\n  /**\r\n   * Insert a block break at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertBreak(editor) {\n    editor.insertBreak();\n  },\n\n  /**\r\n   * Insert a fragment at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertFragment(editor, fragment) {\n    editor.insertFragment(fragment);\n  },\n\n  /**\r\n   * Insert a node at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertNode(editor, node) {\n    editor.insertNode(node);\n  },\n\n  /**\r\n   * Insert text at the current selection.\r\n   *\r\n   * If the selection is currently expanded, it will be deleted first.\r\n   */\n  insertText(editor, text) {\n    editor.insertText(text);\n  },\n\n  /**\r\n   * Check if a value is a block `Element` object.\r\n   */\n  isBlock(editor, value) {\n    return Element.isElement(value) && !editor.isInline(value);\n  },\n\n  /**\r\n   * Check if a value is an `Editor` object.\r\n   */\n  isEditor(value) {\n    if (!isPlainObject(value)) return false;\n    var cachedIsEditor = IS_EDITOR_CACHE.get(value);\n\n    if (cachedIsEditor !== undefined) {\n      return cachedIsEditor;\n    }\n\n    var isEditor = typeof value.addMark === 'function' && typeof value.apply === 'function' && typeof value.deleteBackward === 'function' && typeof value.deleteForward === 'function' && typeof value.deleteFragment === 'function' && typeof value.insertBreak === 'function' && typeof value.insertFragment === 'function' && typeof value.insertNode === 'function' && typeof value.insertText === 'function' && typeof value.isInline === 'function' && typeof value.isVoid === 'function' && typeof value.normalizeNode === 'function' && typeof value.onChange === 'function' && typeof value.removeMark === 'function' && (value.marks === null || isPlainObject(value.marks)) && (value.selection === null || Range.isRange(value.selection)) && Node.isNodeList(value.children) && Operation.isOperationList(value.operations);\n    IS_EDITOR_CACHE.set(value, isEditor);\n    return isEditor;\n  },\n\n  /**\r\n   * Check if a point is the end point of a location.\r\n   */\n  isEnd(editor, point, at) {\n    var end = Editor.end(editor, at);\n    return Point.equals(point, end);\n  },\n\n  /**\r\n   * Check if a point is an edge of a location.\r\n   */\n  isEdge(editor, point, at) {\n    return Editor.isStart(editor, point, at) || Editor.isEnd(editor, point, at);\n  },\n\n  /**\r\n   * Check if an element is empty, accounting for void nodes.\r\n   */\n  isEmpty(editor, element) {\n    var {\n      children\n    } = element;\n    var [first] = children;\n    return children.length === 0 || children.length === 1 && Text.isText(first) && first.text === '' && !editor.isVoid(element);\n  },\n\n  /**\r\n   * Check if a value is an inline `Element` object.\r\n   */\n  isInline(editor, value) {\n    return Element.isElement(value) && editor.isInline(value);\n  },\n\n  /**\r\n   * Check if the editor is currently normalizing after each operation.\r\n   */\n  isNormalizing(editor) {\n    var isNormalizing = NORMALIZING.get(editor);\n    return isNormalizing === undefined ? true : isNormalizing;\n  },\n\n  /**\r\n   * Check if a point is the start point of a location.\r\n   */\n  isStart(editor, point, at) {\n    // PERF: If the offset isn't `0` we know it's not the start.\n    if (point.offset !== 0) {\n      return false;\n    }\n\n    var start = Editor.start(editor, at);\n    return Point.equals(point, start);\n  },\n\n  /**\r\n   * Check if a value is a void `Element` object.\r\n   */\n  isVoid(editor, value) {\n    return Element.isElement(value) && editor.isVoid(value);\n  },\n\n  /**\r\n   * Get the last node at a location.\r\n   */\n  last(editor, at) {\n    var path = Editor.path(editor, at, {\n      edge: 'end'\n    });\n    return Editor.node(editor, path);\n  },\n\n  /**\r\n   * Get the leaf text node at a location.\r\n   */\n  leaf(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var node = Node.leaf(editor, path);\n    return [node, path];\n  },\n\n  /**\r\n   * Iterate through all of the levels at a location.\r\n   */\n  *levels(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      reverse = false,\n      voids = false\n    } = options;\n    var {\n      match\n    } = options;\n\n    if (match == null) {\n      match = () => true;\n    }\n\n    if (!at) {\n      return;\n    }\n\n    var levels = [];\n    var path = Editor.path(editor, at);\n\n    for (var [n, p] of Node.levels(editor, path)) {\n      if (!match(n, p)) {\n        continue;\n      }\n\n      levels.push([n, p]);\n\n      if (!voids && Editor.isVoid(editor, n)) {\n        break;\n      }\n    }\n\n    if (reverse) {\n      levels.reverse();\n    }\n\n    yield* levels;\n  },\n\n  /**\r\n   * Get the marks that would be added to text at the current selection.\r\n   */\n  marks(editor) {\n    var {\n      marks,\n      selection\n    } = editor;\n\n    if (!selection) {\n      return null;\n    }\n\n    if (marks) {\n      return marks;\n    }\n\n    if (Range.isExpanded(selection)) {\n      var [match] = Editor.nodes(editor, {\n        match: Text.isText\n      });\n\n      if (match) {\n        var [_node] = match;\n\n        var _rest = _objectWithoutProperties(_node, _excluded$4);\n\n        return _rest;\n      } else {\n        return {};\n      }\n    }\n\n    var {\n      anchor\n    } = selection;\n    var {\n      path\n    } = anchor;\n    var [node] = Editor.leaf(editor, path);\n\n    if (anchor.offset === 0) {\n      var prev = Editor.previous(editor, {\n        at: path,\n        match: Text.isText\n      });\n      var block = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n)\n      });\n\n      if (prev && block) {\n        var [prevNode, prevPath] = prev;\n        var [, blockPath] = block;\n\n        if (Path.isAncestor(blockPath, prevPath)) {\n          node = prevNode;\n        }\n      }\n    }\n\n    var rest = _objectWithoutProperties(node, _excluded2$3);\n\n    return rest;\n  },\n\n  /**\r\n   * Get the matching node in the branch of the document after a location.\r\n   */\n  next(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      mode = 'lowest',\n      voids = false\n    } = options;\n    var {\n      match,\n      at = editor.selection\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var pointAfterLocation = Editor.after(editor, at, {\n      voids\n    });\n    if (!pointAfterLocation) return;\n    var [, to] = Editor.last(editor, []);\n    var span = [pointAfterLocation.path, to];\n\n    if (Path.isPath(at) && at.length === 0) {\n      throw new Error(\"Cannot get the next node from the root node!\");\n    }\n\n    if (match == null) {\n      if (Path.isPath(at)) {\n        var [parent] = Editor.parent(editor, at);\n\n        match = n => parent.children.includes(n);\n      } else {\n        match = () => true;\n      }\n    }\n\n    var [next] = Editor.nodes(editor, {\n      at: span,\n      match,\n      mode,\n      voids\n    });\n    return next;\n  },\n\n  /**\r\n   * Get the node at a location.\r\n   */\n  node(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var node = Node.get(editor, path);\n    return [node, path];\n  },\n\n  /**\r\n   * Iterate through all of the nodes in the Editor.\r\n   */\n  *nodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      mode = 'all',\n      universal = false,\n      reverse = false,\n      voids = false\n    } = options;\n    var {\n      match\n    } = options;\n\n    if (!match) {\n      match = () => true;\n    }\n\n    if (!at) {\n      return;\n    }\n\n    var from;\n    var to;\n\n    if (Span.isSpan(at)) {\n      from = at[0];\n      to = at[1];\n    } else {\n      var first = Editor.path(editor, at, {\n        edge: 'start'\n      });\n      var last = Editor.path(editor, at, {\n        edge: 'end'\n      });\n      from = reverse ? last : first;\n      to = reverse ? first : last;\n    }\n\n    var nodeEntries = Node.nodes(editor, {\n      reverse,\n      from,\n      to,\n      pass: _ref => {\n        var [n] = _ref;\n        return voids ? false : Editor.isVoid(editor, n);\n      }\n    });\n    var matches = [];\n    var hit;\n\n    for (var [node, path] of nodeEntries) {\n      var isLower = hit && Path.compare(path, hit[1]) === 0; // In highest mode any node lower than the last hit is not a match.\n\n      if (mode === 'highest' && isLower) {\n        continue;\n      }\n\n      if (!match(node, path)) {\n        // If we've arrived at a leaf text node that is not lower than the last\n        // hit, then we've found a branch that doesn't include a match, which\n        // means the match is not universal.\n        if (universal && !isLower && Text.isText(node)) {\n          return;\n        } else {\n          continue;\n        }\n      } // If there's a match and it's lower than the last, update the hit.\n\n\n      if (mode === 'lowest' && isLower) {\n        hit = [node, path];\n        continue;\n      } // In lowest mode we emit the last hit, once it's guaranteed lowest.\n\n\n      var emit = mode === 'lowest' ? hit : [node, path];\n\n      if (emit) {\n        if (universal) {\n          matches.push(emit);\n        } else {\n          yield emit;\n        }\n      }\n\n      hit = [node, path];\n    } // Since lowest is always emitting one behind, catch up at the end.\n\n\n    if (mode === 'lowest' && hit) {\n      if (universal) {\n        matches.push(hit);\n      } else {\n        yield hit;\n      }\n    } // Universal defers to ensure that the match occurs in every branch, so we\n    // yield all of the matches after iterating.\n\n\n    if (universal) {\n      yield* matches;\n    }\n  },\n\n  /**\r\n   * Normalize any dirty objects in the editor.\r\n   */\n  normalize(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      force = false\n    } = options;\n\n    var getDirtyPaths = editor => {\n      return DIRTY_PATHS.get(editor) || [];\n    };\n\n    var getDirtyPathKeys = editor => {\n      return DIRTY_PATH_KEYS.get(editor) || new Set();\n    };\n\n    var popDirtyPath = editor => {\n      var path = getDirtyPaths(editor).pop();\n      var key = path.join(',');\n      getDirtyPathKeys(editor).delete(key);\n      return path;\n    };\n\n    if (!Editor.isNormalizing(editor)) {\n      return;\n    }\n\n    if (force) {\n      var allPaths = Array.from(Node.nodes(editor), _ref2 => {\n        var [, p] = _ref2;\n        return p;\n      });\n      var allPathKeys = new Set(allPaths.map(p => p.join(',')));\n      DIRTY_PATHS.set(editor, allPaths);\n      DIRTY_PATH_KEYS.set(editor, allPathKeys);\n    }\n\n    if (getDirtyPaths(editor).length === 0) {\n      return;\n    }\n\n    Editor.withoutNormalizing(editor, () => {\n      /*\r\n        Fix dirty elements with no children.\r\n        editor.normalizeNode() does fix this, but some normalization fixes also require it to work.\r\n        Running an initial pass avoids the catch-22 race condition.\r\n      */\n      for (var dirtyPath of getDirtyPaths(editor)) {\n        if (Node.has(editor, dirtyPath)) {\n          var entry = Editor.node(editor, dirtyPath);\n          var [node, _] = entry;\n          /*\r\n            The default normalizer inserts an empty text node in this scenario, but it can be customised.\r\n            So there is some risk here.\r\n                       As long as the normalizer only inserts child nodes for this case it is safe to do in any order;\r\n            by definition adding children to an empty node can't cause other paths to change.\r\n          */\n\n          if (Element.isElement(node) && node.children.length === 0) {\n            editor.normalizeNode(entry);\n          }\n        }\n      }\n\n      var max = getDirtyPaths(editor).length * 42; // HACK: better way?\n\n      var m = 0;\n\n      while (getDirtyPaths(editor).length !== 0) {\n        if (m > max) {\n          throw new Error(\"\\n            Could not completely normalize the editor after \".concat(max, \" iterations! This is usually due to incorrect normalization logic that leaves a node in an invalid state.\\n          \"));\n        }\n\n        var _dirtyPath = popDirtyPath(editor); // If the node doesn't exist in the tree, it does not need to be normalized.\n\n\n        if (Node.has(editor, _dirtyPath)) {\n          var _entry = Editor.node(editor, _dirtyPath);\n\n          editor.normalizeNode(_entry);\n        }\n\n        m++;\n      }\n    });\n  },\n\n  /**\r\n   * Get the parent node of a location.\r\n   */\n  parent(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var path = Editor.path(editor, at, options);\n    var parentPath = Path.parent(path);\n    var entry = Editor.node(editor, parentPath);\n    return entry;\n  },\n\n  /**\r\n   * Get the path of a location.\r\n   */\n  path(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      depth,\n      edge\n    } = options;\n\n    if (Path.isPath(at)) {\n      if (edge === 'start') {\n        var [, firstPath] = Node.first(editor, at);\n        at = firstPath;\n      } else if (edge === 'end') {\n        var [, lastPath] = Node.last(editor, at);\n        at = lastPath;\n      }\n    }\n\n    if (Range.isRange(at)) {\n      if (edge === 'start') {\n        at = Range.start(at);\n      } else if (edge === 'end') {\n        at = Range.end(at);\n      } else {\n        at = Path.common(at.anchor.path, at.focus.path);\n      }\n    }\n\n    if (Point.isPoint(at)) {\n      at = at.path;\n    }\n\n    if (depth != null) {\n      at = at.slice(0, depth);\n    }\n\n    return at;\n  },\n\n  hasPath(editor, path) {\n    return Node.has(editor, path);\n  },\n\n  /**\r\n   * Create a mutable ref for a `Path` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  pathRef(editor, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: path,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var pathRefs = Editor.pathRefs(editor);\n        pathRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.pathRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked path refs of the editor.\r\n   */\n  pathRefs(editor) {\n    var refs = PATH_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      PATH_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Get the start or end point of a location.\r\n   */\n  point(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      edge = 'start'\n    } = options;\n\n    if (Path.isPath(at)) {\n      var path;\n\n      if (edge === 'end') {\n        var [, lastPath] = Node.last(editor, at);\n        path = lastPath;\n      } else {\n        var [, firstPath] = Node.first(editor, at);\n        path = firstPath;\n      }\n\n      var node = Node.get(editor, path);\n\n      if (!Text.isText(node)) {\n        throw new Error(\"Cannot get the \".concat(edge, \" point in the node at path [\").concat(at, \"] because it has no \").concat(edge, \" text node.\"));\n      }\n\n      return {\n        path,\n        offset: edge === 'end' ? node.text.length : 0\n      };\n    }\n\n    if (Range.isRange(at)) {\n      var [start, end] = Range.edges(at);\n      return edge === 'start' ? start : end;\n    }\n\n    return at;\n  },\n\n  /**\r\n   * Create a mutable ref for a `Point` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  pointRef(editor, point) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: point,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var pointRefs = Editor.pointRefs(editor);\n        pointRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.pointRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked point refs of the editor.\r\n   */\n  pointRefs(editor) {\n    var refs = POINT_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      POINT_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Return all the positions in `at` range where a `Point` can be placed.\r\n   *\r\n   * By default, moves forward by individual offsets at a time, but\r\n   * the `unit` option can be used to to move by character, word, line, or block.\r\n   *\r\n   * The `reverse` option can be used to change iteration direction.\r\n   *\r\n   * Note: By default void nodes are treated as a single point and iteration\r\n   * will not happen inside their content unless you pass in true for the\r\n   * `voids` option, then iteration will occur.\r\n   */\n  *positions(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      at = editor.selection,\n      unit = 'offset',\n      reverse = false,\n      voids = false\n    } = options;\n\n    if (!at) {\n      return;\n    }\n    /**\r\n     * Algorithm notes:\r\n     *\r\n     * Each step `distance` is dynamic depending on the underlying text\r\n     * and the `unit` specified.  Each step, e.g., a line or word, may\r\n     * span multiple text nodes, so we iterate through the text both on\r\n     * two levels in step-sync:\r\n     *\r\n     * `leafText` stores the text on a text leaf level, and is advanced\r\n     * through using the counters `leafTextOffset` and `leafTextRemaining`.\r\n     *\r\n     * `blockText` stores the text on a block level, and is shortened\r\n     * by `distance` every time it is advanced.\r\n     *\r\n     * We only maintain a window of one blockText and one leafText because\r\n     * a block node always appears before all of its leaf nodes.\r\n     */\n\n\n    var range = Editor.range(editor, at);\n    var [start, end] = Range.edges(range);\n    var first = reverse ? end : start;\n    var isNewBlock = false;\n    var blockText = '';\n    var distance = 0; // Distance for leafText to catch up to blockText.\n\n    var leafTextRemaining = 0;\n    var leafTextOffset = 0; // Iterate through all nodes in range, grabbing entire textual content\n    // of block nodes in blockText, and text nodes in leafText.\n    // Exploits the fact that nodes are sequenced in such a way that we first\n    // encounter the block node, then all of its text nodes, so when iterating\n    // through the blockText and leafText we just need to remember a window of\n    // one block node and leaf node, respectively.\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at,\n      reverse,\n      voids\n    })) {\n      /*\r\n       * ELEMENT NODE - Yield position(s) for voids, collect blockText for blocks\r\n       */\n      if (Element.isElement(node)) {\n        // Void nodes are a special case, so by default we will always\n        // yield their first point. If the `voids` option is set to true,\n        // then we will iterate over their content.\n        if (!voids && editor.isVoid(node)) {\n          yield Editor.start(editor, path);\n          continue;\n        } // Inline element nodes are ignored as they don't themselves\n        // contribute to `blockText` or `leafText` - their parent and\n        // children do.\n\n\n        if (editor.isInline(node)) continue; // Block element node - set `blockText` to its text content.\n\n        if (Editor.hasInlines(editor, node)) {\n          // We always exhaust block nodes before encountering a new one:\n          //   console.assert(blockText === '',\n          //     `blockText='${blockText}' - `+\n          //     `not exhausted before new block node`, path)\n          // Ensure range considered is capped to `range`, in the\n          // start/end edge cases where block extends beyond range.\n          // Equivalent to this, but presumably more performant:\n          //   blockRange = Editor.range(editor, ...Editor.edges(editor, path))\n          //   blockRange = Range.intersection(range, blockRange) // intersect\n          //   blockText = Editor.string(editor, blockRange, { voids })\n          var e = Path.isAncestor(path, end.path) ? end : Editor.end(editor, path);\n          var s = Path.isAncestor(path, start.path) ? start : Editor.start(editor, path);\n          blockText = Editor.string(editor, {\n            anchor: s,\n            focus: e\n          }, {\n            voids\n          });\n          isNewBlock = true;\n        }\n      }\n      /*\r\n       * TEXT LEAF NODE - Iterate through text content, yielding\r\n       * positions every `distance` offset according to `unit`.\r\n       */\n\n\n      if (Text.isText(node)) {\n        var isFirst = Path.equals(path, first.path); // Proof that we always exhaust text nodes before encountering a new one:\n        //   console.assert(leafTextRemaining <= 0,\n        //     `leafTextRemaining=${leafTextRemaining} - `+\n        //     `not exhausted before new leaf text node`, path)\n        // Reset `leafText` counters for new text node.\n\n        if (isFirst) {\n          leafTextRemaining = reverse ? first.offset : node.text.length - first.offset;\n          leafTextOffset = first.offset; // Works for reverse too.\n        } else {\n          leafTextRemaining = node.text.length;\n          leafTextOffset = reverse ? leafTextRemaining : 0;\n        } // Yield position at the start of node (potentially).\n\n\n        if (isFirst || isNewBlock || unit === 'offset') {\n          yield {\n            path,\n            offset: leafTextOffset\n          };\n          isNewBlock = false;\n        } // Yield positions every (dynamically calculated) `distance` offset.\n\n\n        while (true) {\n          // If `leafText` has caught up with `blockText` (distance=0),\n          // and if blockText is exhausted, break to get another block node,\n          // otherwise advance blockText forward by the new `distance`.\n          if (distance === 0) {\n            if (blockText === '') break;\n            distance = calcDistance(blockText, unit, reverse); // Split the string at the previously found distance and use the\n            // remaining string for the next iteration.\n\n            blockText = splitByCharacterDistance(blockText, distance, reverse)[1];\n          } // Advance `leafText` by the current `distance`.\n\n\n          leafTextOffset = reverse ? leafTextOffset - distance : leafTextOffset + distance;\n          leafTextRemaining = leafTextRemaining - distance; // If `leafText` is exhausted, break to get a new leaf node\n          // and set distance to the overflow amount, so we'll (maybe)\n          // catch up to blockText in the next leaf text node.\n\n          if (leafTextRemaining < 0) {\n            distance = -leafTextRemaining;\n            break;\n          } // Successfully walked `distance` offsets through `leafText`\n          // to catch up with `blockText`, so we can reset `distance`\n          // and yield this position in this node.\n\n\n          distance = 0;\n          yield {\n            path,\n            offset: leafTextOffset\n          };\n        }\n      }\n    } // Proof that upon completion, we've exahusted both leaf and block text:\n    //   console.assert(leafTextRemaining <= 0, \"leafText wasn't exhausted\")\n    //   console.assert(blockText === '', \"blockText wasn't exhausted\")\n    // Helper:\n    // Return the distance in offsets for a step of size `unit` on given string.\n\n\n    function calcDistance(text, unit, reverse) {\n      if (unit === 'character') {\n        return getCharacterDistance(text, reverse);\n      } else if (unit === 'word') {\n        return getWordDistance(text, reverse);\n      } else if (unit === 'line' || unit === 'block') {\n        return text.length;\n      }\n\n      return 1;\n    }\n  },\n\n  /**\r\n   * Get the matching node in the branch of the document before a location.\r\n   */\n  previous(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      mode = 'lowest',\n      voids = false\n    } = options;\n    var {\n      match,\n      at = editor.selection\n    } = options;\n\n    if (!at) {\n      return;\n    }\n\n    var pointBeforeLocation = Editor.before(editor, at, {\n      voids\n    });\n\n    if (!pointBeforeLocation) {\n      return;\n    }\n\n    var [, to] = Editor.first(editor, []); // The search location is from the start of the document to the path of\n    // the point before the location passed in\n\n    var span = [pointBeforeLocation.path, to];\n\n    if (Path.isPath(at) && at.length === 0) {\n      throw new Error(\"Cannot get the previous node from the root node!\");\n    }\n\n    if (match == null) {\n      if (Path.isPath(at)) {\n        var [parent] = Editor.parent(editor, at);\n\n        match = n => parent.children.includes(n);\n      } else {\n        match = () => true;\n      }\n    }\n\n    var [previous] = Editor.nodes(editor, {\n      reverse: true,\n      at: span,\n      match,\n      mode,\n      voids\n    });\n    return previous;\n  },\n\n  /**\r\n   * Get a range of a location.\r\n   */\n  range(editor, at, to) {\n    if (Range.isRange(at) && !to) {\n      return at;\n    }\n\n    var start = Editor.start(editor, at);\n    var end = Editor.end(editor, to || at);\n    return {\n      anchor: start,\n      focus: end\n    };\n  },\n\n  /**\r\n   * Create a mutable ref for a `Range` object, which will stay in sync as new\r\n   * operations are applied to the editor.\r\n   */\n  rangeRef(editor, range) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      affinity = 'forward'\n    } = options;\n    var ref = {\n      current: range,\n      affinity,\n\n      unref() {\n        var {\n          current\n        } = ref;\n        var rangeRefs = Editor.rangeRefs(editor);\n        rangeRefs.delete(ref);\n        ref.current = null;\n        return current;\n      }\n\n    };\n    var refs = Editor.rangeRefs(editor);\n    refs.add(ref);\n    return ref;\n  },\n\n  /**\r\n   * Get the set of currently tracked range refs of the editor.\r\n   */\n  rangeRefs(editor) {\n    var refs = RANGE_REFS.get(editor);\n\n    if (!refs) {\n      refs = new Set();\n      RANGE_REFS.set(editor, refs);\n    }\n\n    return refs;\n  },\n\n  /**\r\n   * Remove a custom property from all of the leaf text nodes in the current\r\n   * selection.\r\n   *\r\n   * If the selection is currently collapsed, the removal will be stored on\r\n   * `editor.marks` and applied to the text inserted next.\r\n   */\n  removeMark(editor, key) {\n    editor.removeMark(key);\n  },\n\n  /**\r\n   * Manually set if the editor should currently be normalizing.\r\n   *\r\n   * Note: Using this incorrectly can leave the editor in an invalid state.\r\n   *\r\n   */\n  setNormalizing(editor, isNormalizing) {\n    NORMALIZING.set(editor, isNormalizing);\n  },\n\n  /**\r\n   * Get the start point of a location.\r\n   */\n  start(editor, at) {\n    return Editor.point(editor, at, {\n      edge: 'start'\n    });\n  },\n\n  /**\r\n   * Get the text string content of a location.\r\n   *\r\n   * Note: by default the text of void nodes is considered to be an empty\r\n   * string, regardless of content, unless you pass in true for the voids option\r\n   */\n  string(editor, at) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      voids = false\n    } = options;\n    var range = Editor.range(editor, at);\n    var [start, end] = Range.edges(range);\n    var text = '';\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at: range,\n      match: Text.isText,\n      voids\n    })) {\n      var t = node.text;\n\n      if (Path.equals(path, end.path)) {\n        t = t.slice(0, end.offset);\n      }\n\n      if (Path.equals(path, start.path)) {\n        t = t.slice(start.offset);\n      }\n\n      text += t;\n    }\n\n    return text;\n  },\n\n  /**\r\n   * Convert a range into a non-hanging one.\r\n   */\n  unhangRange(editor, range) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      voids = false\n    } = options;\n    var [start, end] = Range.edges(range); // PERF: exit early if we can guarantee that the range isn't hanging.\n\n    if (start.offset !== 0 || end.offset !== 0 || Range.isCollapsed(range)) {\n      return range;\n    }\n\n    var endBlock = Editor.above(editor, {\n      at: end,\n      match: n => Editor.isBlock(editor, n)\n    });\n    var blockPath = endBlock ? endBlock[1] : [];\n    var first = Editor.start(editor, start);\n    var before = {\n      anchor: first,\n      focus: end\n    };\n    var skip = true;\n\n    for (var [node, path] of Editor.nodes(editor, {\n      at: before,\n      match: Text.isText,\n      reverse: true,\n      voids\n    })) {\n      if (skip) {\n        skip = false;\n        continue;\n      }\n\n      if (node.text !== '' || Path.isBefore(path, blockPath)) {\n        end = {\n          path,\n          offset: node.text.length\n        };\n        break;\n      }\n    }\n\n    return {\n      anchor: start,\n      focus: end\n    };\n  },\n\n  /**\r\n   * Match a void node in the current branch of the editor.\r\n   */\n  void(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return Editor.above(editor, _objectSpread$8(_objectSpread$8({}, options), {}, {\n      match: n => Editor.isVoid(editor, n)\n    }));\n  },\n\n  /**\r\n   * Call a function, deferring normalization until after it completes.\r\n   */\n  withoutNormalizing(editor, fn) {\n    var value = Editor.isNormalizing(editor);\n    Editor.setNormalizing(editor, false);\n\n    try {\n      fn();\n    } finally {\n      Editor.setNormalizing(editor, value);\n    }\n\n    Editor.normalize(editor);\n  }\n\n};\n\nvar Location = {\n  /**\r\n   * Check if a value implements the `Location` interface.\r\n   */\n  isLocation(value) {\n    return Path.isPath(value) || Point.isPoint(value) || Range.isRange(value);\n  }\n\n};\nvar Span = {\n  /**\r\n   * Check if a value implements the `Span` interface.\r\n   */\n  isSpan(value) {\n    return Array.isArray(value) && value.length === 2 && value.every(Path.isPath);\n  }\n\n};\n\nvar _excluded$3 = [\"children\"],\n    _excluded2$2 = [\"text\"];\nvar IS_NODE_LIST_CACHE = new WeakMap();\nvar Node = {\n  /**\r\n   * Get the node at a specific path, asserting that it's an ancestor node.\r\n   */\n  ancestor(root, path) {\n    var node = Node.get(root, path);\n\n    if (Text.isText(node)) {\n      throw new Error(\"Cannot get the ancestor node at path [\".concat(path, \"] because it refers to a text node instead: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return a generator of all the ancestor nodes above a specific path.\r\n   *\r\n   * By default the order is bottom-up, from lowest to highest ancestor in\r\n   * the tree, but you can pass the `reverse: true` option to go top-down.\r\n   */\n  *ancestors(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    for (var p of Path.ancestors(path, options)) {\n      var n = Node.ancestor(root, p);\n      var entry = [n, p];\n      yield entry;\n    }\n  },\n\n  /**\r\n   * Get the child of a node at a specific index.\r\n   */\n  child(root, index) {\n    if (Text.isText(root)) {\n      throw new Error(\"Cannot get the child of a text node: \".concat(JSON.stringify(root)));\n    }\n\n    var c = root.children[index];\n\n    if (c == null) {\n      throw new Error(\"Cannot get child at index `\".concat(index, \"` in node: \").concat(JSON.stringify(root)));\n    }\n\n    return c;\n  },\n\n  /**\r\n   * Iterate over the children of a node at a specific path.\r\n   */\n  *children(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      reverse = false\n    } = options;\n    var ancestor = Node.ancestor(root, path);\n    var {\n      children\n    } = ancestor;\n    var index = reverse ? children.length - 1 : 0;\n\n    while (reverse ? index >= 0 : index < children.length) {\n      var child = Node.child(ancestor, index);\n      var childPath = path.concat(index);\n      yield [child, childPath];\n      index = reverse ? index - 1 : index + 1;\n    }\n  },\n\n  /**\r\n   * Get an entry for the common ancesetor node of two paths.\r\n   */\n  common(root, path, another) {\n    var p = Path.common(path, another);\n    var n = Node.get(root, p);\n    return [n, p];\n  },\n\n  /**\r\n   * Get the node at a specific path, asserting that it's a descendant node.\r\n   */\n  descendant(root, path) {\n    var node = Node.get(root, path);\n\n    if (Editor.isEditor(node)) {\n      throw new Error(\"Cannot get the descendant node at path [\".concat(path, \"] because it refers to the root editor node instead: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return a generator of all the descendant node entries inside a root node.\r\n   */\n  *descendants(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (path.length !== 0) {\n        // NOTE: we have to coerce here because checking the path's length does\n        // guarantee that `node` is not a `Editor`, but TypeScript doesn't know.\n        yield [node, path];\n      }\n    }\n  },\n\n  /**\r\n   * Return a generator of all the element nodes inside a root node. Each iteration\r\n   * will return an `ElementEntry` tuple consisting of `[Element, Path]`. If the\r\n   * root node is an element it will be included in the iteration as well.\r\n   */\n  *elements(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (Element.isElement(node)) {\n        yield [node, path];\n      }\n    }\n  },\n\n  /**\r\n   * Extract props from a Node.\r\n   */\n  extractProps(node) {\n    if (Element.isAncestor(node)) {\n      var properties = _objectWithoutProperties(node, _excluded$3);\n\n      return properties;\n    } else {\n      var properties = _objectWithoutProperties(node, _excluded2$2);\n\n      return properties;\n    }\n  },\n\n  /**\r\n   * Get the first node entry in a root node from a path.\r\n   */\n  first(root, path) {\n    var p = path.slice();\n    var n = Node.get(root, p);\n\n    while (n) {\n      if (Text.isText(n) || n.children.length === 0) {\n        break;\n      } else {\n        n = n.children[0];\n        p.push(0);\n      }\n    }\n\n    return [n, p];\n  },\n\n  /**\r\n   * Get the sliced fragment represented by a range inside a root node.\r\n   */\n  fragment(root, range) {\n    if (Text.isText(root)) {\n      throw new Error(\"Cannot get a fragment starting from a root text node: \".concat(JSON.stringify(root)));\n    }\n\n    var newRoot = produce({\n      children: root.children\n    }, r => {\n      var [start, end] = Range.edges(range);\n      var nodeEntries = Node.nodes(r, {\n        reverse: true,\n        pass: _ref => {\n          var [, path] = _ref;\n          return !Range.includes(range, path);\n        }\n      });\n\n      for (var [, path] of nodeEntries) {\n        if (!Range.includes(range, path)) {\n          var parent = Node.parent(r, path);\n          var index = path[path.length - 1];\n          parent.children.splice(index, 1);\n        }\n\n        if (Path.equals(path, end.path)) {\n          var leaf = Node.leaf(r, path);\n          leaf.text = leaf.text.slice(0, end.offset);\n        }\n\n        if (Path.equals(path, start.path)) {\n          var _leaf = Node.leaf(r, path);\n\n          _leaf.text = _leaf.text.slice(start.offset);\n        }\n      }\n\n      if (Editor.isEditor(r)) {\n        r.selection = null;\n      }\n    });\n    return newRoot.children;\n  },\n\n  /**\r\n   * Get the descendant node referred to by a specific path. If the path is an\r\n   * empty array, it refers to the root node itself.\r\n   */\n  get(root, path) {\n    var node = root;\n\n    for (var i = 0; i < path.length; i++) {\n      var p = path[i];\n\n      if (Text.isText(node) || !node.children[p]) {\n        throw new Error(\"Cannot find a descendant at path [\".concat(path, \"] in node: \").concat(JSON.stringify(root)));\n      }\n\n      node = node.children[p];\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Check if a descendant node exists at a specific path.\r\n   */\n  has(root, path) {\n    var node = root;\n\n    for (var i = 0; i < path.length; i++) {\n      var p = path[i];\n\n      if (Text.isText(node) || !node.children[p]) {\n        return false;\n      }\n\n      node = node.children[p];\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Check if a value implements the `Node` interface.\r\n   */\n  isNode(value) {\n    return Text.isText(value) || Element.isElement(value) || Editor.isEditor(value);\n  },\n\n  /**\r\n   * Check if a value is a list of `Node` objects.\r\n   */\n  isNodeList(value) {\n    if (!Array.isArray(value)) {\n      return false;\n    }\n\n    var cachedResult = IS_NODE_LIST_CACHE.get(value);\n\n    if (cachedResult !== undefined) {\n      return cachedResult;\n    }\n\n    var isNodeList = value.every(val => Node.isNode(val));\n    IS_NODE_LIST_CACHE.set(value, isNodeList);\n    return isNodeList;\n  },\n\n  /**\r\n   * Get the last node entry in a root node from a path.\r\n   */\n  last(root, path) {\n    var p = path.slice();\n    var n = Node.get(root, p);\n\n    while (n) {\n      if (Text.isText(n) || n.children.length === 0) {\n        break;\n      } else {\n        var i = n.children.length - 1;\n        n = n.children[i];\n        p.push(i);\n      }\n    }\n\n    return [n, p];\n  },\n\n  /**\r\n   * Get the node at a specific path, ensuring it's a leaf text node.\r\n   */\n  leaf(root, path) {\n    var node = Node.get(root, path);\n\n    if (!Text.isText(node)) {\n      throw new Error(\"Cannot get the leaf node at path [\".concat(path, \"] because it refers to a non-leaf node: \").concat(node));\n    }\n\n    return node;\n  },\n\n  /**\r\n   * Return a generator of the in a branch of the tree, from a specific path.\r\n   *\r\n   * By default the order is top-down, from lowest to highest node in the tree,\r\n   * but you can pass the `reverse: true` option to go bottom-up.\r\n   */\n  *levels(root, path) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    for (var p of Path.levels(path, options)) {\n      var n = Node.get(root, p);\n      yield [n, p];\n    }\n  },\n\n  /**\r\n   * Check if a node matches a set of props.\r\n   */\n  matches(node, props) {\n    return Element.isElement(node) && Element.isElementProps(props) && Element.matches(node, props) || Text.isText(node) && Text.isTextProps(props) && Text.matches(node, props);\n  },\n\n  /**\r\n   * Return a generator of all the node entries of a root node. Each entry is\r\n   * returned as a `[Node, Path]` tuple, with the path referring to the node's\r\n   * position inside the root node.\r\n   */\n  *nodes(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      pass,\n      reverse = false\n    } = options;\n    var {\n      from = [],\n      to\n    } = options;\n    var visited = new Set();\n    var p = [];\n    var n = root;\n\n    while (true) {\n      if (to && (reverse ? Path.isBefore(p, to) : Path.isAfter(p, to))) {\n        break;\n      }\n\n      if (!visited.has(n)) {\n        yield [n, p];\n      } // If we're allowed to go downward and we haven't descended yet, do.\n\n\n      if (!visited.has(n) && !Text.isText(n) && n.children.length !== 0 && (pass == null || pass([n, p]) === false)) {\n        visited.add(n);\n        var nextIndex = reverse ? n.children.length - 1 : 0;\n\n        if (Path.isAncestor(p, from)) {\n          nextIndex = from[p.length];\n        }\n\n        p = p.concat(nextIndex);\n        n = Node.get(root, p);\n        continue;\n      } // If we're at the root and we can't go down, we're done.\n\n\n      if (p.length === 0) {\n        break;\n      } // If we're going forward...\n\n\n      if (!reverse) {\n        var newPath = Path.next(p);\n\n        if (Node.has(root, newPath)) {\n          p = newPath;\n          n = Node.get(root, p);\n          continue;\n        }\n      } // If we're going backward...\n\n\n      if (reverse && p[p.length - 1] !== 0) {\n        var _newPath = Path.previous(p);\n\n        p = _newPath;\n        n = Node.get(root, p);\n        continue;\n      } // Otherwise we're going upward...\n\n\n      p = Path.parent(p);\n      n = Node.get(root, p);\n      visited.add(n);\n    }\n  },\n\n  /**\r\n   * Get the parent of a node at a specific path.\r\n   */\n  parent(root, path) {\n    var parentPath = Path.parent(path);\n    var p = Node.get(root, parentPath);\n\n    if (Text.isText(p)) {\n      throw new Error(\"Cannot get the parent of path [\".concat(path, \"] because it does not exist in the root.\"));\n    }\n\n    return p;\n  },\n\n  /**\r\n   * Get the concatenated text string of a node's content.\r\n   *\r\n   * Note that this will not include spaces or line breaks between block nodes.\r\n   * It is not a user-facing string, but a string for performing offset-related\r\n   * computations for a node.\r\n   */\n  string(node) {\n    if (Text.isText(node)) {\n      return node.text;\n    } else {\n      return node.children.map(Node.string).join('');\n    }\n  },\n\n  /**\r\n   * Return a generator of all leaf text nodes in a root node.\r\n   */\n  *texts(root) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var [node, path] of Node.nodes(root, options)) {\n      if (Text.isText(node)) {\n        yield [node, path];\n      }\n    }\n  }\n\n};\n\nfunction ownKeys$7(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$7(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$7(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$7(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Operation = {\n  /**\r\n   * Check of a value is a `NodeOperation` object.\r\n   */\n  isNodeOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_node');\n  },\n\n  /**\r\n   * Check of a value is an `Operation` object.\r\n   */\n  isOperation(value) {\n    if (!isPlainObject(value)) {\n      return false;\n    }\n\n    switch (value.type) {\n      case 'insert_node':\n        return Path.isPath(value.path) && Node.isNode(value.node);\n\n      case 'insert_text':\n        return typeof value.offset === 'number' && typeof value.text === 'string' && Path.isPath(value.path);\n\n      case 'merge_node':\n        return typeof value.position === 'number' && Path.isPath(value.path) && isPlainObject(value.properties);\n\n      case 'move_node':\n        return Path.isPath(value.path) && Path.isPath(value.newPath);\n\n      case 'remove_node':\n        return Path.isPath(value.path) && Node.isNode(value.node);\n\n      case 'remove_text':\n        return typeof value.offset === 'number' && typeof value.text === 'string' && Path.isPath(value.path);\n\n      case 'set_node':\n        return Path.isPath(value.path) && isPlainObject(value.properties) && isPlainObject(value.newProperties);\n\n      case 'set_selection':\n        return value.properties === null && Range.isRange(value.newProperties) || value.newProperties === null && Range.isRange(value.properties) || isPlainObject(value.properties) && isPlainObject(value.newProperties);\n\n      case 'split_node':\n        return Path.isPath(value.path) && typeof value.position === 'number' && isPlainObject(value.properties);\n\n      default:\n        return false;\n    }\n  },\n\n  /**\r\n   * Check if a value is a list of `Operation` objects.\r\n   */\n  isOperationList(value) {\n    return Array.isArray(value) && value.every(val => Operation.isOperation(val));\n  },\n\n  /**\r\n   * Check of a value is a `SelectionOperation` object.\r\n   */\n  isSelectionOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_selection');\n  },\n\n  /**\r\n   * Check of a value is a `TextOperation` object.\r\n   */\n  isTextOperation(value) {\n    return Operation.isOperation(value) && value.type.endsWith('_text');\n  },\n\n  /**\r\n   * Invert an operation, returning a new operation that will exactly undo the\r\n   * original when applied.\r\n   */\n  inverse(op) {\n    switch (op.type) {\n      case 'insert_node':\n        {\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            type: 'remove_node'\n          });\n        }\n\n      case 'insert_text':\n        {\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            type: 'remove_text'\n          });\n        }\n\n      case 'merge_node':\n        {\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            type: 'split_node',\n            path: Path.previous(op.path)\n          });\n        }\n\n      case 'move_node':\n        {\n          var {\n            newPath,\n            path\n          } = op; // PERF: in this case the move operation is a no-op anyways.\n\n          if (Path.equals(newPath, path)) {\n            return op;\n          } // If the move happens completely within a single parent the path and\n          // newPath are stable with respect to each other.\n\n\n          if (Path.isSibling(path, newPath)) {\n            return _objectSpread$7(_objectSpread$7({}, op), {}, {\n              path: newPath,\n              newPath: path\n            });\n          } // If the move does not happen within a single parent it is possible\n          // for the move to impact the true path to the location where the node\n          // was removed from and where it was inserted. We have to adjust for this\n          // and find the original path. We can accomplish this (only in non-sibling)\n          // moves by looking at the impact of the move operation on the node\n          // after the original move path.\n\n\n          var inversePath = Path.transform(path, op);\n          var inverseNewPath = Path.transform(Path.next(path), op);\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            path: inversePath,\n            newPath: inverseNewPath\n          });\n        }\n\n      case 'remove_node':\n        {\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            type: 'insert_node'\n          });\n        }\n\n      case 'remove_text':\n        {\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            type: 'insert_text'\n          });\n        }\n\n      case 'set_node':\n        {\n          var {\n            properties,\n            newProperties\n          } = op;\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            properties: newProperties,\n            newProperties: properties\n          });\n        }\n\n      case 'set_selection':\n        {\n          var {\n            properties: _properties,\n            newProperties: _newProperties\n          } = op;\n\n          if (_properties == null) {\n            return _objectSpread$7(_objectSpread$7({}, op), {}, {\n              properties: _newProperties,\n              newProperties: null\n            });\n          } else if (_newProperties == null) {\n            return _objectSpread$7(_objectSpread$7({}, op), {}, {\n              properties: null,\n              newProperties: _properties\n            });\n          } else {\n            return _objectSpread$7(_objectSpread$7({}, op), {}, {\n              properties: _newProperties,\n              newProperties: _properties\n            });\n          }\n        }\n\n      case 'split_node':\n        {\n          return _objectSpread$7(_objectSpread$7({}, op), {}, {\n            type: 'merge_node',\n            path: Path.next(op.path)\n          });\n        }\n    }\n  }\n\n};\n\nvar Path = {\n  /**\r\n   * Get a list of ancestor paths for a given path.\r\n   *\r\n   * The paths are sorted from deepest to shallowest ancestor. However, if the\r\n   * `reverse: true` option is passed, they are reversed.\r\n   */\n  ancestors(path) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var paths = Path.levels(path, options);\n\n    if (reverse) {\n      paths = paths.slice(1);\n    } else {\n      paths = paths.slice(0, -1);\n    }\n\n    return paths;\n  },\n\n  /**\r\n   * Get the common ancestor path of two paths.\r\n   */\n  common(path, another) {\n    var common = [];\n\n    for (var i = 0; i < path.length && i < another.length; i++) {\n      var av = path[i];\n      var bv = another[i];\n\n      if (av !== bv) {\n        break;\n      }\n\n      common.push(av);\n    }\n\n    return common;\n  },\n\n  /**\r\n   * Compare a path to another, returning an integer indicating whether the path\r\n   * was before, at, or after the other.\r\n   *\r\n   * Note: Two paths of unequal length can still receive a `0` result if one is\r\n   * directly above or below the other. If you want exact matching, use\r\n   * [[Path.equals]] instead.\r\n   */\n  compare(path, another) {\n    var min = Math.min(path.length, another.length);\n\n    for (var i = 0; i < min; i++) {\n      if (path[i] < another[i]) return -1;\n      if (path[i] > another[i]) return 1;\n    }\n\n    return 0;\n  },\n\n  /**\r\n   * Check if a path ends after one of the indexes in another.\r\n   */\n  endsAfter(path, another) {\n    var i = path.length - 1;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    var av = path[i];\n    var bv = another[i];\n    return Path.equals(as, bs) && av > bv;\n  },\n\n  /**\r\n   * Check if a path ends at one of the indexes in another.\r\n   */\n  endsAt(path, another) {\n    var i = path.length;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    return Path.equals(as, bs);\n  },\n\n  /**\r\n   * Check if a path ends before one of the indexes in another.\r\n   */\n  endsBefore(path, another) {\n    var i = path.length - 1;\n    var as = path.slice(0, i);\n    var bs = another.slice(0, i);\n    var av = path[i];\n    var bv = another[i];\n    return Path.equals(as, bs) && av < bv;\n  },\n\n  /**\r\n   * Check if a path is exactly equal to another.\r\n   */\n  equals(path, another) {\n    return path.length === another.length && path.every((n, i) => n === another[i]);\n  },\n\n  /**\r\n   * Check if the path of previous sibling node exists\r\n   */\n  hasPrevious(path) {\n    return path[path.length - 1] > 0;\n  },\n\n  /**\r\n   * Check if a path is after another.\r\n   */\n  isAfter(path, another) {\n    return Path.compare(path, another) === 1;\n  },\n\n  /**\r\n   * Check if a path is an ancestor of another.\r\n   */\n  isAncestor(path, another) {\n    return path.length < another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is before another.\r\n   */\n  isBefore(path, another) {\n    return Path.compare(path, another) === -1;\n  },\n\n  /**\r\n   * Check if a path is a child of another.\r\n   */\n  isChild(path, another) {\n    return path.length === another.length + 1 && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is equal to or an ancestor of another.\r\n   */\n  isCommon(path, another) {\n    return path.length <= another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is a descendant of another.\r\n   */\n  isDescendant(path, another) {\n    return path.length > another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check if a path is the parent of another.\r\n   */\n  isParent(path, another) {\n    return path.length + 1 === another.length && Path.compare(path, another) === 0;\n  },\n\n  /**\r\n   * Check is a value implements the `Path` interface.\r\n   */\n  isPath(value) {\n    return Array.isArray(value) && (value.length === 0 || typeof value[0] === 'number');\n  },\n\n  /**\r\n   * Check if a path is a sibling of another.\r\n   */\n  isSibling(path, another) {\n    if (path.length !== another.length) {\n      return false;\n    }\n\n    var as = path.slice(0, -1);\n    var bs = another.slice(0, -1);\n    var al = path[path.length - 1];\n    var bl = another[another.length - 1];\n    return al !== bl && Path.equals(as, bs);\n  },\n\n  /**\r\n   * Get a list of paths at every level down to a path. Note: this is the same\r\n   * as `Path.ancestors`, but including the path itself.\r\n   *\r\n   * The paths are sorted from shallowest to deepest. However, if the `reverse:\r\n   * true` option is passed, they are reversed.\r\n   */\n  levels(path) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var list = [];\n\n    for (var i = 0; i <= path.length; i++) {\n      list.push(path.slice(0, i));\n    }\n\n    if (reverse) {\n      list.reverse();\n    }\n\n    return list;\n  },\n\n  /**\r\n   * Given a path, get the path to the next sibling node.\r\n   */\n  next(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the next path of a root path [\".concat(path, \"], because it has no next index.\"));\n    }\n\n    var last = path[path.length - 1];\n    return path.slice(0, -1).concat(last + 1);\n  },\n\n  /**\r\n   * Returns whether this operation can affect paths or not. Used as an\r\n   * optimization when updating dirty paths during normalization\r\n   *\r\n   * NOTE: This *must* be kept in sync with the implementation of 'transform'\r\n   * below\r\n   */\n  operationCanTransformPath(operation) {\n    switch (operation.type) {\n      case 'insert_node':\n      case 'remove_node':\n      case 'merge_node':\n      case 'split_node':\n      case 'move_node':\n        return true;\n\n      default:\n        return false;\n    }\n  },\n\n  /**\r\n   * Given a path, return a new path referring to the parent node above it.\r\n   */\n  parent(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the parent path of the root path [\".concat(path, \"].\"));\n    }\n\n    return path.slice(0, -1);\n  },\n\n  /**\r\n   * Given a path, get the path to the previous sibling node.\r\n   */\n  previous(path) {\n    if (path.length === 0) {\n      throw new Error(\"Cannot get the previous path of a root path [\".concat(path, \"], because it has no previous index.\"));\n    }\n\n    var last = path[path.length - 1];\n\n    if (last <= 0) {\n      throw new Error(\"Cannot get the previous path of a first child path [\".concat(path, \"] because it would result in a negative index.\"));\n    }\n\n    return path.slice(0, -1).concat(last - 1);\n  },\n\n  /**\r\n   * Get a path relative to an ancestor.\r\n   */\n  relative(path, ancestor) {\n    if (!Path.isAncestor(ancestor, path) && !Path.equals(path, ancestor)) {\n      throw new Error(\"Cannot get the relative path of [\".concat(path, \"] inside ancestor [\").concat(ancestor, \"], because it is not above or equal to the path.\"));\n    }\n\n    return path.slice(ancestor.length);\n  },\n\n  /**\r\n   * Transform a path by an operation.\r\n   */\n  transform(path, operation) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return produce(path, p => {\n      var {\n        affinity = 'forward'\n      } = options; // PERF: Exit early if the operation is guaranteed not to have an effect.\n\n      if (!path || (path === null || path === void 0 ? void 0 : path.length) === 0) {\n        return;\n      }\n\n      if (p === null) {\n        return null;\n      }\n\n      switch (operation.type) {\n        case 'insert_node':\n          {\n            var {\n              path: op\n            } = operation;\n\n            if (Path.equals(op, p) || Path.endsBefore(op, p) || Path.isAncestor(op, p)) {\n              p[op.length - 1] += 1;\n            }\n\n            break;\n          }\n\n        case 'remove_node':\n          {\n            var {\n              path: _op\n            } = operation;\n\n            if (Path.equals(_op, p) || Path.isAncestor(_op, p)) {\n              return null;\n            } else if (Path.endsBefore(_op, p)) {\n              p[_op.length - 1] -= 1;\n            }\n\n            break;\n          }\n\n        case 'merge_node':\n          {\n            var {\n              path: _op2,\n              position\n            } = operation;\n\n            if (Path.equals(_op2, p) || Path.endsBefore(_op2, p)) {\n              p[_op2.length - 1] -= 1;\n            } else if (Path.isAncestor(_op2, p)) {\n              p[_op2.length - 1] -= 1;\n              p[_op2.length] += position;\n            }\n\n            break;\n          }\n\n        case 'split_node':\n          {\n            var {\n              path: _op3,\n              position: _position\n            } = operation;\n\n            if (Path.equals(_op3, p)) {\n              if (affinity === 'forward') {\n                p[p.length - 1] += 1;\n              } else if (affinity === 'backward') ; else {\n                return null;\n              }\n            } else if (Path.endsBefore(_op3, p)) {\n              p[_op3.length - 1] += 1;\n            } else if (Path.isAncestor(_op3, p) && path[_op3.length] >= _position) {\n              p[_op3.length - 1] += 1;\n              p[_op3.length] -= _position;\n            }\n\n            break;\n          }\n\n        case 'move_node':\n          {\n            var {\n              path: _op4,\n              newPath: onp\n            } = operation; // If the old and new path are the same, it's a no-op.\n\n            if (Path.equals(_op4, onp)) {\n              return;\n            }\n\n            if (Path.isAncestor(_op4, p) || Path.equals(_op4, p)) {\n              var copy = onp.slice();\n\n              if (Path.endsBefore(_op4, onp) && _op4.length < onp.length) {\n                copy[_op4.length - 1] -= 1;\n              }\n\n              return copy.concat(p.slice(_op4.length));\n            } else if (Path.isSibling(_op4, onp) && (Path.isAncestor(onp, p) || Path.equals(onp, p))) {\n              if (Path.endsBefore(_op4, p)) {\n                p[_op4.length - 1] -= 1;\n              } else {\n                p[_op4.length - 1] += 1;\n              }\n            } else if (Path.endsBefore(onp, p) || Path.equals(onp, p) || Path.isAncestor(onp, p)) {\n              if (Path.endsBefore(_op4, p)) {\n                p[_op4.length - 1] -= 1;\n              }\n\n              p[onp.length - 1] += 1;\n            } else if (Path.endsBefore(_op4, p)) {\n              if (Path.equals(onp, p)) {\n                p[onp.length - 1] += 1;\n              }\n\n              p[_op4.length - 1] -= 1;\n            }\n\n            break;\n          }\n      }\n    });\n  }\n\n};\n\nvar PathRef = {\n  /**\r\n   * Transform the path ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var path = Path.transform(current, op, {\n      affinity\n    });\n    ref.current = path;\n\n    if (path == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nfunction ownKeys$6(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$6(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$6(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$6(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Point = {\n  /**\r\n   * Compare a point to another, returning an integer indicating whether the\r\n   * point was before, at, or after the other.\r\n   */\n  compare(point, another) {\n    var result = Path.compare(point.path, another.path);\n\n    if (result === 0) {\n      if (point.offset < another.offset) return -1;\n      if (point.offset > another.offset) return 1;\n      return 0;\n    }\n\n    return result;\n  },\n\n  /**\r\n   * Check if a point is after another.\r\n   */\n  isAfter(point, another) {\n    return Point.compare(point, another) === 1;\n  },\n\n  /**\r\n   * Check if a point is before another.\r\n   */\n  isBefore(point, another) {\n    return Point.compare(point, another) === -1;\n  },\n\n  /**\r\n   * Check if a point is exactly equal to another.\r\n   */\n  equals(point, another) {\n    // PERF: ensure the offsets are equal first since they are cheaper to check.\n    return point.offset === another.offset && Path.equals(point.path, another.path);\n  },\n\n  /**\r\n   * Check if a value implements the `Point` interface.\r\n   */\n  isPoint(value) {\n    return isPlainObject(value) && typeof value.offset === 'number' && Path.isPath(value.path);\n  },\n\n  /**\r\n   * Transform a point by an operation.\r\n   */\n  transform(point, op) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return produce(point, p => {\n      if (p === null) {\n        return null;\n      }\n\n      var {\n        affinity = 'forward'\n      } = options;\n      var {\n        path,\n        offset\n      } = p;\n\n      switch (op.type) {\n        case 'insert_node':\n        case 'move_node':\n          {\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'insert_text':\n          {\n            if (Path.equals(op.path, path) && op.offset <= offset) {\n              p.offset += op.text.length;\n            }\n\n            break;\n          }\n\n        case 'merge_node':\n          {\n            if (Path.equals(op.path, path)) {\n              p.offset += op.position;\n            }\n\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'remove_text':\n          {\n            if (Path.equals(op.path, path) && op.offset <= offset) {\n              p.offset -= Math.min(offset - op.offset, op.text.length);\n            }\n\n            break;\n          }\n\n        case 'remove_node':\n          {\n            if (Path.equals(op.path, path) || Path.isAncestor(op.path, path)) {\n              return null;\n            }\n\n            p.path = Path.transform(path, op, options);\n            break;\n          }\n\n        case 'split_node':\n          {\n            if (Path.equals(op.path, path)) {\n              if (op.position === offset && affinity == null) {\n                return null;\n              } else if (op.position < offset || op.position === offset && affinity === 'forward') {\n                p.offset -= op.position;\n                p.path = Path.transform(path, op, _objectSpread$6(_objectSpread$6({}, options), {}, {\n                  affinity: 'forward'\n                }));\n              }\n            } else {\n              p.path = Path.transform(path, op, options);\n            }\n\n            break;\n          }\n      }\n    });\n  }\n\n};\n\nvar PointRef = {\n  /**\r\n   * Transform the point ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var point = Point.transform(current, op, {\n      affinity\n    });\n    ref.current = point;\n\n    if (point == null) {\n      ref.unref();\n    }\n  }\n\n};\n\nvar _excluded$2 = [\"anchor\", \"focus\"];\n\nfunction ownKeys$5(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$5(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$5(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$5(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Range = {\n  /**\r\n   * Get the start and end points of a range, in the order in which they appear\r\n   * in the document.\r\n   */\n  edges(range) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      reverse = false\n    } = options;\n    var {\n      anchor,\n      focus\n    } = range;\n    return Range.isBackward(range) === reverse ? [anchor, focus] : [focus, anchor];\n  },\n\n  /**\r\n   * Get the end point of a range.\r\n   */\n  end(range) {\n    var [, end] = Range.edges(range);\n    return end;\n  },\n\n  /**\r\n   * Check if a range is exactly equal to another.\r\n   */\n  equals(range, another) {\n    return Point.equals(range.anchor, another.anchor) && Point.equals(range.focus, another.focus);\n  },\n\n  /**\r\n   * Check if a range includes a path, a point or part of another range.\r\n   */\n  includes(range, target) {\n    if (Range.isRange(target)) {\n      if (Range.includes(range, target.anchor) || Range.includes(range, target.focus)) {\n        return true;\n      }\n\n      var [rs, re] = Range.edges(range);\n      var [ts, te] = Range.edges(target);\n      return Point.isBefore(rs, ts) && Point.isAfter(re, te);\n    }\n\n    var [start, end] = Range.edges(range);\n    var isAfterStart = false;\n    var isBeforeEnd = false;\n\n    if (Point.isPoint(target)) {\n      isAfterStart = Point.compare(target, start) >= 0;\n      isBeforeEnd = Point.compare(target, end) <= 0;\n    } else {\n      isAfterStart = Path.compare(target, start.path) >= 0;\n      isBeforeEnd = Path.compare(target, end.path) <= 0;\n    }\n\n    return isAfterStart && isBeforeEnd;\n  },\n\n  /**\r\n   * Get the intersection of a range with another.\r\n   */\n  intersection(range, another) {\n    var rest = _objectWithoutProperties(range, _excluded$2);\n\n    var [s1, e1] = Range.edges(range);\n    var [s2, e2] = Range.edges(another);\n    var start = Point.isBefore(s1, s2) ? s2 : s1;\n    var end = Point.isBefore(e1, e2) ? e1 : e2;\n\n    if (Point.isBefore(end, start)) {\n      return null;\n    } else {\n      return _objectSpread$5({\n        anchor: start,\n        focus: end\n      }, rest);\n    }\n  },\n\n  /**\r\n   * Check if a range is backward, meaning that its anchor point appears in the\r\n   * document _after_ its focus point.\r\n   */\n  isBackward(range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    return Point.isAfter(anchor, focus);\n  },\n\n  /**\r\n   * Check if a range is collapsed, meaning that both its anchor and focus\r\n   * points refer to the exact same position in the document.\r\n   */\n  isCollapsed(range) {\n    var {\n      anchor,\n      focus\n    } = range;\n    return Point.equals(anchor, focus);\n  },\n\n  /**\r\n   * Check if a range is expanded.\r\n   *\r\n   * This is the opposite of [[Range.isCollapsed]] and is provided for legibility.\r\n   */\n  isExpanded(range) {\n    return !Range.isCollapsed(range);\n  },\n\n  /**\r\n   * Check if a range is forward.\r\n   *\r\n   * This is the opposite of [[Range.isBackward]] and is provided for legibility.\r\n   */\n  isForward(range) {\n    return !Range.isBackward(range);\n  },\n\n  /**\r\n   * Check if a value implements the [[Range]] interface.\r\n   */\n  isRange(value) {\n    return isPlainObject(value) && Point.isPoint(value.anchor) && Point.isPoint(value.focus);\n  },\n\n  /**\r\n   * Iterate through all of the point entries in a range.\r\n   */\n  *points(range) {\n    yield [range.anchor, 'anchor'];\n    yield [range.focus, 'focus'];\n  },\n\n  /**\r\n   * Get the start point of a range.\r\n   */\n  start(range) {\n    var [start] = Range.edges(range);\n    return start;\n  },\n\n  /**\r\n   * Transform a range by an operation.\r\n   */\n  transform(range, op) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return produce(range, r => {\n      if (r === null) {\n        return null;\n      }\n\n      var {\n        affinity = 'inward'\n      } = options;\n      var affinityAnchor;\n      var affinityFocus;\n\n      if (affinity === 'inward') {\n        // If the range is collapsed, make sure to use the same affinity to\n        // avoid the two points passing each other and expanding in the opposite\n        // direction\n        var isCollapsed = Range.isCollapsed(r);\n\n        if (Range.isForward(r)) {\n          affinityAnchor = 'forward';\n          affinityFocus = isCollapsed ? affinityAnchor : 'backward';\n        } else {\n          affinityAnchor = 'backward';\n          affinityFocus = isCollapsed ? affinityAnchor : 'forward';\n        }\n      } else if (affinity === 'outward') {\n        if (Range.isForward(r)) {\n          affinityAnchor = 'backward';\n          affinityFocus = 'forward';\n        } else {\n          affinityAnchor = 'forward';\n          affinityFocus = 'backward';\n        }\n      } else {\n        affinityAnchor = affinity;\n        affinityFocus = affinity;\n      }\n\n      var anchor = Point.transform(r.anchor, op, {\n        affinity: affinityAnchor\n      });\n      var focus = Point.transform(r.focus, op, {\n        affinity: affinityFocus\n      });\n\n      if (!anchor || !focus) {\n        return null;\n      }\n\n      r.anchor = anchor;\n      r.focus = focus;\n    });\n  }\n\n};\n\nvar RangeRef = {\n  /**\r\n   * Transform the range ref's current value by an operation.\r\n   */\n  transform(ref, op) {\n    var {\n      current,\n      affinity\n    } = ref;\n\n    if (current == null) {\n      return;\n    }\n\n    var path = Range.transform(current, op, {\n      affinity\n    });\n    ref.current = path;\n\n    if (path == null) {\n      ref.unref();\n    }\n  }\n\n};\n\n/*\r\n  Custom deep equal comparison for Slate nodes.\r\n\n  We don't need general purpose deep equality;\r\n  Slate only supports plain values, Arrays, and nested objects.\r\n  Complex values nested inside Arrays are not supported.\r\n\n  Slate objects are designed to be serialised, so\r\n  missing keys are deliberately normalised to undefined.\r\n */\n\nvar isDeepEqual = (node, another) => {\n  for (var key in node) {\n    var a = node[key];\n    var b = another[key];\n\n    if (isPlainObject(a) && isPlainObject(b)) {\n      if (!isDeepEqual(a, b)) return false;\n    } else if (Array.isArray(a) && Array.isArray(b)) {\n      if (a.length !== b.length) return false;\n\n      for (var i = 0; i < a.length; i++) {\n        if (a[i] !== b[i]) return false;\n      }\n    } else if (a !== b) {\n      return false;\n    }\n  }\n  /*\r\n    Deep object equality is only necessary in one direction; in the reverse direction\r\n    we are only looking for keys that are missing.\r\n    As above, undefined keys are normalised to missing.\r\n  */\n\n\n  for (var _key in another) {\n    if (node[_key] === undefined && another[_key] !== undefined) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\nvar _excluded$1 = [\"text\"],\n    _excluded2$1 = [\"anchor\", \"focus\"];\n\nfunction ownKeys$4(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$4(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$4(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$4(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Text = {\n  /**\r\n   * Check if two text nodes are equal.\r\n   *\r\n   * When loose is set, the text is not compared. This is\r\n   * used to check whether sibling text nodes can be merged.\r\n   */\n  equals(text, another) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      loose = false\n    } = options;\n\n    function omitText(obj) {\n      var rest = _objectWithoutProperties(obj, _excluded$1);\n\n      return rest;\n    }\n\n    return isDeepEqual(loose ? omitText(text) : text, loose ? omitText(another) : another);\n  },\n\n  /**\r\n   * Check if a value implements the `Text` interface.\r\n   */\n  isText(value) {\n    return isPlainObject(value) && typeof value.text === 'string';\n  },\n\n  /**\r\n   * Check if a value is a list of `Text` objects.\r\n   */\n  isTextList(value) {\n    return Array.isArray(value) && value.every(val => Text.isText(val));\n  },\n\n  /**\r\n   * Check if some props are a partial of Text.\r\n   */\n  isTextProps(props) {\n    return props.text !== undefined;\n  },\n\n  /**\r\n   * Check if an text matches set of properties.\r\n   *\r\n   * Note: this is for matching custom properties, and it does not ensure that\r\n   * the `text` property are two nodes equal.\r\n   */\n  matches(text, props) {\n    for (var key in props) {\n      if (key === 'text') {\n        continue;\n      }\n\n      if (!text.hasOwnProperty(key) || text[key] !== props[key]) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n\n  /**\r\n   * Get the leaves for a text node given decorations.\r\n   */\n  decorations(node, decorations) {\n    var leaves = [_objectSpread$4({}, node)];\n\n    for (var dec of decorations) {\n      var rest = _objectWithoutProperties(dec, _excluded2$1);\n\n      var [start, end] = Range.edges(dec);\n      var next = [];\n      var o = 0;\n\n      for (var leaf of leaves) {\n        var {\n          length\n        } = leaf.text;\n        var offset = o;\n        o += length; // If the range encompases the entire leaf, add the range.\n\n        if (start.offset <= offset && end.offset >= o) {\n          Object.assign(leaf, rest);\n          next.push(leaf);\n          continue;\n        } // If the range expanded and match the leaf, or starts after, or ends before it, continue.\n\n\n        if (start.offset !== end.offset && (start.offset === o || end.offset === offset) || start.offset > o || end.offset < offset || end.offset === offset && offset !== 0) {\n          next.push(leaf);\n          continue;\n        } // Otherwise we need to split the leaf, at the start, end, or both,\n        // and add the range to the middle intersecting section. Do the end\n        // split first since we don't need to update the offset that way.\n\n\n        var middle = leaf;\n        var before = void 0;\n        var after = void 0;\n\n        if (end.offset < o) {\n          var off = end.offset - offset;\n          after = _objectSpread$4(_objectSpread$4({}, middle), {}, {\n            text: middle.text.slice(off)\n          });\n          middle = _objectSpread$4(_objectSpread$4({}, middle), {}, {\n            text: middle.text.slice(0, off)\n          });\n        }\n\n        if (start.offset > offset) {\n          var _off = start.offset - offset;\n\n          before = _objectSpread$4(_objectSpread$4({}, middle), {}, {\n            text: middle.text.slice(0, _off)\n          });\n          middle = _objectSpread$4(_objectSpread$4({}, middle), {}, {\n            text: middle.text.slice(_off)\n          });\n        }\n\n        Object.assign(middle, rest);\n\n        if (before) {\n          next.push(before);\n        }\n\n        next.push(middle);\n\n        if (after) {\n          next.push(after);\n        }\n      }\n\n      leaves = next;\n    }\n\n    return leaves;\n  }\n\n};\n\nfunction ownKeys$3(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$3(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$3(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$3(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar applyToDraft = (editor, selection, op) => {\n  switch (op.type) {\n    case 'insert_node':\n      {\n        var {\n          path,\n          node\n        } = op;\n        var parent = Node.parent(editor, path);\n        var index = path[path.length - 1];\n\n        if (index > parent.children.length) {\n          throw new Error(\"Cannot apply an \\\"insert_node\\\" operation at path [\".concat(path, \"] because the destination is past the end of the node.\"));\n        }\n\n        parent.children.splice(index, 0, node);\n\n        if (selection) {\n          for (var [point, key] of Range.points(selection)) {\n            selection[key] = Point.transform(point, op);\n          }\n        }\n\n        break;\n      }\n\n    case 'insert_text':\n      {\n        var {\n          path: _path,\n          offset,\n          text\n        } = op;\n        if (text.length === 0) break;\n\n        var _node = Node.leaf(editor, _path);\n\n        var before = _node.text.slice(0, offset);\n\n        var after = _node.text.slice(offset);\n\n        _node.text = before + text + after;\n\n        if (selection) {\n          for (var [_point, _key] of Range.points(selection)) {\n            selection[_key] = Point.transform(_point, op);\n          }\n        }\n\n        break;\n      }\n\n    case 'merge_node':\n      {\n        var {\n          path: _path2\n        } = op;\n\n        var _node2 = Node.get(editor, _path2);\n\n        var prevPath = Path.previous(_path2);\n        var prev = Node.get(editor, prevPath);\n\n        var _parent = Node.parent(editor, _path2);\n\n        var _index = _path2[_path2.length - 1];\n\n        if (Text.isText(_node2) && Text.isText(prev)) {\n          prev.text += _node2.text;\n        } else if (!Text.isText(_node2) && !Text.isText(prev)) {\n          prev.children.push(..._node2.children);\n        } else {\n          throw new Error(\"Cannot apply a \\\"merge_node\\\" operation at path [\".concat(_path2, \"] to nodes of different interfaces: \").concat(_node2, \" \").concat(prev));\n        }\n\n        _parent.children.splice(_index, 1);\n\n        if (selection) {\n          for (var [_point2, _key2] of Range.points(selection)) {\n            selection[_key2] = Point.transform(_point2, op);\n          }\n        }\n\n        break;\n      }\n\n    case 'move_node':\n      {\n        var {\n          path: _path3,\n          newPath\n        } = op;\n\n        if (Path.isAncestor(_path3, newPath)) {\n          throw new Error(\"Cannot move a path [\".concat(_path3, \"] to new path [\").concat(newPath, \"] because the destination is inside itself.\"));\n        }\n\n        var _node3 = Node.get(editor, _path3);\n\n        var _parent2 = Node.parent(editor, _path3);\n\n        var _index2 = _path3[_path3.length - 1]; // This is tricky, but since the `path` and `newPath` both refer to\n        // the same snapshot in time, there's a mismatch. After either\n        // removing the original position, the second step's path can be out\n        // of date. So instead of using the `op.newPath` directly, we\n        // transform `op.path` to ascertain what the `newPath` would be after\n        // the operation was applied.\n\n        _parent2.children.splice(_index2, 1);\n\n        var truePath = Path.transform(_path3, op);\n        var newParent = Node.get(editor, Path.parent(truePath));\n        var newIndex = truePath[truePath.length - 1];\n        newParent.children.splice(newIndex, 0, _node3);\n\n        if (selection) {\n          for (var [_point3, _key3] of Range.points(selection)) {\n            selection[_key3] = Point.transform(_point3, op);\n          }\n        }\n\n        break;\n      }\n\n    case 'remove_node':\n      {\n        var {\n          path: _path4\n        } = op;\n        var _index3 = _path4[_path4.length - 1];\n\n        var _parent3 = Node.parent(editor, _path4);\n\n        _parent3.children.splice(_index3, 1); // Transform all of the points in the value, but if the point was in the\n        // node that was removed we need to update the range or remove it.\n\n\n        if (selection) {\n          for (var [_point4, _key4] of Range.points(selection)) {\n            var result = Point.transform(_point4, op);\n\n            if (selection != null && result != null) {\n              selection[_key4] = result;\n            } else {\n              var _prev = void 0;\n\n              var next = void 0;\n\n              for (var [n, p] of Node.texts(editor)) {\n                if (Path.compare(p, _path4) === -1) {\n                  _prev = [n, p];\n                } else {\n                  next = [n, p];\n                  break;\n                }\n              }\n\n              var preferNext = false;\n\n              if (_prev && next) {\n                if (Path.equals(next[1], _path4)) {\n                  preferNext = !Path.hasPrevious(next[1]);\n                } else {\n                  preferNext = Path.common(_prev[1], _path4).length < Path.common(next[1], _path4).length;\n                }\n              }\n\n              if (_prev && !preferNext) {\n                _point4.path = _prev[1];\n                _point4.offset = _prev[0].text.length;\n              } else if (next) {\n                _point4.path = next[1];\n                _point4.offset = 0;\n              } else {\n                selection = null;\n              }\n            }\n          }\n        }\n\n        break;\n      }\n\n    case 'remove_text':\n      {\n        var {\n          path: _path5,\n          offset: _offset,\n          text: _text\n        } = op;\n        if (_text.length === 0) break;\n\n        var _node4 = Node.leaf(editor, _path5);\n\n        var _before = _node4.text.slice(0, _offset);\n\n        var _after = _node4.text.slice(_offset + _text.length);\n\n        _node4.text = _before + _after;\n\n        if (selection) {\n          for (var [_point5, _key5] of Range.points(selection)) {\n            selection[_key5] = Point.transform(_point5, op);\n          }\n        }\n\n        break;\n      }\n\n    case 'set_node':\n      {\n        var {\n          path: _path6,\n          properties,\n          newProperties\n        } = op;\n\n        if (_path6.length === 0) {\n          throw new Error(\"Cannot set properties on the root node!\");\n        }\n\n        var _node5 = Node.get(editor, _path6);\n\n        for (var _key6 in newProperties) {\n          if (_key6 === 'children' || _key6 === 'text') {\n            throw new Error(\"Cannot set the \\\"\".concat(_key6, \"\\\" property of nodes!\"));\n          }\n\n          var value = newProperties[_key6];\n\n          if (value == null) {\n            delete _node5[_key6];\n          } else {\n            _node5[_key6] = value;\n          }\n        } // properties that were previously defined, but are now missing, must be deleted\n\n\n        for (var _key7 in properties) {\n          if (!newProperties.hasOwnProperty(_key7)) {\n            delete _node5[_key7];\n          }\n        }\n\n        break;\n      }\n\n    case 'set_selection':\n      {\n        var {\n          newProperties: _newProperties\n        } = op;\n\n        if (_newProperties == null) {\n          selection = _newProperties;\n        } else {\n          if (selection == null) {\n            if (!Range.isRange(_newProperties)) {\n              throw new Error(\"Cannot apply an incomplete \\\"set_selection\\\" operation properties \".concat(JSON.stringify(_newProperties), \" when there is no current selection.\"));\n            }\n\n            selection = _objectSpread$3({}, _newProperties);\n          }\n\n          for (var _key8 in _newProperties) {\n            var _value = _newProperties[_key8];\n\n            if (_value == null) {\n              if (_key8 === 'anchor' || _key8 === 'focus') {\n                throw new Error(\"Cannot remove the \\\"\".concat(_key8, \"\\\" selection property\"));\n              }\n\n              delete selection[_key8];\n            } else {\n              selection[_key8] = _value;\n            }\n          }\n        }\n\n        break;\n      }\n\n    case 'split_node':\n      {\n        var {\n          path: _path7,\n          position,\n          properties: _properties\n        } = op;\n\n        if (_path7.length === 0) {\n          throw new Error(\"Cannot apply a \\\"split_node\\\" operation at path [\".concat(_path7, \"] because the root node cannot be split.\"));\n        }\n\n        var _node6 = Node.get(editor, _path7);\n\n        var _parent4 = Node.parent(editor, _path7);\n\n        var _index4 = _path7[_path7.length - 1];\n        var newNode;\n\n        if (Text.isText(_node6)) {\n          var _before2 = _node6.text.slice(0, position);\n\n          var _after2 = _node6.text.slice(position);\n\n          _node6.text = _before2;\n          newNode = _objectSpread$3(_objectSpread$3({}, _properties), {}, {\n            text: _after2\n          });\n        } else {\n          var _before3 = _node6.children.slice(0, position);\n\n          var _after3 = _node6.children.slice(position);\n\n          _node6.children = _before3;\n          newNode = _objectSpread$3(_objectSpread$3({}, _properties), {}, {\n            children: _after3\n          });\n        }\n\n        _parent4.children.splice(_index4 + 1, 0, newNode);\n\n        if (selection) {\n          for (var [_point6, _key9] of Range.points(selection)) {\n            selection[_key9] = Point.transform(_point6, op);\n          }\n        }\n\n        break;\n      }\n  }\n\n  return selection;\n};\n\nvar GeneralTransforms = {\n  /**\r\n   * Transform the editor by an operation.\r\n   */\n  transform(editor, op) {\n    editor.children = createDraft(editor.children);\n    var selection = editor.selection && createDraft(editor.selection);\n\n    try {\n      selection = applyToDraft(editor, selection, op);\n    } finally {\n      editor.children = finishDraft(editor.children);\n\n      if (selection) {\n        editor.selection = isDraft(selection) ? finishDraft(selection) : selection;\n      } else {\n        editor.selection = null;\n      }\n    }\n  }\n\n};\n\nvar _excluded = [\"text\"],\n    _excluded2 = [\"children\"];\n\nfunction ownKeys$2(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$2(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$2(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$2(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar NodeTransforms = {\n  /**\r\n   * Insert nodes at a specific location in the Editor.\r\n   */\n  insertNodes(editor, nodes) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n      var {\n        at,\n        match,\n        select\n      } = options;\n\n      if (Node.isNode(nodes)) {\n        nodes = [nodes];\n      }\n\n      if (nodes.length === 0) {\n        return;\n      }\n\n      var [node] = nodes; // By default, use the selection as the target location. But if there is\n      // no selection, insert at the end of the document since that is such a\n      // common use case when inserting from a non-selected state.\n\n      if (!at) {\n        if (editor.selection) {\n          at = editor.selection;\n        } else if (editor.children.length > 0) {\n          at = Editor.end(editor, []);\n        } else {\n          at = [0];\n        }\n\n        select = true;\n      }\n\n      if (select == null) {\n        select = false;\n      }\n\n      if (Range.isRange(at)) {\n        if (!hanging) {\n          at = Editor.unhangRange(editor, at);\n        }\n\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n        }\n      }\n\n      if (Point.isPoint(at)) {\n        if (match == null) {\n          if (Text.isText(node)) {\n            match = n => Text.isText(n);\n          } else if (editor.isInline(node)) {\n            match = n => Text.isText(n) || Editor.isInline(editor, n);\n          } else {\n            match = n => Editor.isBlock(editor, n);\n          }\n        }\n\n        var [entry] = Editor.nodes(editor, {\n          at: at.path,\n          match,\n          mode,\n          voids\n        });\n\n        if (entry) {\n          var [, _matchPath] = entry;\n          var pathRef = Editor.pathRef(editor, _matchPath);\n          var isAtEnd = Editor.isEnd(editor, at, _matchPath);\n          Transforms.splitNodes(editor, {\n            at,\n            match,\n            mode,\n            voids\n          });\n          var path = pathRef.unref();\n          at = isAtEnd ? Path.next(path) : path;\n        } else {\n          return;\n        }\n      }\n\n      var parentPath = Path.parent(at);\n      var index = at[at.length - 1];\n\n      if (!voids && Editor.void(editor, {\n        at: parentPath\n      })) {\n        return;\n      }\n\n      for (var _node of nodes) {\n        var _path = parentPath.concat(index);\n\n        index++;\n        editor.apply({\n          type: 'insert_node',\n          path: _path,\n          node: _node\n        });\n        at = Path.next(at);\n      }\n\n      at = Path.previous(at);\n\n      if (select) {\n        var point = Editor.end(editor, at);\n\n        if (point) {\n          Transforms.select(editor, point);\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Lift nodes at a specific location upwards in the document tree, splitting\r\n   * their parent in two if necessary.\r\n   */\n  liftNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        at = editor.selection,\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match\n      } = options;\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!at) {\n        return;\n      }\n\n      var matches = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(matches, _ref => {\n        var [, p] = _ref;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n\n        if (path.length < 2) {\n          throw new Error(\"Cannot lift node at a path [\".concat(path, \"] because it has a depth of less than `2`.\"));\n        }\n\n        var parentNodeEntry = Editor.node(editor, Path.parent(path));\n        var [parent, parentPath] = parentNodeEntry;\n        var index = path[path.length - 1];\n        var {\n          length\n        } = parent.children;\n\n        if (length === 1) {\n          var toPath = Path.next(parentPath);\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: toPath,\n            voids\n          });\n          Transforms.removeNodes(editor, {\n            at: parentPath,\n            voids\n          });\n        } else if (index === 0) {\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: parentPath,\n            voids\n          });\n        } else if (index === length - 1) {\n          var _toPath = Path.next(parentPath);\n\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: _toPath,\n            voids\n          });\n        } else {\n          var splitPath = Path.next(path);\n\n          var _toPath2 = Path.next(parentPath);\n\n          Transforms.splitNodes(editor, {\n            at: splitPath,\n            voids\n          });\n          Transforms.moveNodes(editor, {\n            at: path,\n            to: _toPath2,\n            voids\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Merge a node at a location with the previous node of the same depth,\r\n   * removing any empty containing nodes after the merge if necessary.\r\n   */\n  mergeNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        match,\n        at = editor.selection\n      } = options;\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        if (Path.isPath(at)) {\n          var [parent] = Editor.parent(editor, at);\n\n          match = n => parent.children.includes(n);\n        } else {\n          match = n => Editor.isBlock(editor, n);\n        }\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      if (Range.isRange(at)) {\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n\n          if (options.at == null) {\n            Transforms.select(editor, at);\n          }\n        }\n      }\n\n      var [current] = Editor.nodes(editor, {\n        at,\n        match,\n        voids,\n        mode\n      });\n      var prev = Editor.previous(editor, {\n        at,\n        match,\n        voids,\n        mode\n      });\n\n      if (!current || !prev) {\n        return;\n      }\n\n      var [node, path] = current;\n      var [prevNode, prevPath] = prev;\n\n      if (path.length === 0 || prevPath.length === 0) {\n        return;\n      }\n\n      var newPath = Path.next(prevPath);\n      var commonPath = Path.common(path, prevPath);\n      var isPreviousSibling = Path.isSibling(path, prevPath);\n      var levels = Array.from(Editor.levels(editor, {\n        at: path\n      }), _ref2 => {\n        var [n] = _ref2;\n        return n;\n      }).slice(commonPath.length).slice(0, -1); // Determine if the merge will leave an ancestor of the path empty as a\n      // result, in which case we'll want to remove it after merging.\n\n      var emptyAncestor = Editor.above(editor, {\n        at: path,\n        mode: 'highest',\n        match: n => levels.includes(n) && hasSingleChildNest(editor, n)\n      });\n      var emptyRef = emptyAncestor && Editor.pathRef(editor, emptyAncestor[1]);\n      var properties;\n      var position; // Ensure that the nodes are equivalent, and figure out what the position\n      // and extra properties of the merge will be.\n\n      if (Text.isText(node) && Text.isText(prevNode)) {\n        var rest = _objectWithoutProperties(node, _excluded);\n\n        position = prevNode.text.length;\n        properties = rest;\n      } else if (Element.isElement(node) && Element.isElement(prevNode)) {\n        var rest = _objectWithoutProperties(node, _excluded2);\n\n        position = prevNode.children.length;\n        properties = rest;\n      } else {\n        throw new Error(\"Cannot merge the node at path [\".concat(path, \"] with the previous sibling because it is not the same kind: \").concat(JSON.stringify(node), \" \").concat(JSON.stringify(prevNode)));\n      } // If the node isn't already the next sibling of the previous node, move\n      // it so that it is before merging.\n\n\n      if (!isPreviousSibling) {\n        Transforms.moveNodes(editor, {\n          at: path,\n          to: newPath,\n          voids\n        });\n      } // If there was going to be an empty ancestor of the node that was merged,\n      // we remove it from the tree.\n\n\n      if (emptyRef) {\n        Transforms.removeNodes(editor, {\n          at: emptyRef.current,\n          voids\n        });\n      } // If the target node that we're merging with is empty, remove it instead\n      // of merging the two. This is a common rich text editor behavior to\n      // prevent losing formatting when deleting entire nodes when you have a\n      // hanging selection.\n      // if prevNode is first child in parent,don't remove it.\n\n\n      if (Element.isElement(prevNode) && Editor.isEmpty(editor, prevNode) || Text.isText(prevNode) && prevNode.text === '' && prevPath[prevPath.length - 1] !== 0) {\n        Transforms.removeNodes(editor, {\n          at: prevPath,\n          voids\n        });\n      } else {\n        editor.apply({\n          type: 'merge_node',\n          path: newPath,\n          position,\n          properties\n        });\n      }\n\n      if (emptyRef) {\n        emptyRef.unref();\n      }\n    });\n  },\n\n  /**\r\n   * Move the nodes at a location to a new location.\r\n   */\n  moveNodes(editor, options) {\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        to,\n        at = editor.selection,\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      var toRef = Editor.pathRef(editor, to);\n      var targets = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(targets, _ref3 => {\n        var [, p] = _ref3;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n        var newPath = toRef.current;\n\n        if (path.length !== 0) {\n          editor.apply({\n            type: 'move_node',\n            path,\n            newPath\n          });\n        }\n\n        if (toRef.current && Path.isSibling(newPath, path) && Path.isAfter(newPath, path)) {\n          // When performing a sibling move to a later index, the path at the destination is shifted\n          // to before the insertion point instead of after. To ensure our group of nodes are inserted\n          // in the correct order we increment toRef to account for that\n          toRef.current = Path.next(toRef.current);\n        }\n      }\n\n      toRef.unref();\n    });\n  },\n\n  /**\r\n   * Remove the nodes at a specific location in the document.\r\n   */\n  removeNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false,\n        mode = 'lowest'\n      } = options;\n      var {\n        at = editor.selection,\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      var depths = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(depths, _ref4 => {\n        var [, p] = _ref4;\n        return Editor.pathRef(editor, p);\n      });\n\n      for (var pathRef of pathRefs) {\n        var path = pathRef.unref();\n\n        if (path) {\n          var [node] = Editor.node(editor, path);\n          editor.apply({\n            type: 'remove_node',\n            path,\n            node\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Set new properties on the nodes at a location.\r\n   */\n  setNodes(editor, props) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        match,\n        at = editor.selection\n      } = options;\n      var {\n        hanging = false,\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (!hanging && Range.isRange(at)) {\n        at = Editor.unhangRange(editor, at);\n      }\n\n      if (split && Range.isRange(at)) {\n        if (Range.isCollapsed(at) && Editor.leaf(editor, at.anchor)[0].text.length > 0) {\n          // If the range is collapsed in a non-empty node and 'split' is true, there's nothing to\n          // set that won't get normalized away\n          return;\n        }\n\n        var rangeRef = Editor.rangeRef(editor, at, {\n          affinity: 'inward'\n        });\n        var [start, end] = Range.edges(at);\n        var splitMode = mode === 'lowest' ? 'lowest' : 'highest';\n        var endAtEndOfNode = Editor.isEnd(editor, end, end.path);\n        Transforms.splitNodes(editor, {\n          at: end,\n          match,\n          mode: splitMode,\n          voids,\n          always: !endAtEndOfNode\n        });\n        var startAtStartOfNode = Editor.isStart(editor, start, start.path);\n        Transforms.splitNodes(editor, {\n          at: start,\n          match,\n          mode: splitMode,\n          voids,\n          always: !startAtStartOfNode\n        });\n        at = rangeRef.unref();\n\n        if (options.at == null) {\n          Transforms.select(editor, at);\n        }\n      }\n\n      for (var [node, path] of Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      })) {\n        var properties = {};\n        var newProperties = {}; // You can't set properties on the editor node.\n\n        if (path.length === 0) {\n          continue;\n        }\n\n        var hasChanges = false;\n\n        for (var k in props) {\n          if (k === 'children' || k === 'text') {\n            continue;\n          }\n\n          if (props[k] !== node[k]) {\n            hasChanges = true; // Omit new properties from the old properties list\n\n            if (node.hasOwnProperty(k)) properties[k] = node[k]; // Omit properties that have been removed from the new properties list\n\n            if (props[k] != null) newProperties[k] = props[k];\n          }\n        }\n\n        if (hasChanges) {\n          editor.apply({\n            type: 'set_node',\n            path,\n            properties,\n            newProperties\n          });\n        }\n      }\n    });\n  },\n\n  /**\r\n   * Split the nodes at a specific location.\r\n   */\n  splitNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        voids = false\n      } = options;\n      var {\n        match,\n        at = editor.selection,\n        height = 0,\n        always = false\n      } = options;\n\n      if (match == null) {\n        match = n => Editor.isBlock(editor, n);\n      }\n\n      if (Range.isRange(at)) {\n        at = deleteRange(editor, at);\n      } // If the target is a path, the default height-skipping and position\n      // counters need to account for us potentially splitting at a non-leaf.\n\n\n      if (Path.isPath(at)) {\n        var path = at;\n        var point = Editor.point(editor, path);\n        var [parent] = Editor.parent(editor, path);\n\n        match = n => n === parent;\n\n        height = point.path.length - path.length + 1;\n        at = point;\n        always = true;\n      }\n\n      if (!at) {\n        return;\n      }\n\n      var beforeRef = Editor.pointRef(editor, at, {\n        affinity: 'backward'\n      });\n      var [highest] = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n\n      if (!highest) {\n        return;\n      }\n\n      var voidMatch = Editor.void(editor, {\n        at,\n        mode: 'highest'\n      });\n      var nudge = 0;\n\n      if (!voids && voidMatch) {\n        var [voidNode, voidPath] = voidMatch;\n\n        if (Element.isElement(voidNode) && editor.isInline(voidNode)) {\n          var after = Editor.after(editor, voidPath);\n\n          if (!after) {\n            var text = {\n              text: ''\n            };\n            var afterPath = Path.next(voidPath);\n            Transforms.insertNodes(editor, text, {\n              at: afterPath,\n              voids\n            });\n            after = Editor.point(editor, afterPath);\n          }\n\n          at = after;\n          always = true;\n        }\n\n        var siblingHeight = at.path.length - voidPath.length;\n        height = siblingHeight + 1;\n        always = true;\n      }\n\n      var afterRef = Editor.pointRef(editor, at);\n      var depth = at.path.length - height;\n      var [, highestPath] = highest;\n      var lowestPath = at.path.slice(0, depth);\n      var position = height === 0 ? at.offset : at.path[depth] + nudge;\n\n      for (var [node, _path2] of Editor.levels(editor, {\n        at: lowestPath,\n        reverse: true,\n        voids\n      })) {\n        var split = false;\n\n        if (_path2.length < highestPath.length || _path2.length === 0 || !voids && Editor.isVoid(editor, node)) {\n          break;\n        }\n\n        var _point = beforeRef.current;\n        var isEnd = Editor.isEnd(editor, _point, _path2);\n\n        if (always || !beforeRef || !Editor.isEdge(editor, _point, _path2)) {\n          split = true;\n          var properties = Node.extractProps(node);\n          editor.apply({\n            type: 'split_node',\n            path: _path2,\n            position,\n            properties\n          });\n        }\n\n        position = _path2[_path2.length - 1] + (split || isEnd ? 1 : 0);\n      }\n\n      if (options.at == null) {\n        var _point2 = afterRef.current || Editor.end(editor, []);\n\n        Transforms.select(editor, _point2);\n      }\n\n      beforeRef.unref();\n      afterRef.unref();\n    });\n  },\n\n  /**\r\n   * Unset properties on the nodes at a location.\r\n   */\n  unsetNodes(editor, props) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!Array.isArray(props)) {\n      props = [props];\n    }\n\n    var obj = {};\n\n    for (var key of props) {\n      obj[key] = null;\n    }\n\n    Transforms.setNodes(editor, obj, options);\n  },\n\n  /**\r\n   * Unwrap the nodes at a location from a parent node, splitting the parent if\r\n   * necessary to ensure that only the content in the range is unwrapped.\r\n   */\n  unwrapNodes(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection,\n        match\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        match = Path.isPath(at) ? matchPath(editor, at) : n => Editor.isBlock(editor, n);\n      }\n\n      if (Path.isPath(at)) {\n        at = Editor.range(editor, at);\n      }\n\n      var rangeRef = Range.isRange(at) ? Editor.rangeRef(editor, at) : null;\n      var matches = Editor.nodes(editor, {\n        at,\n        match,\n        mode,\n        voids\n      });\n      var pathRefs = Array.from(matches, _ref5 => {\n        var [, p] = _ref5;\n        return Editor.pathRef(editor, p);\n      } // unwrapNode will call liftNode which does not support splitting the node when nested.\n      // If we do not reverse the order and call it from top to the bottom, it will remove all blocks\n      // that wrap target node. So we reverse the order.\n      ).reverse();\n\n      var _loop = function _loop(pathRef) {\n        var path = pathRef.unref();\n        var [node] = Editor.node(editor, path);\n        var range = Editor.range(editor, path);\n\n        if (split && rangeRef) {\n          range = Range.intersection(rangeRef.current, range);\n        }\n\n        Transforms.liftNodes(editor, {\n          at: range,\n          match: n => Element.isAncestor(node) && node.children.includes(n),\n          voids\n        });\n      };\n\n      for (var pathRef of pathRefs) {\n        _loop(pathRef);\n      }\n\n      if (rangeRef) {\n        rangeRef.unref();\n      }\n    });\n  },\n\n  /**\r\n   * Wrap the nodes at a location in a new container node, splitting the edges\r\n   * of the range first to ensure that only the content in the range is wrapped.\r\n   */\n  wrapNodes(editor, element) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        mode = 'lowest',\n        split = false,\n        voids = false\n      } = options;\n      var {\n        match,\n        at = editor.selection\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (match == null) {\n        if (Path.isPath(at)) {\n          match = matchPath(editor, at);\n        } else if (editor.isInline(element)) {\n          match = n => Editor.isInline(editor, n) || Text.isText(n);\n        } else {\n          match = n => Editor.isBlock(editor, n);\n        }\n      }\n\n      if (split && Range.isRange(at)) {\n        var [start, end] = Range.edges(at);\n        var rangeRef = Editor.rangeRef(editor, at, {\n          affinity: 'inward'\n        });\n        Transforms.splitNodes(editor, {\n          at: end,\n          match,\n          voids\n        });\n        Transforms.splitNodes(editor, {\n          at: start,\n          match,\n          voids\n        });\n        at = rangeRef.unref();\n\n        if (options.at == null) {\n          Transforms.select(editor, at);\n        }\n      }\n\n      var roots = Array.from(Editor.nodes(editor, {\n        at,\n        match: editor.isInline(element) ? n => Editor.isBlock(editor, n) : n => Editor.isEditor(n),\n        mode: 'lowest',\n        voids\n      }));\n\n      for (var [, rootPath] of roots) {\n        var a = Range.isRange(at) ? Range.intersection(at, Editor.range(editor, rootPath)) : at;\n\n        if (!a) {\n          continue;\n        }\n\n        var matches = Array.from(Editor.nodes(editor, {\n          at: a,\n          match,\n          mode,\n          voids\n        }));\n\n        if (matches.length > 0) {\n          var _ret = function () {\n            var [first] = matches;\n            var last = matches[matches.length - 1];\n            var [, firstPath] = first;\n            var [, lastPath] = last;\n\n            if (firstPath.length === 0 && lastPath.length === 0) {\n              // if there's no matching parent - usually means the node is an editor - don't do anything\n              return \"continue\";\n            }\n\n            var commonPath = Path.equals(firstPath, lastPath) ? Path.parent(firstPath) : Path.common(firstPath, lastPath);\n            var range = Editor.range(editor, firstPath, lastPath);\n            var commonNodeEntry = Editor.node(editor, commonPath);\n            var [commonNode] = commonNodeEntry;\n            var depth = commonPath.length + 1;\n            var wrapperPath = Path.next(lastPath.slice(0, depth));\n\n            var wrapper = _objectSpread$2(_objectSpread$2({}, element), {}, {\n              children: []\n            });\n\n            Transforms.insertNodes(editor, wrapper, {\n              at: wrapperPath,\n              voids\n            });\n            Transforms.moveNodes(editor, {\n              at: range,\n              match: n => Element.isAncestor(commonNode) && commonNode.children.includes(n),\n              to: wrapperPath.concat(0),\n              voids\n            });\n          }();\n\n          if (_ret === \"continue\") continue;\n        }\n      }\n    });\n  }\n\n};\n\nvar hasSingleChildNest = (editor, node) => {\n  if (Element.isElement(node)) {\n    var element = node;\n\n    if (Editor.isVoid(editor, node)) {\n      return true;\n    } else if (element.children.length === 1) {\n      return hasSingleChildNest(editor, element.children[0]);\n    } else {\n      return false;\n    }\n  } else if (Editor.isEditor(node)) {\n    return false;\n  } else {\n    return true;\n  }\n};\n/**\r\n * Convert a range into a point by deleting it's content.\r\n */\n\n\nvar deleteRange = (editor, range) => {\n  if (Range.isCollapsed(range)) {\n    return range.anchor;\n  } else {\n    var [, end] = Range.edges(range);\n    var pointRef = Editor.pointRef(editor, end);\n    Transforms.delete(editor, {\n      at: range\n    });\n    return pointRef.unref();\n  }\n};\n\nvar matchPath = (editor, path) => {\n  var [node] = Editor.node(editor, path);\n  return n => n === node;\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar SelectionTransforms = {\n  /**\r\n   * Collapse the selection.\r\n   */\n  collapse(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      edge = 'anchor'\n    } = options;\n    var {\n      selection\n    } = editor;\n\n    if (!selection) {\n      return;\n    } else if (edge === 'anchor') {\n      Transforms.select(editor, selection.anchor);\n    } else if (edge === 'focus') {\n      Transforms.select(editor, selection.focus);\n    } else if (edge === 'start') {\n      var [start] = Range.edges(selection);\n      Transforms.select(editor, start);\n    } else if (edge === 'end') {\n      var [, end] = Range.edges(selection);\n      Transforms.select(editor, end);\n    }\n  },\n\n  /**\r\n   * Unset the selection.\r\n   */\n  deselect(editor) {\n    var {\n      selection\n    } = editor;\n\n    if (selection) {\n      editor.apply({\n        type: 'set_selection',\n        properties: selection,\n        newProperties: null\n      });\n    }\n  },\n\n  /**\r\n   * Move the selection's point forward or backward.\r\n   */\n  move(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      selection\n    } = editor;\n    var {\n      distance = 1,\n      unit = 'character',\n      reverse = false\n    } = options;\n    var {\n      edge = null\n    } = options;\n\n    if (!selection) {\n      return;\n    }\n\n    if (edge === 'start') {\n      edge = Range.isBackward(selection) ? 'focus' : 'anchor';\n    }\n\n    if (edge === 'end') {\n      edge = Range.isBackward(selection) ? 'anchor' : 'focus';\n    }\n\n    var {\n      anchor,\n      focus\n    } = selection;\n    var opts = {\n      distance,\n      unit\n    };\n    var props = {};\n\n    if (edge == null || edge === 'anchor') {\n      var point = reverse ? Editor.before(editor, anchor, opts) : Editor.after(editor, anchor, opts);\n\n      if (point) {\n        props.anchor = point;\n      }\n    }\n\n    if (edge == null || edge === 'focus') {\n      var _point = reverse ? Editor.before(editor, focus, opts) : Editor.after(editor, focus, opts);\n\n      if (_point) {\n        props.focus = _point;\n      }\n    }\n\n    Transforms.setSelection(editor, props);\n  },\n\n  /**\r\n   * Set the selection to a new value.\r\n   */\n  select(editor, target) {\n    var {\n      selection\n    } = editor;\n    target = Editor.range(editor, target);\n\n    if (selection) {\n      Transforms.setSelection(editor, target);\n      return;\n    }\n\n    if (!Range.isRange(target)) {\n      throw new Error(\"When setting the selection and the current selection is `null` you must provide at least an `anchor` and `focus`, but you passed: \".concat(JSON.stringify(target)));\n    }\n\n    editor.apply({\n      type: 'set_selection',\n      properties: selection,\n      newProperties: target\n    });\n  },\n\n  /**\r\n   * Set new properties on one of the selection's points.\r\n   */\n  setPoint(editor, props) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var {\n      selection\n    } = editor;\n    var {\n      edge = 'both'\n    } = options;\n\n    if (!selection) {\n      return;\n    }\n\n    if (edge === 'start') {\n      edge = Range.isBackward(selection) ? 'focus' : 'anchor';\n    }\n\n    if (edge === 'end') {\n      edge = Range.isBackward(selection) ? 'anchor' : 'focus';\n    }\n\n    var {\n      anchor,\n      focus\n    } = selection;\n    var point = edge === 'anchor' ? anchor : focus;\n    Transforms.setSelection(editor, {\n      [edge === 'anchor' ? 'anchor' : 'focus']: _objectSpread$1(_objectSpread$1({}, point), props)\n    });\n  },\n\n  /**\r\n   * Set new properties on the selection.\r\n   */\n  setSelection(editor, props) {\n    var {\n      selection\n    } = editor;\n    var oldProps = {};\n    var newProps = {};\n\n    if (!selection) {\n      return;\n    }\n\n    for (var k in props) {\n      if (k === 'anchor' && props.anchor != null && !Point.equals(props.anchor, selection.anchor) || k === 'focus' && props.focus != null && !Point.equals(props.focus, selection.focus) || k !== 'anchor' && k !== 'focus' && props[k] !== selection[k]) {\n        oldProps[k] = selection[k];\n        newProps[k] = props[k];\n      }\n    }\n\n    if (Object.keys(oldProps).length > 0) {\n      editor.apply({\n        type: 'set_selection',\n        properties: oldProps,\n        newProperties: newProps\n      });\n    }\n  }\n\n};\n\nvar TextTransforms = {\n  /**\r\n   * Delete content in the editor.\r\n   */\n  delete(editor) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        reverse = false,\n        unit = 'character',\n        distance = 1,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection,\n        hanging = false\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (Range.isRange(at) && Range.isCollapsed(at)) {\n        at = at.anchor;\n      }\n\n      if (Point.isPoint(at)) {\n        var furthestVoid = Editor.void(editor, {\n          at,\n          mode: 'highest'\n        });\n\n        if (!voids && furthestVoid) {\n          var [, voidPath] = furthestVoid;\n          at = voidPath;\n        } else {\n          var opts = {\n            unit,\n            distance\n          };\n          var target = reverse ? Editor.before(editor, at, opts) || Editor.start(editor, []) : Editor.after(editor, at, opts) || Editor.end(editor, []);\n          at = {\n            anchor: at,\n            focus: target\n          };\n          hanging = true;\n        }\n      }\n\n      if (Path.isPath(at)) {\n        Transforms.removeNodes(editor, {\n          at,\n          voids\n        });\n        return;\n      }\n\n      if (Range.isCollapsed(at)) {\n        return;\n      }\n\n      if (!hanging) {\n        var [, _end] = Range.edges(at);\n        var endOfDoc = Editor.end(editor, []);\n\n        if (!Point.equals(_end, endOfDoc)) {\n          at = Editor.unhangRange(editor, at, {\n            voids\n          });\n        }\n      }\n\n      var [start, end] = Range.edges(at);\n      var startBlock = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at: start,\n        voids\n      });\n      var endBlock = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at: end,\n        voids\n      });\n      var isAcrossBlocks = startBlock && endBlock && !Path.equals(startBlock[1], endBlock[1]);\n      var isSingleText = Path.equals(start.path, end.path);\n      var startVoid = voids ? null : Editor.void(editor, {\n        at: start,\n        mode: 'highest'\n      });\n      var endVoid = voids ? null : Editor.void(editor, {\n        at: end,\n        mode: 'highest'\n      }); // If the start or end points are inside an inline void, nudge them out.\n\n      if (startVoid) {\n        var before = Editor.before(editor, start);\n\n        if (before && startBlock && Path.isAncestor(startBlock[1], before.path)) {\n          start = before;\n        }\n      }\n\n      if (endVoid) {\n        var after = Editor.after(editor, end);\n\n        if (after && endBlock && Path.isAncestor(endBlock[1], after.path)) {\n          end = after;\n        }\n      } // Get the highest nodes that are completely inside the range, as well as\n      // the start and end nodes.\n\n\n      var matches = [];\n      var lastPath;\n\n      for (var entry of Editor.nodes(editor, {\n        at,\n        voids\n      })) {\n        var [node, path] = entry;\n\n        if (lastPath && Path.compare(path, lastPath) === 0) {\n          continue;\n        }\n\n        if (!voids && Editor.isVoid(editor, node) || !Path.isCommon(path, start.path) && !Path.isCommon(path, end.path)) {\n          matches.push(entry);\n          lastPath = path;\n        }\n      }\n\n      var pathRefs = Array.from(matches, _ref => {\n        var [, p] = _ref;\n        return Editor.pathRef(editor, p);\n      });\n      var startRef = Editor.pointRef(editor, start);\n      var endRef = Editor.pointRef(editor, end);\n\n      if (!isSingleText && !startVoid) {\n        var _point = startRef.current;\n        var [_node] = Editor.leaf(editor, _point);\n        var {\n          path: _path\n        } = _point;\n        var {\n          offset\n        } = start;\n\n        var text = _node.text.slice(offset);\n\n        if (text.length > 0) editor.apply({\n          type: 'remove_text',\n          path: _path,\n          offset,\n          text\n        });\n      }\n\n      for (var pathRef of pathRefs) {\n        var _path2 = pathRef.unref();\n\n        Transforms.removeNodes(editor, {\n          at: _path2,\n          voids\n        });\n      }\n\n      if (!endVoid) {\n        var _point2 = endRef.current;\n        var [_node2] = Editor.leaf(editor, _point2);\n        var {\n          path: _path3\n        } = _point2;\n\n        var _offset = isSingleText ? start.offset : 0;\n\n        var _text = _node2.text.slice(_offset, end.offset);\n\n        if (_text.length > 0) editor.apply({\n          type: 'remove_text',\n          path: _path3,\n          offset: _offset,\n          text: _text\n        });\n      }\n\n      if (!isSingleText && isAcrossBlocks && endRef.current && startRef.current) {\n        Transforms.mergeNodes(editor, {\n          at: endRef.current,\n          hanging: true,\n          voids\n        });\n      }\n\n      var point = reverse ? startRef.unref() || endRef.unref() : endRef.unref() || startRef.unref();\n\n      if (options.at == null && point) {\n        Transforms.select(editor, point);\n      }\n    });\n  },\n\n  /**\r\n   * Insert a fragment at a specific location in the editor.\r\n   */\n  insertFragment(editor, fragment) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        hanging = false,\n        voids = false\n      } = options;\n      var {\n        at = editor.selection\n      } = options;\n\n      if (!fragment.length) {\n        return;\n      }\n\n      if (!at) {\n        return;\n      } else if (Range.isRange(at)) {\n        if (!hanging) {\n          at = Editor.unhangRange(editor, at);\n        }\n\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var [, end] = Range.edges(at);\n\n          if (!voids && Editor.void(editor, {\n            at: end\n          })) {\n            return;\n          }\n\n          var pointRef = Editor.pointRef(editor, end);\n          Transforms.delete(editor, {\n            at\n          });\n          at = pointRef.unref();\n        }\n      } else if (Path.isPath(at)) {\n        at = Editor.start(editor, at);\n      }\n\n      if (!voids && Editor.void(editor, {\n        at\n      })) {\n        return;\n      } // If the insert point is at the edge of an inline node, move it outside\n      // instead since it will need to be split otherwise.\n\n\n      var inlineElementMatch = Editor.above(editor, {\n        at,\n        match: n => Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n\n      if (inlineElementMatch) {\n        var [, _inlinePath] = inlineElementMatch;\n\n        if (Editor.isEnd(editor, at, _inlinePath)) {\n          var after = Editor.after(editor, _inlinePath);\n          at = after;\n        } else if (Editor.isStart(editor, at, _inlinePath)) {\n          var before = Editor.before(editor, _inlinePath);\n          at = before;\n        }\n      }\n\n      var blockMatch = Editor.above(editor, {\n        match: n => Editor.isBlock(editor, n),\n        at,\n        voids\n      });\n      var [, blockPath] = blockMatch;\n      var isBlockStart = Editor.isStart(editor, at, blockPath);\n      var isBlockEnd = Editor.isEnd(editor, at, blockPath);\n      var isBlockEmpty = isBlockStart && isBlockEnd;\n      var mergeStart = !isBlockStart || isBlockStart && isBlockEnd;\n      var mergeEnd = !isBlockEnd;\n      var [, firstPath] = Node.first({\n        children: fragment\n      }, []);\n      var [, lastPath] = Node.last({\n        children: fragment\n      }, []);\n      var matches = [];\n\n      var matcher = _ref2 => {\n        var [n, p] = _ref2;\n        var isRoot = p.length === 0;\n\n        if (isRoot) {\n          return false;\n        }\n\n        if (isBlockEmpty) {\n          return true;\n        }\n\n        if (mergeStart && Path.isAncestor(p, firstPath) && Element.isElement(n) && !editor.isVoid(n) && !editor.isInline(n)) {\n          return false;\n        }\n\n        if (mergeEnd && Path.isAncestor(p, lastPath) && Element.isElement(n) && !editor.isVoid(n) && !editor.isInline(n)) {\n          return false;\n        }\n\n        return true;\n      };\n\n      for (var entry of Node.nodes({\n        children: fragment\n      }, {\n        pass: matcher\n      })) {\n        if (matcher(entry)) {\n          matches.push(entry);\n        }\n      }\n\n      var starts = [];\n      var middles = [];\n      var ends = [];\n      var starting = true;\n      var hasBlocks = false;\n\n      for (var [node] of matches) {\n        if (Element.isElement(node) && !editor.isInline(node)) {\n          starting = false;\n          hasBlocks = true;\n          middles.push(node);\n        } else if (starting) {\n          starts.push(node);\n        } else {\n          ends.push(node);\n        }\n      }\n\n      var [inlineMatch] = Editor.nodes(editor, {\n        at,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n      var [, inlinePath] = inlineMatch;\n      var isInlineStart = Editor.isStart(editor, at, inlinePath);\n      var isInlineEnd = Editor.isEnd(editor, at, inlinePath);\n      var middleRef = Editor.pathRef(editor, isBlockEnd ? Path.next(blockPath) : blockPath);\n      var endRef = Editor.pathRef(editor, isInlineEnd ? Path.next(inlinePath) : inlinePath);\n      var blockPathRef = Editor.pathRef(editor, blockPath);\n      Transforms.splitNodes(editor, {\n        at,\n        match: n => hasBlocks ? Editor.isBlock(editor, n) : Text.isText(n) || Editor.isInline(editor, n),\n        mode: hasBlocks ? 'lowest' : 'highest',\n        voids\n      });\n      var startRef = Editor.pathRef(editor, !isInlineStart || isInlineStart && isInlineEnd ? Path.next(inlinePath) : inlinePath);\n      Transforms.insertNodes(editor, starts, {\n        at: startRef.current,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n\n      if (isBlockEmpty && middles.length) {\n        Transforms.delete(editor, {\n          at: blockPathRef.unref(),\n          voids\n        });\n      }\n\n      Transforms.insertNodes(editor, middles, {\n        at: middleRef.current,\n        match: n => Editor.isBlock(editor, n),\n        mode: 'lowest',\n        voids\n      });\n      Transforms.insertNodes(editor, ends, {\n        at: endRef.current,\n        match: n => Text.isText(n) || Editor.isInline(editor, n),\n        mode: 'highest',\n        voids\n      });\n\n      if (!options.at) {\n        var path;\n\n        if (ends.length > 0) {\n          path = Path.previous(endRef.current);\n        } else if (middles.length > 0) {\n          path = Path.previous(middleRef.current);\n        } else {\n          path = Path.previous(startRef.current);\n        }\n\n        var _end2 = Editor.end(editor, path);\n\n        Transforms.select(editor, _end2);\n      }\n\n      startRef.unref();\n      middleRef.unref();\n      endRef.unref();\n    });\n  },\n\n  /**\r\n   * Insert a string of text in the Editor.\r\n   */\n  insertText(editor, text) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    Editor.withoutNormalizing(editor, () => {\n      var {\n        voids = false\n      } = options;\n      var {\n        at = editor.selection\n      } = options;\n\n      if (!at) {\n        return;\n      }\n\n      if (Path.isPath(at)) {\n        at = Editor.range(editor, at);\n      }\n\n      if (Range.isRange(at)) {\n        if (Range.isCollapsed(at)) {\n          at = at.anchor;\n        } else {\n          var end = Range.end(at);\n\n          if (!voids && Editor.void(editor, {\n            at: end\n          })) {\n            return;\n          }\n\n          var start = Range.start(at);\n          var pointRef = Editor.pointRef(editor, start);\n          Transforms.delete(editor, {\n            at,\n            voids\n          });\n          at = pointRef.unref();\n          Transforms.setSelection(editor, {\n            anchor: at,\n            focus: at\n          });\n        }\n      }\n\n      if (!voids && Editor.void(editor, {\n        at\n      })) {\n        return;\n      }\n\n      var {\n        path,\n        offset\n      } = at;\n      if (text.length > 0) editor.apply({\n        type: 'insert_text',\n        path,\n        offset,\n        text\n      });\n    });\n  }\n\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nvar Transforms = _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, GeneralTransforms), NodeTransforms), SelectionTransforms), TextTransforms);\n\nexport { Editor, Element, Location, Node, Operation, Path, PathRef, Point, PointRef, Range, RangeRef, Span, Text, Transforms, createEditor };\n//# sourceMappingURL=index.es.js.map\n","<template>\r\n  <a-modal\r\n    :title=\"t('title_content')\"\r\n    width=\"880px\"\r\n    v-model:open=\"visible\"\r\n    @ok=\"save\"\r\n  >\r\n    <a-alert type=\"info\" class=\"zm-alert-info\">\r\n      <template #message>\r\n        {{ t('msg_rich_text_content_intro') }}\r\n      </template>\r\n    </a-alert>\r\n\r\n    <div class=\"editor-box\">\r\n      <Toolbar\r\n        style=\"border-bottom: 1px solid #ccc;\"\r\n        :editor=\"editorRef\"\r\n        :defaultConfig=\"toolbarConfig\"\r\n        :mode=\"mode\"\r\n      />\r\n      <Editor\r\n        style=\"height: 480px; overflow-y: hidden;\"\r\n        v-model=\"valueHtml\"\r\n        :defaultConfig=\"editorConfig\"\r\n        :mode=\"mode\"\r\n        @onCreated=\"handleCreated\"\r\n        @onChange=\"handleChange\"\r\n      />\r\n    </div>\r\n\r\n    <div v-if=\"showVariable\"\r\n         :style=\"varDialogStyle\"\r\n         class=\"dropdown-list\"\r\n         ref=\"dropdownList\"\r\n    >\r\n      <CascadePanel\r\n        :options=\"variableOptions\"\r\n        @change=\"onSelectOption\"\r\n        @direction-change=\"handleDirectionChange\">\r\n        <template #option=\"{ label, payload }\">\r\n          <div class=\"field-list-item\">\r\n            <div class=\"field-label\">{{ label }}</div>\r\n            <div class=\"field-type\">{{ payload.typ }}</div>\r\n          </div>\r\n        </template>\r\n      </CascadePanel>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, shallowRef, onBeforeUnmount, toRaw, watch} from 'vue'\r\nimport '@wangeditor/editor/dist/css/style.css'\r\nimport {Editor, Toolbar} from '@wangeditor/editor-for-vue'\r\nimport {Editor as SlateEditor, Range, Transforms, Text} from 'slate'\r\nimport CascadePanel from \"@/views/workflow/components/at-input/cascade-panel.vue\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport {getBase64, getTreeOptions} from \"@/utils/index.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.official-draft.components.draft-news-cont')\r\n\r\n\r\nconst emit = defineEmits(['change'])\r\nconst props = defineProps({\r\n  appData: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  },\r\n  defaultSelectedList: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n})\r\n\r\nconst visible = ref(false)\r\nconst editorRef = shallowRef()\r\nconst activeEditor = shallowRef(null)\r\nconst mode = ref('default')\r\nconst valueHtml = ref('')\r\nconst toolbarConfig = ref({\r\n  excludeKeys: [\r\n    \"insertTable\",\r\n    \"codeBlock\",\r\n    \"uploadVideo\",\r\n    \"group-video\",\r\n  ]\r\n})\r\nconst editorConfig = {\r\n  placeholder: t('ph_input_content'),\r\n  MENU_CONF: {\r\n    uploadImage: {\r\n      async customUpload(file, insertFn) {\r\n        const base64 = await getBase64(file)\r\n        const res = await runPlugin({\r\n          name: 'official_draft',\r\n          action: \"default/exec\",\r\n          params: JSON.stringify({\r\n            business: 'upload_image',\r\n            arguments: {\r\n              ...props.appData,\r\n              media: base64\r\n            }\r\n          })\r\n        })\r\n        insertFn(res?.data?.url)\r\n      },\r\n    }\r\n  }\r\n}\r\nconst showVariable = ref(false)\r\nconst varDialogStyle = ref({})\r\nconst showOptions = ref([])\r\nconst tagAllData = ref([])\r\nconst selectedList = ref([])\r\nconst selectedIdSet = ref(new Set())\r\n\r\nonBeforeUnmount(() => {\r\n  const editor = editorRef.value\r\n  if (editor == null) return\r\n  editor.destroy()\r\n})\r\n\r\nfunction show(value = '', tags = []) {\r\n  initData(value, tags)\r\n  visible.value = true\r\n}\r\n\r\nfunction initData(value, tags) {\r\n  let treeOptions = getTreeOptions(props.variableOptions);\r\n  selectedList.value = tags\r\n  tagAllData.value = [...tags, ...treeOptions].filter(item => item && item.value && item.value != '' && item.typ !== 'node');\r\n  // 记录已经替换过的的value\r\n  const replacedValues = new Set();\r\n  for (let opt of  tagAllData.value) {\r\n    value = decodeVariable(value, opt, replacedValues)\r\n  }\r\n  valueHtml.value = value\r\n}\r\n\r\nfunction decodeVariable(html, opt, replacedValues) {\r\n  const regex = new RegExp(`(${opt.value})`, 'g');\r\n  if (!replacedValues.has(opt.value) && regex.test(html)) {\r\n    console.log('open')\r\n    let text = opt.node_name + '.' + opt.text\r\n    text = text.replace(/\\./g, '/')\r\n    html = html.replace(regex, `<a href=\"zm-variable:${opt.value}\" target=\"_blank\"><strong>${text}</strong></a>`)\r\n    replacedValues.add(opt.value)\r\n  }\r\n  return html\r\n}\r\n\r\nfunction handleCreated(editor) {\r\n  editorRef.value = editor\r\n}\r\n\r\nfunction handleChange(editor) {\r\n  const {selection} = editor\r\n  if (!selection || !Range.isCollapsed(selection)) {\r\n    showVariable.value = false\r\n    return\r\n  }\r\n\r\n  const path = selection.focus.path\r\n  const offset = selection.focus.offset\r\n  const text = SlateEditor.string(editor, path)\r\n\r\n  // 光标前一个字符\r\n  const charBefore = text[offset - 1]\r\n  if (charBefore === '/') {\r\n    activeEditor.value = editor\r\n    showVariable.value = true\r\n    updateDialogPosition(editor)\r\n  } else {\r\n    showVariable.value = false\r\n  }\r\n}\r\n\r\n\r\n// 获取当前光标定位\r\nfunction getCaretRectSafe() {\r\n  const selection = window.getSelection()\r\n  if (!selection || selection.rangeCount === 0) return null\r\n\r\n  const range = selection.getRangeAt(0)\r\n  if (!range.collapsed) return null\r\n\r\n  let rect = range.getClientRects()[0]\r\n  if (rect) return rect\r\n\r\n  // ====== 兜底方案 ======\r\n  const span = document.createElement('span')\r\n  span.textContent = '\\u200b' // 零宽字符\r\n  span.style.display = 'inline-block'\r\n\r\n  range.insertNode(span)\r\n  rect = span.getBoundingClientRect()\r\n  span.remove()\r\n  return rect\r\n}\r\n\r\nfunction updateDialogPosition(editor) {\r\n  const rect = getCaretRectSafe()\r\n  if (!rect) return\r\n  const left = rect.left + window.scrollX\r\n  const top = rect.bottom + window.scrollY + 6\r\n  varDialogStyle.value = `left:${left}px; top:${top}px;`;\r\n}\r\n\r\nfunction onSelectOption(value, selectedValuePath, selectedPath) {\r\n  let item = selectedPath[selectedPath.length - 1];\r\n  delete item['children'];\r\n  selectOption(item)\r\n}\r\n\r\nfunction selectOption(opt, isInit = false) {\r\n  if (!opt) return;\r\n  // 处理用户选择逻辑\r\n  showVariable.value = false;\r\n  let text = opt.node_name + '.' + opt.text;\r\n  text = text.replace(/\\./g, '/')\r\n  const dataSet = {\r\n    id: opt.id,\r\n    label: opt.label,\r\n    value: opt.value,\r\n    text: opt.text,\r\n    index: selectedList.value.length,\r\n  };\r\n  selectedList.value.push(opt);\r\n  const set = new Set(selectedIdSet.value)\r\n  set.add(opt.value)\r\n  selectedIdSet.value = set\r\n\r\n  if (!isInit) {\r\n    insertAtCaret(text, dataSet);\r\n  }\r\n}\r\n\r\nfunction insertAtCaret(text, dataSet) {\r\n  const editor = activeEditor.value\r\n  const {selection} = editor\r\n  if (!selection) return\r\n\r\n  // 如果有选中内容，先删\r\n  if (!Range.isCollapsed(selection)) SlateEditor.deleteFragment(editor)\r\n\r\n  // 删除触发字符 `/`\r\n  SlateEditor.deleteBackward(editor, 'character')\r\n\r\n  SlateEditor.insertNode(editor, {\r\n    type: 'link',\r\n    url: `zm-variable:${dataSet.value}`,\r\n    children: [\r\n      {text, bold: true}\r\n    ]\r\n  })\r\n  // 光标落点\r\n  SlateEditor.insertText(editor, ' ')\r\n}\r\n\r\nfunction initShowOptionList() {\r\n  showOptions.value = props.variableOptions.filter((opt) => {\r\n    if (this.atText) {\r\n      return opt.label.startsWith(this.atText);\r\n    }\r\n    if (this.canRepeat) return true;\r\n    return !this.selectedIdSet.has(opt.id + \"\");\r\n  });\r\n}\r\n\r\nfunction handleDirectionChange(direction, width) {\r\n  const leftMatch = varDialogStyle.value.match(/left:\\s*(-?\\d+\\.?\\d*)px/);\r\n  const topMatch = varDialogStyle.value.match(/top:\\s*(-?\\d+\\.?\\d*)px/);\r\n\r\n  if (!leftMatch || !topMatch) return;\r\n\r\n  const currentLeft = parseFloat(leftMatch[1]);\r\n  const currentTop = parseFloat(topMatch[1]);\r\n  let newLeft;\r\n\r\n  if (direction === 'left') {\r\n    newLeft = currentLeft - width;\r\n  } else {\r\n    newLeft = currentLeft + width;\r\n  }\r\n\r\n  varDialogStyle.value = `left:${newLeft}px; top:${currentTop}px;`;\r\n}\r\n\r\nfunction unwrapRoot(html) {\r\n  if (typeof html !== 'string') return ''\r\n  const match = html.match(/^<div[^>]*class=[\"'][^\"']*\\bzm-editor-root\\b[^\"']*[\"'][^>]*>([\\s\\S]*)<\\/div>$/)\r\n  return match ? match[1] : html\r\n}\r\n\r\nfunction save() {\r\n  let html = toRaw(valueHtml.value)\r\n  let selectedListMap = {};\r\n  selectedList.value.forEach(item => {\r\n    if(!selectedListMap[item.value] && html.indexOf(item.value) > -1){\r\n      selectedListMap[item.value] = item;\r\n    }\r\n  });\r\n  let mySelectedList = Object.values(selectedListMap);\r\n  html = unwrapRoot(html)\r\n  html = html.replace(/<a[^>]*href=\"zm-variable:([^\"]+)\"[^>]*>[\\s\\S]*?<\\/a>/g, '$1')\r\n  emit('change', html, toRaw(mySelectedList))\r\n  visible.value = false\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.editor-box {\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  margin-top: 16px;\r\n\r\n  &.w-e-full-screen-container {\r\n    z-index: 9999;\r\n  }\r\n}\r\n\r\n.dropdown-list {\r\n  position: fixed;\r\n  padding: 0;\r\n  margin: 0;\r\n  background-color: #fff;\r\n  z-index: 999999;\r\n  min-width: 180px;\r\n  overflow: hidden;\r\n  user-select: none;\r\n  border-radius: 8px;\r\n  box-shadow: 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05);\r\n\r\n  .dropdown-list-nodata {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    height: 100%;\r\n    font-size: 13px;\r\n    padding: 8px;\r\n  }\r\n\r\n  .dropdown-list-item {\r\n    padding: 8px;\r\n    cursor: pointer;\r\n    background: #fff;\r\n\r\n    &:hover {\r\n      background-color: rgba(0, 0, 0, 0.04) !important;\r\n    }\r\n\r\n    &.active {\r\n      background-color: rgba(0, 0, 0, 0.09) !important;\r\n    }\r\n  }\r\n\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 0px;\r\n    height: 0px;\r\n  }\r\n\r\n  /*定义滚动条轨道 内阴影+圆角*/\r\n\r\n  &::-webkit-scrollbar-track {\r\n    border-radius: 0px;\r\n    background-color: #fafafa;\r\n  }\r\n\r\n  /*定义滑块 内阴影+圆角*/\r\n\r\n  &::-webkit-scrollbar-thumb {\r\n    border-radius: 0px;\r\n    background: rgb(191, 191, 191);\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <a-modal\r\n    :title=\"t('title_content')\"\r\n    width=\"880px\"\r\n    v-model:open=\"visible\"\r\n    @ok=\"save\"\r\n  >\r\n    <a-alert type=\"info\" class=\"zm-alert-info\">\r\n      <template #message>\r\n        {{ t('msg_rich_text_content_intro') }}\r\n      </template>\r\n    </a-alert>\r\n    <AtInput\r\n      style=\"margin-top: 16px;\"\r\n      type=\"textarea\"\r\n      inputStyle=\"height: 420px;\"\r\n      :options=\"variableOptions\"\r\n      :defaultSelectedList=\"tags || []\"\r\n      :defaultValue=\"value\"\r\n      ref=\"atInputRef\"\r\n      @open=\"emit('updateVar')\"\r\n      @change=\"changeValue\"\r\n      :placeholder=\"t('ph_input_content')\"\r\n    >\r\n      <template #option=\"{ label, payload }\">\r\n        <div class=\"field-list-item\">\r\n          <div class=\"field-label\">{{ label }}</div>\r\n          <div class=\"field-type\">{{ payload.typ }}</div>\r\n        </div>\r\n      </template>\r\n    </AtInput>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, shallowRef, onBeforeUnmount, toRaw, watch} from 'vue'\r\nimport '@wangeditor/editor/dist/css/style.css'\r\nimport {Editor, Toolbar} from '@wangeditor/editor-for-vue'\r\nimport {Editor as SlateEditor, Range, Transforms, Text} from 'slate'\r\nimport CascadePanel from \"@/views/workflow/components/at-input/cascade-panel.vue\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport {getBase64, getTreeOptions} from \"@/utils/index.js\";\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.official-draft.components.draft-newspic-cont')\r\n\r\n\r\nconst emit = defineEmits(['change', 'updateVar'])\r\nconst props = defineProps({\r\n  appData: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  },\r\n  defaultSelectedList: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n})\r\n\r\nconst visible = ref(false)\r\nconst value = ref('')\r\nconst tags = ref([])\r\n\r\nfunction show(val = '', _tags = []) {\r\n  value.value = val\r\n  tags.value = _tags\r\n  visible.value = true\r\n}\r\n\r\nfunction changeValue(val, _tags ) {\r\n  value.value = val\r\n  tags.value = _tags\r\n}\r\n\r\nfunction save() {\r\n  emit('change', toRaw(value.value), toRaw(tags.value))\r\n  visible.value = false\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n","<template>\r\n  <div class=\"article-container\">\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/setting-icon.svg\" class=\"title-icon\"/> {{ t('title_basic_info') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"formState.app_id\"\r\n            :placeholder=\"t('ph_select_official_account')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"appChange\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"app in apps\"\r\n              :key=\"app.app_id\"\r\n              :name=\"app.app_name\"\r\n              :secret=\"app.app_secret\"\r\n            >\r\n              {{ app.app_name }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_article_type') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-radio-group v-model:value=\"formState.article_type\" @change=\"articleTypeChange\">\r\n            <a-radio value=\"news\">{{ t('opt_news') }}</a-radio>\r\n            <a-radio value=\"newspic\">{{ t('opt_newspic') }}</a-radio>\r\n          </a-radio-group>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"node-options article-form-box\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/> {{ t('title_input') }}</div>\r\n        <a href=\"https://developers.weixin.qq.com/doc/subscription/api/draftbox/draftmanage/api_draft_add.html\"\r\n           style=\"font-weight: 400;\"\r\n           target=\"_blank\">{{ t('view_help_doc') }}</a>\r\n      </div>\r\n      <div v-if=\"actionName === 'add_draft'\" class=\"options-item\">\r\n        <div class=\"news-tabs\">\r\n          <div\r\n            v-for=\"(article, i) in formState.articles\"\r\n            :key=\"i\"\r\n            :class=\"['news-item', {active: i == currentNewsIndex}]\"\r\n            @click=\"articleChange(article, i)\"\r\n          >\r\n            {{ i == 0 ? t('main_news') : `${t('secondary_news')} ${i}` }}\r\n            <CloseOutlined v-if=\"formState.articles.length > 1\" class=\"del-icon\" @click.stop=\"delNews(i)\"/>\r\n          </div>\r\n          <div v-if=\"formState.articles.length < 8\" class=\"news-item\" @click=\"addNews\">\r\n            <PlusOutlined/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <template v-else>\r\n        <div class=\"options-item baseline is-required\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_article_id') }}</div>\r\n          </div>\r\n          <div style=\"width: 100%;\">\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 33px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"formState.tag_map?.media_id || []\"\r\n              :defaultValue=\"formState.media_id\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(text, selectedList) => changeStateFieldValue('media_id', text, selectedList)\"\r\n              :placeholder=\"t('ph_input_content_with_var')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n            <div class=\"desc\">{{ t('desc_article_media_id') }}</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item baseline is-required\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_article_position') }}</div>\r\n          </div>\r\n          <div>\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 33px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"formState.tag_map?.index || []\"\r\n              :defaultValue=\"formState.index\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(text, selectedList) => changeStateFieldValue('index', text, selectedList)\"\r\n              :placeholder=\"t('ph_input_content_with_var')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n            <div class=\"desc\">{{ t('desc_article_position') }}</div>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_title') }}</div>\r\n        </div>\r\n        <AtInput\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 33px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"currentNews.tag_map?.title || []\"\r\n          :defaultValue=\"currentNews.title\"\r\n          ref=\"atInputRef\"\r\n          @open=\"emit('updateVar')\"\r\n          @change=\"(text, selectedList) => changeFieldValue('title', text, selectedList)\"\r\n          :placeholder=\"t('ph_input_content_with_var')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtInput>\r\n      </div>\r\n      <template v-if=\"currentNews.article_type === 'news'\">\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_author') }}</div>\r\n          </div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 33px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"currentNews.tag_map?.author || []\"\r\n            :defaultValue=\"currentNews.author\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('author', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content_with_var')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_digest') }}</div>\r\n          </div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 33px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"currentNews.tag_map?.digest || []\"\r\n            :defaultValue=\"currentNews.digest\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('digest', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content_with_var')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n      </template>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_content') }}</div>\r\n        </div>\r\n        <div class=\"cont-box\">\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 33px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"currentNews.tag_map?.content || []\"\r\n            :defaultValue=\"currentNews.content\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('content', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content_with_var')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n          <a-tooltip :title=\"t('tooltip_edit_window')\">\r\n            <FullscreenOutlined class=\"edit-icon\" @click=\"showContModal\"/>\r\n          </a-tooltip>\r\n        </div>\r\n      </div>\r\n      <template v-if=\"currentNews.article_type === 'news'\">\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_content_source_url') }}</div>\r\n          </div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 33px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"currentNews.tag_map?.content_source_url || []\"\r\n            :defaultValue=\"currentNews.content_source_url\"\r\n            ref=\"atInputRef\"\r\n            @open=\"emit('updateVar')\"\r\n            @change=\"(text, selectedList) => changeFieldValue('content_source_url', text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content_with_var')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"options-item is-required baseline\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_cover_material') }}</div>\r\n          </div>\r\n          <div style=\"flex: 1;\">\r\n            <AtInput\r\n              type=\"textarea\"\r\n              inputStyle=\"height: 33px;\"\r\n              :options=\"variableOptions\"\r\n              :defaultSelectedList=\"currentNews.tag_map?.thumb_media_id || []\"\r\n              :defaultValue=\"currentNews.thumb_media_id\"\r\n              ref=\"atInputRef\"\r\n              @open=\"emit('updateVar')\"\r\n              @change=\"(text, selectedList) => changeFieldValue('thumb_media_id', text, selectedList)\"\r\n              :placeholder=\"t('ph_input_content_with_var')\"\r\n            >\r\n              <template #option=\"{ label, payload }\">\r\n                <div class=\"field-list-item\">\r\n                  <div class=\"field-label\">{{ label }}</div>\r\n                  <div class=\"field-type\">{{ payload.typ }}</div>\r\n                </div>\r\n              </template>\r\n            </AtInput>\r\n            <ZmRadioGroup class=\"mt4\" v-model:value=\"currentNews.thumb_type\" :options=\"thumbTypeOpts\" @change=\"update\"/>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <div class=\"options-item\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_article_comments') }}</div>\r\n        </div>\r\n        <ZmRadioGroup v-model:value=\"currentNews.need_open_comment\" :options=\"comOpts\" @change=\"update\"/>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_comment_audience') }}</div>\r\n        </div>\r\n        <ZmRadioGroup v-model:value=\"currentNews.only_fans_can_comment\" :options=\"fansComOpts\" @change=\"update\"/>\r\n      </div>\r\n      <template v-if=\"currentNews.article_type === 'news'\">\r\n        <!--        <div class=\"options-item\">-->\r\n        <!--          <div class=\"options-item-tit\">-->\r\n        <!--            <div class=\"option-label\">封面裁剪坐标 (2.35:1)</div>-->\r\n        <!--          </div>-->\r\n        <!--          <ZmRadioGroup v-model:value=\"currentNews.pic_crop_235_1\" :options=\"positionOpts\"/>-->\r\n        <!--        </div>-->\r\n        <!--        <div class=\"options-item\">-->\r\n        <!--          <div class=\"options-item-tit\">-->\r\n        <!--            <div class=\"option-label\">封面裁剪坐标(1:1)</div>-->\r\n        <!--          </div>-->\r\n        <!--          <ZmRadioGroup v-model:value=\"currentNews.pic_crop_1_1\" :options=\"positionOpts\"/>-->\r\n        <!--        </div>-->\r\n      </template>\r\n      <template v-else>\r\n        <div class=\"options-item is-required baseline\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_image') }}</div>\r\n          </div>\r\n          <div class=\"img-box\">\r\n            <div v-for=\"(item, index) in currentNews.image_info\" :key=\"index\" class=\"img-item\">\r\n              <AtInput\r\n                type=\"textarea\"\r\n                inputStyle=\"height: 33px;\"\r\n                :options=\"variableOptions\"\r\n                :defaultSelectedList=\"item.tags || []\"\r\n                :defaultValue=\"item.value\"\r\n                ref=\"atInputRef\"\r\n                @open=\"emit('updateVar')\"\r\n                @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"\r\n                :placeholder=\"t('ph_input_content_with_var')\"\r\n              >\r\n                <template #option=\"{ label, payload }\">\r\n                  <div class=\"field-list-item\">\r\n                    <div class=\"field-label\">{{ label }}</div>\r\n                    <div class=\"field-type\">{{ payload.typ }}</div>\r\n                  </div>\r\n                </template>\r\n              </AtInput>\r\n              <CloseCircleOutlined @click=\"delItem('image_info', index)\"/>\r\n            </div>\r\n            <a-button\r\n              v-if=\"currentNews.image_info.length < 20\"\r\n              type=\"dashed\"\r\n              :icon=\"h(PlusOutlined)\"\r\n              @click=\"addItem('image_info')\">{{ t('btn_add_image') }}\r\n            </a-button>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item baseline\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_cover_info') }}</div>\r\n          </div>\r\n          <div class=\"img-box\">\r\n            <div v-for=\"(item, index) in currentNews.cover_info\" :key=\"index\" class=\"img-item\">\r\n              <AtInput\r\n                type=\"textarea\"\r\n                inputStyle=\"height: 33px;\"\r\n                :options=\"variableOptions\"\r\n                :defaultSelectedList=\"item.tags || []\"\r\n                :defaultValue=\"item.value\"\r\n                ref=\"atInputRef\"\r\n                @open=\"emit('updateVar')\"\r\n                @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"\r\n                :placeholder=\"t('ph_input_content_with_var')\"\r\n              >\r\n                <template #option=\"{ label, payload }\">\r\n                  <div class=\"field-list-item\">\r\n                    <div class=\"field-label\">{{ label }}</div>\r\n                    <div class=\"field-type\">{{ payload.typ }}</div>\r\n                  </div>\r\n                </template>\r\n              </AtInput>\r\n              <CloseCircleOutlined @click=\"delItem('cover_info', index)\"/>\r\n            </div>\r\n            <a-button\r\n              v-if=\"currentNews.cover_info.length < 5\"\r\n              type=\"dashed\"\r\n              :icon=\"h(PlusOutlined)\"\r\n              @click=\"addItem('cover_info')\">{{ t('btn_add_cover') }}\r\n            </a-button>\r\n          </div>\r\n        </div>\r\n<!--        <div class=\"options-item baseline\">-->\r\n<!--          <div class=\"options-item-tit\">-->\r\n<!--            <div class=\"option-label\">商品信息</div>-->\r\n<!--          </div>-->\r\n<!--          <div class=\"img-box\">-->\r\n<!--            <div v-for=\"(item, index) in currentNews.product_info\" :key=\"index\" class=\"img-item\">-->\r\n<!--              <AtInput-->\r\n<!--                type=\"textarea\"-->\r\n<!--                inputStyle=\"height: 33px;\"-->\r\n<!--                :options=\"variableOptions\"-->\r\n<!--                :defaultSelectedList=\"item.tags || []\"-->\r\n<!--                :defaultValue=\"item.value\"-->\r\n<!--                ref=\"atInputRef\"-->\r\n<!--                @open=\"emit('updateVar')\"-->\r\n<!--                @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"-->\r\n<!--                placeholder=\"请输入内容，键入\"/\"可以插入变量\"-->\r\n<!--              >-->\r\n<!--                <template #option=\"{ label, payload }\">-->\r\n<!--                  <div class=\"field-list-item\">-->\r\n<!--                    <div class=\"field-label\">{{ label }}</div>-->\r\n<!--                    <div class=\"field-type\">{{ payload.typ }}</div>-->\r\n<!--                  </div>-->\r\n<!--                </template>-->\r\n<!--              </AtInput>-->\r\n<!--              <CloseCircleOutlined @click=\"delItem('product_info', index)\"/>-->\r\n<!--            </div>-->\r\n<!--            <a-button-->\r\n<!--              v-if=\"currentNews.cover_info.length < 5\"-->\r\n<!--              type=\"dashed\"-->\r\n<!--              :icon=\"h(PlusOutlined)\"-->\r\n<!--              @click=\"addItem('product_info')\">新增商品-->\r\n<!--            </a-button>-->\r\n<!--          </div>-->\r\n<!--        </div>-->\r\n      </template>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/> {{ t('title_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n\r\n    <DraftNewsCont\r\n      v-if=\"formState.article_type === 'news'\"\r\n      ref=\"newsContRef\"\r\n      :variable-options=\"variableOptions\"\r\n      :appData=\"{  app_id: formState.app_id, app_secret: formState.app_secret}\"\r\n      @change=\"changeContent\"\r\n    />\r\n    <DraftNewspicCont\r\n      v-else\r\n      ref=\"newsContRef\"\r\n      :variable-options=\"variableOptions\"\r\n      @change=\"changeContent\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, onMounted, watch, inject, computed, h, nextTick} from 'vue';\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport {getWechatAppList} from \"@/api/robot/index.js\";\r\nimport {pluginOutputToTree} from \"@/constants/plugin.js\";\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {PlusOutlined, CloseOutlined, FullscreenOutlined, CloseCircleOutlined, QuestionCircleOutlined} from '@ant-design/icons-vue';\r\nimport ZmRadioGroup from \"@/components/common/zm-radio-group.vue\";\r\nimport DraftNewsCont from \"./components/draft-news-cont.vue\";\r\nimport DraftNewspicCont from \"./components/draft-newspic-cont.vue\";\r\nimport {useI18n} from \"@/hooks/web/useI18n\";\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.official-draft.official-draft-store')\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst newsContRef = ref(null)\r\nconst outputData = ref([])\r\nconst apps = ref([])\r\nconst articleData = {\r\n  title: \"\",\r\n  article_type: \"\",\r\n  author: \"\",\r\n  digest: \"\",\r\n  content: \"\",\r\n  content_source_url: \"\",\r\n  need_open_comment: 0,\r\n  only_fans_can_comment: 0,\r\n  pic_crop_235_1: '',\r\n  pic_crop_1_1: '',\r\n  thumb_type: 1,\r\n  thumb_media_id: \"\",\r\n  image_info: [{value: '', tags: []}],\r\n  product_info: [{value: '', tags: []}],\r\n  cover_info: [{value: '', tags: []}],\r\n  tag_map: {},\r\n}\r\nconst formState = reactive({\r\n  app_id: undefined,\r\n  app_secret: \"\",\r\n  app_name: \"\",\r\n  article_type: \"news\",\r\n  articles: [],\r\n\r\n  // 更新文章\r\n  media_id: \"\",\r\n  index: 0,\r\n  tag_map: {},\r\n})\r\nconst currentNewsIndex = ref(0)\r\nconst currentNews = computed(() => {\r\n  return formState.articles[currentNewsIndex.value] || articleData\r\n})\r\n\r\nconst positionOpts = computed(() => [\r\n  {label: t('label_center'), value: 1},\r\n  {label: t('label_left_align'), value: 2},\r\n  {label: t('label_right_align'), value: 3},\r\n])\r\n\r\nconst thumbTypeOpts = computed(() => [\r\n  {label: t('opt_material_url'), value: 1},\r\n  {label: t('opt_material_media_id'), value: 2},\r\n])\r\n\r\nconst comOpts = computed(() => [\r\n  {label: t('opt_close'), value: 0},\r\n  {label: t('opt_open'), value: 1},\r\n])\r\n\r\nconst fansComOpts = computed(() => [\r\n  {label: t('opt_all_users'), value: 0},\r\n  {label: t('opt_fans_only'), value: 1},\r\n])\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n\r\nwatch(() => props.action, () => {\r\n  outputData.value = pluginOutputToTree(JSON.parse(JSON.stringify(props.action?.output || '{}')))\r\n}, {\r\n  deep: true,\r\n  immediate: true\r\n})\r\n\r\nfunction init() {\r\n  loadWxApps()\r\n  addNews()\r\n  nodeParamsAssign()\r\n}\r\n\r\nfunction loadWxApps() {\r\n  getWechatAppList({app_type: 'official_account'}).then(res => {\r\n    apps.value = res?.data || []\r\n  })\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let arg = nodeParams?.plugin?.params?.arguments || {}\r\n  // 更新文章时 articles 为对象\r\n  if (props.actionName === 'update_draft' && arg.articles && Object.keys(arg.articles).length) {\r\n    arg.articles = [arg.articles]\r\n  }\r\n  Object.assign(formState, arg)\r\n  if (!formState.app_id) {\r\n    let app = jsonDecode( window.localStorage.getItem('zm:ai:draft:last:app'))\r\n    if (app) {\r\n      Object.assign(formState, app)\r\n      update()\r\n    }\r\n  }\r\n}\r\n\r\nfunction appChange(_, option) {\r\n  const {key, secret, name} = option\r\n  formState.app_secret = secret\r\n  formState.app_name = name\r\n  window.localStorage.setItem('zm:ai:draft:last:app', JSON.stringify({\r\n    app_id: key,\r\n    app_secret: secret,\r\n    app_name: name\r\n  }))\r\n  update()\r\n}\r\n\r\nfunction articleTypeChange() {\r\n  formState.articles = []\r\n  addNews()\r\n}\r\n\r\nfunction articleChange(article, i) {\r\n  currentNewsIndex.value = i\r\n}\r\n\r\nfunction changeStateFieldValue(field, text, selectedList) {\r\n  formState[field] = text\r\n  formState.tag_map[field] = selectedList\r\n  update()\r\n}\r\n\r\nfunction changeFieldValue(field, text, selectedList) {\r\n  currentNews.value[field] = text\r\n  currentNews.value.tag_map[field] = selectedList\r\n  update()\r\n}\r\n\r\nfunction changeValue(item, text, selectedList) {\r\n  item.value = text\r\n  item.tags = selectedList\r\n  update()\r\n}\r\n\r\nfunction showContModal() {\r\n  newsContRef.value.show(currentNews.value.content, currentNews.value.tag_map.content || [])\r\n}\r\n\r\n\r\nfunction changeContent(value,tags) {\r\n  currentNews.value.content = value\r\n  currentNews.value.tag_map.content = tags || []\r\n  update()\r\n}\r\n\r\nfunction addNews() {\r\n  let data = JSON.parse(JSON.stringify(articleData))\r\n  data.article_type = formState.article_type\r\n  formState.articles.push(data)\r\n}\r\n\r\nfunction delNews(index) {\r\n  formState.articles.splice(index, 1)\r\n  update()\r\n}\r\n\r\nfunction addItem(field) {\r\n  formState.articles[currentNewsIndex.value][field].push({\r\n    value: \"\",\r\n    tags: []\r\n  })\r\n}\r\n\r\nfunction delItem(field, index) {\r\n  formState.articles[currentNewsIndex.value][field].splice(index, 1)\r\n}\r\n\r\nfunction update() {\r\n  nextTick(() => {\r\n    let nodeParams = JSON.parse(props.node.node_params)\r\n    nodeParams.plugin.output_obj = outputData.value\r\n    let arg = {...formState}\r\n    if (props.actionName === 'update_draft') {\r\n      arg.articles = arg.articles[0]\r\n    }\r\n    Object.assign(nodeParams.plugin.params, {\r\n      arguments: {\r\n        ...arg\r\n      }\r\n    })\r\n    setData({\r\n      ...props.node,\r\n      node_params: JSON.stringify(nodeParams)\r\n    })\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"../node-options\";\r\n\r\n.article-container {\r\n  :deep(.mention-input-warpper) {\r\n    height: 32px;\r\n    word-break: break-all;\r\n\r\n    .type-textarea {\r\n      height: 32px;\r\n      min-height: 32px;\r\n    }\r\n  }\r\n}\r\n\r\n.news-tabs {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  color: #262626;\r\n  font-size: 14px;\r\n  gap: 4px;\r\n\r\n  .news-item {\r\n    padding: 9px 16px;\r\n    border-radius: 2px;\r\n    border: 1px solid #F0F0F0;\r\n    background: #FAFAFA;\r\n    cursor: pointer;\r\n\r\n    &.active,\r\n    &:hover {\r\n      color: #2475FC;\r\n      background: #FFF;\r\n    }\r\n\r\n    &:hover {\r\n      .del-icon {\r\n        display: inline-block;\r\n      }\r\n    }\r\n\r\n    .del-icon {\r\n      display: none;\r\n      margin-left: 4px;\r\n    }\r\n  }\r\n}\r\n\r\n.article-form-box.node-options {\r\n  .options-item {\r\n    display: flex;\r\n    flex-direction: row;\r\n\r\n    &.baseline {\r\n      align-items: baseline;\r\n    }\r\n\r\n    .options-item-tit {\r\n      width: 83px;\r\n      text-align: left;\r\n      flex-shrink: 0;\r\n    }\r\n  }\r\n}\r\n\r\n.cont-box {\r\n  position: relative;\r\n  flex: 1;\r\n\r\n  .edit-icon {\r\n    padding: 4px;\r\n    border-radius: 6px;\r\n    background: #E4E6EB;\r\n    position: absolute;\r\n    right: 4px;\r\n    top: 5px;\r\n  }\r\n}\r\n\r\n.img-box {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n\r\n  .img-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n.mt4 {\r\n  margin-top: 4px;\r\n}\r\n</style>\r\n","<template>\r\n  <PluginFormRender\r\n    :node=\"node\"\r\n    :params=\"params\"\r\n    :output=\"action.output\"\r\n    :variableOptions=\"variableOptions\"\r\n    @updateVar=\"emit('updateVar')\"\r\n  >\r\n    <template #app_name></template>\r\n    <template #app_secret></template>\r\n    <template #app_id=\"{ state, item, keyName}\">\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_official_account') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-select\r\n            v-model:value=\"item.value\"\r\n            :placeholder=\"t('ph_select_official_account')\"\r\n            style=\"width: 100%;\"\r\n            @change=\"(value, option) => appChange(state, option)\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"app in apps\"\r\n              :key=\"app.app_id\"\r\n              :value=\"app.app_id\"\r\n              :name=\"app.app_name\"\r\n              :secret=\"app.app_secret\"\r\n            >\r\n              {{ app.app_name }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </div>\r\n        <div v-if=\"['publish_draft', 'preview_message'].includes(actionName)\" class=\"desc\">\r\n          <ExclamationCircleFilled/>\r\n          {{ t('msg_unsupported_account') }}\r\n        </div>\r\n      </div>\r\n    </template>\r\n    <template v-if=\"actionName === 'preview_message'\" #type=\"{state, item}\">\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_message_user_type') }}</div>\r\n        </div>\r\n        <div>\r\n          <a-radio-group v-model:value=\"item.value\">\r\n            <a-radio value=\"touser\">{{ t('opt_official_user_openid') }}</a-radio>\r\n            <a-radio value=\"towxname\">{{ t('opt_wechat_id') }}</a-radio>\r\n          </a-radio-group>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </PluginFormRender>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, computed, onMounted} from 'vue';\r\nimport {ExclamationCircleFilled} from '@ant-design/icons-vue';\r\nimport PluginFormRender from \"@/views/workflow/components/node-form-drawer/components/pluginFormRender.vue\";\r\nimport {getWechatAppList} from \"@/api/robot/index.js\";\r\nimport {jsonDecode, sortObjectKeys} from \"@/utils/index.js\";\r\nimport {useI18n} from \"@/hooks/web/useI18n\";\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.official-draft.official-draft-operate')\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  },\r\n})\r\nconst params = ref({})\r\nconst apps = ref([])\r\n\r\nonMounted(() => {\r\n  loadWxApps()\r\n  getParams()\r\n})\r\n\r\nfunction getParams() {\r\n  const baseParams = {\r\n    ...props.action.params,\r\n    app_id: {\r\n      ...props.action.params.app_id,\r\n      default: null,\r\n    },\r\n    app_name: {\r\n      desc: 'label_official_account_name',\r\n      type: 'string',\r\n    },\r\n  }\r\n  let app = jsonDecode(window.localStorage.getItem('zm:ai:draft:last:app'))\r\n  if (app) {\r\n    baseParams.app_id.default = app.app_id\r\n    baseParams.app_name.default = app.app_name\r\n    baseParams.app_secret.default = app.app_secret\r\n  }\r\n  if (props.actionName === \"preview_message\") {\r\n    baseParams.type = {\r\n      ...props.action.params.type,\r\n      default: 'touser'\r\n    }\r\n    params.value = sortObjectKeys(baseParams, ['app_id', 'media_id', 'type', 'account'])\r\n  } else {\r\n    params.value = baseParams\r\n  }\r\n}\r\n\r\nfunction loadWxApps() {\r\n  getWechatAppList({app_type: 'official_account'}).then(res => {\r\n    apps.value = res?.data || []\r\n  })\r\n}\r\n\r\nfunction appChange(state, option) {\r\n  const {key, secret, name} = option\r\n  state.app_secret.value = secret\r\n  state.app_name.value = name\r\n  window.localStorage.setItem('zm:ai:draft:last:app', JSON.stringify({\r\n    app_id: key,\r\n    app_secret: secret,\r\n    app_name: name\r\n  }))\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","<template>\r\n  <component\r\n    :is=\"currentComp\"\r\n    :action=\"action\"\r\n    :actionName=\"actionName\"\r\n    :variableOptions=\"variableOptions\"\r\n    :node=\"node\"\r\n    @updateVar=\"emit('updateVar')\"\r\n  />\r\n</template>\r\n<script setup>\r\nimport {ref, reactive, computed} from 'vue';\r\nimport OfficialDraftStore from \"./official-draft-store.vue\";\r\nimport OfficialDraftOperate from \"./official-draft-operate.vue\";\r\n\r\nconst compMap = {\r\n  add_draft: OfficialDraftStore,\r\n  update_draft: OfficialDraftStore,\r\n  delete_draft: OfficialDraftOperate,\r\n  publish_draft: OfficialDraftOperate,\r\n  preview_message: OfficialDraftOperate,\r\n  get_draft: OfficialDraftOperate,\r\n}\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst currentComp = computed(() => {\r\n  return compMap[props.actionName] || OfficialDraftOperate\r\n})\r\n</script>\r\n","<template>\r\n  <div class=\"field-tree-wrapper\" @wheel.stop @touchmove.stop>\r\n    <a-tree\r\n      v-model:selectedKeys=\"selectedKeys\"\r\n      blockNode\r\n      :defaultExpandAll=\"true\"\r\n      :height=\"224\"\r\n      :tree-data=\"props.treeData\"\r\n      :fieldNames=\"{children: 'subs', key: 'cu_key'}\"\r\n    >\r\n      <template #switcherIcon=\"{ switcherCls }\">\r\n        <span :class=\"switcherCls\">\r\n          <svg-icon\r\n            class=\"switcher-btn\"\r\n            name=\"arrow-down\"\r\n            style=\"font-size: 14px; color: #333\"\r\n          ></svg-icon>\r\n        </span>\r\n      </template>\r\n\r\n      <template #title=\"{ dataRef }\">\r\n        <div class=\"field-item\">\r\n          <span class=\"field-key\">{{ dataRef.key }}</span>\r\n          <a-tooltip v-if=\"dataRef.tip\" :overlayStyle=\"{ maxWidth: '800px' }\">\r\n            <template #title>\r\n              <div class=\"tip-content\">{{ dataRef.tip }}</div>\r\n            </template>\r\n            <QuestionCircleOutlined style=\"margin-left: 4px;\" />\r\n          </a-tooltip>\r\n          <span class=\"field-type\">{{ dataRef.typ }}</span>\r\n          <span class=\"field-name\">{{ dataRef.name }}</span>\r\n        </div>\r\n      </template>\r\n    </a-tree>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue';\r\nimport { ref } from 'vue'\r\n// const expandedKeys = ref(['0-0-0'])\r\n\r\nconst props = defineProps({\r\n  treeData: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst selectedKeys = ref([])\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.field-tree-wrapper {\r\n  position: relative;\r\n  height: 224px;\r\n  :deep(.ant-tree) {\r\n    background: none;\r\n  }\r\n  .switcher-btn {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 16px;\r\n    border-radius: 6px;\r\n    color: #000;\r\n\r\n    &:hover {\r\n      cursor: pointer;\r\n      background-color: #d9d9d9;\r\n    }\r\n  }\r\n\r\n  .field-item{\r\n    display: flex;\r\n    align-items: center;\r\n    .field-key{\r\n      color: #262626;\r\n      text-align: right;\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 22px;\r\n    }\r\n    .field-name{\r\n      color: #595959;\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 22px;\r\n    }\r\n    .field-type{\r\n      display: flex;\r\n      padding: 1px 8px;\r\n      align-items: center;\r\n      gap: 4px;\r\n      border-radius: 6px;\r\n      border: 1px solid #00000026;\r\n      background: #FFF;\r\n      color: #595959;\r\n      font-size: 12px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 20px;\r\n      margin: 0 12px 0 8px;\r\n    }\r\n  }\r\n}\r\n\r\n.tip-content {\r\n  white-space: pre-wrap;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <div v-if=\"!userInfo\" class=\"not-login-box\">\r\n      <div class=\"tit\">请先完成登录</div>\r\n      <a-button type=\"primary\" class=\"link\" @click=\"showLogin\">去登录</a-button>\r\n    </div>\r\n    <div v-else class=\"login-info-box\">\r\n      <img class=\"avatar\" :src=\"userInfo?.avatarUrl\"/>\r\n      <span>{{ userInfo?.nick }}</span>\r\n      <CheckCircleFilled class=\"icon\"/>\r\n    </div>\r\n\r\n    <a-modal\r\n      v-model:open=\"loginVisible\"\r\n      :footer=\"null\"\r\n      wrapClassName=\"qrcode-wrap\"\r\n      width=\"380px\"\r\n    >\r\n      <div class=\"qrcode-box\">\r\n        <div class=\"title\">扫码登录</div>\r\n        <div class=\"content\">\r\n          <div class=\"tip\">请使用钉钉扫描下方二维码授权</div>\r\n          <div id=\"dingLoginCode\" class=\"qrcode\"></div>\r\n<!--          <div class=\"desc\">二维码有效期为5分钟，请尽快扫描</div>-->\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, onMounted, nextTick} from 'vue'\r\nimport {message} from 'ant-design-vue'\r\nimport {CheckCircleFilled} from '@ant-design/icons-vue'\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\n\r\nconst props = defineProps({\r\n  formState: { type: Object, default: () => null },\r\n})\r\nconst emit = defineEmits(['change'])\r\n\r\nconst loginVisible = ref(false)\r\nconst userInfo = ref(jsonDecode(localStorage.getItem('zm:workflow:ding:login:user')))\r\nlet scriptEl = null\r\n\r\nonMounted(() => {\r\n setTimeout(() => {\r\n   if (userInfo.value?.unionId) {\r\n     update()\r\n   }\r\n }, 100)\r\n})\r\n\r\nfunction showLogin() {\r\n  if (!props.formState.dingtalk_app_key || !props.formState.dingtalk_app_secret) return message.error('缺少授权信息')\r\n  loginVisible.value = true\r\n  nextTick(() => {\r\n    loadDingScript(renderLoginComp)\r\n  })\r\n}\r\n\r\nfunction loadDingScript(callback= () => {}) {\r\n  if (!window.DTFrameLogin) {\r\n    scriptEl = document.createElement('script')\r\n    scriptEl.src = 'https://g.alicdn.com/dingding/h5-dingtalk-login/0.21.0/ddlogin.js'\r\n    scriptEl.async = true\r\n    scriptEl.onload = () => callback()\r\n    document.body.appendChild(scriptEl)\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nfunction renderLoginComp() {\r\n  window.DTFrameLogin(\r\n    {\r\n      id: 'dingLoginCode',\r\n      width: 220,\r\n      height: 240,\r\n    },\r\n    {\r\n      redirect_uri: encodeURIComponent(window.location.origin),\r\n      client_id: 'ding8xzffz9vztwiqdcu',\r\n      scope: 'openid',\r\n      response_type: 'code',\r\n      prompt: 'consent',\r\n    },\r\n    (loginResult) => {\r\n      console.log('loginResult', loginResult)\r\n      const {redirectUrl, authCode} = loginResult;\r\n      // 也可以在不跳转页面的情况下，使用code进行授权\r\n      getUserInfo(authCode)\r\n    },\r\n    (errorMsg) => {\r\n      // 这里一般需要展示登录失败的具体原因,可以使用toast等轻提示\r\n      console.error(`errorMsg of errorCbk: ${errorMsg}`);\r\n    },\r\n  );\r\n}\r\n\r\nfunction getUserInfo(dingtalk_code) {\r\n  const {dingtalk_app_key, dingtalk_app_secret} = props.formState\r\n  runPlugin({\r\n    name: \"dingtalk_ai_table\",\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'GetLoginUserInfo',\r\n      arguments: {\r\n        dingtalk_app_key,\r\n        dingtalk_app_secret,\r\n        dingtalk_code,\r\n      }\r\n    })\r\n  }).then(res => {\r\n    if (res?.data?.unionId) {\r\n      userInfo.value = res?.data\r\n      localStorage.setItem('zm:workflow:ding:login:user', JSON.stringify(userInfo.value))\r\n      update()\r\n    }\r\n  })\r\n}\r\n\r\nfunction update() {\r\n  emit('change', 'operatorId', userInfo.value?.unionId)\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.not-login-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  border-radius: 6px;\r\n  padding: 16px 16px 0;\r\n  background: #F2F4F7;\r\n\r\n  .link {\r\n    width: 168px;\r\n    margin-top: 16px;\r\n  }\r\n\r\n  .tit {\r\n    color: #262626;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n  }\r\n\r\n  .desc {\r\n    color: #8c8c8c;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    margin: 12px 0;\r\n\r\n    :deep(.ant-btn) {\r\n      padding: 0;\r\n    }\r\n  }\r\n}\r\n\r\n.login-info-box {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  color: #262626;\r\n  font-size: 14px;\r\n\r\n  .avatar {\r\n    width: 16px;\r\n    height: 16px;\r\n    border-radius: 12px;\r\n  }\r\n\r\n  .icon {\r\n    color: #21A665;\r\n  }\r\n}\r\n\r\n.qrcode-box {\r\n  .title {\r\n    color: #000000;\r\n    font-size: 24px;\r\n    font-weight: 600;\r\n    padding: 32px 24px;\r\n    position: relative;\r\n    &::before {\r\n      content: \"\";\r\n      position: absolute;\r\n      width: 100%;\r\n      height: 100%;\r\n      left: 0;\r\n      top: -18px;\r\n      background: url(\"@/assets/img/login-pop-bg.png\") no-repeat;\r\n      background-size: 100% 100%;\r\n    }\r\n    &::after {\r\n      content: \"扫码登录\";\r\n      position: absolute;\r\n      color: #000000;\r\n      font-size: 24px;\r\n      font-weight: 600;\r\n      left: 24px;\r\n      top: 24px;\r\n    }\r\n  }\r\n  .content {\r\n    display: flex;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    color: #262626;\r\n    font-size: 14px;\r\n    padding: 0 24px 24px;\r\n\r\n    .qrcode {\r\n      //width: 200px;\r\n      //height: 200px;\r\n    }\r\n\r\n    .desc {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n}\r\n</style>\r\n<style lang=\"less\">\r\n.qrcode-wrap.ant-modal-wrap {\r\n  .ant-modal-content {\r\n    padding: 0;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <div class=\"flex-center min-input\">\r\n      <a-select v-model:value=\"state.set_type\" @change=\"setTypeChange\" style=\"width: 112px;flex-shrink: 0;\">\r\n        <a-select-option value=\"1\">选择数据表</a-select-option>\r\n        <a-select-option value=\"2\">插入变量</a-select-option>\r\n      </a-select>\r\n      <a-select\r\n        v-if=\"state.set_type == 1\"\r\n        v-model:value=\"state.sheetIdOrName\"\r\n        @change=\"tableChange\"\r\n        placeholder=\"请选择数据表\"\r\n        style=\"width: 100%;\">\r\n        <a-select-option\r\n          v-for=\"item in list\"\r\n          :key=\"item.id\"\r\n          :name=\"item.name\"\r\n          :value=\"item.id\">\r\n          {{ item.name }}\r\n        </a-select-option>\r\n      </a-select>\r\n      <AtFullInput\r\n        v-else\r\n        type=\"textarea\"\r\n        inputStyle=\"height: 33px;\"\r\n        :options=\"variableOptions\"\r\n        :defaultSelectedList=\"state.tags || []\"\r\n        :defaultValue=\"state.sheetIdOrName\"\r\n        :canFull=\"canFull\"\r\n        ref=\"atInputRef\"\r\n        @open=\"emit('open')\"\r\n        @change=\"changeValue\"\r\n        placeholder=\"请输入表格ID或名称，键入“/”可以插入变量\"\r\n      >\r\n        <template #option=\"{ label, payload }\">\r\n          <div class=\"field-list-item\">\r\n            <div class=\"field-label\">{{ label }}</div>\r\n            <div class=\"field-type\">{{ payload.typ }}</div>\r\n          </div>\r\n        </template>\r\n      </AtFullInput>\r\n    </div>\r\n    <div class=\"desc\">数据表ID或名称，例如：tblz2wmlWiB1JGxS</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {watch, ref, reactive, computed, nextTick} from 'vue'\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\nimport AtFullInput from \"@/views/workflow/components/at-input/at-full-input.vue\";\r\nimport {isValidURL} from \"@/utils/validate.js\";\r\n\r\nconst props = defineProps({\r\n  formState: {type: Object, default: () => null},\r\n  variableOptions: {type: Array, default: () => []},\r\n  canFull:{type: Boolean, default: false}\r\n})\r\nconst emit = defineEmits(['open', 'change'])\r\n\r\nconst atInputRef = ref(null)\r\nconst list = ref([])\r\nconst state = reactive({\r\n  set_type: '1',\r\n  sheetIdOrName: undefined,\r\n  tags: [],\r\n  table_name: '',\r\n})\r\n\r\nconst baseConfigReady = computed(() => {\r\n  const {\r\n    baseId,\r\n    operatorId,\r\n    dingtalk_app_key,\r\n    dingtalk_app_secret,\r\n  } = props.formState\r\n\r\n  return {\r\n    ok: Boolean(baseId && operatorId && dingtalk_app_key && dingtalk_app_secret),\r\n    config: {\r\n      baseId,\r\n      operatorId,\r\n      dingtalk_app_key,\r\n      dingtalk_app_secret,\r\n    }\r\n  }\r\n})\r\n\r\nwatch(\r\n  baseConfigReady,\r\n  (val) => {\r\n    list.value = []\r\n    if (val.ok) {\r\n      if(isValidURL(val.config.baseId)) {\r\n        loadRemoteData()\r\n      } else if (state.set_type == 1) {\r\n        setTable()\r\n      }\r\n    } else {\r\n      list.value = []\r\n      // 插入变量时不清空\r\n      if (state.set_type == 1) setTable()\r\n      state.tags = []\r\n      nextTick(() => {\r\n        update()\r\n      })\r\n    }\r\n  },\r\n  { immediate: true }\r\n)\r\n\r\nwatch(\r\n  () => ({\r\n    set_type: props.formState.extras?.set_type,\r\n    table_name: props.formState.extras?.table_name,\r\n    sheetIdOrName: props.formState.sheetIdOrName,\r\n    sheetIdOrName_tags: props.formState.sheetIdOrName_tags,\r\n  }),\r\n  (val) => {\r\n    state.set_type = val.set_type || '1'\r\n    state.sheetIdOrName = val.sheetIdOrName || undefined\r\n    state.tags = val.sheetIdOrName_tags || []\r\n    state.table_name = val.table_name || ''\r\n  },\r\n  {\r\n    immediate: true,\r\n  }\r\n)\r\n\r\nfunction loadRemoteData() {\r\n  const {dingtalk_app_key, dingtalk_app_secret, operatorId, baseId} = props.formState\r\n  runPlugin({\r\n    name: \"dingtalk_ai_table\",\r\n    action: \"default/exec\",\r\n    params: JSON.stringify({\r\n      business: 'AllSheets',\r\n      arguments: {\r\n        dingtalk_app_key,\r\n        dingtalk_app_secret,\r\n        operatorId,\r\n        baseId,\r\n      }\r\n    })\r\n  }).then(res => {\r\n    list.value = res?.data || []\r\n    if (state.set_type == 1) {\r\n      let tbInfo = null\r\n      if (!state.sheetIdOrName) {\r\n        tbInfo = list.value?.[0] || undefined\r\n      } else {\r\n        tbInfo = list.value.find(i => state.sheetIdOrName == i.id)\r\n      }\r\n      setTable(tbInfo)\r\n    }\r\n  }).catch(() => {\r\n    // 插入变量时不清空\r\n    if (state.set_type == 1) setTable()\r\n  }).finally(() => {\r\n    update()\r\n  })\r\n  return true\r\n}\r\n\r\nfunction setTypeChange() {\r\n  let tbInfo = null\r\n  if (state.set_type == '1') tbInfo = list.value[0]\r\n  setTable(tbInfo)\r\n  update()\r\n}\r\n\r\n\r\nfunction changeValue(val, tags) {\r\n  state.sheetIdOrName = val\r\n  state.tags = tags\r\n  update()\r\n}\r\n\r\nfunction tableChange(_, opt) {\r\n  state.table_name = opt.name\r\n  update()\r\n}\r\n\r\nfunction setTable(info=null) {\r\n  if (info?.id) {\r\n    state.sheetIdOrName = info.id\r\n    state.table_name = info.name\r\n  } else {\r\n    state.sheetIdOrName = state.set_type == '1' ? undefined : ''\r\n    state.table_name = ''\r\n  }\r\n}\r\n\r\nfunction update() {\r\n  emit('change', 'sheetIdOrName', state.sheetIdOrName, state.tags, {\r\n    set_type: state.set_type,\r\n    table_name: state.table_name,\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.flex-center {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.min-input {\r\n  :deep(.mention-input-warpper) {\r\n    height: 32px;\r\n    word-break: break-all;\r\n\r\n    .type-textarea {\r\n      height: 32px;\r\n      min-height: 32px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    v-for=\"item in items\"\r\n    :key=\"item.key\"\r\n    class=\"options-item\"\r\n    :class=\"{ 'is-required': item.meta?.required }\"\r\n  >\r\n    <div class=\"options-item-tit\">\r\n      <div class=\"option-label\">\r\n        {{ item.meta?.name || item.key }}\r\n        <a-tooltip :title=\"t('tip_sync_tags')\" v-if=\"item.meta?.tag_component\" :overlayStyle=\"{ maxWidth: '600px' }\" placement=\"top\">\r\n          <a @click=\"syncFieldTags && syncFieldTags(item.key, item.meta)\">\r\n            {{ t('btn_sync') }} <a-spin v-if=\"syncingTags && syncingTags[item.key]\" size=\"small\" />\r\n          </a>\r\n        </a-tooltip>\r\n        <a-tooltip v-if=\"item.meta?.tip\" :overlayStyle=\"{ maxWidth: '600px' }\" placement=\"top\">\r\n          <template #title>\r\n            <div class=\"tip-content\">{{ item.meta?.tip }}</div>\r\n          </template>\r\n          <QuestionCircleOutlined />\r\n        </a-tooltip>\r\n      </div>\r\n      <div class=\"option-type\">{{ item.meta?.type || 'string' }}</div>\r\n      <ZmRadioGroup\r\n        v-if=\"item.meta?.switch_component\"\r\n        style=\"margin-left: 8px;\"\r\n        :value=\"String(formState[item.key] || '').toLowerCase() === 'true' ? 'true' : 'false'\"\r\n        :options=\"switchOptions\"\r\n        @change=\"(val) => {\r\n          onFieldChange && onFieldChange(item.key, val);\r\n          update && update();\r\n        }\"\r\n      />\r\n      <div v-if=\"item.meta?.show_advanced_settings_icon\" style=\"margin-left: auto; margin-bottom: 4px;\">\r\n        <a-tooltip :title=\"t('tip_advanced_settings')\">\r\n          <span\r\n            @click=\"onToggleAdvanced && onToggleAdvanced()\"\r\n            :style=\"{ color: '#2475FC', padding: '4px 8px', borderRadius: '24px', border: '1px solid #D9D9D9', background: '#E5EFFF', cursor: 'pointer' }\"\r\n          >\r\n            <SettingOutlined/>\r\n          </span>\r\n        </a-tooltip>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-if=\"item.meta?.select_official_component\">\r\n      <a-select\r\n        :value=\"formState.app_id\"\r\n        :placeholder=\"t('ph_select_official_account')\"\r\n        style=\"width: 100%;\"\r\n        @change=\"(value, option) => {\r\n          onFieldChange && onFieldChange('app_id', value);\r\n          appChange && appChange(value, option);\r\n        }\"\r\n      >\r\n        <a-select-option\r\n          v-for=\"app in apps\"\r\n          :key=\"app.app_id\"\r\n          :value=\"app.app_id\"\r\n          :name=\"app.app_name\"\r\n          :app_secret=\"app.app_secret\"\r\n        >\r\n          {{ app.app_name }}\r\n        </a-select-option>\r\n      </a-select>\r\n      <div class=\"desc\" v-html=\"rednerDesc(item.meta?.desc)\"></div>\r\n      <div v-if=\"errors[item.key]\" class=\"desc\" style=\"color:#FB363F;\">{{ errors[item.key] }}</div>\r\n    </div>\r\n\r\n    <div v-else-if=\"item.meta?.enum_component\">\r\n      <a-select\r\n        :value=\"formState[item.key]\"\r\n        :placeholder=\"item.meta?.required ? t('ph_please_select') : t('ph_please_select_optional')\"\r\n        style=\"width: 100%;\"\r\n        @change=\"(value) => {\r\n          onFieldChange && onFieldChange(item.key, value);\r\n          update && update();\r\n        }\"\r\n      >\r\n        <a-select-option\r\n          v-for=\"opt in (sortedEnum ? sortedEnum(item.meta?.enum) : (item.meta?.enum || []))\"\r\n          :key=\"opt.value\"\r\n          :value=\"opt.value\"\r\n        >\r\n          {{ opt.name }}\r\n        </a-select-option>\r\n      </a-select>\r\n      <div class=\"desc\" v-html=\"rednerDesc(item.meta?.desc)\"></div>\r\n      <div v-if=\"errors[item.key]\" class=\"desc\" style=\"color:#FB363F;\">{{ errors[item.key] }}</div>\r\n    </div>\r\n\r\n    <div v-else-if=\"item.meta?.radio_component\">\r\n      <a-radio-group\r\n        :value=\"formState[item.key]\"\r\n        @change=\"(e) => {\r\n          const v = e?.target?.value ?? e\r\n          onFieldChange && onFieldChange(item.key, v);\r\n          update && update();\r\n        }\"\r\n      >\r\n        <a-radio\r\n          v-for=\"opt in (sortedEnum ? sortedEnum(item.meta?.enum) : (item.meta?.enum || []))\"\r\n          :key=\"opt.value\"\r\n          :value=\"opt.value\"\r\n        >\r\n          {{ opt.name }}\r\n        </a-radio>\r\n      </a-radio-group>\r\n      <div class=\"desc\" v-html=\"rednerDesc(item.meta?.desc)\"></div>\r\n      <div v-if=\"errors[item.key]\" class=\"desc\" style=\"color:#FB363F;\">{{ errors[item.key] }}</div>\r\n    </div>\r\n\r\n    <div v-else-if=\"item.meta?.switch_component\">\r\n      <div class=\"desc\" v-html=\"rednerDesc(item.meta?.desc)\"></div>\r\n      <div v-if=\"errors[item.key]\" class=\"desc\" style=\"color:#FB363F;\">{{ errors[item.key] }}</div>\r\n    </div>\r\n\r\n    <div v-else-if=\"item.meta?.date_range_begin_component\">\r\n      <div class=\"tag-box\">\r\n        <a-select\r\n          :value=\"dateRangeTypes[item.meta?.begin_date_key]\"\r\n          @change=\"(val) => dateRangeTypeChange && dateRangeTypeChange(item.meta, val)\"\r\n          style=\"width: 120px; padding-right: 4px;\"\r\n        >\r\n          <a-select-option :value=\"1\">{{ t('label_select_date') }}</a-select-option>\r\n          <a-select-option :value=\"2\">{{ t('label_insert_variable') }}</a-select-option>\r\n        </a-select>\r\n        <a-range-picker\r\n          v-if=\"dateRangeTypes[item.meta?.begin_date_key] == 1\"\r\n          :value=\"getRangeValue ? getRangeValue(item.meta) : null\"\r\n          format=\"YYYY-MM-DD\"\r\n          style=\"width: 100%;\"\r\n          @calendarChange=\"(dates) => onDateRangeCalendarChange && onDateRangeCalendarChange(item.meta, dates)\"\r\n          @change=\"(dates, dateStrings) => onDateRangeChange && onDateRangeChange(item.meta, dates, dateStrings)\"\r\n          :disabled-date=\"(current) => getDisabledDateForRange ? getDisabledDateForRange(item.meta, current) : false\"\r\n        />\r\n        <template v-else>\r\n          <AtFullInput\r\n            inputStyle=\"height: 33px; width: 214px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState[(item.meta?.begin_date_key || '') + '_tags'] || []\"\r\n            :defaultValue=\"formState[item.meta?.begin_date_key] || ''\"\r\n            :canFull=\"item?.meta?.text_edit_component\"\r\n            @open=\"onOpenVar && onOpenVar()\"\r\n            @change=\"(text, selectedList) => onChangeDynamic && onChangeDynamic(item.meta?.begin_date_key, text, selectedList)\"\r\n            :placeholder=\"t('ph_input_start_date')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtFullInput>\r\n          <div class=\"date-range-separator\">-</div>\r\n          <AtFullInput\r\n            inputStyle=\"height: 33px; width: 214px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState[(item.meta?.end_date_key || '') + '_tags'] || []\"\r\n            :defaultValue=\"formState[item.meta?.end_date_key] || ''\"\r\n            :canFull=\"item?.meta?.text_edit_component\"\r\n            @open=\"onOpenVar && onOpenVar()\"\r\n            @change=\"(text, selectedList) => onChangeDynamic && onChangeDynamic(item.meta?.end_date_key, text, selectedList)\"\r\n            :placeholder=\"t('ph_input_end_date')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtFullInput>\r\n        </template>\r\n      </div>\r\n      <div class=\"desc\" v-html=\"rednerDesc(item.meta?.desc)\"></div>\r\n      <div v-if=\"errors[item.key]\" class=\"desc\" style=\"color:#FB363F;\">{{ errors[item.key] }}</div>\r\n    </div>\r\n\r\n    <div v-else-if=\"item.meta?.tag_component && showTagComponents\">\r\n      <div class=\"tag-box\">\r\n        <a-select\r\n          :value=\"tagTypes[item.key]\"\r\n          @change=\"(val) => tagTypeChange && tagTypeChange(item.key, val, item.meta)\"\r\n          style=\"width: 120px;\"\r\n        >\r\n          <a-select-option :value=\"1\">{{ t('label_select_tag') }}</a-select-option>\r\n          <a-select-option :value=\"2\">{{ t('label_insert_variable') }}</a-select-option>\r\n        </a-select>\r\n        <a-select\r\n          v-if=\"tagTypes[item.key] == 1\"\r\n          :value=\"formState[item.key]\"\r\n          :placeholder=\"t('ph_select_tag')\"\r\n          style=\"width: 100%;\"\r\n          @change=\"(val, opt) => tagChange && tagChange(item.key, val, opt)\"\r\n          show-search\r\n          :filter-option=\"filterOption\"\r\n        >\r\n          <a-select-option\r\n            v-for=\"t in (tagLists[item.key] || [])\"\r\n            :key=\"t.id\"\r\n            :value=\"t.id\"\r\n            :name=\"t.name\"\r\n          >\r\n            {{ t.name }}\r\n          </a-select-option>\r\n        </a-select>\r\n        <AtFullInput\r\n          v-else\r\n          type=\"textarea\"\r\n          inputStyle=\"height: 33px;\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"formState[item.key + '_tags'] || []\"\r\n          :defaultValue=\"formState[item.key] || ''\"\r\n          :canFull=\"item?.meta?.text_edit_component\"\r\n          @open=\"onOpenVar && onOpenVar()\"\r\n          @change=\"(text, selectedList) => onChangeDynamic && onChangeDynamic(item.key, text, selectedList)\"\r\n          :placeholder=\"t('ph_input_content')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </AtFullInput>\r\n      </div>\r\n      <div class=\"desc\" v-html=\"rednerDesc(item.meta?.desc)\"></div>\r\n      <div v-if=\"errors[item.key]\" class=\"desc\" style=\"color:#FB363F;\">{{ errors[item.key] }}</div>\r\n    </div>\r\n\r\n    <div v-else-if=\"item.meta?.dingtalk_user_info_component\">\r\n      <DingLoginBox :formState=\"formState\" @change=\"onChangeDynamic\"/>\r\n    </div>\r\n\r\n    <div v-else-if=\"item.meta?.select_remote_component\">\r\n      <DingTableSelect\r\n        :formState=\"formState\"\r\n        :variableOptions=\"variableOptions\"\r\n        :canFull=\"item?.meta?.text_edit_component\"\r\n        @open=\"onOpenVar\"\r\n        @change=\"onChangeDynamic\"\r\n      />\r\n    </div>\r\n\r\n    <div v-else>\r\n      <AtFullInput\r\n        :type=\"item.meta?.in === 'body' ? 'textarea' : undefined\"\r\n        :inputStyle=\"item.meta?.in === 'body' ? 'height: 64px;' : undefined\"\r\n        :options=\"variableOptions\"\r\n        :defaultSelectedList=\"formState[item.key + '_tags'] || []\"\r\n        :defaultValue=\"formState[item.key] || ''\"\r\n        :canFull=\"item?.meta?.text_edit_component\"\r\n        @open=\"onOpenVar && onOpenVar()\"\r\n        @change=\"(text, selectedList) => onChangeDynamic && onChangeDynamic(item.key, text, selectedList)\"\r\n        :placeholder=\"t('ph_input_content')\"\r\n      >\r\n        <template #option=\"{ label, payload }\">\r\n          <div class=\"field-list-item\">\r\n            <div class=\"field-label\">{{ label }}</div>\r\n            <div class=\"field-type\">{{ payload.typ }}</div>\r\n          </div>\r\n        </template>\r\n      </AtFullInput>\r\n      <div class=\"desc\" v-html=\"rednerDesc(item.meta?.desc)\"></div>\r\n      <div v-if=\"errors[item.key]\" class=\"desc\" style=\"color:#FB363F;\">{{ errors[item.key] }}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { QuestionCircleOutlined, SettingOutlined } from '@ant-design/icons-vue'\r\nimport ZmRadioGroup from '@/components/common/zm-radio-group.vue'\r\nimport DingLoginBox from \"./components/ding-login-box.vue\";\r\nimport DingTableSelect from \"./components/ding-table-select.vue\";\r\nimport AtFullInput from \"@/views/workflow/components/at-input/at-full-input.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.dynamic-api.field-list')\r\n\r\nconst switchOptions = [\r\n  { label: t('label_on'), value: 'true' },\r\n  { label: t('label_off'), value: 'false' }\r\n]\r\ndefineProps({\r\n  actionName: {type: String},\r\n  items: { type: Array, default: () => [] },\r\n  formState: { type: Object, default: () => ({}) },\r\n  errors: { type: Object, default: () => ({}) },\r\n  apps: { type: Array, default: () => [] },\r\n  variableOptions: { type: Array, default: () => [] },\r\n  tagTypes: { type: Object, default: () => ({}) },\r\n  tagLists: { type: Object, default: () => ({}) },\r\n  showTagComponents: { type: Boolean, default: false },\r\n  sortedEnum: { type: Function },\r\n  appChange: { type: Function },\r\n  update: { type: Function },\r\n  onFieldChange: { type: Function },\r\n  onChangeDynamic: { type: Function },\r\n  filterOption: { type: Function },\r\n  tagTypeChange: { type: Function },\r\n  tagChange: { type: Function },\r\n  syncFieldTags: { type: Function },\r\n  syncingTags: { type: Object, default: () => ({}) },\r\n  dateRangeTypes: { type: Object, default: () => ({}) },\r\n  dateRangeTypeChange: { type: Function },\r\n  getRangeValue: { type: Function },\r\n  onDateRangeCalendarChange: { type: Function },\r\n  onDateRangeChange: { type: Function },\r\n  getDisabledDateForRange: { type: Function },\r\n  onOpenVar: { type: Function },\r\n  onToggleAdvanced: { type: Function }\r\n})\r\n\r\nfunction rednerDesc(text) {\r\n  if (!text || typeof text !== \"string\") {\r\n    return ''\r\n  }\r\n  return text.replace(/\\n/g, '<br/')\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.options-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-top: 12px;\r\n  line-height: 22px;\r\n  gap: 4px;\r\n\r\n  .options-item-tit {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  .option-label {\r\n    color: var(--wf-color-text-1);\r\n    font-size: 14px;\r\n    margin-right: 8px;\r\n  }\r\n\r\n  .desc {\r\n    color: var(--wf-color-text-2);\r\n    word-break: break-all;\r\n  }\r\n\r\n\r\n  &.is-required .option-label::before {\r\n    content: '*';\r\n    color: #FB363F;\r\n    display: inline-block;\r\n    margin-right: 2px;\r\n  }\r\n\r\n  .option-type {\r\n    height: 22px;\r\n    line-height: 18px;\r\n    padding: 0 8px;\r\n    border-radius: 6px;\r\n    border: 1px solid rgba(0, 0, 0, 0.15);\r\n    background-color: #fff;\r\n    color: var(--wf-color-text-3);\r\n    font-size: 12px;\r\n  }\r\n\r\n  .item-actions-box {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .action-btn {\r\n      margin-left: 12px;\r\n      font-size: 16px;\r\n      color: #595959;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n}\r\n\r\n.tag-box {\r\n  display: flex;\r\n  align-items: center;\r\n  :deep(.mention-input-warpper) {\r\n    height: 33px;\r\n  }\r\n}\r\n\r\n.date-range-separator {\r\n  padding: 0 6px;\r\n}\r\n.tip-content {\r\n  white-space: pre-wrap;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"main-box\">\r\n    <div v-if=\"loadingF || loading\" class=\"loading-box\">\r\n      <a-spin/>\r\n    </div>\r\n    <div class=\"node-options\" v-if=\"hasCacheSetting\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/setting-icon.svg\" class=\"title-icon\"/>{{ t('title_settings') }}</div>\r\n        <div class=\"acton-box\" v-if=\"clickUrl\">\r\n          <a :href=\"clickUrl\" target=\"_blank\" rel=\"noopener noreferrer\">{{ clickTitle || clickUrl }}</a>\r\n        </div>\r\n      </div>\r\n      <FieldList\r\n        :items=\"cacheParamList\"\r\n        :formState=\"formState\"\r\n        :errors=\"errors\"\r\n        :apps=\"apps\"\r\n        :variableOptions=\"variableOptions\"\r\n        :tagTypes=\"tagTypes\"\r\n        :tagLists=\"tagLists\"\r\n        :showTagComponents=\"showTagComponents\"\r\n        :sortedEnum=\"sortedEnum\"\r\n        :appChange=\"appChange\"\r\n        :onFieldChange=\"onFieldChange\"\r\n        :update=\"update\"\r\n        :onChangeDynamic=\"onChangeDynamic\"\r\n        :filterOption=\"filterOption\"\r\n        :tagTypeChange=\"tagTypeChange\"\r\n        :tagChange=\"tagChange\"\r\n        :syncFieldTags=\"syncFieldTags\"\r\n        :syncingTags=\"syncingTags\"\r\n        :dateRangeTypes=\"dateRangeTypes\"\r\n        :dateRangeTypeChange=\"dateRangeTypeChange\"\r\n        :getRangeValue=\"getRangeValue\"\r\n        :onDateRangeCalendarChange=\"onDateRangeCalendarChange\"\r\n        :onDateRangeChange=\"onDateRangeChange\"\r\n        :getDisabledDateForRange=\"getDisabledDateForRange\"\r\n        :onToggleAdvanced=\"settingsShowChange\"\r\n        :onOpenVar=\"() => emit('updateVar')\"\r\n      />\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('title_input') }}</div>\r\n        <template v-if=\"hasPluginConfigComponent\">\r\n          <a-select\r\n            v-if=\"Object.keys(configData).length\"\r\n            v-model:value=\"currentConfigName\"\r\n            @change=\"configChange\"\r\n            style=\"min-width: 160px\"\r\n          >\r\n            <a-select-option v-for=\"(item, name) in configData\" :key=\"name\" :value=\"name\">\r\n              {{ item.name || name }}\r\n            </a-select-option>\r\n          </a-select>\r\n          <a-button v-else @click=\"showConfigModal\">{{ t('btn_unauthorized') }} <DownOutlined/></a-button>\r\n        </template>\r\n      </div>\r\n      <FieldList\r\n        :items=\"displayParamList\"\r\n        :formState=\"formState\"\r\n        :errors=\"errors\"\r\n        :apps=\"apps\"\r\n        :variableOptions=\"variableOptions\"\r\n        :tagTypes=\"tagTypes\"\r\n        :tagLists=\"tagLists\"\r\n        :showTagComponents=\"showTagComponents\"\r\n        :sortedEnum=\"sortedEnum\"\r\n        :appChange=\"appChange\"\r\n        :onFieldChange=\"onFieldChange\"\r\n        :update=\"update\"\r\n        :onChangeDynamic=\"onChangeDynamic\"\r\n        :filterOption=\"filterOption\"\r\n        :tagTypeChange=\"tagTypeChange\"\r\n        :tagChange=\"tagChange\"\r\n        :syncFieldTags=\"syncFieldTags\"\r\n        :syncingTags=\"syncingTags\"\r\n        :dateRangeTypes=\"dateRangeTypes\"\r\n        :dateRangeTypeChange=\"dateRangeTypeChange\"\r\n        :getRangeValue=\"getRangeValue\"\r\n        :onDateRangeCalendarChange=\"onDateRangeCalendarChange\"\r\n        :onDateRangeChange=\"onDateRangeChange\"\r\n        :getDisabledDateForRange=\"getDisabledDateForRange\"\r\n        :onToggleAdvanced=\"settingsShowChange\"\r\n        :onOpenVar=\"() => emit('updateVar')\"\r\n      />\r\n      <template v-if=\"hasAdvancedSetting && settingsOpen\">\r\n        <FieldList\r\n          :items=\"advancedParamList\"\r\n          :formState=\"formState\"\r\n          :errors=\"errors\"\r\n          :apps=\"apps\"\r\n          :variableOptions=\"variableOptions\"\r\n          :tagTypes=\"tagTypes\"\r\n          :tagLists=\"tagLists\"\r\n          :showTagComponents=\"showTagComponents\"\r\n          :sortedEnum=\"sortedEnum\"\r\n          :appChange=\"appChange\"\r\n          :onFieldChange=\"onFieldChange\"\r\n          :update=\"update\"\r\n          :onChangeDynamic=\"onChangeDynamic\"\r\n          :filterOption=\"filterOption\"\r\n          :tagTypeChange=\"tagTypeChange\"\r\n          :tagChange=\"tagChange\"\r\n          :syncFieldTags=\"syncFieldTags\"\r\n          :syncingTags=\"syncingTags\"\r\n          :dateRangeTypes=\"dateRangeTypes\"\r\n          :dateRangeTypeChange=\"dateRangeTypeChange\"\r\n          :getRangeValue=\"getRangeValue\"\r\n          :onDateRangeCalendarChange=\"onDateRangeCalendarChange\"\r\n          :onDateRangeChange=\"onDateRangeChange\"\r\n          :getDisabledDateForRange=\"getDisabledDateForRange\"\r\n          :onToggleAdvanced=\"settingsShowChange\"\r\n          :onOpenVar=\"() => emit('updateVar')\"\r\n        />\r\n      </template>\r\n    </div>\r\n\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('title_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n\r\n    <PluginConfigModal ref=\"configModalRef\" @change=\"loadConfig(true)\"/>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, reactive, onMounted, computed, inject, watch} from 'vue'\r\nimport { DownOutlined } from '@ant-design/icons-vue'\r\nimport OutputFields from \"./output-fields.vue\";\r\nimport FieldList from \"./field-list.vue\";\r\nimport {pluginOutputToTree, getPluginConfigData} from \"@/constants/plugin.js\";\r\nimport {getWechatAppList} from \"@/api/robot/index.js\";\r\nimport { useEventBus } from '@/hooks/event/useEventBus.js'\r\nimport { isValidURL } from '@/utils/validate.js'\r\nimport { runPlugin } from '@/api/plugins/index.js'\r\nimport { message } from 'ant-design-vue'\r\nimport dayjs from 'dayjs'\r\nimport { useRoute } from 'vue-router'\r\nimport PluginConfigModal from \"@/views/explore/plugins/components/plugin-config-modal.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.dynamic-api.dynamic-api-box')\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst route = useRoute()\r\nlet pluginNameForCache = ''\r\nconst hasCacheSetting = computed(() => {\r\n  return (paramList.value || []).some((it) => {\r\n    const v = it.meta?.setting_cache_component\r\n    return v === true || v === 1 || v === 'true' || v === '1'\r\n  })\r\n})\r\nconst clickUrl = computed(() => String(formState.click_url || '').trim())\r\nconst clickTitle = computed(() => String(formState.click_title || '').trim())\r\n\r\nconst paramsMap = computed(() => props.action?.params || {})\r\nconst hasOfficial = computed(() => !!(paramsMap.value.app_id && paramsMap.value.app_secret))\r\nconst paramList = computed(() => {\r\n  const list = Object.entries(paramsMap.value || {}).map(([key, meta]) => ({ key, meta }))\r\n  return list\r\n    .filter(it => !it.meta?.hide_official_component)\r\n    .sort((a, b) => (+(a.meta?.sort_num || 0)) - (+(b.meta?.sort_num || 0)))\r\n})\r\nfunction sortedEnum(list) {\r\n  return (list || []).slice().sort((a, b) => (+(a.sort_num || 0)) - (+(b.sort_num || 0)))\r\n}\r\n\r\n\r\nconst formState = reactive({\r\n  app_id: '',\r\n  app_secret: '',\r\n  app_name: '',\r\n  extras: {}\r\n})\r\nconst loading = ref(false)\r\nconst loadingF = ref(false)\r\nconst apps = ref([])\r\nconst errors = reactive({})\r\n\r\nconst outputData = ref([])\r\n\r\nconst tagLists = reactive({})\r\nconst tagTypes = reactive({})\r\nconst syncingTags = reactive({})\r\nconst dateRangeTypes = reactive({})\r\nconst dateAnchors = reactive({})\r\n\r\nconst configModalRef = ref(null)\r\nconst configData = ref({})\r\nconst currentConfigName = ref(null)\r\nconst settingsOpen = ref(false)\r\n\r\nconst showTagComponents = computed(() => {\r\n  const hasTag = paramList.value.some((it) => it.meta?.tag_component)\r\n  if (!hasTag) return false\r\n  return paramList.value.some((it) => {\r\n    const meta = it.meta || {}\r\n    const enumList = Array.isArray(meta.enum) ? meta.enum : []\r\n    if (!(meta.enum_component || meta.radio_component || meta.switch_component) || enumList.length === 0) return false\r\n    const selected = String(formState[it.key] ?? '')\r\n    const opt = enumList.find((e) => String(e?.value) === selected)\r\n    const related = opt?.related_tags\r\n    return related === true || related === 1 || related === 'true' || related === '1'\r\n  })\r\n})\r\n\r\nconst hasPluginConfigComponent = computed(() => {\r\n  return (paramList.value || []).some((it) => {\r\n    const v = it.meta?.plugin_config_component\r\n    return v === true || v === 1 || v === 'true' || v === '1'\r\n  })\r\n})\r\nconst hasAdvancedSetting = computed(() => {\r\n  const useAdv = props.action?.use_advanced_settings\r\n  const anyAdvField = (paramList.value || []).some((it) => {\r\n    const v = it.meta?.advanced_settings\r\n    return v === true || v === 1 || v === 'true' || v === '1'\r\n  })\r\n  return (useAdv === true || useAdv === 1 || useAdv === 'true' || useAdv === '1') || anyAdvField\r\n})\r\n\r\nconst displayParamList = computed(() => {\r\n  const isCacheField = (meta) => {\r\n    const v = meta?.setting_cache_component\r\n    return v === true || v === 1 || v === 'true' || v === '1'\r\n  }\r\n  return (paramList.value || [])\r\n    .filter((it) => !(it.meta?.tag_component && !showTagComponents.value))\r\n    .filter((it) => !(it.meta?.plugin_config_component))\r\n    .filter((it) => {\r\n      const v = it.meta?.advanced_settings\r\n      const isAdv = v === true || v === 1 || v === 'true' || v === '1'\r\n      return !isAdv\r\n    })\r\n    .filter((it) => !isCacheField(it.meta))\r\n})\r\nconst cacheParamList = computed(() => {\r\n  return (paramList.value || []).filter((it) => {\r\n    const v = it.meta?.setting_cache_component\r\n    return v === true || v === 1 || v === 'true' || v === '1'\r\n  })\r\n})\r\nconst advancedParamList = computed(() => {\r\n  return (paramList.value || []).filter((it) => {\r\n    const v = it.meta?.advanced_settings\r\n    const isAdv = v === true || v === 1 || v === 'true' || v === '1'\r\n    const pc = it.meta?.plugin_config_component\r\n    const isPc = pc === true || pc === 1 || pc === 'true' || pc === '1'\r\n    return isAdv && !isPc\r\n  })\r\n})\r\n\r\nwatch(showTagComponents, (val) => {\r\n  if (!val) {\r\n    let changed = false\r\n    paramList.value.forEach((it) => {\r\n      if (it.meta?.tag_component) {\r\n        if (formState[it.key]) {\r\n          formState[it.key] = ''\r\n          changed = true\r\n        }\r\n        if (Array.isArray(formState[it.key + '_tags']) && formState[it.key + '_tags'].length) {\r\n          formState[it.key + '_tags'] = []\r\n          changed = true\r\n        }\r\n      }\r\n    })\r\n    if (changed) update()\r\n  }\r\n})\r\n\r\nonMounted(() => {\r\n  init()\r\n  const bus = useEventBus({\r\n    name: 'workflow:validate',\r\n    callback: onWorkflowValidate\r\n  })\r\n})\r\n\r\nasync function init() {\r\n  if (hasOfficial.value) {\r\n    await loadWxApps()\r\n  }\r\n  nodeParamsAssign()\r\n  if (hasPluginConfigComponent.value) {\r\n    await loadConfig()\r\n  }\r\n  paramList.value.forEach(async it => {\r\n    const def = String(it.meta?.enum_default || '').trim()\r\n    if ((it.meta?.radio_component || it.meta?.enum_component || it.meta?.switch_component) && !String(formState[it.key] || '').trim() && def) {\r\n      formState[it.key] = def\r\n    }\r\n    if (it.meta?.tag_component) {\r\n      tagTypes[it.key] = typeof tagTypes[it.key] === 'number' ? tagTypes[it.key] : 1\r\n      await loadFieldTags(it.key, it.meta?.query_tag_service)\r\n    }\r\n  })\r\n  loadCacheForEmptyFields()\r\n  outputFormat()\r\n}\r\n\r\nfunction loadWxApps() {\r\n  return getWechatAppList({app_type: 'official_account'}).then(res => {\r\n    apps.value = res?.data || []\r\n  })\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  pluginNameForCache = nodeParams?.plugin?.name || ''\r\n  let arg = nodeParams?.plugin?.params?.arguments || {}\r\n  paramList.value.forEach(it => {\r\n    formState[it.key] = it.key !== 'app_id' ? String(arg[it.key] || '').trim() : arg[it.key]\r\n    const tagMap = arg?.tag_map || {}\r\n    formState[it.key + '_tags'] = Array.isArray(tagMap[it.key]) ? tagMap[it.key] : []\r\n    if (it.meta?.date_range_begin_component) {\r\n      const endKey = it.meta?.end_date_key\r\n      const typeKey = it.meta?.date_type_key\r\n      formState[endKey] = String(arg[endKey] || '').trim()\r\n      formState[endKey + '_tags'] = Array.isArray(tagMap[endKey]) ? tagMap[endKey] : []\r\n      const typeVal = arg[typeKey]\r\n      dateRangeTypes[it.meta?.begin_date_key] =\r\n        typeof dateRangeTypes[it.meta?.begin_date_key] === 'number'\r\n          ? dateRangeTypes[it.meta?.begin_date_key]\r\n          : (typeVal == null ? 1 : Number(typeVal) || 1)\r\n    }\r\n  })\r\n  if (arg.app_secret) formState.app_secret = String(arg.app_secret)\r\n  if (arg.app_name) formState.app_name = String(arg.app_name)\r\n  if (arg.extras) formState.extras = arg.extras\r\n}\r\n\r\nfunction appChange (value, option) {\r\n  if (option && option.app_secret) {\r\n    formState.app_secret = option.app_secret\r\n  }\r\n  if (option && option.name) {\r\n    formState.app_name = option.name\r\n  }\r\n  update()\r\n  paramList.value.forEach(async it => {\r\n    if (it.meta?.tag_component) {\r\n      await loadFieldTags(it.key, it.meta?.query_tag_service)\r\n    }\r\n  })\r\n}\r\n\r\nfunction onWorkflowValidate() {\r\n  console.log('node', props.node)\r\n  const bus = useEventBus()\r\n  const res = validateAll()\r\n  if (res && res.ok === false) {\r\n    bus.emit && bus.emit('workflow:validate:error', {\r\n      component: props.node?.node_name,\r\n      type: '',\r\n      typeDisplay: '',\r\n      message: '请完善字段后再继续',\r\n      errors: res.errors || []\r\n    })\r\n  }\r\n}\r\n\r\nfunction update(val = null) {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  nodeParams.plugin.output_obj = outputData.value\r\n  const args = buildArguments()\r\n  injectConfigArgs(args)\r\n  Object.assign(nodeParams.plugin.params, {\r\n    arguments: {\r\n      ...args,\r\n      tag_map: {\r\n        ...buildTagMap()\r\n      }\r\n    },\r\n    rendering: buildRendering()\r\n  })\r\n  if (hasPluginConfigComponent.value) {\r\n    nodeParams.plugin.params.config_name = currentConfigName.value || ''\r\n  }\r\n  nodeParams.plugin.params.use_plugin_config = !!hasPluginConfigComponent.value\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n  storeAllToCache()\r\n}\r\n\r\nfunction onChangeDynamic (key, text, selectedList, extras = {}) {\r\n  formState[key] = text\r\n  formState[key + '_tags'] = selectedList\r\n  if (typeof formState.extras === \"object\") {\r\n    Object.assign(formState.extras, extras)\r\n  } else {\r\n    formState.extras = extras\r\n  }\r\n  update()\r\n}\r\n\r\nfunction onFieldChange (key, value) {\r\n  formState[key] = value\r\n  update()\r\n}\r\n\r\nfunction sanitizeStr(s) {\r\n  return String(s || '').replace(/`/g, '').trim()\r\n}\r\nfunction buildCacheKey(fieldKey) {\r\n  const wfId = String(route.query.id || '')\r\n  return `${wfId}:${pluginNameForCache}:${fieldKey}`\r\n}\r\nfunction loadCacheForEmptyFields() {\r\n  if (!hasCacheSetting.value) return\r\n  let url = ''\r\n  let title = ''\r\n  for (const it of (paramList.value || [])) {\r\n    const v = it.meta?.setting_cache_component\r\n    const enabled = v === true || v === 1 || v === 'true' || v === '1'\r\n    if (!enabled) continue\r\n    if (!url) {\r\n      const u = sanitizeStr(it.meta?.click_url)\r\n      const t = sanitizeStr(it.meta?.click_title)\r\n      if (u) {\r\n        url = u\r\n        title = t\r\n      }\r\n    }\r\n    const k = it.key\r\n    const cur = String(formState[k] == null ? '' : formState[k]).trim()\r\n    if (!cur) {\r\n      const cache = localStorage.getItem(buildCacheKey(k))\r\n      if (cache != null) {\r\n        formState[k] = it.key === 'app_id' ? cache : String(cache)\r\n      }\r\n    }\r\n  }\r\n  if (url) formState.click_url = url\r\n  if (title) formState.click_title = title\r\n}\r\nfunction storeAllToCache() {\r\n  if (!hasCacheSetting.value) return\r\n  paramList.value.forEach((it) => {\r\n    const cfg = it.meta?.setting_cache_component\r\n    const enabled = cfg === true || cfg === 1 || cfg === 'true' || cfg === '1'\r\n    if (!enabled) return\r\n    const k = it.key\r\n    const val = String(formState[k] == null ? '' : formState[k])\r\n    localStorage.setItem(buildCacheKey(k), val)\r\n  })\r\n}\r\n\r\nfunction buildRendering () {\r\n  return paramList.value\r\n    .filter((it) => {\r\n      if (it.meta?.tag_component && !showTagComponents.value) return false\r\n      const v = it.meta?.setting_cache_component\r\n      const isCache = v === true || v === 1 || v === 'true' || v === '1'\r\n      if (isCache) return false\r\n      if (it.meta?.plugin_config_component) return false\r\n      if (it.meta?.advanced_settings) return false\r\n      return true\r\n    })\r\n    .map((it) => {\r\n    let label = it.meta?.name || it.key\r\n    let value = String(formState[it.key] ?? '')\r\n\r\n    const tags = Array.isArray(formState[it.key + '_tags']) ? formState[it.key + '_tags'] : []\r\n    if (it.key === 'app_id') {\r\n      label = t('label_official_account_name')\r\n      value = String(formState.app_name ?? '')\r\n    }\r\n    if (it.meta?.select_remote_component && it.key === 'sheetIdOrName' && formState?.extras?.table_name) {\r\n      value = String(formState.extras.table_name)\r\n    }\r\n    if (it.meta?.enum_component || it.meta?.radio_component || it.meta?.switch_component) {\r\n      const opt = (it.meta?.enum || []).find((e) => String(e?.value) === value)\r\n      if (opt && opt.name) {\r\n        value = String(opt.name)\r\n      }\r\n    }\r\n    if (it.meta?.tag_component && tagTypes[it.key] == 1) {\r\n      const opt = (tagLists[it.key] || []).find((t) => String(t.id) === String(value))\r\n      if (opt && opt.name) {\r\n        value = String(opt.name)\r\n      }\r\n    }\r\n    if (it.meta?.date_range_begin_component) {\r\n      const beginKey = it.meta?.begin_date_key\r\n      const endKey = it.meta?.end_date_key\r\n      const beginVal = String(formState[beginKey] || '')\r\n      const endVal = String(formState[endKey] || '')\r\n      const beginTags = Array.isArray(formState[beginKey + '_tags']) ? formState[beginKey + '_tags'] : []\r\n      const endTags = Array.isArray(formState[endKey + '_tags']) ? formState[endKey + '_tags'] : []\r\n      value = [beginVal, endVal].filter(Boolean).join(' ~ ')\r\n      const mergedTags = [...beginTags, ...endTags]\r\n      return {\r\n        label,\r\n        value,\r\n        key: it.key,\r\n        tags: mergedTags\r\n      }\r\n    }\r\n    return {\r\n      label,\r\n      value,\r\n      key: it.key,\r\n      tags\r\n    }\r\n  })\r\n}\r\n\r\nfunction buildTagMap() {\r\n  const tagMap = {}\r\n  paramList.value.forEach((it) => {\r\n    if (it.meta?.plugin_config_component) return\r\n    if (it.meta?.tag_component && !showTagComponents.value) return\r\n    const tags = Array.isArray(formState[it.key + '_tags']) ? formState[it.key + '_tags'] : []\r\n    if (tags.length) {\r\n      tagMap[it.key] = tags\r\n    }\r\n    if (it.meta?.date_range_begin_component) {\r\n      const endKey = it.meta?.end_date_key\r\n      const endTags = Array.isArray(formState[endKey + '_tags']) ? formState[endKey + '_tags'] : []\r\n      if (endTags.length) {\r\n        tagMap[endKey] = endTags\r\n      }\r\n    }\r\n  })\r\n  return tagMap\r\n}\r\n\r\nfunction buildArguments() {\r\n  const args = {}\r\n  paramList.value.forEach(it => {\r\n    if (it.meta?.plugin_config_component) return\r\n    if (it.meta?.tag_component && !showTagComponents.value) return\r\n    args[it.key] = String(formState[it.key] || '')\r\n    if (it.meta?.date_range_begin_component) {\r\n      const endKey = it.meta?.end_date_key\r\n      const typeKey = it.meta?.date_type_key\r\n      args[endKey] = String(formState[endKey] || '')\r\n      const typeVal = dateRangeTypes[it.meta?.begin_date_key] || 1\r\n      args[typeKey] = String(typeVal)\r\n    }\r\n  })\r\n  if (formState.app_secret) {\r\n    args.app_secret = String(formState.app_secret || '')\r\n  }\r\n  if (formState.app_name) {\r\n    args.app_name = String(formState.app_name || '')\r\n  }\r\n  if (formState.extras) {\r\n    args.extras = formState.extras\r\n  }\r\n  return args\r\n}\r\n\r\nfunction outputFormat() {\r\n  outputData.value = pluginOutputToTree(props.action.output)\r\n  update()\r\n}\r\n\r\nfunction validateAll () {\r\n  Object.keys(errors).forEach(k => { errors[k] = '' })\r\n  const result = { ok: true, errors: [] }\r\n  paramList.value.forEach(it => {\r\n    const key = it.key\r\n    const meta = it.meta || {}\r\n    const raw = formState[key]\r\n    const val = String(raw == null ? '' : raw).trim()\r\n    const tags = Array.isArray(formState[key + '_tags']) ? formState[key + '_tags'] : []\r\n    if (meta.plugin_config_component) {\r\n      return\r\n    }\r\n    if (meta.select_official_component) {\r\n      if (meta.required && !val) {\r\n        const msg = meta.error || t('msg_select_official_account')\r\n        errors[key] = msg\r\n        result.ok = false\r\n        result.errors.push({ field_name: meta.name || key, message: msg })\r\n      }\r\n      return\r\n    }\r\n    if (meta.enum_component || meta.radio_component || meta.switch_component) {\r\n      const enums = (meta.enum || []).map(it => String(it.value))\r\n      if (meta.required && !val) {\r\n        const msg = meta.error || t('msg_please_select')\r\n        errors[key] = msg\r\n        result.ok = false\r\n        result.errors.push({ field_name: meta.name || key, message: msg })\r\n      } else if (val && enums.length && !enums.includes(val)) {\r\n        const msg = meta.error || t('msg_invalid_selection')\r\n        errors[key] = msg\r\n        result.ok = false\r\n        result.errors.push({ field_name: meta.name || key, message: msg })\r\n      }\r\n      return\r\n    }\r\n    if (meta.date_range_begin_component) {\r\n      const beginKey = meta.begin_date_key\r\n      const endKey = meta.end_date_key\r\n      const beginVal = String(formState[beginKey] || '').trim()\r\n      const endVal = String(formState[endKey] || '').trim()\r\n      const beginTags = Array.isArray(formState[beginKey + '_tags']) ? formState[beginKey + '_tags'] : []\r\n      const endTags = Array.isArray(formState[endKey + '_tags']) ? formState[endKey + '_tags'] : []\r\n      if (meta.required && (!beginVal && beginTags.length === 0 || !endVal && endTags.length === 0)) {\r\n        const msg = meta.error || t('msg_select_date_range')\r\n        errors[key] = msg\r\n        result.ok = false\r\n        result.errors.push({ field_name: meta.name || key, message: msg })\r\n        return\r\n      }\r\n      const typeVal = dateRangeTypes[beginKey]\r\n      if (typeVal === 2) {\r\n        // 插入变量模式：仅校验纯文本输入的格式为 YYYY-MM-DD；引用变量不校验格式\r\n        const isValidDateStr = (str) => {\r\n          if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(str)) return false\r\n          const d = dayjs(str)\r\n          return d.isValid()\r\n        }\r\n        if (beginVal && beginTags.length === 0 && !isValidDateStr(beginVal)) {\r\n          const msg = meta.error || t('msg_start_date_format')\r\n          errors[key] = msg\r\n          result.ok = false\r\n          result.errors.push({ field_name: meta.name || key, message: msg })\r\n          return\r\n        }\r\n        if (endVal && endTags.length === 0 && !isValidDateStr(endVal)) {\r\n          const msg = meta.error || t('msg_end_date_format')\r\n          errors[key] = msg\r\n          result.ok = false\r\n          result.errors.push({ field_name: meta.name || key, message: msg })\r\n          return\r\n        }\r\n      }\r\n      if (beginVal && endVal) {\r\n        const b = dayjs(beginVal)\r\n        const e = dayjs(endVal)\r\n        if (e.isBefore(b)) {\r\n          const msg = meta.error || t('msg_end_after_start')\r\n          errors[key] = msg\r\n          result.ok = false\r\n          result.errors.push({ field_name: meta.name || key, message: msg })\r\n          return\r\n        }\r\n        const interval = e.diff(b, 'day')\r\n        const allowedDays = Number(meta.date_range_max_interval || 0)\r\n        if (allowedDays > 0 && (interval + 1) > allowedDays) {\r\n          const msg = meta.error || t('msg_date_range_limit', { days: allowedDays })\r\n          errors[key] = msg\r\n          result.ok = false\r\n          result.errors.push({ field_name: meta.name || key, message: msg })\r\n          return\r\n        }\r\n      }\r\n      return\r\n    }\r\n    if (meta.required && !val && (!Array.isArray(tags) || tags.length === 0)) {\r\n      const msg = meta.error || t('msg_please_input_content')\r\n      errors[key] = msg\r\n      result.ok = false\r\n      result.errors.push({ field_name: meta.name || key, message: msg })\r\n    } else if (key.toLowerCase().includes('url') && val && (!Array.isArray(tags) || tags.length === 0)) {\r\n      const ok = /^https?:\\/\\//.test(val) || isValidURL(val)\r\n      if (!ok) {\r\n        const msg = meta.error || t('msg_correct_url')\r\n        errors[key] = msg\r\n        result.ok = false\r\n        result.errors.push({ field_name: meta.name || key, message: msg })\r\n      }\r\n    }\r\n  })\r\n  return result\r\n}\r\n\r\nfunction tagTypeChange(fieldKey, val, meta) {\r\n  tagTypes[fieldKey] = val\r\n  if (val == 1) {\r\n    loadFieldTags(fieldKey, meta?.query_tag_service)\r\n  }\r\n}\r\n\r\nfunction tagChange(fieldKey, val, opt) {\r\n  formState[fieldKey] = val\r\n  formState[fieldKey + '_name'] = opt?.name || ''\r\n  update()\r\n}\r\n\r\nfunction loadFieldTags(fieldKey, service) {\r\n  const nodeParams = JSON.parse(props.node.node_params)\r\n  const pluginName = nodeParams?.plugin?.name\r\n  if (!pluginName || !service) {\r\n    tagLists[fieldKey] = []\r\n    return Promise.resolve([])\r\n  }\r\n  if (!formState.app_id || !formState.app_secret) {\r\n    tagLists[fieldKey] = []\r\n    return Promise.resolve([])\r\n  }\r\n  return runPlugin({\r\n    name: pluginName,\r\n    action: 'default/exec',\r\n    params: JSON.stringify({\r\n      business: service,\r\n      arguments: {\r\n        app_id: formState.app_id,\r\n        app_secret: formState.app_secret\r\n      }\r\n    })\r\n  }).then((res) => {\r\n    tagLists[fieldKey] = res?.data?.tags || []\r\n    return res\r\n  })\r\n}\r\n\r\nfunction syncFieldTags(fieldKey, meta) {\r\n  if (!formState.app_id || !formState.app_secret) {\r\n    return message.warning(t('msg_select_official_account_first'))\r\n  }\r\n  if (syncingTags[fieldKey]) return\r\n  syncingTags[fieldKey] = true\r\n  loadFieldTags(fieldKey, meta?.query_tag_service)\r\n    .then(() => {\r\n      message.success(t('msg_sync_completed'))\r\n    })\r\n    .finally(() => {\r\n      syncingTags[fieldKey] = false\r\n    })\r\n}\r\n\r\nconst filterOption = (input, option) => {\r\n  return option.name.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n}\r\n\r\nfunction dateRangeTypeChange(meta, val) {\r\n  dateRangeTypes[meta.begin_date_key] = val\r\n  const typeKey = meta?.date_type_key\r\n  if (typeKey) {\r\n    formState[typeKey] = String(val)\r\n  }\r\n  const beginKey = meta.begin_date_key\r\n  const endKey = meta.end_date_key\r\n  if (val === 1) {\r\n    formState[beginKey] = ''\r\n    formState[endKey] = ''\r\n    formState[beginKey + '_tags'] = []\r\n    formState[endKey + '_tags'] = []\r\n    dateAnchors[beginKey] = null\r\n  } else if (val === 2) {\r\n    formState[beginKey] = ''\r\n    formState[endKey] = ''\r\n    dateAnchors[beginKey] = null\r\n  }\r\n  update()\r\n}\r\n\r\nfunction getRangeValue(meta) {\r\n  const b = formState[meta.begin_date_key]\r\n  const e = formState[meta.end_date_key]\r\n  return [b ? dayjs(b) : null, e ? dayjs(e) : null]\r\n}\r\n\r\nfunction onDateRangeCalendarChange(meta, dates) {\r\n  const key = meta.begin_date_key\r\n  if (Array.isArray(dates) && dates[0]) {\r\n    dateAnchors[key] = dates[0]\r\n  } else {\r\n    dateAnchors[key] = null\r\n  }\r\n}\r\n\r\nfunction onDateRangeChange(meta, dates, dateStrings) {\r\n  formState[meta.begin_date_key] = dateStrings[0] || ''\r\n  formState[meta.end_date_key] = dateStrings[1] || ''\r\n  if ((!dateStrings[0] && !dateStrings[1])) {\r\n    dateAnchors[meta.begin_date_key] = null\r\n  }\r\n  update()\r\n}\r\n\r\nfunction getDisabledDateForRange(meta, current) {\r\n  if (!current) return false\r\n  const endMax = meta.end_date_max ? dayjs(meta.end_date_max) : null\r\n  if (endMax && current.isAfter(endMax, 'day')) return true\r\n  const anchor = dateAnchors[meta.begin_date_key]\r\n  const maxInterval = Number(meta.date_range_max_interval || 0)\r\n  if (anchor && maxInterval > 0) {\r\n    const limit = dayjs(anchor).add(maxInterval - 1, 'day')\r\n    return current.isAfter(limit, 'day')\r\n  }\r\n  return false\r\n}\r\n\r\nfunction loadConfig(refresh=false) {\r\n  return getPluginConfigData(pluginNameForCache, refresh).then(res => {\r\n    configData.value = res || {}\r\n    const names = Object.keys(configData.value)\r\n    const defName = names.find((n) => configData.value[n]?.is_default)\r\n    let wantName = null\r\n    try {\r\n      const nodeParams = JSON.parse(props.node.node_params)\r\n      wantName = nodeParams?.plugin?.params?.config_name || ''\r\n    } catch (e) {}\r\n    if (wantName && names.includes(wantName)) {\r\n      currentConfigName.value = wantName\r\n    } else {\r\n      currentConfigName.value = defName || names[0] || null\r\n    }\r\n  })\r\n}\r\nfunction showConfigModal() {\r\n  const schemaData = { [props.actionName || 'default']: props.action || {} }\r\n  configModalRef.value && configModalRef.value.show(configData.value, pluginNameForCache, schemaData)\r\n}\r\nfunction configChange() {\r\n  let args = []\r\n  injectConfigArgs(args)\r\n  Object.assign(formState, args)\r\n  update()\r\n}\r\nfunction settingsShowChange() {\r\n  settingsOpen.value = !settingsOpen.value\r\n}\r\n\r\nfunction injectConfigArgs(args) {\r\n  try {\r\n    const cfgName = currentConfigName.value || ''\r\n    const cfg = cfgName ? (configData.value?.[cfgName] || {}) : {}\r\n    if (!cfg || Object.keys(cfg).length === 0) return\r\n    paramList.value.forEach((it) => {\r\n      const meta = it.meta || {}\r\n      const isCfgField = meta.plugin_config_component === true || meta.plugin_config_component === 1 || meta.plugin_config_component === 'true' || meta.plugin_config_component === '1'\r\n      if (!isCfgField) return\r\n      const k = it.key\r\n      const v = cfg[k]\r\n      if (v != null) {\r\n        args[k] = sanitizeStr(v)\r\n      }\r\n    })\r\n  } catch (e) {}\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.loading-box {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 99;\r\n}\r\n.node-options {\r\n  background: #f2f4f7;\r\n  border-radius: 6px;\r\n  padding: 12px;\r\n  margin-top: 16px;\r\n\r\n  &:first-child {\r\n    margin-top: 0;\r\n  }\r\n\r\n  .options-title {\r\n    color: var(--wf-color-text-1);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    font-weight: 600;\r\n    height: 22px;;\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    margin-bottom: 16px;\r\n\r\n    .title-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      vertical-align: -3px;\r\n      margin-right: 8px;;\r\n    }\r\n\r\n    .acton-box {\r\n      font-weight: 400;\r\n    }\r\n  }\r\n\r\n.options-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-top: 12px;\r\n  line-height: 22px;\r\n  gap: 4px;\r\n\r\n    .options-item-tit {\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-1);\r\n      font-size: 14px;\r\n      margin-right: 8px;\r\n    }\r\n\r\n    .desc {\r\n      color: var(--wf-color-text-2);\r\n    }\r\n\r\n\r\n    &.is-required .option-label::before {\r\n      content: '*';\r\n      color: #FB363F;\r\n      display: inline-block;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-type {\r\n      height: 22px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 6px;\r\n      border: 1px solid rgba(0, 0, 0, 0.15);\r\n      background-color: #fff;\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n    }\r\n\r\n    .item-actions-box {\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      .action-btn {\r\n        margin-left: 12px;\r\n        font-size: 16px;\r\n        color: #595959;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n  }\r\n}\r\n.tag-box {\r\n  display: flex;\r\n  align-items: center;\r\n  :deep(.mention-input-warpper) {\r\n    height: 33px;\r\n  }\r\n}\r\n\r\n.date-range-separator {\r\n  padding: 0 6px;\r\n}\r\n\r\n.tip-content {\r\n  white-space: pre-wrap;\r\n}\r\n</style>\r\n","<style scoped lang=\"less\">\r\n@import \"../node-options.less\";\r\n.node-icon{\r\n  display: block;\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 6px;\r\n}\r\n.kv {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin: 4px 0;\r\n  .k {\r\n    width: 80px;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n  .v {\r\n    flex: 1;\r\n    color: var(--wf-color-text-1);\r\n    word-break: break-all;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :desc=\"descText\">\r\n        <template #node-icon>\r\n          <img v-if=\"node.properties?.node_icon\" class=\"node-icon\" :src=\"node.properties.node_icon\"/>\r\n          <a-spin v-else size=\"small\"/>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div>\r\n      <div class=\"node-options\">\r\n        <div class=\"options-title\">\r\n          <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>输入</div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"kv\"><div class=\"k\">请求方法</div><div class=\"v\">{{ state.method }}</div></div>\r\n          <div class=\"kv\"><div class=\"k\">请求地址</div><div class=\"v\">{{ state.url }}</div></div>\r\n          <div class=\"kv\" v-if=\"state.query\"><div class=\"k\">查询参数</div><div class=\"v\">{{ state.query }}</div></div>\r\n          <div class=\"kv\" v-if=\"state.headers\"><div class=\"k\">请求头</div><div class=\"v\">{{ state.headers }}</div></div>\r\n          <div class=\"kv\" v-if=\"state.body\"><div class=\"k\">请求体</div><div class=\"v\">{{ state.body }}</div></div>\r\n        </div>\r\n      </div>\r\n      <div class=\"node-options\">\r\n        <div class=\"options-title\">\r\n          <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>输出</div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <OutputFields :tree-data=\"outputData\"/>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, inject, onMounted, computed} from 'vue'\r\nimport NodeFormLayout from '../../node-form-layout.vue'\r\nimport NodeFormHeader from '../../node-form-header.vue'\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\n\r\nconst setData = inject('setData')\r\n\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst outputData = ref([])\r\nconst state = ref({\r\n  method: '',\r\n  url: '',\r\n  query: '',\r\n  headers: '',\r\n  body: ''\r\n})\r\n\r\nconst descText = computed(() => {\r\n  return `${state.value.method || ''} ${state.value.url || ''}`.trim()\r\n})\r\n\r\nfunction init() {\r\n  const nodeParams = JSON.parse(props.node.node_params || '{}')\r\n  const args = nodeParams?.plugin?.params?.arguments || {}\r\n  state.value.method = args.method || ''\r\n  state.value.url = args.url || ''\r\n  state.value.query = args.query || ''\r\n  state.value.headers = args.headers || ''\r\n  state.value.body = args.body || ''\r\n  outputData.value = nodeParams?.plugin?.output_obj || []\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n","<template>\r\n  <a-modal\r\n    v-model:open=\"open\"\r\n    :footer=\"null\"\r\n    wrapClassName=\"qrcode-wrap\"\r\n    width=\"380px\"\r\n  >\r\n    <div class=\"qrcode-box\">\r\n      <div class=\"title\">{{ t('title_scan_to_login') }}</div>\r\n      <div class=\"content\">\r\n        <div class=\"tip\">{{ t('msg_scan_with_wechat') }}</div>\r\n        <img class=\"qrcode\" src=\"https://xiaokefu.com.cn/static/home/img/zhima.jpg\"/>\r\n        <div class=\"desc\">{{ t('msg_qrcode_valid') }}</div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref} from 'vue'\r\nimport {useI18n} from '@/hooks/web/useI18n'\r\n\r\nconst {t} = useI18n('components.common.qrcode-box')\r\n\r\nconst open = ref(false)\r\n\r\nfunction show() {\r\n  open.value = true\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n})\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.qrcode-wrap.ant-modal-wrap {\r\n  .ant-modal-content {\r\n    padding: 0;\r\n  }\r\n}\r\n</style>\r\n<style scoped lang=\"less\">\r\n.qrcode-box {\r\n  .title {\r\n    color: #000000;\r\n    font-size: 24px;\r\n    font-weight: 600;\r\n    padding: 32px 24px;\r\n    position: relative;\r\n    &::before {\r\n      content: \"\";\r\n      position: absolute;\r\n      width: 100%;\r\n      height: 100%;\r\n      left: 0;\r\n      top: -18px;\r\n      background: url(\"@/assets/img/login-pop-bg.png\") no-repeat;\r\n      background-size: 100% 100%;\r\n    }\r\n    &::after {\r\n      content: \"扫码登录\";\r\n      position: absolute;\r\n      color: #000000;\r\n      font-size: 24px;\r\n      font-weight: 600;\r\n      left: 24px;\r\n      top: 24px;\r\n    }\r\n  }\r\n  .content {\r\n    display: flex;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    gap: 12px;\r\n    color: #262626;\r\n    font-size: 14px;\r\n    padding: 0 24px 24px;\r\n\r\n    .qrcode {\r\n      width: 170px;\r\n      height: 170px;\r\n    }\r\n\r\n    .desc {\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"_main-box\">\r\n    <div v-if=\"!loginStatus\" class=\"login-info-box\">\r\n      <div class=\"tit\">{{ t('title_login') }}</div>\r\n      <a-button type=\"primary\" class=\"link\" @click=\"goLogin\">{{ t('btn_login') }}</a-button>\r\n      <div class=\"desc\">{{ t('msg_logged_in') }}\r\n        <a-button type=\"link\" @click=\"refresh\" :loading=\"loading\">{{ t('btn_refresh') }}</a-button>\r\n      </div>\r\n    </div>\r\n    <PluginFormRender\r\n      ref=\"formRef\"\r\n      :node=\"node\"\r\n      :params=\"action.params\"\r\n      :output=\"action.output\"\r\n      :variableOptions=\"variableOptions\"\r\n      @updateVar=\"emit('updateVar')\">\r\n      <template v-if=\"loginStatus\" #input-title-extra>\r\n        <div class=\"official-info\">\r\n          <img class=\"avatar\" :src=\"loginInfo?.headimgurl\"/>\r\n          <span>{{ loginInfo?.nickname }}</span>\r\n          <CheckCircleFilled class=\"icon\"/>\r\n        </div>\r\n      </template>\r\n      <template #username=\"{state, keyName, item}\"></template>\r\n    </PluginFormRender>\r\n\r\n    <QrcodeBox/>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {onMounted, ref, computed} from 'vue';\r\nimport { useI18n } from 'vue-i18n';\r\nimport {CheckCircleFilled} from '@ant-design/icons-vue';\r\nimport PluginFormRender from \"../pluginFormRender.vue\";\r\nimport QrcodeBox from \"@/components/common/qrcode-box.vue\";\r\nimport {useOfficialArticleLogin} from \"@/composables/useOfficialArticleLogin.js\";\r\nimport {useUserStore} from \"@/stores/modules/user.js\";\r\n\r\nconst { t } = useI18n();\r\n\r\nconst emit = defineEmits(['updateVar'])\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  action: {\r\n    type: Object,\r\n  },\r\n  actionName: {\r\n    type: String,\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n  }\r\n})\r\n\r\nconst {\r\n  loginInfo,\r\n  loginStatus,\r\n  loading,\r\n  refresh,\r\n  goLogin\r\n} = useOfficialArticleLogin()\r\n\r\nconst userStore = useUserStore()\r\nconst formRef = ref(null)\r\n\r\n// 开源版本仅支持admin\r\n// const username = computed(() => {\r\n//   return userStore?.userInfo?.user_id\r\n// })\r\nconst username = ref('admin')\r\n\r\nonMounted(() => {\r\n  formRef.value.setState({\r\n    username: {\r\n      value: username.value,\r\n      tags: []\r\n    },\r\n  })\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.login-info-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  border-radius: 6px;\r\n  padding: 24px;\r\n  background: #F2F4F7;\r\n  margin-bottom: 16px;\r\n\r\n  .link {\r\n    width: 168px;\r\n    margin-top: 16px;\r\n  }\r\n\r\n  .tit {\r\n    color: #262626;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n  }\r\n\r\n  .desc {\r\n    color: #8c8c8c;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    margin: 12px 0;\r\n\r\n    :deep(.ant-btn) {\r\n      padding: 0;\r\n    }\r\n  }\r\n}\r\n\r\n.official-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  color: #262626;\r\n  font-size: 14px;\r\n\r\n  .avatar {\r\n    width: 16px;\r\n    height: 16px;\r\n    border-radius: 4px;\r\n  }\r\n\r\n  .icon {\r\n    color: #21A665;\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n@import \"./components/node-options\";\r\n.node-icon{\r\n  display: block;\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 6px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :desc=\"showDesc\">\r\n        <template #node-icon>\r\n          <img v-if=\"info.icon\" class=\"node-icon\" :src=\"info.icon\"/>\r\n          <a-spin v-else size=\"small\"/>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <!-- 根据params动态渲染的组件 -->\r\n    <template v-if=\"actionInfo?.common_template\">\r\n      <!--自定义渲染-->\r\n      <DynamicApiBox\r\n        :node=\"node\"\r\n        :action=\"actionInfo\"\r\n        :actionName=\"nodeParams.plugin.params.business\"\r\n        :variableOptions=\"variableOptions\"\r\n        @updateVar=\"getValueVariableList\"\r\n      />\r\n    </template>\r\n\r\n    <!--方法插件-->\r\n    <template v-else-if=\"pluginHasAction(nodeParams?.plugin?.name)\">\r\n      <!--自定义渲染-->\r\n      <component\r\n        v-if=\"pluginCompMap[nodeParams.plugin.name]\"\r\n        :is=\"pluginCompMap[nodeParams.plugin.name]\"\r\n        :node=\"node\"\r\n        :action=\"actionInfo\"\r\n        :actionName=\"nodeParams.plugin.params.business\"\r\n        :variableOptions=\"variableOptions\"\r\n        @updateVar=\"getValueVariableList\"\r\n      />\r\n      <!--默认渲染-->\r\n      <PluginFormRender\r\n        v-else\r\n        :node=\"node\"\r\n        :params=\"actionInfo.params\"\r\n        :output=\"actionInfo.output\"\r\n        :variableOptions=\"variableOptions\"\r\n        @updateVar=\"getValueVariableList\"\r\n      />\r\n    </template>\r\n    <!--独立插件-->\r\n    <div v-else class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('label_input') }}</div>\r\n      </div>\r\n      <div v-for=\"(item, key) in formState\"\r\n           :key=\"key\"\r\n           :class=\"['options-item', {'is-required': item.required}]\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ key }}</div>\r\n          <div class=\"option-type\">{{ item.type }}</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"item.tags\"\r\n            :defaultValue=\"item.value\"\r\n            ref=\"atInputRef\"\r\n            @open=\"getValueVariableList\"\r\n            @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{ item.description }}</div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, inject, onMounted, computed} from 'vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport {getPluginInfo, runPlugin} from \"@/api/plugins/index.js\";\r\nimport FeishuBittableBox from \"./components/feishu-bittable/feishu-bittable-box.vue\";\r\nimport OfficialAccountBox from \"./components/official-account/official-account-box.vue\";\r\nimport OfficialTemplateBox from \"./components/official-account/official-template-box.vue\";\r\nimport OfficialTagBox from \"./components/official-account/official-tag-box.vue\";\r\nimport OfficialSendMessageBox from \"./components/official-send-message/official-send-message-box.vue\";\r\nimport {pluginHasAction} from \"@/constants/plugin.js\";\r\nimport PluginFormRender from \"./components/pluginFormRender.vue\";\r\nimport {sortObjectKeys} from \"@/utils/index.js\";\r\nimport OfficialDraftBox from \"./components/official-draft/official-draft-box.vue\";\r\nimport DynamicApiBox from \"./components/dynamic-api/dynamic-api-box.vue\";\r\nimport HttpToolBox from \"./components/http-tool/http-tool-box.vue\";\r\nimport OfficialArticleBox from \"./components/official-account/official-article-box.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.zm-plugins-node-form')\r\n\r\nconst getNode = inject('getNode')\r\nconst setData = inject('setData')\r\n\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst pluginCompMap = {\r\n  feishu_bitable: FeishuBittableBox,\r\n  official_account_profile: OfficialAccountBox,\r\n  official_batch_tag: OfficialTagBox,\r\n  official_send_template_message: OfficialTemplateBox,\r\n  official_send_message: OfficialSendMessageBox,\r\n  official_draft: OfficialDraftBox,\r\n  http_tool: HttpToolBox,\r\n  official_article: OfficialArticleBox\r\n}\r\n\r\nconst customFieldsSortMap = {\r\n  'official_article:get_official_article': ['url', 'number']\r\n}\r\n\r\nconst formState = reactive({})\r\nconst info = ref({})\r\nconst actionInfo = ref(null)\r\nconst variableOptions = ref([])\r\nconst isMultiNode = ref(false)\r\nconst remoteInfo = ref({})  // 用于临时存储info需要的数据\r\nconst showDesc = computed(() => {\r\n  if (actionInfo.value) {\r\n    return actionInfo.value.desc\r\n  }\r\n  return info.value.description\r\n})\r\n\r\nlet nodeParams = {}\r\n\r\nasync function init() {\r\n  getValueVariableList();\r\n  nodeParams = JSON.parse(props.node.node_params)\r\n  await loadPluginInfo()\r\n  await loadPluginParams()\r\n}\r\n\r\nfunction loadPluginInfo() {\r\n  return getPluginInfo({name: nodeParams?.plugin?.name}).then(res => {\r\n    let data = res?.data || {}\r\n    remoteInfo.value = data.remote // 用于临时存储info需要的数据\r\n    isMultiNode.value = data?.local?.multiNode || false\r\n  })\r\n}\r\n\r\nfunction loadPluginParams() {\r\n  return runPlugin({\r\n    name: nodeParams?.plugin?.name || '',\r\n    action: \"default/get-schema\",\r\n    params: {}\r\n  }).then(res => {\r\n    let data = res?.data || {}\r\n    info.value = remoteInfo.value // info会导致页面开始渲染，等loadPluginParams有数据再渲染\r\n    const pName = nodeParams?.plugin?.name\r\n    if (pluginHasAction(pName) || isMultiNode.value) {\r\n      const business = nodeParams.plugin.params.business\r\n      actionInfo.value = data[business]\r\n      let sortFields = customFieldsSortMap[`${pName}:${business}`]\r\n      if (Array.isArray(sortFields)) {\r\n        actionInfo.value.params = sortObjectKeys(actionInfo.value.params, sortFields)\r\n      }\r\n    } else {\r\n      Object.assign(formState, data)\r\n      for (let key in formState) {\r\n        formState[key].value = String(nodeParams?.plugin.params[key] || '')\r\n        formState[key].tags = nodeParams?.plugin?.tag_map?.[key] || []\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nfunction getValueVariableList() {\r\n  variableOptions.value = getNode().getAllParentVariable()\r\n}\r\n\r\nfunction changeValue(item, text, selectedList){\r\n  item.value = text;\r\n  item.tags = selectedList\r\n\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  let data = {\r\n    params: {},\r\n    tag_map: {}\r\n  }\r\n\r\n  for (let key in formState) {\r\n    let value = formState[key].value\r\n    if(formState[key].type == 'string'){\r\n      value = String(value)\r\n    } else if(['number', 'integer'].includes(formState[key].type)){\r\n      value = Number(value)\r\n    }\r\n    data.params[key] = value\r\n    data.tag_map[key] = formState[key].tags\r\n  }\r\n\r\n  nodeParams.plugin.params = data.params\r\n  nodeParams.plugin.tag_map = data.tag_map\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        @changeTitle=\"handleTitleChange\"\r\n        @deleteNode=\"handleDeleteNode\"\r\n        :desc=\"t('desc_session_trigger')\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"variable-node\">\r\n      <div class=\"node-form-content\">\r\n        <div class=\"gray-block multi-modal-box\">\r\n          <div class=\"output-label\">\r\n            <img src=\"@/assets/img/workflow/output.svg\" alt=\"\" class=\"output-label-icon\" />\r\n            <span class=\"output-label-text\">{{ t('label_multi_modal_input') }}</span>\r\n            &nbsp;&nbsp;\r\n            <a-switch\r\n              v-model:checked=\"formState.question_multiple_switch\"\r\n              @change=\"onChangeQuestionMultipleqSwitch\"\r\n            />\r\n          </div>\r\n          <div class=\"multi-modal-input\">\r\n            <div style=\"color: #8c8c8c;\">{{ t('msg_multi_modal_desc') }}\r\n              <a-tooltip placement=\"left\">\r\n                <template #title>\r\n                  <div>{{ t('tip_question_multiple') }}</div>\r\n              <pre><code>\"question_multiple\":[\r\n  {\r\n    \"type\":\"text\",\r\n    \"text\":\"{{ t('sample_text_content') }}\"\r\n  },{\r\n    \"type\":\"image_url\",\r\n    \"image_url\":{\r\n      \"url\":\"{{ t('sample_image_url') }}\"\r\n    }\r\n  }\r\n]\r\n              </code></pre>\r\n                </template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip> \r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"gray-block\">\r\n          <div class=\"output-label\">\r\n            <img src=\"@/assets/img/workflow/output.svg\" alt=\"\" class=\"output-label-icon\" />\r\n            <span class=\"output-label-text\">{{ t('label_output') }}</span>\r\n            <span class=\"output-desc\">{{ t('msg_output_auto_mapped') }}</span>\r\n          </div>\r\n          <div class=\"field-items\">\r\n            <div class=\"field-item\" v-for=\"(item, index) in list\" :key=\"index\">\r\n              <div class=\"field-name-box\">\r\n                <span class=\"field-name\">{{item.key}}</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ item.desc }}</template>\r\n                  <QuestionCircleOutlined />\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"field-value-box\">\r\n                <a-select\r\n                  style=\"width: 200px\"\r\n                  :placeholder=\"t('ph_select_variable')\"\r\n                  v-model:value=\"item.variable\"\r\n                  allowClear\r\n                  @dropdownVisibleChange=\"dropdownVisibleChange\"\r\n                  @change=\"update\"\r\n                >\r\n                  <a-select-option :disabled=\"selectedValues.includes(opt.value)\" :value=\"opt.value\" v-for=\"opt in options\" :key=\"opt.key\">\r\n                    <span>{{ opt.label }}</span>\r\n                  </a-select-option>\r\n                </a-select>\r\n              </div>\r\n              <!-- <div class=\"field-desc\">\r\n                {{ item.desc }}\r\n              </div> -->\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, inject, computed } from 'vue'\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.session-trigger-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\nconst getGraph = inject('getGraph')\r\n\r\nconst list = ref([])\r\nconst options = ref([])\r\nconst formState = reactive({\r\n  question_multiple_switch: false\r\n})\r\n\r\nconst selectedValues = computed(() => { \r\n  return list.value.map(item => item.variable)\r\n})\r\n\r\nconst onChangeQuestionMultipleqSwitch = (val) => {\r\n  update()\r\n}\r\n\r\nfunction getOptions() {\r\n  const nodeModel = getNode()\r\n\r\n  if (nodeModel) {\r\n    let globalVariable = nodeModel.getGlobalVariable()\r\n    let diy_global = globalVariable.diy_global || []\r\n    diy_global.forEach((item) => {\r\n      item.label = item.key\r\n      item.value = 'global.' + item.key\r\n    })\r\n\r\n    options.value = diy_global || []\r\n  }\r\n}\r\n\r\nfunction dropdownVisibleChange(visible) {\r\n  if (visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst handleTitleChange = () => { \r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change',  {...props.node})\r\n  }, 10)\r\n}\r\n\r\nconst handleDeleteNode = () => {\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', null)\r\n  }, 10)\r\n}\r\n\r\nconst update = () => {\r\n  let node_params = JSON.parse(props.node.node_params)\r\n\r\n  node_params.trigger.outputs = [...list.value]\r\n  node_params.trigger.chat_config = {...formState}\r\n\r\n  let data = {...props.node, node_params: JSON.stringify(node_params)}\r\n\r\n  emit('update-node', data)\r\n  \r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', data)\r\n  }, 10)\r\n}\r\n\r\nconst init = () => {\r\n  getOptions();\r\n\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    \r\n    dataRaw = JSON.parse(dataRaw)\r\n\r\n    const trigger = dataRaw.trigger || {\r\n      outputs: [],\r\n      chat_config: {\r\n        question_multiple_switch: false\r\n      }\r\n    }\r\n\r\n    formState.question_multiple_switch = trigger.chat_config.question_multiple_switch\r\n\r\n    list.value = trigger.outputs.map((item) => {\r\n      item.tags = item.tags || []\r\n\r\n      return item\r\n    })\r\n    \r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import './form-block.less';\r\n.variable-node {\r\n  .multi-modal-box{\r\n    margin-bottom: 8px;\r\n  }\r\n  .field-items {\r\n    .field-item {\r\n      display: flex;\r\n      align-items: center;\r\n      margin-bottom: 8px;\r\n      justify-content: space-between;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n\r\n    .field-name-box {\r\n      width: auto;\r\n      margin-right: 8px;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n    }\r\n\r\n    .field-value-box {\r\n      margin-right: 8px;\r\n      \r\n      .field-value{\r\n        display: inline-flex;\r\n        line-height: 20px;\r\n        padding: 1px 8px;\r\n        border-radius: 6px;\r\n        overflow: hidden;\r\n        background: #FFF;\r\n        border: 1px solid rgba(0, 0, 0, 0.15);\r\n      }\r\n\r\n      .value-arrow{\r\n        font-size: 16px;\r\n        padding: 1px 4px;\r\n        margin-right: 4px;\r\n        border-radius: 4px;\r\n        background: #E4E6EB;\r\n      }\r\n    }\r\n\r\n    .field-desc{\r\n      line-height: 22px;\r\n      font-size: 14px;\r\n      color: #595959;\r\n      text-align: left;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cg%20clip-path='url(%23hp676wcw9__clip0_12661_41280)'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linejoin='round'%3e%3cpath%20d='M7.99993%2014.7779C11.375%2014.7779%2014.1111%2012.0418%2014.1111%208.66678C14.1111%205.29171%2011.375%202.55566%207.99993%202.55566C4.62487%202.55566%201.88883%205.29171%201.88883%208.66678C1.88883%2012.0418%204.62487%2014.7779%207.99993%2014.7779Z'/%3e%3cpath%20d='M7.9198%205.11768L7.9194%208.78728L10.5102%2011.378'%20stroke-linecap='round'/%3e%3cpath%20d='M1.33334%203.00016L3.66667%201.3335'%20stroke-linecap='round'/%3e%3cpath%20d='M14.6667%203.00016L12.3333%201.3335'%20stroke-linecap='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='hp676wcw9__clip0_12661_41280'%3e%3cpath%20fill='%23fff'%20d='M0%200H16V16H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        @changeTitle=\"handleTitleChange\"\r\n        @deleteNode=\"handleDeleteNode\"\r\n        :desc=\"t('desc_timing_trigger')\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"variable-node\">\r\n      <div class=\"node-form-content\">\r\n        <div class=\"gray-block\">\r\n          <div class=\"output-label\">\r\n            <img src=\"@/assets/svg/alarm-clock.svg\" alt=\"\" class=\"output-label-icon\" />\r\n            <span class=\"output-label-text\">{{ t('label_trigger_time') }}</span>\r\n          </div>\r\n          <div class=\"form-item\">\r\n            <a-radio-group v-model:value=\"formState.type\">\r\n              <a-radio value=\"select_time\">{{ t('label_select_time') }}</a-radio>\r\n              <a-radio value=\"linux_crontab\">{{ t('label_linux_crontab') }}</a-radio>\r\n            </a-radio-group>\r\n          </div>\r\n          <div class=\"form-item\" v-if=\"formState.type === 'select_time'\">\r\n            <a-flex :gap=\"8\">\r\n              <a-cascader\r\n                v-model:value=\"formState.time_value\"\r\n                :options=\"options\"\r\n                :placeholder=\"t('ph_select')\"\r\n                style=\"width: 194px\"\r\n              />\r\n              <a-time-picker\r\n                :allowClear=\"false\"\r\n                v-model:value=\"formState.hour_minute\"\r\n                valueFormat=\"HH:mm\"\r\n                format=\"HH:mm\"\r\n                style=\"width: 124px\"\r\n              />\r\n            </a-flex>\r\n          </div>\r\n          <div class=\"form-item custom-textarea\" v-else>\r\n            <a-textarea\r\n              v-model:value=\"formState.linux_crontab\"\r\n              :placeholder=\"t('ph_input_code')\"\r\n              style=\"min-height: 142px; background: #262626; color: #bfbfbf\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { ref, onMounted, inject, reactive, computed, watch } from 'vue'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport CodeEditBox from './code-edit-box.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.timing-trigger-node.timing-trigger-node-form')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nfunction getMonthDays() {\r\n  let lists = []\r\n  for (let i = 0; i < 31; i++) {\r\n    lists.push({\r\n      label: i + 1 + t('label_day'),\r\n      value: i + 1 + ''\r\n    })\r\n  }\r\n  return lists\r\n}\r\n\r\nconst options = computed(() => [\r\n  {\r\n    value: 'day',\r\n    label: t('label_every_day')\r\n  },\r\n  {\r\n    value: 'week',\r\n    label: t('label_every_week'),\r\n    children: [\r\n      {\r\n        value: '0',\r\n        label: t('label_sunday')\r\n      },\r\n      {\r\n        value: '1',\r\n        label: t('label_monday')\r\n      },\r\n      {\r\n        value: '2',\r\n        label: t('label_tuesday')\r\n      },\r\n      {\r\n        value: '3',\r\n        label: t('label_wednesday')\r\n      },\r\n      {\r\n        value: '4',\r\n        label: t('label_thursday')\r\n      },\r\n      {\r\n        value: '5',\r\n        label: t('label_friday')\r\n      },\r\n      {\r\n        value: '6',\r\n        label: t('label_saturday')\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    value: 'month',\r\n    label: t('label_every_month'),\r\n    children: getMonthDays()\r\n  }\r\n])\r\n\r\nconst formState = reactive({\r\n  type: 'select_time',\r\n  time_value: [],\r\n  every_type: 'day',\r\n  week_number: '',\r\n  month_day: '',\r\n  hour_minute: '',\r\n  linux_crontab: ''\r\n})\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  {\r\n    deep: true\r\n  }\r\n)\r\n\r\nconst getNode = inject('getNode')\r\nconst getGraph = inject('getGraph')\r\n\r\nconst handleTitleChange = () => {\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', { ...props.node })\r\n  }, 10)\r\n}\r\n\r\nconst handleDeleteNode = () => {\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', null)\r\n  }, 10)\r\n}\r\n\r\nconst update = () => {\r\n  let node_params = JSON.parse(props.node.node_params)\r\n  let every_type = ''\r\n  let week_number = ''\r\n  let month_day = ''\r\n  if (formState.time_value && formState.time_value.length) {\r\n    every_type = formState.time_value[0]\r\n    if (formState.time_value[0] == 'week') {\r\n      week_number = formState.time_value[1]\r\n    }\r\n    if (formState.time_value[0] == 'month') {\r\n      month_day = formState.time_value[1]\r\n    }\r\n  }\r\n\r\n  node_params.trigger.cron_config = {\r\n    ...formState,\r\n    every_type,\r\n    week_number,\r\n    month_day\r\n  }\r\n\r\n  let data = { ...props.node, node_params: JSON.stringify(node_params) }\r\n\r\n  emit('update-node', data)\r\n\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', data)\r\n  }, 10)\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n\r\n    dataRaw = JSON.parse(dataRaw)\r\n\r\n    let cron_config = dataRaw.trigger.cron_config\r\n    formState.type = cron_config.type\r\n    formState.linux_crontab = cron_config.linux_crontab\r\n    formState.every_type = cron_config.every_type\r\n    formState.week_number = cron_config.week_number\r\n    formState.month_day = cron_config.month_day\r\n    formState.hour_minute = cron_config.hour_minute\r\n    let every_type = cron_config.every_type\r\n    if (every_type == 'day') {\r\n      formState.time_value = ['day']\r\n    }\r\n    if (every_type == 'week') {\r\n      formState.time_value = ['week', cron_config.week_number]\r\n    }\r\n    if (every_type == 'month') {\r\n      formState.time_value = ['month', cron_config.month_day]\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.variable-node {\r\n  .output-label {\r\n    margin-bottom: 16px;\r\n  }\r\n  .form-item {\r\n    margin-bottom: 4px;\r\n  }\r\n  .custom-textarea {\r\n    &::v-deep(.ant-input::placeholder) {\r\n      color: #bfbfbf !important;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","export default \"data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1763712774665'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1849'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='300'%20height='300'%3e%3cpath%20d='M692.352%20335.04c11.712%200.128%2023.36%200.96%2034.944%202.432-31.232-156.8-186.88-273.152-365.184-273.152C163.008%2064.32%200%20210.048%200%20394.88c0%20106.944%2054.336%20194.688%20144.768%20262.784l-36.096%20117.12%20126.592-68.224c41.536%2011.2%2084.032%2017.728%20126.848%2019.584h33.856a312%20312%200%200%201-11.136-81.6%20306.88%20306.88%200%200%201%20307.84-308.032l-0.32-1.536z%20m-194.56-105.408a41.088%2041.088%200%200%201%2032.768%2013.312%2047.808%2047.808%200%200%201%2012.416%2035.2%2047.808%2047.808%200%200%201-12.416%2035.328%2041.088%2041.088%200%200%201-32.768%2013.312c-27.328%202.176-51.328-19.328-54.4-48.64%202.88-29.312%2027.008-50.816%2054.4-48.512z%20m-253.44%2097.152c-27.456%202.304-51.648-19.2-54.656-48.64%203.008-29.312%2027.2-50.88%2054.656-48.512a41.088%2041.088%200%200%201%2032.768%2013.312%2047.808%2047.808%200%200%201%2012.416%2035.2%2047.808%2047.808%200%200%201-12.416%2035.328%2041.088%2041.088%200%200%201-32.768%2013.312z'%20fill='currentColor'%20p-id='1850'%3e%3c/path%3e%3cpath%20d='M1024%20638.464c0-155.52-145.92-283.52-308.608-283.52-172.416%200-308.096%20126.784-308.096%20282.304%200%20155.52%20135.68%20282.368%20308.096%20282.368a426.176%20426.176%200%200%200%20109.44-18.304L924.16%20960l-28.416-97.216C968.832%20803.84%201024%20726.208%201024%20638.464z%20m-408.448-48.832c-19.968%200-36.16-17.408-36.16-38.848%200-21.44%2016.192-38.784%2036.16-38.784%2022.4-2.56%2042.56%2014.72%2045.184%2038.784-2.624%2024.064-22.784%2041.344-45.184%2038.848z%20m199.04%200c-19.84%200-36.096-17.408-36.096-38.848%200-21.44%2016.192-38.784%2036.16-38.784%2022.4-2.368%2042.432%2014.848%2045.248%2038.784-2.688%2024.064-22.848%2041.344-45.248%2038.848z'%20fill='currentColor'%20p-id='1851'%3e%3c/path%3e%3c/svg%3e\"","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        @changeTitle=\"handleTitleChange\"\r\n        @deleteNode=\"handleDeleteNode\"\r\n        :desc=\"t('desc_official_trigger')\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"variable-node\">\r\n      <div class=\"node-form-content\">\r\n        <div class=\"gray-block\">\r\n          <div class=\"output-label\">\r\n            <img src=\"@/assets/svg/wx-app-icon.svg\" alt=\"\" class=\"output-label-icon\" />\r\n            <span class=\"output-label-text\">{{ t('label_official_account') }}</span>\r\n          </div>\r\n          <div>\r\n            <a-button @click=\"handleOpenAppModal\" type=\"dashed\"\r\n              ><PlusOutlined />{{ t('btn_add_official') }}</a-button\r\n            >\r\n            <div class=\"app-item-list\">\r\n              <div class=\"app-item\" v-for=\"item in selectAppItems\" :key=\"item.app_id\">\r\n                {{ item.app_name }}\r\n                <span @click=\"handleDelOfficial(item)\" class=\"close-icon\"\r\n                  ><CloseCircleFilled\r\n                /></span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-item\">\r\n            <div class=\"form-item-label\">{{ t('label_trigger_event') }}</div>\r\n            <div class=\"form-item-content\">\r\n              <a-select\r\n                :options=\"trigger_options\"\r\n                v-model:value=\"formState.msg_type\"\r\n                style=\"width: 100%\"\r\n                :showArrow=\"false\"\r\n                disabled\r\n              >\r\n              </a-select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"gray-block\">\r\n          <div class=\"output-label\">\r\n            <img src=\"@/assets/svg/output.svg\" alt=\"\" class=\"output-label-icon\" />\r\n            <span class=\"output-label-text\">{{ t('label_output') }}</span>\r\n            <a\r\n              class=\"ml8\"\r\n              href=\"https://developers.weixin.qq.com/doc/subscription/guide/product/message/Receiving_standard_messages.html\"\r\n              target=\"_blank\"\r\n              >{{ t('btn_view_document') }}</a\r\n            >\r\n          </div>\r\n          <div class=\"field-items\">\r\n            <!-- <div class=\"field-items-label\">文本消息</div> -->\r\n            <div class=\"field-item\" v-for=\"(item, index) in list\" :key=\"index\">\r\n              <div class=\"field-name-box\">\r\n                <span class=\"field-name\">{{ item.key }}</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ item.desc }}</template>\r\n                  <QuestionCircleOutlined />\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"field-value-box\">\r\n                <a-select\r\n                  style=\"width: 200px\"\r\n                  :placeholder=\"t('ph_select_variable')\"\r\n                  v-model:value=\"item.variable\"\r\n                  allowClear\r\n                  @dropdownVisibleChange=\"dropdownVisibleChange\"\r\n                  @change=\"update\"\r\n                >\r\n                  <!--  :disabled=\"selectedValues.includes(opt.value)\" -->\r\n                  <a-select-option :value=\"opt.value\" v-for=\"opt in options\" :key=\"opt.key\">\r\n                    <span>{{ opt.label }}</span>\r\n                  </a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <SelectWechatApp ref=\"wxAppRef\" :title=\"t('btn_add_official')\" @ok=\"handleAppChange\" />\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { ref, onMounted, inject, computed, reactive } from 'vue'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { PlusOutlined, CloseCircleFilled, QuestionCircleOutlined } from '@ant-design/icons-vue'\r\nimport SelectWechatApp from '@/components/common/select-wechat-app.vue'\r\nimport { useWorkflowStore } from '@/stores/modules/workflow'\r\nconst workflowStore = useWorkflowStore()\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.official-trigger-node.official-trigger-node-form')\r\n\r\nconst officialList = computed(() => workflowStore.officialList)\r\nconst triggerOfficialList = computed(() => workflowStore.triggerOfficialList)\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\nconst getGraph = inject('getGraph')\r\n\r\nconst trigger_options = ref([\r\n  {\r\n    label: t('label_private_message'),\r\n    value: 'message'\r\n  },\r\n  {\r\n    label: t('label_subscribe_unsubscribe'),\r\n    value: 'subscribe_unsubscribe'\r\n  },\r\n  {\r\n    label: t('label_qrcode_scan'),\r\n    value: 'qrcode_scan'\r\n  },\r\n  {\r\n    label: t('label_menu_click'),\r\n    value: 'menu_click'\r\n  }\r\n])\r\n\r\nconst formState = reactive({\r\n  msg_type: '',\r\n  app_ids: []\r\n})\r\n\r\nconst selectAppItems = computed(() => {\r\n  return formState.app_ids.map((item) => officialList.value.find((it) => it.app_id == item)).filter(Boolean)\r\n})\r\n\r\nconst list = ref([])\r\nconst options = ref([])\r\n\r\nconst selectedValues = computed(() => {\r\n  return list.value.map((item) => item.variable)\r\n})\r\n\r\nfunction getOptions() {\r\n  const nodeModel = getNode()\r\n\r\n  if (nodeModel) {\r\n    let globalVariable = nodeModel.getGlobalVariable()\r\n    let diy_global = globalVariable.diy_global || []\r\n    diy_global.forEach((item) => {\r\n      item.label = item.key\r\n      item.value = 'global.' + item.key\r\n    })\r\n\r\n    options.value = diy_global || []\r\n  }\r\n}\r\n\r\nfunction dropdownVisibleChange(visible) {\r\n  if (visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst handleTitleChange = () => {\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', { ...props.node })\r\n  }, 10)\r\n}\r\n\r\nconst handleDeleteNode = () => {\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', null)\r\n  }, 10)\r\n}\r\n\r\nconst update = () => {\r\n  let node_params = JSON.parse(props.node.node_params)\r\n\r\n  node_params.trigger.outputs = [...list.value]\r\n  node_params.trigger.trigger_official_config = {\r\n    msg_type: formState.msg_type,\r\n    app_ids: formState.app_ids.join(',')\r\n  }\r\n\r\n  let data = { ...props.node, node_params: JSON.stringify(node_params) }\r\n\r\n  emit('update-node', data)\r\n\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', data)\r\n  }, 10)\r\n}\r\n\r\nconst init = () => {\r\n  getOptions()\r\n\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n\r\n    dataRaw = JSON.parse(dataRaw)\r\n\r\n    const trigger = dataRaw.trigger || {\r\n      outputs: []\r\n    }\r\n\r\n    let trigger_official_config = trigger.trigger_official_config\r\n\r\n    formState.msg_type = trigger_official_config.msg_type\r\n    formState.app_ids = trigger_official_config.app_ids\r\n      ? trigger_official_config.app_ids.split(',')\r\n      : []\r\n\r\n    let outputs = trigger.outputs\r\n    if (!outputs) {\r\n      outputs = triggerOfficialList.value.find(\r\n        (item) => item.msg_type == trigger_official_config.msg_type\r\n      ).fields\r\n    }\r\n\r\n    list.value = outputs.map((item) => {\r\n      item.tags = item.tags || []\r\n\r\n      return item\r\n    })\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst handleOpenAppModal = () => {\r\n  wxAppRef.value.open({}, JSON.parse(JSON.stringify(formState.app_ids)))\r\n}\r\n\r\nconst wxAppRef = ref(null)\r\nconst handleAppChange = (data) => {\r\n  formState.app_ids = data || []\r\n  wxAppRef.value.close()\r\n  update()\r\n}\r\n\r\nconst handleDelOfficial = (item) => {\r\n  formState.app_ids = formState.app_ids.filter((id) => id != item.app_id)\r\n  update()\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.variable-node {\r\n  .gray-block {\r\n    margin-top: 16px;\r\n  }\r\n  .ml8 {\r\n    margin-left: 8px;\r\n  }\r\n  .app-item-list {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    margin-top: 8px;\r\n    flex-wrap: wrap;\r\n    .app-item {\r\n      height: 32px;\r\n      padding: 5px 16px;\r\n      border-radius: 6px;\r\n      display: flex;\r\n      align-items: center;\r\n      border: 1px solid var(--06, #d9d9d9);\r\n      background: var(--08, #f5f5f5);\r\n      color: #595959;\r\n      font-size: 14px;\r\n      position: relative;\r\n      &:hover {\r\n        .close-icon {\r\n          opacity: 1;\r\n        }\r\n      }\r\n      .close-icon {\r\n        width: 24px;\r\n        height: 24px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        position: absolute;\r\n        top: -8px;\r\n        right: -12px;\r\n        font-size: 20px;\r\n        color: #fb363f;\r\n        opacity: 0;\r\n        transition: all 0.1s ease-in-out;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n  }\r\n  .form-item {\r\n    margin-top: 12px;\r\n    .form-item-label {\r\n      color: #262626;\r\n      font-size: 14px;\r\n      line-height: 22px;\r\n      margin-bottom: 4px;\r\n    }\r\n  }\r\n  .field-items {\r\n    .field-items-label {\r\n      margin-bottom: 4px;\r\n      color: #262626;\r\n      line-height: 22px;\r\n    }\r\n    .field-item {\r\n      display: flex;\r\n      align-items: center;\r\n      margin-bottom: 8px;\r\n      justify-content: space-between;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n\r\n    .field-name-box {\r\n      width: auto;\r\n      margin-right: 8px;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n    }\r\n\r\n    .field-value-box {\r\n      margin-right: 8px;\r\n\r\n      .field-value {\r\n        display: inline-flex;\r\n        line-height: 20px;\r\n        padding: 1px 8px;\r\n        border-radius: 6px;\r\n        overflow: hidden;\r\n        background: #fff;\r\n        border: 1px solid rgba(0, 0, 0, 0.15);\r\n      }\r\n\r\n      .value-arrow {\r\n        font-size: 16px;\r\n        padding: 1px 4px;\r\n        margin-right: 4px;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n\r\n    .field-desc {\r\n      line-height: 22px;\r\n      font-size: 14px;\r\n      color: #595959;\r\n      text-align: left;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cg%20clip-path='url(%234f9846fr4__clip0_12833_126304)'%20stroke='%23262626'%20stroke-width='1.33333'%3e%3cpath%20d='M4%203.30905V2.33337C4%201.78109%204.4477%201.33337%205%201.33337H13.6667C14.219%201.33337%2014.6667%201.78109%2014.6667%202.33337V11C14.6667%2011.5523%2014.219%2012%2013.6667%2012H12.6725'/%3e%3cpath%20d='M11.6667%203.33337H2.33337C1.78109%203.33337%201.33337%203.78109%201.33337%204.33337V13.6667C1.33337%2014.219%201.78109%2014.6667%202.33337%2014.6667H11.6667C12.219%2014.6667%2012.6667%2014.219%2012.6667%2013.6667V4.33337C12.6667%203.78109%2012.219%203.33337%2011.6667%203.33337Z'%20stroke-linejoin='round'/%3e%3cpath%20d='M4%209L10%209'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%206L10%209L7%2012'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='4f9846fr4__clip0_12833_126304'%3e%3cpath%20fill='%23fff'%20d='M0%200H16V16H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cpath%20d='M8%201.66663H2V12.3333H8V1.66663Z'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M14%203.66663H8V14.3333H14V3.66663Z'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M4.33337%205.66663L5.66671%206.92979L4.44447%208.33329'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M10.3334%207.66663L11.6667%208.92979L10.4445%2010.3333'%20stroke='%23262626'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","<template>\r\n  <div>\r\n    <!-- <a-button @click=\"handleOpenTestModal\" style=\"background-color: #00ad3a\" type=\"primary\"\r\n      ><CaretRightOutlined />运行测试</a-button\r\n    > -->\r\n    <a-modal\r\n      v-model:open=\"show\"\r\n      :footer=\"null\"\r\n      :width=\"820\"\r\n      wrapClassName=\"no-padding-modal\"\r\n    >\r\n      <template #title>\r\n        <div class=\"modal-title-block\">{{ t('btn_run_test') }}\r\n          <div class=\"run-detail\" v-if=\"resultList.length\">\r\n            <span>{{ t('label_total_time') }}：{{ formatTime(use_mills) }}</span>\r\n            <span>{{ t('label_token_usage') }}：{{ use_token }} {{ t('label_tokens') }}</span>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <div class=\"flex-content-box\">\r\n        <div class=\"test-model-box\">\r\n          <div class=\"top-title\">{{ t('title_start_node_params') }}</div>\r\n          <a-form\r\n            :model=\"formState\"\r\n            ref=\"formRef\"\r\n            layout=\"vertical\"\r\n            :wrapper-col=\"{ span: 24 }\"\r\n            autocomplete=\"off\"\r\n          >\r\n            <a-form-item\r\n              v-if=\"is_need_question\"\r\n              name=\"question\"\r\n              :rules=\"[{ required: true, message: t('msg_input_question') }]\"\r\n            >\r\n              <template #label>\r\n                <a-flex :gap=\"4\">{{ t('label_question') }} <a-tag style=\"margin: 0\">{{ t('label_string') }}</a-tag> </a-flex>\r\n              </template>\r\n              <a-input :placeholder=\"t('ph_input')\" v-model:value=\"formState.question\" />\r\n            </a-form-item>\r\n            <a-form-item name=\"openid\" :rules=\"[{ required: true, message: t('msg_input_openid') }]\" v-if=\"is_need_openid \">\r\n              <template #label>\r\n                <a-flex :gap=\"4\">{{ t('label_openid') }} <a-tag style=\"margin: 0\">{{ t('label_string') }}</a-tag> </a-flex>\r\n              </template>\r\n              <a-input :placeholder=\"t('ph_input')\" v-model:value=\"formState.openid\" />\r\n            </a-form-item>\r\n            <a-form-item\r\n              v-for=\"item in batch_test_params\"\r\n              :key=\"item.node_key\"\r\n              :rules=\"[{ required: item.field.required, message: `${t('ph_input')}${item.node_name}` }]\"\r\n            >\r\n              <template #label>\r\n                <a-flex :gap=\"4\"\r\n                  >{{ item.node_name }} {{ formatStr(item)\r\n                  }}<a-tag style=\"margin: 0\">{{ item.field.typ }}</a-tag>\r\n                </a-flex>\r\n              </template>\r\n              <template v-if=\"item.field.typ == 'string'\">\r\n                <a-input :placeholder=\"t('ph_input')\" v-model:value=\"item.field.Vals\" />\r\n              </template>\r\n              <template v-if=\"item.field.typ == 'number'\">\r\n                <a-input-number\r\n                  style=\"width: 100%\"\r\n                  :placeholder=\"t('ph_input')\"\r\n                  v-model:value=\"item.field.Vals\"\r\n                />\r\n              </template>\r\n              <template v-if=\"item.field.typ.includes('array')\">\r\n                <div class=\"input-list-box\">\r\n                  <div class=\"input-list-item\" v-for=\"(input, i) in item.field.Vals\" :key=\"i\">\r\n                    <a-form-item-rest\r\n                      ><a-input :placeholder=\"t('ph_input')\" v-model:value=\"input.value\"\r\n                    /></a-form-item-rest>\r\n\r\n                    <CloseCircleOutlined\r\n                      v-if=\"item.field.Vals.length > 1\"\r\n                      @click=\"handleDelItem(item.field.Vals, i)\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"add-btn-box\">\r\n                    <a-button @click=\"handleAddItem(item.field.Vals)\" block type=\"dashed\"\r\n                      >{{ t('btn_add') }}</a-button\r\n                    >\r\n                  </div>\r\n                </div>\r\n              </template>\r\n            </a-form-item>\r\n          </a-form>\r\n\r\n          <div class=\"result-list-box loading-box\" v-if=\"loading\">\r\n            <a-spin v-if=\"loading\" :tip=\"t('msg_generating_test_result')\" />\r\n          </div>\r\n\r\n          <div class=\"result-list-box\" v-if=\"resultList.length > 0\">\r\n            <div\r\n              class=\"list-item-block\"\r\n              :class=\"{ active: currentNodeKey == item.node_key }\"\r\n              v-for=\"(item, index) in resultList\"\r\n              @click=\"handleChangeNodeKey(item)\"\r\n              :key=\"index\"\r\n            >\r\n              <div class=\"status-block\">\r\n                <CheckCircleFilled v-if=\"item.is_success\" style=\"color: #138b1b\" />\r\n                <CloseCircleFilled v-else style=\"color: #d81e06\" />\r\n              </div>\r\n              <div class=\"icon-name-box\">\r\n                <img :src=\"item.node_icon\" alt=\"\" />\r\n                <div class=\"node-name\">{{ item.node_name }}</div>\r\n              </div>\r\n              <div class=\"time-tag\" v-if=\"item.is_success\">{{ item.use_time }}ms</div>\r\n              <div class=\"right-active-icon\"><RightCircleOutlined /></div>\r\n              <!-- <div class=\"out-put-box\" v-if=\"item.is_success\">\r\n                <a-tooltip>\r\n                  <template #title>{{ item.output }}</template>\r\n                  <div class=\"out-text-box\">{{ item.output }}</div>\r\n                </a-tooltip>\r\n              </div> -->\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"save-btn-box\">\r\n            <a-button\r\n              :loading=\"loading\"\r\n              @click=\"handleSubmit\"\r\n              style=\"background-color: #00ad3a\"\r\n              type=\"primary\"\r\n              ><CaretRightOutlined />{{ t('btn_run_test') }}</a-button\r\n            >\r\n          </div>\r\n        </div>\r\n        <div class=\"preview-box\">\r\n          <template v-if=\"cuttentItem\">\r\n            <div class=\"preview-title\">\r\n              <div class=\"title-text\">{{ t('title_log_details') }}</div>\r\n              <div class=\"icon-name-box\">\r\n                <img :src=\"cuttentItem.node_icon\" alt=\"\" />\r\n                <div class=\"node-name\">{{ cuttentItem.node_name }}</div>\r\n              </div>\r\n              <div class=\"time-tag\" v-if=\"cuttentItem.is_success\">{{ cuttentItem.use_time }}ms</div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_input') }}<CopyOutlined @click=\"handleCopy('input')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.input\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_output') }}<CopyOutlined @click=\"handleCopy('node_output')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.node_output\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_run_log') }}<CopyOutlined @click=\"handleCopy('output')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.output\" />\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  CaretRightOutlined,\r\n  CheckCircleFilled,\r\n  CloseCircleFilled,\r\n  CloseCircleOutlined,\r\n  RightCircleOutlined,\r\n  CopyOutlined\r\n} from '@ant-design/icons-vue'\r\nimport VueJsonPretty from 'vue-json-pretty'\r\nimport 'vue-json-pretty/lib/styles.css'\r\nimport { reactive, ref, computed, nextTick } from 'vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { callBatchWorkFlow, callBatchWorkFlowParams } from '@/api/robot/index'\r\nimport { getImageUrl, formatTime } from '../../../util'\r\nimport { message } from 'ant-design-vue'\r\nimport { copyText } from '@/utils/index'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.batch-group-node.components.run-test')\r\n\r\nconst robotStore = useRobotStore()\r\n\r\nconst isLockedByOther = computed(() => {\r\n  return robotStore.robotInfo.isLockedByOther\r\n})\r\n\r\nconst props = defineProps({\r\n  batch_node_key: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n})\r\nconst diy_global = computed(() => {\r\n  return []\r\n})\r\n\r\nconst emit = defineEmits(['save'])\r\n\r\nconst show = ref(false)\r\nconst currentNodeKey = ref('')\r\nconst resultList = ref([])\r\n\r\nconst cuttentItem = computed(() => {\r\n  if (!currentNodeKey.value) {\r\n    return null\r\n  }\r\n  return resultList.value.filter((item) => item.node_key == currentNodeKey.value)[0]\r\n})\r\n\r\nconst loading = ref(false)\r\n\r\nconst formState = reactive({\r\n  is_draft: true,\r\n  robot_key: robotStore.robotInfo.robot_key,\r\n  question: '',\r\n  openid: ''\r\n})\r\n\r\nconst handleOpenTestModal = async () => {\r\n  if (isLockedByOther.value) {\r\n    message.warning(t('msg_locked_by_other_cannot_test'))\r\n    return\r\n  }\r\n  robotStore.robotInfo.loop_save_canvas_status++ // 触发保存草稿操作\r\n\r\n  await nextTick()\r\n\r\n  let localData = localStorage.getItem('workflow_batch_run_test_data') || '{}'\r\n\r\n  localData = JSON.parse(localData)\r\n\r\n  formState.question = localData.question || ''\r\n  formState.openid = localData.openid || ''\r\n  formState.global = localData.global || ''\r\n\r\n  resultList.value = []\r\n  currentNodeKey.value = ''\r\n  setTimeout(() => {\r\n    getFieldLists()\r\n  }, 1000)\r\n  show.value = true\r\n}\r\n\r\nconst batch_test_params = ref([])\r\nconst is_need_question = ref(false)\r\nconst is_need_openid = ref(false)\r\n\r\nconst getFieldLists = () => {\r\n  callBatchWorkFlowParams({\r\n    robot_key: formState.robot_key,\r\n    batch_node_key: props.batch_node_key,\r\n  }).then((res) => {\r\n    is_need_question.value = res.data.is_need_question\r\n    is_need_openid.value = res.data.is_need_openid\r\n    \r\n    if (!is_need_question.value) {\r\n      formState.question = ''\r\n    }\r\n    batch_test_params.value = res.data.loop_test_params.map((item) => {\r\n      return {\r\n        ...item,\r\n        field: {\r\n          ...item.field,\r\n          Vals: setGlobalDefaultVal(item.field)\r\n        }\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction setGlobalDefaultVal(item) {\r\n  if (item.typ == 'string' || item.typ == 'number') {\r\n    return ''\r\n  }\r\n  return [\r\n    {\r\n      value: '',\r\n      key: Math.random() * 10000\r\n    }\r\n  ]\r\n}\r\n\r\nconst handleDelItem = (item, index) => {\r\n  item.splice(index, 1)\r\n}\r\nconst handleAddItem = (item) => {\r\n  item.push({\r\n    value: '',\r\n    key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst formRef = ref(null)\r\n\r\nconst use_token = ref(0)\r\nconst use_mills = ref(0)\r\n\r\nconst handleSubmit = () => {\r\n  formRef.value.validate().then(() => {\r\n    let postData = { ...formState, batch_node_key: props.batch_node_key }\r\n    let batch_test_params_data = JSON.parse(JSON.stringify(batch_test_params.value))\r\n\r\n    batch_test_params_data.forEach((item) => {\r\n      if (item.field.typ.includes('array')) {\r\n        item.field.Vals = item.field.Vals.map((it) => it.value)\r\n      }\r\n    })\r\n\r\n    postData.batch_test_params = JSON.stringify(batch_test_params_data)\r\n\r\n    loading.value = true\r\n    resultList.value = []\r\n    localStorage.setItem('workflow_batch_run_test_data', JSON.stringify({ ...postData }))\r\n    callBatchWorkFlow({\r\n      ...postData\r\n    })\r\n      .then((res) => {\r\n        message.success(t('msg_test_result_generated'))\r\n        let node_logs = res.data.node_logs || []\r\n        use_token.value = res.data.use_token\r\n        use_mills.value = res.data.use_mills\r\n        formateData(node_logs)\r\n      })\r\n      .catch((res) => {\r\n        resultList.value = []\r\n        let node_logs = res.data.node_logs || []\r\n        if (node_logs && node_logs.length) {\r\n          formateData(node_logs)\r\n        }\r\n      })\r\n      .finally(() => {\r\n        loading.value = false\r\n      })\r\n  })\r\n}\r\n\r\nconst formateData = (data) => {\r\n  resultList.value = data.map((item) => {\r\n    return {\r\n      ...item,\r\n      is_success: item.error_msg === '<nil>',\r\n      node_icon: getImageUrl(item.node_type)\r\n    }\r\n  })\r\n  currentNodeKey.value = resultList.value[0]?.node_key\r\n}\r\n\r\nconst handleChangeNodeKey = (item) => {\r\n  currentNodeKey.value = item.node_key\r\n}\r\n\r\nconst handleCopy = (key) => {\r\n  copyText(JSON.stringify(cuttentItem.value[key]))\r\n  message.success(t('msg_copy_success'))\r\n}\r\n\r\nfunction formatStr(item) {\r\n  return item.field.key.replace(item.node_key + '.', '')\r\n}\r\n\r\nconst open = () => {\r\n  handleOpenTestModal()\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.flex-content-box {\r\n  display: flex;\r\n  max-height: 600px;\r\n  overflow: hidden;\r\n}\r\n.test-model-box {\r\n  flex: 1;\r\n  margin: 24px 0 0 0;\r\n  padding-right: 16px;\r\n  overflow-y: auto;\r\n  .top-title {\r\n    font-weight: 600;\r\n    margin-bottom: 16px;\r\n  }\r\n  .save-btn-box {\r\n    margin: 32px 0;\r\n    margin-top: 50px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n.tooltip-content {\r\n  white-space: pre-wrap;\r\n}\r\n.loading-box {\r\n  height: 100px;\r\n  justify-content: center;\r\n}\r\n.result-list-box {\r\n  margin: 24px 0;\r\n  width: 100%;\r\n  border: 1px solid #ebebeb;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 8px;\r\n  .list-item-block {\r\n    display: flex;\r\n    align-items: center;\r\n    overflow: hidden;\r\n    gap: 8px;\r\n    padding: 8px;\r\n    color: #333;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\r\n    .right-active-icon {\r\n      margin-left: auto;\r\n      color: #2475fc;\r\n      opacity: 0;\r\n    }\r\n    &:hover {\r\n      background: #f2f4f7;\r\n      .right-active-icon {\r\n        opacity: 1;\r\n      }\r\n    }\r\n    &.active {\r\n      color: #2475fc;\r\n      background: #e6efff;\r\n      .right-active-icon {\r\n        opacity: 0;\r\n      }\r\n    }\r\n    .status-block {\r\n      font-size: 20px;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      font-weight: 600;\r\n      img {\r\n        width: 24px;\r\n        height: 24px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n    .out-put-box {\r\n      flex: 1;\r\n      margin-left: 24px;\r\n      overflow: hidden;\r\n      .out-text-box {\r\n        background: #f2f2f2;\r\n        border-radius: 6px;\r\n        padding: 8px;\r\n        width: 100%;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.input-list-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  .input-list-item {\r\n    display: flex;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n.preview-box {\r\n  flex: 1;\r\n  border-left: 1px solid #d9d9d9;\r\n  padding: 16px;\r\n  overflow-y: auto;\r\n  .preview-title {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    .title-text {\r\n      font-size: 15px;\r\n      font-weight: 600;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      margin-left: 12px;\r\n      img {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n  .preview-content-block {\r\n    margin-top: 16px;\r\n    .title-block {\r\n      font-size: 15px;\r\n      color: #262626;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      .anticon-copy {\r\n        cursor: pointer;\r\n        &:hover {\r\n          color: #2475fc;\r\n        }\r\n      }\r\n    }\r\n    .preview-code-box {\r\n      width: fit-content;\r\n      min-width: 100%;\r\n      margin-top: 16px;\r\n      padding: 8px;\r\n      border-radius: 8px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &::v-deep(.vjs-tree) {\r\n        width: fit-content;\r\n      }\r\n\r\n      &::v-deep(.vjs-tree-node) {\r\n        width: calc(100% + 16px);\r\n        padding-right: 16px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.modal-title-block{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  .run-detail{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 16px;\r\n    background: #BFFBD7;\r\n    padding: 4px 16px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n    border-radius: 8px;\r\n  }\r\n}\r\n\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_batch_group')\"\r\n        @close=\"handleClose\"\r\n      >\r\n        <template #runBtn>\r\n          <a-tooltip>\r\n            <template #title>{{ t('btn_run_test') }}</template>\r\n            <div class=\"action-btn\" @click=\"handleOpenTestModal\">\r\n              <CaretRightOutlined style=\"color: rgb(0, 173, 58)\" />\r\n            </div>\r\n          </a-tooltip>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/execute.svg\" alt=\"\" />\r\n              <span>{{ t('title_execution_settings') }}</span>\r\n            </div>\r\n            <div class=\"row-form-item\">\r\n              <div class=\"form-label\">\r\n                <span>{{ t('label_parallel_count') }}</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_parallel_count') }}</template>\r\n                  <QuestionCircleOutlined class=\"tip-icon\" />\r\n                </a-tooltip>\r\n              </div>\r\n              <div>\r\n                <a-input-number\r\n                  style=\"width: 300px\"\r\n                  :max=\"10\"\r\n                  :min=\"1\"\r\n                  :precision=\"0\"\r\n                  :step=\"1\"\r\n                  :placeholder=\"t('ph_input_value')\"\r\n                  v-model:value=\"formState.chan_number\"\r\n                ></a-input-number>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"row-form-item\">\r\n              <div class=\"form-label\">\r\n                <span>{{ t('label_max_execution_count') }}</span>\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_max_execution_count') }}</template>\r\n                  <QuestionCircleOutlined class=\"tip-icon\" />\r\n                </a-tooltip>\r\n              </div>\r\n              <div>\r\n                <a-input-number\r\n                  style=\"width: 300px\"\r\n                  :max=\"500\"\r\n                  :min=\"1\"\r\n                  :precision=\"0\"\r\n                  :step=\"1\"\r\n                  :placeholder=\"t('ph_input_value')\"\r\n                  v-model:value=\"formState.max_run_number\"\r\n                ></a-input-number>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/execute_array.svg\" alt=\"\" />\r\n              {{ t('title_execution_array') }}\r\n              <a-tooltip>\r\n                <template #title>{{ t('tip_execution_array') }}</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\" style=\"width: 25%\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\" style=\"width: 30%\">{{ t('label_type') }}</div>\r\n                <div class=\"output-item\" style=\"width: 45%\">{{ t('label_param_value') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\">\r\n                <div\r\n                  class=\"form-item-list\"\r\n                  v-for=\"(item, index) in formState.batch_arrays\"\r\n                  :key=\"item._id\"\r\n                >\r\n                  <a-form-item :label=\"null\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 25%\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input_value')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 30%\"\r\n                          v-model:value=\"item.typ\"\r\n                          placeholder=\"\"\r\n                          readonly\r\n                        ></a-input>\r\n                        <a-cascader\r\n                          @change=\"(val, selectedOptions) => handleBatchArrChange(val, item, selectedOptions)\"\r\n                          v-model:value=\"item.value\"\r\n                          @dropdownVisibleChange=\"onBatchArrVisibleChange\"\r\n                          style=\"width: 45%\"\r\n                          :options=\"batchArraysOptions\"\r\n                          :allowClear=\"false\"\r\n                          :displayRender=\"({ labels }) => labels.join('/')\"\r\n                          :field-names=\"{ children: 'children' }\"\r\n                          :placeholder=\"t('ph_select_value')\"\r\n                        />\r\n                      </a-form-item-rest>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/output.svg\" alt=\"\" />\r\n              {{ t('title_output') }}\r\n              <a-tooltip>\r\n                <template #title>{{ t('tip_output') }}</template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n               <div class=\"output-item\" style=\"width: 23%\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\" style=\"width: 27%\">{{ t('label_type') }}</div>\r\n                <div class=\"output-item\" style=\"width: 45%\">{{ t('label_param_value') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\">\r\n                <div\r\n                  class=\"form-item-list\"\r\n                  v-for=\"(item, index) in formState.output\"\r\n                  :key=\"item._id\"\r\n                >\r\n                  <a-form-item :label=\"null\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 25%\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input_value')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-input\r\n                          style=\"width: 30%\"\r\n                          v-model:value=\"item.typ\"\r\n                          placeholder=\"\"\r\n                          readonly\r\n                        ></a-input>\r\n                        <a-cascader\r\n                          @change=\"(val) => handleOutputArrChange(val, item)\"\r\n                          v-model:value=\"item.value\"\r\n                          @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                          style=\"width: 45%\"\r\n                          :options=\"outputArrarysOptions\"\r\n                          :allowClear=\"false\"\r\n                          :displayRender=\"({ labels }) => labels.join('/')\"\r\n                          :field-names=\"{ children: 'children' }\"\r\n                          :placeholder=\"t('ph_select_value')\"\r\n                        />\r\n                      </a-form-item-rest>\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelOutputArrays(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <a-button\r\n                  @click.stop=\"handleAddOutputArrays\"\r\n                  :icon=\"h(PlusOutlined)\"\r\n                  block\r\n                  type=\"dashed\"\r\n                  >{{ t('btn_add_param') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n    <RunTest :batch_node_key=\"nodeId\" ref=\"runTestRef\" />\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { generateRandomId } from '@/utils/index'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport RunTest from '../../nodes/batch-group-node/components/run-test.vue'\r\nimport { ref, reactive, watch, h, onMounted, inject } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  PlusOutlined,\r\n  QuestionCircleOutlined,\r\n  CaretRightOutlined\r\n} from '@ant-design/icons-vue'\r\nimport { message } from 'ant-design-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.batch-group-form.index')\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\nconst batchArraysOptions = ref([])\r\nconst outputArrarysOptions = ref([])\r\nconst runTestRef = ref(null)\r\n\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  list = handleOptions(list)\r\n  list = list.filter((item) => item.group_node_key != item.loop_parent_key).filter((item) => item.node_id != item.group_node_key)\r\n\r\n  batchArraysOptions.value = filterArrayFields(list)\r\n}\r\n\r\nfunction filterArrayFields(list) {\r\n  const filterNodes = (nodes) => {\r\n    if (!nodes || nodes.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    return nodes.map(node => {\r\n      // 递归过滤子节点\r\n      const filteredChildren = filterNodes(node.children);\r\n\r\n      // 检查当前节点是否包含 'array' 类型，或者其子节点过滤后是否还有内容\r\n      if (node.typ.includes('array') || (filteredChildren && filteredChildren.length > 0)) {\r\n        return {\r\n          ...node,\r\n          children: filteredChildren\r\n        };\r\n      }\r\n\r\n      return null;\r\n    }).filter(Boolean); // 过滤掉 null 值\r\n  };\r\n\r\n  return filterNodes(list);\r\n}\r\n\r\nconst getOutputOptions = () => {\r\n  let list = getNode().getAllParentVariable()\r\n  list.forEach((item) => {\r\n    item.tags = item.tags || []\r\n  })\r\n \r\n  // 需要当前分组内的变量\r\n  list = list.filter((item) => item.group_node_key == item.loop_parent_key)\r\n\r\n  // 递归处理成后端需要的格式\r\n  const loop = (tree) => {\r\n    tree.forEach((item) => {\r\n      if(item.original_value){\r\n        item.value = item.original_value\r\n      }\r\n      if(item.children && item.children.length) {\r\n        loop(item.children)\r\n      }\r\n    })\r\n  }\r\n\r\n  // loop(list)\r\n  outputArrarysOptions.value = handleOptions(list)\r\n}\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOutputOptions()\r\n  }\r\n}\r\n\r\nconst formRef = ref()\r\n\r\nconst batch_arrays_default = {\r\n  key: '',\r\n  typ: '',\r\n  value: '',\r\n  _id: generateRandomId(16)\r\n}\r\n\r\nconst output_default = {\r\n  key: '',\r\n  typ: '',\r\n  value: '',\r\n  _id: generateRandomId(16)\r\n}\r\n\r\nconst formState = reactive({\r\n  chan_number: 10,\r\n  max_run_number: 500,\r\n  batch_arrays: [],\r\n  output: []\r\n})\r\n\r\n\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return []\r\n}\r\n\r\nconst onBatchArrVisibleChange = (visible) => {\r\n  if(visible){\r\n    getOptions()\r\n  }\r\n} \r\n\r\nconst handleBatchArrChange = (val, item, selectedOptions) => {\r\n  if(selectedOptions){\r\n    item.typ = selectedOptions[selectedOptions.length - 1].typ \r\n  }else{\r\n    item.typ = ''\r\n  }\r\n}\r\n\r\nconst handleAddOutputArrays = () => {\r\n  formState.output.push({\r\n    key: '',\r\n    typ: '',\r\n    value: '',\r\n    _id: generateRandomId(16)\r\n  })\r\n}\r\nconst onDelOutputArrays = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst handleOutputArrChange = (val, item) => {\r\n  if (val && val.length) {\r\n    let filterItem1 = outputArrarysOptions.value.filter((it) => it.value == val[0])[0].children\r\n    if (filterItem1 && filterItem1.length) {\r\n      let typ = filterItem1.filter((it) => it.value == val[1])[0].typ\r\n      item.typ = item.typ = typ.startsWith('array') ? typ : `array\\<${typ}>`\r\n    }\r\n  } else {\r\n    item.typ = ''\r\n  }\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nconst handleOpenTestModal = () => {\r\n  let data = formState.batch_arrays[0]\r\n\r\n  if (data && data.key && data.typ && data.value) {\r\n    runTestRef.value?.open()\r\n  } else {\r\n    message.error(t('msg_fill_execution_array'))\r\n  }\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let batch = JSON.parse(dataRaw).batch || {}\r\n\r\n    getOptions()\r\n    getOutputOptions()\r\n\r\n    formState.chan_number = batch.chan_number\r\n    formState.max_run_number = batch.max_run_number\r\n    formState.batch_arrays = batch.batch_arrays.map((item) => {\r\n      return {\r\n        ...item,\r\n        value: formatQuestionValue(item.value)\r\n      }\r\n    })\r\n\r\n    formState.output = batch.output.map((item) => {\r\n      return {\r\n        ...item,\r\n        value: formatQuestionValue(item.value)\r\n      }\r\n    })\r\n\r\n    if (formState.batch_arrays.length == 0) {\r\n      formState.batch_arrays = [batch_arrays_default]\r\n    }\r\n\r\n    if (formState.output.length == 0) {\r\n      formState.output = [output_default]\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    batch: {\r\n      ...formState,\r\n      batch_arrays: formState.batch_arrays.map((item) => {\r\n        return {\r\n          ...item,\r\n          value: item.value ? item.value.join('.') : ''\r\n        }\r\n      }),\r\n      chan_number: formState.chan_number,\r\n      max_run_number: formState.max_run_number,\r\n      output: formState.output.map((item) => {\r\n        let value = item.value ? item.value.join('.') : ''\r\n\r\n        return {\r\n          ...item,\r\n          value: value\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.row-form-item {\r\n  margin-bottom: 12px;\r\n\r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n\r\n  .form-label {\r\n    display: flex;\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n\r\n    .tip-icon {\r\n      margin-left: 2px;\r\n      color: #8c8c8c;\r\n    }\r\n  }\r\n}\r\n\r\n.flex-form-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.gray-block {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.gray-block-title {\r\n  img {\r\n    width: 16px;\r\n    height: 16px;\r\n  }\r\n}\r\n\r\n.at-input-flex1 {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.action-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in;\r\n  margin-left: 8px;\r\n  &:hover {\r\n    background: #e4e6eb;\r\n  }\r\n}\r\n\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n\r\n    .output-item {\r\n      width: 24%;\r\n    }\r\n  }\r\n\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    :class=\"['sub-field-item-box', `sub-field-item-box_${props.level}`]\"\r\n    v-for=\"(item, index) in props.data\"\r\n    :key=\"item.cu_key\"\r\n  >\r\n    <div class=\"sub-field-item\">\r\n      <a-flex>\r\n        <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n        <a-input\r\n          :style=\"{ width: widthPx }\"\r\n          v-model:value=\"item.key\"\r\n          :placeholder=\"t('ph_input')\"\r\n        ></a-input>\r\n      </a-flex>\r\n      <!-- <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" /> -->\r\n      <a-select\r\n        @change=\"onTypeChange(item)\"\r\n        v-model:value=\"item.typ\"\r\n        :placeholder=\"t('ph_select')\"\r\n        style=\"width: 114px\"\r\n      >\r\n        <a-select-option v-for=\"op in filterTypOptions\" :value=\"op.value\">{{\r\n          op.value\r\n        }}</a-select-option>\r\n      </a-select>\r\n      <div style=\"width: 200px\">\r\n        <at-input\r\n          v-if=\"item.typ != 'object'\"\r\n          :options=\"variableOptions\"\r\n          :defaultSelectedList=\"item.tags\"\r\n          :defaultValue=\"item.desc\"\r\n          @change=\"(text, selectedList) => changeOutputValue(text, selectedList, item, index)\"\r\n          :placeholder=\"t('ph_input_value')\"\r\n        >\r\n          <template #option=\"{ label, payload }\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-label\">{{ label }}</div>\r\n              <div class=\"field-type\">{{ payload.typ }}</div>\r\n            </div>\r\n          </template>\r\n        </at-input>\r\n      </div>\r\n      <div class=\"btn-hover-wrap\" @click=\"onAddSubs(index, props.data)\" v-if=\"showAddBtn(item)\">\r\n        <PlusCircleOutlined />\r\n      </div>\r\n      <div class=\"btn-hover-wrap\" v-else style=\"opacity: 0\">\r\n        <PlusCircleOutlined />\r\n      </div>\r\n\r\n      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index, props.data)\">\r\n        <CloseCircleOutlined />\r\n      </div>\r\n    </div>\r\n    <template v-if=\"item.subs && item.subs.length > 0\">\r\n      <SubsKey\r\n        :level=\"props.level + 1\"\r\n        :typOptions=\"props.typOptions\"\r\n        :variableOptions=\"props.variableOptions\"\r\n        :data=\"item.subs\"\r\n      />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { computed } from 'vue'\r\nimport { CloseCircleOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.end-node-form.subs-key')\r\nconst props = defineProps({\r\n  data: {},\r\n  level: {\r\n    type: Number\r\n  },\r\n  typOptions: {\r\n    type: Array\r\n  },\r\n  variableOptions: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst filterTypOptions = computed(() => {\r\n  if (props.level > 2) {\r\n    return props.typOptions.filter((item) => item.value != 'object')\r\n  }\r\n  return props.typOptions\r\n})\r\n\r\nconst widthPx = computed(() => {\r\n  if (props.level == 2) {\r\n    return '165px'\r\n  }\r\n  return '130px'\r\n})\r\n\r\nconst onAddSubs = (index, data) => {\r\n  data[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index, data) => {\r\n  data.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst showAddBtn = (item) => {\r\n  return item.typ == 'object' && props.level <= 2\r\n}\r\n\r\nconst changeOutputValue = (text, selectedList, item) => {\r\n  item.tags = selectedList\r\n  item.desc = text\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sub-field-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 4px;\r\n  gap: 8px;\r\n  .btn-hover-wrap {\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    width: 24px;\r\n    height: 24px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n.mr12 {\r\n  margin-right: 12px;\r\n}\r\n.mr8 {\r\n  margin-right: 8px;\r\n}\r\n.sub-field-item-box_3 .fork-icon {\r\n  margin-left: 34px;\r\n}\r\n.fork-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_end_node')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('title_output_type') }}</div>\r\n            <a-segmented\r\n              class=\"customer-segmented\"\r\n              v-model:value=\"formState.out_type\"\r\n              :options=\"typeOptions\"\r\n            />\r\n          </div>\r\n          <div class=\"gray-block\" style=\"margin-top: 12px\" v-if=\"formState.out_type == 'variable'\">\r\n            <div class=\"gray-block-title\">{{ t('title_output_variable') }}</div>\r\n\r\n            <div class=\"array-form-box\">\r\n              <div class=\"field-key-title\">\r\n                <div class=\"field-key\" style=\"width: 200px\">{{ t('label_param_key') }}</div>\r\n                <div class=\"field-key\" style=\"width: 114px\">{{ t('label_type') }}</div>\r\n                <div class=\"field-key\" style=\"flex: 1\">{{ t('label_param_value') }}</div>\r\n              </div>\r\n              <div class=\"form-item-list\">\r\n                <a-form-item :label=\"null\">\r\n                  <div class=\"flex-block-item\" style=\"gap: 8px\">\r\n                    <a-input\r\n                      style=\"width: 200px\"\r\n                      disabled\r\n                      :value=\"'content'\"\r\n                      :placeholder=\"t('ph_input_value')\"\r\n                    ></a-input>\r\n                    <a-form-item-rest>\r\n                      <a-select\r\n                        :value=\"'string'\"\r\n                        disabled\r\n                        :placeholder=\"t('ph_select_value')\"\r\n                        style=\"width: 114px\"\r\n                      >\r\n                        <a-select-option\r\n                          v-for=\"op in typOptions\"\r\n                          :value=\"op.value\"\r\n                          :key=\"op.value\"\r\n                          >{{ op.value }}</a-select-option\r\n                        >\r\n                      </a-select>\r\n                    </a-form-item-rest>\r\n                    <div class=\"msg_content_return_setting\">\r\n                      <ExclamationCircleFilled style=\"color: #faad14\" />\r\n                      {{ t('msg_content_return_setting') }}\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.outputs\" :key=\"index\">\r\n                <a-form-item :label=\"null\">\r\n                  <div class=\"flex-block-item\" style=\"gap: 8px\">\r\n                    <a-input\r\n                      style=\"width: 200px\"\r\n                      v-model:value=\"item.key\"\r\n                      :placeholder=\"t('ph_input_value')\"\r\n                    ></a-input>\r\n                    <a-form-item-rest>\r\n                      <a-select\r\n                        @change=\"onTypeChange(item)\"\r\n                        v-model:value=\"item.typ\"\r\n                        :placeholder=\"t('ph_select_value')\"\r\n                        style=\"width: 114px\"\r\n                      >\r\n                        <a-select-option\r\n                          v-for=\"op in typOptions\"\r\n                          :value=\"op.value\"\r\n                          :key=\"op.value\"\r\n                          >{{ op.value }}</a-select-option\r\n                        >\r\n                      </a-select>\r\n                    </a-form-item-rest>\r\n                    <div style=\"width: 200px\">\r\n                      <at-input\r\n                        v-if=\"item.typ != 'object'\"\r\n                        :options=\"filterOutputOption(item)\"\r\n                        :defaultSelectedList=\"item.tags\"\r\n                        :defaultValue=\"item.desc\"\r\n                        @open=\"getVlaueVariableList\"\r\n                        @change=\"\r\n                          (text, selectedList) => changeOutputValue(text, selectedList, item, index)\r\n                        \"\r\n                        :placeholder=\"t('ph_input_variable_value')\"\r\n                      >\r\n                        <template #option=\"{ label, payload }\">\r\n                          <div class=\"field-list-item\">\r\n                            <div class=\"field-label\">{{ label }}</div>\r\n                            <div class=\"field-type\">{{ payload.typ }}</div>\r\n                          </div>\r\n                        </template>\r\n                      </at-input>\r\n                    </div>\r\n\r\n                    <div\r\n                      class=\"btn-hover-wrap\"\r\n                      v-if=\"item.typ == 'object'\"\r\n                      @click=\"onAddSubs(index)\"\r\n                    >\r\n                      <PlusCircleOutlined />\r\n                    </div>\r\n\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                    <a-form-item-rest>\r\n                      <SubKey\r\n                        :data=\"item.subs\"\r\n                        :level=\"2\"\r\n                        :typOptions=\"typOptions\"\r\n                        :variableOptions=\"variableOptions\"\r\n                      />\r\n                    </a-form-item-rest>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddOutPut\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >{{ t('btn_add_param') }}</a-button\r\n              >\r\n            </div>\r\n          </div>\r\n          <div class=\"gray-block\" style=\"margin-top: 12px\">\r\n            <div class=\"gray-block-title\">{{ t('title_custom_message') }}</div>\r\n            <div class=\"array-form-box\">\r\n              <div class=\"form-item-label\" style=\"margin-bottom: 8px\">\r\n                {{ t('msg_custom_message_desc') }}\r\n              </div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.messages\" :key=\"index\">\r\n                <a-form-item :label=\"null\">\r\n                  <div class=\"input-block-item\">\r\n                    <div class=\"input-header\">\r\n                      <div>\r\n                        {{ index + 1 }}、\r\n                        <span v-if=\"item.type == 'text'\">{{ t('label_text_message') }}</span>\r\n                        <span v-if=\"item.type == 'image'\">{{ t('label_image_message') }}</span>\r\n                        <span v-if=\"item.type == 'voice'\">{{ t('label_voice_message') }}</span>\r\n                      </div>\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelItem(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                    <at-input\r\n                      inputStyle=\"height: 100px;\"\r\n                      :ref=\"(el) => setAtInputRef(el, index)\"\r\n                      :options=\"variableOptions\"\r\n                      :defaultSelectedList=\"item.tags\"\r\n                      :defaultValue=\"item.content\"\r\n                      @open=\"getVlaueVariableList\"\r\n                      type=\"textarea\"\r\n                      @change=\"(text, selectedList) => changeValue(text, selectedList, item, index)\"\r\n                      :placeholder=\"placeholderMap[item.type]\"\r\n                    >\r\n                      <template #option=\"{ label, payload }\">\r\n                        <div class=\"field-list-item\">\r\n                          <div class=\"field-label\">{{ label }}</div>\r\n                          <div class=\"field-type\">{{ payload.typ }}</div>\r\n                        </div>\r\n                      </template>\r\n                    </at-input>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-dropdown>\r\n                <div>\r\n                  <a-button type=\"dashed\" block\r\n                    ><PlusOutlined />{{ t('btn_add_message', { count: formState.messages.length }) }}</a-button\r\n                  >\r\n                </div>\r\n\r\n                <template #overlay>\r\n                  <a-menu>\r\n                    <a-menu-item @click=\"handleAddItem('text')\">\r\n                      <a>{{ t('label_text') }}</a>\r\n                    </a-menu-item>\r\n                    <a-menu-item @click=\"handleAddItem('image')\">\r\n                      <a>{{ t('label_image') }}</a>\r\n                    </a-menu-item>\r\n                    <a-menu-item @click=\"handleAddItem('voice')\">\r\n                      <a>{{ t('label_voice') }}</a>\r\n                    </a-menu-item>\r\n                  </a-menu>\r\n                </template>\r\n              </a-dropdown>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { getUuid } from '@/utils/index'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, h, onMounted } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  PlusSquareOutlined,\r\n  PlusOutlined,\r\n  PlusCircleOutlined,\r\n  ExclamationCircleFilled\r\n} from '@ant-design/icons-vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport SubKey from './subs-key.vue'\r\nimport { message } from 'ant-design-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.end-node-form.index')\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst placeholderMap = {\r\n  text: t('ph_text_message'),\r\n  image: t('ph_image_message'),\r\n  voice: t('ph_voice_message')\r\n}\r\n\r\nconst typeOptions = [\r\n  {\r\n    label: t('label_return_message'),\r\n    value: 'message'\r\n  },\r\n  {\r\n    label: t('label_return_message_and_variable'),\r\n    value: 'variable'\r\n  }\r\n]\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst atInputRefs = reactive({})\r\nconst setAtInputRef = (el, index) => {\r\n  if (el) {\r\n    let key = `at_input_${index}`\r\n    atInputRefs[key] = el\r\n  }\r\n}\r\n\r\nconst changeValue = (text, selectedList, item) => {\r\n  item.tags = selectedList\r\n  item.content = text\r\n}\r\n\r\nconst changeOutputValue = (text, selectedList, item) => {\r\n  item.tags = selectedList\r\n  item.desc = text\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n    list.forEach((item) => {\r\n      item.tags = item.tags || []\r\n    })\r\n\r\n    variableOptions.value = list\r\n  }\r\n}\r\n\r\nfunction filterOutputOption(item) {\r\n  if (item.typ) {\r\n    return filterCalueOptions(variableOptions.value, item.typ)\r\n  }\r\n  return variableOptions.value\r\n}\r\n\r\nfunction filterCalueOptions(list, typ) {\r\n  function traverse(items) {\r\n    const result = []\r\n\r\n    for (const item of items) {\r\n      if (item.children && item.children.length > 0) {\r\n        // 有子节点的情况，递归处理子节点\r\n        const filteredChildren = traverse(item.children)\r\n\r\n        if (filteredChildren.length > 0) {\r\n          // 如果过滤后的子节点不为空，保留当前节点并更新其子节点\r\n          const newItem = { ...item, children: filteredChildren }\r\n          result.push(newItem)\r\n        }\r\n      } else {\r\n        // 叶子节点，检查类型是否符合要求\r\n        if (item.typ && item.typ === typ) {\r\n          result.push({ ...item })\r\n        }\r\n      }\r\n    }\r\n\r\n    return result\r\n  }\r\n\r\n  return traverse(list)\r\n}\r\n\r\nconst formState = reactive({\r\n  out_type: 'message', // variable\r\n  messages: [\r\n    {\r\n      key: getUuid(16),\r\n      type: 'text',\r\n      content: ''\r\n    }\r\n  ],\r\n  outputs: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    finish: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let finish = JSON.parse(dataRaw).finish || {}\r\n    finish = JSON.parse(JSON.stringify(finish))\r\n\r\n    getVlaueVariableList()\r\n\r\n    formState.out_type = finish.out_type || 'message'\r\n    formState.messages = finish.messages || []\r\n\r\n    if (formState.messages.length == 0) {\r\n      formState.messages = [\r\n        {\r\n          key: getUuid(16),\r\n          type: 'text',\r\n          content: ''\r\n        }\r\n      ]\r\n    }\r\n    formState.outputs = finish.outputs || []\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddItem = (type) => {\r\n  if (formState.messages.length >= 5) {\r\n    return message.warning(t('msg_max_5_messages'))\r\n  }\r\n  formState.messages.push({\r\n    key: getUuid(16),\r\n    type,\r\n    content: ''\r\n  })\r\n}\r\n\r\nconst onDelItem = (index) => {\r\n  if (formState.messages.length <= 1) {\r\n    return message.warning(t('msg_min_1_message'))\r\n  }\r\n  formState.messages.splice(index, 1)\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nconst handleAddOutPut = () => {\r\n  formState.outputs.push({\r\n    key: '',\r\n    typ: 'string',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index) => {\r\n  formState.outputs.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n  data.desc = void 0\r\n  data.tags = []\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  formState.outputs[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.gray-block-title {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.input-block-item {\r\n  background: #e4e6eb;\r\n  border-radius: 6px;\r\n  padding: 8px;\r\n  .input-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n}\r\n\r\n.flex-block-item .btn-hover-wrap {\r\n  width: 24px;\r\n  height: 24px;\r\n}\r\n\r\n.field-key-title {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 14px;\r\n  color: #262626;\r\n  gap: 8px;\r\n  margin-bottom: 4px;\r\n  font-weight: 600;\r\n}\r\n\r\n.msg_content_return_setting{\r\n  line-height: 16px;\r\n  font-size: 13px;\r\n}\r\n</style>\r\n","import { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport const getDefaultRadioOpt = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return [\r\n    {label: t('label_close'), value: false},\r\n    {label: t('label_open'), value: true},\r\n  ]\r\n}\r\n\r\nexport const defaultRadioOpt = getDefaultRadioOpt()\r\n\r\nexport const getDefaultVoiceOpts = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return [\r\n    { label: t('voice_male'), value: 'male-qn-jingying' },\r\n    { label: t('voice_female'), value: 'female-chengshu' },\r\n    { label: t('voice_boy'), value: 'clever_boy' },\r\n    { label: t('voice_girl'), value: 'lovely_girl' },\r\n  ]\r\n}\r\n\r\nexport const defaultVoiceOpts = getDefaultVoiceOpts()\r\n\r\nexport const getEmotionMap = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return {\r\n    happy: t('emotion_happy'),\r\n    sad: t('emotion_sad'),\r\n    angry: t('emotion_angry'),\r\n    fearful: t('emotion_fearful'),\r\n    disgusted: t('emotion_disgusted'),\r\n    surprised: t('emotion_surprised'),\r\n    calm: t('emotion_calm'),\r\n    fluent: t('emotion_fluent'),\r\n    whisper: t('emotion_whisper')\r\n  }\r\n}\r\n\r\nexport const emotionMap = getEmotionMap()\r\n\r\n\r\nexport const audioSampleRates = [8000, 16000, 22050, 24000, 32000, 44100];\r\n\r\nexport const audioBitrate = [32000, 64000, 128000, 256000];\r\n\r\nexport const audioFormats = ['mp3', 'pcm', 'flac', 'wav'];\r\n\r\nexport const getAudioChannels = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return [\r\n    {label: t('channel_mono'), value: 1},\r\n    {label: t('channel_stereo'), value: 2},\r\n  ]\r\n}\r\n\r\nexport const audioChannels = getAudioChannels()\r\n\r\nexport const formatMap = {\r\n  url: 'url',\r\n  hex: 'hex'\r\n};\r\n\r\nexport const getEffectMap = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return {\r\n    spacious_echo: t('effect_spacious_echo'),\r\n    auditorium_echo: t('effect_auditorium_echo'),\r\n    lofi_telephone: t('effect_lofi_telephone'),\r\n    robotic: t('effect_robotic')\r\n  }\r\n}\r\n\r\nexport const effectMap = getEffectMap()\r\n\r\nexport const getLanguageMap = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return {\r\n    auto: t('language_auto'),\r\n    Chinese: t('language_chinese'),\r\n    Yue: t('language_yue'),\r\n    English: t('language_english'),\r\n    Arabic: t('language_arabic'),\r\n    Russian: t('language_russian'),\r\n    Spanish: t('language_spanish'),\r\n    French: t('language_french'),\r\n    Portuguese: t('language_portuguese'),\r\n    German: t('language_german'),\r\n    Turkish: t('language_turkish'),\r\n    Dutch: t('language_dutch'),\r\n    Ukrainian: t('language_ukrainian'),\r\n    Vietnamese: t('language_vietnamese'),\r\n    Indonesian: t('language_indonesian'),\r\n    Japanese: t('language_japanese'),\r\n    Italian: t('language_italian'),\r\n    Korean: t('language_korean'),\r\n    Thai: t('language_thai'),\r\n    Polish: t('language_polish'),\r\n    Romanian: t('language_romanian'),\r\n    Greek: t('language_greek'),\r\n    Czech: t('language_czech'),\r\n    Finnish: t('language_finnish'),\r\n    Hindi: t('language_hindi'),\r\n    Bulgarian: t('language_bulgarian'),\r\n    Danish: t('language_danish'),\r\n    Hebrew: t('language_hebrew'),\r\n    Malay: t('language_malay'),\r\n    Persian: t('language_persian'),\r\n    Slovak: t('language_slovak'),\r\n    Swedish: t('language_swedish'),\r\n    Croatian: t('language_croatian'),\r\n    Filipino: t('language_filipino'),\r\n    Hungarian: t('language_hungarian'),\r\n    Norwegian: t('language_norwegian'),\r\n    Slovenian: t('language_slovenian'),\r\n    Catalan: t('language_catalan'),\r\n    Nynorsk: t('language_nynorsk'),\r\n    Tamil: t('language_tamil'),\r\n    Afrikaans: t('language_afrikaans'),\r\n  }\r\n}\r\n\r\nexport const languageMap = getLanguageMap()\r\n\r\nexport const getVoiceSettingSliderConfig = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return {\r\n    'speed': {\r\n      ui_type: 'slider',\r\n      key: 'voice_setting.speed',\r\n      label: t('label_speed'),\r\n      type: 'number',\r\n      required: true,\r\n      tooltip: t('tooltip_speed'),\r\n      default: 1.0,\r\n      min: 0.5,\r\n      max: 2,\r\n      step: 0.1,\r\n      marks: {0.5: '0.5', 2: '2'}\r\n    },\r\n    'vol': {\r\n      ui_type: 'slider',\r\n      key: 'voice_setting.vol',\r\n      label: t('label_volume'),\r\n      type: 'number',\r\n      required: true,\r\n      tooltip: t('tooltip_volume'),\r\n      default: 1,\r\n      min: 0,\r\n      max: 10,\r\n      step: 1,\r\n      marks: {0: '0', 10: '10'}\r\n    },\r\n    'pitch': {\r\n      ui_type: 'slider',\r\n      key: 'voice_setting.pitch',\r\n      label: t('label_pitch'),\r\n      type: 'number',\r\n      required: true,\r\n      tooltip: t('tooltip_pitch'),\r\n      default: 0,\r\n      min: -12,\r\n      max: 12,\r\n      step: 1,\r\n      marks: {'-12': '-12', 12: '12'}\r\n    }\r\n  }\r\n}\r\n\r\nexport const voiceSettingSliderConfig = getVoiceSettingSliderConfig()\r\n\r\n\r\nexport const getVoiceModifySliderConfig = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return {\r\n    'pitch': {\r\n      ui_type: 'slider',\r\n      key: 'voice_modify.pitch',\r\n      label: t('label_pitch'),\r\n      type: 'number',\r\n      tooltip: t('tooltip_pitch_modify'),\r\n      default: 0,\r\n      min: -100,\r\n      max: 100,\r\n      step: 1,\r\n      marks: {'-100': '-100', 100: '100'}\r\n    },\r\n\r\n    'intensity': {\r\n      ui_type: 'slider',\r\n      key: 'voice_modify.intensity',\r\n      label: t('label_intensity'),\r\n      type: 'number',\r\n      tooltip: t('tooltip_intensity'),\r\n      default: 0,\r\n      min: -100,\r\n      max: 100,\r\n      step: 1,\r\n      marks: {'-100': '-100', 100: '100'}\r\n    },\r\n\r\n    'timbre': {\r\n      ui_type: 'slider',\r\n      key: 'voice_modify.timbre',\r\n      label: t('label_timbre'),\r\n      type: 'number',\r\n      tooltip: t('tooltip_timbre'),\r\n      default: 0,\r\n      min: -100,\r\n      max: 100,\r\n      step: 1,\r\n      marks: {'-100': '-100', 100: '100'}\r\n    },\r\n  }\r\n}\r\n\r\nexport const voiceModifySliderConfig = getVoiceModifySliderConfig()\r\n\r\nexport const getVoiceOutputObj = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return {\r\n    \"data\": {\r\n      \"desc\": t('desc_audio_synthesis_result'),\r\n      \"type\": \"object\",\r\n      \"properties\": {\r\n        \"audio\": {\r\n          \"desc\": t('desc_audio_data'),\r\n          \"type\": \"string\"\r\n        },\r\n        \"status\": {\r\n          \"desc\": t('desc_audio_synthesis_status'),\r\n          \"type\": \"number\"\r\n        }\r\n      }\r\n    },\r\n    \"extra_info\": {\r\n      \"desc\": t('desc_audio_extra_info'),\r\n      \"type\": \"object\",\r\n      \"properties\": {\r\n        \"audio_length\": {\r\n          \"desc\": t('desc_audio_length'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"audio_sample_rate\": {\r\n          \"desc\": t('desc_audio_sample_rate'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"audio_size\": {\r\n          \"desc\": t('desc_audio_size'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"bitrate\": {\r\n          \"desc\": t('desc_bitrate'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"word_count\": {\r\n          \"desc\": t('desc_word_count'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"invisible_character_ratio\": {\r\n          \"desc\": t('desc_invisible_character_ratio'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"usage_characters\": {\r\n          \"desc\": t('desc_usage_characters'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"audio_format\": {\r\n          \"desc\": t('desc_audio_format'),\r\n          \"type\": \"string\"\r\n        },\r\n        \"audio_channel\": {\r\n          \"desc\": t('desc_audio_channel'),\r\n          \"type\": \"number\"\r\n        }\r\n      }\r\n    },\r\n    \"trace_id\": {\r\n      \"desc\": t('desc_request_trace_id'),\r\n      \"type\": \"string\"\r\n    },\r\n    \"base_resp\": {\r\n      \"desc\": t('desc_base_response'),\r\n      \"type\": \"object\",\r\n      \"properties\": {\r\n        \"status_code\": {\r\n          \"desc\": t('desc_status_code'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"status_msg\": {\r\n          \"desc\": t('desc_status_msg'),\r\n          \"type\": \"string\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const voiceOutputObj = getVoiceOutputObj()\r\n\r\nexport const getVoiceCloneOutputObj = () => {\r\n  const { t } = useI18n('constants.voice')\r\n  return {\r\n    \"input_sensitive\": {\r\n      \"desc\": t('desc_input_sensitive'),\r\n      \"type\": \"boolean\"\r\n    },\r\n    \"input_sensitive_type\": {\r\n      \"desc\": t('desc_sensitive_type'),\r\n      \"type\": \"number\"\r\n    },\r\n    \"demo_audio\": {\r\n      \"desc\": t('desc_demo_audio'),\r\n      \"type\": \"string\"\r\n    },\r\n    \"base_resp\": {\r\n      \"desc\": t('desc_base_response'),\r\n      \"type\": \"object\",\r\n      \"properties\": {\r\n        \"status_code\": {\r\n          \"desc\": t('desc_status_code'),\r\n          \"type\": \"number\"\r\n        },\r\n        \"status_msg\": {\r\n          \"desc\": t('desc_status_msg'),\r\n          \"type\": \"string\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const voiceCloneOutputObj = getVoiceCloneOutputObj()\r\n\r\n\r\n","<template>\r\n  <NodeFormLayout class=\"voice-clone-form\">\r\n    <NodeFormHeader\r\n      :title=\"node.node_name\"\r\n      :iconName=\"node.node_icon_name\"\r\n      :desc=\"t('desc_voice_clone')\"\r\n    />\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('label_input') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_clone_audio_file') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.file_url || []\"\r\n            :defaultValue=\"formState.file_url\"\r\n            ref=\"atInputRef\"\r\n            :placeholder=\"t('ph_input_file_url')\"\r\n            @open=\"getValueVariableList\"\r\n            @change=\"(text, selectedList) => changeValue('file_url', text, selectedList)\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{ t('msg_clone_audio') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_voice_id') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.voice_id || []\"\r\n            :defaultValue=\"formState.voice_id\"\r\n            ref=\"atInputRef\"\r\n            :placeholder=\"t('ph_input_voice_id')\"\r\n            @open=\"getValueVariableList\"\r\n            @change=\"(text, selectedList) => changeValue('voice_id', text, selectedList)\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{ t('msg_voice_id_desc') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <div class=\"options-item-tit flex-between\">\r\n          <div class=\"option-label\">{{ t('label_clone_sample_audio') }}</div>\r\n          <a @click=\"settingsShowChange\">{{ t('label_advanced_settings') }} <DownOutlined v-if=\"!settingsOpen\"/><UpOutlined v-else/></a>\r\n        </div>\r\n      </div>\r\n\r\n      <template v-if=\"settingsOpen\">\r\n        <div class=\"options-item\">\r\n          <div class=\"form-box\">\r\n            <div class=\"form-item \">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_audio_file')\">\r\n                  {{ t('label_audio_file') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <AtInput\r\n                  type=\"textarea\"\r\n                  inputStyle=\"height: 64px;\"\r\n                  :options=\"variableOptions\"\r\n                  :defaultSelectedList=\"formState.tag_map?.prompt_audio_url || []\"\r\n                  :defaultValue=\"formState.clone_prompt.prompt_audio_url\"\r\n                  ref=\"atInputRef\"\r\n                  :placeholder=\"t('ph_input_file_url')\"\r\n                  @open=\"getValueVariableList\"\r\n                  @change=\"(text, selectedList) => changeValue('prompt_audio_url', text, selectedList, formState.clone_prompt)\"\r\n                >\r\n                  <template #option=\"{ label, payload }\">\r\n                    <div class=\"field-list-item\">\r\n                      <div class=\"field-label\">{{ label }}</div>\r\n                      <div class=\"field-type\">{{ payload.typ }}</div>\r\n                    </div>\r\n                  </template>\r\n                </AtInput>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item \">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_text')\">\r\n                  {{ t('label_text') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <AtInput\r\n                  type=\"textarea\"\r\n                  inputStyle=\"height: 64px;\"\r\n                  :options=\"variableOptions\"\r\n                  :defaultSelectedList=\"formState.tag_map?.prompt_text || []\"\r\n                  :defaultValue=\"formState.clone_prompt.prompt_text\"\r\n                  ref=\"atInputRef\"\r\n                  :placeholder=\"t('ph_input_sample_text')\"\r\n                  @open=\"getValueVariableList\"\r\n                  @change=\"(text, selectedList) => changeValue('prompt_text', text, selectedList, formState.clone_prompt)\"\r\n                >\r\n                  <template #option=\"{ label, payload }\">\r\n                    <div class=\"field-list-item\">\r\n                      <div class=\"field-label\">{{ label }}</div>\r\n                      <div class=\"field-type\">{{ payload.typ }}</div>\r\n                    </div>\r\n                  </template>\r\n                </AtInput>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_clone_preview_params') }}</div>\r\n          </div>\r\n          <div class=\"form-box\">\r\n            <div class=\"form-item \">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_preview_text')\">\r\n                  {{ t('label_preview_text') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <AtInput\r\n                  type=\"textarea\"\r\n                  inputStyle=\"height: 64px;\"\r\n                  :options=\"variableOptions\"\r\n                  :defaultSelectedList=\"formState.tag_map?.text || []\"\r\n                  :defaultValue=\"formState.text\"\r\n                  ref=\"atInputRef\"\r\n                  :placeholder=\"t('ph_input_preview_text')\"\r\n                  @open=\"getValueVariableList\"\r\n                  @change=\"(text, selectedList) => changeValue('text', text, selectedList)\"\r\n                >\r\n                  <template #option=\"{ label, payload }\">\r\n                    <div class=\"field-list-item\">\r\n                      <div class=\"field-label\">{{ label }}</div>\r\n                      <div class=\"field-type\">{{ payload.typ }}</div>\r\n                    </div>\r\n                  </template>\r\n                </AtInput>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_small_language_recognition')\">\r\n                  {{ t('label_small_language_recognition') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.language_boost\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"(txt, key) in languageMap\" :key=\"key\" :value=\"key\">{{ txt }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"form-box\">\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit c262626\">\r\n                <a-tooltip :title=\"t('tip_preview_audio_model')\">\r\n                  {{ t('label_preview_audio_model') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ModelSelect\r\n                  style=\"width: 276px;\"\r\n                  model-type=\"TTS\"\r\n                  v-model:modeName=\"formState.model\"\r\n                  v-model:modeId=\"formState.model_id\"\r\n                  v-model:useConfigId=\"formState.model_config_id\"\r\n                  @change=\"update\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"form-box\">\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_noise_reduction')\">\r\n                  {{ t('label_noise_reduction') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ZmRadioGroup v-model:value=\"formState.need_noise_reduction\" :options=\"defaultRadioOpt\" @change=\"update\"/>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_volume_normalization')\">\r\n                  {{ t('label_volume_normalization') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ZmRadioGroup v-model:value=\"formState.need_volume_normalization\" :options=\"defaultRadioOpt\" @change=\"update\"/>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_audio_rhythm_mark')\">\r\n                  {{ t('label_audio_rhythm_mark') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ZmRadioGroup v-model:value=\"formState.aigc_watermark\" :options=\"defaultRadioOpt\" @change=\"update\"/>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('label_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, onMounted, reactive, inject} from 'vue';\r\nimport NodeFormLayout from \"@/views/workflow/components/node-form-drawer/node-form-layout.vue\";\r\nimport ModelSelect from \"@/components/model-select/model-select.vue\";\r\nimport NodeFormHeader from \"@/views/workflow/components/node-form-drawer/node-form-header.vue\";\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport ZmRadioGroup from \"@/components/common/zm-radio-group.vue\";\r\nimport {QuestionCircleOutlined, DownOutlined, UpOutlined} from '@ant-design/icons-vue';\r\nimport {message} from 'ant-design-vue';\r\nimport {\r\n  defaultRadioOpt,\r\n  languageMap,\r\n  voiceCloneOutputObj,\r\n} from \"@/constants/voice.js\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {pluginOutputToTree} from \"@/constants/plugin.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.voice-clone-form')\r\n\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\nconst setData = inject('setData')\r\nconst voiceModalRef = ref(null)\r\nconst variableOptions = ref([])\r\nconst outputData = ref([])\r\nconst voiceSelectOpts = ref([])\r\nconst formState = reactive({\r\n  model_id: 0,\r\n  model: '',\r\n  model_config_id: 0,\r\n  file_url: '',\r\n  voice_id: '',\r\n  clone_prompt: {\r\n    prompt_audio_url: '',\r\n    prompt_text: '',\r\n    tag_map: {}\r\n  },\r\n  text: '',\r\n  language_boost: 'auto',\r\n  need_noise_reduction: false,\r\n  need_volume_normalization: false,\r\n  aigc_watermark: false,\r\n  tag_map: {}\r\n})\r\nconst settingsOpen = ref(false)\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n\r\nfunction init() {\r\n  getValueVariableList();\r\n  outputData.value = pluginOutputToTree(voiceCloneOutputObj)\r\n  nodeParamsAssign()\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let arg = nodeParams?.voice_clone?.arguments || {}\r\n  arg.tag_map = arg.tag_map ? arg.tag_map : {}\r\n  Object.assign(formState, arg)\r\n}\r\n\r\nfunction getValueVariableList() {\r\n  variableOptions.value = getNode().getAllParentVariable()\r\n}\r\n\r\nfunction changeValue(field, text, selectedList, _state=null) {\r\n  _state = _state || formState\r\n  _state[field] = text\r\n  formState.tag_map[field] = selectedList\r\n  update()\r\n}\r\n\r\nfunction changeVoiceId(text, selectedList) {\r\n  formState.voice_setting.voice_id = text\r\n  formState.tag_map.voice_setting_voice_id = selectedList\r\n  update()\r\n}\r\n\r\nfunction showVoiceModal() {\r\n  if (!formState.model_config_id) {\r\n    return message.warning(t('msg_select_model_first'))\r\n  }\r\n  voiceModalRef.value.show([formState.voice_setting.voice_id])\r\n}\r\n\r\nfunction voiceSetTypeChange() {\r\n  update()\r\n}\r\n\r\nfunction voiceChange(keys, rows) {\r\n  formState.voice_setting.voice_id = keys[0]\r\n  voiceSelectOpts.value = rows\r\n  update()\r\n}\r\n\r\nfunction settingsShowChange() {\r\n  settingsOpen.value = !settingsOpen.value\r\n}\r\n\r\nfunction update() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  formState.model_id = Number(formState.model_id || 0)\r\n  Object.assign(nodeParams.voice_clone, {\r\n    model_config_id: formState.model_config_id,\r\n    arguments: formState,\r\n    output: outputData.value\r\n  })\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams),\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"./components/node-options\";\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.voice-clone-form{\r\n\r\n}\r\n\r\n.node-options {\r\n  :deep(.mention-input-warpper) {\r\n    height: 33px;\r\n    word-break: break-all;\r\n  }\r\n}\r\n\r\n.form-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n  gap: 4px;\r\n\r\n  .form-item {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 8px;\r\n    padding: 4px 0;\r\n\r\n    .form-tit {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: start;\r\n      flex-shrink: 0;\r\n      word-break: break-all;\r\n      color: #595959;\r\n\r\n      .option-type {\r\n        margin-left: 4px;\r\n        display: inline-block;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n\r\n    .form-cont {\r\n      flex: 1;\r\n\r\n      :deep(.ant-select) {\r\n        width: 100%;\r\n      }\r\n\r\n      :deep(.ant-slider-mark) {\r\n        color: #8c8c8c;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        left: 6px;\r\n        top: -16px;\r\n      }\r\n\r\n      :deep(.ant-slider-with-marks ) {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.required::before {\r\n  content: '*';\r\n  color: #FB363F;\r\n  display: inline-block;\r\n  margin-right: 2px;\r\n}\r\n\r\n.ml16 {\r\n  margin-left: 16px;\r\n}\r\n.c262626 {\r\n  color: #262626 !important;\r\n}\r\n</style>\r\n","import request from '@/utils/http/axios'\r\n\r\nexport function getVoiceList(params={}) {\r\n  return request.get({url: '/manage/getMiniMaxVoiceList', params})\r\n}\r\n","<template>\r\n  <a-modal\r\n    v-model:open=\"visible\"\r\n    :title=\"t('title_select_voice')\"\r\n    width=\"670px\"\r\n    @ok=\"save\"\r\n  >\r\n    <a-input v-model:value.trim=\"keyword\" :placeholder=\"t('ph_search_voice')\" allow-clear style=\"width: 240px;\">\r\n      <template #suffix>\r\n        <SearchOutlined/>\r\n      </template>\r\n    </a-input>\r\n    <a-table\r\n      class=\"mt16\"\r\n      :loading=\"loading\"\r\n      :columns=\"columns\"\r\n      :data-source=\"showList\"\r\n      :pagination=\"false\"\r\n      row-key=\"voice_id\"\r\n      :row-selection=\"{ type: 'radio', selectedRowKeys, onChange }\"\r\n      :scroll=\"{y: 500}\"\r\n    >\r\n      <template #bodyCell=\"{column, record}\">\r\n        <template v-if=\"'description' === column.dataIndex\">\r\n          <a-tooltip :title=\"record.description\">\r\n            <div class=\"zm-line2\">{{record.description}}</div>\r\n          </a-tooltip>\r\n        </template>\r\n      </template>\r\n    </a-table>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, computed, toRaw} from 'vue';\r\nimport {getVoiceList} from \"@/api/node/index.js\";\r\nimport {SearchOutlined} from '@ant-design/icons-vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.components.select-voice-modal')\r\nconst emit = defineEmits(['change'])\r\nconst props = defineProps({\r\n  modelConfigId: {\r\n    type: [Number, String]\r\n  },\r\n  voiceType: {\r\n    type: String,\r\n    default: 'all'\r\n  }\r\n})\r\nconst visible = ref(false)\r\nconst loading = ref(false)\r\nconst keyword = ref('')\r\nconst list = ref([])\r\nconst selectedRowKeys = ref([])\r\nconst selectedRows = ref([])\r\n\r\nconst columns = computed(() => [\r\n  {\r\n    title: t('label_index'),\r\n    dataIndex: 'index',\r\n    key: 'index',\r\n    width: 80,\r\n  },\r\n  {\r\n    title: t('label_name'),\r\n    dataIndex: 'voice_name',\r\n    width: 120,\r\n  },\r\n  {\r\n    title: t('label_id'),\r\n    dataIndex: 'voice_id',\r\n    width: 80,\r\n  },\r\n  {\r\n    title: t('label_description'),\r\n    dataIndex: 'description',\r\n    width: 200,\r\n  },\r\n])\r\nconst showList = computed(() => {\r\n  if (keyword.value) {\r\n    return list.value.filter(item => {\r\n      return item.voice_name.indexOf(keyword.value) > -1 || item.voice_id == keyword.value\r\n    })\r\n  }\r\n  return list.value\r\n})\r\n\r\nfunction show(keys = []) {\r\n  selectedRowKeys.value = keys\r\n  loadData()\r\n  visible.value = true\r\n}\r\n\r\nfunction loadData() {\r\n  loading.value = true\r\n  getVoiceList({\r\n    model_config_id: props.modelConfigId,\r\n    voice_type: props.voiceType,\r\n  }).then(res => {\r\n    list.value = res?.data || []\r\n    list.value.forEach((item, index) => {\r\n      item.index = index + 1\r\n      item.description = item?.description?.[0] || ''\r\n    })\r\n    selectedRows.value = list.value.filter(i => selectedRowKeys.value.includes(i.voice_id))\r\n  }).finally(() => {\r\n    loading.value = false\r\n  })\r\n}\r\n\r\nfunction onChange(keys, rows) {\r\n  selectedRowKeys.value = keys\r\n  selectedRows.value = rows\r\n}\r\n\r\nfunction save() {\r\n  emit('change', toRaw(selectedRowKeys.value),toRaw(selectedRows.value))\r\n  visible.value = false\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.mt16 {\r\n  margin-top: 16px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout class=\"voice-synthesis-form\">\r\n    <NodeFormHeader\r\n      :title=\"node.node_name\"\r\n      :iconName=\"node.node_icon_name\"\r\n      :desc=\"t('desc_voice_synthesis')\"\r\n    />\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('label_input') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_voice_model') }}</div>\r\n        </div>\r\n        <ModelSelect\r\n          model-type=\"TTS\"\r\n          v-model:modeName=\"formState.use_model\"\r\n          v-model:modeId=\"formState.model_id\"\r\n          v-model:useConfigId=\"formState.model_config_id\"\r\n          @change=\"modelChange\"\r\n        />\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_text') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div>\r\n          <AtInput\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 64px;\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.text || []\"\r\n            :defaultValue=\"formState.text\"\r\n            ref=\"atInputRef\"\r\n            @open=\"getValueVariableList\"\r\n            @change=\"(text, selectedList) => changeValue('text', text, selectedList)\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n        <div class=\"desc\">{{ t('msg_text_desc') }}</div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_select_voice') }}</div>\r\n        </div>\r\n        <div class=\"flex-between\">\r\n          <ZmRadioGroup v-model:value=\"formState.voice_setting.voice_id\" :options=\"voiceOptions\" @change=\"update\"/>\r\n          <a-tooltip placement=\"left\" :title=\"t('label_advanced_settings')\">\r\n            <span class=\"setting-icon\" @click=\"settingsShowChange\"><SettingOutlined/></span>\r\n          </a-tooltip>\r\n        </div>\r\n      </div>\r\n      <div class=\"options-item is-required\">\r\n        <div class=\"options-item-tit\">\r\n          <div class=\"option-label\">{{ t('label_voice_settings') }}</div>\r\n          <div class=\"option-type\">string</div>\r\n        </div>\r\n        <div class=\"flex-between\">\r\n          <a-select v-model:value=\"formState.voice_set_type\" @change=\"voiceSetTypeChange\">\r\n            <a-select-option :value=\"1\">{{ t('label_select_voice_type') }}</a-select-option>\r\n            <a-select-option :value=\"2\">{{ t('label_set_voice') }}</a-select-option>\r\n          </a-select>\r\n          <a-select\r\n            v-if=\"formState.voice_set_type == 1\"\r\n            v-model:value=\"formState.voice_setting.voice_id\"\r\n            :open=\"false\"\r\n            @dropdownVisibleChange=\"showVoiceModal\"\r\n            style=\"width: 100%;\"\r\n          >\r\n            <a-select-option value=\"-1\">{{ t('ph_select') }}</a-select-option>\r\n            <a-select-option v-for=\"item in showVoiceOpts\" :value=\"item.value\" :key=\"item.item\">\r\n              {{ item.label }}\r\n            </a-select-option>\r\n          </a-select>\r\n          <AtInput\r\n            v-else\r\n            type=\"textarea\"\r\n            inputStyle=\"height: 33px\"\r\n            :options=\"variableOptions\"\r\n            :defaultSelectedList=\"formState.tag_map?.voice_setting_voice_id || []\"\r\n            :defaultValue=\"formState.voice_setting.voice_id\"\r\n            ref=\"atInputRef\"\r\n            :placeholder=\"t('ph_input_content')\"\r\n            @open=\"getValueVariableList\"\r\n            @change=\"changeVoiceId\"\r\n          >\r\n            <template #option=\"{ label, payload }\">\r\n              <div class=\"field-list-item\">\r\n                <div class=\"field-label\">{{ label }}</div>\r\n                <div class=\"field-type\">{{ payload.typ }}</div>\r\n              </div>\r\n            </template>\r\n          </AtInput>\r\n        </div>\r\n      </div>\r\n\r\n      <template v-if=\"settingsOpen\">\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_voice_settings_label') }}</div>\r\n          </div>\r\n          <div class=\"form-box\">\r\n            <div v-for=\"field in ['speed', 'vol', 'pitch']\" :key=\"field\" class=\"form-item\">\r\n              <div :class=\"['form-tit', {required: voiceSettingSliderConfig[field]}.required]\">\r\n                <a-tooltip :title=\"voiceSettingSliderConfig[field].tooltip\">\r\n                  {{ voiceSettingSliderConfig[field].label }}\r\n                  <QuestionCircleOutlined/>\r\n                  <span class=\"option-type\">{{ voiceSettingSliderConfig[field].type }}</span>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-row>\r\n                  <a-col :span=\"15\">\r\n                    <a-slider\r\n                      v-model:value=\"formState.voice_setting[field]\"\r\n                      :step=\"voiceSettingSliderConfig[field].step\"\r\n                      :min=\"voiceSettingSliderConfig[field].min\"\r\n                      :max=\"voiceSettingSliderConfig[field].max\"\r\n                      :marks=\"voiceSettingSliderConfig[field].marks\"\r\n                    />\r\n                  </a-col>\r\n                  <a-col :span=\"7\">\r\n                    <a-input-number\r\n                      v-model:value=\"formState.voice_setting[field]\"\r\n                      :placeholder=\"t('ph_select')\"\r\n                      :min=\"voiceSettingSliderConfig[field].min\"\r\n                      :max=\"voiceSettingSliderConfig[field].max\"\r\n                      class=\"ml16\"\r\n                    />\r\n                  </a-col>\r\n                </a-row>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit required\">\r\n                <a-tooltip :title=\"t('tip_emotion')\">\r\n                  {{ t('label_emotion') }}\r\n                  <QuestionCircleOutlined/>\r\n                  <span class=\"option-type\">string</span>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.voice_setting.emotion\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"(txt, key) in emotionMap\" :key=\"key\">{{ txt }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item \">\r\n              <div class=\"form-tit required\">\r\n                <a-tooltip :title=\"t('tip_text_normalization')\">\r\n                  {{ t('label_text_normalization') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ZmRadioGroup v-model:value=\"formState.voice_setting.text_normalization\" :options=\"defaultRadioOpt\" @change=\"update\"/>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_audio_settings') }}</div>\r\n          </div>\r\n          <div class=\"form-box\">\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_sample_rate')\">\r\n                  {{ t('label_sample_rate') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n                <span class=\"option-type\">Number</span>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.audio_setting.sample_rate\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"item in audioSampleRates\" :key=\"item\">{{ item }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_bitrate')\">\r\n                  {{ t('label_bitrate') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n                <span class=\"option-type\">Number</span>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.audio_setting.bitrate\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"item in audioBitrate\" :key=\"item\">{{ item }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_format')\">\r\n                  {{ t('label_format') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n                <span class=\"option-type\">string</span>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.audio_setting.format\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"item in audioFormats\" :key=\"item\">{{ item }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_channel')\">\r\n                  {{ t('label_channel') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n                <span class=\"option-type\">Number</span>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.audio_setting.channel\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"item in audioChannels\" :key=\"item.value\" :value=\"item.value\">\r\n                    {{ item.label }}\r\n                  </a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_voice_effect_settings') }}</div>\r\n          </div>\r\n          <div class=\"form-box\">\r\n            <div v-for=\"field in ['pitch', 'intensity', 'timbre']\" :key=\"field\" class=\"form-item\">\r\n              <div :class=\"['form-tit', {required: voiceModifySliderConfig[field]}.required]\">\r\n                <a-tooltip :title=\"voiceModifySliderConfig[field].tooltip\">\r\n                  {{voiceModifySliderConfig[field].label}}\r\n                  <QuestionCircleOutlined/>\r\n                  <span class=\"option-type\">{{ voiceModifySliderConfig[field].type }}</span>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-row>\r\n                  <a-col :span=\"15\">\r\n                    <a-slider\r\n                      v-model:value=\"formState.voice_modify[field]\"\r\n                      :step=\"voiceModifySliderConfig[field].step\"\r\n                      :min=\"voiceModifySliderConfig[field].min\"\r\n                      :max=\"voiceModifySliderConfig[field].max\"\r\n                      :marks=\"voiceModifySliderConfig[field].marks\"\r\n                    />\r\n                  </a-col>\r\n                  <a-col :span=\"7\">\r\n                    <a-input-number\r\n                      v-model:value=\"formState.voice_modify[field]\"\r\n                      :placeholder=\"t('ph_select')\"\r\n                      :min=\"voiceModifySliderConfig[field].min\"\r\n                      :max=\"voiceModifySliderConfig[field].max\"\r\n                      class=\"ml16\"\r\n                    />\r\n                  </a-col>\r\n                </a-row>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_sound_effect')\">\r\n                  {{ t('label_sound_effect') }}\r\n                  <QuestionCircleOutlined/>\r\n                  <span class=\"option-type\">string</span>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.voice_modify.sound_effects\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option value=\"\">{{ t('opt_none') }}</a-select-option>\r\n                  <a-select-option v-for=\"(txt, key) in effectMap\" :key=\"key\" :value=\"key\">{{ txt }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <div class=\"options-item-tit\">\r\n            <div class=\"option-label\">{{ t('label_other_settings') }}</div>\r\n          </div>\r\n          <div class=\"form-box\">\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_small_language_recognition')\">\r\n                  {{ t('label_small_language_recognition') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.language_boost\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"(txt, key) in languageMap\" :key=\"key\" :value=\"key\">{{ txt }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_output_format')\">\r\n                  {{ t('label_output_format') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <a-select v-model:value=\"formState.output_format\" :placeholder=\"t('ph_select')\" @change=\"update\">\r\n                  <a-select-option v-for=\"(txt, key) in formatMap\" :key=\"key\" :value=\"key\">{{ txt }}</a-select-option>\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_constant_bitrate_control')\">\r\n                  {{ t('label_constant_bitrate_control') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ZmRadioGroup v-model:value=\"formState.audio_setting.force_cbr\" :options=\"defaultRadioOpt\" @change=\"update\"/>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_subtitle_service')\">\r\n                  {{ t('label_subtitle_service') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ZmRadioGroup v-model:value=\"formState.subtitle_enable\" :options=\"defaultRadioOpt\" @change=\"update\"/>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <div class=\"form-tit\">\r\n                <a-tooltip :title=\"t('tip_add_audio_rhythm_mark')\">\r\n                  {{ t('label_add_audio_rhythm_mark') }}\r\n                  <QuestionCircleOutlined/>\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"form-cont\">\r\n                <ZmRadioGroup v-model:value=\"formState.aigc_watermark\" :options=\"defaultRadioOpt\" @change=\"update\"/>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n    <div class=\"node-options\">\r\n      <div class=\"options-title\">\r\n        <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('label_output') }}</div>\r\n      </div>\r\n      <div class=\"options-item\">\r\n        <OutputFields :tree-data=\"outputData\"/>\r\n      </div>\r\n    </div>\r\n\r\n    <SelectVoiceModal ref=\"voiceModalRef\" :modelConfigId=\"formState.model_config_id\" @change=\"voiceChange\"/>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, onMounted, reactive, inject, computed} from 'vue';\r\nimport NodeFormLayout from \"@/views/workflow/components/node-form-drawer/node-form-layout.vue\";\r\nimport ModelSelect from \"@/components/model-select/model-select.vue\";\r\nimport NodeFormHeader from \"@/views/workflow/components/node-form-drawer/node-form-header.vue\";\r\nimport AtInput from \"@/views/workflow/components/at-input/at-input.vue\";\r\nimport ZmRadioGroup from \"@/components/common/zm-radio-group.vue\";\r\nimport SelectVoiceModal from \"@/views/workflow/components/node-form-drawer/components/select-voice-modal.vue\";\r\nimport {QuestionCircleOutlined, SettingOutlined} from '@ant-design/icons-vue';\r\nimport {message} from 'ant-design-vue';\r\nimport {\r\n  audioBitrate,\r\n  audioChannels,\r\n  audioFormats,\r\n  audioSampleRates,\r\n  defaultRadioOpt,\r\n  emotionMap,\r\n  languageMap,\r\n  formatMap,\r\n  effectMap,\r\n  voiceModifySliderConfig,\r\n  voiceSettingSliderConfig,\r\n  defaultVoiceOpts,\r\n  voiceOutputObj,\r\n} from \"@/constants/voice.js\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport {pluginOutputToTree} from \"@/constants/plugin.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n';\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.voice-synthesis-form');\r\n\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\nconst setData = inject('setData')\r\nconst voiceModalRef = ref(null)\r\nconst variableOptions = ref([])\r\nconst outputData = ref([])\r\nconst voiceSelectOpts = ref([])\r\nconst formState = reactive({\r\n  model_id: 0,\r\n  use_model: '',\r\n  model_config_id: 0,\r\n  text: '',\r\n  voice_set_type: 1,\r\n  voice_setting: {\r\n    voice_id: 'male-qn-jingying',\r\n    voice_name: '',\r\n    speed: 1,\r\n    vol: 1,\r\n    pitch: 0,\r\n    emotion: 'happy',\r\n    text_normalization: false,\r\n  },\r\n  audio_setting: {\r\n    sample_rate: 32000,\r\n    bitrate: 128000,\r\n    format: 'mp3',\r\n    channel: 1,\r\n    force_cbr: false,\r\n  },\r\n  voice_modify: {\r\n    pitch: 0,\r\n    intensity: 0,\r\n    timbre: 0,\r\n    sound_effects: ''\r\n  },\r\n  language_boost: 'auto',\r\n  output_format: 'url',\r\n  subtitle_enable: false,\r\n  aigc_watermark: false,\r\n  tag_map: {}\r\n})\r\nconst settingsOpen = ref(false)\r\n\r\nconst voiceOptions = computed(() => {\r\n  const voiceId = formState.voice_setting.voice_id\r\n  const inDefault = defaultVoiceOpts.some(i => i.value == voiceId)\r\n  const customValue = inDefault ? '-1' : voiceSelectOpts.value?.[0]?.voice_id ?? voiceId\r\n  return [\r\n    ...defaultVoiceOpts,\r\n    { label: t('opt_custom'), value: customValue }\r\n  ]\r\n})\r\n\r\nconst showVoiceOpts = computed(() => {\r\n  return [\r\n    ...defaultVoiceOpts,\r\n    ...voiceSelectOpts.value.map(i => ({label: i.voice_name, value: i.voice_id}))\r\n  ]\r\n})\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n\r\nfunction init() {\r\n  getValueVariableList();\r\n  outputData.value = pluginOutputToTree(voiceOutputObj)\r\n  nodeParamsAssign()\r\n}\r\n\r\nfunction nodeParamsAssign() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  let arg = nodeParams?.text_to_audio?.arguments || {}\r\n  arg.tag_map = arg.tag_map ? arg.tag_map : {}\r\n  Object.assign(formState, arg)\r\n  if (formState.voice_setting?.voice_id && defaultVoiceOpts.findIndex(i => i.value == formState.voice_setting?.voice_id) < 0) {\r\n    const {voice_id, voice_name} = formState.voice_setting\r\n    voiceSelectOpts.value = [{voice_id, voice_name}]\r\n  }\r\n}\r\n\r\nfunction getValueVariableList() {\r\n  variableOptions.value = getNode().getAllParentVariable()\r\n}\r\n\r\nfunction changeValue(field, text, selectedList) {\r\n  formState[field] = text\r\n  formState.tag_map[field] = selectedList\r\n  update()\r\n}\r\n\r\nfunction changeVoiceId(text, selectedList) {\r\n  formState.voice_setting.voice_id = text\r\n  formState.tag_map.voice_setting_voice_id = selectedList\r\n  update()\r\n}\r\n\r\nfunction showVoiceModal() {\r\n  if (!formState.model_config_id) {\r\n    return message.warning(t('msg_select_voice_model_first'))\r\n  }\r\n  voiceModalRef.value.show([formState.voice_setting.voice_id])\r\n}\r\n\r\nfunction modelChange() {\r\n  formState.voice_setting.voice_id = 'male-qn-jingying'\r\n  update()\r\n}\r\n\r\nfunction voiceSetTypeChange() {\r\n  update()\r\n}\r\n\r\nfunction voiceChange(keys, rows) {\r\n  formState.voice_setting.voice_id = keys[0]\r\n  formState.voice_setting.voice_name = rows[0].voice_name\r\n  voiceSelectOpts.value = rows\r\n  update()\r\n}\r\n\r\nfunction settingsShowChange() {\r\n  settingsOpen.value = !settingsOpen.value\r\n}\r\n\r\nfunction update() {\r\n  let nodeParams = JSON.parse(props.node.node_params)\r\n  formState.model_id = Number(formState.model_id || 0)\r\n  Object.assign(nodeParams.text_to_audio, {\r\n    voice_type: 'all',\r\n    model_config_id: formState.model_config_id,\r\n    arguments: formState,\r\n    output: outputData.value\r\n  })\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams),\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"./components/node-options\";\r\n\r\n.flex-between {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n\r\n  :deep(.mention-input-warpper) {\r\n    height: 33px;\r\n    word-break: break-all;\r\n  }\r\n}\r\n.voice-synthesis-form{\r\n  .options-item{\r\n    margin-top: 24px !important;\r\n  }\r\n  .options-item-tit{\r\n    margin-bottom: 4px;\r\n  }\r\n}\r\n\r\n.setting-icon {\r\n  color: #2475FC;\r\n  padding: 4px 8px;\r\n  border-radius: 24px;\r\n  border: 1px solid #D9D9D9;\r\n  background: #E5EFFF;\r\n  cursor: pointer;\r\n}\r\n\r\n.form-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n  gap: 8px;\r\n\r\n  .form-item {\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 4px 0;\r\n\r\n    .form-tit {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: start;\r\n      flex-shrink: 0;\r\n      margin-bottom: 8px;\r\n      word-break: break-all;\r\n      color: #595959;\r\n\r\n      .option-type {\r\n        margin-left: 4px;\r\n        display: inline-block;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n\r\n    .form-cont {\r\n      flex: 1;\r\n\r\n      :deep(.ant-select) {\r\n        width: 100%;\r\n      }\r\n\r\n      :deep(.ant-slider-mark) {\r\n        color: #8c8c8c;\r\n        font-size: 12px;\r\n        font-weight: 400;\r\n        left: 6px;\r\n        top: -16px;\r\n      }\r\n\r\n      :deep(.ant-slider-with-marks ) {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.required::before {\r\n  content: '*';\r\n  color: #FB363F;\r\n  display: inline-block;\r\n  margin-right: 2px;\r\n}\r\n\r\n.ml16 {\r\n  margin-left: 16px;\r\n}\r\n</style>\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cpath%20d='M6.09452%2014.4098C4.97749%2014.0772%203.98319%2013.4598%203.19588%2012.6417C3.48959%2012.2936%203.66659%2011.8438%203.66659%2011.3527C3.66659%2010.2482%202.77116%209.35274%201.66659%209.35274C1.59977%209.35274%201.53372%209.35604%201.46858%209.36244C1.37985%208.9286%201.33325%208.47947%201.33325%208.0194C1.33325%207.32254%201.44018%206.65064%201.63852%206.0192C1.64786%206.01934%201.65721%206.0194%201.66659%206.0194C2.77116%206.0194%203.66659%205.12397%203.66659%204.0194C3.66659%203.7023%203.59279%203.40247%203.46145%203.13607C4.23242%202.4192%205.17342%201.88271%206.21729%201.59375C6.54805%202.2421%207.22215%202.68608%207.99992%202.68608C8.77769%202.68608%209.45179%202.2421%209.78255%201.59375C10.8264%201.88271%2011.7674%202.4192%2012.5384%203.13607C12.4071%203.40247%2012.3333%203.7023%2012.3333%204.0194C12.3333%205.12397%2013.2287%206.0194%2014.3333%206.0194C14.3426%206.0194%2014.352%206.01934%2014.3613%206.0192C14.5597%206.65064%2014.6666%207.32254%2014.6666%208.0194C14.6666%208.47947%2014.62%208.9286%2014.5313%209.36244C14.4661%209.35604%2014.4001%209.35274%2014.3333%209.35274C13.2287%209.35274%2012.3333%2010.2482%2012.3333%2011.3527C12.3333%2011.8438%2012.5103%2012.2936%2012.804%2012.6417C12.0167%2013.4598%2011.0224%2014.0772%209.90532%2014.4098C9.64752%2013.6034%208.89192%2013.0194%207.99992%2013.0194C7.10792%2013.0194%206.35232%2013.6034%206.09452%2014.4098Z'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linejoin='round'/%3e%3cpath%20d='M7.99984%2010.3542C9.2885%2010.3542%2010.3332%209.3095%2010.3332%208.02083C10.3332%206.73217%209.2885%205.6875%207.99984%205.6875C6.71117%205.6875%205.6665%206.73217%205.6665%208.02083C5.6665%209.3095%206.71117%2010.3542%207.99984%2010.3542Z'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","export default \"data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1.7002%208L11%208'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%202C11%202%2014.3333%203.33333%2014.3333%208C14.3333%2012.6667%2011%2014%209%2014'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M10.9666%208L1.66672%208'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%2012L11%208L7%204'%20stroke='%23262626'%20stroke-width='1.3'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_generate_image')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <img src=\"@/assets/svg/system-setting.svg\" alt=\"\" />{{ t('label_model_settings') }}\r\n            </div>\r\n            <div class=\"model-setting-form\">\r\n              <div class=\"model-label\">{{ t('label_model') }}</div>\r\n              <div class=\"model-content\">\r\n                <ModelSelect\r\n                  modelType=\"IMAGE\"\r\n                  v-model:modeName=\"formState.use_model\"\r\n                  v-model:modeId=\"formState.model_config_id\"\r\n                  @change=\"handleChangeModel\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"model-setting-form\">\r\n              <div class=\"model-label\">{{ t('label_ratio') }}</div>\r\n              <div class=\"model-content\">\r\n                <a-select :placeholder=\"t('ph_select')\" v-model:value=\"formState.size\" style=\"width: 100%\">\r\n                  <a-select-option\r\n                    v-for=\"item in sizeOptions\"\r\n                    :value=\"item.value\"\r\n                    :key=\"item.value\"\r\n                    >{{ item.label }}</a-select-option\r\n                  >\r\n                </a-select>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"model-setting-form\">\r\n              <div class=\"model-label\">\r\n                {{ t('label_max_count') }}\r\n                <a-tooltip>\r\n                  <template #title>{{ t('tip_max_count') }}</template>\r\n                  <QuestionCircleOutlined />\r\n                </a-tooltip>\r\n              </div>\r\n              <div class=\"model-content\">\r\n                <a-input-number\r\n                  :placeholder=\"t('ph_select')\"\r\n                  style=\"width: 100%\"\r\n                  v-model:value=\"formState.image_num\"\r\n                  :min=\"1\"\r\n                  :max=\"image_max\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"model-setting-form\" v-if=\"show_image_watermark\">\r\n              <div class=\"model-label\">{{ t('label_watermark') }}</div>\r\n              <div class=\"model-content\">\r\n                <a-segmented\r\n                  class=\"customer-segmented\"\r\n                  v-model:value=\"formState.image_watermark\"\r\n                  :options=\"options1\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"model-setting-form\" v-if=\"show_image_optimize_prompt\">\r\n              <div class=\"model-label\">{{ t('label_optimize_prompt') }}</div>\r\n              <div class=\"model-content\">\r\n                <a-segmented\r\n                  class=\"customer-segmented\"\r\n                  v-model:value=\"formState.image_optimize_prompt\"\r\n                  :options=\"options2\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"gray-block mt16\"\r\n            v-if=\"currentModelConfig.input_image == 1 || currentModelConfig.input_text == 1\"\r\n          >\r\n            <div class=\"gray-block-title\"><img src=\"@/assets/svg/input.svg\" alt=\"\" />{{ t('label_input') }}</div>\r\n            <a-form-item name=\"use_model\" v-if=\"currentModelConfig.input_text == 1\">\r\n              <template #label>\r\n                <div style=\"width: 409px\" class=\"flex-between-box\">\r\n                  <div>{{ t('label_prompt') }}</div>\r\n                  <div class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal\">\r\n                    <FullscreenOutlined />\r\n                  </div>\r\n                </div>\r\n              </template>\r\n              <at-input\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.prompt_tags\"\r\n                :defaultValue=\"formState.prompt\"\r\n                ref=\"promptInputRef\"\r\n                :placeholder=\"t('ph_input_message')\"\r\n                input-style=\"height: 76px\"\r\n                type=\"textarea\"\r\n                @open=\"showAtList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n              />\r\n            </a-form-item>\r\n            <a-form-item\r\n              :label=\"t('label_reference_image')\"\r\n              name=\"use_model\"\r\n              v-if=\"currentModelConfig.input_image == 1\"\r\n            >\r\n              <a-form-item-rest>\r\n                <div class=\"array-form-box\">\r\n                  <div\r\n                    class=\"form-item-list\"\r\n                    v-for=\"(item, index) in formState.input_images\"\r\n                    :key=\"item.key\"\r\n                  >\r\n                    <div class=\"flex-block-item\">\r\n                      <at-input\r\n                        inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                        :ref=\"(el) => setAtInputRef(el, 'input_images', index)\"\r\n                        :options=\"variableOptions\"\r\n                        :defaultSelectedList=\"item.tags\"\r\n                        :defaultValue=\"item.value\"\r\n                        @open=\"getVlaueVariableList\"\r\n                        @change=\"\r\n                          (text, selectedList) => changeImgListValue(text, selectedList, item)\r\n                        \"\r\n                        :placeholder=\"t('ph_input_value')\"\r\n                      >\r\n                        <template #option=\"{ label, payload }\">\r\n                          <div class=\"field-list-item\">\r\n                            <div class=\"field-label\">{{ label }}</div>\r\n                            <div class=\"field-type\">{{ payload.typ }}</div>\r\n                          </div>\r\n                        </template>\r\n                      </at-input>\r\n\r\n                      <div class=\"btn-hover-wrap\" @click=\"onDelcategory(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <a-button @click=\"handleAddcategory\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                    >{{ t('btn_add_reference_image') }}</a-button\r\n                  >\r\n                </div>\r\n              </a-form-item-rest>\r\n            </a-form-item>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\"><img src=\"@/assets/svg/output.svg\" alt=\"\" />{{ t('label_output') }}</div>\r\n            <div class=\"output-item\">\r\n              <div class=\"key-label\">msg</div>\r\n              <div class=\"key-value\">string</div>\r\n            </div>\r\n            <div class=\"output-item\" v-for=\"item in outputImggeList\" :key=\"item\">\r\n              <div class=\"key-label\">{{ item }}</div>\r\n              <div class=\"key-value\">string</div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n    <FullAtInput\r\n      :options=\"valueOptions\"\r\n      :defaultSelectedList=\"formState.prompt_tags\"\r\n      :defaultValue=\"formState.prompt\"\r\n      :placeholder=\"t('ph_input_message')\"\r\n      input-style=\"height: 76px\"\r\n      type=\"textarea\"\r\n      @open=\"showAtList\"\r\n      @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n      @ok=\"handleRefreshAtInput\"\r\n      ref=\"fullAtInputRef\"\r\n    />\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { getUuid } from '@/utils/index'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, computed, onMounted, h, inject } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  QuestionCircleOutlined,\r\n  PlusOutlined,\r\n  FullscreenOutlined\r\n} from '@ant-design/icons-vue'\r\nimport ModelSelect from '@/components/model-select/model-select.vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport { getCurrentModelConfig } from '@/components/model-select/index.js'\r\nimport { getSizeOptions } from '@/views/workflow/components/util.js'\r\nimport { message } from 'ant-design-vue'\r\nimport FullAtInput from '../../at-input/full-at-input.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.image-generation-node-form.index')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst options1 = computed(() => [\r\n  {\r\n    label: t('label_show'),\r\n    value: '1'\r\n  },\r\n  {\r\n    label: t('label_hide'),\r\n    value: '0'\r\n  }\r\n])\r\n\r\nconst options2 = computed(() => [\r\n  {\r\n    label: t('label_enable'),\r\n    value: '1'\r\n  },\r\n  {\r\n    label: t('label_disable'),\r\n    value: '0'\r\n  }\r\n])\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst formState = reactive({\r\n  model_config_id: void 0,\r\n  use_model: void 0,\r\n  size: void 0,\r\n  image_num: '1',\r\n\r\n  prompt: '',\r\n  prompt_tags: [],\r\n  input_images: [\r\n    {\r\n      value: '',\r\n      key: getUuid(16)\r\n    }\r\n  ],\r\n  image_watermark: '1',\r\n  image_optimize_prompt: '1'\r\n})\r\n\r\nconst promptInputRef = ref(null)\r\nconst fullAtInputRef = ref(null)\r\n\r\nconst handleRefreshAtInput = () => {\r\n  promptInputRef.value.refresh()\r\n}\r\n\r\nconst handleOpenFullAtModal = () => {\r\n  fullAtInputRef.value.show()\r\n}\r\n\r\nconst outputImggeList = computed(() => {\r\n  let list = []\r\n  if (formState.image_num > 0) {\r\n    for (let i = 0; i < +formState.image_num; i++) {\r\n      let letter = String.fromCharCode('a'.charCodeAt(0) + i)\r\n      list.push(`picture_url_${letter}`)\r\n    }\r\n  }\r\n  return list\r\n})\r\n\r\nconst handleChangeModel = () => {\r\n  formState.size = void 0\r\n  formState.image_num = '1'\r\n  formState.input_images = [\r\n    {\r\n      value: '',\r\n      key: getUuid(16)\r\n    }\r\n  ]\r\n}\r\n\r\nconst currentModelConfig = computed(() => {\r\n  return getCurrentModelConfig(formState.model_config_id, formState.use_model, 'IMAGE') || {}\r\n})\r\n\r\nconst image_generation_config = computed(() => {\r\n  if (currentModelConfig.value.image_generation) {\r\n    return JSON.parse(currentModelConfig.value.image_generation)\r\n  }\r\n  return {}\r\n})\r\n\r\nconst allSizeOptions = getSizeOptions()\r\nconst sizeOptions = computed(() => {\r\n  if (image_generation_config.value.image_sizes) {\r\n    return image_generation_config.value.image_sizes\r\n      .split(',')\r\n      .map((item) => allSizeOptions.find((it) => it.value == item))\r\n  }\r\n  return []\r\n})\r\n\r\nconst image_max = computed(() => {\r\n  return +image_generation_config.value.image_max || 1\r\n})\r\n\r\nconst show_image_optimize_prompt = computed(() => {\r\n  return image_generation_config.value.image_optimize_prompt == '1'\r\n})\r\n\r\nconst show_image_watermark = computed(() => {\r\n  return image_generation_config.value.image_watermark == '1'\r\n})\r\n\r\nconst image_inputs_image_max = computed(() => {\r\n  return +image_generation_config.value.image_inputs_image_max || 1\r\n})\r\n\r\nconst update = () => {\r\n  let output = [\r\n    {\r\n      key: 'msg',\r\n      typ: 'string'\r\n    }\r\n  ]\r\n  outputImggeList.value.forEach((item) => {\r\n    output.push({\r\n      key: item,\r\n      typ: 'string'\r\n    })\r\n  })\r\n  const data = JSON.stringify({\r\n    image_generation: {\r\n      ...formState,\r\n      image_num: formState.image_num > 0 ? formState.image_num + '' : '1',\r\n      input_images: formState.input_images.map((item) => item.value).filter(Boolean),\r\n      output\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let image_generation = JSON.parse(dataRaw).image_generation || {}\r\n    getValueOptions()\r\n    getVlaueVariableList()\r\n    image_generation = JSON.parse(JSON.stringify(image_generation))\r\n    formState.model_config_id = image_generation.model_config_id\r\n    formState.use_model = image_generation.use_model\r\n    formState.size = image_generation.size\r\n    formState.image_num = image_generation.image_num\r\n    formState.prompt = image_generation.prompt\r\n    formState.prompt_tags = image_generation.prompt_tags\r\n    formState.input_images = image_generation.input_images.map((item) => {\r\n      return {\r\n        value: item,\r\n        key: getUuid(16)\r\n      }\r\n    })\r\n    formState.image_watermark = image_generation.image_watermark\r\n    formState.image_optimize_prompt = image_generation.image_optimize_prompt\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst valueOptions = ref([])\r\nconst showAtList = (val) => {\r\n  if (val) {\r\n    getValueOptions()\r\n  }\r\n}\r\n\r\nconst getValueOptions = () => {\r\n  let options = getNode().getAllParentVariable()\r\n  valueOptions.value = options || []\r\n}\r\n\r\nconst changeValue = (text, selectedList) => {\r\n  formState.prompt_tags = selectedList\r\n  formState.prompt = text\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n    list.forEach((item) => {\r\n      item.tags = item.tags || []\r\n    })\r\n\r\n    variableOptions.value = list\r\n  }\r\n}\r\n\r\nconst atInputRefs = reactive({})\r\nconst setAtInputRef = (el, name, index) => {\r\n  if (el) {\r\n    let key = `at_input_${name}_${index}`\r\n    atInputRefs[key] = el\r\n  }\r\n}\r\n\r\nconst changeImgListValue = (text, selectedList, item) => {\r\n  item.tags = selectedList\r\n  item.value = text\r\n}\r\n\r\nconst handleAddcategory = () => {\r\n  if (formState.input_images.length >= image_inputs_image_max.value) {\r\n    return message.error(t('msg_max_images_limit', { val: image_inputs_image_max.value }))\r\n  }\r\n  formState.input_images.push({\r\n    value: '',\r\n    key: getUuid(16)\r\n  })\r\n}\r\nconst onDelcategory = (index) => {\r\n  formState.input_images.splice(index, 1)\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.flex-between-box {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n.btn-hover-wrap {\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in;\r\n  &:hover {\r\n    background: #e4e6eb;\r\n  }\r\n}\r\n.model-setting-form {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 12px;\r\n  .model-label {\r\n    width: 114px;\r\n    text-align: left;\r\n    color: #262626;\r\n  }\r\n  .model-content {\r\n    flex: 1;\r\n  }\r\n}\r\n.form-item-list {\r\n  margin-bottom: 8px;\r\n}\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n\r\n.output-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin-bottom: 12px;\r\n  .key-label {\r\n    color: #262626;\r\n    font-size: 14px;\r\n  }\r\n  .key-value {\r\n    padding: 1px 8px;\r\n    display: flex;\r\n    align-items: center;\r\n    border: 1px solid #00000026;\r\n    background: var(--10, #fff);\r\n    border-radius: 6px;\r\n    font-size: 12px;\r\n    color: #595959;\r\n  }\r\n}\r\n</style>","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        desc=\"\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\"></div>\r\n            <div class=\"model-setting-form\">\r\n              <a-textarea\r\n                style=\"min-height: 300px\"\r\n                v-model:value.trim=\"formState.content\"\r\n                auto-size\r\n                :placeholder=\"t('ph_input_comment')\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { reactive, watch, onMounted, h } from 'vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.explain-node-form.index')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst formState = reactive({\r\n  content: ''\r\n})\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    ...formState\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let data = JSON.parse(dataRaw)\r\n    formState.content = data.content\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.model-setting-form {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 12px;\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <a-modal\r\n      v-model:open=\"open\"\r\n      :title=\"modalTitle\"\r\n      @ok=\"handleOk\"\r\n      :width=\"472\"\r\n      :ok-text=\"t('btn_confirm')\"\r\n      :cancel-text=\"t('btn_cancel')\"\r\n    >\r\n      <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\" style=\"margin: 24px 0\">\r\n        <a-form-item\r\n          :label=\"t('label_param_key')\"\r\n          name=\"key\"\r\n          :rules=\"[\r\n            {\r\n              required: true,\r\n              validator: (rule, value) => checkKey(rule, value)\r\n            }\r\n          ]\"\r\n        >\r\n          <a-input\r\n            v-model:value=\"formState.key\"\r\n            :maxlength=\"20\"\r\n            placeholder=\"英文字母和下划线“_”组成，最多20字符\"\r\n          />\r\n        </a-form-item>\r\n        <a-form-item\r\n          :label=\"t('label_param_type')\"\r\n          name=\"typ\"\r\n          :rules=\"[{ required: true, message: t('msg_select_type') }]\"\r\n        >\r\n          <a-select v-model:value=\"formState.typ\" :placeholder=\"t('ph_select')\" style=\"width: 100%\">\r\n            <a-select-option v-for=\"op in typOptions\" :value=\"op.value\">{{\r\n              op.value\r\n            }}</a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { message } from 'ant-design-vue'\r\nimport { getUuid } from '@/utils/index'\r\nimport { ref, reactive, computed } from 'vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.webhook-trigger-node-form.add-key-modal')\r\n\r\nconst emit = defineEmits(['add', 'edit', 'addSub'])\r\n\r\nconst props = defineProps({\r\n  request_content_type: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  level: {\r\n    type: Number,\r\n    default: 1\r\n  }\r\n})\r\n\r\nconst typOptions = computed(() => {\r\n  if (props.request_content_type == 'multipart/form-data') {\r\n    return [\r\n      {\r\n        lable: 'string',\r\n        value: 'string'\r\n      },\r\n      {\r\n        lable: 'file',\r\n        value: 'file'\r\n      }\r\n    ]\r\n  }\r\n  if (props.request_content_type == 'application/x-www-form-urlencoded') {\r\n    return [\r\n      {\r\n        lable: 'string',\r\n        value: 'string'\r\n      }\r\n    ]\r\n  }\r\n\r\n  if (props.request_content_type == 'application/json') {\r\n    let baseList = [\r\n      {\r\n        lable: 'string',\r\n        value: 'string'\r\n      },\r\n      {\r\n        lable: 'number',\r\n        value: 'number'\r\n      },\r\n      {\r\n        lable: 'boole',\r\n        value: 'boole'\r\n      },\r\n      {\r\n        lable: 'object',\r\n        value: 'object'\r\n      },\r\n      {\r\n        lable: 'array<string>',\r\n        value: 'array<string>'\r\n      },\r\n      {\r\n        lable: 'array<number>',\r\n        value: 'array<number>'\r\n      },\r\n      {\r\n        lable: 'array\\<object>',\r\n        value: 'array\\<object>'\r\n      }\r\n    ]\r\n    if (props.level >= 2) {\r\n      return baseList.filter((i) => i.value != 'object')\r\n    } else {\r\n      return baseList\r\n    }\r\n  }\r\n\r\n  return [\r\n    {\r\n      lable: 'string',\r\n      value: 'string'\r\n    }\r\n  ]\r\n})\r\n\r\nconst open = ref(false)\r\nconst modalTitle = ref(t('title_add_param'))\r\n\r\nlet oprateType = 'add'\r\n\r\nconst checkKey = (rule, value) => {\r\n  if (!value) {\r\n    return Promise.reject(t('msg_enter_key'))\r\n  }\r\n  // 校验是否只包含英文字母和下划线\r\n  const regex = /^[a-zA-Z_]+$/\r\n  if (!regex.test(value)) {\r\n    return Promise.reject(t('msg_only_letters_underscore'))\r\n  }\r\n  return Promise.resolve()\r\n}\r\nlet INDEX = 0\r\nconst formState = reactive({\r\n  key: '',\r\n  typ: 'string',\r\n  cu_key: '',\r\n  desc: void 0,\r\n  subs: []\r\n})\r\nconst show = () => {\r\n  formState.typ = 'string'\r\n  open.value = true\r\n}\r\n\r\nconst add = () => {\r\n  Object.assign(formState, {\r\n    key: '',\r\n    typ: 'string',\r\n    cu_key: getUuid(16),\r\n    subs: []\r\n  })\r\n  oprateType = 'add'\r\n  modalTitle.value = t('title_add_param')\r\n  open.value = true\r\n}\r\n\r\nconst addSub = (index) => {\r\n  INDEX = index\r\n  Object.assign(formState, {\r\n    key: '',\r\n    typ: 'string',\r\n    cu_key: getUuid(16),\r\n    subs: []\r\n  })\r\n  oprateType = 'addSub'\r\n  modalTitle.value = t('title_add_param')\r\n  open.value = true\r\n}\r\n\r\nconst edit = (data, index) => {\r\n  INDEX = index\r\n  Object.assign(formState, {\r\n    key: '',\r\n    typ: 'string',\r\n    cu_key: getUuid(16),\r\n    subs: []\r\n  })\r\n  Object.assign(formState, {\r\n    ...data\r\n  })\r\n  oprateType = 'edit'\r\n  modalTitle.value = t('title_edit_param')\r\n  open.value = true\r\n}\r\n\r\nconst formRef = ref(null)\r\nconst handleOk = () => {\r\n  formRef.value.validate().then(() => {\r\n    if (oprateType == 'add') {\r\n      emit('add', {\r\n        ...formState\r\n      })\r\n    }\r\n    if (oprateType == 'addSub') {\r\n      emit(\r\n        'addSub',\r\n        {\r\n          ...formState\r\n        },\r\n        INDEX\r\n      )\r\n    }\r\n    if (oprateType == 'edit') {\r\n      emit(\r\n        'edit',\r\n        {\r\n          ...formState\r\n        },\r\n        INDEX\r\n      )\r\n    }\r\n    open.value = false\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  show,\r\n  add,\r\n  edit,\r\n  addSub\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped></style>\r\n","<template>\r\n  <div\r\n    :class=\"['sub-field-item-box', `sub-field-item-box_${props.level}`]\"\r\n    v-for=\"(item, index) in props.data\"\r\n    :key=\"item.cu_key\"\r\n  >\r\n    <div class=\"sub-field-item\">\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <div class=\"key-title-item\">{{ item.key }}</div>\r\n      <div class=\"typ-title-item\">{{ item.typ }}</div>\r\n      <div class=\"value-title-item\">\r\n        <a-select\r\n          v-if=\"item.typ != 'object'\"\r\n          :placeholder=\"t('ph_select_variable')\"\r\n          v-model:value=\"item.desc\"\r\n          style=\"width: 90%\"\r\n        >\r\n          <a-select-option :value=\"opt.value\" v-for=\"opt in handleFilterOptions(item)\" :key=\"opt.key\">\r\n            <span>{{ opt.label }}</span>\r\n          </a-select-option>\r\n        </a-select>\r\n      </div>\r\n      <div\r\n        class=\"btn-hover-wrap\"\r\n        @click=\"handleAddOutPut(index, props.data)\"\r\n        v-if=\"showAddBtn(item)\"\r\n      >\r\n        <PlusCircleOutlined />\r\n      </div>\r\n      <div class=\"btn-hover-wrap\" @click=\"handleEditOutput(item, index)\">\r\n        <EditOutlined />\r\n      </div>\r\n\r\n      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index, props.data)\">\r\n        <CloseCircleOutlined />\r\n      </div>\r\n    </div>\r\n    <template v-if=\"item.subs && item.subs.length > 0\">\r\n      <SubsKey\r\n        :request_content_type=\"props.request_content_type\"\r\n        :level=\"props.level + 1\"\r\n        :data=\"item.subs\"\r\n        :globalOptions=\"props.globalOptions\"\r\n      />\r\n    </template>\r\n  </div>\r\n  <AddKeyModal\r\n    @add=\"onOutputAdd\"\r\n    :level=\"props.level\"\r\n    :request_content_type=\"props.request_content_type\"\r\n    @edit=\"onOutputEdit\"\r\n    ref=\"addParamsModalRef\"\r\n  />\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { computed, ref } from 'vue'\r\nimport { CloseCircleOutlined, PlusCircleOutlined, EditOutlined } from '@ant-design/icons-vue'\r\nimport AddKeyModal from './add-key-modal.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.webhook-trigger-node-form.subs-key')\r\nconst props = defineProps({\r\n  data: {},\r\n  level: {\r\n    type: Number\r\n  },\r\n  globalOptions: {\r\n    type: Array\r\n  },\r\n  request_content_type: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n})\r\nconst filterTypOptions = computed(() => {\r\n  if (props.level > 2) {\r\n    return typOptions.filter((item) => item.value != 'object')\r\n  }\r\n  return typOptions\r\n})\r\n\r\nlet currentIndex = 0\r\n\r\nconst onDelOutput = (index, data) => {\r\n  data.splice(index, 1)\r\n}\r\n\r\nconst addParamsModalRef = ref(null)\r\n\r\nconst handleAddOutPut = (index) => {\r\n  currentIndex = index\r\n  addParamsModalRef.value.add()\r\n}\r\nconst handleEditOutput = (data, index) => {\r\n  addParamsModalRef.value.edit(data, index)\r\n}\r\nconst onOutputAdd = (data) => {\r\n  props.data[currentIndex].subs.push(data)\r\n}\r\n\r\nconst onOutputEdit = (data, index) => {\r\n  if(props.data[index].typ != data.typ){\r\n    data.desc = void 0\r\n  }\r\n  props.data.splice(index, 1, data)\r\n}\r\n\r\nconst showAddBtn = (item) => {\r\n  return item.typ == 'object' && props.level <= 2\r\n}\r\n\r\nconst handleFilterOptions = (item) => {\r\n  let typ = item.typ\r\n  if (typ == 'file') {\r\n    typ = 'string'\r\n  }\r\n  if (typ) {\r\n    return props.globalOptions.filter((item) => item.typ == typ)\r\n  }\r\n  return props.globalOptions\r\n}\r\n\r\nlet typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sub-field-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 6px;\r\n  .btn-hover-wrap {\r\n    margin-right: 4px;\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    width: 24px;\r\n    height: 24px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n.sub-field-item-box_3 .key-title-item {\r\n  width: 114px;\r\n}\r\n\r\n.key-title-item {\r\n  width: 148px;\r\n}\r\n\r\n.typ-title-item {\r\n  width: 90px;\r\n}\r\n.value-title-item {\r\n  width: 160px;\r\n}\r\n.mr12 {\r\n  margin-right: 12px;\r\n}\r\n.sub-field-item-box_3 .fork-icon {\r\n  margin-left: 34px;\r\n}\r\n\r\n.fork-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        @changeTitle=\"handleTitleChange\"\r\n        @deleteNode=\"handleDeleteNode\"\r\n        :desc=\"t('desc_webhook_trigger')\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n\r\n    <div class=\"variable-node\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <a-form-item :label=\"t('label_request_url')\">\r\n              <a-input-group compact>\r\n                <a-select v-model:value=\"formState.method\" style=\"width: 20%\">\r\n                  <a-select-option value=\"POST\">POST</a-select-option>\r\n                  <a-select-option value=\"GET\">GET</a-select-option>\r\n                </a-select>\r\n                <a-input readonly v-model:value=\"formState.url\" style=\"width: 65%\" />\r\n                <a-button @click=\"handleCopyText()\" style=\"width: 15%\" type=\"primary\"\r\n                  >{{ t('btn_copy') }}</a-button\r\n                >\r\n              </a-input-group>\r\n            </a-form-item>\r\n\r\n            <a-form-item :label=\"t('label_auth')\">\r\n              <a-radio-group v-model:value=\"formState.switch_verify\">\r\n                <a-radio value=\"1\">{{ t('label_need_auth') }}</a-radio>\r\n                <a-radio value=\"0\">{{ t('label_no_auth') }}</a-radio>\r\n              </a-radio-group>\r\n            </a-form-item>\r\n\r\n            <a-form-item :label=\"t('label_ip_whitelist')\">\r\n              <a-radio-group v-model:value=\"formState.switch_allow_ip\">\r\n                <a-radio value=\"0\">{{ t('label_not_enable') }}</a-radio>\r\n                <a-radio value=\"1\">{{ t('label_enable') }}</a-radio>\r\n              </a-radio-group>\r\n              <div class=\"mt8\">\r\n                <a-textarea\r\n                  v-model:value=\"formState.allow_ips\"\r\n                  style=\"min-height: 74px\"\r\n                  :placeholder=\"t('ph_input_ip')\"\r\n                />\r\n              </div>\r\n            </a-form-item>\r\n\r\n            <div class=\"array-form-box\">\r\n              <div class=\"form-item-label\">{{ t('label_params') }}</div>\r\n              <div class=\"form-item-list\" v-for=\"(item, index) in formState.params\" :key=\"index\">\r\n                <a-form-item :label=\"null\">\r\n                  <div class=\"flex-block-item\">\r\n                    <a-form-item-rest>\r\n                      <a-input\r\n                        style=\"width: 120px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input_key')\"\r\n                      ></a-input>\r\n                    </a-form-item-rest>\r\n                    <div class=\"at-input-flex1\">\r\n                      <a-select\r\n                        style=\"width: 100%\"\r\n                        :placeholder=\"t('ph_select_variable')\"\r\n                        v-model:value=\"item.desc\"\r\n                        @dropdownVisibleChange=\"dropdownVisibleChange\"\r\n                      >\r\n                        <a-select-option\r\n                          :value=\"opt.value\"\r\n                          v-for=\"opt in strGlobalOptions\"\r\n                          :key=\"opt.key\"\r\n                        >\r\n                          <span>{{ opt.label }}</span>\r\n                        </a-select-option>\r\n                      </a-select>\r\n                    </div>\r\n\r\n                    <div class=\"btn-hover-wrap\" @click=\"onDelParams(index)\">\r\n                      <CloseCircleOutlined />\r\n                    </div>\r\n                  </div>\r\n                </a-form-item>\r\n              </div>\r\n              <a-button @click=\"handleAddParams\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                >{{ t('btn_add_param') }}</a-button\r\n              >\r\n            </div>\r\n            <template v-if=\"formState.method == 'POST'\">\r\n              <a-form-item :label=\"t('label_body')\">\r\n                <a-radio-group v-model:value=\"formState.request_content_type\">\r\n                  <a-radio value=\"none\">none</a-radio>\r\n                  <a-radio value=\"multipart/form-data\">form-data</a-radio>\r\n                  <a-radio value=\"application/x-www-form-urlencoded\">x-www-form-urlencoded</a-radio>\r\n                  <a-radio value=\"application/json\">JSON</a-radio>\r\n                </a-radio-group>\r\n              </a-form-item>\r\n              <div\r\n                class=\"array-form-box\"\r\n                v-if=\"formState.request_content_type == 'multipart/form-data'\"\r\n              >\r\n                <div class=\"array-form-box\">\r\n                  <div class=\"th-header-block\">\r\n                    <div class=\"td-title\" style=\"width: 180px\">{{ t('label_key') }}</div>\r\n                    <div class=\"td-title\" style=\"width: 90px\">{{ t('label_value_type') }}</div>\r\n                    <div class=\"td-title\" style=\"width: 160px\">{{ t('label_all_variables') }}</div>\r\n                    <div class=\"td-title\" style=\"flex: 1\">{{ t('label_operation') }}</div>\r\n                  </div>\r\n                  <div class=\"form-item-list\" v-for=\"(item, index) in formState.form\" :key=\"index\">\r\n                    <a-form-item :label=\"null\">\r\n                      <div class=\"key-block-item\">\r\n                        <div class=\"key-item\" style=\"width: 180px\">{{ item.key }}</div>\r\n                        <div class=\"key-item\" style=\"width: 90px\">{{ item.typ }}</div>\r\n                        <div class=\"key-item\" style=\"width: 160px\">\r\n                          <a-select\r\n                            :placeholder=\"t('ph_select_variable')\"\r\n                            v-model:value=\"item.desc\"\r\n                            style=\"width: 90%\"\r\n                            @dropdownVisibleChange=\"dropdownVisibleChange\"\r\n                          >\r\n                            <a-select-option\r\n                              :value=\"opt.value\"\r\n                              v-for=\"opt in handleFilterOptions(item)\"\r\n                              :key=\"opt.key\"\r\n                            >\r\n                              <span>{{ opt.label }}</span>\r\n                            </a-select-option>\r\n                          </a-select>\r\n                        </div>\r\n                        <div class=\"key-item btn-block\" style=\"flex: 1\">\r\n                          <div\r\n                            class=\"btn-hover-wrap\"\r\n                            v-if=\"item.typ == 'object'\"\r\n                            @click=\"onAddSubs(index)\"\r\n                          >\r\n                            <PlusCircleOutlined />\r\n                          </div>\r\n                          <div class=\"btn-hover-wrap\" @click=\"handleEditKey(item, index)\">\r\n                            <EditOutlined />\r\n                          </div>\r\n                          <div class=\"btn-hover-wrap\" @click=\"onDelBody(index, 'form')\">\r\n                            <CloseCircleOutlined />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                        <a-form-item-rest>\r\n                          <SubKey\r\n                            :data=\"item.subs\"\r\n                            :request_content_type=\"formState.request_content_type\"\r\n                            :level=\"2\"\r\n                            :globalOptions=\"globalOptions\"\r\n                          />\r\n                        </a-form-item-rest>\r\n                      </div>\r\n                    </a-form-item>\r\n                  </div>\r\n                </div>\r\n                <div class=\"mt8\">\r\n                  <a-button @click=\"handleAddKeyModal\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                    >{{ t('label_add_param') }}</a-button\r\n                  >\r\n                </div>\r\n              </div>\r\n              <div\r\n                class=\"array-form-box\"\r\n                v-if=\"formState.request_content_type == 'application/x-www-form-urlencoded'\"\r\n              >\r\n                <div class=\"array-form-box\">\r\n                  <div class=\"th-header-block\">\r\n                    <div class=\"td-title\" style=\"width: 180px\">{{ t('label_key') }}</div>\r\n                    <div class=\"td-title\" style=\"width: 90px\">{{ t('label_value_type') }}</div>\r\n                    <div class=\"td-title\" style=\"width: 160px\">{{ t('label_all_variables') }}</div>\r\n                    <div class=\"td-title\" style=\"flex: 1\">{{ t('label_operation') }}</div>\r\n                  </div>\r\n                  <div\r\n                    class=\"form-item-list\"\r\n                    v-for=\"(item, index) in formState.x_form\"\r\n                    :key=\"index\"\r\n                  >\r\n                    <a-form-item :label=\"null\">\r\n                      <div class=\"key-block-item\">\r\n                        <div class=\"key-item\" style=\"width: 180px\">{{ item.key }}</div>\r\n                        <div class=\"key-item\" style=\"width: 90px\">{{ item.typ }}</div>\r\n                        <div class=\"key-item\" style=\"width: 160px\">\r\n                          <a-select\r\n                            :placeholder=\"t('ph_select_variable')\"\r\n                            v-model:value=\"item.desc\"\r\n                            style=\"width: 90%\"\r\n                            @dropdownVisibleChange=\"dropdownVisibleChange\"\r\n                          >\r\n                            <a-select-option\r\n                              :value=\"opt.value\"\r\n                              v-for=\"opt in handleFilterOptions(item)\"\r\n                              :key=\"opt.key\"\r\n                            >\r\n                              <span>{{ opt.label }}</span>\r\n                            </a-select-option>\r\n                          </a-select>\r\n                        </div>\r\n                        <div class=\"key-item btn-block\" style=\"flex: 1\">\r\n                          <div class=\"btn-hover-wrap\" @click=\"handleEditKey(item, index)\">\r\n                            <EditOutlined />\r\n                          </div>\r\n                          <div class=\"btn-hover-wrap\" @click=\"onDelBody(index, 'x_form')\">\r\n                            <CloseCircleOutlined />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </a-form-item>\r\n                  </div>\r\n                </div>\r\n                <div class=\"mt8\">\r\n                  <a-button @click=\"handleAddKeyModal\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                    >{{ t('label_add_param') }}</a-button\r\n                  >\r\n                </div>\r\n              </div>\r\n              <div\r\n                class=\"array-form-box\"\r\n                v-if=\"formState.request_content_type == 'application/json'\"\r\n              >\r\n                <div class=\"array-form-box\">\r\n                  <div class=\"th-header-block\">\r\n                    <div class=\"td-title\" style=\"width: 180px\">{{ t('label_key') }}</div>\r\n                    <div class=\"td-title\" style=\"width: 90px\">{{ t('label_value_type') }}</div>\r\n                    <div class=\"td-title\" style=\"width: 160px\">{{ t('label_all_variables') }}</div>\r\n                    <div class=\"td-title\" style=\"flex: 1\">{{ t('label_operation') }}</div>\r\n                  </div>\r\n                  <div class=\"form-item-list\" v-for=\"(item, index) in formState.json\" :key=\"index\">\r\n                    <a-form-item :label=\"null\">\r\n                      <div class=\"key-block-item\">\r\n                        <div class=\"key-item\" style=\"width: 180px\">{{ item.key }}</div>\r\n                        <div class=\"key-item\" style=\"width: 90px\">{{ item.typ }}</div>\r\n                        <div class=\"key-item\" style=\"width: 160px\">\r\n                          <a-select\r\n                            v-if=\"item.typ != 'object'\"\r\n                            :placeholder=\"t('ph_select_variable')\"\r\n                            v-model:value=\"item.desc\"\r\n                            style=\"width: 90%\"\r\n                            @dropdownVisibleChange=\"dropdownVisibleChange\"\r\n                          >\r\n                            <a-select-option\r\n                              :value=\"opt.value\"\r\n                              v-for=\"opt in handleFilterOptions(item)\"\r\n                              :key=\"opt.key\"\r\n                            >\r\n                              <span>{{ opt.label }}</span>\r\n                            </a-select-option>\r\n                          </a-select>\r\n                        </div>\r\n                        <div class=\"key-item btn-block\" style=\"flex: 1\">\r\n                          <div\r\n                            class=\"btn-hover-wrap\"\r\n                            v-if=\"item.typ == 'object'\"\r\n                            @click=\"onAddSubs(index)\"\r\n                          >\r\n                            <PlusCircleOutlined />\r\n                          </div>\r\n                          <div class=\"btn-hover-wrap\" @click=\"handleEditKey(item, index)\">\r\n                            <EditOutlined />\r\n                          </div>\r\n                          <div class=\"btn-hover-wrap\" @click=\"onDelBody(index, 'json')\">\r\n                            <CloseCircleOutlined />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                        <a-form-item-rest>\r\n                          <SubKey\r\n                            :data=\"item.subs\"\r\n                            :request_content_type=\"formState.request_content_type\"\r\n                            :level=\"2\"\r\n                            :globalOptions=\"globalOptions\"\r\n                          />\r\n                        </a-form-item-rest>\r\n                      </div>\r\n                    </a-form-item>\r\n                  </div>\r\n                </div>\r\n                <div class=\"mt8\">\r\n                  <a-button @click=\"handleAddKeyModal\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                    >{{ t('label_add_param') }}</a-button\r\n                  >\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <a-form-item :label=\"t('label_response')\">\r\n              <a-radio-group v-model:value=\"formState.response_type\">\r\n                <a-radio value=\"message_variable\">{{ t('label_return_after_end') }}</a-radio>\r\n                <a-radio value=\"now\">{{ t('label_return_now') }}</a-radio>\r\n              </a-radio-group>\r\n              <div class=\"mt8\" v-if=\"formState.response_type == 'now'\">\r\n                <a-textarea\r\n                  v-model:value=\"formState.response_now\"\r\n                  style=\"min-height: 74px\"\r\n                  :placeholder=\"t('ph_input_response')\"\r\n                />\r\n              </div>\r\n            </a-form-item>\r\n          </div>\r\n        </a-form>\r\n        <AddKeyModal\r\n          :request_content_type=\"formState.request_content_type\"\r\n          @add=\"onKeyAdd\"\r\n          @edit=\"onKeyEdit\"\r\n          @addSub=\"onKeyAddSub\"\r\n          ref=\"addKeyModalRef\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { getUuid } from '@/utils/index'\r\nimport { ref, onMounted, inject, reactive, computed, watch, h } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  PlusOutlined,\r\n  PlusCircleOutlined,\r\n  EditOutlined\r\n} from '@ant-design/icons-vue'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport AddKeyModal from './add-key-modal.vue'\r\nimport SubKey from './subs-key.vue'\r\nimport { copyText } from '@/utils/index'\r\nimport { message } from 'ant-design-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.webhook-trigger-node-form.index')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst formState = reactive({\r\n  url: '',\r\n  method: 'GET',\r\n  switch_verify: '1',\r\n  switch_allow_ip: '0',\r\n  allow_ips: '',\r\n\r\n  params: [\r\n    // {\r\n    //   key: '',\r\n    //   typ: 'string',\r\n    //   desc: void 0\r\n    // }\r\n  ],\r\n  form: [\r\n    // {\r\n    //   key: '',\r\n    //   typ: 'string',\r\n    //   desc: void 0\r\n    // }\r\n  ],\r\n\r\n  x_form: [\r\n    // {\r\n    //   key: '',\r\n    //   typ: 'string',\r\n    //   desc: void 0\r\n    // }\r\n  ],\r\n\r\n  json: [\r\n    // {\r\n    //   key: '',\r\n    //   typ: 'string',\r\n    //   desc: void 0,\r\n    //   subs: []\r\n    // }\r\n  ],\r\n\r\n  request_content_type: 'none',\r\n\r\n  response_type: 'now',\r\n  response_now: ''\r\n})\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  {\r\n    deep: true\r\n  }\r\n)\r\n\r\nconst getNode = inject('getNode')\r\nconst getGraph = inject('getGraph')\r\n\r\nconst handleTitleChange = () => {\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', { ...props.node })\r\n  }, 10)\r\n}\r\n\r\nconst handleDeleteNode = () => {\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', null)\r\n  }, 10)\r\n}\r\n\r\nconst update = () => {\r\n  let node_params = JSON.parse(props.node.node_params)\r\n\r\n  node_params.trigger.trigger_web_hook_config = {\r\n    ...formState\r\n  }\r\n\r\n  let data = { ...props.node, node_params: JSON.stringify(node_params) }\r\n\r\n  emit('update-node', data)\r\n\r\n  setTimeout(() => {\r\n    getGraph().eventCenter.emit('custom:trigger-change', data)\r\n  }, 10)\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n\r\n    dataRaw = JSON.parse(dataRaw)\r\n    getOptions()\r\n    let trigger_web_hook_config = dataRaw.trigger.trigger_web_hook_config\r\n    formState.url = trigger_web_hook_config.url\r\n    formState.method = trigger_web_hook_config.method || 'GET'\r\n    formState.switch_verify = trigger_web_hook_config.switch_verify || '1'\r\n    formState.switch_allow_ip = trigger_web_hook_config.switch_allow_ip || '0'\r\n    formState.allow_ips = trigger_web_hook_config.allow_ips\r\n      ? trigger_web_hook_config.allow_ips.split(',').join('\\n')\r\n      : ''\r\n    formState.params = trigger_web_hook_config.params || []\r\n    formState.form = trigger_web_hook_config.form || []\r\n    formState.x_form = trigger_web_hook_config.x_form || []\r\n    formState.json = trigger_web_hook_config.json || []\r\n    formState.request_content_type = trigger_web_hook_config.request_content_type || 'none'\r\n    formState.response_type = trigger_web_hook_config.response_type || 'now'\r\n    formState.response_now = trigger_web_hook_config.response_now || ''\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst globalOptions = ref([])\r\n\r\nfunction getOptions() {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let globalVariable = nodeModel.getGlobalVariable()\r\n    let diy_global = globalVariable.diy_global || []\r\n    diy_global.forEach((item) => {\r\n      item.label = item.key\r\n      item.value = 'global.' + item.key\r\n    })\r\n\r\n    globalOptions.value = diy_global || []\r\n  }\r\n}\r\n\r\nconst strGlobalOptions = computed(()=>{\r\n  return globalOptions.value.filter(item => item.typ == 'string')\r\n})\r\n\r\nconst dropdownVisibleChange = (visible) => {\r\n  if (visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst handleFilterOptions = (item) => {\r\n  let typ = item.typ\r\n  if (typ == 'file') {\r\n    typ = 'string'\r\n  }\r\n  if (typ) {\r\n    return globalOptions.value.filter((item) => item.typ == typ)\r\n  }\r\n  return globalOptions.value\r\n}\r\n\r\nconst handleAddParams = () => {\r\n  formState.params.push({\r\n    key: '',\r\n    typ: 'string',\r\n    desc: void 0\r\n  })\r\n}\r\n\r\nconst onDelParams = (index) => {\r\n  formState.params.splice(index, 1)\r\n}\r\n\r\nconst onDelBody = (index, key) => {\r\n  formState[key].splice(index, 1)\r\n}\r\n\r\nconst addKeyModalRef = ref(null)\r\n\r\nconst handleAddKeyModal = () => {\r\n  addKeyModalRef.value.add()\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  addKeyModalRef.value.addSub(index)\r\n}\r\n\r\nconst handleEditKey = (data, index) => {\r\n  addKeyModalRef.value.edit(data, index)\r\n}\r\n\r\nconst onKeyAdd = (data) => {\r\n  if (formState.request_content_type == 'multipart/form-data') {\r\n    formState.form.push(data)\r\n  }\r\n  if (formState.request_content_type == 'application/x-www-form-urlencoded') {\r\n    formState.x_form.push(data)\r\n  }\r\n  if (formState.request_content_type == 'application/json') {\r\n    formState.json.push(data)\r\n  }\r\n}\r\n\r\nconst onKeyEdit = (data, index) => {\r\n  if (formState.request_content_type == 'multipart/form-data') {\r\n    formState.form.splice(index, 1, data)\r\n  }\r\n  if (formState.request_content_type == 'application/x-www-form-urlencoded') {\r\n    formState.x_form.splice(index, 1, data)\r\n  }\r\n  if (formState.request_content_type == 'application/json') {\r\n    formState.json.splice(index, 1, data)\r\n  }\r\n}\r\n\r\nconst onKeyAddSub = (data, index) => {\r\n  if (formState.request_content_type == 'multipart/form-data') {\r\n    if(!formState.form[index].subs){\r\n      formState.form[index].subs = []\r\n    }\r\n    formState.form[index].subs.push(data)\r\n  }\r\n  if (formState.request_content_type == 'application/x-www-form-urlencoded') {\r\n    if(!formState.x_form[index].subs){\r\n      formState.x_form[index].subs = []\r\n    }\r\n    formState.x_form[index].subs.push(data)\r\n  }\r\n  if (formState.request_content_type == 'application/json') {\r\n    if(!formState.json[index].subs){\r\n      formState.json[index].subs = []\r\n    }\r\n    formState.json[index].subs.push(data)\r\n  }\r\n}\r\n\r\nconst handleCopyText = () => {\r\n  copyText(formState.url)\r\n  message.success(t('msg_copy_success'))\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.at-input-flex1 {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.th-header-block {\r\n  display: flex;\r\n  align-items: center;\r\n  .td-title {\r\n    font-size: 14px;\r\n    color: #262626;\r\n  }\r\n}\r\n\r\n.key-block-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 12px;\r\n  .key-item {\r\n    font-size: 14px;\r\n    color: #262626;\r\n  }\r\n  .btn-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n  }\r\n  .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_import_library')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"import-library-node-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">\r\n              <svg-icon name=\"nav-library\" style=\"font-size: 14px; color: #333\"></svg-icon>\r\n              {{ t('label_library') }}\r\n            </div>\r\n            <a-form-item :label=\"null\">\r\n              <div class=\"konwledge-list-item\" v-for=\"item in selectedLibraryRows\" :key=\"item.id\">\r\n                <div class=\"avatar-box\">\r\n                  <img :src=\"item.avatar\" alt=\"\" />\r\n                </div>\r\n                <div class=\"content-box\">\r\n                  <div class=\"list-name\">{{ item.library_name }}</div>\r\n                  <div class=\"list-intro\">{{ item.library_intro }}</div>\r\n                </div>\r\n                <div class=\"btn-hover-wrap\" @click=\"handleDelKonwledge(item)\">\r\n                  <CloseCircleOutlined />\r\n                </div>\r\n              </div>\r\n              <div class=\"btn-block\">\r\n                <div>\r\n                  <a-button\r\n                    @click=\"handleOpenSelectLibraryAlert\"\r\n                    :icon=\"h(PlusOutlined)\"\r\n                    block\r\n                    type=\"dashed\"\r\n                    >{{ t('btn_add_library') }}</a-button\r\n                  >\r\n                </div>\r\n              </div>\r\n            </a-form-item>\r\n\r\n            <a-form-item :label=\"t('label_library_group')\">\r\n              <a-select\r\n                v-model:value=\"formState.library_group_id\"\r\n                style=\"width: 100%\"\r\n                :placeholder=\"t('ph_select')\"\r\n              >\r\n                <a-select-option v-for=\"item in groupLists\" :value=\"item.id\" :key=\"item.id\">{{\r\n                  item.group_name\r\n                }}</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n\r\n            <a-form-item\r\n              :label=\"t('label_import_type')\"\r\n              v-if=\"selectedLibraryType != 2 && selectedLibraryType >= 0\"\r\n            >\r\n              <a-segmented\r\n                class=\"customer-segmented\"\r\n                v-model:value=\"formState.import_type\"\r\n                :options=\"options1\"\r\n              />\r\n            </a-form-item>\r\n\r\n            <a-form-item :label=\"t('label_qa_repeat')\" v-if=\"selectedLibraryType == 2\">\r\n              <a-segmented\r\n                class=\"customer-segmented\"\r\n                v-model:value=\"formState.qa_repeat_op\"\r\n                :options=\"options2\"\r\n              />\r\n            </a-form-item>\r\n\r\n            <a-form-item\r\n              :label=\"t('label_url_repeat')\"\r\n              v-if=\"\r\n                selectedLibraryType != 2 &&\r\n                selectedLibraryType >= 0 &&\r\n                formState.import_type == 'url'\r\n              \"\r\n            >\r\n              <a-segmented\r\n                class=\"customer-segmented\"\r\n                v-model:value=\"formState.normal_url_repeat_op\"\r\n                :options=\"options2\"\r\n              />\r\n            </a-form-item>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">\r\n              <svg-icon name=\"input\" style=\"font-size: 14px; color: #333\"></svg-icon>\r\n              {{ t('label_input') }}\r\n            </div>\r\n            <template v-if=\"selectedLibraryType != 2 && selectedLibraryType >= 0\">\r\n              <div class=\"flex-block-item\" v-if=\"formState.import_type == 'content'\">\r\n                <div class=\"form-item-label required\">{{ t('label_document_title') }}</div>\r\n                <div class=\"form-content-box flex1\">\r\n                  <at-input\r\n                    inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                    :options=\"variableOptions\"\r\n                    :defaultValue=\"formState.normal_title\"\r\n                    @open=\"getVlaueVariableList\"\r\n                    @change=\"\r\n                      (text, selectedList) => changeValue(text, selectedList, 'normal_title')\r\n                    \"\r\n                    :placeholder=\"t('ph_input_value')\"\r\n                  >\r\n                    <template #option=\"{ label, payload }\">\r\n                      <div class=\"field-list-item\">\r\n                        <div class=\"field-label\">{{ label }}</div>\r\n                        <div class=\"field-type\">{{ payload.typ }}</div>\r\n                      </div>\r\n                    </template>\r\n                  </at-input>\r\n                </div>\r\n              </div>\r\n              <div class=\"flex-block-item\" v-if=\"formState.import_type == 'content'\">\r\n                <div class=\"form-item-label required\">{{ t('label_document_content') }}</div>\r\n                <div class=\"form-content-box flex1\">\r\n                  <at-input\r\n                    inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                    :options=\"variableOptions\"\r\n                    :defaultValue=\"formState.normal_content\"\r\n                    @open=\"getVlaueVariableList\"\r\n                    @change=\"\r\n                      (text, selectedList) => changeValue(text, selectedList, 'normal_content')\r\n                    \"\r\n                    :placeholder=\"t('ph_input_value')\"\r\n                  >\r\n                    <template #option=\"{ label, payload }\">\r\n                      <div class=\"field-list-item\">\r\n                        <div class=\"field-label\">{{ label }}</div>\r\n                        <div class=\"field-type\">{{ payload.typ }}</div>\r\n                      </div>\r\n                    </template>\r\n                  </at-input>\r\n                </div>\r\n              </div>\r\n              <div class=\"flex-block-item\" v-if=\"formState.import_type == 'url'\">\r\n                <div class=\"form-item-label\">{{ t('label_document_url') }}</div>\r\n                <div class=\"form-content-box flex1\">\r\n                  <at-input\r\n                    inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                    :options=\"variableOptions\"\r\n                    :defaultValue=\"formState.normal_url\"\r\n                    @open=\"getVlaueVariableList\"\r\n                    @change=\"(text, selectedList) => changeValue(text, selectedList, 'normal_url')\"\r\n                    :placeholder=\"t('ph_input_value')\"\r\n                  >\r\n                    <template #option=\"{ label, payload }\">\r\n                      <div class=\"field-list-item\">\r\n                        <div class=\"field-label\">{{ label }}</div>\r\n                        <div class=\"field-type\">{{ payload.typ }}</div>\r\n                      </div>\r\n                    </template>\r\n                  </at-input>\r\n                </div>\r\n              </div>\r\n            </template>\r\n\r\n            <template v-if=\"selectedLibraryType == 2\">\r\n              <div class=\"flex-block-item\">\r\n                <div class=\"form-item-label required\">{{ t('label_segment_question') }}</div>\r\n                <div class=\"form-content-box flex1\">\r\n                  <at-input\r\n                    inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                    :options=\"variableOptions\"\r\n                    :defaultValue=\"formState.qa_question\"\r\n                    @open=\"getVlaueVariableList\"\r\n                    @change=\"(text, selectedList) => changeValue(text, selectedList, 'qa_question')\"\r\n                    :placeholder=\"t('ph_input_value')\"\r\n                  >\r\n                    <template #option=\"{ label, payload }\">\r\n                      <div class=\"field-list-item\">\r\n                        <div class=\"field-label\">{{ label }}</div>\r\n                        <div class=\"field-type\">{{ payload.typ }}</div>\r\n                      </div>\r\n                    </template>\r\n                  </at-input>\r\n                </div>\r\n              </div>\r\n              <div class=\"flex-block-item\">\r\n                <div class=\"form-item-label required\">{{ t('label_segment_answer') }}</div>\r\n                <div class=\"form-content-box flex1\">\r\n                  <at-input\r\n                    inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                    :options=\"variableOptions\"\r\n                    :defaultValue=\"formState.qa_answer\"\r\n                    @open=\"getVlaueVariableList\"\r\n                    @change=\"(text, selectedList) => changeValue(text, selectedList, 'qa_answer')\"\r\n                    :placeholder=\"t('ph_input_value')\"\r\n                  >\r\n                    <template #option=\"{ label, payload }\">\r\n                      <div class=\"field-list-item\">\r\n                        <div class=\"field-label\">{{ label }}</div>\r\n                        <div class=\"field-type\">{{ payload.typ }}</div>\r\n                      </div>\r\n                    </template>\r\n                  </at-input>\r\n                </div>\r\n              </div>\r\n              <div class=\"flex-block-item\">\r\n                <div class=\"form-item-label\">\r\n                  {{ t('label_answer_images') }}\r\n                  <a-tooltip :title=\"t('tip_answer_images')\">\r\n                    <QuestionCircleOutlined />\r\n                  </a-tooltip>\r\n                </div>\r\n                <div class=\"form-content-box flex1\">\r\n                  <at-input\r\n                    inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                    :options=\"variableOptionsArr\"\r\n                    :defaultValue=\"formState.qa_images_variable\"\r\n                    @open=\"getVlaueVariableList\"\r\n                    @change=\"\r\n                      (text, selectedList) => changeValue(text, selectedList, 'qa_images_variable')\r\n                    \"\r\n                    :placeholder=\"t('ph_input_value')\"\r\n                  >\r\n                    <template #option=\"{ label, payload }\">\r\n                      <div class=\"field-list-item\">\r\n                        <div class=\"field-label\">{{ label }}</div>\r\n                        <div class=\"field-type\">{{ payload.typ }}</div>\r\n                      </div>\r\n                    </template>\r\n                  </at-input>\r\n                </div>\r\n              </div>\r\n              <div class=\"flex-block-item\">\r\n                <div class=\"form-item-label\">\r\n                  {{ t('label_similar_questions') }}\r\n                  <a-tooltip :title=\"t('tip_similar_questions')\">\r\n                    <QuestionCircleOutlined />\r\n                  </a-tooltip>\r\n                </div>\r\n                <div class=\"form-content-box flex1\">\r\n                  <at-input\r\n                    inputStyle=\"overflow-y: hidden; overflow-x: scroll; height: 22px;\"\r\n                    :options=\"variableOptionsArr\"\r\n                    :defaultValue=\"formState.qa_similar_question_variable\"\r\n                    @open=\"getVlaueVariableList\"\r\n                    @change=\"\r\n                      (text, selectedList) =>\r\n                        changeValue(text, selectedList, 'qa_similar_question_variable')\r\n                    \"\r\n                    :placeholder=\"t('ph_input_value')\"\r\n                  >\r\n                    <template #option=\"{ label, payload }\">\r\n                      <div class=\"field-list-item\">\r\n                        <div class=\"field-label\">{{ label }}</div>\r\n                        <div class=\"field-type\">{{ payload.typ }}</div>\r\n                      </div>\r\n                    </template>\r\n                  </at-input>\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </div>\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">\r\n              <svg-icon name=\"output\" style=\"font-size: 14px; color: #333\"></svg-icon>\r\n              {{ t('label_output') }}\r\n            </div>\r\n            <div class=\"options-item\">\r\n              <div class=\"option-label\">msg</div>\r\n              <div class=\"desc\">{{ t('msg_output_description') }}</div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n        <LibrarySelectAlert\r\n          ref=\"librarySelectAlertRef\"\r\n          :showWxType=\"!!wxAppLibary\"\r\n          select_type=\"radio\"\r\n          @change=\"onChangeLibrarySelected\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, computed, onMounted, h, nextTick } from 'vue'\r\nimport { CloseCircleOutlined, PlusOutlined, QuestionCircleOutlined } from '@ant-design/icons-vue'\r\nimport { getLibraryList, getLibraryGroup } from '@/api/library/index'\r\nimport LibrarySelectAlert from '../components/library-select-alert.vue'\r\nimport { getSpecifyAbilityConfig } from '@/api/explore/index.js'\r\nimport AtInput from '../../at-input/at-input.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.import-library-node-form.index')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst options1 = computed(() => [\r\n  {\r\n    label: t('label_import_content'),\r\n    value: 'content'\r\n  },\r\n  {\r\n    label: t('label_import_url'),\r\n    value: 'url'\r\n  }\r\n])\r\n\r\nconst options2 = computed(() => [\r\n  {\r\n    label: t('label_import_anyway'),\r\n    value: 'import'\r\n  },\r\n  {\r\n    label: t('label_not_import'),\r\n    value: 'not import'\r\n  },\r\n  {\r\n    label: t('label_update_content'),\r\n    value: 'update'\r\n  }\r\n])\r\n\r\nconst groupListMap = ref({})\r\n\r\nconst variableOptions = ref([])\r\nconst variableOptionsArr = ref([])\r\n\r\nconst getVlaueVariableList = () => {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n    list.forEach((item) => {\r\n      item.tags = item.tags || []\r\n    })\r\n\r\n    variableOptions.value = list\r\n    variableOptionsArr.value = filterCalueOptions(list)\r\n  }\r\n}\r\n\r\nfunction filterCalueOptions(list) {\r\n  function traverse(items) {\r\n    const result = []\r\n\r\n    for (const item of items) {\r\n      if (item.children && item.children.length > 0) {\r\n        // 有子节点的情况，递归处理子节点\r\n        const filteredChildren = traverse(item.children)\r\n\r\n        if (filteredChildren.length > 0) {\r\n          // 如果过滤后的子节点不为空，保留当前节点并更新其子节点\r\n          const newItem = { ...item, children: filteredChildren }\r\n          result.push(newItem)\r\n        }\r\n      } else {\r\n        // 叶子节点，检查类型是否符合要求\r\n        if (item.typ && item.typ === 'array<string>') {\r\n          result.push({ ...item })\r\n        }\r\n      }\r\n    }\r\n\r\n    return result\r\n  }\r\n\r\n  return traverse(list)\r\n}\r\n\r\nconst wxAppLibary = ref(null)\r\nconst formState = reactive({\r\n  library_group_id: '0',\r\n  library_id: [],\r\n  import_type: 'content',\r\n  normal_url: '',\r\n  normal_title: '',\r\n  normal_content: '',\r\n  normal_url_repeat_op: 'import',\r\n  qa_question: '',\r\n  qa_answer: '',\r\n  qa_images_variable: '',\r\n  qa_similar_question_variable: '',\r\n  qa_repeat_op: 'import',\r\n  outputs: [\r\n    {\r\n      key: 'msg',\r\n      typ: 'string'\r\n    }\r\n  ]\r\n})\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    library_import: {\r\n      ...formState,\r\n      library_id: formState.library_id.join(',')\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let library_import = JSON.parse(dataRaw).library_import || {}\r\n\r\n    getVlaueVariableList()\r\n\r\n    library_import = JSON.parse(JSON.stringify(library_import))\r\n\r\n    for (let key in library_import) {\r\n      if (key == 'library_id') {\r\n        formState.library_id = library_import[key] ? library_import[key].split(',') : []\r\n      } else {\r\n        formState[key] = library_import[key]\r\n      }\r\n    }\r\n    // 公众号知识库是否开启\r\n    getSpecifyAbilityConfig({ ability_type: 'library_ability_official_account' }).then((res) => {\r\n      let _data = res?.data || {}\r\n      if (_data?.user_config?.switch_status == 1) {\r\n        wxAppLibary.value = _data\r\n      }\r\n    })\r\n\r\n    setTimeout(() => {\r\n      getGroupList()\r\n    }, 300)\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst groupLists = computed(() => {\r\n  let library_id = formState.library_id[0]\r\n  let defaultList = [\r\n    {\r\n      group_name: '未分组',\r\n      id: '0'\r\n    }\r\n  ]\r\n  if (library_id) {\r\n    return groupListMap.value[library_id] || defaultList\r\n  }\r\n\r\n  return defaultList\r\n})\r\n\r\nconst libraryList = ref([])\r\nconst librarySelectAlertRef = ref(null)\r\nconst selectedLibraryRows = computed(() => {\r\n  return libraryList.value.filter((item) => {\r\n    if (!wxAppLibary.value) {\r\n      return formState.library_id.includes(item.id) && item.type != 3\r\n    } else {\r\n      return formState.library_id.includes(item.id)\r\n    }\r\n  })\r\n})\r\n\r\nconst selectedLibraryType = computed(() => {\r\n  if (selectedLibraryRows.value && selectedLibraryRows.value.length) {\r\n    return selectedLibraryRows.value[0].type\r\n  }\r\n  return -1\r\n})\r\n\r\n// 移除知识库\r\nconst handleDelKonwledge = (item) => {\r\n  let index = formState.library_id.indexOf(item.id)\r\n  formState.library_id.splice(index, 1)\r\n}\r\n\r\nconst onChangeLibrarySelected = (checkedList) => {\r\n  getList()\r\n  formState.library_id = [...checkedList]\r\n  formState.library_group_id = '0'\r\n  nextTick(() => {\r\n    getGroupList()\r\n  })\r\n}\r\n\r\nconst handleOpenSelectLibraryAlert = () => {\r\n  librarySelectAlertRef.value.open([...formState.library_id])\r\n}\r\n\r\n// 获取知识库\r\nconst getList = async () => {\r\n  const res = await getLibraryList({ type: '' })\r\n  if (res) {\r\n    libraryList.value = res.data || []\r\n  }\r\n}\r\n\r\nconst getGroupList = () => {\r\n  nextTick(() => {\r\n    if (formState.library_id.length == 0) {\r\n      return\r\n    }\r\n    getLibraryGroup({\r\n      group_type: selectedLibraryType.value == 0 ? 1 : 0,\r\n      library_id: formState.library_id[0]\r\n    }).then((res) => {\r\n      groupListMap.value = {\r\n        ...groupListMap.value,\r\n        [formState.library_id[0]]: res.data\r\n      }\r\n      // groupListMap.value[formState.library_id[0]] = res.data || []\r\n    })\r\n  })\r\n}\r\n\r\nconst changeValue = (text, selectedList, key) => {\r\n  formState[key] = text\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nwatch(\r\n  () => formState.library_id,\r\n  () => {\r\n    getGroupList()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n  getList()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.import-library-node-form{\r\n  .flex-block-item {\r\n    flex-direction: column;\r\n    align-items: normal;\r\n    margin-bottom: 12px;\r\n    .form-item-label {\r\n      width: auto;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 2px;\r\n      position: relative;\r\n      &.required {\r\n        &::before {\r\n          content: '*';\r\n          color: #fb363f;\r\n        }\r\n      }\r\n    }\r\n    .form-content-box {\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n.node-form-content {\r\n  ::v-deep(.ant-form-item-label) {\r\n    padding: 0 0 4px;\r\n  }\r\n}\r\n.konwledge-list-item {\r\n  padding: 14px 16px;\r\n  height: 72px;\r\n  border: 1px solid #d8dde5;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: #fff;\r\n  font-size: 14px;\r\n  line-height: 22px;\r\n  margin-bottom: 4px;\r\n  .avatar-box {\r\n    width: 40px;\r\n    height: 40px;\r\n    border: 1px solid var(--07, #f0f0f0);\r\n    border-radius: 6px;\r\n    margin-right: 8px;\r\n    img {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n  .list-name {\r\n    color: #262626;\r\n    font-weight: 600;\r\n  }\r\n  .list-intro {\r\n    font-size: 12px;\r\n    margin-top: 2px;\r\n    line-height: 20px;\r\n    color: #8c8c8c;\r\n    max-width: 400px;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n  }\r\n  .content-box {\r\n    flex: 1;\r\n  }\r\n}\r\n\r\n.desc {\r\n  color: #8c8c8c;\r\n  line-height: 22px;\r\n}\r\n\r\n.btn-block {\r\n  display: flex;\r\n  gap: 4px;\r\n  & > div {\r\n    flex: 1;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    :class=\"['sub-field-item-box', `sub-field-item-box_${props.level}`]\"\r\n    v-for=\"(item, index) in props.data\"\r\n    :key=\"item.cu_key\"\r\n  >\r\n    <div class=\"sub-field-item\">\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-input\r\n        class=\"mr12\"\r\n        :style=\"{ width: widthPx }\"\r\n        v-model:value=\"item.key\"\r\n        :placeholder=\"t('ph_input')\"\r\n      ></a-input>\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-select\r\n        class=\"mr12\"\r\n        @change=\"onTypeChange(item)\"\r\n        v-model:value=\"item.typ\"\r\n        :placeholder=\"t('ph_select')\"\r\n        :style=\"{ width: widthPx }\"\r\n      >\r\n        <a-select-option v-for=\"op in filterTypOptions\" :value=\"op.value\">{{\r\n          op.value\r\n        }}</a-select-option>\r\n      </a-select>\r\n      <div\r\n        class=\"btn-hover-wrap mr12\"\r\n        @click=\"onAddSubs(index, props.data)\"\r\n        v-if=\"showAddBtn(item)\"\r\n      >\r\n        <PlusCircleOutlined />\r\n      </div>\r\n\r\n      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index, props.data)\">\r\n        <CloseCircleOutlined />\r\n      </div>\r\n    </div>\r\n    <template v-if=\"item.subs && item.subs.length > 0\">\r\n      <SubsKey :level=\"props.level + 1\" :typOptions=\"props.typOptions\" :data=\"item.subs\" />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { computed } from 'vue'\r\nimport { CloseCircleOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.json-node-form.subs-key')\r\nconst props = defineProps({\r\n  data: {},\r\n  level: {\r\n    type: Number\r\n  },\r\n  typOptions: {\r\n    type: Array\r\n  }\r\n})\r\n\r\nconst filterTypOptions = computed(() => {\r\n  if (props.level > 2) {\r\n    return props.typOptions.filter((item) => item.value != 'object')\r\n  }\r\n  return props.typOptions\r\n})\r\n\r\nconst widthPx = computed(() => {\r\n  if (props.level == 2) {\r\n    return '180px'\r\n  }\r\n  return '146px'\r\n})\r\n\r\nconst onAddSubs = (index, data) => {\r\n  data[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index, data) => {\r\n  data.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst showAddBtn = (item) => {\r\n  return item.typ == 'object' && props.level <= 2\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sub-field-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 4px;\r\n  .btn-hover-wrap {\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    width: 24px;\r\n    height: 24px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n.mr12 {\r\n  margin-right: 12px;\r\n}\r\n.sub-field-item-box_3 .fork-icon {\r\n  margin-left: 34px;\r\n}\r\n.fork-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n  margin-right: 2px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_json_encode')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('label_input') }}</div>\r\n            <div class=\"array-form-box\">\r\n              <at-input\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.input_tags\"\r\n                :defaultValue=\"formState.input_variable\"\r\n                :checkAnyLevel=\"true\"\r\n                ref=\"atInputRef\"\r\n                :placeholder=\"t('ph_input_message')\"\r\n                @open=\"showAtList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_output_custom') }}</div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\">{{ t('label_type') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\" @mousedown.stop=\"\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n                  <a-form-item :label=\"null\" :name=\"['output', index, 'key']\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 214px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-select\r\n                          @change=\"onTypeChange(item)\"\r\n                          v-model:value=\"item.typ\"\r\n                          :placeholder=\"t('ph_select')\"\r\n                          :showArrow=\"false\"\r\n                          disabled\r\n                          style=\"width: 214px\"\r\n                        >\r\n                          <a-select-option\r\n                            v-for=\"op in typOptions\"\r\n                            :value=\"op.value\"\r\n                            :key=\"op.value\"\r\n                            >{{ op.value }}</a-select-option\r\n                          >\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n\r\n                      <div\r\n                        class=\"btn-hover-wrap\"\r\n                        v-if=\"item.typ == 'object'\"\r\n                        @click=\"onAddSubs(index)\"\r\n                      >\r\n                        <PlusCircleOutlined />\r\n                      </div>\r\n\r\n                      <!-- <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div> -->\r\n                    </div>\r\n                    <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                      <a-form-item-rest>\r\n                        <SubKey :data=\"item.subs\" :level=\"2\" :typOptions=\"typOptions\" />\r\n                      </a-form-item-rest>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <!-- <a-button @click=\"handleAddOutPut\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >添加参数</a-button\r\n                > -->\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { getUuid } from '@/utils/index'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, h, onMounted } from 'vue'\r\nimport { CloseCircleOutlined, PlusOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport SubKey from './subs-key.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.json-node-form.index')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\n\r\nconst valueOptions = ref([])\r\n\r\nfunction getOptions() {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    valueOptions.value = filterCalueOptions(list)\r\n  }\r\n}\r\n\r\nfunction filterCalueOptions(list) {\r\n  function traverse(items) {\r\n    const result = []\r\n    \r\n    for (const item of items) {\r\n      if (item.children && item.children.length > 0) {\r\n        // 有子节点的情况，递归处理子节点\r\n        const filteredChildren = traverse(item.children)\r\n        \r\n        if (filteredChildren.length > 0) {\r\n          // 如果过滤后的子节点不为空，保留当前节点并更新其子节点\r\n          const newItem = { ...item, children: filteredChildren }\r\n          result.push(newItem)\r\n        }\r\n      } else {\r\n        // 叶子节点，检查类型是否符合要求\r\n        if (item.typ && (item.typ.startsWith('array<') || item.typ === 'object')) {\r\n          result.push({ ...item })\r\n        }\r\n      }\r\n    }\r\n    \r\n    return result\r\n  }\r\n  \r\n  return traverse(list)\r\n}\r\n\r\nconst showAtList = (val) => {\r\n  if (val) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\n\r\nconst formState = reactive({\r\n  input_variable: '',\r\n  input_tags: [],\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: 'string',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    json_encode: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst changeValue = (text, selectedList) => {\r\n  formState.input_tags = selectedList\r\n  formState.input_variable = text\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let json_encode = JSON.parse(dataRaw).json_encode || {}\r\n\r\n    json_encode = JSON.parse(JSON.stringify(json_encode))\r\n    getOptions()\r\n    formState.input_variable = json_encode.input_variable\r\n    if (json_encode.output.length > 0) {\r\n      formState.output = json_encode.output\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddOutPut = () => {\r\n  formState.output.push({\r\n    key: '',\r\n    typ: 'string',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  formState.output[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.code-edit-box {\r\n  margin-top: 12px;\r\n  .title-block {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n}\r\n.action-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    margin-left: 8px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>","<template>\r\n  <div\r\n    :class=\"['sub-field-item-box', `sub-field-item-box_${props.level}`]\"\r\n    v-for=\"(item, index) in props.data\"\r\n    :key=\"item.cu_key\"\r\n  >\r\n    <div class=\"sub-field-item\">\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-input\r\n        class=\"mr12\"\r\n        :style=\"{ width: widthPx }\"\r\n        v-model:value=\"item.key\"\r\n        :placeholder=\"t('ph_input')\"\r\n      ></a-input>\r\n      <img class=\"fork-icon\" src=\"@/assets/svg/right-fork-icon.svg\" alt=\"\" />\r\n      <a-select\r\n        class=\"mr12\"\r\n        @change=\"onTypeChange(item)\"\r\n        v-model:value=\"item.typ\"\r\n        :placeholder=\"t('ph_select')\"\r\n        :style=\"{ width: widthPx }\"\r\n      >\r\n        <a-select-option v-for=\"op in filterTypOptions\" :value=\"op.value\">{{\r\n          op.value\r\n        }}</a-select-option>\r\n      </a-select>\r\n      <div\r\n        class=\"btn-hover-wrap mr12\"\r\n        @click=\"onAddSubs(index, props.data)\"\r\n        v-if=\"showAddBtn(item)\"\r\n      >\r\n        <PlusCircleOutlined />\r\n      </div>\r\n\r\n      <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index, props.data)\">\r\n        <CloseCircleOutlined />\r\n      </div>\r\n    </div>\r\n    <template v-if=\"item.subs && item.subs.length > 0\">\r\n      <SubsKey :level=\"props.level + 1\" :typOptions=\"props.typOptions\" :data=\"item.subs\" />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { computed } from 'vue'\r\nimport { CloseCircleOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.json-reverse-node-form.subs-key')\r\nconst props = defineProps({\r\n  data: {},\r\n  level: {\r\n    type: Number\r\n  },\r\n  typOptions: {\r\n    type: Array\r\n  }\r\n})\r\n\r\nconst filterTypOptions = computed(() => {\r\n  if (props.level > 2) {\r\n    return props.typOptions.filter((item) => item.value != 'object')\r\n  }\r\n  return props.typOptions\r\n})\r\n\r\nconst widthPx = computed(() => {\r\n  if (props.level == 2) {\r\n    return '180px'\r\n  }\r\n  return '146px'\r\n})\r\n\r\nconst onAddSubs = (index, data) => {\r\n  data[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index, data) => {\r\n  data.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst showAddBtn = (item) => {\r\n  return item.typ == 'object' && props.level <= 2\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sub-field-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 4px;\r\n  .btn-hover-wrap {\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    width: 24px;\r\n    height: 24px;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n}\r\n.mr12 {\r\n  margin-right: 12px;\r\n}\r\n.sub-field-item-box_3 .fork-icon {\r\n  margin-left: 34px;\r\n}\r\n.fork-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n  margin-right: 2px;\r\n}\r\n</style>\r\n","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc_json_decode')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <div class=\"gray-block-title\">{{ t('label_input_string') }}</div>\r\n            <div class=\"array-form-box\">\r\n              <a-cascader\r\n                v-model:value=\"formState.input_variable\"\r\n                @dropdownVisibleChange=\"onDropdownVisibleChange\"\r\n                style=\"width: 400px\"\r\n                :options=\"valueOptions\"\r\n                change-on-select\r\n                :allowClear=\"false\"\r\n                :displayRender=\"({ labels }) => labels.join('/')\"\r\n                :field-names=\"{ children: 'children' }\"\r\n                :placeholder=\"t('ph_select')\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('label_output_custom') }}</div>\r\n            <div class=\"output-box\">\r\n              <div class=\"output-block\">\r\n                <div class=\"output-item\">{{ t('label_param_key') }}</div>\r\n                <div class=\"output-item\">{{ t('label_type') }}</div>\r\n              </div>\r\n              <div class=\"array-form-box\" @mousedown.stop=\"\">\r\n                <div class=\"form-item-list\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n                  <a-form-item :label=\"null\" :name=\"['output', index, 'key']\">\r\n                    <div class=\"flex-block-item\" style=\"gap: 12px\">\r\n                      <a-input\r\n                        style=\"width: 214px\"\r\n                        v-model:value=\"item.key\"\r\n                        :placeholder=\"t('ph_input')\"\r\n                      ></a-input>\r\n                      <a-form-item-rest>\r\n                        <a-select\r\n                          @change=\"onTypeChange(item)\"\r\n                          v-model:value=\"item.typ\"\r\n                          :placeholder=\"t('ph_select')\"\r\n                          :showArrow=\"false\"\r\n                          disabled\r\n                          style=\"width: 214px\"\r\n                        >\r\n                          <a-select-option\r\n                            v-for=\"op in typOptions\"\r\n                            :value=\"op.value\"\r\n                            :key=\"op.value\"\r\n                            >{{ op.value }}</a-select-option\r\n                          >\r\n                        </a-select>\r\n                      </a-form-item-rest>\r\n\r\n                      <div\r\n                        class=\"btn-hover-wrap\"\r\n                        v-if=\"item.typ == 'object'\"\r\n                        @click=\"onAddSubs(index)\"\r\n                      >\r\n                        <PlusCircleOutlined />\r\n                      </div>\r\n\r\n                      <!-- <div class=\"btn-hover-wrap\" @click=\"onDelOutput(index)\">\r\n                        <CloseCircleOutlined />\r\n                      </div> -->\r\n                    </div>\r\n                    <div class=\"sub-field-box\" v-if=\"item.subs && item.subs.length > 0\">\r\n                      <a-form-item-rest>\r\n                        <SubKey :data=\"item.subs\" :level=\"2\" :typOptions=\"typOptions\" />\r\n                      </a-form-item-rest>\r\n                    </div>\r\n                  </a-form-item>\r\n                </div>\r\n                <!-- <a-button @click=\"handleAddOutPut\" :icon=\"h(PlusOutlined)\" block type=\"dashed\"\r\n                  >添加参数</a-button\r\n                > -->\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { getUuid } from '@/utils/index'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { ref, reactive, watch, h, onMounted } from 'vue'\r\nimport { CloseCircleOutlined, PlusOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\nimport SubKey from './subs-key.vue'\r\nimport { formatSpacialKey } from '@/views/workflow/components/util.js'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.json-reverse-node-form.index')\r\n\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst valueOptions = ref([])\r\n\r\nfunction getOptions() {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    valueOptions.value = handleOptions(filterCalueOptions(list))\r\n  }\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nfunction filterCalueOptions(list) {\r\n  function traverse(items) {\r\n    const result = []\r\n\r\n    for (const item of items) {\r\n      if (item.children && item.children.length > 0) {\r\n        // 有子节点的情况，递归处理子节点\r\n        const filteredChildren = traverse(item.children)\r\n\r\n        if (filteredChildren.length > 0) {\r\n          // 如果过滤后的子节点不为空，保留当前节点并更新其子节点\r\n          const newItem = { ...item, children: filteredChildren }\r\n          result.push(newItem)\r\n        }\r\n      } else {\r\n        if (item.typ) {\r\n          let loop_parent_key = props.node.loop_parent_key\r\n          if (loop_parent_key && (item.node_type == 25 || item.node_type == 30)) {\r\n            // 循环 和 批量处理节点 特殊处理\r\n            if (item.typ === 'object' || item.typ == 'string' || item.typ == 'array<object>') {\r\n              result.push({ ...item })\r\n            }\r\n          } else {\r\n            // 叶子节点，检查类型是否符合要求\r\n            if (item.typ === 'object' || item.typ == 'string') {\r\n              result.push({ ...item })\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return result\r\n  }\r\n\r\n  return traverse(list)\r\n}\r\n\r\nconst formState = reactive({\r\n  input_variable: [],\r\n  input_tags: [],\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: 'object',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    json_decode: {\r\n      ...formState,\r\n      input_variable: formState.input_variable ? formState.input_variable.join('.') : ''\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let json_decode = JSON.parse(dataRaw).json_decode || {}\r\n\r\n    json_decode = JSON.parse(JSON.stringify(json_decode))\r\n    getOptions()\r\n\r\n    formState.input_variable = formatSpacialKey(json_decode.input_variable)\r\n    if (json_decode.output.length > 0) {\r\n      formState.output = json_decode.output\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleAddOutPut = () => {\r\n  formState.output.push({\r\n    key: '',\r\n    typ: 'string',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst onDelOutput = (index) => {\r\n  formState.output.splice(index, 1)\r\n}\r\n\r\nconst onTypeChange = (data) => {\r\n  data.subs = []\r\n}\r\n\r\nconst onAddSubs = (index) => {\r\n  formState.output[index].subs.push({\r\n    key: '',\r\n    value: '',\r\n    subs: [],\r\n    cu_key: getUuid(16)\r\n  })\r\n}\r\n\r\nconst typOptions = [\r\n  {\r\n    lable: 'string',\r\n    value: 'string'\r\n  },\r\n  {\r\n    lable: 'number',\r\n    value: 'number'\r\n  },\r\n  {\r\n    lable: 'boole',\r\n    value: 'boole'\r\n  },\r\n  {\r\n    lable: 'float',\r\n    value: 'float'\r\n  },\r\n  {\r\n    lable: 'object',\r\n    value: 'object'\r\n  },\r\n  {\r\n    lable: 'array\\<string>',\r\n    value: 'array\\<string>'\r\n  },\r\n  {\r\n    lable: 'array\\<number>',\r\n    value: 'array\\<number>'\r\n  },\r\n  {\r\n    lable: 'array\\<boole>',\r\n    value: 'array\\<boole>'\r\n  },\r\n  {\r\n    lable: 'array\\<float>',\r\n    value: 'array\\<float>'\r\n  },\r\n  {\r\n    lable: 'array\\<object>',\r\n    value: 'array\\<object>'\r\n  }\r\n]\r\n\r\nconst onDropdownVisibleChange = (visible) => {\r\n  if (!visible) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.code-edit-box {\r\n  margin-top: 12px;\r\n  .title-block {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n}\r\n.action-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in;\r\n  margin-left: 8px;\r\n  &:hover {\r\n    background: #e4e6eb;\r\n  }\r\n}\r\n\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n</style>\r\n","export default \"__VITE_ASSET__Dzv0APP2__\"","<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader\r\n        :title=\"node.node_name\"\r\n        :iconName=\"node.node_icon_name\"\r\n        :desc=\"t('desc')\"\r\n        @close=\"handleClose\"\r\n      >\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"problem-optimization-form\">\r\n      <div class=\"node-form-content\">\r\n        <a-form ref=\"formRef\" layout=\"vertical\" :model=\"formState\">\r\n          <div class=\"gray-block\">\r\n            <a-flex justify=\"space-between\">\r\n              <div class=\"gray-block-title\">{{ t('title_question_content') }}</div>\r\n              <div class=\"btn-hover-wrap\" @click=\"handleOpenFullAtModal\">\r\n                <FullscreenOutlined />\r\n              </div>\r\n            </a-flex>\r\n            <div class=\"array-form-box\">\r\n              <AtInput\r\n                inputStyle=\"height: 100px;\"\r\n                :options=\"valueOptions\"\r\n                :defaultValue=\"formState.answer_text\"\r\n                ref=\"atInputRef\"\r\n                :placeholder=\"t('ph_input_message')\"\r\n                input-style=\"height: 130px\"\r\n                type=\"textarea\"\r\n                @open=\"showAtList\"\r\n                @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n              />\r\n            </div>\r\n\r\n            <a-form-item :label=\"t('label_answer_type')\">\r\n              <a-radio-group v-model:value=\"formState.answer_type\">\r\n                <a-radio value=\"text\">{{ t('opt_direct_answer') }}</a-radio>\r\n                <a-radio value=\"menu\"\r\n                  >{{ t('opt_smart_menu') }}\r\n\r\n                  <a-popover :title=\"null\">\r\n                    <template #content>\r\n                      <div>\r\n                        <img style=\"width: 330px\" src=\"@/assets/img/robot/menu-guide.png\" alt=\"\" />\r\n                      </div>\r\n                    </template>\r\n                    <QuestionCircleOutlined />\r\n                  </a-popover>\r\n                </a-radio>\r\n              </a-radio-group>\r\n            </a-form-item>\r\n            <div class=\"menu-list-box\" v-if=\"formState.answer_type == 'menu'\">\r\n              <draggable\r\n                v-model=\"formState.menu_content\"\r\n                item-key=\"key\"\r\n                @end=\"onDragEnd\"\r\n                group=\"table-rows\"\r\n                handle=\".drag-btn\"\r\n              >\r\n                <template #item=\"{ element, index }\">\r\n                  <div :key=\"element.id\" class=\"menu-item\">\r\n                    <div class=\"menu-border-box\">\r\n                      <span class=\"drag-btn\"><svg-icon name=\"drag\" /></span>\r\n                      <span class=\"index-number\">{{ index + 1 }}</span>\r\n                      <div class=\"input-box\">\r\n                        <AtInput\r\n                          inputStyle=\"height: 22px;\"\r\n                          :bordered=\"false\"\r\n                          :options=\"valueOptions\"\r\n                          :defaultValue=\"element.content\"\r\n                          :placeholder=\"t('ph_input_message')\"\r\n                          @open=\"showAtList\"\r\n                          @change=\"\r\n                            (text, selectedList) => changeMenuValue(text, selectedList, element)\r\n                          \"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <span class=\"action-btn\">\r\n                      <CloseCircleOutlined @click=\"onDelete(index)\" />\r\n                    </span>\r\n                  </div>\r\n                </template>\r\n              </draggable>\r\n              <div>\r\n                <a-button @click=\"handleAddMenu()\" type=\"dashed\" block\r\n                  ><PlusOutlined />{{ t('btn_add_menu') }}</a-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"gray-block mt16\">\r\n            <div class=\"gray-block-title\">{{ t('title_output') }}</div>\r\n            <div class=\"options-item\">\r\n              <div class=\"option-label\">question</div>\r\n              <div class=\"option-type\">string</div>\r\n            </div>\r\n            <div class=\"options-item\">\r\n              <div class=\"option-label\">question_multiple</div>\r\n              <div class=\"option-type\" v-text=\"'array<object>'\"></div>\r\n              <a-tooltip placement=\"left\">\r\n                <template #title>\r\n                  <div>{{ t('tip_question_multiple') }}</div>\r\n              <pre><code>\"question_multiple\":[\r\n  {\r\n    \"type\":\"text\",\r\n    \"text\":\"{{ t('sample_text_content') }}\"\r\n  },{\r\n    \"type\":\"image_url\",\r\n    \"image_url\":{\r\n      \"url\":\"{{ t('sample_image_url') }}\"\r\n    }\r\n  }\r\n]\r\n              </code></pre>\r\n                </template>\r\n                <QuestionCircleOutlined />\r\n              </a-tooltip>\r\n            </div>\r\n          </div>\r\n        </a-form>\r\n      </div>\r\n      <FullAtInput\r\n        :options=\"valueOptions\"\r\n        :defaultValue=\"formState.answer_text\"\r\n        :placeholder=\"t('ph_input_message_with_slash')\"\r\n        type=\"textarea\"\r\n        @open=\"showAtList\"\r\n        @change=\"(text, selectedList) => changeValue(text, selectedList)\"\r\n        @ok=\"handleRefreshAtInput\"\r\n        ref=\"fullAtInputRef\"\r\n      />\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { getUuid } from '@/utils/index'\r\nimport NodeFormLayout from '../node-form-layout.vue'\r\nimport NodeFormHeader from '../node-form-header.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { ref, reactive, watch, h, onMounted } from 'vue'\r\nimport {\r\n  CloseCircleOutlined,\r\n  PlusOutlined,\r\n  PlusCircleOutlined,\r\n  FullscreenOutlined,\r\n  QuestionCircleOutlined\r\n} from '@ant-design/icons-vue'\r\nimport draggable from 'vuedraggable'\r\nimport AtInput from '../../at-input/at-input.vue'\r\nimport FullAtInput from '../../at-input/full-at-input.vue'\r\nimport { message } from 'ant-design-vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.qa-node-form.index')\r\nconst emit = defineEmits(['update-node'])\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst atInputRef = ref(null)\r\nconst fullAtInputRef = ref(null)\r\n\r\nconst valueOptions = ref([])\r\n\r\nfunction getOptions() {\r\n  const nodeModel = props.lf.getNodeModelById(props.nodeId)\r\n  if (nodeModel) {\r\n    let list = nodeModel.getAllParentVariable()\r\n\r\n    valueOptions.value = list\r\n  }\r\n}\r\n\r\nconst showAtList = (val) => {\r\n  if (val) {\r\n    getOptions()\r\n  }\r\n}\r\n\r\nconst defaultMenu = ref({\r\n  menu_type: '-1',\r\n  serial_no: '-1',\r\n  content: t('default_other_case')\r\n})\r\n\r\nconst formState = reactive({\r\n  answer_text: '',\r\n  answer_type: 'text',\r\n  menu_content: [\r\n    {\r\n      menu_type: '1',\r\n      serial_no: '1',\r\n      content: '',\r\n      key: getUuid(16)\r\n    },\r\n    {\r\n      menu_type: '1',\r\n      serial_no: '2',\r\n      content: '',\r\n      key: getUuid(16)\r\n    }\r\n  ],\r\n\r\n  outputs: [\r\n    {\r\n      key: 'question',\r\n      typ: 'string',\r\n      subs: []\r\n    },\r\n    {\r\n      key: 'question_multiple',\r\n      typ: 'array<object>',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nconst update = () => {\r\n  let menu_content = formState.menu_content.map((item, index) => {\r\n    return {\r\n      ...item,\r\n      serial_no: (index + 1).toString()\r\n    }\r\n  })\r\n  menu_content.push(defaultMenu.value)\r\n  let reply_content_list = [\r\n    {\r\n      reply_type: 'smartMenu',\r\n      smart_menu: {\r\n        menu_content: menu_content\r\n      }\r\n    }\r\n  ]\r\n  const data = JSON.stringify({\r\n    question: {\r\n      ...formState,\r\n      reply_content_list\r\n    }\r\n  })\r\n\r\n  emit('update-node', {\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst changeValue = (text, selectedList) => {\r\n  formState.answer_text = text\r\n}\r\n\r\nconst changeMenuValue = (text, selectedList, item) => {\r\n  item.content = text\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let dataRaw = props.node.dataRaw || props.node.node_params || '{}'\r\n    let question = JSON.parse(dataRaw).question || {}\r\n    question = JSON.parse(JSON.stringify(question))\r\n    formState.answer_text = question.answer_text || ''\r\n    formState.answer_type = question.answer_type || 'text'\r\n    let reply_content_list = question.reply_content_list || []\r\n    if (reply_content_list.length > 0) {\r\n      let menu_content = reply_content_list[0].smart_menu?.menu_content || []\r\n      if (menu_content.length > 0) {\r\n        let findItem = menu_content.find((item) => item.menu_type == '-1')\r\n        if (findItem) {\r\n          defaultMenu.value = findItem\r\n        }\r\n        formState.menu_content = menu_content\r\n          .filter((item) => item.menu_type != '-1')\r\n          .map((item) => ({\r\n            ...item,\r\n            key: getUuid(16)\r\n          }))\r\n      }\r\n    }\r\n\r\n    getOptions()\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState,\r\n  () => {\r\n    update()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleRefreshAtInput = () => {\r\n  atInputRef.value.refresh()\r\n}\r\nconst handleOpenFullAtModal = () => {\r\n  fullAtInputRef.value.show()\r\n}\r\n\r\nconst handleClose = () => {\r\n  emit('close')\r\n}\r\n\r\nconst onDragEnd = () => {}\r\n\r\nconst onDelete = (index) => {\r\n  if (formState.menu_content.length <= 1) {\r\n    return message.warning(t('msg_min_menu_required'))\r\n  }\r\n  formState.menu_content.splice(index, 1)\r\n}\r\n\r\nconst handleAddMenu = () => {\r\n  formState.menu_content.push({\r\n    menu_type: '1',\r\n    serial_no: (formState.menu_content.length + 1).toString(),\r\n    content: '',\r\n    key: getUuid(16)\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.code-edit-box {\r\n  margin-top: 12px;\r\n  .title-block {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n}\r\n.action-btn {\r\n  width: 28px;\r\n  height: 28px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in;\r\n  &:hover {\r\n    background: #e4e6eb;\r\n  }\r\n}\r\n\r\n.output-box {\r\n  .output-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    margin-bottom: 4px;\r\n    color: #262626;\r\n    .output-item {\r\n      width: 214px;\r\n    }\r\n  }\r\n  .flex-block-item .btn-hover-wrap {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n\r\n.menu-list-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  .menu-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n    margin-bottom: 4px;\r\n    .input-box {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n    .drag-btn {\r\n      cursor: grab;\r\n    }\r\n    .index-number {\r\n      border-radius: 6px;\r\n      background: var(--06, #d8dde5);\r\n      font-size: 12px;\r\n      line-height: 16px;\r\n      color: #242933;\r\n      padding: 0px 6px;\r\n      margin-left: 6px;\r\n      height: 18px;\r\n      line-height: 18px;\r\n    }\r\n    .menu-border-box {\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      background: #fff;\r\n      border: 1px solid var(--06, #d9d9d9);\r\n      border-radius: 6px;\r\n      padding-left: 4px;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n@import \"./components/node-options\";\r\n\r\n.node-icon {\r\n  display: block;\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 6px;\r\n}\r\n\r\n.workflow-form {\r\n  :deep(.mention-input-warpper) {\r\n    height: 32px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <NodeFormLayout>\r\n    <template #header>\r\n      <NodeFormHeader :title=\"node.node_name\" :desc=\"robotInfo?.robot_intro\">\r\n        <template #node-icon>\r\n          <img v-if=\"robotInfo.robot_avatar\" class=\"node-icon\" :src=\"robotInfo.robot_avatar\"/>\r\n          <a-spin v-else size=\"small\"/>\r\n        </template>\r\n      </NodeFormHeader>\r\n    </template>\r\n    <div class=\"workflow-form\">\r\n      <div class=\"node-options\">\r\n        <div class=\"options-title\">\r\n          <div><img src=\"@/assets/img/workflow/input.svg\" class=\"title-icon\"/>{{ t('label_input') }}</div>\r\n        </div>\r\n        <template v-for=\"item in options\" :key=\"item.key\">\r\n          <div :class=\"['options-item', {'is-required': item.required}]\">\r\n            <div class=\"options-item-tit\">\r\n              <div class=\"option-label\">{{ item.name || item.key }}</div>\r\n              <div class=\"option-type\">{{ item.typ }}</div>\r\n            </div>\r\n            <div>\r\n              <AtInput\r\n                type=\"textarea\"\r\n                inputStyle=\"height: 64px;\"\r\n                :options=\"variableOptions\"\r\n                :defaultSelectedList=\"item.tags\"\r\n                :defaultValue=\"item.variable\"\r\n                ref=\"atInputRef\"\r\n                placeholder=\"请输入内容，键入“/”可以插入变量\"\r\n                @open=\"getValueVariableList\"\r\n                @change=\"(text, selectedList) => changeValue(item, text, selectedList)\"\r\n              >\r\n                <template #option=\"{ label, payload }\">\r\n                  <div class=\"field-list-item\">\r\n                    <div class=\"field-label\">{{ label }}</div>\r\n                    <div class=\"field-type\">{{ payload.typ }}</div>\r\n                  </div>\r\n                </template>\r\n              </AtInput>\r\n            </div>\r\n            <div class=\"desc\">{{ item.desc }}</div>\r\n          </div>\r\n        </template>\r\n      </div>\r\n      <div class=\"node-options\">\r\n        <div class=\"options-title\">\r\n          <div><img src=\"@/assets/img/workflow/output.svg\" class=\"title-icon\"/>{{ t('label_output') }}</div>\r\n        </div>\r\n        <div class=\"options-item\">\r\n          <OutputFields :tree-data=\"outputData\"/>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </NodeFormLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, inject, onMounted} from 'vue'\r\nimport NodeFormLayout from './node-form-layout.vue'\r\nimport NodeFormHeader from './node-form-header.vue'\r\nimport AtInput from '../at-input/at-input.vue'\r\nimport {getRobotStartNode} from \"@/api/robot/index.js\";\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\nimport OutputFields from \"@/views/workflow/components/feishu-table/output-fields.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.zm-workflow-node-form')\r\n\r\nconst getNode = inject('getNode')\r\nconst setData = inject('setData')\r\n\r\nconst props = defineProps({\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst options = ref([])\r\nconst variableOptions = ref([])\r\nconst robotInfo = ref({})\r\nconst outputData = ref([])\r\n\r\nlet nodeParams = {}\r\n\r\nasync function init() {\r\n  getValueVariableList();\r\n  nodeParams = JSON.parse(props.node.node_params)\r\n  outputData.value = nodeParams?.workflow?.output || []\r\n  robotInfo.value = nodeParams?.workflow?.robot_info || {}\r\n  loadRobotNode()\r\n}\r\n\r\nfunction loadRobotNode() {\r\n  getRobotStartNode({\r\n    robot_id: nodeParams?.workflow?.robot_id\r\n  }).then(res => {\r\n    let _params = jsonDecode(res?.data?.node_params)\r\n    let _data = nodeParams?.workflow?.params || []\r\n    options.value = _params?.start?.diy_global || []\r\n    for (let item of options.value) {\r\n      let _it = _data.find(i => item.key == i.key)\r\n      item.variable = _it?.variable || ''\r\n      item.tags = Array.isArray(_it?.tags) ? _it.tags : []\r\n    }\r\n  })\r\n}\r\n\r\nfunction getValueVariableList() {\r\n  variableOptions.value = getNode().getAllParentVariable()\r\n}\r\n\r\nfunction changeValue(item, text, selectedList) {\r\n  item.variable = text;\r\n  item.tags = selectedList\r\n\r\n  update()\r\n}\r\n\r\nfunction update() {\r\n  let _state = JSON.parse(JSON.stringify(options.value))\r\n  for (let item of _state) {\r\n    item.variable = String(item.variable)\r\n  }\r\n  nodeParams.workflow.params = _state\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(nodeParams)\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n","<template>\r\n  <transition name=\"slide-right\" appear>\r\n    <div\r\n      v-if=\"show\"\r\n      :width=\"width\"\r\n      :style=\"{ width: width + 'px' }\"\r\n      class=\"node-form-drawer\"\r\n      aria-label=\"节点表单编辑器\"\r\n      role=\"dialog\"\r\n      @keydown.esc=\"handleClose\"\r\n    >\r\n      <div class=\"node-form-drawer-body\">\r\n        <div class=\"drawer-form\" :node-key=\"props.nodeType\">\r\n          <template v-if=\"nodeFormComponent\">\r\n            <component\r\n              :is=\"nodeFormComponent\"\r\n              :lf=\"props.lf\"\r\n              :node-id=\"props.nodeId\"\r\n              :node-type=\"props.nodeType\"\r\n              :node=\"props.node\"\r\n              :key=\"props.nodeId\"\r\n              @close=\"handleClose\"\r\n              @update-node=\"handleChange\"\r\n            />\r\n          </template>\r\n          <a-result\r\n            v-else\r\n            status=\"warning\"\r\n            :title=\"t('msg_component_load_failed')\"\r\n            :sub-title=\"t('msg_component_not_found')\"\r\n          >\r\n            <template #extra>\r\n              <a-button type=\"primary\" @click=\"handleClose\">{{ t('btn_close') }}</a-button>\r\n            </template>\r\n          </a-result>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </transition>\r\n</template>\r\n\r\n<script setup>\r\n/**\r\n * 节点表单抽屉组件\r\n * @component NodeFormDrawer\r\n * @description 用于显示和编辑不同类型节点的表单配置\r\n * @example\r\n * <node-form-drawer ref=\"drawerRef\" node-key=\"start-node\" />\r\n */\r\n\r\nimport { ref, computed, provide } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.node-form-drawer.index')\r\nimport StartNodeForm from './start-node-form/index.vue'\r\nimport ProblemOptimizationForm from './problem-optimization-form.vue'\r\nimport AiDialogueNodeFrom from './ai-dialogue-node-from.vue'\r\nimport AddDataForm from './add-data-form.vue'\r\nimport KnowledgeBaseNodeForm from './knowledge-base-node-form.vue'\r\nimport CodeRunNodeForm from './code-run-node/code-run-node-form.vue'\r\nimport HttpNodeForm from './http-node/http-node-form.vue'\r\nimport HttpToolNodeForm from './http-tool-node/http-tool-node-form.vue'\r\nimport DeleteDataForm from './delete-data-form.vue'\r\nimport VariableAssignmentNodeForm from './variable-assignment-node-form.vue'\r\nimport UpdateDataForm from './update-data-form.vue'\r\nimport ParameterExtractionNodeForm from './parameter-extraction-form/index.vue'\r\nimport SelectDataForm from './select-data-form.vue'\r\nimport QuestionNodeForm from './question-node-form.vue'\r\nimport JudgeNodeForm from './judge-node-form.vue'\r\nimport SpecifyReplyNodeForm from './specify-reply-form.vue'\r\nimport ImmediatelyReplyNodeForm from './immediately-reply-form.vue'\r\nimport McpForm from './mcp-form.vue'\r\nimport CustomGroupNodeForm from './custom-group-node/custom-group-node-form.vue'\r\nimport ZmPluginsNodeForm from \"./zm-plugins-node-form.vue\";\r\nimport SessionTriggerForm from './session-trigger-form.vue'\r\nimport TimingTriggerForm from './timing-trigger-node/timing-trigger-node-form.vue'\r\nimport OfficialTriggerNodeForm from './official-trigger-node/official-trigger-node-form.vue'\r\nimport BatchGroupForm from './batch-group-form/index.vue'\r\nimport EndNodeForm from './end-node-form/index.vue'\r\nimport {jsonDecode} from \"@/utils/index.js\";\r\nimport VoiceCloneForm from \"./voice-clone-form.vue\";\r\nimport VoiceSynthesisForm from \"./voice-synthesis-form.vue\";\r\nimport ImageGenerationNodeForm from './image-generation-node-form/index.vue'\r\nimport ExplainNodeForm from './explain-node-form/index.vue'\r\nimport WebhookTriggerNodeForm from './webhook-trigger-node-form/index.vue'\r\nimport ImportLibraryNodeForm from './import-library-node-form/index.vue'\r\nimport JsonNodeForm from './json-node-form/index.vue'\r\nimport JsonReverseNodeForm from './json-reverse-node-form/index.vue'\r\nimport QaNodeForm from './qa-node-form/index.vue'\r\nimport ZmWorkflowNodeForm from \"./zm-workflow-node-form.vue\";\r\n\r\n// 预定义所有可能的表单组件\r\nconst formComponents = {\r\n  'start-node': StartNodeForm,\r\n  'problem-optimization-node': ProblemOptimizationForm,\r\n  'ai-dialogue-node': AiDialogueNodeFrom,\r\n  'add-data-node': AddDataForm,\r\n  'knowledge-base-node': KnowledgeBaseNodeForm,\r\n  'code-run-node': CodeRunNodeForm,\r\n  'http-node': HttpNodeForm,\r\n  'http-tool-node': HttpToolNodeForm,\r\n  'delete-data-node': DeleteDataForm,\r\n  'variable-assignment-node': VariableAssignmentNodeForm,\r\n  'update-data-node': UpdateDataForm,\r\n  'parameter-extraction-node': ParameterExtractionNodeForm,\r\n  'select-data-node': SelectDataForm,\r\n  'question-node': QuestionNodeForm,\r\n  'judge-node': JudgeNodeForm,\r\n  'specify-reply-node': SpecifyReplyNodeForm,\r\n  'immediately-reply-node': ImmediatelyReplyNodeForm,\r\n  'mcp-node': McpForm,\r\n  'custom-group': CustomGroupNodeForm,\r\n  'batch-group': BatchGroupForm,\r\n  'zm-plugins-node': ZmPluginsNodeForm,\r\n  'session-trigger-node': SessionTriggerForm,\r\n  'timing-trigger-node': TimingTriggerForm,\r\n  'end-node': EndNodeForm,\r\n  'official-trigger-node': OfficialTriggerNodeForm,\r\n  'image-generation-node': ImageGenerationNodeForm,\r\n  'voice-clone-node': VoiceCloneForm,\r\n  'voice-synthesis-node': VoiceSynthesisForm,\r\n  'explain-node': ExplainNodeForm,\r\n  'webhook-trigger-node': WebhookTriggerNodeForm,\r\n  'import-library-node': ImportLibraryNodeForm,\r\n  'json-node': JsonNodeForm,\r\n  'json-reverse-node': JsonReverseNodeForm,\r\n  'qa-node': QaNodeForm,\r\n  'zm-workflow-node': ZmWorkflowNodeForm,\r\n\r\n  // 其他表单组件可以在这里添加\r\n  // 'problem-optimization-node': defineAsyncComponent(() => import('./problem-optimization-form.vue')),\r\n}\r\n\r\nconst emit = defineEmits(['update:open', 'update-node', 'change-title'])\r\n\r\nconst props = defineProps({\r\n  open: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  lf: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  nodeId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  nodeType: {\r\n    type: String,\r\n    default: 'start-node'\r\n  },\r\n  node: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\n// 使用计算属性获取对应的表单组件，并添加 getter 和 setter\r\nconst show = computed({\r\n  get: () => props.open,\r\n  set: (value) => emit('update:open', value)\r\n})\r\n\r\nconst close = () => {\r\n  show.value = false\r\n}\r\n\r\nconst width = computed(() => {\r\n  let node_params = jsonDecode(props.node?.node_params)\r\n  if (node_params?.plugin?.name == 'feishu_bitable') return 600\r\n  if (node_params?.plugin?.name == 'official_send_message') return 600\r\n  const hasDateRange = (() => {\r\n    const p = node_params?.plugin?.params\r\n    if (!p) return false\r\n    const metaParams = p?.params\r\n    if (metaParams && typeof metaParams === 'object') {\r\n      for (const k in metaParams) {\r\n        const v = metaParams[k]\r\n        if (v && v.date_range_begin_component) return true\r\n      }\r\n    }\r\n    const args = p?.arguments\r\n    if (args && typeof args === 'object') {\r\n      const keys = Object.keys(args || {})\r\n      if (keys.includes('date_type') || (keys.includes('begin_date') && keys.includes('end_date'))) {\r\n        return true\r\n      }\r\n    }\r\n    return false\r\n  })()\r\n  if (hasDateRange) return 640\r\n  let widthMap = {\r\n    'delete-data-node': 600,\r\n    'update-data-node': 600,\r\n    'select-data-node': 600,\r\n    'judge-node': 600,\r\n    'custom-group': 640,\r\n    'timing-trigger-node': 420,\r\n    'batch-group': 640,\r\n    'webhook-trigger-node': 620,\r\n    'end-node': 650,\r\n  }\r\n  return widthMap[props.nodeType] || 480\r\n})\r\nconst getNode = () => {\r\n  return props.lf.getNodeModelById(props.nodeId)\r\n}\r\n\r\nconst getGraph = () => {\r\n  return props.lf.graphModel\r\n}\r\n\r\nconst setData = (data) => {\r\n  handleChange(data)\r\n}\r\n\r\nconst changeTitle = (title) => {\r\n  emit('change-title', title)\r\n}\r\n\r\nconst deleteNode = () => {\r\n  show.value = false\r\n  let node = getNode()\r\n\r\n  getGraph().eventCenter.emit('custom:node:delete', node)\r\n}\r\n\r\n// 使用provide提供lf对象给子组件\r\nprovide('lf', props.lf)\r\nprovide('getNode', getNode)\r\nprovide('getGraph', getGraph)\r\nprovide('setData', setData)\r\nprovide('changeTitle', changeTitle)\r\nprovide('deleteNode', deleteNode)\r\nprovide('close', close)\r\n\r\n// 使用计算属性获取对应的表单组件\r\nconst nodeFormComponent = computed(() => {\r\n  const componentName = `${props.nodeType}`\r\n  return formComponents[componentName] || null\r\n})\r\n\r\nconst handleChange = (data) => {\r\n  data.dataRaw = data.node_params\r\n  emit('update-node', data)\r\n}\r\n\r\nconst handleClose = () => {\r\n  show.value = false\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.node-form-drawer {\r\n  position: fixed;\r\n  z-index: 100;\r\n  top: 56px;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: #fff;\r\n  box-shadow: 0 0 12px rgba(0, 0, 0, 0.1);\r\n  .node-form-drawer-body {\r\n    position: relative;\r\n    height: 100%;\r\n  }\r\n  .drawer-form {\r\n    height: 100%;\r\n    overflow: hidden;\r\n  }\r\n}\r\n// 定义抽屉滑入滑出动画\r\n.slide-right-enter-active,\r\n.slide-right-leave-active {\r\n  transition: transform 0.3s ease;\r\n}\r\n\r\n.slide-right-enter-from,\r\n.slide-right-leave-to {\r\n  transform: translateX(100%);\r\n}\r\n</style>\r\n","import ELK from 'elkjs'\r\n/**\r\n * 将扁平化数组转换为树形结构\r\n * @param {Array} flatData - 包含 id 和 parentId 的扁平数组\r\n * @param {string} [idKey='id'] - 唯一标识符的键名\r\n * @param {string} [parentIdKey='parentId'] - 父节点标识符的键名\r\n * @param {string} [childrenKey='children'] - 子节点数组的键名\r\n * @returns {Array} - 树形结构数组\r\n */\r\nfunction arrayToTree(flatData, idKey = 'id', parentIdKey = 'parentId', childrenKey = 'children') {\r\n  const tree = []\r\n  const map = new Map()\r\n\r\n  // 1. 第一次遍历：将所有节点以 id 为键存入 Map，方便快速查找\r\n  for (const item of flatData) {\r\n    map.set(item[idKey], { ...item, [childrenKey]: [] })\r\n  }\r\n\r\n  // 2. 第二次遍历：构建树形结构\r\n  for (const item of flatData) {\r\n    const mappedItem = map.get(item[idKey])\r\n    const parentId = item[parentIdKey]\r\n\r\n    // 检查是否存在父节点\r\n    if (parentId !== null && parentId !== undefined && map.has(parentId)) {\r\n      const parentItem = map.get(parentId)\r\n      // 将当前节点添加到其父节点的 children 数组中\r\n      parentItem[childrenKey].push(mappedItem)\r\n    } else {\r\n      // 如果没有父节点，说明是根节点\r\n      tree.push(mappedItem)\r\n    }\r\n  }\r\n\r\n  return tree\r\n}\r\n\r\nclass Elk {\r\n  static pluginName = 'elk'\r\n  constructor({ lf }) {\r\n    this.lf = lf\r\n    this.elk = new ELK()\r\n  }\r\n  /**\r\n   * @param {object} graphData\r\n   * @return {Promise<object>}\r\n   */\r\n  async layout(graphData) {\r\n    const originalGraphData = JSON.parse(JSON.stringify(graphData))\r\n\r\n    const { nodes, edges } = originalGraphData\r\n\r\n    // 1. 创建节点映射，方便通过ID快速查找节点\r\n    const nodeMap = new Map(nodes.map((node) => [node.id, node]))\r\n\r\n    const newNodes = nodes.map((item) => {\r\n      let node = {\r\n        id: item.id,\r\n        parentId: item.properties?.loop_parent_key || null\r\n      }\r\n\r\n      // 分组节点特殊处理\r\n      if (item.children && item.children.length > 0) {\r\n        // 对于分组节点，设置初始宽高，ELK会根据子节点自动调整\r\n        // node.width = item.properties.width || 800\r\n        // node.height = item.properties.height || 400\r\n        node.layoutOptions = {\r\n          'elk.padding': '[top=112, right=32, bottom=32, left=32]',\r\n          'elk.nodeSize.constraints': 'MINIMUM_SIZE',\r\n          'elk.nodeSize.minimum': `[600, 420]`,\r\n          'elk.spacing.nodeNode': 100, // 设置组内同层节点间距\r\n          'elk.layered.spacing.nodeNodeBetweenLayers': 120, // 设置组内跨层间距\r\n        }\r\n      } else {\r\n        // 普通节点\r\n        node.width = item.properties.width || 420\r\n        node.height = item.properties.height || 100\r\n        node.layoutOptions = {\r\n          'elk.nodeSize.constraints': 'FIXED'\r\n        }\r\n      }\r\n\r\n      return node\r\n    })\r\n\r\n    // 5. 构建ELK图数据\r\n    // 保留原始边数据的映射，以便后续恢复锚点信息等\r\n    const edgeMap = new Map()\r\n    edges.forEach(edge => {\r\n      edgeMap.set(edge.id, { ...edge })\r\n    })\r\n\r\n    const elkNodes = arrayToTree(newNodes)\r\n    const elkEdges = edges.map((edge) => {\r\n      return {\r\n        id: edge.id,\r\n        sources: [edge.sourceNodeId],\r\n        targets: [edge.targetNodeId]\r\n      }\r\n    })\r\n\r\n    const elkGraph = {\r\n      id: 'root',\r\n      layoutOptions: {\r\n        'elk.algorithm': 'layered', // 使用分层算法\r\n        'elk.direction': 'RIGHT', // 布局方向：从左到右\r\n        'elk.layered.nodePlacement.strategy': 'BRANDES_KOEPF',\r\n        'elk.layered.nodePlacement.bk.fixedAlignment': 'TOP',\r\n        'elk.spacing.nodeNode': 200, //节点间距\r\n        'elk.layered.spacing.nodeNodeBetweenLayers': 200, // 层间间距\r\n        // 嵌套节点相关配置\r\n        'elk.layered.considerHierarchy': 'true',\r\n        'elk.spacing.componentComponent': 80 // 组件间距\r\n      },\r\n      children: elkNodes,\r\n      edges: elkEdges\r\n    }\r\n\r\n    // 执行ELK布局计算\r\n    const newElkGraph = await this.elk.layout(elkGraph)\r\n    // 更新节点位置的辅助函数（递归处理层次结构）\r\n    function updateNodePositions(elkNodes, parentElkNode = null, parentX = 0, parentY = 0) {\r\n      for (const elkNode of elkNodes) {\r\n        const originalNode = nodeMap.get(elkNode.id)\r\n        if (!originalNode) continue\r\n\r\n        // 计算实际坐标\r\n        let actualX, actualY\r\n\r\n        if (parentElkNode) {\r\n          // 嵌套子节点：坐标相对于父节点\r\n          actualX = parentX + elkNode.x\r\n          actualY = parentY + elkNode.y\r\n        } else {\r\n          // 顶层节点：直接使用绝对坐标\r\n          actualX = elkNode.x\r\n          actualY = elkNode.y\r\n        }\r\n\r\n        // 更新节点坐标\r\n        originalNode.x = actualX + elkNode.width / 2;\r\n        originalNode.y = actualY + elkNode.height / 2;\r\n\r\n        // 更新宽高（可选）\r\n        if (!originalNode.properties) originalNode.properties = {}\r\n\r\n        originalNode.width = elkNode.width\r\n        originalNode.height = elkNode.height\r\n        originalNode.properties.width = elkNode.width\r\n        originalNode.properties.height = elkNode.height\r\n\r\n        // 递归子节点，传入当前 elkNode 作为 parent\r\n        if (elkNode.children && elkNode.children.length > 0) {\r\n          updateNodePositions(elkNode.children, elkNode, actualX, actualY)\r\n        }\r\n      }\r\n    }\r\n    \r\n    // 更新所有节点位置\r\n    updateNodePositions(newElkGraph.children)\r\n \r\n    // 9. 更新边路径\r\n    edges.forEach((edge) => {\r\n      const originalEdge = edgeMap.get(edge.id) // 获取原始边数据\r\n      const newEdge = newElkGraph.edges.find((e) => e.id === edge.id)\r\n      if (newEdge && newEdge.sections && newEdge.sections.length > 0) {\r\n        const section = newEdge.sections[0]\r\n        if (section) {\r\n          // 保留原始的锚点信息\r\n          if (originalEdge) {\r\n            edge.sourceAnchorId = originalEdge.sourceAnchorId\r\n            edge.targetAnchorId = originalEdge.targetAnchorId\r\n          }\r\n\r\n          // 设置起始点和结束点\r\n          edge.startPoint = { ...section.startPoint }\r\n          edge.endPoint = { ...section.endPoint }\r\n\r\n          // 构建贝塞尔曲线的pointsList\r\n          // LogicFlow Bezier边的pointsList格式为 [起点, 控制点1, 控制点2, 终点]\r\n          const startPoint = section.startPoint\r\n          const endPoint = section.endPoint\r\n\r\n          // 计算控制点，使用偏移量来生成平滑的贝塞尔曲线\r\n          // 偏移量可以根据线段长度动态计算\r\n          const dx = endPoint.x - startPoint.x\r\n          const dy = endPoint.y - startPoint.y\r\n          const length = Math.sqrt(dx * dx + dy * dy)\r\n\r\n          // 计算偏移量，用于创建平滑的贝塞尔曲线\r\n          const baseOffset = 50\r\n          const scale = 0.3\r\n          let offset = baseOffset + length * scale\r\n          const minOffset = 10\r\n          const maxOffset = 100\r\n          offset = Math.max(minOffset, Math.min(offset, maxOffset))\r\n\r\n          // 创建控制点\r\n          // 控制点1：从起点向右偏移（水平方向）\r\n          const controlPoint1 = {\r\n            x: startPoint.x + Math.abs(dx) * 0.3, // 水平方向偏移\r\n            y: startPoint.y // 保持起点的y坐标或根据需要调整\r\n          }\r\n\r\n          // 控制点2：从终点向左偏移（水平方向）\r\n          const controlPoint2 = {\r\n            x: endPoint.x - Math.abs(dx) * 0.3, // 水平方向偏移\r\n            y: endPoint.y // 保持终点的y坐标或根据需要调整\r\n          }\r\n\r\n          // 如果是垂直方向的线，调整控制点的计算方式\r\n          if (Math.abs(dy) > Math.abs(dx)) {\r\n            // 如果是垂直方向为主\r\n            controlPoint1.x = startPoint.x\r\n            controlPoint1.y = startPoint.y + Math.abs(dy) * 0.3\r\n            controlPoint2.x = endPoint.x\r\n            controlPoint2.y = endPoint.y - Math.abs(dy) * 0.3\r\n          } else {\r\n            // 如果是水平方向为主\r\n            controlPoint1.x = startPoint.x + Math.abs(dx) * 0.3\r\n            controlPoint1.y = startPoint.y\r\n            controlPoint2.x = endPoint.x - Math.abs(dx) * 0.3\r\n            controlPoint2.y = endPoint.y\r\n          }\r\n\r\n          // 更新边的属性\r\n          edge.pointsList = [\r\n            { ...startPoint },\r\n            controlPoint1,\r\n            controlPoint2,\r\n            { ...endPoint }\r\n          ]\r\n\r\n          // 保存offset到properties中，以便后续使用\r\n          if (!edge.properties) {\r\n            edge.properties = {}\r\n          }\r\n          edge.properties.offset = Math.round(offset)\r\n        }\r\n      } else {\r\n        // 如果ELK没有返回该边的信息（可能由于某些原因边被移除或未正确生成）\r\n        // 保留原始边信息，但确保pointsList被初始化\r\n        if (originalEdge) {\r\n          edge.sourceAnchorId = originalEdge.sourceAnchorId\r\n          edge.targetAnchorId = originalEdge.targetAnchorId\r\n          edge.type = originalEdge.type || 'custom-bezier-edge'\r\n\r\n          // 如果原始边有起始点和结束点，但没有pointsList，则初始化\r\n          if (edge.startPoint && edge.endPoint && (!edge.pointsList || edge.pointsList.length === 0)) {\r\n            // 创建默认的贝塞尔曲线控制点\r\n            const dx = edge.endPoint.x - edge.startPoint.x\r\n            const dy = edge.endPoint.y - edge.startPoint.y\r\n            const length = Math.sqrt(dx * dx + dy * dy)\r\n\r\n            const baseOffset = 50\r\n            const scale = 0.3\r\n            let offset = baseOffset + length * scale\r\n            const minOffset = 10\r\n            const maxOffset = 100\r\n            offset = Math.max(minOffset, Math.min(offset, maxOffset))\r\n\r\n            const controlPoint1 = {\r\n              x: edge.startPoint.x + Math.abs(dx) * 0.3,\r\n              y: edge.startPoint.y\r\n            }\r\n\r\n            const controlPoint2 = {\r\n              x: edge.endPoint.x - Math.abs(dx) * 0.3,\r\n              y: edge.endPoint.y\r\n            }\r\n\r\n            if (Math.abs(dy) > Math.abs(dx)) {\r\n              controlPoint1.x = edge.startPoint.x\r\n              controlPoint1.y = edge.startPoint.y + Math.abs(dy) * 0.3\r\n              controlPoint2.x = edge.endPoint.x\r\n              controlPoint2.y = edge.endPoint.y - Math.abs(dy) * 0.3\r\n            } else {\r\n              controlPoint1.x = edge.startPoint.x + Math.abs(dx) * 0.3\r\n              controlPoint1.y = edge.startPoint.y\r\n              controlPoint2.x = edge.endPoint.x - Math.abs(dx) * 0.3\r\n              controlPoint2.y = edge.endPoint.y\r\n            }\r\n\r\n            edge.pointsList = [\r\n              { ...edge.startPoint },\r\n              controlPoint1,\r\n              controlPoint2,\r\n              { ...edge.endPoint }\r\n            ]\r\n\r\n            if (!edge.properties) {\r\n              edge.properties = {}\r\n            }\r\n            edge.properties.offset = Math.round(offset)\r\n          }\r\n        }\r\n      }\r\n    })\r\n    \r\n    this.lf.clearSelectElements()\r\n    this.lf.clearData()\r\n    this.lf.graphModel.graphDataToModel(originalGraphData)\r\n\r\n    this.fitView(originalGraphData.nodes)\r\n\r\n    originalGraphData.nodes.forEach(node => {\r\n      // 将组的zIndex设为-9999，确保它在所有节点的下方\r\n      if(node.children && node.children.length){\r\n        let groupNode = this.lf.graphModel.getElement(node.id)\r\n        if(groupNode){\r\n          groupNode.setZIndex(-9999)\r\n        }\r\n      }\r\n    })\r\n  }\r\n  /**\r\n * 计算并应用最佳视图\r\n * @param {Array} nodes - 所有节点的数组\r\n */\r\n  fitView(nodes) {\r\n    if (!nodes || nodes.length === 0) {\r\n      // 如果没有节点，可以重置视图到初始状态\r\n      this.lf.resetZoom();\r\n      this.lf.resetTranslate();\r\n      return;\r\n    }\r\n\r\n    // 1. 获取画布尺寸\r\n    const { width: viewWidth, height: viewHeight } = this.lf.graphModel;\r\n\r\n    // 2. 计算所有节点的包围盒\r\n    let minX = Infinity;\r\n    let minY = Infinity;\r\n    let maxX = -Infinity;\r\n    let maxY = -Infinity;\r\n\r\n    nodes.forEach(node => {\r\n      // 节点的坐标是中心点，需要考虑节点的宽高\r\n      const halfWidth = (node.width || node.properties.width) / 2;\r\n      const halfHeight = (node.height || node.properties.height) / 2;\r\n      minX = Math.min(minX, node.x - halfWidth);\r\n      minY = Math.min(minY, node.y - halfHeight);\r\n      maxX = Math.max(maxX, node.x + halfWidth);\r\n      maxY = Math.max(maxY, node.y + halfHeight);\r\n    });\r\n\r\n    const graphWidth = maxX - minX;\r\n    const graphHeight = maxY - minY;\r\n\r\n    if (graphWidth === 0 || graphHeight === 0) return;\r\n\r\n    // 3. 计算缩放比例，并留出一些边距 (e.g., 10%)\r\n    const padding = 0.1;\r\n    const scaleX = viewWidth / (graphWidth * (1 + padding));\r\n    const scaleY = viewHeight / (graphHeight * (1 + padding));\r\n    let newZoom = Math.min(scaleX, scaleY);\r\n\r\n    // 4. 应用缩放\r\n    // LogicFlow 的 zoom API 会以画布中心为基点进行缩放\r\n    if(newZoom > 1){\r\n      newZoom = 1\r\n    }else if(newZoom < 0.3){\r\n      newZoom = 0.3\r\n    }\r\n\r\n    this.lf.zoom(newZoom);\r\n    this.lf.translateCenter();\r\n  }\r\n\r\n}\r\n\r\nexport { Elk }\r\n","export class GroupAutoResize {\r\n  static pluginName = 'groupAutoResize';\r\n\r\n  constructor({ lf }) {\r\n    this.lf = lf;\r\n    this.padding = { top: 94, right: 16, bottom: 16, left: 16 };\r\n    // resize_padding 用于在调整大小时，在子节点和父节点之间保留一些额外的空间\r\n    this.resize_padding = 30;\r\n\r\n    this.handleNodeDrag = this.handleNodeDrag.bind(this);\r\n    lf.on('node:drag', this.handleNodeDrag);\r\n  }\r\n\r\n  handleNodeDrag({ data }) {\r\n    // 1. 解绑事件，避免在调用API时触发循环\r\n    this.lf.off('node:drag', this.handleNodeDrag);\r\n\r\n    try {\r\n      const model = this.lf.graphModel.getNodeModelById(data.id);\r\n      if (!model) return;\r\n\r\n      const { x, y, width, height } = model;\r\n      const props = model.getProperties();\r\n\r\n      if (props.loop_parent_key) {\r\n        const groupNode = this.lf.graphModel.getNodeModelById(props.loop_parent_key);\r\n        if (groupNode) {\r\n          const { x: groupX, y: groupY, width: groupWidth, height: groupHeight } = groupNode;\r\n\r\n          // 子节点的四条边\r\n          const nodeLeft = x - width / 2;\r\n          const nodeRight = x + width / 2;\r\n          const nodeTop = y - height / 2;\r\n          const nodeBottom = y + height / 2;\r\n\r\n          // 父容器的四条边（考虑内边距）\r\n          const groupLeft = groupX - groupWidth / 2 + this.padding.left;\r\n          const groupRight = groupX + groupWidth / 2 - this.padding.right;\r\n          const groupTop = groupY - groupHeight / 2 + this.padding.top;\r\n          const groupBottom = groupY + groupHeight / 2 - this.padding.bottom;\r\n\r\n          let newGroupWidth = groupWidth;\r\n          let newGroupHeight = groupHeight;\r\n          let newGroupX = groupX;\r\n          let newGroupY = groupY;\r\n          let needsResize = false;\r\n\r\n          // 2. 判断并计算新的尺寸和位置\r\n          if (nodeLeft < groupLeft) {\r\n            const diff = groupLeft - nodeLeft + this.resize_padding;\r\n            newGroupWidth += diff;\r\n            newGroupX -= diff / 2; // 中心点向左移动\r\n            needsResize = true;\r\n          }\r\n          if (nodeRight > groupRight) {\r\n            const diff = nodeRight - groupRight + this.resize_padding;\r\n            newGroupWidth += diff;\r\n            newGroupX += diff / 2; // 中心点向右移动\r\n            needsResize = true;\r\n          }\r\n          if (nodeTop < groupTop) {\r\n            const diff = groupTop - nodeTop + this.resize_padding;\r\n            newGroupHeight += diff;\r\n            newGroupY -= diff / 2; // 中心点向上移动\r\n            needsResize = true;\r\n          }\r\n          if (nodeBottom > groupBottom) {\r\n            const diff = nodeBottom - groupBottom + this.resize_padding;\r\n            newGroupHeight += diff;\r\n            newGroupY += diff / 2; // 中心点向下移动\r\n            needsResize = true;\r\n          }\r\n\r\n          // 3. 如果需要，则调用 setAttributes 更新节点属性\r\n          if (needsResize) {\r\n            groupNode.x = newGroupX\r\n            groupNode.y = newGroupY\r\n            groupNode._width = groupNode.width = newGroupWidth\r\n            groupNode._height = groupNode.height = newGroupHeight\r\n          }\r\n        }\r\n      }\r\n    } finally {\r\n      // 3. 在finally块中重新绑定事件，确保无论是否出错都能恢复监听\r\n      this.lf.on('node:drag', this.handleNodeDrag);\r\n    }\r\n  }\r\n}","<style lang=\"less\" scoped>\r\n.custom-line-popup {\r\n  border-radius: 6px;\r\n  background: #fff;\r\n\r\n  .delete-btn {\r\n    width: 70px;\r\n    height: 36px;\r\n    line-height: 36px;\r\n    padding: 0;\r\n    border: 0;\r\n    font-size: 14px;\r\n    color: #fb363f;\r\n\r\n    text-align: center;\r\n    cursor: pointer;\r\n    background: none;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"custom-line-popup\" v-show=\"isDeleteConfirmShow\">\r\n    <button class=\"delete-btn\" @click.stop=\"handleDelete\">{{ t('btn_delete') }}</button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'CustomLine',\r\n  emits: ['delete'],\r\n  inject: ['getGraphModel', 'getModel'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      },\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false },\r\n  },\r\n  data() {\r\n    return {\r\n      isDeleteConfirmShow: false,\r\n    }\r\n  },\r\n  computed: {\r\n    t() {\r\n      return useI18n('views.workflow.components.edges.custom-line.index').t\r\n    }\r\n  },\r\n  watch: {\r\n    isSelected(newVal) {\r\n      if (newVal) {\r\n        let graphModel = this.getGraphModel()\r\n        let selectedElements = graphModel.getSelectElements(true);\r\n\r\n        if(selectedElements.nodes.length === 0 && selectedElements.edges.length === 1) {\r\n          this.isDeleteConfirmShow = true;\r\n        }\r\n      } else {\r\n        this.isDeleteConfirmShow = false;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    handleDelete() {\r\n      const graphModel = this.getGraphModel()\r\n      const model = this.getModel()\r\n\r\n      graphModel.eventCenter.emit('custom:edge:delete', model)\r\n\r\n      this.$emit('delete')\r\n    },\r\n  },\r\n}\r\n</script>\r\n","// import { BezierEdge, BezierEdgeModel, h } from '@logicflow/core'\r\n// import { BaseEdgeModel, LineEdge, h } from '@logicflow/core'\r\nimport { PolylineEdge, PolylineEdgeModel, h } from '@logicflow/core'\r\nimport { createApp, h as vh } from 'vue'\r\nimport VueNode from './index.vue'\r\nimport { generateUniqueId } from '@/utils/index'\r\n\r\nconst DEFAULT_WIDTH = 70\r\nconst DEFAULT_HEIGHT = 36\r\n\r\nclass CustomEdge extends PolylineEdge {\r\n  constructor(props) {\r\n    super(props)\r\n    this.isMounted = false\r\n    this.r = vh(VueNode, {\r\n      properties: props.model.getProperties(),\r\n      isSelected: props.model.isSelected,\r\n      isHovered: props.model.isHovered,\r\n    })\r\n\r\n    this.app = createApp({\r\n      render: () => this.r,\r\n      provide: () => ({\r\n        getModel: () => props.model,\r\n        getGraphModel: () => props.graphModel,\r\n      }),\r\n      mounted: () => {\r\n        // console.log('mounted', this)\r\n      },\r\n    })\r\n  }\r\n\r\n  getText() {\r\n    const { model } = this.props\r\n\r\n    const { customWidth = DEFAULT_WIDTH, customHeight = DEFAULT_HEIGHT } = model.getProperties()\r\n    const id = model.id\r\n    // const edgeStyle = model.getEdgeStyle()\r\n    const { startPoint, endPoint, arrowConfig, pointsList } = model\r\n\r\n    // const lineData = {\r\n    //   x1: startPoint.x,\r\n    //   y1: startPoint.y,\r\n    //   x2: endPoint.x,\r\n    //   y2: endPoint.y,\r\n    // }\r\n    let positionData = {\r\n      x: (startPoint.x + endPoint.x - customWidth) / 2,\r\n      y: (startPoint.y + endPoint.y - customHeight) / 2,\r\n      width: customWidth,\r\n      height: customHeight,\r\n    }\r\n\r\n    if (pointsList.length > 2) {\r\n      let index = Math.round(pointsList.length / 2)\r\n      positionData.x = pointsList[index - 1].x + 5\r\n      positionData.y = pointsList[index - 1].y\r\n    }\r\n\r\n    const wrapperStyle = {\r\n      width: customWidth,\r\n      height: customHeight,\r\n    }\r\n\r\n    setTimeout(() => {\r\n      const dom = document.querySelector('#' + 'line_' + id).querySelector('.vue-app-wrapper')\r\n\r\n      if (!this.isMounted) {\r\n        this.isMounted = true\r\n        this.app.mount(dom)\r\n      } else {\r\n        this.r.component.props.isSelected = this.props.model.isSelected\r\n        this.r.component.props.isHovered = this.props.model.isHovered\r\n        this.r.component.props.properties = this.props.model.getProperties()\r\n      }\r\n    }, 0)\r\n\r\n    return h('foreignObject', { ...positionData, id: 'line_' + id }, [\r\n      h('div', {\r\n        id,\r\n        style: wrapperStyle,\r\n        className: 'vue-app-wrapper',\r\n      }),\r\n    ])\r\n  }\r\n}\r\n\r\nclass CustomEdgeModel extends PolylineEdgeModel {\r\n  initEdgeData(data) {\r\n    super.initEdgeData(data)\r\n  }\r\n  createId() {\r\n    return generateUniqueId('customEdge');\r\n  }\r\n\r\n  getEdgeStyle() {\r\n    const style = super.getEdgeStyle()\r\n    // svg属性\r\n    if (this.isSelected || this.isHovered) {\r\n      style.stroke = '#2475FC'\r\n    } else {\r\n      style.stroke = '#A1A7B3'\r\n    }\r\n\r\n    style.strokeWidth = 2\r\n\r\n    return style\r\n  }\r\n\r\n  getArrowStyle() {\r\n    const style = super.getArrowStyle()\r\n    style.refX = 0\r\n    return style\r\n  }\r\n\r\n  getOutlineStyle() {\r\n    const style = super.getOutlineStyle()\r\n    style.stroke = 'none'\r\n    style.hover.stroke = 'none'\r\n    return style\r\n  }\r\n\r\n  /**\r\n   * 重写此方法，使保存数据是能带上锚点数据。\r\n   */\r\n  getData() {\r\n    const data = super.getData()\r\n    data.sourceAnchorId = this.sourceAnchorId\r\n    data.targetAnchorId = this.targetAnchorId\r\n    return data\r\n  }\r\n\r\n  /**\r\n   * 给边自定义方案，使其支持基于锚点的位置更新边的路径\r\n   */\r\n  updatePathByAnchor() {\r\n    // TODO\r\n    const sourceNodeModel = this.graphModel.getNodeModelById(this.sourceNodeId)\r\n    const sourceAnchor = sourceNodeModel\r\n      ?.getDefaultAnchor()\r\n      .find((anchor) => anchor.id === this.sourceAnchorId)\r\n\r\n    const targetNodeModel = this.graphModel.getNodeModelById(this.targetNodeId)\r\n    const targetAnchor = targetNodeModel\r\n      ?.getDefaultAnchor()\r\n      .find((anchor) => anchor.id === this.targetAnchorId)\r\n\r\n    if (sourceAnchor) {\r\n      const startPoint = {\r\n        x: sourceAnchor?.x,\r\n        y: sourceAnchor?.y,\r\n      }\r\n      this.updateStartPoint(startPoint)\r\n    }\r\n\r\n    if (targetAnchor) {\r\n      const endPoint = {\r\n        x: targetAnchor?.x,\r\n        y: targetAnchor?.y,\r\n      }\r\n\r\n      this.updateEndPoint(endPoint)\r\n    }\r\n    // 这里需要将原有的pointsList设置为空，才能触发bezier的自动计算control点。\r\n    this.pointsList = []\r\n    this.initPoints()\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'custom-edge',\r\n  view: CustomEdge,\r\n  model: CustomEdgeModel,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.custom-line-popup {\r\n  /* 图标容器：定义圆形轮廓 */\r\n  .minus-circle-outlined {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 1px solid #d32f2f;\r\n    border-radius: 50%;\r\n    background-color: #ffebee;\r\n    // box-shadow: 0 0 0 2px #ffffff;\r\n    position: relative;\r\n    cursor: pointer;\r\n    &::before {\r\n      content: '';\r\n      width: 50%;\r\n      height: 2px;\r\n      background-color: #d32f2f;\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"custom-line-popup\" v-show=\"isDeleteConfirmShow\">\r\n    <div class=\"minus-circle-outlined\" @click.stop=\"handleDelete\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'CustomLine',\r\n  emits: ['delete'],\r\n  inject: ['getGraphModel', 'getModel'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  data() {\r\n    return {\r\n      isDeleteConfirmShow: false,\r\n    }\r\n  },\r\n  watch: {\r\n    isSelected(newVal) {\r\n      if (newVal) {\r\n        const graphModel = this.getGraphModel()\r\n        const model = this.getModel()\r\n        const sourceNode = graphModel.getNodeModelById(model.sourceNodeId)\r\n   \r\n        if(sourceNode.properties.isTriggerNode){\r\n          this.isDeleteConfirmShow = false;\r\n          return\r\n        }\r\n\r\n        const selectedElements = graphModel.getSelectElements(true);\r\n\r\n        if(selectedElements.nodes.length === 0 && selectedElements.edges.length === 1) {\r\n          this.isDeleteConfirmShow = true;\r\n        }\r\n      } else {\r\n        this.isDeleteConfirmShow = false;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    handleDelete() {\r\n      const graphModel = this.getGraphModel()\r\n      const model = this.getModel()\r\n\r\n      graphModel.eventCenter.emit('custom:edge:delete', model)\r\n      \r\n      this.$emit('delete')\r\n    }\r\n  }\r\n}\r\n</script>","// 贝塞尔曲线\r\nimport { BezierEdge, BezierEdgeModel, h } from \"@logicflow/core\";\r\nimport { createApp, h as vh } from 'vue'\r\nimport VueNode from './index.vue'\r\nimport { generateUniqueId } from '@/utils/index'\r\n\r\nclass CustomEdge extends BezierEdge {\r\n  constructor(props) {\r\n    super(props)\r\n    \r\n    this.isMounted = false\r\n    this.r = vh(VueNode, {\r\n      properties: props.model.getProperties(),\r\n      isSelected: props.model.isSelected,\r\n      isHovered: props.model.isHovered,\r\n    })\r\n\r\n    this.app = createApp({\r\n      render: () => this.r,\r\n      provide: () => ({\r\n        getModel: () => props.model,\r\n        getGraphModel: () => props.graphModel,\r\n      }),\r\n      mounted: () => {\r\n        // console.log('mounted', this)\r\n      },\r\n    })\r\n  }\r\n\r\n  // 关键修复：重写 view 层的 getEndArrow 方法，手动渲染箭头\r\n  getEndArrow() {\r\n    const { model } = this.props;\r\n    const { stroke, strokeWidth } = model.getArrowStyle();\r\n\r\n    return (\r\n      // d格式：M 尾部X 尾部Y L 尖端X 尖端Y L 尾部另一侧X 尾部另一侧Y Z\r\n      h('path', { \r\n        stroke,\r\n        strokeWidth,\r\n        d: 'M -9 -7 0 0 -9 7',\r\n        fill:'none'\r\n      })\r\n    )\r\n  }\r\n\r\n  getText() {\r\n    const { model } = this.props;\r\n    const { startPoint, endPoint, pointsList } = model; // pointsList长度为4，即两个控制点\r\n\r\n    const id = model.id;\r\n    // 固定元素尺寸为24×24\r\n    const elementWidth = 24;\r\n    const elementHeight = 24;\r\n    const halfWidth = elementWidth / 2; // 12\r\n    const halfHeight = elementHeight / 2; // 12\r\n\r\n    // 1. 三次贝塞尔曲线点计算\r\n    const getBezierPoint = (t) => {\r\n      const { x: x0, y: y0 } = startPoint;\r\n      const { x: x1, y: y1 } = pointsList[1]; // 第一个控制点\r\n      const { x: x2, y: y2 } = pointsList[2]; // 第二个控制点\r\n      const { x: x3, y: y3 } = endPoint;\r\n      const t2 = t * t;\r\n      const t3 = t2 * t;\r\n      const mt = 1 - t;\r\n      const mt2 = mt * mt;\r\n      const mt3 = mt2 * mt;\r\n      // 三次贝塞尔公式：B(t) = P0*(1-t)³ + 3P1*(1-t)²t + 3P2*(1-t)t² + P3*t³\r\n      return {\r\n        x: x0 * mt3 + 3 * x1 * mt2 * t + 3 * x2 * mt * t2 + x3 * t3,\r\n        y: y0 * mt3 + 3 * y1 * mt2 * t + 3 * y2 * mt * t2 + y3 * t3,\r\n      };\r\n    };\r\n\r\n    // 2. 高精度曲线长度计算（增加分段数）\r\n    const getBezierLength = (segments = 5) => { // segments 增加精度\r\n      let length = 0;\r\n      let prevPoint = getBezierPoint(0);\r\n      for (let i = 1; i <= segments; i++) {\r\n        const t = i / segments;\r\n        const currentPoint = getBezierPoint(t);\r\n        const dx = currentPoint.x - prevPoint.x;\r\n        const dy = currentPoint.y - prevPoint.y;\r\n        length += Math.sqrt(dx * dx + dy * dy);\r\n        prevPoint = currentPoint;\r\n      }\r\n      return length;\r\n    };\r\n\r\n    // 3. 二分法精准找中点（替代分段遍历）\r\n    const findMidPoint = (totalLength) => {\r\n      const targetLength = totalLength / 2;\r\n      let low = 0, high = 1;\r\n      let midT = 0.5;\r\n      let epsilon = 0.0001; // 精度阈值\r\n\r\n      while (high - low > epsilon) {\r\n        midT = (low + high) / 2;\r\n        const currentLength = getPartialLength(midT);\r\n        if (currentLength < targetLength) {\r\n          low = midT;\r\n        } else {\r\n          high = midT;\r\n        }\r\n      }\r\n\r\n      // 辅助函数：计算t从0到t的曲线长度\r\n      function getPartialLength(t) {\r\n        let length = 0;\r\n        let prevPoint = getBezierPoint(0);\r\n        const segments = 5; // 内部分段数\r\n        for (let i = 1; i <= segments; i++) {\r\n          const currentT = i / segments * t;\r\n          const currentPoint = getBezierPoint(currentT);\r\n          const dx = currentPoint.x - prevPoint.x;\r\n          const dy = currentPoint.y - prevPoint.y;\r\n          length += Math.sqrt(dx * dx + dy * dy);\r\n          prevPoint = currentPoint;\r\n        }\r\n        return length;\r\n      }\r\n\r\n      return getBezierPoint(midT);\r\n    };\r\n\r\n    // 4. 计算中点并定位元素\r\n    const totalLength = getBezierLength();\r\n    const midPoint = findMidPoint(totalLength);\r\n\r\n    const positionData = {\r\n      x: midPoint.x - halfWidth,\r\n      y: midPoint.y - halfHeight,\r\n      width: elementWidth,\r\n      height: elementHeight,\r\n    };\r\n\r\n    const wrapperStyle = {\r\n      width: elementWidth,\r\n      height: elementHeight,\r\n    };\r\n\r\n    // 5. 挂载/更新组件\r\n    setTimeout(() => {\r\n      const dom = document.querySelector(`#line_${id}`)?.querySelector('.vue-app-wrapper');\r\n      if (!this.isMounted && dom) {\r\n        this.isMounted = true;\r\n        this.app.mount(dom);\r\n      } else if (this.r?.component) {\r\n        this.r.component.props.isSelected = model.isSelected;\r\n        this.r.component.props.isHovered = model.isHovered;\r\n        this.r.component.props.properties = model.getProperties();\r\n      }\r\n    }, 0);\r\n\r\n    return h('foreignObject', {\r\n      ...positionData,\r\n      id: `line_${id}`,\r\n    }, [\r\n      h('div', {\r\n        id,\r\n        style: wrapperStyle,\r\n        className: 'vue-app-wrapper',\r\n      }),\r\n    ]);\r\n  }\r\n}\r\n\r\nclass CustomEdgeModel extends BezierEdgeModel {\r\n  initEdgeData(data) {\r\n    super.initEdgeData(data)\r\n  }\r\n  setAttributes(data) {\r\n    super.setAttributes(data)\r\n    // 节点拖拽时动态调整边的offset\r\n    let offset = this.getProperties().offset;\r\n    if(offset){\r\n      this.offset = offset\r\n      this.pointsList = []\r\n      this.initPoints()\r\n    }\r\n  }\r\n  createId() {\r\n    return generateUniqueId('customEdge');\r\n  }\r\n\r\n  getEdgeStyle() {\r\n    const style = super.getEdgeStyle()\r\n    // svg属性\r\n    if (this.isSelected || this.isHovered) {\r\n      style.stroke = '#37e1ffff'\r\n    } else {\r\n      style.stroke = '#2475FC'\r\n    }\r\n\r\n    style.strokeWidth = 2\r\n\r\n    return style\r\n  }\r\n\r\n  getArrowStyle() {\r\n    const style = super.getArrowStyle()\r\n    return {\r\n      ...style,\r\n      ...this.arrowStyle,\r\n      refX: 0,\r\n      refY: 0,\r\n    };\r\n  }\r\n\r\n  getOutlineStyle() {\r\n    const style = super.getOutlineStyle()\r\n    style.stroke = 'none'\r\n    style.hover.stroke = 'none'\r\n    return style\r\n  }\r\n\r\n  /**\r\n   * 重写此方法，使保存数据是能带上锚点数据。\r\n   */\r\n  getData() {\r\n    const data = super.getData()\r\n    data.sourceAnchorId = this.sourceAnchorId\r\n    data.targetAnchorId = this.targetAnchorId\r\n    return data\r\n  }\r\n\r\n  /**\r\n   * 给边自定义方案，使其支持基于锚点的位置更新边的路径\r\n   */\r\n  updatePathByAnchor() {\r\n    // TODO\r\n    const sourceNodeModel = this.graphModel.getNodeModelById(this.sourceNodeId)\r\n    const sourceAnchor = sourceNodeModel\r\n      ?.getDefaultAnchor()\r\n      .find((anchor) => anchor.id === this.sourceAnchorId)\r\n\r\n    const targetNodeModel = this.graphModel.getNodeModelById(this.targetNodeId)\r\n    const targetAnchor = targetNodeModel\r\n      ?.getDefaultAnchor()\r\n      .find((anchor) => anchor.id === this.targetAnchorId)\r\n\r\n    if (sourceAnchor) {\r\n      const startPoint = {\r\n        x: sourceAnchor?.x,\r\n        y: sourceAnchor?.y,\r\n      }\r\n      this.updateStartPoint(startPoint)\r\n    }\r\n\r\n    if (targetAnchor) {\r\n      const endPoint = {\r\n        x: targetAnchor?.x,\r\n        y: targetAnchor?.y,\r\n      }\r\n\r\n      this.updateEndPoint(endPoint)\r\n    }\r\n    // 这里需要将原有的pointsList设置为空，才能触发bezier的自动计算control点。\r\n    this.pointsList = []\r\n    this.initPoints()\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'custom-bezier-edge',\r\n  view: CustomEdge,\r\n  model: CustomEdgeModel,\r\n}","<style lang=\"less\" scoped></style>\r\n\r\n<template>\r\n  <PopupMenu @addNode=\"handleAddNode\" :type=\"type\" :excludedNodeTypes=\"excludedNodeTypes\" v-model:active=\"nodeListTabActive\" />\r\n</template>\r\n\r\n<script>\r\nimport PopupMenu from '../../node-list-popup/index.vue'\r\n\r\nexport default {\r\n  name: 'QuestionNode',\r\n  components: {\r\n    PopupMenu,\r\n  },\r\n  emits: ['click-item'],\r\n  inject: ['getNode', 'getGraph'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      type: 'node',\r\n      excludedNodeTypes: [],\r\n      nodeListTabActive: 1,\r\n    }\r\n  },\r\n  mounted() {\r\n    const mode = this.getGraph()\r\n    mode.eventCenter.on('custom:showPopupMenu', this.onShowPopupMenu)\r\n  },\r\n  methods: {\r\n    onShowPopupMenu(data){\r\n      const {type, loop_parent_key} = data.model.properties\r\n\r\n      if(loop_parent_key){\r\n        let excludedNodeTypes = ['custom-group', 'batch-group', 'end-node', 'qa-node'];\r\n        let parentNode = this.getGraph().getNodeModelById(loop_parent_key)\r\n\r\n        if(parentNode.type == 'batch-group'){\r\n          excludedNodeTypes.push('terminate-node')\r\n        }\r\n\r\n        this.excludedNodeTypes = excludedNodeTypes;\r\n      }else{\r\n        this.excludedNodeTypes = ['explain-node', 'terminate-node']\r\n      }\r\n    },\r\n    handleAddNode(item) {\r\n      this.$emit('click-item', item)\r\n    },\r\n  },\r\n}\r\n</script>\r\n","import { createApp, h } from 'vue'\r\nimport ContextPadView from \"./index.vue\";\r\n\r\nconst WIDTH = 444\r\nconst HEIGHT = 620;\r\n\r\nexport class ContextPad {\r\n  constructor({ lf }) {\r\n    this.menuTypeMap = new Map();\r\n    this.lf = lf;\r\n    this.__menuDOM = document.createElement(\"div\");\r\n    this.__menuDOM.className = \"lf-inner-context\";\r\n    this.__menuDOM.style.width = `${WIDTH}px`;\r\n    this.__menuDOM.style.height = `${HEIGHT}px`;\r\n\r\n\r\n    this.isMounted = false\r\n\r\n    this.r = h(ContextPadView, {\r\n      properties: {},\r\n      isSelected: false,\r\n      isHovered:false,\r\n      onClickItem: ({node, event}) => {\r\n        this.hideMenu()\r\n        \r\n        lf.graphModel.eventCenter.emit('custom:addNode', {\r\n          node: node,\r\n          event: event,\r\n          model: this._activeData,\r\n          anchorData: this._activeAnchorData,\r\n        })\r\n      },\r\n    })\r\n\r\n    this.app = createApp({\r\n      render: () => this.r,\r\n      provide: () => ({\r\n        getNode: () => this._activeData,\r\n        getGraph: () => lf.graphModel,\r\n      }),\r\n      mounted: () => {},\r\n    })\r\n  }\r\n\r\n  render(lf, container) {\r\n    this.container = container;\r\n\r\n    if (!this.isMounted) {\r\n      this.isMounted = true\r\n      this.container.appendChild(this.__menuDOM);\r\n      this.app.mount(this.__menuDOM)\r\n    } else {\r\n      // this.r.component.props.properties = this.props.model.getProperties()\r\n    }\r\n\r\n    lf.on(\"custom:showPopupMenu\", ({anchorData, model}) => {\r\n      this._activeData = model;\r\n      this._activeAnchorData = anchorData;\r\n      this.createMenu();\r\n    })\r\n\r\n    lf.on(\"node:click\", ({ data }) => {\r\n      // this._activeData = data;\r\n      // this.createMenu();\r\n      this.hideMenu();\r\n    });\r\n    lf.on(\"edge:click\", ({ data }) => {\r\n      // 获取右上角坐标\r\n      // this._activeData = data;\r\n      // this.createMenu();\r\n      this.hideMenu();\r\n    });\r\n\r\n    lf.on(\"blank:click\", () => {\r\n      this.hideMenu();\r\n    });\r\n  }\r\n  createMenu() {\r\n    // this.__menuDOM = document.createElement(\"div\");\r\n    // this.__menuDOM.className = \"lf-inner-context context-pad-wrapper\";\r\n\r\n\r\n    this.showMenu();\r\n  }\r\n  // 计算出菜单应该显示的位置（节点的右上角）\r\n  getContextMenuPosition() {\r\n    const data = this._activeAnchorData;\r\n    let x = data.x + 5;\r\n    let y =  data.y - 10;\r\n\r\n    return this.lf.graphModel.transformModel.CanvasPointToHtmlPoint([x, y]);\r\n  }\r\n  showMenu() {\r\n    // 获取菜单的理想位置\r\n    const [x, y] = this.getContextMenuPosition();\r\n    // 获取画布的高度和宽度，减去适当偏移量\r\n    const canvasHeight = this.lf.graphModel.height - 64;\r\n    const canvasWidth = this.lf.graphModel.width - 64;\r\n\r\n    // 显示菜单\r\n    this.__menuDOM.style.display = \"flex\";\r\n    \r\n    // 计算菜单的实际高度，取525和（画布高度-20）中的较小值\r\n    const menuHeight = Math.min(525, canvasHeight - 20);\r\n    const menuWidth = WIDTH;\r\n\r\n    // 处理水平位置\r\n    let left = x + 10;\r\n    \r\n    // 判断菜单是否会超出画布右侧\r\n    if (left + menuWidth > canvasWidth) {\r\n      // 如果超出，将菜单位置调整到锚点左侧\r\n      left = x - menuWidth - 20;\r\n    }\r\n    \r\n    // 如果菜单左侧超出画布左侧，则设置为4像素\r\n    if (left < 0) {\r\n      left = 4;\r\n    }\r\n    \r\n    // 设置菜单的水平位置\r\n    this.__menuDOM.style.left = `${left}px`;\r\n\r\n    let top = y;\r\n    \r\n    // 判断菜单是否会超出画布底部\r\n    if(y + menuHeight > canvasHeight){\r\n      // 如果超出，向上调整菜单位置，使其紧贴画布底部\r\n      top = y - (y + menuHeight - canvasHeight) - 10\r\n    }else{\r\n      // 如果未超出，向上微调10像素\r\n      top = y - 10\r\n    }\r\n\r\n    // 如果菜单顶部超出画布顶部，则设置为4像素\r\n    if(top < 0){\r\n      top = 4\r\n    }\r\n    \r\n    // 设置菜单的垂直位置\r\n    this.__menuDOM.style.top = `${top}px`;\r\n    // 设置菜单的高度，如果计算出的高度有效则使用，否则使用默认高度\r\n    this.__menuDOM.style.height = `${menuHeight > 0 ? menuHeight : HEIGHT}px`;\r\n\r\n    // 如果菜单当前未显示，则添加事件监听器，在节点删除、拖拽或画布变换时隐藏菜单\r\n    !this.isShow && this.lf.on(\"node:delete,edge:delete,node:drag,graph:transform\", this.listenDelete);\r\n\r\n    // 标记菜单为已显示\r\n    this.isShow = true;\r\n    // this.container.appendChild(this.__menuDOM);\r\n  }\r\n  /**\r\n   * 隐藏菜单\r\n   */\r\n  hideMenu () {\r\n    // this.__menuDOM.innerHTML = \"\";\r\n    this.__menuDOM.style.display = \"none\";\r\n    if (this.isShow) {\r\n      // this.container.removeChild(this.__menuDOM);\r\n    }\r\n\r\n    this.lf.off(\"node:delete,edge:delete,node:drag,graph:transform\",  this.listenDelete);\r\n\r\n    this.isShow = false;\r\n  }\r\n\r\n  listenDelete = () => {\r\n    this.hideMenu();\r\n  }\r\n}\r\n","export class CanvasHistory {\r\n  static pluginName = 'canvasHistory'\r\n\r\n  constructor({ lf }) {\r\n    this.lf = lf\r\n    this.historyStack = [] // 撤销栈\r\n    this.redoStack = [] // 重做栈\r\n    this.isProcessing = false // 防止递归调用\r\n    this.historyChangeCallbacks = [] // 历史记录变化回调\r\n    this._isSelectionDrop = false; // \r\n    this._isSelectionCompleted = false;\r\n\r\n  }\r\n\r\n  /**\r\n   * 创建状态快照\r\n   */\r\n  createSnapshot() {\r\n    const graphData = this.lf.getGraphData()\r\n    const selectElements = this.lf.getSelectElements(true)\r\n    let selectedElementIds = [...selectElements.nodes, ...selectElements.edges].map(item => item.id)\r\n    return {\r\n      nodes: JSON.parse(JSON.stringify(graphData.nodes || [])),\r\n      edges: JSON.parse(JSON.stringify(graphData.edges || [])),\r\n      selectedElementIds: selectedElementIds || [],\r\n      timestamp: Date.now(),\r\n      operation: 'snapshot'\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 保存当前状态到历史栈\r\n   */\r\n  saveCurrentState(operation = 'change') {\r\n    if (this.isProcessing) return\r\n\r\n    const snapshot = this.createSnapshot()\r\n    snapshot.operation = operation\r\n\r\n    // 添加到历史栈\r\n    this.historyStack.push(snapshot)\r\n\r\n    // 限制历史记录数量\r\n    if (this.historyStack.length > this.maxHistorySize) {\r\n      this.historyStack.shift()\r\n    }\r\n\r\n    // 新操作时清空重做栈\r\n    this.redoStack = []\r\n\r\n    // 触发回调\r\n    this.notifyHistoryChange()\r\n  }\r\n\r\n  /**\r\n   * 撤销操作\r\n   */\r\n  undo() {\r\n    if (this.historyStack.length <= 1 || this.isProcessing) return\r\n\r\n    // 当前状态移到重做栈\r\n    const currentState = this.historyStack.pop()\r\n    this.redoStack.push(currentState)\r\n\r\n    // 恢复到上一个状态\r\n    const previousState = this.historyStack[this.historyStack.length - 1]\r\n    this.restoreState(previousState)\r\n\r\n    this.notifyHistoryChange()\r\n  }\r\n\r\n  /**\r\n   * 重做操作\r\n   */\r\n  redo() {\r\n    if (this.redoStack.length === 0 || this.isProcessing) return\r\n\r\n    // 从重做栈取出状态\r\n    const stateToRestore = this.redoStack.pop()\r\n    this.historyStack.push(stateToRestore)\r\n\r\n    // 恢复到该状态\r\n    this.restoreState(stateToRestore)\r\n\r\n    this.notifyHistoryChange()\r\n  }\r\n\r\n  /**\r\n   * 恢复到指定状态\r\n   */\r\n  restoreState(state) {\r\n    this.isProcessing = true\r\n\r\n    try {\r\n      // 清空当前画布\r\n      this.lf.clearSelectElements()\r\n      this.lf.clearData()\r\n\r\n      state.nodes.forEach(item => {\r\n        item.width = item.properties.width\r\n        item.height = item.properties.height\r\n      })\r\n\r\n      this.lf.graphModel.graphDataToModel({\r\n        nodes: state.nodes || [],\r\n        edges: state.edges || [],\r\n      })\r\n      // 恢复节点\r\n      // if (state.nodes && state.nodes.length > 0) {\r\n      //   state.nodes.forEach(node => {\r\n      //     this.lf.addNode(node)\r\n      //   })\r\n      // }\r\n\r\n      // 恢复连线\r\n      // if (state.edges && state.edges.length > 0) {\r\n      //   state.edges.forEach(edge => {\r\n      //     this.lf.addEdge(edge)\r\n      //   })\r\n      // }\r\n\r\n      // 恢复选中状态\r\n      if (state.selectedElementIds && state.selectedElementIds.length > 0) {\r\n        state.selectedElementIds.forEach(id => {\r\n          this.lf.selectElementById(id, true)\r\n        })\r\n      } \r\n    } finally {\r\n      this.isProcessing = false\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 历史记录键盘事件处理 - 仅处理撤销/重做快捷键\r\n   */\r\n  handleHistoryKeyDown = (event) => {\r\n    // 检查是否在输入框中，避免冲突\r\n    if (this.isInputElement(event.target)) return\r\n\r\n    const { ctrlKey, key, metaKey } = event\r\n    const isCtrlOrCmd = ctrlKey || metaKey\r\n\r\n    // Ctrl+Z 撤销\r\n    if (isCtrlOrCmd && key.toLowerCase() === 'z' && !event.shiftKey) {\r\n      event.preventDefault()\r\n      event.stopPropagation()\r\n      this.undo()\r\n      return\r\n    }\r\n\r\n    // Ctrl+Y 或 Ctrl+Shift+Z 重做\r\n    if (isCtrlOrCmd && (key.toLowerCase() === 'y' || (key.toLowerCase() === 'z' && event.shiftKey))) {\r\n      event.preventDefault()\r\n      event.stopPropagation()\r\n      this.redo()\r\n      return\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 判断是否为输入框元素\r\n   */\r\n  isInputElement(element) {\r\n    const inputTypes = ['INPUT', 'TEXTAREA', 'SELECT']\r\n    \r\n    if (inputTypes.includes(element.tagName)) return true\r\n    \r\n    // 检查contenteditable属性\r\n    let current = element\r\n    while (current && current !== document.body) {\r\n      if (current.hasAttribute && current.hasAttribute('contenteditable')) {\r\n        return true\r\n      }\r\n      current = current.parentElement\r\n    }\r\n    \r\n    return false\r\n  }\r\n\r\n  /**\r\n   * 注册LogicFlow事件监听\r\n   */\r\n  registerLogicFlowEvents() {\r\n    // 只记录影响画布结构的事件\r\n    const eventsToRecord = [\r\n      'node:add',\r\n      // 'node:delete', // 改为自定义控制\r\n      'node:drop',\r\n      'edge:add',\r\n      // 'edge:delete', // 改为自定义控制\r\n      'edge:adjust',\r\n      // 'selection:drop'\r\n    ]\r\n\r\n    eventsToRecord.forEach(eventName => {\r\n      this.lf.on(eventName, () => {\r\n        this.saveCurrentState(eventName)\r\n      })\r\n    })\r\n\r\n    // selection:selected 也会触发 selection:drop，所以需要判断是否有选中元素\r\n    this.lf.on('selection:drop', () => {\r\n      this._isSelectionDrop = true;\r\n      this._isSelectionCompleted = false; \r\n      // 延时一下等待selection:selected后在执行onselectionDrop\r\n      setTimeout(() => {\r\n        this.onselectionDrop()\r\n      }, 20)\r\n    })\r\n\r\n    // 配合selection:drop用来区分是操作了选区还是移动了选区\r\n    this.lf.on('selection:selected', () => {\r\n      if(this._isSelectionDrop){\r\n        this._isSelectionDrop = false;\r\n        this._isSelectionCompleted = true;\r\n      }\r\n    })\r\n\r\n    // 画布单击\r\n    this.lf.on('blank:click', () => {\r\n      this.clearSelectedStatus()\r\n    })\r\n\r\n    // 元素点击\r\n    this.lf.on('element:click', () => {\r\n      this.clearSelectedStatus()\r\n    })\r\n  }\r\n\r\n  clearSelectedStatus(){\r\n    this._isSelectionDrop = false;\r\n    this._isSelectionCompleted = false;\r\n  }\r\n\r\n  onselectionDrop(){\r\n    if(!this._isSelectionCompleted){\r\n      this.saveCurrentState('selection:drop')\r\n    }\r\n\r\n    this._isSelectionDrop = false;\r\n  }\r\n\r\n  /**\r\n   * 初始化历史记录功能\r\n   */\r\n  // eslint-disable-next-line no-unused-vars\r\n  render(lf, toolOverlay, options) {\r\n    this.maxHistorySize = (options && options.maxHistorySize) || 50\r\n    // 注册历史记录相关键盘事件（仅撤销/重做）\r\n    document.addEventListener('keydown', this.handleHistoryKeyDown)\r\n\r\n    // 注册LogicFlow事件\r\n    this.registerLogicFlowEvents()\r\n  }\r\n\r\n  /**\r\n   * 从外部设置初始状态，通常在加载已有画布数据后调用\r\n   * @param {Object} graphData - LogicFlow的图数据\r\n   */\r\n  setInitialState(graphData) {\r\n    this.historyStack = []\r\n    this.redoStack = []\r\n\r\n    const snapshot = {\r\n      nodes: JSON.parse(JSON.stringify(graphData.nodes || [])),\r\n      edges: JSON.parse(JSON.stringify(graphData.edges || [])),\r\n      timestamp: Date.now(),\r\n      operation: 'init'\r\n    }\r\n\r\n    this.historyStack.push(snapshot)\r\n    this.notifyHistoryChange()\r\n  }\r\n\r\n  /**\r\n   * 检查是否可以撤销\r\n   */\r\n  canUndo() {\r\n    return this.historyStack.length > 1\r\n  }\r\n\r\n  /**\r\n   * 检查是否可以重做\r\n   */\r\n  canRedo() {\r\n    return this.redoStack.length > 0\r\n  }\r\n\r\n  /**\r\n   * 获取历史记录数量\r\n   */\r\n  getHistorySize() {\r\n    return Math.max(0, this.historyStack.length - 1)\r\n  }\r\n\r\n  /**\r\n   * 获取重做记录数量\r\n   */\r\n  getRedoSize() {\r\n    return this.redoStack.length\r\n  }\r\n\r\n  /**\r\n   * 注册历史记录变化回调\r\n   */\r\n  onHistoryChange(callback) {\r\n    if (typeof callback === 'function') {\r\n      this.historyChangeCallbacks.push(callback)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 通知历史记录变化\r\n   */\r\n  notifyHistoryChange() {\r\n    this.historyChangeCallbacks.forEach(callback => {\r\n      try {\r\n        // 构建历史记录详细信息\r\n        const historyDetails = this.historyStack.map((snapshot, index) => ({\r\n          index: index,\r\n          timestamp: snapshot.timestamp,\r\n          operation: snapshot.operation,\r\n          nodeCount: snapshot.nodes ? snapshot.nodes.length : 0,\r\n          edgeCount: snapshot.edges ? snapshot.edges.length : 0,\r\n          nodes: snapshot.nodes || [],\r\n          edges: snapshot.edges || [],\r\n          selectedElementIds: snapshot.selectedElementIds || []\r\n        }))\r\n\r\n        // 构建重做记录详细信息\r\n        const redoDetails = this.redoStack.map((snapshot, index) => ({\r\n          index: index,\r\n          timestamp: snapshot.timestamp,\r\n          operation: snapshot.operation,\r\n          nodeCount: snapshot.nodes ? snapshot.nodes.length : 0,\r\n          edgeCount: snapshot.edges ? snapshot.edges.length : 0,\r\n          nodes: snapshot.nodes || [],\r\n          edges: snapshot.edges || [],\r\n          selectedElementIds: snapshot.selectedElementIds || []\r\n        }))\r\n        // 获取当前画布状态\r\n        const currentHistoryIndex = this.historyStack.length - 1\r\n\r\n        callback({\r\n          canUndo: this.canUndo(),\r\n          canRedo: this.canRedo(),\r\n          historySize: this.getHistorySize(),\r\n          redoSize: this.getRedoSize(),\r\n          maxSize: this.maxHistorySize,\r\n          // 当前画布状态\r\n          currentCanvas: historyDetails[currentHistoryIndex],\r\n          // 历史记录详情\r\n          historyDetails: historyDetails,\r\n          // 重做记录详情\r\n          redoDetails: redoDetails,\r\n          // 当前历史索引（0为初始状态）\r\n          currentHistoryIndex: currentHistoryIndex\r\n        })\r\n      } catch (error) {\r\n        console.error('History change callback error:', error)\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 清空历史记录\r\n   */\r\n  clearHistory() {\r\n    this.historyStack = [this.createSnapshot()]\r\n    this.redoStack = []\r\n    this.notifyHistoryChange()\r\n  }\r\n\r\n  /**\r\n   * 替换上一个历史状态\r\n   */\r\n  replaceLastState(operation = 'replace') {\r\n    if (this.isProcessing) return\r\n\r\n    if (this.canUndo()) {\r\n      this.historyStack.pop()\r\n    }\r\n\r\n    // 不直接调用 saveCurrentState 是为了避免清空 redoStack\r\n    const snapshot = this.createSnapshot()\r\n    snapshot.operation = operation\r\n    this.historyStack.push(snapshot)\r\n\r\n    // 限制历史记录数量\r\n    if (this.historyStack.length > this.maxHistorySize) {\r\n      this.historyStack.shift()\r\n    }\r\n    \r\n    this.notifyHistoryChange()\r\n  }\r\n\r\n  /**\r\n   * 开始一个事务，暂停历史记录的自动保存\r\n   */\r\n  beginTransaction() {\r\n    this.isProcessing = true;\r\n  }\r\n\r\n  /**\r\n   * 提交一个事务，恢复历史记录的自动保存，并手动保存一次快照\r\n   * @param {string} operation - 本次操作的类型描述\r\n   */\r\n  commitTransaction(operation = 'commit') {\r\n    this.isProcessing = false;\r\n    this.saveCurrentState(operation);\r\n  }\r\n\r\n  /**\r\n   * 销毁插件\r\n   */\r\n  destroy() {\r\n    // 移除历史记录键盘事件监听\r\n    document.removeEventListener('keydown', this.handleHistoryKeyDown)\r\n    \r\n    // 清空回调\r\n    this.historyChangeCallbacks = []\r\n    \r\n    // 清空状态\r\n    this.historyStack = []\r\n    this.redoStack = []\r\n  }\r\n}","/**\r\n * 自定义键盘快捷键插件\r\n * @class CustomKeyboard\r\n * @property {string} pluginName - 插件名称\r\n * @property {object} lf - LogicFlow 实例\r\n * @property {boolean} isCtrlPressed - Ctrl 键是否被按下\r\n * @property {number} zoom - 当前缩放值\r\n * @property {object|null} clipboard - 剪贴板，用于存储复制的节点数据\r\n * @property {number} basePointX - 粘贴节点的 X 轴偏移量\r\n * @property {number} basePointY - 粘贴节点的 Y 轴偏移量\r\n */\r\nclass CustomKeyboard {\r\n  static pluginName = 'custom-keyboard'\r\n  constructor({ lf }) {\r\n    this.lf = lf\r\n    this.isCtrlPressed = false\r\n    this.zoom = 1\r\n    this.clipboard = null // 用于存储复制的节点数据\r\n    this.basePointX = 20 // 粘贴时节点的 X 轴基础偏移量\r\n    this.basePointY = 20 // 粘贴时节点的 Y 轴基础偏移量\r\n  }\r\n\r\n  /**\r\n   * 插件渲染方法，用于绑定事件监听器\r\n   */\r\n  render() {\r\n    this.lf.container.tabIndex = 0\r\n    this.lf.container.addEventListener('wheel', this.wheelEventListener, { passive: false })\r\n    document.addEventListener('keydown', this.keydownListener, { passive: false })\r\n    document.addEventListener('keyup', this.keyupListener, { passive: false })\r\n  }\r\n\r\n  /**\r\n   * 插件销毁方法，用于移除事件监听器\r\n   */\r\n  destroy() {\r\n    this.lf.container.removeEventListener('wheel', this.wheelEventListener)\r\n    document.removeEventListener('keydown', this.keydownListener)\r\n    document.removeEventListener('keyup', this.keyupListener)\r\n  }\r\n\r\n  /**\r\n   * 鼠标滚轮事件监听器\r\n   * - Shift + 滚轮: 画布横向滚动\r\n   * - Ctrl + 滚轮: 画布缩放\r\n   * @param {WheelEvent} e - 滚轮事件对象\r\n   */\r\n  wheelEventListener = (e) => {\r\n    // Shift + 滚轮: 画布横向滚动\r\n    if (e.shiftKey) {\r\n      e.preventDefault()\r\n      const transform = this.lf.getTransform()\r\n      let SCALE_X = transform.SCALE_X\r\n      let SCALE_Y = transform.SCALE_Y\r\n      if (e.deltaY > 0) {\r\n        this.lf.translate(-100 * SCALE_X, 100 * SCALE_Y)\r\n      } else {\r\n        this.lf.translate(100 * SCALE_X, -100 * SCALE_Y)\r\n      }\r\n      // Ctrl + 滚轮: 画布缩放\r\n    } else if (e.ctrlKey) {\r\n      e.preventDefault()\r\n      const { transformModel } = this.lf.graphModel\r\n      const [canvasX, canvasY] = transformModel.HtmlPointToCanvasPoint([e.clientX, e.clientY])\r\n      const transform = this.lf.getTransform()\r\n\r\n      this.zoom = transform.SCALE_X\r\n\r\n      if (e.deltaY < 0) {\r\n        // 放大\r\n        this.zoom += 0.04\r\n      } else {\r\n        // 缩小\r\n        this.zoom -= 0.04\r\n      }\r\n\r\n      this.lf.zoom(this.zoom, [canvasX, canvasY])\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 键盘按下事件监听器\r\n   * - Ctrl + C: 复制节点\r\n   * - Ctrl + V: 粘贴节点\r\n   * - Delete: 删除节点\r\n   * - Ctrl (长按): 激活套索选择\r\n   * @param {KeyboardEvent} e - 键盘事件对象\r\n   */\r\n  keydownListener = (e) => {\r\n    const key = e?.key?.toLowerCase()\r\n    const {\r\n      graphModel: { eventCenter }\r\n    } = this.lf\r\n\r\n    // 判断事件是否发生在画布上\r\n    const target = e.target\r\n    const isCanvas = target === document.body || this.lf.container.contains(target)\r\n\r\n    if (e.ctrlKey) {\r\n      // Ctrl + C: 复制节点\r\n      if (key === 'c') {\r\n        if (!isCanvas) return\r\n        \r\n        let selectedElements = this.lf.getSelectElements(true)\r\n        selectedElements = JSON.parse(JSON.stringify(selectedElements))\r\n\r\n        if(selectedElements.nodes.length === 0) return\r\n\r\n        // e.preventDefault()\r\n        // 去掉边的信息\r\n        selectedElements.edges = []\r\n\r\n        // 过滤掉开始节点和分组节点\r\n        const validNodes = selectedElements.nodes.filter(\r\n          (node) => {\r\n            return node.type !== 'start-node'\r\n              && node.type !== 'custom-group'\r\n              && node.properties.isTriggerNode != true\r\n          }\r\n        )\r\n\r\n        if (validNodes.length > 0) {\r\n          // 重置粘贴偏移量\r\n          this.basePointX = 20\r\n          this.basePointY = 20\r\n          // 计算选中节点的左上角基点\r\n          let basePoint = { x: Infinity, y: Infinity }\r\n          validNodes.forEach((node) => {\r\n            // 清空下一个节点的键值\r\n            node.id = '';\r\n            node.nodeSortKey = '';\r\n            node.properties.id = '';\r\n            node.properties.next_node_key = '';\r\n            node.properties.nodeSortKey = '';\r\n            node.properties.node_key = '';\r\n\r\n            if (!node.width && node.properties.width) {\r\n              node.width = node.properties.width\r\n            }\r\n            if (!node.height && node.properties.height) {\r\n              node.height = node.properties.height\r\n            }\r\n            if (node.x < basePoint.x) basePoint.x = node.x\r\n            if (node.y < basePoint.y) basePoint.y = node.y\r\n          })\r\n          // 将节点数据和基点存入剪贴板\r\n          this.clipboard = {\r\n            nodes: validNodes,\r\n            basePoint: basePoint\r\n          }\r\n        } else {\r\n          this.clipboard = null\r\n        }\r\n        return\r\n      }\r\n\r\n      // Ctrl + V: 粘贴节点\r\n      if (key === 'v') {\r\n        if (!isCanvas) return\r\n        if (!this.clipboard || this.clipboard.nodes.length === 0) return\r\n\r\n        // e.preventDefault()\r\n\r\n        if (this.clipboard && this.clipboard.nodes.length > 0) {\r\n          const pasteBasePoint = {\r\n            x: this.clipboard.basePoint.x + this.basePointX,\r\n            y: this.clipboard.basePoint.y + this.basePointY\r\n          }\r\n\r\n          // 触发自定义粘贴事件\r\n          eventCenter.emit('custom:paste', {\r\n            originalNodes: this.clipboard.nodes,\r\n            basePoint: this.clipboard.basePoint,\r\n            pasteBasePoint: pasteBasePoint\r\n          })\r\n\r\n          // 增加下一次粘贴的偏移量\r\n          this.basePointX += 20\r\n          this.basePointY += 20\r\n        }\r\n        return\r\n      }\r\n    }\r\n\r\n    // Delete: 删除节点\r\n    if (key === 'delete' && isCanvas) {\r\n      eventCenter.emit('custom:keyoard:delete')\r\n      return\r\n    }\r\n\r\n    // Ctrl (长按): 激活套索选择\r\n    if (e.ctrlKey && !this.isCtrlPressed) {\r\n      e.preventDefault()\r\n      this.isCtrlPressed = true\r\n      this.lf.extension.selectionSelect.openSelectionSelect()\r\n      this.lf.once('selection:selected', () => {\r\n        this.isCtrlPressed = false\r\n        this.lf.extension.selectionSelect.closeSelectionSelect()\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 键盘松开事件监听器\r\n   * - Ctrl: 关闭套索选择\r\n   * @param {KeyboardEvent} e - 键盘事件对象\r\n   */\r\n  keyupListener = (e) => {\r\n    // 松开 Ctrl 键，关闭套索选择\r\n    if (!e.ctrlKey && this.isCtrlPressed) {\r\n      e.preventDefault()\r\n      this.isCtrlPressed = false\r\n      this.lf.extension.selectionSelect.closeSelectionSelect()\r\n    }\r\n  }\r\n}\r\n\r\nexport { CustomKeyboard }\r\n","import { HtmlNode, HtmlNodeModel, h as flh } from '@logicflow/core'\r\nimport { createApp, h, nextTick } from 'vue'\r\nimport {generateUniqueId, jsonDecode} from '@/utils/index'\r\nimport {HasOutputPluginNames} from \"@/constants/plugin.js\";\r\nimport { allParentVariableNodeWhiteList } from '../util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.base-node')\r\n\r\nfunction transformArray(arr, parent) {\r\n  // 使用map处理数组并返回新的数组\r\n  return arr.map((item) => {\r\n    let node_id = parent ? parent.node_id : item.node_id\r\n    let node_name = parent ? parent.node_name : item.node_name\r\n    let node_type = parent? parent.node_type : item.node_type\r\n    let label = item.name || item.key\r\n    let text = parent ? `${parent.text}.${label}` : label // 路径\r\n    let children = item.children || item.subs || []\r\n\r\n    let value = ''\r\n    let original_value = ''\r\n\r\n    if(node_type == 1){\r\n      original_value = `global.${text}`\r\n    }else{\r\n      if(parent){\r\n        original_value = `${parent.original_value}.${item.key}`\r\n      }else{\r\n        original_value = `${node_id}.${item.key}`\r\n      }\r\n    }\r\n\r\n    value = `【${original_value}】`\r\n\r\n    let data = {\r\n      label: label,\r\n      value: value,\r\n      original_value: original_value,\r\n      node_id: node_id,\r\n      node_name: node_name,\r\n      node_type: node_type,\r\n      text: text,\r\n      key: item.key,\r\n      id: node_id,\r\n      typ: item.typ,\r\n      children: children || [],\r\n    }\r\n\r\n    // 递归处理子节点\r\n    if (data.children && data.children.length > 0) {\r\n      data.children = transformArray(data.children, data)\r\n    }\r\n\r\n    return data\r\n  })\r\n}\r\n\r\nexport class BaseVueNodeView extends HtmlNode {\r\n  constructor(props) {\r\n    super(props)\r\n  }\r\n\r\n  renderVue(VueNode, props) {\r\n    this.isMounted = false\r\n\r\n    this.r = h(VueNode, {\r\n      properties: props.model.getProperties(),\r\n      isSelected: props.model.isSelected,\r\n      isHovered: props.model.isHovered,\r\n    })\r\n\r\n    this.app = createApp({\r\n      render: () => this.r,\r\n      provide: () => ({\r\n        getNode: () => props.model,\r\n        getGraph: () => props.graphModel,\r\n        resetSize: () => {\r\n          if (this.r && this.r.el){\r\n            // 获取高度\r\n            let  height = this.r.el.clientHeight\r\n            let  width = this.r.el.clientWidth\r\n            props.model.properties = {\r\n              ...props.model.properties,\r\n              width: width,\r\n              height: height,\r\n            }\r\n\r\n            props.model.width = width\r\n            props.model.height = height\r\n            props.model._width = width\r\n            props.model._height = height\r\n\r\n            // 视图变化  边的线位置更新\r\n            props.model.refreshBranch()\r\n\r\n            props.graphModel.eventCenter.emit('custom:setData',  props.model)\r\n          }\r\n        },\r\n        updateAnchorList: (anchorList) => {\r\n          props.model.properties.anchorList = anchorList\r\n        },\r\n        setData: (data) => {\r\n          data.dataRaw = data.node_params;\r\n\r\n          nextTick(() => {\r\n            props.model.properties = {\r\n              ...props.model.properties,\r\n              ...data,\r\n            }\r\n            // 获取高度\r\n            let height = null\r\n\r\n            if (this.r && this.r.el){\r\n              height = this.r.el.clientHeight\r\n            }\r\n\r\n            props.model.height = height || data.height || props.model.properties.height\r\n            props.model._height = height || data.height || props.model.properties.height\r\n\r\n            props.model.refreshBranch()  // 视图变化  边的线位置更新\r\n\r\n            props.graphModel.eventCenter.emit('custom:setData',  props.model)\r\n          })\r\n        },\r\n        setTitle: (title) => {\r\n          props.model.properties.node_name = title;\r\n\r\n          props.graphModel.eventCenter.emit('custom:setNodeName',  {\r\n            node_name: title,\r\n            node_id: props.model.id,\r\n            node_type: props.model.type\r\n          })\r\n        }\r\n      }),\r\n      mounted: () => {\r\n        // console.log('vue node mounted')\r\n      },\r\n    })\r\n  }\r\n\r\n  shouldUpdate() {\r\n    const data = {\r\n      ...this.props.model.properties,\r\n      isSelected: this.props.model.isSelected,\r\n      isHovered: this.props.model.isHovered,\r\n    }\r\n    if (this.preProperties && this.preProperties === JSON.stringify(data)) return\r\n    this.preProperties = JSON.stringify(data)\r\n    return true\r\n  }\r\n\r\n  /**\r\n   * 1.1.7版本后支持在view中重写锚点形状。\r\n   * 重写锚点新增\r\n   */\r\n  getAnchorShape(anchorData) {\r\n    let edges = this.props.graphModel.getNodeEdges(this.props.model.id)\r\n    let sourceAnchorIds = edges.map((edge) => edge.sourceAnchorId)\r\n    let targetAnchorIds = edges.map((edge) => edge.targetAnchorId)\r\n    let anchorIsSelected = false\r\n\r\n    const { x, y, type } = anchorData\r\n    const radius = 10 // 圆形的半径\r\n\r\n    if (type === 'left') {\r\n      anchorIsSelected = targetAnchorIds.includes(anchorData.id)\r\n    } else {\r\n      anchorIsSelected = sourceAnchorIds.includes(anchorData.id)\r\n    }\r\n\r\n    // 圆形的SVG元素\r\n    const circle = flh('circle', {\r\n      className: `custom-anchor-circle`,\r\n      cx: x,\r\n      cy: y,\r\n      r: radius,\r\n      fill: '#fff', // 你可以根据需要设置颜色\r\n      stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n      'stroke-width': 2, // 你可以根据需要设置边框宽度\r\n    })\r\n\r\n    // 向右箭头的SVG路径元素\r\n    const arrowPath = flh(\r\n      'g',\r\n      {\r\n        className: `custom-anchor-arrow`,\r\n        transform: `translate(${x - radius - 2}, ${y - radius - 2})`,\r\n      },\r\n      [\r\n        flh('circle', {\r\n          cx: 12,\r\n          cy: 12,\r\n          r: radius,\r\n          fill: '#2475FC', // 你可以根据需要设置颜色\r\n          stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n          'stroke-width': 1, // 你可以根据需要设置边框宽度\r\n        }),\r\n        flh('path', {\r\n          d: `M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z`,\r\n          fill: '#fff', // 你可以根据需要设置箭头颜色\r\n        }),\r\n      ],\r\n    )\r\n\r\n    // 加号的SVG路径元素\r\n    const plusPath = flh(\r\n      'g',\r\n      {\r\n        className: `custom-anchor-plus ${anchorIsSelected ? 'anchor-hide' : ''}`,\r\n        transform: `translate(${x - radius - 2}, ${y - radius - 2})`,\r\n      },\r\n      [\r\n        flh('circle', {\r\n          cx: 12,\r\n          cy: 12,\r\n          r: radius,\r\n          fill: '#2475FC', // 你可以根据需要设置颜色\r\n          stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n          'stroke-width': 1, // 你可以根据需要设置边框宽度\r\n        }),\r\n        flh('line', {\r\n          x1: 12,\r\n          y1: 6,\r\n          x2: 12,\r\n          y2: 18,\r\n          strokeWidth: 2.4,\r\n          strokeLinecap: 'round',\r\n          strokeLinejoin: 'round',\r\n          stroke: '#fff', // 你可以根据需要设置箭头颜色\r\n        }),\r\n        flh('line', {\r\n          x1: 6,\r\n          y1: 12,\r\n          x2: 18,\r\n          y2: 12,\r\n          strokeWidth: 2.4,\r\n          strokeLinecap: 'round',\r\n          strokeLinejoin: 'round',\r\n          stroke: '#fff', // 你可以根据需要设置箭头颜色\r\n        }),\r\n      ],\r\n    )\r\n\r\n    // 创建一个SVG组元素来包含圆形和箭头\r\n    const group = flh(\r\n      'g',\r\n      {\r\n        id: anchorData.id,\r\n        className: `custom-anchor custom-anchor-${type} ${anchorIsSelected ? 'anchor-selected' : 'anchor-not-selected'}`,\r\n        onClick: (e) => {\r\n          e.stopPropagation()\r\n\r\n          const { graphModel, model } = this.props\r\n\r\n          if (type === 'right' && !anchorIsSelected) {\r\n            graphModel.eventCenter.emit('custom:showPopupMenu', { anchorData, model })\r\n          }\r\n        },\r\n      },\r\n      circle,\r\n      arrowPath,\r\n      plusPath,\r\n    )\r\n\r\n    return group\r\n  }\r\n\r\n  setHtml(rootEl) {\r\n    if(this.props.model.virtual){\r\n      return\r\n    }\r\n\r\n    if (!this.isMounted) {\r\n      this.isMounted = true\r\n\r\n      const node = document.createElement('div')\r\n\r\n      node.className = 'root-node'\r\n      node.id = 'node-'+this.props.model.id\r\n\r\n      rootEl.appendChild(node)\r\n\r\n      this.app.mount(node)\r\n    } else {\r\n      this.r.component.props.isSelected = this.props.model.isSelected\r\n      this.r.component.props.isHovered = this.props.model.isHovered\r\n      this.r.component.props.properties = this.props.model.getProperties()\r\n    }\r\n  }\r\n}\r\n\r\nexport class BaseVueNodeModel extends HtmlNodeModel {\r\n  createId() {\r\n    return generateUniqueId(this.type);\r\n  }\r\n\r\n  initNodeData(data) {\r\n    this.width = data.properties.width\r\n    this.height = data.properties.height\r\n    // 实现锚点的常显、常隐以及其他动作\r\n    // this.isShowAnchor = true;\r\n\r\n    super.initNodeData(data)\r\n  }\r\n\r\n  // 实现锚点的常显、常隐以及其他动作\r\n  // setIsShowAnchor( ){\r\n  //   this.isShowAnchor = true\r\n  // }\r\n\r\n  getAnchorLineStyle() {\r\n    const style = super.getAnchorLineStyle()\r\n    style.stroke = '#2475FC'\r\n    return style\r\n  }\r\n\r\n  getOutlineStyle() {\r\n    const style = super.getOutlineStyle()\r\n    style.stroke = 'none'\r\n    style.hover.stroke = 'none'\r\n\r\n    return style\r\n  }\r\n\r\n  getGlobalVariable() {\r\n    const { nodes } = this.graphModel\r\n\r\n    let startNode = nodes.find((node) => node.type === 'start-node')\r\n\r\n    if(!startNode){\r\n      return {\r\n        sys_global: [],\r\n        diy_global: [],\r\n        all_global: [],\r\n      }\r\n    }\r\n\r\n    let node_params = JSON.parse(startNode.properties.node_params)\r\n\r\n    let data = {\r\n      sys_global: node_params.start.sys_global,\r\n      diy_global: node_params.start.diy_global,\r\n      all_global: [...node_params.start.sys_global, ...node_params.start.diy_global],\r\n    }\r\n\r\n    return data\r\n  }\r\n\r\n  getAllParentVariable(){\r\n    const parentNodes = [];\r\n    const visited = new Set();\r\n    const edges = this.incoming.edges;\r\n    const { nodes } = this.graphModel\r\n\r\n    let startNode = nodes.find((node) => node.type === 'start-node')\r\n    // 插入起始节点(起始节点必传)\r\n    if(startNode){\r\n      visited.add(startNode.id);\r\n      parentNodes.push(startNode)\r\n    }\r\n\r\n    // 递归函数用于遍历父节点\r\n    const traverseParents = (edges) => {\r\n      for(let i=0;i<edges.length;i++){\r\n        let edge = edges[i]\r\n        let node = edge.sourceNode\r\n\r\n        if (visited.has(node.id)) continue;\r\n\r\n        visited.add(node.id);\r\n\r\n        if (allParentVariableNodeWhiteList.includes(node.type)){\r\n          if (node.type === 'zm-plugins-node') {\r\n            let nodeParams = jsonDecode(node.properties.node_params)\r\n            if (HasOutputPluginNames.includes(nodeParams.plugin.name) || nodeParams.plugin?.output_obj?.length) {\r\n              parentNodes.push(node);\r\n            }\r\n          } else {\r\n            parentNodes.push(node);\r\n          }\r\n        }\r\n\r\n        traverseParents(node.incoming.edges);\r\n      }\r\n    };\r\n\r\n    // 获取所有父节点\r\n    traverseParents(edges);\r\n\r\n    // 取出输出的变量\r\n    let variableArr = []\r\n\r\n    if(this.properties.loop_parent_key){\r\n      // 如果当前节点在分组里面的话  需要获取到分组的变量\r\n      let groupNodes = nodes.find((node) => node.id == this.properties.loop_parent_key)\r\n      if(groupNodes){\r\n        let hasNode = parentNodes.filter(item => item.id == this.properties.loop_parent_key).length > 0\r\n        if(!hasNode){\r\n          parentNodes.push(groupNodes)\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const node of parentNodes) {\r\n      // 如果节点类型既不是http-node也不是start-node，则跳过当前循环\r\n      if (!allParentVariableNodeWhiteList.includes(node.type)) {\r\n        continue;\r\n      }\r\n\r\n      let node_params = JSON.parse(node.properties.node_params)\r\n\r\n      let obj = {\r\n        label: node.properties.node_name,\r\n        value: node.id,\r\n        node_id: node.id,\r\n        node_type: node.properties.node_type,\r\n        typ: 'node',\r\n        children: [],\r\n        loop_parent_key: node.properties.loop_parent_key,\r\n      }\r\n\r\n      if(node.type === 'http-node'){\r\n        obj.children = node_params.curl.output\r\n      }\r\n\r\n      if(node.type === 'http-tool-node'){\r\n        obj.children = node_params.curl.output\r\n      }\r\n\r\n      if(node.type === 'zm-workflow-node'){\r\n        obj.children = node_params.workflow.output\r\n      }\r\n\r\n      if(node.type === 'voice-synthesis-node'){\r\n        obj.children = node_params.text_to_audio.output\r\n      }\r\n\r\n      if(node.type === 'voice-clone-node'){\r\n        obj.children = node_params.voice_clone.output\r\n      }\r\n\r\n      if(node.type === 'zm-plugins-node'){\r\n        obj.children = node_params.plugin.output || node_params.plugin.output_obj\r\n      }\r\n\r\n      if(node.type === 'code-run-node'){\r\n        obj.children = node_params.code_run.output\r\n      }\r\n\r\n      if(node.type === 'parameter-extraction-node'){\r\n        obj.children = node_params.params_extractor.output\r\n      }\r\n\r\n      if(node.type === 'qa-node'){\r\n        obj.children = node_params.question.outputs\r\n      }\r\n\r\n\r\n      if(node.type === 'start-node'){\r\n        obj.children = [...node_params.start.diy_global, ...node_params.start.sys_global]\r\n      }\r\n\r\n      if(node.type === 'custom-group'){\r\n        let loop_parent_key = this.properties.loop_parent_key   // 当前节点的父节点\r\n        if(loop_parent_key == node.id){\r\n          // 代表的是当前这个节点在循环节点中\r\n\r\n        obj.children = [\r\n          ...(node_params.loop?.intermediate_params || []),\r\n          ...(node_params.loop?.loop_arrays || [])\r\n        ]\r\n\r\n        }else{\r\n          // 代表当前节点不在循环节点中\r\n          obj.children = node_params.loop.output\r\n        }\r\n      }\r\n\r\n      if(node.type === 'batch-group'){\r\n        let loop_parent_key = this.properties.loop_parent_key   // 当前节点的父节点\r\n        if(loop_parent_key == node.id){\r\n          // 代表的是当前这个节点在批量执行节点中\r\n\r\n        obj.children = [\r\n          ...(node_params.batch?.batch_arrays || [])\r\n        ]\r\n\r\n        }else{\r\n          // 代表当前节点不在批量执行节点中\r\n          obj.children = node_params.batch.output\r\n        }\r\n      }\r\n\r\n      if(node.type === 'import-library-node'){\r\n        obj.children = node_params.library_import.outputs\r\n      }\r\n\r\n      if(node.type === 'json-node'){\r\n        obj.children = node_params.json_encode.output\r\n      }\r\n\r\n      if(node.type === 'json-reverse-node'){\r\n        obj.children = node_params.json_decode.output\r\n      }\r\n\r\n      if(node.type === 'select-data-node'){\r\n        obj.children = [{\r\n          key: 'output_list',\r\n          typ: 'array<object>',\r\n          name: 'output_list',\r\n          label: 'output_list'\r\n        },{\r\n          key: 'row_num',\r\n          typ: 'integer',\r\n          name: 'row_num',\r\n          label: 'row_num'\r\n        }]\r\n      }\r\n\r\n      if(node.type === 'knowledge-base-node'){\r\n        obj.children = [{\r\n          key: 'special.lib_paragraph_list',\r\n          typ: 'string',\r\n          name: t('var_knowledge_base_reference'),\r\n          label: t('var_knowledge_base_reference')\r\n        }]\r\n      }\r\n\r\n      if(node.type === 'ai-dialogue-node'){\r\n        obj.children = [{\r\n          key: 'special.llm_reply_content',\r\n          typ: 'string',\r\n          name: t('var_ai_reply_content'),\r\n          label: t('var_ai_reply_content'),\r\n        }]\r\n      }\r\n\r\n      if(node.type === 'specify-reply-node'){\r\n        obj.children = [{\r\n          key: 'special.llm_reply_content',\r\n          typ: 'string',\r\n          name: t('var_message_content'),\r\n          label: t('var_message_content'),\r\n        }]\r\n      }\r\n\r\n      if (node.type === 'immediately-reply-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.llm_reply_content',\r\n            typ: 'string',\r\n            name: t('var_message_content'),\r\n            label: t('var_message_content')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if(node.type === 'problem-optimization-node'){\r\n        obj.children = [{\r\n          key: 'special.question_optimize_reply_content',\r\n          typ: 'string',\r\n          name: t('var_question_optimization_result'),\r\n          label: t('var_question_optimization_result'),\r\n        }]\r\n      }\r\n\r\n      if(node.type === 'mcp-node'){\r\n        obj.children = [{\r\n          key: 'special.mcp_reply_content',\r\n          typ: 'string',\r\n          name: 'text',\r\n          label: t('var_tool_generated_content'),\r\n        }]\r\n      }\r\n      if(node.type === 'image-generation-node'){\r\n        let image_num = node_params.image_generation.image_num\r\n        if(image_num > 0){\r\n          let list = []\r\n          for (let i = 0; i < +image_num; i++) {\r\n            let letter = String.fromCharCode('a'.charCodeAt(0) + i)\r\n            list.push({\r\n              key: `picture_url_${letter}`,\r\n              typ: 'string',\r\n              name: `picture_url_${letter}`,\r\n              label: `picture_url_${letter}`,\r\n            })\r\n          }\r\n          obj.children = list\r\n        }\r\n      }\r\n\r\n      obj.children = Array.isArray(obj.children) ?  obj.children : []\r\n      obj.children.forEach(variable => {\r\n        variable.node_id = node.id\r\n        variable.node_name = node.properties.node_name\r\n        variable.node_type = node.properties.node_type\r\n      })\r\n\r\n      obj.children = transformArray(obj.children, null)\r\n\r\n      variableArr.push(obj)\r\n    }\r\n\r\n    return variableArr;\r\n  }\r\n\r\n  getTriggerNodes(){\r\n    const { nodes } = this.graphModel\r\n\r\n    let triggerNodes = nodes.filter((node) => node.properties.isTriggerNode)\r\n\r\n    return triggerNodes;\r\n  }\r\n\r\n  refreshBranch() {\r\n    // 更新节点连接边的path\r\n    this.incoming.edges.forEach((edge) => {\r\n      // 调用自定义的更新方案\r\n      edge.updatePathByAnchor()\r\n    })\r\n    this.outgoing.edges.forEach((edge) => {\r\n      edge.updatePathByAnchor()\r\n    })\r\n  }\r\n}\r\n","export default \"data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8%205C8.55228%205%209%204.55228%209%204C9%203.44772%208.55228%203%208%203C7.44772%203%207%203.44772%207%204C7%204.55228%207.44772%205%208%205Z'%20fill='%23595959'/%3e%3cpath%20d='M8%209C8.55228%209%209%208.55228%209%208C9%207.44772%208.55228%207%208%207C7.44772%207%207%207.44772%207%208C7%208.55228%207.44772%209%208%209Z'%20fill='%23595959'/%3e%3cpath%20d='M8%2012.666C8.55228%2012.666%209%2012.2183%209%2011.666C9%2011.1137%208.55228%2010.666%208%2010.666C7.44772%2010.666%207%2011.1137%207%2011.666C7%2012.2183%207.44772%2012.666%208%2012.666Z'%20fill='%23595959'/%3e%3c/svg%3e\"","<template>\r\n  <div\r\n    class=\"node-common-wrapper\"\r\n    :class=\"[`node-common-wrapper_${iconName}`]\"\r\n    :data-node-name=\"title\"\r\n    :data-node-type=\"node_type\"\r\n  >\r\n    <div class=\"node-common\" :class=\"{ isHovered: isHovered, isSelected: isSelected }\">\r\n      <div class=\"node-header\" :style=\"{ background: properties.node_header_bg_color || 'none' }\">\r\n        <div class=\"node-header-left\">\r\n          <span class=\"node-icon\" v-if=\"iconUrl || iconName\">\r\n            <img :src=\"iconUrl || getImgUrl(iconName)\" alt=\"\" />\r\n          </span>\r\n          <span class=\"node-title\">{{ title }}</span>\r\n          <!-- <a-input\r\n            v-else\r\n            size=\"small\"\r\n            class=\"node-title-input\"\r\n            :value=\"title\"\r\n            @input=\"updateTitle($event.target.value)\"\r\n          ></a-input> -->\r\n        </div>\r\n        <div>\r\n          <div class=\"node-menu-wrapper\" v-if=\"!hideMenus\">\r\n            <div class=\"node-menu-btn\" @click.stop=\"showMenu\">\r\n              <img\r\n                class=\"btn-icon\"\r\n                src=\"../../../../assets/img/workflow/node-menu-btn.svg\"\r\n                alt=\"\"\r\n              />\r\n            </div>\r\n\r\n            <div class=\"node-menus\" v-show=\"isShowMenu\">\r\n              <div\r\n                class=\"node-menu\"\r\n                v-for=\"item in allMenus\"\r\n                :key=\"item.key\"\r\n                @click.stop=\"handleMenu(item)\"\r\n              >\r\n                {{ t(item.name) }}\r\n              </div>\r\n\r\n              <div class=\"node-menu del-btn\" @click.stop=\"handleDelete(item)\">{{ t('btn_delete') }}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"node-body\">\r\n        <slot></slot>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getImageUrl } from '../util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'NodeCommon',\r\n  inject: ['setTitle',  'getNode',  'getGraph'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    iconUrl: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    iconName: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    node_type: {\r\n      default: ''\r\n    },\r\n    nodeKey: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    value: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    menus: {\r\n      type: Array,\r\n      default() {\r\n        return []\r\n      }\r\n    },\r\n    hideMenus: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    isSelected: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    isHovered: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      isShowMenu: false,\r\n      localMenus: [],\r\n      node_header_bg_color: ''\r\n    }\r\n  },\r\n  computed: {\r\n    allMenus() {\r\n      return [...this.menus, ...this.localMenus]\r\n    },\r\n    t() {\r\n      return useI18n('views.workflow.components.nodes.base-node').t\r\n    }\r\n  },\r\n  mounted() {\r\n    document.addEventListener('click', this.documentClick)\r\n  },\r\n  beforeUnmount() {\r\n    document.removeEventListener('click', this.documentClick)\r\n  },\r\n  methods: {\r\n    handleMenu(item) {\r\n      this.isShowMenu = false\r\n      this.$emit('handleMenu', item)\r\n    },\r\n    showMenu() {\r\n      this.isShowMenu = !this.isShowMenu\r\n    },\r\n    handleDelete(){\r\n      this.isShowMenu = false\r\n      let node = this.getNode()\r\n      this.getGraph().eventCenter.emit('custom:node:delete', node)\r\n    },\r\n    // 点击菜单以外的地方，隐藏菜单\r\n    documentClick(e) {\r\n      if (this.isShowMenu) {\r\n        const menus = this.$el.querySelector('.node-menus')\r\n        if (\r\n          !menus.contains(e.target) &&\r\n          e.target !== this.$el.querySelector('.node-menu-btn') &&\r\n          e.target !== this.$el.querySelector('.btn-icon')\r\n        ) {\r\n          this.isShowMenu = false\r\n        }\r\n      }\r\n    },\r\n    getImgUrl() {\r\n      return getImageUrl(this.node_type)\r\n    },\r\n    updateTitle(newValue) {\r\n      this.setTitle(newValue)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.node-common {\r\n  position: relative;\r\n  width: 100%;\r\n  border-radius: 8px;\r\n  background: #fff;\r\n  box-sizing: border-box;\r\n  cursor: pointer;\r\n\r\n  .node-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 16px 16px 16px 16px;\r\n    border-radius: 8px 8px 0 0;\r\n  }\r\n  .node-title {\r\n    height: 24px;\r\n    line-height: 24px;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    color: var(--wf-color-text-1);\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n\r\n  .node-header-left {\r\n    flex: 1;\r\n    display: flex;\r\n    align-items: center;\r\n    overflow: hidden;\r\n  }\r\n  .node-icon {\r\n    display: flex;\r\n    margin-right: 8px;\r\n    img {\r\n      width: 20px;\r\n      height: 20px;\r\n    }\r\n  }\r\n  .node-menu-wrapper {\r\n    position: relative;\r\n    .node-menu-btn {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      width: 24px;\r\n      height: 24px;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n\r\n      &:hover {\r\n        background-color: #e4e6eb;\r\n      }\r\n\r\n      .btn-icon {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n    .node-menus {\r\n      position: absolute;\r\n      top: 26px;\r\n      right: 4px;\r\n      padding: 2px;\r\n      z-index: 100;\r\n      border-radius: 6px;\r\n      background: #fff;\r\n      box-shadow:\r\n        0 6px 30px 5px #0000000d,\r\n        0 16px 24px 2px #0000000a,\r\n        0 8px 10px -5px #00000014;\r\n      .node-menu {\r\n        height: 32px;\r\n        line-height: 32px;\r\n        padding: 0 16px;\r\n        font-size: 14px;\r\n        font-weight: 400;\r\n        color: #595959;\r\n        white-space: nowrap;\r\n        cursor: pointer;\r\n\r\n        &:hover {\r\n          border-radius: 6px;\r\n          background-color: #e4e6eb;\r\n        }\r\n      }\r\n\r\n      .del-btn {\r\n        color: #fb363f;\r\n      }\r\n    }\r\n  }\r\n\r\n  .node-title-input {\r\n    border-width: 0;\r\n    color: #262626;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    margin-right: 8px;\r\n  }\r\n  .node-title-input:hover {\r\n    border-width: 1px;\r\n  }\r\n\r\n  .node-body{\r\n    padding: 0 16px 16px 16px;\r\n  }\r\n}\r\n\r\n.node-common.isHovered {\r\n  &::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    border-radius: 8px;\r\n    border: 1px solid #2475fc;\r\n    pointer-events: none;\r\n  }\r\n}\r\n.node-common.isSelected {\r\n  &::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    border-radius: 8px;\r\n    border: 2px solid #2475fc;\r\n    pointer-events: none;\r\n  }\r\n}\r\n\r\n.node-common-wrapper.node-common-wrapper_explain-node {\r\n  .node-icon {\r\n    display: none;\r\n  }\r\n  .node-title-input {\r\n    padding-left: 0;\r\n    font-size: 12px;\r\n    color: #7a8699;\r\n    font-weight: 400;\r\n    background: #ffefd6;\r\n  }\r\n  .node-common {\r\n    background: #ffefd6;\r\n    padding: 16px;\r\n  }\r\n  .node-common.isHovered {\r\n    &::before {\r\n      border: 1px solid #bfbfbf;\r\n    }\r\n  }\r\n  .node-common.isSelected {\r\n    &::before {\r\n      border: 2px solid #f90;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.start-node {\r\n  position: relative;\r\n  padding-top: 8px;\r\n  .node-desc {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n\r\n  .start-node-options {\r\n    display: flex;\r\n    gap: 4px;\r\n    .options-title {\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n    .options-list {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n    .options-item {\r\n      display: flex;\r\n      align-items: center;\r\n      height: 22px;\r\n      padding: 2px 2px 2px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &.is-required .option-label::before {\r\n        vertical-align: middle;\r\n        content: '*';\r\n        color: #fb363f;\r\n        margin-right: 2px;\r\n      }\r\n\r\n      .option-label {\r\n        color: var(--wf-color-text-3);\r\n        font-size: 12px;\r\n        margin-right: 4px;\r\n      }\r\n\r\n      .option-type {\r\n        height: 18px;\r\n        line-height: 18px;\r\n        padding: 0 8px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        background-color: #e4e6eb;\r\n        color: var(--wf-color-text-3);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=properties\r\n    :title=\"properties.node_name\"\r\n    :icon-url=\"properties.node_icon\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"start-node\">\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('label_output') }}</div>\r\n        <div class=\"options-list\">\r\n          <div\r\n            class=\"options-item\"\r\n            :class=\"{ 'is-required': item.required }\"\r\n            v-for=\"item in options\"\r\n            :key=\"item.key\"\r\n          >\r\n            <div class=\"option-label\">{{ item.key }}</div>\r\n            <div class=\"option-type\">{{ item.typ }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'StartNode',\r\n  components: {\r\n    NodeCommon\r\n  },\r\n  inject: ['resetSize'],\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.session-trigger-node.index')\r\n    return { t }\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  data() {\r\n    return {\r\n      outputs: [],\r\n      show: false,\r\n    }\r\n  },\r\n  computed: {\r\n    options() {\r\n      return [...this.outputs]\r\n    }\r\n  },\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        const newDataRaw =  newVal.node_params || '{}'\r\n        const oldDataRaw = oldVal.node_params || '{}'\r\n        \r\n        if(newDataRaw != oldDataRaw) { \r\n          this.reset()\r\n        }\r\n      },\r\n      deep: true,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.reset()\r\n  },\r\n  methods: {\r\n    reset() {\r\n      if(!this.properties || !this.properties.node_params) {\r\n        return\r\n      }\r\n      \r\n      let node_params = JSON.parse(this.properties.node_params)\r\n\r\n      this.outputs = node_params.trigger.outputs\r\n\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    // this.width = 420\r\n    // this.height = 102\r\n    // 当节点作为边的起始节点（source）时的校验规则\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        isHovered,\r\n        isSelected,\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'session-trigger-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.start-node {\r\n  position: relative;\r\n  padding-top: 8px;\r\n  .node-desc {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n\r\n  .start-node-options {\r\n    display: flex;\r\n    gap: 4px;\r\n    .options-title {\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n    .options-list {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n    .options-item {\r\n      display: flex;\r\n      align-items: center;\r\n      height: 22px;\r\n      padding: 2px 2px 2px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &.is-required .option-label::before {\r\n        vertical-align: middle;\r\n        content: '*';\r\n        color: #fb363f;\r\n        margin-right: 2px;\r\n      }\r\n\r\n      .option-label {\r\n        color: var(--wf-color-text-3);\r\n        font-size: 12px;\r\n        margin-right: 4px;\r\n      }\r\n\r\n      .option-type {\r\n        height: 18px;\r\n        line-height: 18px;\r\n        padding: 0 8px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        background-color: #e4e6eb;\r\n        color: var(--wf-color-text-3);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    :hide-menus=\"true\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"start-node\">\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('output') }}</div>\r\n        <div class=\"options-list\">\r\n          <div\r\n            class=\"options-item\"\r\n            :class=\"{ 'is-required': item.required }\"\r\n            v-for=\"item in options\"\r\n            :key=\"item.key\"\r\n          >\r\n            <div class=\"option-label\">{{ item.key }}</div>\r\n            <div class=\"option-type\">{{ item.typ }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'StartNode',\r\n  components: {\r\n    NodeCommon\r\n  },\r\n  inject: ['resetSize', 'setData', 'getGraph', 'getNode'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.start-node')\r\n    return { t }\r\n  },\r\n  data() {\r\n    return {\r\n      sys_global: [],\r\n      diy_global: [],\r\n      trigger_list: [],\r\n      show: false,\r\n    }\r\n  },\r\n  computed: {\r\n    options() {\r\n      return [...this.sys_global, ...this.diy_global]\r\n    },\r\n  },\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        const newDataRaw =  newVal.node_params || '{}'\r\n        const oldDataRaw = oldVal.node_params || '{}'\r\n        \r\n        if(newDataRaw != oldDataRaw) { \r\n          this.reset()\r\n        }\r\n      },\r\n      deep: true,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.reset()\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.on('custom:trigger-add', this.onTriggerAdd)\r\n    graphModel.eventCenter.on('custom:trigger-change', this.onTriggerChange)\r\n  },\r\n  beforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:trigger-change', this.onTriggerChange)\r\n    graphModel.eventCenter.off('custom:trigger-add', this.onTriggerAdd)\r\n  },\r\n  methods: {\r\n    reset() {\r\n      if(!this.properties || !this.properties.node_params) {\r\n        return\r\n      }\r\n      \r\n      let node_params = JSON.parse(this.properties.node_params)\r\n\r\n      this.sys_global = node_params.start.sys_global\r\n      this.diy_global = node_params.start.diy_global\r\n      this.trigger_list = node_params.start.trigger_list\r\n\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n    update(){\r\n      let node_params = JSON.parse(this.properties.node_params)\r\n\r\n      node_params.start.sys_global = this.sys_global\r\n      node_params.start.diy_global = this.diy_global\r\n      node_params.start.trigger_list = this.trigger_list\r\n\r\n      this.setData({\r\n        node_params: JSON.stringify(node_params)\r\n      })\r\n    },\r\n    onTriggerAdd(nodeData){\r\n      const { trigger } = JSON.parse(nodeData.properties.node_params)\r\n      this.trigger_list.push(trigger)\r\n      // 合并outputs到diy_global\r\n      const { outputs } = trigger\r\n      \r\n      // 使用Map提高查找效率，避免每次都要遍历整个数组\r\n      const diyGlobalMap = new Map(this.diy_global.map((item, index) => [item.key, { item, index }]));\r\n      \r\n      // 处理outputs合并到diy_global的逻辑\r\n      if (outputs && Array.isArray(outputs)) {\r\n        outputs.forEach(output => {\r\n          if (diyGlobalMap.has(output.key)) {\r\n            // 如果找到了同名的key，进行覆盖处理\r\n            const { index } = diyGlobalMap.get(output.key);\r\n            this.diy_global[index] = output;\r\n          } else {\r\n            // 如果没有找到同名的key，则添加新的项\r\n            this.diy_global.push(output);\r\n          }\r\n        });\r\n      }\r\n\r\n      this.update();\r\n    },\r\n    onTriggerChange(data){\r\n      const nodeMode = this.getNode()\r\n      const triggerNodes = nodeMode.getTriggerNodes()\r\n\r\n      const list = []\r\n      triggerNodes.forEach(node => { \r\n        const node_params = JSON.parse(node.properties.node_params)\r\n        const triggerData = node_params.trigger || null;\r\n\r\n        if(triggerData) { \r\n          triggerData.trigger_name = node.properties.node_name\r\n          list.push(triggerData)\r\n        }\r\n      })\r\n      \r\n      this.trigger_list = list;\r\n\r\n      this.update()\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    // this.width = 420\r\n    // this.height = 102\r\n    \r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    const allowedNodeTypes = ['session-trigger-node']\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left' || allowedNodeTypes.includes(sourceNode.type)\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'anchor_left',\r\n        isHovered,\r\n        isSelected,\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        isHovered,\r\n        isSelected,\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'start-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped></style>\r\n\r\n<template>\r\n  <span>{{ text }}</span>\r\n</template>\r\n\r\n<script setup>\r\nimport { storeToRefs } from 'pinia'\r\nimport { ref, watch } from 'vue'\r\nimport { useModelStore } from '@/stores/modules/model'\r\nimport { getModelOptionsList } from '@/components/model-select/index.js'\r\n\r\nconst props = defineProps({\r\n  useModel: {\r\n    type: [String, Number],\r\n    default: ''\r\n  },\r\n  modelConfigId: {\r\n    type: [String, Number],\r\n    default: ''\r\n  }\r\n})\r\n\r\nconst modelStore = useModelStore()\r\nconst { allModelList } = storeToRefs(modelStore)\r\n\r\nlet modelList = getModelOptionsList(allModelList.value).newList\r\n\r\nconst text = ref('')\r\n\r\nconst setText = () => {\r\n  if (!props.useModel) {\r\n    text.value = ''\r\n    return\r\n  }\r\n\r\n  for (const item of modelList) {\r\n    if (item.children) {\r\n      for (const child of item.children) {\r\n        if (props.useModel == child.name && props.modelConfigId == item.id) {\r\n          text.value = child.show_model_name || child.deployment_name || child.name\r\n          return // Exit loops once found\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => [props.useModel, props.modelConfigId],\r\n  () => {\r\n    setText()\r\n  },\r\n  {\r\n    immediate: true\r\n  }\r\n)\r\n</script>\r\n","<style lang=\"less\" scoped>\r\n\r\n</style>\r\n\r\n<template>\r\n  <span>{{ text }}</span>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, inject, watch } from 'vue'\r\n\r\nconst props = defineProps({\r\n  value: {\r\n    type: Array,\r\n    default: () => [],\r\n  },\r\n})\r\n\r\nconst getNode = inject('getNode')\r\n\r\nconst variableOptionsSelect = ref([])\r\nconst text = ref('')\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptionsSelect.value = handleOptions(list)\r\n}\r\n\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\n// 递归查找函数，根据value在树结构中查找对应的label\r\nconst findLabelByValue = (options, value) => {\r\n  for (const item of options) {\r\n    if (item.value === value) {\r\n      return item.label\r\n    }\r\n    if (item.children && item.children.length > 0) {\r\n      const foundLabel = findLabelByValue(item.children, value)\r\n      if (foundLabel) {\r\n        return foundLabel\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nconst setText = () => {\r\n  if (!props.value || props.value.length === 0) {\r\n    return ''\r\n  }\r\n\r\n  getOptions()\r\n\r\n  let labelArr = []\r\n\r\n  // 根据valueArr中的每个值，递归查找对应的label\r\n  props.value.forEach((value) => {\r\n    const label = findLabelByValue(variableOptionsSelect.value, value)\r\n    if (label) {\r\n      labelArr.push(label)\r\n    }\r\n  })\r\n\r\n  // 返回拼接后的label字符串，用\".\"连接\r\n  text.value = labelArr.join('/')\r\n}\r\n\r\nconst refresh = () => {\r\n  setText()\r\n}\r\n\r\nwatch(() => props.value, () => {\r\n setText()\r\n}, {\r\n  immediate: true,\r\n})\r\n\r\ndefineExpose({\r\n  refresh,\r\n})\r\n</script>\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_user_question') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">\r\n                <user-question-text ref=\"questionTextRef\" :value=\"formState.question_value\" />\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_llm_model') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">\r\n                <model-name-text :useModel=\"formState.use_model\" :modelConfigId=\"formState.model_config_id\" />\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_question_category') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"category-list\">\r\n              <div class=\"field-value category-value\" v-for=\"item in formState.categorys\" :key=\"item.key\">\r\n                <span>{{ item.category }}</span>\r\n              </div>\r\n\r\n              <div class=\"field-value category-value\">\r\n                <span>{{ t('label_default_category') }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { getUuid } from '@/utils/index'\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport NodeCommon from '../base-node.vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport ModelNameText from '../model-name-text.vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.question-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- Store ---\r\nconst robotStore = useRobotStore()\r\nconst { modelList } = storeToRefs(robotStore)\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  model_config_id: void 0,\r\n  use_model: void 0,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  question_value: [],\r\n  enable_thinking: false,\r\n  categorys: []\r\n})\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val && typeof val === 'string') {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  } else if (val && typeof val === 'object' && val.length === 2) {\r\n    return val\r\n  }\r\n\r\n  return ['global', 'question']\r\n}\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let cate = {}\r\n  try {\r\n    cate = JSON.parse(dataRaw).cate || {}\r\n  } catch (e) {\r\n    cate = {}\r\n  }\r\n\r\n  cate = JSON.parse(JSON.stringify(cate))\r\n\r\n  for (let key in cate) {\r\n    if(key === 'question_value'){\r\n      formState.question_value = formatQuestionValue(cate['question_value'])\r\n    }else if (key == 'categorys') {\r\n      if (cate.categorys && cate.categorys.length > 0) {\r\n        let items = cate.categorys.map((item) => {\r\n          return {\r\n            ...item,\r\n          }\r\n        })\r\n        formState[key] = items\r\n      } else {\r\n        formState[key] = [\r\n          {\r\n            category: '',\r\n            next_node_key: '',\r\n            key: getUuid(16)\r\n          }\r\n        ]\r\n      }\r\n    } else {\r\n      formState[key] = cate[key]\r\n    }\r\n  }\r\n\r\n  if (!formState.model_config_id && modelList.value.length > 0) {\r\n    formState.model_config_id = modelList.value[0].id\r\n    formState.use_model = modelList.value[0].children[0].name\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const model_config_id = formState.model_config_id  ? +formState.model_config_id : formState.model_config_id;\r\n  const data = JSON.stringify({\r\n    cate: {\r\n      ...formState,\r\n      question_value: formState.question_value.join('.'),\r\n      model_config_id: model_config_id\r\n    }\r\n  })\r\n  \r\n  setData({\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nwatch(() => props.properties, (newVal, oldVal) => {\r\n  const newDataRaw = newVal.dataRaw || newVal.node_params || '{}'\r\n  const oldDataRaw = oldVal.dataRaw || oldVal.node_params || '{}'\r\n  \r\n  if(newDataRaw != oldDataRaw) { \r\n    reset()\r\n  }\r\n}, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  update()\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n})\r\n</script>\r\n\r\n\r\n<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n    .category-list {\r\n      width: 100%;\r\n      overflow: hidden;\r\n    }\r\n    .field-value {\r\n      width: 100%;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      height: 24px;\r\n      margin-bottom: 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n      .category-value{\r\n        width: 100%;\r\n      }\r\n\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nimport { getQuestionNodeAnchor } from '../../util.js'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n  getAnchorPos() {\r\n    let anchorListPos = getQuestionNodeAnchor(this.properties)\r\n\r\n    return anchorListPos\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      }\r\n      // {\r\n      //   x: x + width / 2,\r\n      //   y: y - height / 2 + 24,\r\n      //   id: nodeSortKey + '-anchor_right',\r\n      //   type: 'right',\r\n      //   nodeId: id\r\n      // }\r\n    ]\r\n\r\n    let anchorListPos = this.getAnchorPos()\r\n    let y0 = y - height / 2\r\n\r\n    for (let i = 0; i < anchorListPos.length; i++) {\r\n      defaultAnchor.push({\r\n        id: anchorListPos[i].id,\r\n        x: x + width / 2,\r\n        y: (y0 + 132) + i * 32 ,\r\n        type: 'right',\r\n        nodeId: id\r\n      })\r\n    }\r\n\r\n    defaultAnchor.push({\r\n      id: nodeSortKey + '-anchor_right',\r\n      x: x + width / 2,\r\n      y: height / 2 + y - 28,\r\n      type: 'right',\r\n      nodeId: id\r\n    })\r\n\r\n    return defaultAnchor\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'question-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.question-node {\r\n  .node-desc {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n\r\n  .q-title {\r\n    line-height: 22px;\r\n    padding: 8px 12px;\r\n    margin-top: 12px;\r\n    border-radius: 4px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n    background-color: #f2f4f7;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    @handleMenu=\"handleMenu\"\r\n  >\r\n    <div class=\"question-node\">\r\n      <div class=\"node-desc\">{{ properties.content || t('msg_click_to_set_content') }}</div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'QuestionNode',\r\n  components: {\r\n    NodeCommon,\r\n  },\r\n  inject: ['getNode', 'getGraph'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      },\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false },\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.action-node.index')\r\n    return { t }\r\n  },\r\n  data() {\r\n    return {\r\n      menus: [],\r\n    }\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    handleMenu(item) {\r\n      if (item.key === 'delete') {\r\n        let node = this.getNode()\r\n\r\n        this.getGraph().deleteNode(node.id)\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n\r\n    if (this.properties.node_type != 5) {\r\n      anchors.push({\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      })\r\n    }\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'action-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<template>\r\n  <span ref=\"JMention\"  class=\"j-mention\"  :class=\"['type-'+type]\" ></span>\r\n</template>\r\n\r\n<script>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\n// 把树状的options抓换成编排的数组\r\nconst getTreeOptions = (options) => {\r\n  let result = [];\r\n  options.forEach((opt) => {\r\n    if (opt.children && opt.children.length > 0) {\r\n      result.push(...getTreeOptions(opt.children));\r\n    } else {\r\n      result.push(opt);\r\n    }\r\n  });\r\n  return result;\r\n}\r\n\r\nexport default {\r\n  name: \"JMention\",\r\n  inject: [],\r\n  emits: [\"input\", 'change', \"update:selectedList\", \"focus\", 'open', 'resize'],\r\n  props: {\r\n    type: {\r\n      type: String,\r\n      default: \"input\", // input, textarea\r\n      validator(value) {\r\n        return [\"input\", \"textarea\"].includes(value);\r\n      },\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: \"ph_input\",\r\n    },\r\n    defaultValue: {\r\n      type: [String, Number],\r\n      default: \"\",\r\n    },\r\n    options: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    defaultSelectedList: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    canRepeat: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    isContain: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    inputStyle: {\r\n      type: String,\r\n      default: \"\",\r\n    }\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.at-input.at-text')\r\n    return {\r\n      t\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      timer: null,\r\n      showDropdown: false,\r\n      showAtList: false,\r\n      positionStyle: \"\",\r\n      chooseIndex: 0,\r\n      selectedList: [],\r\n      selectedIdSet: new Set(),\r\n      showOptions: [],\r\n      atText: \"\",\r\n      localValue: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    computedPlaceholder() {\r\n      return this.placeholder === 'ph_input' ? this.t('ph_input') : this.placeholder\r\n    }\r\n  },\r\n  watch: {\r\n    defaultValue(val){\r\n      if(val != this.localValue){\r\n        this.refresh()\r\n      }\r\n    },\r\n    chooseIndex() {},\r\n    showAtList(val){\r\n      this.onOpen(val);\r\n    },\r\n    options(){\r\n      this.initShowOptionList();\r\n    },\r\n  },\r\n  mounted() {\r\n    this.initShowOptionList();\r\n    this.initData();\r\n  },\r\n  beforeUnmount() {\r\n  },\r\n  methods: {\r\n    getText(htmlStr){\r\n      const div = document.createElement('div');\r\n      div.innerHTML = htmlStr;\r\n      let text = '';\r\n        // 遍历子节点\r\n        Array.from(div.childNodes).forEach(node => {\r\n        let textContent = '';\r\n        if(this.type === 'textarea'){\r\n          // textarea\r\n          if(node.nodeName === 'BR'){ // 如果是BR节点,直接添加换行\r\n            textContent = '\\n';\r\n          }else{\r\n            if (node.classList && node.classList.contains('j-mention-at')) {\r\n              textContent = node.dataset.value;\r\n            } else{\r\n              textContent = node.textContent\r\n            }\r\n          }\r\n        }else{\r\n          // input\r\n          if (node.classList && node.classList.contains('j-mention-at')) {\r\n            textContent = node.dataset.value;\r\n          }else if(node.nodeName === 'BR'){\r\n              textContent = '';\r\n          }else{\r\n            textContent = node.textContent.replace(/\\n/g, '');\r\n          }\r\n        }\r\n\r\n        // 去除只有&nbsp;字符的节点\r\n        if (textContent === '&nbsp;' || textContent === ' ') {\r\n          textContent = '';\r\n        }\r\n\r\n        // 拼接文本内容\r\n        text += textContent;\r\n      });\r\n\r\n      return text;\r\n    },\r\n    onChange(){\r\n      const jMention = this.$refs.JMention;\r\n      let htmlStr = jMention.innerHTML;\r\n      let text = this.getText(htmlStr);\r\n\r\n      this.localValue = text;\r\n\r\n      let selectedListMap = {};\r\n\r\n      this.selectedList.forEach(item => {\r\n        if(!selectedListMap[item.value] && text.indexOf(item.value) !== -1){\r\n          selectedListMap[item.value] = item;\r\n        }\r\n      });\r\n\r\n      let mySelectedList = Object.values(selectedListMap);\r\n\r\n      this.$emit(\"change\", text, mySelectedList);\r\n    },\r\n    refresh(){\r\n      this.selectedList = [];\r\n      this.selectedIdSet = new Set();\r\n\r\n      this.initShowOptionList();\r\n      this.initData();\r\n    },\r\n    initData() {\r\n      const JMention = this.$refs.JMention;\r\n      // let html = this.defaultValue;\r\n      let html = this.defaultValue.toString()\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;');\r\n      let defaultSelectedList = this.defaultSelectedList || [];\r\n      let treeOptions = getTreeOptions(this.options);\r\n      let selectedList = [...defaultSelectedList, ...treeOptions].filter(item => item && item.value && item.value != '' && item.typ !== 'node');\r\n\r\n      // 记录已经替换过的的value\r\n      const replacedValues = new Set();\r\n\r\n      selectedList.forEach((opt) => {\r\n        // 使用正则匹配完整的value,避免部分匹配\r\n        const regex = new RegExp(`(${opt.value})`, 'g');\r\n        if(regex.test(this.defaultValue) && !replacedValues.has(opt.value)){\r\n          let text = opt.node_name + '.' + opt.text;\r\n\r\n          text = text.replace(/\\./g, '/')\r\n\r\n          html = html.replace(regex,\r\n            `<span class=\"j-mention-at\" data-id=\"${opt.node_id}\" contentEditable=\"false\" data-value=\"${opt.value}\">${text}</span>`\r\n          );\r\n\r\n          replacedValues.add(opt.value);\r\n\r\n          this.selectOption(opt, true);\r\n        }\r\n      });\r\n\r\n      JMention.innerHTML = html;\r\n      this.localValue = this.defaultValue;\r\n\r\n      this.$nextTick(() => {\r\n        this.$emit('resize');\r\n      })\r\n    },\r\n    initShowOptionList() {\r\n      this.showOptions = this.options.filter((opt) => {\r\n        if (this.atText) {\r\n          return opt.label.startsWith(this.atText);\r\n        }\r\n        if (this.canRepeat) return true;\r\n        return !this.selectedIdSet.has(opt.id + \"\");\r\n      });\r\n    },\r\n    getLastChar(len = 1) {\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return;\r\n      const range = selection.getRangeAt(0);\r\n      const startOffset = range.startOffset;\r\n      const startContainer = range.startContainer;\r\n      let textBeforeCursor = \"\";\r\n      if (startContainer.nodeType === Node.TEXT_NODE) {\r\n        textBeforeCursor = startContainer.textContent.slice(\r\n          0,\r\n          startOffset\r\n        );\r\n      } else if (startContainer.nodeType === Node.ELEMENT_NODE) {\r\n        // 若光标在元素节点内，获取其内部文本\r\n        const childNodes = startContainer.childNodes;\r\n        for (let i = 0; i < childNodes.length; i++) {\r\n          const node = childNodes[i];\r\n          if (node.nodeType === Node.TEXT_NODE) {\r\n            if (i === childNodes.length - 1) {\r\n              textBeforeCursor += node.textContent.slice(\r\n                0,\r\n                startOffset\r\n              );\r\n            } else {\r\n              textBeforeCursor += node.textContent;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return textBeforeCursor.slice(-len);\r\n    },\r\n    getLastAtText() {\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return;\r\n      const range = selection.getRangeAt(0);\r\n      const startOffset = range.startOffset;\r\n      const startContainer = range.startContainer;\r\n      let textBeforeCursor = \"\";\r\n      if (startContainer.nodeType === Node.TEXT_NODE) {\r\n        textBeforeCursor = startContainer.textContent.slice(\r\n          0,\r\n          startOffset\r\n        );\r\n      } else if (startContainer.nodeType === Node.ELEMENT_NODE) {\r\n        // 若光标在元素节点内，获取其内部文本\r\n        const childNodes = startContainer.childNodes;\r\n        for (let i = 0; i < childNodes.length; i++) {\r\n          const node = childNodes[i];\r\n          if (node.nodeType === Node.TEXT_NODE) {\r\n            if (i === childNodes.length - 1) {\r\n              textBeforeCursor += node.textContent.slice(\r\n                0,\r\n                startOffset\r\n              );\r\n            } else {\r\n              textBeforeCursor += node.textContent;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      const lastAtIndex = textBeforeCursor.lastIndexOf(\"/\");\r\n      if (lastAtIndex === -1) return \"\";\r\n      return textBeforeCursor.slice(lastAtIndex + 1);\r\n    },\r\n    async getCaretPosition() {\r\n      // const JMention = this.$refs.JMention;\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return { top: 0, left: 0 };\r\n      const range = selection.getRangeAt(0);\r\n      const rect = range.getBoundingClientRect();\r\n      const dropdownListRect = await this.getDropdownListSize();\r\n\r\n      // 获取视口位置\r\n      let top = rect.bottom;\r\n      let left = rect.left;\r\n\r\n      // 确保下拉列表不会超出视口\r\n      const viewportWidth = window.innerWidth;\r\n      const viewportHeight = window.innerHeight;\r\n\r\n      // 检查右边界\r\n      if (left + dropdownListRect.width > viewportWidth) {\r\n        left = viewportWidth - dropdownListRect.width;\r\n      }\r\n\r\n      // 检查底部边界\r\n      if (top + dropdownListRect.height > viewportHeight) {\r\n        // 如果下方空间不足，将下拉列表显示在输入框上方\r\n        top = rect.top - dropdownListRect.height;\r\n      }\r\n\r\n      return {\r\n        top,\r\n        left,\r\n        x: left,\r\n        y: top\r\n      };\r\n    },\r\n    async getDropdownListSize() {\r\n      this.showDropdown = true; // 临时显示元素\r\n      await this.$nextTick(); // 等待 DOM 更新\r\n      const width = this.$refs.dropdownList.offsetWidth;\r\n      const height = this.$refs.dropdownList.offsetHeight;\r\n      this.showDropdown = false; // 恢复隐藏\r\n      return { width, height };\r\n    },\r\n    updateSelectedList() {\r\n      const JMention = this.$refs.JMention;\r\n      const nodeList = JMention.querySelectorAll(\".j-mention-at\");\r\n      this.selectedList = [];\r\n      this.selectedIdSet = new Set();\r\n\r\n      for (const node of nodeList) {\r\n        // const { value } = node.dataset;\r\n        let value = node.dataset.value;\r\n        const item = this.options.find((opt) => {\r\n          return opt.value == value;\r\n        });\r\n\r\n        this.selectedList.push(item);\r\n        this.selectedIdSet.add(value);\r\n      }\r\n      this.$emit(\"update:selectedList\", this.selectedList);\r\n      if (\r\n        nodeList.length === this.selectedList.length &&\r\n        !this.atText &&\r\n        !this.showDropdown\r\n      ){\r\n        return;\r\n      }\r\n\r\n      this.initShowOptionList();\r\n    },\r\n    checkStartWith(text) {\r\n      const list = this.options.filter((opt) => {\r\n        return opt.label.startsWith(text);\r\n      });\r\n      return list.length > 0;\r\n    },\r\n    updateValue() {\r\n      this.onChange();\r\n    },\r\n    insertAtCaret(text, dataSet) {\r\n      let len = this.atText.length + 1;\r\n      const lastChar = this.getLastChar(len);\r\n      if (lastChar !== \"/\" + this.atText) len = 0;\r\n      const selection = window.getSelection();\r\n      if (selection.rangeCount <= 0) return;\r\n      const range = selection.getRangeAt(0);\r\n      const startOffset = range.startOffset;\r\n      const startContainer = range.startContainer;\r\n\r\n      let prevCharOffset = startOffset - len;\r\n      let prevCharNode = startContainer;\r\n      if (prevCharOffset < 0) {\r\n        // 如果当前节点没有前一个字符，查找前一个兄弟节点\r\n        let prevSibling = startContainer.previousSibling;\r\n        while (prevSibling) {\r\n          if (prevSibling.nodeType === Node.TEXT_NODE) {\r\n            prevCharOffset = prevSibling.textContent.length - len;\r\n            prevCharNode = prevSibling;\r\n            break;\r\n          }\r\n          prevSibling = prevSibling.previousSibling;\r\n        }\r\n      }\r\n\r\n      if (prevCharNode.nodeType === Node.TEXT_NODE) {\r\n        prevCharNode.replaceData(prevCharOffset, len, \" \");\r\n\r\n        // 创建 span 标签\r\n        const span = document.createElement(\"span\");\r\n        span.contentEditable = \"false\";\r\n        span.classList.add(\"j-mention-at\");\r\n        span.style = this.atTextStyle;\r\n        span.textContent = `${text}`;\r\n\r\n        // const tmp = document.createElement(\"span\");\r\n        // tmp.contentEditable = true;\r\n        // tmp.innerHTML += \"&nbsp;\";\r\n        // tmp.classList.add(\"at-space\");\r\n\r\n        for (const key in dataSet) {\r\n          span.dataset[key] = dataSet[key];\r\n        }\r\n\r\n        // 在原字符位置插入 span 标签\r\n        const newRange = document.createRange();\r\n        newRange.setStart(prevCharNode, prevCharOffset);\r\n        newRange.insertNode(span);\r\n        // newRange.insertNode(tmp);\r\n\r\n        // 将光标移动到 span 元素外部\r\n        let nextNode = span.nextSibling;\r\n        if (!nextNode) {\r\n          // 如果 span 元素后面没有兄弟节点，创建一个新的文本节点\r\n          // nextNode = document.createTextNode(\"\");\r\n          // tmp.parentNode.appendChild(nextNode);\r\n        }\r\n        range.setStart(nextNode, 1);\r\n        range.setEnd(nextNode, 1);\r\n        selection.removeAllRanges();\r\n        selection.addRange(range);\r\n      }\r\n    },\r\n    onSelectOption(value, selectedValuePath, selectedPath) {\r\n      let item = selectedPath[selectedPath.length - 1];\r\n      delete item['children'];\r\n      this.selectOption(item)\r\n    },\r\n    selectOption(opt, isInit = false) {\r\n      if (!opt) return;\r\n      // 处理用户选择逻辑\r\n      this.showDropdown = false;\r\n      this.showAtList = false;\r\n\r\n      let text = opt.node_name + '.' + opt.text;\r\n\r\n      text = text.replace(/\\./g, '/')\r\n\r\n      const dataSet = {\r\n        id: opt.id ,\r\n        label: opt.label,\r\n        value: opt.value,\r\n        text: opt.text,\r\n        index: this.selectedList.length,\r\n      };\r\n\r\n      this.selectedList.push(opt);\r\n      this.selectedIdSet.add(opt.value);\r\n\r\n      if (!isInit) {\r\n        this.insertAtCaret(text, dataSet);\r\n        this.initShowOptionList();\r\n        this.updateValue();\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n    .menu-list-box {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n    }\r\n    .field-list-item {\r\n      display: flex;\r\n      gap: 4px;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .right-arrow {\r\n        width: 24px;\r\n        height: 100%;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 13px;\r\n      }\r\n      .field-text {\r\n        max-width: 250px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        font-size: 12px;\r\n      }\r\n    }\r\n    .menu-list-item {\r\n      width: 100%;\r\n      gap: 4px;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .field-text {\r\n        width: 100%;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        font-size: 12px;\r\n      }\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .field-key {\r\n        max-width: 200px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\" @click=\"handleDelEdg\">{{ t('label_question_content') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-text\">\r\n                <at-text\r\n                  :options=\"valueOptions\"\r\n                  :defaultValue=\"formState.answer_text\"\r\n                  ref=\"atInputRef\"\r\n                  v-if=\"formState.answer_text.length > 0\"\r\n                />\r\n                <span v-else>--</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_answer_type') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">\r\n                {{ t(formState.answer_type == 'text' ? 'label_direct_answer' : 'label_smart_menu_answer') }}</span\r\n              >\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-item menu-list-box\" v-if=\"formState.answer_type == 'menu'\">\r\n          <div class=\"menu-list-item\" v-for=\"(item, index) in formState.menu_content\" :key=\"index\">\r\n            <div class=\"field-text\">\r\n              <at-text\r\n                :options=\"valueOptions\"\r\n                :defaultValue=\"item.content\"\r\n                ref=\"atInputRef\"\r\n                v-if=\"item.content.length > 0\"\r\n              />\r\n              <span v-else>--</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.qa-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst valueOptions = ref([])\r\nconst formState = reactive({\r\n  answer_text: '',\r\n  answer_type: 'text',\r\n  reply_content_list: [],\r\n  menu_content: [\r\n    {\r\n      menu_type: '1',\r\n      serial_no: '1',\r\n      content: ''\r\n    },\r\n    {\r\n      menu_type: '1',\r\n      serial_no: '2',\r\n      content: ''\r\n    }\r\n  ],\r\n\r\n  outputs: [\r\n    {\r\n      key: 'question',\r\n      typ: 'string',\r\n      subs: []\r\n    },\r\n    {\r\n      key: 'question_multiple',\r\n      typ: 'array<object>',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nconst handleDelEdg = () => {\r\n  let nodeSortKey = props.properties.nodeSortKey\r\n  let edges = graphModel().edges\r\n  if (formState.answer_type == 'text') {\r\n    formState.menu_content.forEach((item, index) => {\r\n      let sourceAnchorId = nodeSortKey + '-anchor_' + index\r\n      let delEdges = edges.find((item) => item.sourceAnchorId == sourceAnchorId)\r\n      if (delEdges) {\r\n        graphModel().eventCenter.emit('custom:edge:delete', delEdges)\r\n      }\r\n    })\r\n  } else {\r\n    let sourceAnchorId = nodeSortKey + '-anchor_right'\r\n\r\n    let delEdges = edges.find((item) => item.sourceAnchorId == sourceAnchorId)\r\n    if (delEdges) {\r\n      graphModel().eventCenter.emit('custom:edge:delete', delEdges)\r\n    }\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => formState.answer_type,\r\n  (val) => {\r\n    handleDelEdg()\r\n  }\r\n)\r\n\r\nconst reset = () => {\r\n  getValueOptions()\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let question = JSON.parse(dataRaw).question || {}\r\n  question = JSON.parse(JSON.stringify(question))\r\n  formState.answer_text = question.answer_text || ''\r\n  formState.answer_type = question.answer_type || 'text'\r\n  formState.reply_content_list = question.reply_content_list || []\r\n  let reply_content_list = question.reply_content_list || []\r\n  if (reply_content_list.length > 0) {\r\n    let menu_content = reply_content_list[0].smart_menu?.menu_content || []\r\n    if (menu_content.length > 0) {\r\n      formState.menu_content = menu_content\r\n    }\r\n  }\r\n  try {\r\n  } catch (e) {}\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    question: {\r\n      ...formState,\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\nconst onUpatateNodeName = (data) => {\r\n  update()\r\n}\r\n\r\nconst getValueOptions = () => {\r\n  let options = getNode().getAllParentVariable()\r\n\r\n  valueOptions.value = options || []\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.properties.loop_parent_key) {\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        } else {\r\n          if (targetNode.properties.loop_parent_key) {\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      }\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    // console.log(JSON.parse(this.properties.node_params), '==')\r\n    let question = {}\r\n    try {\r\n      question = JSON.parse(this.properties.dataRaw).question\r\n    } catch (error) {}\r\n\r\n    if (question.answer_type == 'menu') {\r\n      let customAnchor = []\r\n      if (question.reply_content_list && question.reply_content_list.length > 0) {\r\n        let menu_content = question.reply_content_list[0].smart_menu?.menu_content || []\r\n        let y0 = y - height / 2\r\n        menu_content.forEach((item, index) => {\r\n          customAnchor.push({\r\n            id: nodeSortKey + '-anchor_' + index,\r\n            x: x + width / 2,\r\n            y: y0 + 132 + index * 32,\r\n            type: 'right',\r\n            nodeId: id\r\n          })\r\n        })\r\n      }\r\n      return [\r\n        {\r\n          x: x - width / 2,\r\n          y: y - height / 2 + 24,\r\n          id: nodeSortKey + '-anchor_left',\r\n          type: 'left',\r\n          nodeId: id\r\n        },\r\n        ...customAnchor\r\n      ]\r\n    } else {\r\n      return [\r\n        {\r\n          x: x - width / 2,\r\n          y: y - height / 2 + 24,\r\n          id: nodeSortKey + '-anchor_left',\r\n          type: 'left',\r\n          nodeId: id\r\n        },\r\n        {\r\n          x: x + width / 2,\r\n          y: y - height / 2 + 24,\r\n          id: nodeSortKey + '-anchor_right',\r\n          type: 'right',\r\n          nodeId: id\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'qa-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      \r\n      &.is-required .field-key::before{\r\n        content: '*';\r\n        color: #FB363F;\r\n        display: inline-block;\r\n        margin-right: 2px;\r\n      }\r\n\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_user_question') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <user-question-text ref=\"questionTextRef\" :value=\"formState.question_value\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_llm_model') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">\r\n                <model-name-text :useModel=\"formState.use_model\" :modelConfigId=\"formState.model_config_id\" />\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value is-required\">\r\n              <span class=\"field-key\">{{ t('label_ai_reply_content') }}</span>\r\n              <span class=\"field-type\">string</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport NodeCommon from '../base-node.vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport ModelNameText from '../model-name-text.vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.ai-dialogue-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- Store ---\r\nconst robotStore = useRobotStore()\r\nconst { modelList } = storeToRefs(robotStore)\r\n\r\n// --- State ---\r\nconst questionTextRef = ref(null)\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  model_config_id: undefined,\r\n  use_model: undefined,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  prompt_tags: [],\r\n  question_value: [],\r\n  enable_thinking: false,\r\n  libs_node_key: void 0\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let llm = {}\r\n  try {\r\n    llm = JSON.parse(dataRaw).llm || {}\r\n  } catch (e) {\r\n    llm = {}\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  const {\r\n    model_config_id,\r\n    use_model,\r\n    context_pair,\r\n    temperature,\r\n    max_token,\r\n    prompt,\r\n    prompt_tags,\r\n    question_value,\r\n    enable_thinking,\r\n    libs_node_key\r\n  } = JSON.parse(JSON.stringify(llm))\r\n\r\n  formState.model_config_id = model_config_id\r\n  formState.use_model = use_model\r\n  formState.context_pair = context_pair || 0\r\n  formState.temperature = temperature\r\n  formState.max_token = max_token\r\n  formState.prompt = prompt\r\n  formState.enable_thinking = enable_thinking\r\n  formState.prompt_tags = prompt_tags || []\r\n  formState.libs_node_key = libs_node_key\r\n  formState.question_value = formatQuestionValue(question_value)\r\n\r\n  if (!formState.model_config_id && modelList.value.length > 0) {\r\n    formState.model_config_id = modelList.value[0].id\r\n    formState.use_model = modelList.value[0].children[0].name\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    llm: {\r\n      ...formState,\r\n      question_value: formState.question_value.join('.'),\r\n      model_config_id: formState.model_config_id\r\n        ? +formState.model_config_id\r\n        : formState.model_config_id\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptions.value = list}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  getVlaueVariableList()\r\n\r\n  if (formState.prompt_tags && formState.prompt_tags.length > 0) {\r\n    formState.prompt_tags.forEach((tag) => {\r\n      if (tag.node_id == data.node_id) {\r\n        let arr = tag.label.split('/')\r\n        arr[0] = data.node_name\r\n        tag.label = arr.join('/')\r\n        tag.node_name = data.node_name\r\n      }\r\n    })\r\n  }\r\n\r\n  update()\r\n\r\n  questionTextRef.value.refresh()\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'ai-dialogue-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: 90px;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n    .field-list-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      width: 100%;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      overflow: hidden;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      overflow: hidden;\r\n      margin-bottom: 4px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n      .right-arrow {\r\n        width: 24px;\r\n        height: 100%;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 13px;\r\n      }\r\n\r\n      .field-text{\r\n        max-width: 120px;\r\n        font-size: 12px;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n      .field-text2{\r\n        max-width: 120px;\r\n        font-size: 12px;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n    .body_raw{\r\n      width: 100%;\r\n      display: block;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px; \r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      overflow: hidden;\r\n\r\n      .field-type {\r\n        flex: 1;\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    @click=\"handleConsole\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_request_url') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\"> {{ formState.method }}</span>\r\n              <span class=\"field-type\" v-if=\"formState.rawurl\">{{ formState.rawurl }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_headers') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"item in formState.headers\" :key=\"item.cu_key\">\r\n              <div class=\"field-text\">{{ item.key }}</div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text2\">\r\n                <AtText :options=\"variableOptions\" :default-value=\"item.value\" :defaultSelectedList=\"item.tags\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_params') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"item in formState.params\" :key=\"item.cu_key\">\r\n              <div class=\"field-text\">{{ item.key }}</div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text2\">\r\n                <AtText :options=\"variableOptions\" :default-value=\"item.value\" :defaultSelectedList=\"item.tags\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\" v-if=\"formState.type == 1\">\r\n          <div class=\"field-item-label\">{{ t('label_body') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"item in formState.body\" :key=\"item.cu_key\">\r\n              <div class=\"field-text\">{{ item.key }}</div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text2\">\r\n                <AtText :options=\"variableOptions\" :default-value=\"item.value\" :defaultSelectedList=\"item.tags\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-item\" v-if=\"formState.type == 2\">\r\n          <div class=\"field-item-label\">{{ t('label_body') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item body_raw\">\r\n              {{ formState.body_raw }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output_fields') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\" v-for=\"item in formState.output\" :key=\"item.cu_key\">\r\n              <span class=\"field-key\"> {{ item.key }}</span>\r\n              <span class=\"field-type\">{{ item.typ }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport { ArrowRightOutlined } from '@ant-design/icons-vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.http-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  method: 'POST',\r\n  rawurl: '',\r\n  headers: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  params: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  type: 1,\r\n  body: [],\r\n  body_raw: '',\r\n  body_raw_tags: [],\r\n  timeout: 30,\r\n  output: []\r\n})\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = Math.random() * 10000\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let curl = {}\r\n  try {\r\n    curl = JSON.parse(dataRaw).curl || {}\r\n  } catch (e) {\r\n    curl = {}\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  curl = JSON.parse(JSON.stringify(curl))\r\n\r\n  for (let key in curl) {\r\n    if (key == 'headers' || key == 'params' || key == 'body') {\r\n      if (curl[key] && curl[key].length > 0) {\r\n        formState[key] = curl[key].map((item) => {\r\n          return {\r\n            ...item,\r\n            cu_key: Math.random() * 10000\r\n          }\r\n        })\r\n      } else {\r\n        formState[key] = []\r\n      }\r\n      continue\r\n    }\r\n    if (key == 'output') {\r\n      formState['output'] = recursionData(curl[key])\r\n      continue\r\n    }\r\n    formState[key] = curl[key]\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    curl: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  list.forEach((item) => {\r\n    item.tags = item.tags || []\r\n  })\r\n  variableOptions.value = list\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  nextTick(() => {\r\n    if (formState.body_raw_tags && formState.body_raw_tags.length > 0) {\r\n      formState.body_raw_tags.forEach((tag) => {\r\n        if (tag.node_id == data.node_id) {\r\n          let arr = tag.label.split('/')\r\n          arr[0] = data.node_name\r\n          tag.label = arr.join('/')\r\n          tag.node_name = data.node_name\r\n        }\r\n      })\r\n    }\r\n\r\n    let keys = ['headers', 'params', 'body']\r\n\r\n    keys.forEach((key) => {\r\n      let items = formState[key]\r\n\r\n      items.forEach((item) => {\r\n        if (item.tags && item.tags.length > 0) {\r\n          item.tags.forEach((tag) => {\r\n            if (tag.node_id == data.node_id) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n              tag.node_name = data.node_name\r\n            }\r\n          })\r\n        }\r\n      })\r\n    })\r\n\r\n    update()\r\n  })\r\n}\r\n\r\nconst handleConsole = () => {\r\n\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 26,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 26,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n\r\n    return defaultAnchor\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'http-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n      overflow: hidden;\r\n    }\r\n    .field-list-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      width: 200px;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      overflow: hidden;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      overflow: hidden;\r\n      .right-arrow {\r\n        width: 24px;\r\n        height: 100%;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 13px;\r\n      }\r\n\r\n      .field-text{\r\n        max-width: 100px;\r\n        font-size: 12px;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n      .field-text2{\r\n        max-width: 100px;\r\n        font-size: 12px;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px; \r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      overflow: hidden;\r\n\r\n      .field-type {\r\n        flex: 1;\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n        overflow: hidden;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-url=\"props.properties.node_icon\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    @click=\"handleConsole\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">请求地址</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\"> {{ formState.method }}</span>\r\n              <span class=\"field-type\">{{ formState.rawurl }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">HEADERS</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"item in formState.headers\" :key=\"item.cu_key\">\r\n              <div class=\"field-text\">{{ item.key }}</div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text2\">\r\n                <AtText :options=\"variableOptions\" :default-value=\"item.value\" :defaultSelectedList=\"item.tags\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">PARAMS</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"item in formState.params\" :key=\"item.cu_key\">\r\n              <div class=\"field-text\">{{ item.key }}</div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text2\">\r\n                <AtText :options=\"variableOptions\" :default-value=\"item.value\" :defaultSelectedList=\"item.tags\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\" v-if=\"formState.type == 1\">\r\n          <div class=\"field-item-label\">BODY</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"item in formState.body\" :key=\"item.cu_key\">\r\n              <div class=\"field-text\">{{ item.key }}</div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text2\">\r\n                <AtText :options=\"variableOptions\" :default-value=\"item.value\" :defaultSelectedList=\"item.tags\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-item\" v-if=\"formState.type == 2\">\r\n          <div class=\"field-item-label\">BODY</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\">\r\n              {{ formState.body_raw }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">输出字段</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\" v-for=\"item in formState.output\" :key=\"item.cu_key\">\r\n              <span class=\"field-key\"> {{ item.key }}</span>\r\n              <span class=\"field-type\">{{ item.typ }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport { ArrowRightOutlined } from '@ant-design/icons-vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport AtText from '../../at-input/at-text.vue'\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  method: 'POST',\r\n  rawurl: '',\r\n  headers: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  params: [\r\n    {\r\n      key: '',\r\n      value: ''\r\n    }\r\n  ],\r\n  type: 1,\r\n  body: [],\r\n  body_raw: '',\r\n  body_raw_tags: [],\r\n  timeout: 30,\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = Math.random() * 10000\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nconst variableOptions = ref([])\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let curl = {}\r\n  try {\r\n    curl = JSON.parse(dataRaw).curl || {}\r\n  } catch (e) {\r\n    curl = {}\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  curl = JSON.parse(JSON.stringify(curl))\r\n\r\n  for (let key in curl) {\r\n    if (key == 'headers' || key == 'params' || key == 'body') {\r\n      if (curl[key] && curl[key].length > 0) {\r\n        formState[key] = curl[key].map((item) => {\r\n          return {\r\n            ...item,\r\n            cu_key: Math.random() * 10000\r\n          }\r\n        })\r\n      } else {\r\n        formState[key] = []\r\n      }\r\n      continue\r\n    }\r\n    if (key == 'output') {\r\n      formState['output'] = recursionData(curl[key])\r\n      continue\r\n    }\r\n    formState[key] = curl[key]\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    curl: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  list.forEach((item) => {\r\n    item.tags = item.tags || []\r\n  })\r\n  variableOptions.value = list\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  nextTick(() => {\r\n    if (formState.body_raw_tags && formState.body_raw_tags.length > 0) {\r\n      formState.body_raw_tags.forEach((tag) => {\r\n        if (tag.node_id == data.node_id) {\r\n          let arr = tag.label.split('/')\r\n          arr[0] = data.node_name\r\n          tag.label = arr.join('/')\r\n          tag.node_name = data.node_name\r\n        }\r\n      })\r\n    }\r\n\r\n    let keys = ['headers', 'params', 'body']\r\n\r\n    keys.forEach((key) => {\r\n      let items = formState[key]\r\n\r\n      items.forEach((item) => {\r\n        if (item.tags && item.tags.length > 0) {\r\n          item.tags.forEach((tag) => {\r\n            if (tag.node_id == data.node_id) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n              tag.node_name = data.node_name\r\n            }\r\n          })\r\n        }\r\n      })\r\n    })\r\n\r\n    update()\r\n  })\r\n}\r\n\r\nconst handleConsole = () => {\r\n\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 26,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 26,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n\r\n    return defaultAnchor\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'http-tool-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 4px;\r\n    }\r\n    .library-item {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n\r\n      &.is-required .field-key::before{\r\n        content: '*';\r\n        color: #FB363F;\r\n        display: inline-block;\r\n        margin-right: 2px;\r\n      }\r\n\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_user_question') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <user-question-text ref=\"questionTextRef\" :value=\"formState.question_value\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output_fields') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value is-required\">\r\n              <span class=\"field-key\">{{ t('label_knowledge_base_reference') }}</span>\r\n              <span class=\"field-type\">string</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_knowledge_base') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"library-item\" v-for=\"item in selectedLibraryRows\" :key=\"item.id\">{{ item.library_name }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount, computed } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport { getLibraryList } from '@/api/library/index'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.knowledge-base-node.index')\r\nconst robotStore = useRobotStore()\r\n\r\nconst rrf_weight = computed(()=>{\r\n  return robotStore.robotInfo.rrf_weight\r\n})\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- Store ---\r\n\r\n// --- State ---\r\nconst questionTextRef = ref(null)\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  library_ids: [],\r\n  rerank_status: 0,\r\n  rerank_use_model: undefined,\r\n  rerank_model_config_id: void 0,\r\n  top_k: 5,\r\n  similarity: 0.5,\r\n  search_type: 1,\r\n  question_value: [],\r\n  rrf_weight: {},\r\n  recall_neighbor_switch: false,\r\n  recall_neighbor_before_num: 1,\r\n  recall_neighbor_after_num: 1,\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let libs = {}\r\n  try {\r\n    libs = JSON.parse(dataRaw).libs || {}\r\n  } catch (e) {\r\n    libs = {}\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  libs = JSON.parse(JSON.stringify(libs))\r\n\r\n  for (let key in libs) {\r\n    if (key == 'library_ids') {\r\n      formState[key] = libs[key] ? libs[key].split(',') : []\r\n    } else if (key == 'question_value') {\r\n      formState.question_value = formatQuestionValue(libs['question_value'])\r\n    }else if(key == 'rrf_weight') {\r\n      formState.rrf_weight = libs[key] ? JSON.parse(libs[key]) : libs[key]\r\n    } else {\r\n      formState[key] = libs[key]\r\n    }\r\n  }\r\n  \r\n  if (!formState.rrf_weight || Object.keys(formState.rrf_weight).length == 0) {\r\n    //  没有值 则去默认值\r\n    formState.rrf_weight = rrf_weight.value\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    libs: {\r\n      ...formState,\r\n      rerank_model_config_id: formState.rerank_model_config_id\r\n        ? +formState.rerank_model_config_id\r\n        : void 0,\r\n      question_value: formState.question_value.join('.'),\r\n      library_ids: formState.library_ids.join(','),\r\n      rrf_weight: JSON.stringify(formState.rrf_weight),\r\n      recall_neighbor_switch: formState.recall_neighbor_switch,\r\n      recall_neighbor_before_num: formState.recall_neighbor_before_num,\r\n      recall_neighbor_after_num: formState.recall_neighbor_before_num,\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst libraryList = ref([])\r\nconst selectedLibraryRows = computed(() => {\r\n  return libraryList.value.filter((item) => {\r\n    return formState.library_ids.includes(item.id)\r\n  })\r\n})\r\n// 获取知识库\r\nconst getList = async () => {\r\n  const res = await getLibraryList({ type: '' })\r\n  if (res) {\r\n    libraryList.value = res.data || []\r\n\r\n    nextTick(() => {\r\n      resetSize()\r\n    })\r\n  }\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptions.value = list\r\n}\r\n\r\nconst onUpatateNodeName = () => {\r\n  getVlaueVariableList()\r\n\r\n  update()\r\n\r\n  questionTextRef.value.refresh()\r\n}\r\n\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  getList()\r\n\r\n  reset()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'knowledge-base-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.end-node {\r\n  .node-desc {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    @handleMenu=\"handleMenu\"\r\n    style=\"width: 420px; height: 116px;\"\r\n  >\r\n    <div class=\"end-node\">\r\n      <div class=\"node-desc\">{{ t('msg_trigger_node_end_return_result') }}</div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'EndNode',\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  components: {\r\n    NodeCommon\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.end-node.index')\r\n    return { t }\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  data() {\r\n    return {\r\n      menus: []\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      this.resetSize()\r\n    })\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    handleMenu() {\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'end-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-url=\"properties.node_icon\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"explain-node\">\r\n      <a-textarea\r\n        auto-size\r\n        :bordered=\"false\"\r\n        class=\"explain-textarea\"\r\n        v-model:value=\"formState.content\"\r\n        placeholder=\"\"\r\n      />\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { nextTick, onMounted, inject, watch, reactive } from 'vue'\r\nconst resetSize = inject('resetSize')\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default() {\r\n      return {}\r\n    }\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nwatch(\r\n  () => props.properties,\r\n  (newVal, oldVal) => {\r\n    const newDataRaw = newVal.node_params || '{}'\r\n    const oldDataRaw = oldVal.node_params || '{}'\r\n    if (newDataRaw != oldDataRaw) {\r\n      reset()\r\n    }\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst formState = reactive({\r\n  content: ''\r\n})\r\n\r\nconst reset = () => {\r\n  if (!props.properties || !props.properties.node_params) {\r\n    return\r\n  }\r\n\r\n  let node_params = JSON.parse(props.properties.node_params)\r\n\r\n  Object.assign(formState, node_params)\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  reset()\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = []\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'explain-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n    .field-list-item {\r\n      display: flex;\r\n      gap: 4px;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      margin-bottom: 4px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n      .right-arrow {\r\n        width: 24px;\r\n        height: 100%;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 13px;\r\n      }\r\n      .field-value{\r\n        max-width: 130px;\r\n      }\r\n      .field-text{\r\n        max-width: 130px;\r\n        font-size: 12px;\r\n      }\r\n      .field-value,\r\n      .field-text{\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_variable') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"(item, index) in formState.list\" :key=\"index\">\r\n              <div class=\"field-text\">\r\n                <AtText\r\n                  :options=\"valueOptions\"\r\n                  :default-value=\"item.value\"\r\n                  :defaultSelectedList=\"item.tags\"\r\n                  class=\"field-value\"\r\n                />\r\n              </div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text\">\r\n                {{ getKeyValue(item.variable) }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport { ArrowRightOutlined } from '@ant-design/icons-vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.variable-assignment-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  list: []\r\n})\r\n\r\nconst valueOptions = ref([])\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let fields = []\r\n  try {\r\n    let node_params = JSON.parse(dataRaw)\r\n    fields = node_params.assign || []\r\n  } catch (e) {\r\n    console.log(e)\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n\r\n  fields.forEach((item) => {\r\n    item.tags = item.tags || []\r\n  })\r\n\r\n  formState.list = fields\r\n\r\n  nextTick(() => {\r\n    update()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  let node_params = JSON.parse(props.properties.node_params)\r\n\r\n  node_params.assign = [...formState.list]\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nfunction getKeyValue(val) {\r\n  if (val) {\r\n    return val.split('.')[1]\r\n  }\r\n  return ''\r\n}\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  list.forEach((item) => {\r\n    item.tags = item.tags || []\r\n  })\r\n  valueOptions.value = list\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n\r\n  getVlaueVariableList()\r\n  nextTick(() => {\r\n    formState.list.forEach((item) => {\r\n      if (item.tags && item.tags.length > 0) {\r\n        item.tags.forEach((tag) => {\r\n          if (tag.node_id == data.node_id) {\r\n            let arr = tag.label.split('/')\r\n            arr[0] = data.node_name\r\n            tag.label = arr.join('/')\r\n            tag.node_name = data.node_name\r\n          }\r\n        })\r\n      }\r\n    })\r\n    update()\r\n  })\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'variable-assignment-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.judge-node {\r\n  position: relative;\r\n  overflow: hidden;\r\n\r\n  .condition-box {\r\n    position: relative;\r\n    display: flex;\r\n    align-items: center;\r\n    .condition-left-box {\r\n      margin-right: 4px;\r\n    }\r\n    .connection-text {\r\n      display: inline-block;\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      font-size: 12px;\r\n      font-weight: 400;\r\n      border-radius: 4px;\r\n      color: #595959;\r\n      background: #e4e6eb;\r\n    }\r\n    .condition-line {\r\n      height: 100%;\r\n      width: 24px;\r\n      margin-right: 4px;\r\n      &::after {\r\n        content: '';\r\n        position: absolute;\r\n        width: 24px;\r\n        top: 12px;\r\n        bottom: 12px;\r\n        border: 1px solid #d9d9d9;\r\n        border-right: 0;\r\n        border-radius: 2px;\r\n        border-top-right-radius: 0;\r\n        border-bottom-right-radius: 0;\r\n      }\r\n    }\r\n\r\n    .condition-body{\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n\r\n    .field-items {\r\n      .field-item {\r\n        display: flex;\r\n        align-items: center;\r\n        min-height: 24px;\r\n        line-height: 16px;\r\n        padding: 2px 4px;\r\n        margin-bottom: 2px;\r\n        border-radius: 4px;\r\n        border: 1px solid #d9d9d9;\r\n        background: #fff;\r\n\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n\r\n        .field-name,\r\n        .field-value {\r\n          flex: 1;\r\n          line-height: 16px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          font-size: 12px;\r\n          color: #595959;\r\n          overflow: hidden;\r\n          white-space: nowrap;\r\n          text-overflow: ellipsis;\r\n        }\r\n        .field-rule {\r\n          height: 18px;\r\n          line-height: 18px;\r\n          padding: 0 8px;\r\n          margin: 0 4px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          border-radius: 4px;\r\n          color: #595959;\r\n          background: #e4e6eb;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .if-box {\r\n    position: relative;\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 8px;\r\n\r\n    .if-box-label {\r\n      width: 48px;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      text-align: right;\r\n      color: #262626;\r\n    }\r\n\r\n    .if-box-content {\r\n      flex: 1;\r\n      padding: 8px;\r\n      border-radius: 6px;\r\n      overflow: hidden;\r\n      background: #f2f4f7;\r\n    }\r\n  }\r\n\r\n  .else-box {\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 8px;\r\n\r\n    .else-box-label {\r\n      width: 60px;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      text-align: right;\r\n      color: #262626;\r\n    }\r\n\r\n    .else-box-content {\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      font-size: 12px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      background: #fff;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"judge-node\">\r\n      <div class=\"if-box\" :ref=\"(el) => ifBoxRefs[index] = el\" v-for=\"(item, index) in formState.term\" :key=\"index\">\r\n        <div class=\"if-box-label\">{{ index == 0 ? t('label_if') : t('label_else_if') }}</div>\r\n        <div class=\"if-box-content\">\r\n          <div class=\"condition-box\">\r\n            <div class=\"condition-left-box\" v-if=\"item.terms.length > 1\">\r\n              <span class=\"connection-text\">{{ item.is_or == 1 ? t('label_or') : t('label_and') }}</span>\r\n            </div>\r\n            <div class=\"condition-line\" v-if=\"item.terms.length > 1\"></div>\r\n            <div class=\"condition-body\">\r\n              <div class=\"field-items\">\r\n                <div class=\"field-item\" v-for=\"(subItem, index) in item.terms\" :key=\"index\">\r\n                  <span class=\"field-name\">\r\n                    <user-question-text :value=\"subItem.variable\" />\r\n                  </span>\r\n                  <span class=\"field-rule\">{{ getRuleLabel(subItem) }}</span>\r\n                  <span class=\"field-value\">\r\n                    {{ subItem.value }}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"else-box\">\r\n        <div class=\"else-box-label\">{{ t('label_else') }}</div>\r\n        <div class=\"else-box-content\">\r\n          <div class=\"else-desc\">{{ t('msg_else_desc') }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, inject, onMounted, nextTick } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport userQuestionText  from '../user-question-text.vue'\r\nimport { specialNodeList } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.judge-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst resetSize = inject('resetSize')\r\nconst getNode = inject('getNode')\r\nconst updateAnchorList = inject('updateAnchorList')\r\n\r\nconst formState = reactive({\r\n  term: []\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\n// 用于收集所有if-box的ref\r\nconst ifBoxRefs = ref([])\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptions.value = handleOptions(list)\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nlet baseTypeOptions = [\r\n  {\r\n    label: t('label_equal'),\r\n    value: 1\r\n  },\r\n  {\r\n    label: t('label_not_equal'),\r\n    value: 2\r\n  },\r\n  {\r\n    label: t('label_contain'),\r\n    value: 3\r\n  },\r\n  {\r\n    label: t('label_not_contain'),\r\n    value: 4\r\n  },\r\n  {\r\n    label: t('label_is_empty'),\r\n    value: 5\r\n  },\r\n  {\r\n    label: t('label_not_empty'),\r\n    value: 6\r\n  }\r\n]\r\n\r\nlet baseTypeOptions2 = [\r\n  {\r\n    label: t('label_contain_one'),\r\n    value: 3\r\n  },\r\n  {\r\n    label: t('label_not_contain_one'),\r\n    value: 4\r\n  },\r\n  {\r\n    label: t('label_is_empty'),\r\n    value: 5\r\n  },\r\n  {\r\n    label: t('label_not_empty'),\r\n    value: 6\r\n  }\r\n]\r\n\r\nfunction getTypeByVariable(data) {\r\n  let typ = ''\r\n  if (data.variable && data.variable.length > 0) {\r\n    let slectItem = variableOptions.value.filter((item) => item.key == data.variable[0])\r\n    if (slectItem && slectItem.length) {\r\n      typ = slectItem[0].typ\r\n    }\r\n    if (typ == 'object') {\r\n      if (slectItem[0] && slectItem[0].children) {\r\n        slectItem = slectItem[0].subs.filter((item) => item.key == data.variable[1])\r\n      }\r\n      if (slectItem && slectItem.length) {\r\n        typ = slectItem[0].typ\r\n      }\r\n\r\n      if (typ == 'object') {\r\n        if (slectItem[0] && slectItem[0].children) {\r\n          slectItem = slectItem[0].subs.filter((item) => item.key == data.variable[2])\r\n        }\r\n        if (slectItem && slectItem.length) {\r\n          typ = slectItem[0].typ\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return typ\r\n}\r\n\r\nfunction getTypeOptions(data) {\r\n  if (!data.variable) {\r\n    return []\r\n  }\r\n  let typ = getTypeByVariable(data)\r\n\r\n  if (typ == '') {\r\n    if (data.is_mult) {\r\n      return baseTypeOptions2\r\n    } else {\r\n      return baseTypeOptions\r\n    }\r\n  }\r\n\r\n  if (typ == 'boole') {\r\n    return [\r\n      {\r\n        label: t('label_equal'),\r\n        value: 1\r\n      },\r\n      {\r\n        label: t('label_not_equal'),\r\n        value: 2\r\n      }\r\n    ]\r\n  }\r\n\r\n  if (typ.includes('array')) {\r\n    return baseTypeOptions2\r\n  }\r\n\r\n  return baseTypeOptions\r\n}\r\n\r\nconst getRuleLabel =  (item) => {\r\n  let options = getTypeOptions(item)\r\n  let index = options.findIndex((it) => it.value == item.type)\r\n\r\n  return options[index].label\r\n}\r\n\r\nconst init = () => {\r\n  try {\r\n    let term = JSON.parse(props.properties.node_params).term || []\r\n\r\n    term = term.map((item) => {\r\n      let terms = item.terms.map((it) => {\r\n        // 判断是不是特殊节点\r\n        let specialKey = ''\r\n\r\n        for (let i = 0; i < specialNodeList.length; i++) {\r\n          if (it.variable.indexOf(specialNodeList[i]) > -1) {\r\n            specialKey = specialNodeList[i]\r\n            break\r\n          }\r\n        }\r\n\r\n        if (specialKey != '') {\r\n          let arr = it.variable.split('.')\r\n          it.variable = [arr[0], specialKey]\r\n        } else {\r\n          it.variable = it.variable.split('.')\r\n        }\r\n        return {\r\n          ...it,\r\n          type: it.type > 0 ? it.type : 1,\r\n          key: Math.random() * 10000\r\n        }\r\n      })\r\n\r\n      return {\r\n        ...item,\r\n        is_or: item.is_or ? 1 : 0,\r\n        terms,\r\n        key: Math.random() * 10000\r\n      }\r\n    })\r\n\r\n    formState.term = term\r\n\r\n    nextTick(() => {\r\n      resetSize()\r\n      updateAnchor()\r\n    })\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst updateAnchor = () => {\r\n  const  nodeSortKey = props.properties.nodeSortKey\r\n  let items =  []\r\n  let ifBoxCountOffsetTop = 56;\r\n  for(let i =0; i < formState.term.length; i++){\r\n    let item  = formState.term[i]\r\n    if (item) {\r\n      let height = 0;\r\n      let top = ifBoxCountOffsetTop;\r\n      let padding = 8;\r\n      let margin  = 2;\r\n      let subItemHeight = 24;\r\n      let subItemNum = item.terms.length;\r\n\r\n      height =  subItemNum  * subItemHeight + padding * 2 + margin * (subItemNum - 1);\r\n      \r\n      if(i > 0 &&  i < formState.term.length){\r\n        top += 8\r\n      }\r\n\r\n      ifBoxCountOffsetTop = top + height;\r\n\r\n      items.push({\r\n        id: nodeSortKey + '-anchor_' + i,\r\n        offsetHeight: height,\r\n        offsetTop: top\r\n      })\r\n    }\r\n  }\r\n \r\n  // 插入else-box\r\n  if(items.length > 0){\r\n    items.push({\r\n       id: nodeSortKey + '-anchor_right',\r\n      offsetHeight: 24,\r\n      offsetTop: ifBoxCountOffsetTop + 8,\r\n    })\r\n  }\r\n\r\n  updateAnchorList(items)\r\n}\r\n\r\nwatch(() => props.properties.node_params, (newVal, oldVal) => {\r\n  if (newVal != oldVal) {\r\n    init()\r\n  }\r\n}, {\r\n  deep: true\r\n})\r\n\r\nonMounted(() => {\r\n  getOptions()\r\n\r\n  init()\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height } = this\r\n    const { nodeSortKey, anchorList } = this.properties\r\n\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      // {\r\n      //   x: x + width / 2,\r\n      //   y: y - height / 2 + 24,\r\n      //   id: nodeSortKey + '-anchor_right',\r\n      //   type: 'right',\r\n      //   nodeId: id,\r\n      // },\r\n    ]\r\n\r\n    if(anchorList){\r\n      for (let i = 0; i < anchorList.length; i++) {\r\n        let { offsetTop, offsetHeight } = anchorList[i]\r\n        let y0 = y - height / 2\r\n\r\n        defaultAnchor.push({\r\n          id: anchorList[i].id,\r\n          nodeId: id,\r\n          x: x + width / 2,\r\n          y: y0 + offsetTop + offsetHeight / 2,\r\n          type: 'right',\r\n        })\r\n      }\r\n    }\r\n    \r\n    return defaultAnchor\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'judge-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n  >\r\n    <div class=\"specify-reply-node\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_message_content') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              <AtText\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.content_tags\"\r\n                :defaultValue=\"formState.content\"\r\n                ref=\"atInputRef\"\r\n                class=\"text-input\"\r\n                @resize=\"onInputResize\"\r\n                v-if=\"formState.content.length > 0\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'SpecifyReplyNode',\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  components: {\r\n    NodeCommon,\r\n    AtText\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.specify-reply-node.index')\r\n    return { t }\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  data() {\r\n    return {\r\n      menus: [],\r\n      valueOptions: [],\r\n      formState: {\r\n        content: '',\r\n        content_tags: []\r\n      }\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        if (newVal.dataRaw !== oldVal.dataRaw) {\r\n          this.init()\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  mounted() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.on('custom:setNodeName', this.onUpatateNodeName)\r\n    this.init()\r\n  },\r\n  onBeforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getValueOptions()\r\n\r\n      let dataRaw = this.properties.dataRaw || this.properties.node_params || '{}'\r\n      let node_params = JSON.parse(dataRaw)\r\n\r\n      const reply = node_params.reply || {\r\n        content: '',\r\n        content_tags: []\r\n      }\r\n\r\n      this.formState.content = reply.content\r\n\r\n      this.formState.content_tags = reply.content_tags || []\r\n\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n    onInputResize() {\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n    onUpatateNodeName (data) {\r\n      if (!this.formState.content) return\r\n      if (!haveOutKeyNode.includes(data.node_type)) {\r\n        return\r\n      }\r\n\r\n      this.getValueOptions()\r\n\r\n      this.$nextTick(() => {\r\n        if (this.formState.content_tags && this.formState.content_tags.length > 0) {\r\n          this.formState.content_tags.forEach((tag) => {\r\n            if (tag.node_id == data.node_id) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n              tag.node_name = data.node_name\r\n            }\r\n          })\r\n        }\r\n\r\n        this.$refs[`atInputRef`].refresh()\r\n\r\n        // this.update()\r\n      })\r\n    },\r\n    getValueOptions() {\r\n      let options = this.getNode().getAllParentVariable()\r\n\r\n      this.valueOptions = options || []\r\n    },\r\n    update() {\r\n      let node_params = JSON.parse(this.properties.node_params)\r\n\r\n      node_params.reply = { ...this.formState }\r\n\r\n      this.setData({\r\n        node_params: JSON.stringify(node_params)\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.specify-reply-node {\r\n  position: relative;\r\n  z-index: 2;\r\n  .static-field-value{\r\n    width: 100%;\r\n    height: 58px;\r\n    line-height: 18px;\r\n    font-size: 13px;\r\n    word-break: break-all;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 3;\r\n    line-clamp: 3;\r\n    -webkit-box-orient: vertical;\r\n    white-space: pre-wrap;\r\n  }\r\n  &:deep(.j-mention-at) {\r\n    padding: 0 8px;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    line-height: 16px;\r\n    font-weight: 400;\r\n    background: #f2f4f5;\r\n  }\r\n}\r\n</style>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height} = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'specify-reply-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n  >\r\n    <div class=\"specify-reply-node\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_message_content') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              <AtText\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.content_tags\"\r\n                :defaultValue=\"formState.content\"\r\n                ref=\"atInputRef\"\r\n                class=\"text-input\"\r\n                @resize=\"onInputResize\"\r\n                v-if=\"formState.content.length > 0\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'ImmediatelyReplyNode',\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  components: {\r\n    NodeCommon,\r\n    AtText\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.immediately-reply-node.index')\r\n    return { t }\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  data() {\r\n    return {\r\n      menus: [],\r\n      valueOptions: [],\r\n      formState: {\r\n        content: '',\r\n        content_tags: []\r\n      }\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        if (newVal.dataRaw !== oldVal.dataRaw) {\r\n          this.init()\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  mounted() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.on('custom:setNodeName', this.onUpatateNodeName)\r\n    this.init()\r\n  },\r\n  onBeforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getValueOptions()\r\n\r\n      let dataRaw = this.properties.dataRaw || this.properties.node_params || '{}'\r\n      let node_params = JSON.parse(dataRaw)\r\n\r\n      const reply = node_params.immediately_reply || {\r\n        content: '',\r\n        content_tags: []\r\n      }\r\n\r\n      this.formState.content = reply.content\r\n\r\n      this.formState.content_tags = reply.content_tags || []\r\n\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n    onInputResize() {\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n    onUpatateNodeName (data) {\r\n      if (!this.formState.content) return\r\n      if (!haveOutKeyNode.includes(data.node_type)) {\r\n        return\r\n      }\r\n\r\n      this.getValueOptions()\r\n\r\n      this.$nextTick(() => {\r\n        if (this.formState.content_tags && this.formState.content_tags.length > 0) {\r\n          this.formState.content_tags.forEach((tag) => {\r\n            if (tag.node_id == data.node_id) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n              tag.node_name = data.node_name\r\n            }\r\n          })\r\n        }\r\n\r\n        this.$refs[`atInputRef`].refresh()\r\n\r\n        // this.update()\r\n      })\r\n    },\r\n    getValueOptions() {\r\n      let options = this.getNode().getAllParentVariable()\r\n\r\n      this.valueOptions = options || []\r\n    },\r\n    update() {\r\n      let node_params = JSON.parse(this.properties.node_params)\r\n\r\n      node_params.immediately_reply = { ...this.formState }\r\n\r\n      this.setData({\r\n        node_params: JSON.stringify(node_params)\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.specify-reply-node {\r\n  position: relative;\r\n  z-index: 2;\r\n  .static-field-value{\r\n    width: 100%;\r\n    height: 58px;\r\n    line-height: 18px;\r\n    font-size: 13px;\r\n    word-break: break-all;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 3;\r\n    line-clamp: 3;\r\n    -webkit-box-orient: vertical;\r\n    white-space: pre-wrap;\r\n  }\r\n  &:deep(.j-mention-at) {\r\n    padding: 0 8px;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    line-height: 16px;\r\n    font-weight: 400;\r\n    background: #f2f4f5;\r\n  }\r\n}\r\n</style>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height} = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'immediately-reply-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 4px;\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n\r\n      &.is-required .field-key::before{\r\n        content: '*';\r\n        color: #FB363F;\r\n        display: inline-block;\r\n        margin-right: 2px;\r\n      }\r\n\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_user_question') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <user-question-text ref=\"questionTextRef\" :value=\"formState.question_value\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_llm_model') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">\r\n                <model-name-text :useModel=\"formState.use_model\" :modelConfigId=\"formState.model_config_id\" />\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output_fields') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\" :class=\"{ 'is-required': item.required }\" v-for=\"item in formState.output\" :key=\"item.cu_key\">\r\n              <span class=\"field-key\"> {{ item.key }}</span>\r\n              <span class=\"field-type\">{{ item.typ }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  ref,\r\n  reactive,\r\n  watch,\r\n  inject,\r\n  nextTick,\r\n  onMounted,\r\n  onBeforeUnmount\r\n} from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport NodeCommon from '../base-node.vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport ModelNameText from '../model-name-text.vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.parameter-extraction-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- Store ---\r\nconst robotStore = useRobotStore()\r\nconst { modelList } = storeToRefs(robotStore)\r\n\r\n// --- State ---\r\nconst questionTextRef = ref(null)\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  model_config_id: undefined,\r\n  use_model: undefined,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  prompt_tags: [],\r\n  question_value: [],\r\n  enable_thinking: false,\r\n  output: []\r\n})\r\n\r\nconst variableOptions = ref([])\r\nconst variableOptionsSelect = ref([])\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = Math.random() * 10000\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let params_extractor = {}\r\n  try {\r\n    params_extractor = JSON.parse(dataRaw).params_extractor || {}\r\n  } catch (e) {\r\n    params_extractor = {}\r\n  }\r\n  params_extractor = JSON.parse(JSON.stringify(params_extractor))\r\n\r\n  getVlaueVariableList()\r\n  getOptions()\r\n\r\n  for (let key in params_extractor) {\r\n    if (key == 'output') {\r\n      formState['output'] = recursionData(params_extractor[key])\r\n      continue\r\n    }\r\n    if (key == 'question_value') {\r\n      formState.question_value = formatQuestionValue(params_extractor[key])\r\n      continue\r\n    }\r\n    formState[key] = params_extractor[key]\r\n  }\r\n\r\n  if (!formState.model_config_id && modelList.value.length > 0) {\r\n    formState.model_config_id = modelList.value[0].id\r\n    formState.use_model = modelList.value[0].children[0].name\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    params_extractor: {\r\n      ...formState,\r\n      question_value: formState.question_value.join('.'),\r\n      model_config_id: formState.model_config_id\r\n        ? +formState.model_config_id\r\n        : formState.model_config_id\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n  list.forEach((item) => {\r\n    item.tags = item.tags || []\r\n  })\r\n\r\n  variableOptions.value = list\r\n}\r\n\r\nfunction getOptions() {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptionsSelect.value = handleOptions(list)\r\n}\r\n\r\n// 递归处理Options\r\nfunction handleOptions(options) {\r\n  options.forEach((item) => {\r\n    if (item.typ == 'node') {\r\n      if (item.node_type == 1) {\r\n        item.value = 'global'\r\n      } else {\r\n        item.value = item.node_id\r\n      }\r\n    } else {\r\n      item.value = item.key\r\n    }\r\n\r\n    if (item.children && item.children.length > 0) {\r\n      item.children = handleOptions(item.children)\r\n    }\r\n  })\r\n\r\n  return options\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n  getVlaueVariableList()\r\n\r\n  if (formState.prompt_tags && formState.prompt_tags.length > 0) {\r\n    formState.prompt_tags.forEach((tag) => {\r\n      if (tag.node_id == data.node_id) {\r\n        let arr = tag.label.split('/')\r\n        arr[0] = data.node_name\r\n        tag.label = arr.join('/')\r\n        tag.node_name = data.node_name\r\n      }\r\n    })\r\n  }\r\n\r\n  update()\r\n\r\n  questionTextRef.value.refresh()\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties.dataRaw, (newVal, oldVal) => {\r\n  if(newVal != oldVal) {\r\n    reset()\r\n  }\r\n}, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n\r\n    return defaultAnchor\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'parameter-extraction-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.ai-dialogue-node {\r\n  \r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_user_question') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              <user-question-text ref=\"questionTextRef\" :value=\"formState.question_value\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_llm_model') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              <model-name-text :useModel=\"formState.use_model\" :modelConfigId=\"formState.model_config_id\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_output') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              <span class=\"static-field-key\">{{ t('label_problem_optimization_result') }}</span>\r\n              <span class=\"static-field-type\">string</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { ref, reactive, watch, nextTick, onMounted, inject, onBeforeUnmount } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport NodeCommon from '../base-node.vue'\r\nimport ModelNameText from '../model-name-text.vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.problem-optimization-node.index')\r\n\r\n// --- Props and Injections ---\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\nconst questionTextRef = ref(null)\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- Store ---\r\nconst robotStore = useRobotStore()\r\nconst { modelList } = storeToRefs(robotStore)\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  model_config_id: undefined,\r\n  use_model: undefined,\r\n  temperature: 0,\r\n  max_token: 0,\r\n  context_pair: 0,\r\n  prompt: '',\r\n  prompt_tags: [],\r\n  question_value: [],\r\n  enable_thinking: false\r\n})\r\n\r\nconst variableOptions = ref([])\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val) {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  }\r\n  return ['global', 'question']\r\n}\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  \r\n  let question_optimize = {}\r\n  try {\r\n    question_optimize = JSON.parse(dataRaw).question_optimize || {}\r\n  } catch (e) {\r\n    question_optimize = {}\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  // Use a deep copy to avoid side effects\r\n  const {\r\n    model_config_id,\r\n    use_model,\r\n    context_pair,\r\n    temperature,\r\n    max_token,\r\n    prompt,\r\n    prompt_tags,\r\n    question_value,\r\n    enable_thinking\r\n  } = JSON.parse(JSON.stringify(question_optimize))\r\n\r\n  formState.model_config_id = model_config_id\r\n  formState.use_model = use_model\r\n  formState.context_pair = context_pair || 0\r\n  formState.temperature = temperature\r\n  formState.max_token = max_token\r\n  formState.prompt = prompt\r\n  formState.enable_thinking = enable_thinking\r\n  formState.prompt_tags = prompt_tags || []\r\n  formState.question_value = formatQuestionValue(question_value)\r\n\r\n  if (!formState.model_config_id && modelList.value.length > 0) {\r\n    formState.model_config_id = modelList.value[0].id\r\n    formState.use_model = modelList.value[0].children[0].name\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = {\r\n    ...formState,\r\n    node_params: JSON.stringify({\r\n      question_optimize: {\r\n        ...formState,\r\n        question_value: formState.question_value.join('.'),\r\n        model_config_id: formState.model_config_id\r\n          ? +formState.model_config_id\r\n          : formState.model_config_id\r\n      }\r\n    })\r\n  }\r\n\r\n  setData(data)\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptions.value = list\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  getVlaueVariableList()\r\n\r\n  if (formState.prompt_tags && formState.prompt_tags.length > 0) {\r\n    formState.prompt_tags.forEach((tag) => {\r\n      if (tag.node_id == data.node_id) {\r\n        let arr = tag.label.split('/')\r\n        arr[0] = data.node_name\r\n        tag.label = arr.join('/')\r\n        tag.node_name = data.node_name\r\n      }\r\n    })\r\n  }\r\n  \r\n  update()\r\n\r\n  questionTextRef.value.refresh()\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'problem-optimization-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20class='design-iconfont'%3e%3cpath%20d='M13%208L3%208'%20stroke='%23595959'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%2012L13%208L9%204'%20stroke='%23595959'%20stroke-width='1.33333'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"add-data-node\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_data_table') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              {{ state.formData.form_name || '--' }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_insert_data') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\" v-if=\"state.formData.datas.length == 0\">--</div>\r\n            <div class=\"static-field-value\" v-for=\"item in state.formData.datas\" :key=\"item.id\">\r\n              <span class=\"field-name\">\r\n                <AtText\r\n                  :options=\"atInputOptions\"\r\n                  :default-value=\"item.value\"\r\n                  :defaultSelectedList=\"item.atTags\"\r\n                  ref=\"atInputRef\"\r\n                />\r\n              </span>\r\n\r\n              <span class=\"field-arrow\"><img src=\"@/assets/img/workflow/arrow-right.svg\" alt=\"\"/></span>\r\n\r\n              <span class=\"field-name\">{{ item.name }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, inject, onMounted, reactive, nextTick, watch, toRaw, onUnmounted } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.add-data-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst resetSize = inject('resetSize')\r\nconst getNode = inject('getNode')\r\nconst getGraph = inject('getGraph')\r\nconst atInputRef = ref(null)\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    datas: []\r\n  }\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable()\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst init = () => {\r\n  let dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n\r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  getAtInputOptions()\r\n\r\n  state.formData = node_params.form_insert\r\n\r\n  update()\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  node_params.form_insert = toRaw(state.formData)\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nwatch(\r\n  () => props.properties.dataRaw,\r\n  (newVal, oldVal) => {\r\n    if (newVal !== oldVal) {\r\n      init()\r\n    }\r\n  }\r\n)\r\n\r\nonMounted(() => {\r\n  const graphModel = getGraph()\r\n  graphModel.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n  init()\r\n})\r\n\r\nonUnmounted(() => {\r\n  const graphModel = getGraph()\r\n  graphModel.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!state.formData.datas || state.formData.datas.length == 0) {\r\n    return\r\n  }\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n\r\n  getAtInputOptions()\r\n\r\n  state.formData.datas.forEach((item) => {\r\n    if (item.atTags && item.atTags.length > 0) {\r\n      item.atTags.forEach((tag) => {\r\n        if (tag.node_id == data.node_id) {\r\n          let arr = tag.label.split('/')\r\n          arr[0] = data.node_name\r\n          tag.label = arr.join('/')\r\n          tag.node_name = data.node_name\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  update()\r\n  nextTick(() => {\r\n    atInputRef.value.map(item => item.refresh())\r\n    resetSize()\r\n  })\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.add-data-node {\r\n  position: relative;\r\n  .static-field-item-content {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  .static-field-value {\r\n    font-size: 12px;\r\n\r\n    .field-arrow {\r\n      display: inline-flex;\r\n      align-items: center;\r\n      margin: 0 4px;\r\n      padding: 0 4px;\r\n      height: 18px;\r\n      font-size: 12px;\r\n      border-radius: 4px;\r\n      background: #e4e6eb;\r\n      img {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n  }\r\n  &:deep(.j-mention-at) {\r\n    padding: 0 8px;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    line-height: 16px;\r\n    font-weight: 400;\r\n    background: #f2f4f5;\r\n  }\r\n}\r\n</style>","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'add-data-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n  >\r\n    <div class=\"node-box\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_data_table') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              {{ state.formData.form_name || '--' }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\" style=\"align-items: center\">\r\n          <div class=\"static-field-item-label\">{{ t('label_update_condition') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <span class=\"static-field-value\" v-if=\"state.formData.where.length == 0\">--</span>\r\n            <div class=\"condition-box\">\r\n              <div class=\"condition-left-box\" v-if=\"state.formData.where.length > 1\">\r\n                <span class=\"connection-text\">{{ state.formData.typ == 1 ? t('label_and') : t('label_or') }}</span>\r\n              </div>\r\n              <div class=\"condition-line\" v-if=\"state.formData.where.length > 1\"></div>\r\n              <div class=\"condition-body\">\r\n                <div class=\"field-items\">\r\n                  <div class=\"field-item\" v-for=\"item in state.formData.where\" :key=\"item.id\">\r\n                    <span class=\"field-name\">{{ item.field_name }}</span>\r\n                    <span class=\"field-rule\">{{ getRuleLabel(item.field_type, item.rule) }}</span>\r\n                    <span class=\"field-value\">\r\n                      <AtText\r\n                        :options=\"atInputOptions\"\r\n                        :default-value=\"item.rule_value1\"\r\n                        :defaultSelectedList=\"item.atTags\"\r\n                      />\r\n                      <template v-if=\"item.rule_value2\">\r\n                        <span>-</span>\r\n                        <AtText\r\n                          :options=\"atInputOptions\"\r\n                          :default-value=\"item.rule_value2\"\r\n                          :defaultSelectedList=\"item.atTags2\"\r\n                        />\r\n                      </template>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_update_data') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <!-- :class=\"{ 'is-required': item.required }\" -->\r\n            <div class=\"options-list\">\r\n              <div\r\n                class=\"options-item\"\r\n                v-for=\"item in state.formData.datas\"\r\n                :key=\"item.key\"\r\n              >\r\n                <div class=\"option-label\">\r\n                  <AtText\r\n                    :options=\"atInputOptions\"\r\n                    :default-value=\"item.value\"\r\n                    :defaultSelectedList=\"item.atTags\"\r\n                  />\r\n                </div>\r\n                <span class=\"field-arrow\"><img src=\"@/assets/img/workflow/arrow-right.svg\" alt=\"\"/></span>\r\n                <div class=\"option-label\">\r\n                  {{ item.name }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { getFilterRuleLabel } from '@/constants/database'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { ref, reactive, watch, onMounted, toRaw, nextTick, inject } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.update-data-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst resetSize = inject('resetSize')\r\nconst getNode = inject('getNode')\r\n\r\nconst dataTableStore = useDataTableStore()\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    typ: 1,\r\n    datas: [],\r\n    where: []\r\n  },\r\n  fieldList: []\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable()\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst init = () => {\r\n  let dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n\r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  getAtInputOptions()\r\n\r\n  let where = whereDataConditions(node_params.form_update.where || [])\r\n\r\n  node_params.form_update.where = where\r\n\r\n  state.formData = node_params.form_update\r\n\r\n  if (state.formData.form_id) {\r\n    getFieldList(state.formData.form_id)\r\n  }\r\n  \r\n  update()\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  let form = { ...toRaw(state.formData) }\r\n\r\n  form.where = whereDataFormatter(form.where)\r\n\r\n  node_params.form_update = form\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst whereDataConditions = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n    let ruleArr = data.rule.split('_')\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.field_type = ruleArr[0]\r\n    // 删除数组的第一个\r\n    ruleArr.shift()\r\n    // 数组还原成字符串\r\n    data.rule = ruleArr.join('_')\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst whereDataFormatter = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.rule = item.field_type + '_' + item.rule\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst getFieldList = async (form_id) => {\r\n  dataTableStore\r\n    .getFormFieldList({ form_id: form_id })\r\n    .then((list) => {\r\n      list.forEach((item) => {\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      state.fieldList = list\r\n    })\r\n    .catch(() => {})\r\n}\r\n\r\nconst getRuleLabel = (field_type, rule) => {\r\n  return getFilterRuleLabel(rule, field_type)\r\n}\r\n\r\nwatch(\r\n  () => props.properties.dataRaw,\r\n  (newVal, oldVal) => {\r\n    if (newVal !== oldVal) {\r\n      init()\r\n    }\r\n  }\r\n)\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.node-box {\r\n  .condition-box {\r\n    display: flex;\r\n    align-items: center;\r\n    .condition-left-box {\r\n      margin-right: 4px;\r\n    }\r\n    .connection-text {\r\n      display: inline-block;\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      font-size: 12px;\r\n      font-weight: 400;\r\n      border-radius: 4px;\r\n      color: #595959;\r\n      background: #e4e6eb;\r\n    }\r\n    .condition-line {\r\n      position: relative;\r\n      height: 100%;\r\n      width: 24px;\r\n      margin-right: 4px;\r\n      &::after {\r\n        content: '';\r\n        position: absolute;\r\n        width: 24px;\r\n        top: 12px;\r\n        bottom: 12px;\r\n        border: 1px solid #d9d9d9;\r\n        border-right: 0;\r\n        border-radius: 2px;\r\n        border-top-right-radius: 0;\r\n        border-bottom-right-radius: 0;\r\n      }\r\n    }\r\n\r\n    .field-items {\r\n      .field-item {\r\n        display: flex;\r\n        align-items: center;\r\n        min-height: 24px;\r\n        line-height: 16px;\r\n        padding: 2px 4px;\r\n        margin-bottom: 2px;\r\n        border-radius: 4px;\r\n        border: 1px solid #d9d9d9;\r\n\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n\r\n        .field-name,\r\n        .field-value {\r\n          line-height: 16px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          color: #595959;\r\n        }\r\n        .field-rule {\r\n          height: 18px;\r\n          line-height: 18px;\r\n          padding: 0 8px;\r\n          margin: 0 4px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          border-radius: 4px;\r\n          color: #595959;\r\n          background: #e4e6eb;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .options-list {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  .options-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 22px;\r\n    padding: 2px 2px 2px 4px;\r\n    border-radius: 4px;\r\n    border: 1px solid #d9d9d9;\r\n\r\n    &.is-required .option-label::before {\r\n      vertical-align: middle;\r\n      content: '*';\r\n      color: #fb363f;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-label {\r\n      max-width: 150px;\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n    }\r\n\r\n    .field-arrow {\r\n      display: inline-flex;\r\n      align-items: center;\r\n      margin: 0 4px;\r\n      padding: 0 4px;\r\n      height: 18px;\r\n      font-size: 12px;\r\n      border-radius: 4px;\r\n      background: #e4e6eb;\r\n      img {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n\r\n    &:deep(.j-mention-at) {\r\n      padding: 0 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      line-height: 16px;\r\n      font-weight: 400;\r\n      background: #f2f4f5;\r\n    }\r\n  }\r\n}\r\n</style>","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'update-data-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.node-box {\r\n  .condition-box {\r\n    display: flex;\r\n    align-items: center;\r\n    .condition-left-box {\r\n      margin-right: 4px;\r\n    }\r\n    .connection-text {\r\n      display: inline-block;\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      font-size: 12px;\r\n      font-weight: 400;\r\n      border-radius: 4px;\r\n      color: #595959;\r\n      background: #e4e6eb;\r\n    }\r\n    .condition-line {\r\n      position: relative;\r\n      height: 100%;\r\n      width: 24px;\r\n      margin-right: 4px;\r\n      &::after {\r\n        content: '';\r\n        position: absolute;\r\n        width: 24px;\r\n        top: 12px;\r\n        bottom: 12px;\r\n        border: 1px solid #d9d9d9;\r\n        border-right: 0;\r\n        border-radius: 2px;\r\n        border-top-right-radius: 0;\r\n        border-bottom-right-radius: 0;\r\n      }\r\n    }\r\n\r\n    .field-items {\r\n      .field-item {\r\n        display: flex;\r\n        align-items: center;\r\n        min-height: 24px;\r\n        line-height: 16px;\r\n        padding: 2px 4px;\r\n        margin-bottom: 2px;\r\n        border-radius: 4px;\r\n        border: 1px solid #d9d9d9;\r\n\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n\r\n        .field-name,\r\n        .field-value {\r\n          line-height: 16px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          color: #595959;\r\n        }\r\n        .field-rule {\r\n          height: 18px;\r\n          line-height: 18px;\r\n          padding: 0 8px;\r\n          margin: 0 4px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          border-radius: 4px;\r\n          color: #595959;\r\n          background: #e4e6eb;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n  >\r\n    <div class=\"node-box\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_data_table') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              {{ state.formData.form_name || '--' }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\" style=\"align-items: center\">\r\n          <div class=\"static-field-item-label\">{{ t('label_delete_condition') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <span class=\"static-field-value\" v-if=\"state.formData.where.length == 0\">--</span>\r\n            <div class=\"condition-box\">\r\n              <div class=\"condition-left-box\" v-if=\"state.formData.where.length > 1\">\r\n                <span class=\"connection-text\">{{ state.formData.typ == 1 ? t('label_and') : t('label_or') }}</span>\r\n              </div>\r\n              <div class=\"condition-line\" v-if=\"state.formData.where.length > 1\"></div>\r\n              <div class=\"condition-body\">\r\n                <div class=\"field-items\">\r\n                  <div class=\"field-item\" v-for=\"item in state.formData.where\" :key=\"item.id\">\r\n                    <span class=\"field-name\">{{ item.field_name }}</span>\r\n                    <span class=\"field-rule\">{{ getRuleLabel(item.field_type, item.rule) }}</span>\r\n                    <span class=\"field-value\">\r\n                      <AtText\r\n                        :options=\"atInputOptions\"\r\n                        :default-value=\"item.rule_value1\"\r\n                        :defaultSelectedList=\"item.atTags\"\r\n                      />\r\n                      <template v-if=\"item.rule_value2\">\r\n                        <span>-</span>\r\n                        <AtText\r\n                          :options=\"atInputOptions\"\r\n                          :default-value=\"item.rule_value2\"\r\n                          :defaultSelectedList=\"item.atTags2\"\r\n                        />\r\n                      </template>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { getFilterRuleLabel } from '@/constants/database'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { ref, reactive, watch, onMounted, nextTick, inject,  toRaw } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.delete-data-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst resetSize = inject('resetSize')\r\nconst setData = inject('setData')\r\nconst getNode = inject('getNode')\r\n\r\nconst dataTableStore = useDataTableStore()\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    typ: 1,\r\n    where: []\r\n  },\r\n  fieldList: []\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable()\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\nconst init = () => {\r\n  let dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  \r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  getAtInputOptions()\r\n\r\n  let where = whereDataConditions(node_params.form_delete.where || [])\r\n\r\n  node_params.form_delete.where = where\r\n\r\n  state.formData = node_params.form_delete\r\n\r\n  if (state.formData.form_id) {\r\n    getFieldList(state.formData.form_id)\r\n  }\r\n  update()\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  let form = { ...toRaw(state.formData) }\r\n\r\n  form.where = whereDataFormatter(form.where)\r\n\r\n  node_params.form_delete = form\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst whereDataFormatter = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.rule = item.field_type + '_' + item.rule\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst whereDataConditions = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n    let ruleArr = data.rule.split('_')\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.field_type = ruleArr[0]\r\n    // 删除数组的第一个\r\n    ruleArr.shift()\r\n    // 数组还原成字符串\r\n    data.rule = ruleArr.join('_')\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst getFieldList = async (form_id) => {\r\n  dataTableStore\r\n    .getFormFieldList({ form_id: form_id })\r\n    .then((list) => {\r\n      list.forEach((item) => {\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      state.fieldList = list\r\n\r\n      nextTick(() => {\r\n        resetSize()\r\n      })\r\n    })\r\n    .catch(() => {})\r\n}\r\n\r\nconst getRuleLabel = (field_type, rule) => {\r\n  return getFilterRuleLabel(rule, field_type)\r\n}\r\n\r\nwatch(\r\n  () => props.properties.dataRaw,\r\n  (newVal, oldVal) => {\r\n    if (newVal !== oldVal) {\r\n      init()\r\n    }\r\n  }\r\n)\r\n\r\nonMounted(() => {\r\n  init()\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'delete-data-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.node-box {\r\n  .condition-box {\r\n    display: flex;\r\n    align-items: center;\r\n    .condition-left-box {\r\n      margin-right: 4px;\r\n    }\r\n    .connection-text {\r\n      display: inline-block;\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      font-size: 12px;\r\n      font-weight: 400;\r\n      border-radius: 4px;\r\n      color: #595959;\r\n      background: #e4e6eb;\r\n    }\r\n    .condition-line {\r\n      position: relative;\r\n      height: 100%;\r\n      width: 24px;\r\n      margin-right: 4px;\r\n      &::after {\r\n        content: '';\r\n        position: absolute;\r\n        width: 24px;\r\n        top: 12px;\r\n        bottom: 12px;\r\n        border: 1px solid #d9d9d9;\r\n        border-right: 0;\r\n        border-radius: 2px;\r\n        border-top-right-radius: 0;\r\n        border-bottom-right-radius: 0;\r\n      }\r\n    }\r\n\r\n    .field-items {\r\n      .field-item {\r\n        display: flex;\r\n        align-items: center;\r\n        min-height: 24px;\r\n        line-height: 16px;\r\n        padding: 2px 4px;\r\n        margin-bottom: 2px;\r\n        border-radius: 4px;\r\n        border: 1px solid #d9d9d9;\r\n\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n\r\n        .field-name,\r\n        .field-value {\r\n          line-height: 16px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          color: #595959;\r\n        }\r\n        .field-rule {\r\n          height: 18px;\r\n          line-height: 18px;\r\n          padding: 0 8px;\r\n          margin: 0 4px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          border-radius: 4px;\r\n          color: #595959;\r\n          background: #e4e6eb;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .options-list {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  .options-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 22px;\r\n    padding: 2px 2px 2px 4px;\r\n    border-radius: 4px;\r\n    border: 1px solid #d9d9d9;\r\n\r\n    &.is-required .option-label::before {\r\n      vertical-align: middle;\r\n      content: '*';\r\n      color: #fb363f;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .option-type {\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      background-color: #e4e6eb;\r\n      color: var(--wf-color-text-3);\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n  >\r\n    <div class=\"node-box\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_data_table') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              {{ state.formData.form_name || '--' }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\" style=\"align-items: center\">\r\n          <div class=\"static-field-item-label\">{{ t('label_query_conditions') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <span class=\"static-field-value\" v-if=\"state.formData.where.length == 0\">--</span>\r\n            <div class=\"condition-box\">\r\n              <div class=\"condition-left-box\" v-if=\"state.formData.where.length > 1\">\r\n                <span class=\"connection-text\">{{ state.formData.typ == 1 ? t('text_and') : t('text_or') }}</span>\r\n              </div>\r\n              <div class=\"condition-line\" v-if=\"state.formData.where.length > 1\"></div>\r\n              <div class=\"condition-body\">\r\n                <div class=\"field-items\">\r\n                  <div class=\"field-item\" v-for=\"item in state.formData.where\" :key=\"item.id\">\r\n                    <span class=\"field-name\">{{ item.field_name }}</span>\r\n                    <span class=\"field-rule\">{{ getRuleLabel(item.field_type, item.rule) }}</span>\r\n                    <span class=\"field-value\">\r\n                      <AtText\r\n                        :options=\"atInputOptions\"\r\n                        :default-value=\"item.rule_value1\"\r\n                        :defaultSelectedList=\"item.atTags\"\r\n                      />\r\n                      <template v-if=\"item.rule_value2\">\r\n                        <span>-</span>\r\n                        <AtText\r\n                          :options=\"atInputOptions\"\r\n                          :default-value=\"item.rule_value2\"\r\n                          :defaultSelectedList=\"item.atTags2\"\r\n                        />\r\n                      </template>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_query_fields') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"options-list\">\r\n              <div\r\n                class=\"options-item\"\r\n                v-for=\"item in state.formData.fields\"\r\n                :key=\"item.key\"\r\n              >\r\n                <div class=\"option-label\">{{ item.name }}</div>\r\n                <div class=\"option-type\">{{ item.type }}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { getFilterRuleLabel } from '@/constants/database'\r\nimport { useDataTableStore } from '@/stores/modules/data-table'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport { ref, reactive, inject, onMounted, toRaw, nextTick, watch, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.select-data-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst resetSize = inject('resetSize')\r\nconst getNode = inject('getNode')\r\nconst graphModel = inject('getGraph')\r\n\r\nconst dataTableStore = useDataTableStore()\r\n\r\nlet node_params = {}\r\n\r\nconst state = reactive({\r\n  tableList: [],\r\n  formData: {\r\n    form_name: '',\r\n    form_description: '',\r\n    form_id: '',\r\n    typ: 1,\r\n    fields: [],\r\n    where: [],\r\n    order: [],\r\n    limit: 100\r\n  },\r\n  fieldList: []\r\n})\r\n\r\nconst atInputOptions = ref([])\r\n\r\nconst getAtInputOptions = () => {\r\n  let options = getNode().getAllParentVariable()\r\n\r\n  atInputOptions.value = options || []\r\n}\r\n\r\n\r\nconst init = () => {\r\n  let dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n\r\n  node_params = JSON.parse(dataRaw)\r\n\r\n  getAtInputOptions()\r\n\r\n  let where = whereDataConditions(node_params.form_select.where || [])\r\n\r\n  node_params.form_select.where = where\r\n\r\n  state.formData = node_params.form_select\r\n\r\n  if (state.formData.form_id) {\r\n    getFieldList(state.formData.form_id)\r\n  }\r\n\r\n  update()\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  let form = { ...toRaw(state.formData) }\r\n\r\n  form.where = whereDataFormatter(form.where)\r\n\r\n  node_params.form_select = form\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: JSON.stringify(node_params)\r\n  })\r\n}\r\n\r\nconst whereDataConditions = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n    let ruleArr = data.rule.split('_')\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.field_type = ruleArr[0]\r\n    // 删除数组的第一个\r\n    ruleArr.shift()\r\n    // 数组还原成字符串\r\n    data.rule = ruleArr.join('_')\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst whereDataFormatter = (where) => {\r\n  let conditions = []\r\n\r\n  where.forEach((item) => {\r\n    let data = JSON.parse(JSON.stringify(item))\r\n\r\n    data.form_field_id = data.form_field_id * 1\r\n    data.rule = item.field_type + '_' + item.rule\r\n\r\n    conditions.push(data)\r\n  })\r\n\r\n  return conditions\r\n}\r\n\r\nconst getTableList = async () => {\r\n  const list = await dataTableStore.getFormList()\r\n  if (list) {\r\n    state.tableList = list\r\n  }\r\n}\r\n\r\nconst getFieldList = async (form_id) => {\r\n  dataTableStore\r\n    .getFormFieldList({ form_id: form_id })\r\n    .then((list) => {\r\n      list.forEach((item) => {\r\n        item.id = item.id * 1\r\n      })\r\n\r\n      state.fieldList = list\r\n    })\r\n    .catch(() => {})\r\n}\r\n\r\nconst getRuleLabel = (field_type, rule) => {\r\n  return getFilterRuleLabel(rule, field_type)\r\n}\r\n\r\nconst onUpatateNodeName = () => {\r\n  // console.log(props.properties.node_name, 'onUpatateNodeName')\r\n  init()\r\n}\r\n\r\nwatch(\r\n  () => props.properties.dataRaw,\r\n  (newVal, oldVal) => {\r\n    if (newVal !== oldVal) {\r\n      init()\r\n    }\r\n  }\r\n)\r\n\r\nonMounted(() => {\r\n  getTableList()\r\n  init()\r\n\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'select-data-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n    .field-list-item {\r\n      display: flex;\r\n      gap: 4px;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .right-arrow {\r\n        width: 24px;\r\n        height: 100%;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 13px;\r\n      }\r\n      .field-text{\r\n        max-width: 150px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        font-size: 12px;\r\n      }\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .field-key{\r\n        max-width: 200px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px;\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_input_params') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\" v-for=\"item in formState.params\" :key=\"item.cu_key\">\r\n              <div class=\"field-text\">\r\n                <UserQuestionText :value=\"item.variable\" />\r\n              </div>\r\n              <div class=\"right-arrow\"><ArrowRightOutlined /></div>\r\n              <div class=\"field-text\">{{ item.field }}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output_fields') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\" v-for=\"item in formState.output\" :key=\"item.cu_key\">\r\n              <span class=\"field-key\"> {{ item.key }}</span>\r\n              <span class=\"field-type\">{{ item.typ }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_exception_handling') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">{{ t('msg_exception_branch') }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport { ArrowRightOutlined } from '@ant-design/icons-vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport { haveOutKeyNode, specialNodeList } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.code-run-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  language: 'javaScript',\r\n  main_func: '',\r\n  params: [\r\n    {\r\n      field: '',\r\n      variable: []\r\n    }\r\n  ],\r\n  timeout: 30,\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      subs: []\r\n    }\r\n  ],\r\n  exception: ''\r\n})\r\n\r\nconst defaultCode = `function main({data1, data2}){\r\n\treturn {\r\n\t\tdata1,\r\n    \tdata2\r\n\t}\r\n}`\r\n\r\nconst variableOptions = ref([])\r\n\r\nfunction recursionData(data) {\r\n  data.forEach((item) => {\r\n    item.cu_key = Math.random() * 10000\r\n    if (item.subs && item.subs.length) {\r\n      recursionData(item.subs)\r\n    } else {\r\n      item.subs = []\r\n    }\r\n  })\r\n  return data\r\n}\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let code_run = {}\r\n  try {\r\n    code_run = JSON.parse(dataRaw).code_run || {}\r\n  } catch (e) {\r\n    code_run = {}\r\n  }\r\n\r\n  getVlaueVariableList()\r\n\r\n  code_run = JSON.parse(JSON.stringify(code_run))\r\n\r\n  for (let key in code_run) {\r\n    if (key == 'params') {\r\n      if (code_run[key] && code_run[key].length > 0) {\r\n        formState[key] = code_run[key].map((item) => {\r\n          return {\r\n            ...item,\r\n            cu_key: Math.random() * 10000\r\n          }\r\n        })\r\n      } else {\r\n        formState[key] = []\r\n      }\r\n      continue\r\n    }\r\n\r\n    if (key == 'output') {\r\n      formState['output'] = recursionData(code_run[key])\r\n      continue\r\n    }\r\n    formState[key] = code_run[key]\r\n  }\r\n  formState.main_func = formState.main_func || defaultCode\r\n  formState.language = formState.language || 'javaScript'\r\n\r\n  formState.params = formState.params.map((it) => {\r\n    let specialKey = ''\r\n    for (let i = 0; i < specialNodeList.length; i++) {\r\n      if (it.variable.indexOf(specialNodeList[i]) > -1) {\r\n        specialKey = specialNodeList[i]\r\n        break\r\n      }\r\n    }\r\n    if (specialKey != '') {\r\n      let arr = it.variable.split('.')\r\n      it.variable = [arr[0], specialKey]\r\n    } else {\r\n      it.variable = it.variable.split('.')\r\n    }\r\n    return {\r\n      ...it,\r\n      key: Math.random() * 10000\r\n    }\r\n  })\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    code_run: {\r\n      ...formState,\r\n      params: formatParams()\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nfunction formatParams() {\r\n  let list = []\r\n  formState.params.forEach((item) => {\r\n    list.push({\r\n      field: item.field,\r\n      variable: item.variable && item.variable.length > 0 ? item.variable.join('.') : ''\r\n    })\r\n  })\r\n  return list\r\n}\r\n\r\nconst getVlaueVariableList = () => {\r\n  let list = getNode().getAllParentVariable()\r\n\r\n  variableOptions.value = list\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n  getVlaueVariableList()\r\n\r\n  nextTick(() => {\r\n    update()\r\n  })\r\n}\r\n\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 28,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 28,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y + height / 2 - 28,\r\n        id: nodeSortKey + '-anchor_right_exception',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n\r\n    return defaultAnchor\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'code-run-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}","<style lang=\"less\" scoped>\r\n._main {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  > div {\r\n    display: flex;\r\n    > .label {\r\n      flex-shrink: 0;\r\n      min-width: 70px;\r\n      text-align: right;\r\n    }\r\n    :deep(.ant-tag) {\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-url=\"mcpInfo.avatar\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    style=\"min-width: 320px;min-height: 94px;\"\r\n  >\r\n    <div class=\"_main\">\r\n      <div v-for=\"p in propList\" :key=\"p.key\">\r\n        <span class=\"label\">{{ p.key }}：</span>\r\n        <a-tag v-if=\"getArgValue(p.key)\">\r\n          <at-text :options=\"valueOptions\" :defaultSelectedList=\"getArgTags(p.key)\" :defaultValue=\"getArgValue(p.key)\" ref=\"atTextRef\" />\r\n        </a-tag>\r\n        <a-tag v-else>--</a-tag>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport {jsonDecode} from '@/utils/index'\r\nimport NodeCommon from '../base-node.vue'\r\nimport {getTMcpProviderInfo} from \"@/api/robot/thirdMcp.js\";\r\nimport AtText from \"@/views/workflow/components/at-input/at-text.vue\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'QuestionNode',\r\n  components: {\r\n    NodeCommon,\r\n    AtText,\r\n  },\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      },\r\n    },\r\n    isSelected: {type: Boolean, default: false},\r\n    isHovered: {type: Boolean, default: false},\r\n  },\r\n  data() {\r\n    return {\r\n      atTextRef: null,\r\n      menus: [{name: 'btn_delete', key: 'delete', color: '#fb363f'}],\r\n      visible: false,\r\n      toolInfo: {},\r\n      mcpInfo: {},\r\n      nodeParams: {\r\n        mcp: {\r\n          provider_id: '',\r\n          tool_name: '',\r\n          arguments: {}\r\n        }\r\n      },\r\n      valueOptions: []\r\n    }\r\n  },\r\n  computed: {\r\n    t() {\r\n      return useI18n('views.workflow.components.nodes.mcp-node.index').t\r\n    }\r\n  },\r\n  mounted() {\r\n    this.nodeParams = JSON.parse(this.properties.node_params)\r\n    this.valueOptions = this.getNode().getAllParentVariable() || []\r\n    this.loadProvider()\r\n\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.on('custom:setNodeName', this.onUpatateNodeName)\r\n\r\n    this.$nextTick(() => {\r\n      this.resetSize()\r\n    })\r\n  },\r\n  onBeforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        if (newVal.dataRaw !== oldVal.dataRaw) {\r\n          this.nodeParams = JSON.parse(this.properties.node_params || '{}')\r\n          this.$nextTick(() => {\r\n            const atTextRef = this.$refs.atTextRef\r\n            const refList = Array.isArray(atTextRef) ? atTextRef : atTextRef ? [atTextRef] : []\r\n            refList.forEach((ref) => {\r\n              ref && ref.refresh && ref.refresh()\r\n            })\r\n            this.resetSize()\r\n          })\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    onUpatateNodeName (data) {\r\n      this.valueOptions = this.getNode().getAllParentVariable() || []\r\n      const patchTags = (tags) => {\r\n        if (!Array.isArray(tags) || tags.length === 0) {\r\n          return\r\n        }\r\n        tags.forEach((tag) => {\r\n          if (tag && tag.node_id == data.node_id) {\r\n            if (tag.label) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n            }\r\n            tag.node_name = data.node_name\r\n          }\r\n        })\r\n      }\r\n      const map = this.nodeParams?.mcp?.tag_map || {}\r\n      Object.keys(map).forEach((k) => {\r\n        patchTags(map[k])\r\n      })\r\n      this.$nextTick(() => {\r\n        const atTextRef = this.$refs.atTextRef\r\n        const refList = Array.isArray(atTextRef) ? atTextRef : atTextRef ? [atTextRef] : []\r\n        refList.forEach((ref) => {\r\n          ref && ref.refresh && ref.refresh()\r\n        })\r\n        this.setData({\r\n          node_params: JSON.stringify(this.nodeParams)\r\n        })\r\n        this.resetSize()\r\n      })\r\n    },\r\n    loadProvider() {\r\n      getTMcpProviderInfo({\r\n        provider_id: this.nodeParams?.mcp.provider_id || ''\r\n      }).then(res => {\r\n        this.mcpInfo = res?.data || {}\r\n        let tools = jsonDecode(this.mcpInfo?.tools, [])\r\n        this.toolInfo = tools.find(item => item.name == this.nodeParams?.mcp.tool_name)\r\n        this.$nextTick(() => {\r\n          this.resetSize()\r\n        })\r\n      })\r\n    },\r\n    update(data) {\r\n      let nodeParams = this.nodeParams\r\n      nodeParams.mcp.arguments = data.arguments\r\n      nodeParams.mcp.tag_map = data.tag_map\r\n      this.setData({\r\n        node_params: JSON.stringify(nodeParams)\r\n      })\r\n    },\r\n    getArgValue(key) {\r\n      const v = this.nodeParams?.mcp?.arguments?.[key]\r\n      return v == null ? '' : String(v)\r\n    },\r\n    getArgTags(key) {\r\n      const tags = this.nodeParams?.mcp?.tag_map?.[key]\r\n      return Array.isArray(tags) ? tags : []\r\n    }\r\n  },\r\n  computed: {\r\n    propList() {\r\n      const schema = this.toolInfo?.inputSchema || {}\r\n      const props = schema?.properties || {}\r\n      const req = Array.isArray(schema?.required) ? schema.required : []\r\n      return Object.keys(props).map(k => {\r\n        const it = props[k] || {}\r\n        return {\r\n          key: k,\r\n          required: req.includes(k)\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'mcp-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<template>\r\n  <div class=\"_main\">\r\n    <div>\r\n      <span class=\"label\">配置：</span>\r\n      <a-tag>{{ actionState?.config_name || '--' }}</a-tag>\r\n    </div>\r\n    <div v-if=\"!['create_bitable', 'create_tables', 'table_add_members', 'update_advanced', 'roles_list'].includes(business)\">\r\n      <span class=\"label\">数据表：</span>\r\n      <a-tag>\r\n        <at-text\r\n          v-if=\"actionState?.tag_map?.table_id && actionState?.tag_map?.table_id.length\"\r\n          class=\"batch-render-at\"\r\n          :options=\"valueOptions\"\r\n          :defaultSelectedList=\"actionState.tag_map.table_id\"\r\n          :defaultValue=\"actionState?.table_id\"\r\n        />\r\n        <template v-else>{{actionState?.table_name || actionState?.table_id || '--'}}</template>\r\n      </a-tag>\r\n    </div>\r\n    <div v-if=\"business == 'create_bitable'\">\r\n      <span class=\"label\">多维表名称：</span>\r\n      <a-tag>\r\n        <at-text\r\n          class=\"batch-render-at\"\r\n          :options=\"valueOptions\"\r\n          :defaultSelectedList=\"actionState?.tag_map?.name || []\"\r\n          :defaultValue=\"actionState?.name || '--'\"\r\n        />\r\n      </a-tag>\r\n    </div>\r\n    <template v-else-if=\"business == 'create_tables'\">\r\n      <div>\r\n        <span class=\"label\">数据表名称：</span>\r\n        <a-tag>\r\n          <at-text\r\n            class=\"batch-render-at\"\r\n            :options=\"valueOptions\"\r\n            :defaultSelectedList=\"actionState?.tag_map?.name || []\"\r\n            :defaultValue=\"actionState?.name || '--'\"\r\n          />\r\n        </a-tag>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'create_views'\">\r\n      <div>\r\n        <span class=\"label\">视图名称：</span>\r\n        <a-tag>\r\n          <at-text\r\n            class=\"batch-render-at\"\r\n            :options=\"valueOptions\"\r\n            :defaultSelectedList=\"actionState?.tag_map?.view_name || []\"\r\n            :defaultValue=\"actionState?.view_name || '--'\"\r\n          />\r\n        </a-tag>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'create_record'\">\r\n      <div>\r\n        <span class=\"label\">插入数据：</span>\r\n        <div v-if=\"Array.isArray(actionState.fields)\" class=\"field-box\">\r\n          <a-tag v-for=\"field in actionState.fields\" class=\"field-tag\" :key=\"field.field_name\">\r\n            <span>{{ field.field_name }}</span>\r\n            <span class=\"arrow-icon\">\r\n              <img src=\"@/assets/img/workflow/arrow-right.svg\"/>\r\n            </span>\r\n            <span v-if=\"field.value\">\r\n              <at-text :options=\"valueOptions\" :defaultSelectedList=\"field.atTags\" :defaultValue=\"field.value.toString()\"/>\r\n            </span>\r\n            <span v-else></span>\r\n          </a-tag>\r\n        </div>\r\n        <div v-else>\r\n          <a-tag>--</a-tag>\r\n        </div>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'delete_record'\">\r\n      <div>\r\n        <span class=\"label\">删除ID：</span>\r\n        <a-tag v-if=\"actionState.record_id\">\r\n          <at-text :options=\"valueOptions\" :defaultSelectedList=\"actionState.record_tags\" :defaultValue=\"actionState.record_id\"/>\r\n        </a-tag>\r\n        <a-tag v-else>--</a-tag>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'search_records'\">\r\n      <div>\r\n        <span class=\"label\">查询条件：</span>\r\n        <div v-if=\"Array.isArray(actionState?.filter?.conditions) && actionState.filter.conditions.length\" class=\"field-box\">\r\n          <a-tag v-for=\"item in actionState.filter.conditions\" class=\"field-tag\" :key=\"item.field_id\">\r\n            <span>{{ item.field_name }}</span>\r\n            <span class=\"arrow-icon\">{{ operatorMap[item.operator]?.label }}</span>\r\n            <span v-if=\"item.value\">\r\n              <at-text :options=\"valueOptions\" :defaultSelectedList=\"item.atTags\" :defaultValue=\"item.value.toString()\"/>\r\n            </span>\r\n            <span v-else></span>\r\n          </a-tag>\r\n        </div>\r\n        <div v-else>\r\n          <a-tag>--</a-tag>\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <span class=\"label\">查询字段：</span>\r\n        <div v-if=\"Array.isArray(actionState.field_names) && actionState.field_names.length\" class=\"field-box\">\r\n          <a-tag v-for=\"field in actionState.field_names\" class=\"field-tag\" :key=\"field.field\">{{ field }}</a-tag>\r\n        </div>\r\n        <div v-else>\r\n          <a-tag>--</a-tag>\r\n        </div>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'update_record'\">\r\n      <div>\r\n        <span class=\"label\">更新ID：</span>\r\n        <a-tag v-if=\"actionState.record_id\">\r\n          <at-text :options=\"valueOptions\" :defaultSelectedList=\"actionState.record_tags\" :defaultValue=\"actionState.record_id\"/>\r\n        </a-tag>\r\n        <a-tag v-else>--</a-tag>\r\n      </div>\r\n      <div>\r\n        <span class=\"label\">更新数据：</span>\r\n        <div v-if=\"Array.isArray(actionState.fields)\" class=\"field-box\">\r\n          <a-tag v-for=\"field in actionState.fields\" class=\"field-tag\" :key=\"field.field_name\">\r\n            <span>{{ field.field_name }}</span>\r\n            <span class=\"arrow-icon\">\r\n              <img src=\"@/assets/img/workflow/arrow-right.svg\"/>\r\n            </span>\r\n            <span v-if=\"field.value\">\r\n              <at-text :options=\"valueOptions\" :defaultSelectedList=\"field.atTags\" :defaultValue=\"field.value.toString()\"/>\r\n            </span>\r\n            <span v-else></span>\r\n          </a-tag>\r\n        </div>\r\n        <div v-else>\r\n          <a-tag>--</a-tag>\r\n        </div>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'update_advanced'\">\r\n      <div>\r\n        <span class=\"label\">多维表名称：</span>\r\n        <a-tag v-if=\"actionState.name\">\r\n          <at-text :options=\"valueOptions\" :defaultSelectedList=\"actionState?.tag_map?.name || []\" :defaultValue=\"actionState.name\"/>\r\n        </a-tag>\r\n        <a-tag v-else>--</a-tag>\r\n      </div>\r\n      <div>\r\n        <span class=\"label\">高级权限：</span>\r\n        <a-tag>{{actionState.is_advanced == 0 ? '不设置' : actionState.is_advanced == 1 ? '开启' : '关闭'}}</a-tag>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'table_add_members'\">\r\n      <div>\r\n        <span class=\"label\">多维表：</span>\r\n        <a-tag>\r\n          <at-text\r\n            class=\"batch-render-at\"\r\n            :options=\"valueOptions\"\r\n            :defaultSelectedList=\"actionState?.tag_map?.app_token || []\"\r\n            :defaultValue=\"actionState?.app_token || '--'\"\r\n          />\r\n        </a-tag>\r\n      </div>\r\n      <div>\r\n        <span class=\"label\">协作者角色：</span>\r\n        <a-tag v-if=\"actionState.role_id\">\r\n          <at-text :options=\"valueOptions\" :defaultSelectedList=\"actionState?.tag_map?.role_id || []\" :defaultValue=\"actionState.role_id\"/>\r\n        </a-tag>\r\n        <a-tag v-else>--</a-tag>\r\n      </div>\r\n      <div>\r\n        <span class=\"label\">协作者ID：</span>\r\n        <a-tag v-if=\"actionState.member_id\">\r\n          <at-text :options=\"valueOptions\" :defaultSelectedList=\"actionState?.tag_map?.member_id || []\" :defaultValue=\"actionState.member_id\"/>\r\n        </a-tag>\r\n        <a-tag v-else>--</a-tag>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"business == 'roles_list'\">\r\n      <div>\r\n        <span class=\"label\">多维表：</span>\r\n        <a-tag>\r\n          <at-text\r\n            class=\"batch-render-at\"\r\n            :options=\"valueOptions\"\r\n            :defaultSelectedList=\"actionState?.tag_map?.app_token || []\"\r\n            :defaultValue=\"actionState?.app_token || '--'\"\r\n          />\r\n        </a-tag>\r\n      </div>\r\n    </template>\r\n    <template v-else-if=\"BatchActions.includes(business)\">\r\n      <div v-for=\"(item, key) in batchActionParam\" :key=\"key\">\r\n        <span class=\"label\">{{ item.name }}：</span>\r\n        <div v-if=\"actionState[key]\" class=\"field-box\">\r\n          <a-tag>\r\n            <at-text\r\n              class=\"batch-render-at\"\r\n              :options=\"valueOptions\"\r\n              :defaultSelectedList=\"actionState?.tag_map[key] || []\"\r\n              :defaultValue=\"actionState[key].toString()\"\r\n            />\r\n          </a-tag>\r\n        </div>\r\n        <div v-else>\r\n          <a-tag>--</a-tag>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {BatchActions, feiShuOperatorMap, getBatchActionParams} from \"@/constants/feishu-table.js\";\r\nimport AtText from \"@/views/workflow/components/at-input/at-text.vue\";\r\nimport {runPlugin} from \"@/api/plugins/index.js\";\r\n\r\nexport default {\r\n  name: \"feishu-table-render\",\r\n  components: {AtText},\r\n  props: {\r\n    business: {\r\n      type: String,\r\n    },\r\n    nodeParams: {\r\n      type: Object\r\n    },\r\n    valueOptions: {\r\n      type: Array\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      BatchActions,\r\n      batchActionParam: {},\r\n      operatorMap: feiShuOperatorMap,\r\n      actionState: {},\r\n    }\r\n  },\r\n  async mounted() {\r\n    if (BatchActions.includes(this.business)) {\r\n      await this.initParams()\r\n    }\r\n    this.dataFormat()\r\n  },\r\n  watch: {\r\n    nodeParams: {\r\n      handler(newVal, oldVal) {\r\n        this.dataFormat()\r\n        this.$emit('updateSize')\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    async initParams() {\r\n      await runPlugin({\r\n        name: 'feishu_bitable',\r\n        action: \"default/get-schema\",\r\n        params: {}\r\n      }).then(res => {\r\n        let data = res?.data || {}\r\n        this.batchActionParam = getBatchActionParams(data[this.business]?.params || {})\r\n      })\r\n    },\r\n    dataFormat() {\r\n      let arg = this.nodeParams?.plugin?.params?.arguments || {}\r\n      let {config_name, table_name} = this.nodeParams?.plugin?.params || {}\r\n      this.actionState = {\r\n        ...arg,\r\n        config_name,\r\n        table_name,\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n._main {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  > div {\r\n    display: flex;\r\n\r\n    > .label {\r\n      flex-shrink: 0;\r\n      width: 90px;\r\n      text-align: right;\r\n    }\r\n\r\n    :deep(.ant-tag) {\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n    }\r\n  }\r\n}\r\n\r\n.field-box {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n\r\n  .field-tag {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n    margin: 0;\r\n    word-break: break-all;\r\n  }\r\n\r\n  .arrow-icon {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    margin: 0 4px;\r\n    padding: 0 4px;\r\n    height: 18px;\r\n    font-size: 12px;\r\n    border-radius: 4px;\r\n    background: #e4e6eb;\r\n\r\n    img {\r\n      width: 16px;\r\n      height: 16px;\r\n    }\r\n  }\r\n}\r\n\r\n.batch-render-at {\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: pre-wrap;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  line-clamp: 2;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"_main\">\r\n    <div>\r\n      <span class=\"label\">公众号：</span>\r\n      <a-tag>{{ actionState?.app_name || '--' }}</a-tag>\r\n    </div>\r\n    <div>\r\n      <span class=\"label\">接收人\r\n        <span class=\"hint\">\r\n          <QuestionCircleOutlined />\r\n          <span class=\"hint-pop\">接收人openid</span>\r\n        </span>：\r\n      </span>\r\n      <span v-if=\"actionState?.touser\">\r\n        <at-text\r\n          :options=\"valueOptions\"\r\n          :defaultSelectedList=\"[]\"\r\n          :defaultValue=\"(actionState?.touser || '').toString()\"/>\r\n      </span>\r\n      <span v-else>\r\n        <a-tag>--</a-tag>\r\n      </span>\r\n    </div>\r\n    <div><span class=\"label\">消息类型：</span>\r\n      <a-tag>{{ actionState?.msg_type_name || '--' }}</a-tag>\r\n    </div>\r\n    <div>\r\n      <span class=\"label\">回复内容：</span>\r\n      <div v-if=\"Array.isArray(actionState.fields)\" class=\"field-box\">\r\n        <a-tag v-for=\"field in actionState.fields\" class=\"field-tag\" :key=\"field.field_name\">\r\n          <span>{{ getFieldLabel(field) }}</span>\r\n          <span class=\"arrow-icon\">\r\n            <img src=\"@/assets/img/workflow/arrow-right.svg\"/>\r\n          </span>\r\n          <span v-if=\"getFieldValue(field)\">\r\n            <at-text :options=\"valueOptions\" :defaultSelectedList=\"getFieldTags(field)\" :defaultValue=\"getFieldValue(field).toString()\"/>\r\n          </span>\r\n          <span v-else></span>\r\n        </a-tag>\r\n      </div>\r\n      <div v-else>\r\n        <a-tag>--</a-tag>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue';\r\nimport {feiShuOperatorMap} from \"@/constants/feishu-table.js\";\r\nimport AtText from \"@/views/workflow/components/at-input/at-text.vue\";\r\n\r\nexport default {\r\n  name: \"feishu-table-render\",\r\n  components: {AtText, QuestionCircleOutlined},\r\n  props: {\r\n    nodeParams: {\r\n      type: Object\r\n    },\r\n    valueOptions: {\r\n      type: Array\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      operatorMap: feiShuOperatorMap,\r\n      actionState: {},\r\n    }\r\n  },\r\n  mounted() {\r\n    this.dataFormat()\r\n  },\r\n  watch: {\r\n    nodeParams: {\r\n      handler(newVal, oldVal) {\r\n        this.dataFormat()\r\n        this.$emit('updateSize')\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    dataFormat() {\r\n      let params = this.nodeParams?.plugin?.params || {}\r\n      let arg = params?.arguments || {}\r\n      let {config_name, table_name} = params || {}\r\n      this.actionState = {\r\n        ...params,\r\n        ...arg,\r\n        config_name,\r\n        table_name,\r\n      }\r\n      console.log('this.actionState', this.actionState)\r\n    },\r\n    getFieldLabel(field) {\r\n      return field?.properties?.[field?.current_properties_key]?.name || field?.name\r\n    },\r\n    getFieldValue(field) {\r\n      if (field?.media_component) {\r\n        const p = field?.properties?.[field?.current_properties_key] || {}\r\n        return p?.value ?? ''\r\n      }\r\n      return field?.value ?? ''\r\n    },\r\n    getFieldTags(field) {\r\n      if (field?.media_component) {\r\n        const p = field?.properties?.[field?.current_properties_key] || {}\r\n        return p?.atTags ?? []\r\n      }\r\n      return field?.atTags ?? []\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n._main {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  > div {\r\n    display: flex;\r\n\r\n    > .label {\r\n      flex-shrink: 0;\r\n      width: 100px;\r\n      text-align: right;\r\n    }\r\n\r\n    :deep(.ant-tag) {\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n    }\r\n  }\r\n}\r\n\r\n.field-box {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n\r\n  .field-tag {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n    margin: 0;\r\n    word-break: break-all;\r\n  }\r\n\r\n  .arrow-icon {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    margin: 0 4px;\r\n    padding: 0 4px;\r\n    height: 18px;\r\n    font-size: 12px;\r\n    border-radius: 4px;\r\n    background: #e4e6eb;\r\n\r\n    img {\r\n      width: 16px;\r\n      height: 16px;\r\n    }\r\n  }\r\n}\r\n\r\n.hint {\r\n  position: relative;\r\n  cursor: pointer;\r\n}\r\n.hint-pop {\r\n  position: absolute;\r\n  bottom: 30px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  font-size: 12px;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n  min-width: max-content;\r\n  min-height: 32px;\r\n  padding: 6px 8px;\r\n  color: #fff;\r\n  text-align: start;\r\n  text-decoration: none;\r\n  word-wrap: break-word;\r\n  background-color: rgba(0, 0, 0, 0.85);\r\n  border-radius: 6px;\r\n  box-shadow: 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05);\r\n\r\n  &::after {\r\n    content: '';\r\n    position: absolute;\r\n    bottom: -6px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    width: 0;\r\n    height: 0;\r\n    border-left: 8px solid transparent;\r\n    border-right: 8px solid transparent;\r\n    border-top: 8px solid rgba(0, 0, 0, 0.85);\r\n  }\r\n}\r\n.hint:hover .hint-pop {\r\n  opacity: 1;\r\n  pointer-events: auto;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"_main\">\r\n    <div v-if=\"actionState?.use_plugin_config\">\r\n      <span class=\"label\">配置：</span>\r\n      <a-tag>{{ actionState?.config_name || '--' }}</a-tag>\r\n    </div>\r\n    <div v-for=\"(item, idx) in (actionState?.rendering || [])\" :key=\"item.key || idx\">\r\n      <span class=\"label\">{{ item.label }}：</span>\r\n      <a-tag v-if=\"item.value\">\r\n        <at-text :options=\"valueOptions\" :defaultSelectedList=\"item.tags\" :defaultValue=\"item.value\" ref=\"atTextRef\" />\r\n      </a-tag>\r\n      <a-tag v-else>--</a-tag>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AtText from \"@/views/workflow/components/at-input/at-text.vue\";\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\n\r\nexport default {\r\n  name: \"feishu-table-render\",\r\n  inject: ['getGraph', 'setData'],\r\n  components: {AtText},\r\n  props: {\r\n    nodeParams: {\r\n      type: Object\r\n    },\r\n    valueOptions: {\r\n      type: Array\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      atTextRef: null,\r\n      actionState: {},\r\n    }\r\n  },\r\n  mounted() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.on('custom:setNodeName', this.onUpatateNodeName)\r\n    this.dataFormat()\r\n  },\r\n  onBeforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  watch: {\r\n    nodeParams: {\r\n      handler(newVal, oldVal) {\r\n        this.dataFormat()\r\n        this.$emit('updateSize')\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    onUpatateNodeName (data) {\r\n      if (!haveOutKeyNode.includes(data.node_type)) {\r\n        return\r\n      }\r\n\r\n      const patchTags = (tags) => {\r\n        if (!Array.isArray(tags) || tags.length === 0) {\r\n          return\r\n        }\r\n        tags.forEach((tag) => {\r\n          if (tag && tag.node_id == data.node_id) {\r\n            if (tag.label) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n            }\r\n            tag.node_name = data.node_name\r\n          }\r\n        })\r\n      }\r\n\r\n      const rendering = this.actionState?.rendering || []\r\n      rendering.forEach((item) => {\r\n        patchTags(item?.tags)\r\n      })\r\n\r\n      this.$nextTick(() => {\r\n        const atTextRef = this.$refs.atTextRef\r\n        const refList = Array.isArray(atTextRef) ? atTextRef : atTextRef ? [atTextRef] : []\r\n        refList.forEach((ref) => {\r\n          ref && ref.refresh && ref.refresh()\r\n        })\r\n        this.update()\r\n        this.dataFormat()\r\n        this.$emit('updateSize')\r\n      })\r\n    },\r\n    update() {\r\n      this.setData({\r\n        node_params: JSON.stringify(this.nodeParams)\r\n      })\r\n    },\r\n    dataFormat() {\r\n      let params = this.nodeParams?.plugin?.params || {}\r\n      let arg = params?.arguments || {}\r\n      let render = params?.rendering || {}\r\n\r\n      if (Array.isArray(params?.rendering)) {\r\n        const tagMap = params?.arguments?.tag_map || params?.tag_map || {}\r\n        params.rendering.forEach((item) => {\r\n          if (!item) return\r\n          if (!Array.isArray(item.tags) || item.tags.length === 0) {\r\n            const key = item.key\r\n            const tags = key && tagMap ? tagMap[key] : null\r\n            if (Array.isArray(tags) && tags.length) {\r\n              item.tags = tags\r\n            }\r\n          }\r\n        })\r\n      }\r\n      this.actionState = {\r\n        ...params,\r\n        ...arg,\r\n        ...render\r\n      }\r\n      // console.log('this.actionState', this.actionState)\r\n    },\r\n    getFieldLabel(field) {\r\n      return field?.properties?.[field?.current_properties_key]?.name || field?.name\r\n    },\r\n    getFieldValue(field) {\r\n      if (field?.media_component) {\r\n        const p = field?.properties?.[field?.current_properties_key] || {}\r\n        return p?.value ?? ''\r\n      }\r\n      return field?.value ?? ''\r\n    },\r\n    getFieldTags(field) {\r\n      if (field?.media_component) {\r\n        const p = field?.properties?.[field?.current_properties_key] || {}\r\n        return p?.atTags ?? []\r\n      }\r\n      return field?.atTags ?? []\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n._main {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  > div {\r\n    display: flex;\r\n\r\n    > .label {\r\n      flex-shrink: 0;\r\n      min-width: 70px;\r\n      text-align: right;\r\n    }\r\n\r\n    :deep(.ant-tag) {\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n    }\r\n  }\r\n}\r\n\r\n.hint {\r\n  position: relative;\r\n  cursor: pointer;\r\n}\r\n.hint-pop {\r\n  position: absolute;\r\n  bottom: 30px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  font-size: 12px;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n  min-width: max-content;\r\n  min-height: 32px;\r\n  padding: 6px 8px;\r\n  color: #fff;\r\n  text-align: start;\r\n  text-decoration: none;\r\n  word-wrap: break-word;\r\n  background-color: rgba(0, 0, 0, 0.85);\r\n  border-radius: 6px;\r\n  box-shadow: 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05);\r\n\r\n  &::after {\r\n    content: '';\r\n    position: absolute;\r\n    bottom: -6px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    width: 0;\r\n    height: 0;\r\n    border-left: 8px solid transparent;\r\n    border-right: 8px solid transparent;\r\n    border-top: 8px solid rgba(0, 0, 0, 0.85);\r\n  }\r\n}\r\n.hint:hover .hint-pop {\r\n  opacity: 1;\r\n  pointer-events: auto;\r\n}\r\n</style>\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :iconUrl=\"properties.node_icon || info.icon\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    style=\"min-width: 320px;min-height: 157px;\"\r\n  >\r\n    <div v-if=\"isMultiNode\" class=\"ding-group-node\">\r\n      <DynamicRender\r\n        :nodeParams=\"nodeParams\"\r\n        :business=\"business\"\r\n        :valueOptions=\"valueOptions\"\r\n        @updateSize=\"updateSize\"\r\n      />\r\n    </div>\r\n    <div v-else class=\"ding-group-node\">\r\n      <FeishuTableRender\r\n        v-if=\"isFeishuTbPlugin\"\r\n        :nodeParams=\"nodeParams\"\r\n        :business=\"business\"\r\n        :valueOptions=\"valueOptions\"\r\n        @updateSize=\"updateSize\"\r\n      />\r\n      <OfficialSendMessageRender\r\n        v-if=\"isOfficialSendMessagePlugin\"\r\n        :nodeParams=\"nodeParams\"\r\n        :business=\"business\"\r\n        :valueOptions=\"valueOptions\"\r\n        @updateSize=\"updateSize\"\r\n      />\r\n      <template v-else>\r\n        <div v-for=\"(item, key) in formState\" :key=\"key\">\r\n          <span class=\"label\">{{ item.name || key }}：</span>\r\n          <a-tag v-if=\"item.value\">\r\n            <at-text :options=\"valueOptions\" :defaultSelectedList=\"item.tags\" :defaultValue=\"item.value\" ref=\"atTextRef\" />\r\n          </a-tag>\r\n          <a-tag v-else>--</a-tag>\r\n        </div>\r\n      </template>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport {getPluginInfo, runPlugin} from \"@/api/plugins/index.js\";\r\nimport {pluginHasAction} from \"@/constants/plugin.js\";\r\nimport FeishuTableRender from \"./components/feishu-table-render.vue\";\r\nimport OfficialSendMessageRender from \"./components/official-send-message-render.vue\";\r\nimport DynamicRender from \"./components/dynamic-render.vue\";\r\nimport AtText from \"@/views/workflow/components/at-input/at-text.vue\";\r\nimport { pluginOutputToTree } from \"@/constants/plugin.js\";\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'QuestionNode',\r\n  components: {\r\n    AtText,\r\n    FeishuTableRender,\r\n    OfficialSendMessageRender,\r\n    DynamicRender,\r\n    NodeCommon\r\n  },\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      },\r\n    },\r\n    isSelected: {type: Boolean, default: false},\r\n    isHovered: {type: Boolean, default: false},\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.zm-plugins-node.index')\r\n    return {\r\n      t\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      atTextRef: null,\r\n      menus: [{name: 'btn_delete', key: 'delete', color: '#fb363f'}],\r\n      formState: {\r\n        // app_id: {\r\n        //   type: 'string',\r\n        //   desc: '微信公众号app_id'\r\n        //   name: 'app_id'\r\n        // }\r\n      },\r\n      nodeParams: {},\r\n      info: {},\r\n      isMultiNode: false,\r\n      pluginData: {},\r\n      valueOptions: []\r\n    }\r\n  },\r\n  computed: {\r\n    pluginName() {\r\n      return this.nodeParams?.plugin?.name || null\r\n    },\r\n    business() {\r\n      return this.nodeParams?.plugin?.params?.business || null\r\n    },\r\n    isFeishuTbPlugin() {\r\n      return this.pluginName === 'feishu_bitable'\r\n    },\r\n    isOfficialSendMessagePlugin() {\r\n      return this.pluginName === 'official_send_message'\r\n    }\r\n  },\r\n  mounted() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.on('custom:setNodeName', this.onUpatateNodeName)\r\n    this.init()\r\n  },\r\n  onBeforeUnmount() {\r\n    const graphModel = this.getGraph()\r\n    graphModel.eventCenter.off('custom:setNodeName', this.onUpatateNodeName)\r\n  },\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        if (newVal.dataRaw !== oldVal.dataRaw) {\r\n          this.nodeParamsFormat()\r\n          this.formStateFormat()\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    onUpatateNodeName(data) {\r\n      if (!haveOutKeyNode.includes(data.node_type)) {\r\n        return\r\n      }\r\n\r\n      this.valueOptions = this.getNode().getAllParentVariable() || []\r\n\r\n      const patchTags = (tags) => {\r\n        if (!Array.isArray(tags) || tags.length === 0) {\r\n          return\r\n        }\r\n\r\n        tags.forEach((tag) => {\r\n          if (tag && tag.node_id == data.node_id) {\r\n            if (tag.label) {\r\n              let arr = tag.label.split('/')\r\n              arr[0] = data.node_name\r\n              tag.label = arr.join('/')\r\n            }\r\n            tag.node_name = data.node_name\r\n          }\r\n        })\r\n      }\r\n\r\n      if (this.formState && typeof this.formState === 'object') {\r\n        Object.keys(this.formState).forEach((key) => {\r\n          patchTags(this.formState[key]?.tags)\r\n        })\r\n      }\r\n\r\n      const tagMaps = []\r\n\r\n      if (this.nodeParams?.plugin?.tag_map) {\r\n        tagMaps.push(this.nodeParams.plugin.tag_map)\r\n      }\r\n      if (this.nodeParams?.plugin?.params?.arguments?.tag_map) {\r\n        tagMaps.push(this.nodeParams.plugin.params.arguments.tag_map)\r\n      }\r\n\r\n      tagMaps.forEach((tagMap) => {\r\n        if (!tagMap || typeof tagMap !== 'object') {\r\n          return\r\n        }\r\n        Object.keys(tagMap).forEach((k) => {\r\n          patchTags(tagMap[k])\r\n        })\r\n      })\r\n\r\n      this.$nextTick(() => {\r\n        const atTextRef = this.$refs.atTextRef\r\n        const refList = Array.isArray(atTextRef) ? atTextRef : atTextRef ? [atTextRef] : []\r\n        refList.forEach((ref) => {\r\n          ref && ref.refresh && ref.refresh()\r\n        })\r\n\r\n        this.setData({\r\n          node_params: JSON.stringify(this.nodeParams)\r\n        })\r\n\r\n        this.updateSize()\r\n      })\r\n    },\r\n    async init() {\r\n      this.valueOptions = this.getNode().getAllParentVariable()\r\n      this.nodeParamsFormat()\r\n      await this.loadPluginInfo()\r\n      await this.loadPluginParams()\r\n      this.updateSize()\r\n    },\r\n    loadPluginInfo() {\r\n      return getPluginInfo({name: this.pluginName}).then(res => {\r\n        let data = res?.data || {}\r\n        this.info = data.remote || {}\r\n        this.isMultiNode = data?.local?.multiNode || false\r\n      }).catch(() => {\r\n        this.info = { icon: this.properties.node_icon || '' }\r\n        this.isMultiNode = false\r\n      })\r\n    },\r\n    loadPluginParams() {\r\n      return runPlugin({\r\n        name: this.pluginName,\r\n        action: \"default/get-schema\",\r\n        params: {}\r\n      }).then(res => {\r\n        this.pluginData = res?.data || {}\r\n        this.formStateFormat()\r\n        this.update(this.pluginData)\r\n      }).catch(() => {\r\n        this.pluginData = {}\r\n        this.formStateFormat()\r\n        this.update(this.pluginData)\r\n      })\r\n    },\r\n    nodeParamsFormat() {\r\n      this.nodeParams = JSON.parse(this.properties.node_params)\r\n    },\r\n    formStateFormat() {\r\n      if (this.isFeishuTbPlugin || this.isOfficialSendMessagePlugin) return\r\n      let data = JSON.parse(JSON.stringify(this.pluginData))\r\n      const customHandleFunc = {\r\n        official_account_profile: this.officialAccountHandle,\r\n        official_batch_tag: this.officialTagHandle,\r\n        official_send_template_message: this.officialTemplateHandle,\r\n        official_article: this.officialArticleHandle,\r\n        official_draft: this.officialDraftHandle,\r\n      }\r\n      if (customHandleFunc[this.pluginName] ) {\r\n        customHandleFunc[this.pluginName](data)\r\n      } else {\r\n        this.defaultHandle(data)\r\n      }\r\n      this.updateSize()\r\n    },\r\n    update (data) {\r\n      if (typeof data === 'string') {\r\n        data = JSON.parse(data)\r\n      }\r\n      const nodeParams = JSON.parse(this.properties.node_params)\r\n      const schemaAction = (this.business && data?.[this.business]) ? data[this.business] : data\r\n      const isAction = pluginHasAction(this.pluginName) || this.isMultiNode\r\n\r\n      const oldArgs = isAction\r\n        ? (nodeParams?.plugin?.params?.arguments || {})\r\n        : (nodeParams?.plugin?.params || {})\r\n\r\n      const updatedArgs = { ...oldArgs }\r\n      for (const key in (this.formState || {})) {\r\n        const meta = this.formState[key] || {}\r\n        const isDefaultableField = meta?.enum_component || meta?.radio_component\r\n        const def = meta?.enum_default\r\n        if (isDefaultableField && (updatedArgs[key] == null || String(updatedArgs[key]).trim() === '')) {\r\n          if (def != null && def !== '') {\r\n            updatedArgs[key] = def\r\n          }\r\n        }\r\n        const v = meta?.setting_cache_component\r\n        const isCache = v === true || v === 1 || v === 'true' || v === '1'\r\n        if (isCache) {\r\n          const val = String(meta?.value ?? '')\r\n          if (val !== '') {\r\n            updatedArgs[key] = val\r\n          } else {\r\n            const cacheVal = localStorage.getItem(this.getCacheKey(key))\r\n            if (cacheVal != null) {\r\n              updatedArgs[key] = String(cacheVal)\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      nodeParams.plugin = nodeParams.plugin || {}\r\n      nodeParams.plugin.params = nodeParams.plugin.params || {}\r\n      const currentUse = nodeParams?.plugin?.params?.use_plugin_config\r\n      nodeParams.plugin.params.use_plugin_config = (schemaAction && Object.prototype.hasOwnProperty.call(schemaAction, 'use_plugin_config'))\r\n        ? !!schemaAction.use_plugin_config\r\n        : !!currentUse\r\n\r\n      if (isAction) {\r\n        nodeParams.plugin.params.arguments = {\r\n          ...oldArgs,\r\n          ...updatedArgs,\r\n          tag_map: oldArgs.tag_map || {}\r\n        }\r\n      } else {\r\n        nodeParams.plugin.params = {\r\n          ...nodeParams.plugin.params,\r\n          ...updatedArgs\r\n        }\r\n      }\r\n      nodeParams.plugin.output_obj = pluginOutputToTree(schemaAction?.output || {})\r\n      const newNodeParamsStr = JSON.stringify(nodeParams)\r\n      if (this.properties.node_params !== newNodeParamsStr) {\r\n        this.setData({\r\n          ...this.properties,\r\n          node_params: newNodeParamsStr\r\n        })\r\n      }\r\n    },\r\n    defaultHandle(data) {\r\n      let args, tag_map\r\n      if (pluginHasAction(this.pluginName) || this.isMultiNode) {\r\n        this.formState = data?.[this.business]?.params || {}\r\n        args = this.nodeParams?.plugin?.params?.arguments || {}\r\n        tag_map = this.nodeParams?.plugin?.params?.arguments?.tag_map || {}\r\n      } else {\r\n        args = this.nodeParams?.plugin?.params || {}\r\n        tag_map = this.nodeParams?.plugin?.tag_map || {}\r\n        this.formState = data\r\n      }\r\n      for (let key in this.formState) {\r\n        this.formState[key].value = String(args[key] || '')\r\n        this.formState[key].tags = tag_map[key] || []\r\n        const v = this.formState[key]?.setting_cache_component\r\n        const enabled = v === true || v === 1 || v === 'true' || v === '1'\r\n        if (enabled) {\r\n          const cur = String(this.formState[key].value || '').trim()\r\n          if (!cur) {\r\n            const cacheVal = localStorage.getItem(this.getCacheKey(key))\r\n            if (cacheVal != null) {\r\n              this.formState[key].value = String(cacheVal)\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (this.isMultiNode) {\r\n        this.ensureMultiNodeRendering()\r\n      }\r\n    },\r\n    getCacheKey(fieldKey) {\r\n      let id = ''\r\n      let robotKey = ''\r\n      const hash = typeof window !== 'undefined' ? String(window.location.hash || '') : ''\r\n      if (hash.includes('?')) {\r\n        const query = hash.split('?')[1] || ''\r\n        query.split('&').forEach((pair) => {\r\n          const [k, v] = pair.split('=')\r\n          if (k === 'id') id = decodeURIComponent(v || '')\r\n          if (k === 'robot_key') robotKey = decodeURIComponent(v || '')\r\n        })\r\n      }\r\n      if (!id) {\r\n        id = String(localStorage.getItem('last_local_robot_id') || '')\r\n      }\r\n      const wfId = id || robotKey || ''\r\n      return `${wfId}:${this.pluginName}:${fieldKey}`\r\n    },\r\n    ensureMultiNodeRendering() {\r\n      const current = this.nodeParams?.plugin?.params?.rendering\r\n      if (Array.isArray(current) && current.length) {\r\n        const tag_map = this.nodeParams?.plugin?.params?.arguments?.tag_map || this.nodeParams?.plugin?.tag_map || {}\r\n        let changed = false\r\n        const list = current.map((item) => {\r\n          const key = item?.key\r\n          const originTags = Array.isArray(item?.tags) ? item.tags : []\r\n          if (originTags.length) return item\r\n\r\n          const nextTags = Array.isArray(tag_map?.[key])\r\n            ? tag_map[key]\r\n            : Array.isArray(this.formState?.[key]?.tags)\r\n              ? this.formState[key].tags\r\n              : []\r\n\r\n          if (nextTags.length) {\r\n            changed = true\r\n            return { ...item, tags: nextTags }\r\n          }\r\n          return item\r\n        })\r\n\r\n        if (changed) {\r\n          const nodeParams = JSON.parse(this.properties.node_params)\r\n          nodeParams.plugin = nodeParams.plugin || {}\r\n          nodeParams.plugin.params = nodeParams.plugin.params || {}\r\n          nodeParams.plugin.params.rendering = list\r\n\r\n          if (this.nodeParams?.plugin?.params) {\r\n            this.nodeParams.plugin.params.rendering = list\r\n          }\r\n\r\n          this.setData({\r\n            ...this.properties,\r\n            node_params: JSON.stringify(nodeParams)\r\n          })\r\n        }\r\n        return\r\n      }\r\n\r\n      const keys = Object.keys(this.formState || {})\r\n        .filter((key) => key !== 'app_secret')\r\n        .filter((key) => !this.formState?.[key]?.hide_official_component)\r\n        .filter((key) => !this.formState?.[key]?.advanced_settings)\r\n        .filter((key) => {\r\n          const v = this.formState?.[key]?.plugin_config_component\r\n          const enabled = v === true || v === 1 || v === 'true' || v === '1'\r\n          return !enabled\r\n        })\r\n        .filter((key) => {\r\n          const v = this.formState?.[key]?.setting_cache_component\r\n          const enabled = v === true || v === 1 || v === 'true' || v === '1'\r\n          return !enabled\r\n        })\r\n        .sort((a, b) => (+(this.formState?.[a]?.sort_num || 0)) - (+(this.formState?.[b]?.sort_num || 0)))\r\n\r\n      const args = this.nodeParams?.plugin?.params?.arguments || {}\r\n\r\n      const list = keys.map((key) => {\r\n        const meta = this.formState?.[key] || {}\r\n        let label = meta?.name || key\r\n        let value = String(meta?.value ?? '')\r\n        const tags = Array.isArray(meta?.tags) ? meta.tags : []\r\n\r\n        if (key === 'app_id') {\r\n          label = this.t('label_official_account_name')\r\n          value = String(args.app_name ?? this.formState?.app_name?.value ?? '')\r\n        }\r\n\r\n        if (meta?.enum_component || meta?.radio_component) {\r\n          const opt = (meta?.enum || []).find((e) => String(e?.value) === value) || (meta?.enum || []).find((e) => String(e?.value) === meta?.enum_default)\r\n          if (opt && opt.name) {\r\n            value = String(opt.name)\r\n          }\r\n        }\r\n\r\n        return { label, value, tags, key }\r\n      })\r\n      if (!list.length) return\r\n\r\n      const nodeParams = JSON.parse(this.properties.node_params)\r\n      nodeParams.plugin = nodeParams.plugin || {}\r\n      nodeParams.plugin.params = nodeParams.plugin.params || {}\r\n      nodeParams.plugin.params.rendering = list\r\n\r\n      if (this.nodeParams?.plugin?.params) {\r\n        this.nodeParams.plugin.params.rendering = list\r\n      }\r\n\r\n      this.setData({\r\n        ...this.properties,\r\n        node_params: JSON.stringify(nodeParams)\r\n      })\r\n    },\r\n    officialAccountHandle(data) {\r\n      delete data?.[this.business]?.params.app_id\r\n      delete data?.[this.business]?.params.app_secret\r\n      if (data?.[this.business]?.params) {\r\n        if (this.business === 'getTagFans') {\r\n          let args = this.nodeParams?.plugin?.params?.arguments || {}\r\n          let tag_map = this.nodeParams?.plugin?.params?.arguments?.tag_map || {}\r\n          this.formState = {\r\n            app_name: {type: 'string', name: this.t('label_official_account_name'), value: args.app_name, tags: []},\r\n          }\r\n          if (args.tag_type == 1) {\r\n            this.formState.tag_name = {type: 'string', name: this.t('label_tag_name'), value: args.tag_name, tags: []}\r\n          } else if (tag_map?.tagid?.length) {\r\n            this.formState.tagid = {type: 'string', name: this.t('label_tag_name'), value: args.tagid, tags: tag_map.tagid || []}\r\n          } else {\r\n            this.formState.tagid = {type: 'string', name: this.t('label_tag_id'), value: args.tagid, tags: []}\r\n          }\r\n          this.formState.next_openid = {type: 'string', name: this.t('label_last_batch_openid'), value: args.next_openid, tags: tag_map.next_openid || []}\r\n          this.updateSize()\r\n          return\r\n        } else {\r\n          // 为了让app_name显示在前面\r\n          data[this.business].params = {\r\n            app_name: {\r\n              type: 'string',\r\n              name: this.t('label_official_account_name'),\r\n            },\r\n            ...data[this.business].params\r\n          }\r\n        }\r\n      }\r\n      this.defaultHandle(data)\r\n    },\r\n    officialTemplateHandle() {\r\n      let args = this.nodeParams?.plugin?.params?.arguments || {}\r\n      let tag_map = this.nodeParams?.plugin?.params?.arguments?.tag_map || {}\r\n      this.formState = {\r\n        app_name: {type: 'string', name: this.t('label_official_account_name'), value: args.app_name, tags: []},\r\n        template_name: {type: 'string', name: this.t('label_template_name'), value: args.template_name, tags: []},\r\n        touser: {type: 'string', name: this.t('label_receiver'), value: args.touser, tags: tag_map.touser || []},\r\n      }\r\n      switch (args.link_type) {\r\n        case 0:\r\n          this.formState.link_type = {type: 'string', name: this.t('label_template_jump'), value: this.t('text_no_jump'), tags: []}\r\n          break\r\n        case 1:\r\n          this.formState.link_type = {type: 'string', name: this.t('label_template_jump'), value: this.t('text_jump_link'), tags: []}\r\n          this.formState.url = {type: 'string', name: this.t('label_jump_link'), value: args.url, tags: tag_map.url || []}\r\n          break\r\n        case 2:\r\n          this.formState.link_type = {type: 'string', name: this.t('label_template_jump'), value: this.t('text_jump_miniprogram'), tags: []}\r\n          this.formState.miniprogram_app = {type: 'string', name: this.t('label_miniprogram_appid'), ...args.miniprogram.appid }\r\n          this.formState.miniprogram_path = {type: 'string', name: this.t('label_miniprogram_path'), ...args.miniprogram.pagepath }\r\n          break\r\n      }\r\n      this.updateSize()\r\n    },\r\n    officialTagHandle() {\r\n      let args = this.nodeParams?.plugin?.params?.arguments || {}\r\n      let tag_map = this.nodeParams?.plugin?.params?.arguments?.tag_map || {}\r\n      this.formState = {\r\n        app_name: {type: 'string', name: this.t('label_official_account_name'), value: args.app_name, tags: []},\r\n        openid_list: {type: 'string', name: this.t('label_fans_openid_list'), value: args.openid_list, tags: []},\r\n      }\r\n      if (args.tag_type == 1) {\r\n        this.formState.tag_name = {type: 'string', name: this.t('label_tag_name'), value: args.tag_name, tags: []}\r\n      } else {\r\n        this.formState.tagid = {type: 'string', name: this.t('label_tag_name'), value: args.tagid, tags: tag_map.tagid || []}\r\n      }\r\n      this.updateSize()\r\n    },\r\n    officialArticleHandle() {\r\n      let args = this.nodeParams?.plugin?.params?.arguments || {}\r\n      let tag_map = this.nodeParams?.plugin?.params?.arguments?.tag_map || {}\r\n      this.formState = {\r\n        url: {type: 'string', name: '', value: args.url, tags: tag_map.url || []},\r\n        number: {type: 'string', name: '', value: args.number, tags: tag_map.number || []},\r\n      }\r\n      this.updateSize()\r\n    },\r\n    officialDraftHandle() {\r\n      let args = this.nodeParams?.plugin?.params?.arguments || {}\r\n      let tag_map = this.nodeParams?.plugin?.params?.arguments?.tag_map || {}\r\n      let article_type_text = !args.article_type ? '--' : args.article_type == 'news' ? this.t('text_news_message') : this.t('text_image_message')\r\n      switch (this.business) {\r\n        case 'add_draft':\r\n          this.formState = {\r\n            app_name: {type: 'string', name: this.t('label_official_account_name'), value: args.app_name, tags: []},\r\n            article_type: {type: 'string', name: this.t('label_article_type'), value: article_type_text, tags: []},\r\n          }\r\n          break\r\n        case 'update_draft':\r\n        case 'publish_draft':\r\n        case 'delete_draft':\r\n        case 'preview_message':\r\n        case 'get_draft':\r\n        default:\r\n          this.formState = {\r\n            app_name: {type: 'string', name: this.t('label_official_account_name'), value: args.app_name, tags: []},\r\n            media_id: {type: 'string', name: this.t('label_article_id'), value: args.media_id, tags: tag_map.media_id || []},\r\n          }\r\n          if (this.business === 'preview_message') {\r\n            this.formState.account = {type: 'string', name: this.t('label_receive_user'), value: args.account, tags: tag_map.account || []}\r\n          }\r\n          break\r\n      }\r\n      this.updateSize()\r\n    },\r\n    updateSize() {\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.ding-group-node {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  min-height: 52px;\r\n\r\n  > div {\r\n    display: flex;\r\n    word-break: break-all;\r\n\r\n    .label {\r\n      flex-shrink: 0;\r\n      text-align: right;\r\n      white-space: normal;\r\n    }\r\n\r\n    :deep(.ant-tag) {\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'zm-plugins-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2020%2020'%20class='design-iconfont'%3e%3crect%20width='20'%20height='20'%20rx='6'%20fill='%2338F'/%3e%3cg%20clip-path='url(%23cmdkkm1o9__clip0_12048_97931)'%20stroke='%23fff'%20stroke-width='1.16667'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M6.79163%2013.2109H5.04163V14.9609'/%3e%3cpath%20d='M14.9584%2014.9609H13.2084V13.2109'/%3e%3cpath%20d='M13.2084%206.78906H14.9584V5.03906'/%3e%3cpath%20d='M5.04163%205.03906H6.79163V6.78906'/%3e%3cpath%20d='M6.79163%205.125C5.21015%206.16842%204.16663%207.96112%204.16663%209.99757C4.16663%2010.295%204.18888%2010.5871%204.23181%2010.8726'/%3e%3cpath%20d='M10.875%2015.7708C10.5896%2015.8137%2010.2974%2015.8359%2010%2015.8359C7.96357%2015.8359%206.17086%2014.7924%205.12744%2013.2109'/%3e%3cpath%20d='M15.7682%209.125C15.8111%209.41043%2015.8334%209.70262%2015.8334%2010C15.8334%2012.0364%2014.7898%2013.8291%2013.2084%2014.8726'/%3e%3cpath%20d='M9.125%204.22925C9.41043%204.18632%209.70262%204.16406%2010%204.16406C12.0364%204.16406%2013.8291%205.20758%2014.8726%206.78906'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='cmdkkm1o9__clip0_12048_97931'%3e%3cpath%20fill='%23fff'%20transform='translate(3%203)'%20d='M0%200H14V14H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","<template>\r\n  <div\r\n    class=\"border-line line-left\"\r\n    :class=\"{ isSelected: isSelected, isHovered: isHovered }\"\r\n  ></div>\r\n  <div\r\n    class=\"border-line line-right\"\r\n    :class=\"{ isSelected: isSelected, isHovered: isHovered }\"\r\n  ></div>\r\n  <div class=\"border-line line-top\" :class=\"{ isSelected: isSelected, isHovered: isHovered }\"></div>\r\n  <div\r\n    class=\"border-line line-botttom\"\r\n    :class=\"{ isSelected: isSelected, isHovered: isHovered }\"\r\n  ></div>\r\n</template>\r\n\r\n<script setup>\r\nconst props = defineProps({\r\n  isSelected: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  isHovered: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.border-line {\r\n  position: absolute;\r\n\r\n  border-radius: 16px;\r\n  &.line-left {\r\n    left: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n\r\n    &.isHovered {\r\n      width: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      width: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n  &.line-right {\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    &.isHovered {\r\n      width: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      width: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n  &.line-top {\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n\r\n    &.isHovered {\r\n      height: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      height: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n  &.line-botttom {\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    &.isHovered {\r\n      height: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      height: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"custom-group-content\">\r\n    <BorderLine :isHovered=\"isHovered\" :isSelected=\"isSelected\" />\r\n    <div class=\"header-box\" :style=\"{ background: properties.node_header_bg_color }\">\r\n      <div class=\"top-block\">\r\n        <div class=\"title-block\">\r\n          <img src=\"@/assets/svg/custom-group-node.svg\" alt=\"\" />\r\n          <div class=\"title-text\">{{ props.properties.node_name }}</div>\r\n        </div>\r\n        <div class=\"btn-block\">\r\n          <a-popover :title=\"null\" trigger=\"click\" v-model:open=\"isShowMenu\" :arrow=\"false\" placement=\"right\">\r\n            <template #content>\r\n              <NodeListPopup style=\"height: 550px;width: 500px;\" :excludedNodeTypes=\"excludedNodeTypes\" @addNode=\"handleAddNode\" type=\"loop-node\" />\r\n            </template>\r\n            <a-tooltip :title=\"t('tooltip_create_inner_node')\">\r\n              <div class=\"btn-item\" @click.stop=\"handleClick\">\r\n                <PlusCircleOutlined />\r\n              </div>\r\n            </a-tooltip>\r\n          </a-popover>\r\n\r\n          <a-tooltip :title=\"t('tooltip_run_test')\">\r\n            <div class=\"btn-item\" @click.stop=\"handleOpenTestModal\">\r\n              <CaretRightOutlined />\r\n            </div>\r\n          </a-tooltip>\r\n\r\n          <a-dropdown trigger=\"click\">\r\n            <div class=\"btn-item\" @click.stop=\"\">\r\n              <img class=\"btn-icon\" src=\"@/assets/img/workflow/node-menu-btn.svg\" alt=\"\" />\r\n            </div>\r\n            <template #overlay>\r\n              <a-menu>\r\n                <a-menu-item @click=\"handleDelete\">\r\n                  <div style=\"color: #fb363f\">{{ t('btn_delete') }}</div>\r\n                </a-menu-item>\r\n              </a-menu>\r\n            </template>\r\n          </a-dropdown>\r\n        </div>\r\n      </div>\r\n      <div class=\"info-block\">\r\n        <div class=\"info-item\">\r\n          <div class=\"info-label\">{{ t('label_loop_type') }}</div>\r\n          <div class=\"info-content\">\r\n            <div class=\"label-text\" v-if=\"formState.loop_type == 'array'\">{{ t('text_loop_array') }}</div>\r\n            <div class=\"label-text\" v-if=\"formState.loop_type == 'number'\">{{ t('text_loop_number') }}</div>\r\n            <div class=\"label-value\" v-if=\"formState.loop_type == 'number'\">\r\n              {{ formState.loop_number }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"node-body\">\r\n      <div class=\"node-content\"></div>\r\n    </div>\r\n    <RunTest ref=\"runTestRef\" :loop_node_key=\"loop_node_key\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, computed } from 'vue'\r\nimport NodeListPopup from '../../node-list-popup/index.vue'\r\nimport { CaretRightOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\nimport RunTest from './components/run-test.vue'\r\nimport BorderLine from './components/border-line.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.custom-group-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  model: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  isHovered: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\nconst getGraph = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst addNode = inject('addNode')\r\nconst setData = inject('setData')\r\nconst resetSize = inject('resetSize')\r\nconst excludedNodeTypes = ref(['custom-group', 'batch-group', 'end-node', 'qa-node'])\r\n\r\nconst isShowMenu = ref(false)\r\n\r\nconst loop_node_key = computed(() => {\r\n  return getNode().id\r\n})\r\n\r\nfunction formatQuestionValue(val) {\r\n  if (val && typeof val === 'string') {\r\n    let lists = val.split('.')\r\n    let str1 = lists[0]\r\n    let str2 = lists.filter((item, index) => index > 0).join('.')\r\n    return [str1, str2]\r\n  } else if (val && typeof val === 'object' && val.length === 2) {\r\n    return val\r\n  }\r\n\r\n  return ['global', 'question']\r\n}\r\n\r\nconst handleAddNode = (node) => {\r\n  addNode(node)\r\n  isShowMenu.value = false\r\n}\r\nconst handleClick = () => {\r\n  isShowMenu.value = true\r\n}\r\n\r\nconst runTestRef = ref(null)\r\n\r\nconst handleOpenTestModal = () => {\r\n  runTestRef.value.open()\r\n}\r\n\r\nconst formState = reactive({\r\n  loop_type: 'array',\r\n  loop_number: '',\r\n  loop_arrays: [\r\n    {\r\n      key: '',\r\n      typ: 'array',\r\n      value: '',\r\n      cu_key: Math.random() * 10000\r\n    }\r\n  ],\r\n  intermediate_params: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      value: '',\r\n      cu_key: Math.random() * 10000\r\n    }\r\n  ],\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      value: '',\r\n      cu_key: Math.random() * 10000\r\n    }\r\n  ]\r\n})\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let loop = {}\r\n  try {\r\n    loop = JSON.parse(dataRaw).loop || {}\r\n  } catch (e) {\r\n    loop = {}\r\n  }\r\n\r\n  loop = JSON.parse(JSON.stringify(loop))\r\n\r\n  formState.loop_type = loop.loop_type\r\n  formState.loop_number = loop.loop_number\r\n  formState.loop_arrays = loop.loop_arrays\r\n  formState.intermediate_params = loop.intermediate_params\r\n  formState.output = loop.output\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    loop: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    ...formState,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nwatch(\r\n  () => props.properties,\r\n  () => {\r\n    reset()\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleDelete = () => {\r\n  let node = getNode()\r\n  getGraph().deleteNode(node.id)\r\n}\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  update()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.custom-group-content {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  background: #fff;\r\n  display: flex;\r\n  flex-direction: column;\r\n  border-radius: 8px;\r\n  // border: 1px solid #fff;\r\n  &.isHovered {\r\n    // border: 1px solid #2475fc;\r\n  }\r\n  &.isSelected {\r\n    // border: 2px solid #2475fc;\r\n    // &::before {\r\n    //   content: '';\r\n    //   position: absolute;\r\n    //   top: 0;\r\n    //   left: 0;\r\n    //   width: 100%;\r\n    //   height: 100%;\r\n    //   border-radius: 8px;\r\n    //   border: 2px solid #2475fc;\r\n    // }\r\n  }\r\n  .header-box {\r\n    padding: 16px;\r\n    overflow: hidden;\r\n\r\n    .top-block {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      .title-block {\r\n        display: flex;\r\n        align-items: center;\r\n        flex: 1;\r\n        gap: 8px;\r\n        color: #262626;\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n        img {\r\n          width: 20px;\r\n          height: 20px;\r\n        }\r\n      }\r\n      .btn-block {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        .btn-item {\r\n          width: 24px;\r\n          height: 24px;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          cursor: pointer;\r\n          border-radius: 6px;\r\n          transition: all 0.2s ease-in-out;\r\n          font-size: 16px;\r\n          &:hover {\r\n            background: #e4e6eb;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .info-block {\r\n    margin-top: 16px;\r\n    padding-left: 20px;\r\n    .info-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      .info-label {\r\n        color: #262626;\r\n        font-size: 14px;\r\n      }\r\n      .info-content {\r\n        display: flex;\r\n        width: fit-content;\r\n        border: 1px solid #d9d9d9;\r\n        background: #fff;\r\n        gap: 4px;\r\n        border-radius: 4px;\r\n        color: #595959;\r\n        height: 22px;\r\n        .label-text {\r\n          padding: 2px 2px 2px 4px;\r\n          font-size: 12px;\r\n          display: flex;\r\n          align-items: center;\r\n        }\r\n        .label-value {\r\n          border-radius: 4px;\r\n          background: #e4e6eb;\r\n          color: #595959;\r\n          font-size: 12px;\r\n          padding: 1px 4px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .node-body{\r\n    flex: 1;\r\n    border-radius: 6px;\r\n    padding: 0 16px 16px;\r\n  }\r\n  .node-content {\r\n    width: 100%;\r\n    height: 100%;\r\n    background: #f2f4f7;\r\n  }\r\n}\r\n</style>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { dynamicGroup } from '@logicflow/extension'\r\nimport { createApp, h, nextTick } from 'vue'\r\nimport CustomGroupComponent from './index.vue'\r\nimport { allParentVariableNodeWhiteList } from '../../util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.base-node')\r\n\r\nfunction transformArray(arr, parent) {\r\n  // 使用map处理数组并返回新的数组\r\n  return arr.map((item) => {\r\n    let node_id = parent ? parent.node_id : item.node_id\r\n    let node_name = parent ? parent.node_name : item.node_name\r\n    let node_type = parent ? parent.node_type : item.node_type\r\n    let label = item.name || item.key\r\n    let text = parent ? `${parent.text}.${label}` : label // 路径\r\n    let children = item.children || item.subs || []\r\n\r\n    let value = ''\r\n    let original_value = ''\r\n\r\n    if (node_type == 1) {\r\n      original_value = `global.${text}`\r\n    } else {\r\n      if (parent) {\r\n        original_value = `${parent.original_value}.${item.key}`\r\n      } else {\r\n        original_value = `${node_id}.${item.key}`\r\n      }\r\n    }\r\n\r\n    value = `【${original_value}】`\r\n\r\n    let data = {\r\n      label: label,\r\n      value: value,\r\n      original_value: original_value,\r\n      node_id: node_id,\r\n      node_name: node_name,\r\n      node_type: node_type,\r\n      text: text,\r\n      key: item.key,\r\n      id: node_id,\r\n      typ: item.typ,\r\n      children: children || []\r\n    }\r\n\r\n    // 递归处理子节点\r\n    if (data.children && data.children.length > 0) {\r\n      data.children = transformArray(data.children, data)\r\n    }\r\n\r\n    return data\r\n  })\r\n}\r\n\r\n// 自定义分组\r\nclass CustomGroup extends dynamicGroup.view {\r\n  constructor(props) {\r\n    super(props)\r\n    this.div = null\r\n    this.app = null\r\n  }\r\n\r\n  /**\r\n   * getShape: 在 super.getShape() 的基础上，追加一个 foreignObject。\r\n   */\r\n  getShape() {\r\n    // 1. 保留父类的基础 shape 结构\r\n    const shape = super.getShape()\r\n    const { model } = this.props\r\n    const { width, height, x, y } = model\r\n    this.div = flh('div', {\r\n      xmlns: 'http://www.w3.org/1999/xhtml',\r\n      style: 'width: 100%; height: 100%;'\r\n    })\r\n\r\n    // 3. 创建 foreignObject 并通过 push 添加到 shape 的子元素中\r\n    shape.props.children.push(\r\n      flh('foreignObject', {\r\n        // foreignObject 的坐标是相对于分组左上角的，所以用 0, 0\r\n        x: x - width / 2,\r\n        y: y - height / 2,\r\n        width,\r\n        height,\r\n        overflow: 'unset',\r\n        children: [this.div]\r\n      })\r\n    )\r\n\r\n    // 异步挂载Vue组件\r\n    this.mountVueComponentOnNextTick(this.props)\r\n    return shape\r\n  }\r\n\r\n  /**\r\n   * mountVueComponentOnNextTick: 负责在 DOM 渲染后挂载和更新 Vue 实例。\r\n   */\r\n  async mountVueComponentOnNextTick() {\r\n    // const { model, graphModel } = this.props\r\n    const mountPoint = this.div.__e\r\n\r\n    if (!mountPoint) {\r\n      setTimeout(() => this.mountVueComponentOnNextTick(), 100)\r\n      return\r\n    }\r\n\r\n\r\n    // 如果 Vue 实例不存在，则创建并挂载\r\n    if (!this.app) {\r\n      this.r = h(CustomGroupComponent, {\r\n        isSelected: this.props.model.isSelected,\r\n        isHovered: this.props.model.isHovered,\r\n        properties: this.props.model.getProperties()\r\n      })\r\n\r\n      this.app = createApp({\r\n        render: () => this.r,\r\n        provide: () => ({\r\n          getNode: () => this.props.model,\r\n          getGraph: () => this.props.graphModel,\r\n          addNode: (data) => {\r\n            this.props.graphModel.eventCenter.emit('custom:addGroupNode', {\r\n              data,\r\n              group_id: this.props.model.id\r\n            })\r\n          },\r\n          resetSize: () => {\r\n            if (this.r && this.r.el) {\r\n              // 获取高度\r\n              let height = this.r.el.clientHeight\r\n              let width = this.r.el.clientWidth\r\n              this.props.model.properties = {\r\n                ...this.props.model.properties,\r\n                width: width,\r\n                height: height\r\n              }\r\n\r\n              this.props.model._width = width\r\n              this.props.model._height = height\r\n\r\n              // 视图变化  边的线位置更新\r\n              this.props.model.refreshBranch()\r\n            }\r\n          },\r\n          setData: (data) => {\r\n            data.dataRaw = data.node_params\r\n            nextTick(() => {\r\n              this.props.model.properties = {\r\n                ...this.props.model.properties,\r\n                ...data\r\n              }\r\n              // 获取高度\r\n              let height = null\r\n\r\n              if (this.r && this.r.el) {\r\n                height = this.r.el.clientHeight\r\n              }\r\n\r\n              this.props.model._height = height || data.height || this.props.model.properties.height\r\n              this.props.model.refreshBranch() // 视图变化  边的线位置更新\r\n            })\r\n          },\r\n          setTitle: (title) => {\r\n            this.props.model.properties.node_name = title\r\n          }\r\n        })\r\n      })\r\n      this.app.mount(mountPoint)\r\n    } else if (this.r && this.r.component) {\r\n      // 如果实例已存在，则只更新 props\r\n      const newProperties = this.props.model.getProperties()\r\n      const oldProperties = this.r.component.props.properties\r\n\r\n      this.r.component.props.isSelected = this.props.model.isSelected\r\n      this.r.component.props.isHovered = this.props.model.isHovered\r\n\r\n      if (JSON.stringify(newProperties) !== JSON.stringify(oldProperties)) {\r\n        this.r.component.props.properties = newProperties\r\n      }\r\n    }\r\n  }\r\n\r\n  getAnchorShape(anchorData) {\r\n    let edges = this.props.graphModel.getNodeEdges(this.props.model.id)\r\n    let sourceAnchorIds = edges.map((edge) => edge.sourceAnchorId)\r\n    let targetAnchorIds = edges.map((edge) => edge.targetAnchorId)\r\n    let anchorIsSelected = false\r\n\r\n    const { x, y, type } = anchorData\r\n    const radius = 10 // 圆形的半径\r\n\r\n    if (type === 'left') {\r\n      anchorIsSelected = targetAnchorIds.includes(anchorData.id)\r\n    } else {\r\n      anchorIsSelected = sourceAnchorIds.includes(anchorData.id)\r\n    }\r\n\r\n    // 圆形的SVG元素\r\n    const circle = flh('circle', {\r\n      className: `custom-anchor-circle`,\r\n      cx: x,\r\n      cy: y,\r\n      r: radius,\r\n      fill: '#fff', // 你可以根据需要设置颜色\r\n      stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n      'stroke-width': 2 // 你可以根据需要设置边框宽度\r\n    })\r\n\r\n    // 向右箭头的SVG路径元素\r\n    const arrowPath = flh(\r\n      'g',\r\n      {\r\n        className: `custom-anchor-arrow`,\r\n        transform: `translate(${x - radius - 2}, ${y - radius - 2})`\r\n      },\r\n      [\r\n        flh('circle', {\r\n          cx: 12,\r\n          cy: 12,\r\n          r: radius,\r\n          fill: '#2475FC', // 你可以根据需要设置颜色\r\n          stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n          'stroke-width': 1 // 你可以根据需要设置边框宽度\r\n        }),\r\n        flh('path', {\r\n          d: `M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z`,\r\n          fill: '#fff' // 你可以根据需要设置箭头颜色\r\n        })\r\n      ]\r\n    )\r\n\r\n    // 加号的SVG路径元素\r\n    const plusPath = flh(\r\n      'g',\r\n      {\r\n        className: `custom-anchor-plus ${anchorIsSelected ? 'anchor-hide' : ''}`,\r\n        transform: `translate(${x - radius - 2}, ${y - radius - 2})`\r\n      },\r\n      [\r\n        flh('circle', {\r\n          cx: 12,\r\n          cy: 12,\r\n          r: radius,\r\n          fill: '#2475FC', // 你可以根据需要设置颜色\r\n          stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n          'stroke-width': 1 // 你可以根据需要设置边框宽度\r\n        }),\r\n        flh('line', {\r\n          x1: 12,\r\n          y1: 6,\r\n          x2: 12,\r\n          y2: 18,\r\n          strokeWidth: 2.4,\r\n          strokeLinecap: 'round',\r\n          strokeLinejoin: 'round',\r\n          stroke: '#fff' // 你可以根据需要设置箭头颜色\r\n        }),\r\n        flh('line', {\r\n          x1: 6,\r\n          y1: 12,\r\n          x2: 18,\r\n          y2: 12,\r\n          strokeWidth: 2.4,\r\n          strokeLinecap: 'round',\r\n          strokeLinejoin: 'round',\r\n          stroke: '#fff' // 你可以根据需要设置箭头颜色\r\n        })\r\n      ]\r\n    )\r\n\r\n    // 创建一个SVG组元素来包含圆形和箭头\r\n    const group = flh(\r\n      'g',\r\n      {\r\n        id: anchorData.id,\r\n        className: `custom-anchor custom-anchor-${type} ${anchorIsSelected ? 'anchor-selected' : 'anchor-not-selected'}`,\r\n        onClick: (e) => {\r\n          e.stopPropagation()\r\n\r\n          const { graphModel, model } = this.props\r\n\r\n          if (type === 'right' && !anchorIsSelected) {\r\n            graphModel.eventCenter.emit('custom:showPopupMenu', { anchorData, model })\r\n          }\r\n        }\r\n      },\r\n      circle,\r\n      arrowPath,\r\n      plusPath\r\n    )\r\n\r\n    return group\r\n  }\r\n\r\n  /**\r\n   * 销毁时卸载 Vue 实例\r\n   */\r\n  destroy() {\r\n    if (this.app) {\r\n      this.app.unmount()\r\n      this.app = null\r\n    }\r\n    super.destroy()\r\n  }\r\n}\r\n\r\nclass CustomGroupModel extends dynamicGroup.model {\r\n  initNodeData(data) {\r\n    super.initNodeData(data)\r\n    this.DEFAULT_TOP_Z_INDEX = Number.MAX_SAFE_INTEGER // 永远不会触发重置\r\n    this.DEFAULT_BOTTOM_Z_INDEX = 1\r\n    this.topGroupZIndex = 1\r\n    this.width = data.width || 600\r\n    this.height = data.height || 420\r\n    this.zIndex = 1\r\n    this.collapsible = false\r\n    this.isRestrict = false // 限制拖出去\r\n    this.autoResize = false // 跟随节点 调整宽度\r\n    this.radius = 8\r\n    this.allowResize = false\r\n    this.autoExpand = false\r\n    this.transformWithContainer = true\r\n    this.allowRotate = true\r\n    this.stopMoveGraph = false\r\n    this.autoToFront = false;\r\n    this.properties = {\r\n      ...this.properties,\r\n      transformWithContainer: true, \r\n    }\r\n  }\r\n\r\n  setSelected(isSelected){\r\n    super.setSelected(isSelected)\r\n    // setTimeout(() => {\r\n    //   this.setZIndex(this.zIndex < 0 ? 1 : this.zIndex)\r\n    // }, 50);\r\n  }\r\n\r\n  // 自定义分组样式\r\n  getNodeStyle() {\r\n    const style = super.getNodeStyle()\r\n    // 将默认背景设置为透明，因为背景由我们的 Vue 组件控制\r\n    // 这可以防止父类矩形和我们的组件背景重叠\r\n    style.stroke = 'none'\r\n    style.strokeWidth = 2\r\n    style.fill = '#F0F2F5'\r\n    style.filter = 'drop-shadow(0 2px 3px rgba(0, 0, 0, 0.2))'\r\n    // 边框也可以在Vue组件里实现，这里设为透明\r\n    return style\r\n  }\r\n\r\n  getOutlineStyle() {\r\n    const style = super.getOutlineStyle()\r\n    style.stroke = 'none'\r\n    style.hover.stroke = 'none'\r\n\r\n    return style\r\n  }\r\n  getAnchorLineStyle() {\r\n    const style = super.getAnchorLineStyle()\r\n    style.stroke = '#2475FC'\r\n    return style\r\n  }\r\n\r\n  getAddableOutlineStyle() {\r\n    const style = super.getAddableOutlineStyle()\r\n    style.stroke = '#52c41a'\r\n    style.strokeDasharray = '4 4'\r\n    style.strokeWidth = 2\r\n    return style\r\n  }\r\n\r\n  isAllowAppendIn(nodeData) {\r\n    return !nodeData.properties.disabled_add_group\r\n  }\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: t('err_only_right_anchor'),\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: t('err_group_connection_rule'),\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: t('err_only_left_anchor'),\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 28,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 28,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return defaultAnchor\r\n  }\r\n\r\n  getAllParentVariable() {\r\n    const parentNodes = []\r\n    const visited = new Set()\r\n    const edges = this.incoming.edges\r\n    const { nodes } = this.graphModel\r\n\r\n    let startNode = nodes.find((node) => node.type === 'start-node')\r\n    // 插入起始节点(起始节点必传)\r\n    if (startNode) {\r\n      visited.add(startNode.id)\r\n      parentNodes.push(startNode)\r\n    }\r\n\r\n    // 递归函数用于遍历父节点\r\n    const traverseParents = (edges) => {\r\n      for (let i = 0; i < edges.length; i++) {\r\n        let edge = edges[i]\r\n        let node = edge.sourceNode\r\n\r\n        if (visited.has(node.id)) continue\r\n\r\n        visited.add(node.id)\r\n\r\n        if (allParentVariableNodeWhiteList.includes(node.type)) {\r\n          parentNodes.push(node)\r\n        }\r\n\r\n        traverseParents(node.incoming.edges)\r\n      }\r\n    }\r\n\r\n    // 获取所有父节点\r\n    traverseParents(edges)\r\n\r\n\r\n    let childernNodes = nodes.filter(item => item.properties.loop_parent_key == this.id)\r\n    childernNodes.forEach(item => {\r\n      parentNodes.push(item)\r\n    })\r\n\r\n\r\n    // 取出输出的变量\r\n    let variableArr = []\r\n\r\n    for (const node of parentNodes) {\r\n      // 如果节点类型既不是http-node也不是start-node，则跳过当前循环\r\n      if (!allParentVariableNodeWhiteList.includes(node.type)) {\r\n        continue\r\n      }\r\n\r\n      let node_params = JSON.parse(node.properties.node_params)\r\n\r\n      let obj = {\r\n        label: node.properties.node_name,\r\n        value: node.id,\r\n        node_id: node.id,\r\n        node_type: node.properties.node_type,\r\n        typ: 'node',\r\n        children: [],\r\n        loop_parent_key: node.properties.loop_parent_key,\r\n        group_node_key: this.id\r\n      }\r\n\r\n      if (node.type === 'http-node') {\r\n        obj.children = node_params.curl.output\r\n      }\r\n\r\n      if (node.type === 'http-tool-node') {\r\n        obj.children = node_params.curl.output\r\n      }\r\n\r\n      if (node.type === 'code-run-node') {\r\n        obj.children = node_params.code_run.output\r\n      }\r\n\r\n      if (node.type === 'parameter-extraction-node') {\r\n        obj.children = node_params.params_extractor.output\r\n      }\r\n\r\n      if (node.type === 'start-node') {\r\n        obj.children = [...node_params.start.diy_global, ...node_params.start.sys_global]\r\n      }\r\n\r\n      if (node.type === 'custom-group') {\r\n        obj.children = node_params.loop.output\r\n      }\r\n\r\n      if(node.type === 'import-library-node'){\r\n        obj.children = node_params.library_import.outputs\r\n      }\r\n\r\n      if(node.type === 'qa-node'){\r\n        obj.children = node_params.question.outputs\r\n      }\r\n      \r\n      if(node.type === 'json-node'){\r\n        obj.children = node_params.json_encode.output\r\n      }\r\n\r\n      if(node.type === 'json-reverse-node'){\r\n        obj.children = node_params.json_decode.output\r\n      }\r\n\r\n      if (node.type === 'select-data-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'output_list',\r\n            typ: 'array<object>',\r\n            name: 'output_list',\r\n            label: 'output_list'\r\n          },\r\n          {\r\n            key: 'row_num',\r\n            typ: 'integer',\r\n            name: 'row_num',\r\n            label: 'row_num'\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'knowledge-base-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.lib_paragraph_list',\r\n            typ: 'string',\r\n            name: t('var_knowledge_base_reference'),\r\n            label: t('var_knowledge_base_reference')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'ai-dialogue-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.llm_reply_content',\r\n            typ: 'string',\r\n            name: t('var_ai_reply_content'),\r\n            label: t('var_ai_reply_content')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'specify-reply-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.llm_reply_content',\r\n            typ: 'string',\r\n            name: t('var_message_content'),\r\n            label: t('var_message_content')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'immediately-reply-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.llm_reply_content',\r\n            typ: 'string',\r\n            name: t('var_message_content'),\r\n            label: t('var_message_content')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'problem-optimization-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.question_optimize_reply_content',\r\n            typ: 'string',\r\n            name: t('var_question_optimization_result'),\r\n            label: t('var_question_optimization_result')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'mcp-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.mcp_reply_content',\r\n            typ: 'string',\r\n            name: 'text',\r\n            label: t('var_tool_generated_content')\r\n          }\r\n        ]\r\n      }\r\n      if(node.type === 'image-generation-node'){\r\n        let image_num = node_params.image_generation.image_num \r\n        if(image_num > 0){\r\n          let list = []\r\n          for (let i = 0; i < +image_num; i++) {\r\n            let letter = String.fromCharCode('a'.charCodeAt(0) + i)\r\n            list.push({\r\n              key: `picture_url_${letter}`,\r\n              typ: 'string',\r\n              name: `picture_url_${letter}`,\r\n              label: `picture_url_${letter}`,\r\n            })\r\n          }\r\n          obj.children = list\r\n        }\r\n      }\r\n\r\n      if (node.type === 'zm-plugins-node') {\r\n        let output = node_params.plugin.output_obj ? JSON.parse(JSON.stringify(node_params.plugin.output_obj)) : []\r\n        \r\n        const loop = (arr) => {\r\n          arr.forEach((item) => {\r\n            item.name = item.key || ''\r\n            if (item.subs && item.subs.length > 0) {\r\n              loop(item.subs)\r\n            }\r\n          })\r\n        }\r\n\r\n        loop(output)\r\n\r\n        obj.children = output || []\r\n      }\r\n\r\n      obj.children.forEach((variable) => {\r\n        variable.node_id = node.id\r\n        variable.node_name = node.properties.node_name\r\n        variable.node_type = node.properties.node_type\r\n      })\r\n\r\n      obj.children = transformArray(obj.children, null)\r\n\r\n      variableArr.push(obj)\r\n    }\r\n\r\n    return variableArr\r\n  }\r\n  refreshBranch() {\r\n    // 更新节点连接边的path\r\n    this.incoming.edges.forEach((edge) => {\r\n      // 调用自定义的更新方案\r\n      edge.updatePathByAnchor()\r\n    })\r\n    this.outgoing.edges.forEach((edge) => {\r\n      edge.updatePathByAnchor()\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'custom-group',\r\n  view: CustomGroup,\r\n  model: CustomGroupModel\r\n}\r\n","<style lang=\"less\" scoped>\r\n.start-node {\r\n  position: relative;\r\n  padding-top: 8px;\r\n  .node-desc {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n\r\n  .start-node-options {\r\n    display: flex;\r\n    gap: 4px;\r\n    .options-title {\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n    .options-list {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n    .options-item {\r\n      display: flex;\r\n      align-items: center;\r\n      height: 22px;\r\n      padding: 2px 2px 2px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &.is-required .option-label::before {\r\n        vertical-align: middle;\r\n        content: '*';\r\n        color: #fb363f;\r\n        margin-right: 2px;\r\n      }\r\n\r\n      .option-label {\r\n        color: var(--wf-color-text-3);\r\n        font-size: 12px;\r\n        margin-right: 4px;\r\n      }\r\n\r\n      .option-type {\r\n        height: 18px;\r\n        line-height: 18px;\r\n        padding: 0 8px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        background-color: #e4e6eb;\r\n        color: var(--wf-color-text-3);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    :hide-menus=\"true\"\r\n    style=\"width: 200px\"\r\n  >\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\n\r\nexport default {\r\n  name: 'groupStartNode',\r\n  components: {\r\n    NodeCommon\r\n  },\r\n  inject: ['resetSize'],\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  data() {\r\n    return {}\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    properties: {\r\n      handler() {\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  mounted() {\r\n  },\r\n  methods: {}\r\n}\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    this.width = 200\r\n    this.height = 72\r\n    \r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        isHovered,\r\n        isSelected,\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'group-start-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.end-node {\r\n  .node-desc {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    @handleMenu=\"handleMenu\"\r\n    style=\"width: 420px; height: 116px;\"\r\n  >\r\n    <div class=\"end-node\">\r\n      <div class=\"node-desc\">{{ t('msg_terminate_desc') }}</div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'EndNode',\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  components: {\r\n    NodeCommon\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: { type: Boolean, default: false },\r\n    isHovered: { type: Boolean, default: false }\r\n  },\r\n  data() {\r\n    return {\r\n      menus: []\r\n    }\r\n  },\r\n  computed: {\r\n    t() {\r\n      return useI18n('views.workflow.components.nodes.terminate-node.index').t\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      this.resetSize()\r\n    })\r\n  },\r\n  methods: {\r\n    handleMenu() {\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'terminate-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.start-node {\r\n  position: relative;\r\n\r\n  .start-node-options {\r\n    display: flex;\r\n    gap: 4px;\r\n  }\r\n  .options-title {\r\n    line-height: 22px;\r\n    margin-right: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n  }\r\n  .options-list {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  .options-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 22px;\r\n    padding: 2px 2px 2px 4px;\r\n    border-radius: 4px;\r\n    border: 1px solid #d9d9d9;\r\n\r\n    &.is-required .option-label::before {\r\n      vertical-align: middle;\r\n      content: '*';\r\n      color: #fb363f;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .option-type {\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      background-color: #e4e6eb;\r\n      color: var(--wf-color-text-3);\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-url=\"properties.node_icon\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"start-node\">\r\n      <div class=\"start-node-options\" v-if=\"formState.type == 'select_time'\">\r\n        <div class=\"options-title\">{{ t('label_execution_time') }}</div>\r\n        <div class=\"options-list\">\r\n          <div class=\"options-item\">\r\n            <div class=\"option-label\" v-if=\"formState.every_type == 'day'\">\r\n              {{ t('text_every_day') }} {{ formState.hour_minute }}\r\n            </div>\r\n            <div class=\"option-label\" v-if=\"formState.every_type == 'week'\">\r\n              {{ t('text_every_week') }} {{ t(week_number_map[formState.week_number]) }} {{ formState.hour_minute }}\r\n            </div>\r\n            <div class=\"option-label\" v-if=\"formState.every_type == 'month'\">\r\n              {{ t('text_every_month') }}\r\n              <span v-if=\"formState.month_day\">{{ formState.month_day }}{{ t('text_day_suffix') }}</span>\r\n              {{ formState.hour_minute }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"start-node-options\" v-else>\r\n        <div class=\"options-title\">{{ t('label_execution_time') }}</div>\r\n        <div class=\"options-list\">\r\n          <div class=\"options-item\">\r\n            <div class=\"option-label\">{{ t('text_linux_crontab_code') }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { nextTick, onMounted, inject, watch, reactive } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.timing-trigger-node.index')\r\n\r\nconst resetSize = inject('resetSize')\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default() {\r\n      return {}\r\n    }\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nwatch(\r\n  () => props.properties,\r\n  (newVal, oldVal) => {\r\n    const newDataRaw = newVal.node_params || '{}'\r\n    const oldDataRaw = oldVal.node_params || '{}'\r\n    if (newDataRaw != oldDataRaw) {\r\n      reset()\r\n    }\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nlet week_number_map = {\r\n  1: 'text_monday',\r\n  2: 'text_tuesday',\r\n  3: 'text_wednesday',\r\n  4: 'text_thursday',\r\n  5: 'text_friday',\r\n  6: 'text_saturday',\r\n  0: 'text_sunday'\r\n}\r\nconst formState = reactive({\r\n  type: 'select_time',\r\n  every_type: 'day',\r\n  week_number: '',\r\n  month_day: '',\r\n  hour_minute: '',\r\n  linux_crontab: ''\r\n})\r\n\r\nconst reset = () => {\r\n  if (!props.properties || !props.properties.node_params) {\r\n    return\r\n  }\r\n\r\n  let node_params = JSON.parse(props.properties.node_params)\r\n  let cron_config = node_params.trigger.cron_config || {}\r\n\r\n  Object.assign(formState, cron_config)\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  reset()\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    // this.width = 420\r\n    // this.height = 102\r\n    // 当节点作为边的起始节点（source）时的校验规则\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        isHovered,\r\n        isSelected,\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'timing-trigger-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.start-node {\r\n  position: relative;\r\n\r\n  .start-node-options {\r\n    display: flex;\r\n    gap: 4px;\r\n    margin-top: 12px;\r\n  }\r\n  .options-title {\r\n    line-height: 22px;\r\n    margin-right: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n  }\r\n  .options-list {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  .options-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 22px;\r\n    padding: 2px 2px 2px 4px;\r\n    border-radius: 4px;\r\n    border: 1px solid #d9d9d9;\r\n\r\n    &.is-required .option-label::before {\r\n      vertical-align: middle;\r\n      content: '*';\r\n      color: #fb363f;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .option-type {\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      background-color: #e4e6eb;\r\n      color: var(--wf-color-text-3);\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-url=\"properties.node_icon\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"start-node\">\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('label_trigger_event') }}</div>\r\n        <div class=\"options-list\">\r\n          <div class=\"options-item\">\r\n            <div class=\"option-label\">{{ t(msg_type_map[formState.msg_type]) }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\" @click=\"test\">{{ t('label_official_account') }}</div>\r\n        <div class=\"options-list\">\r\n          <div class=\"options-item\" v-for=\"item in selectAppItems.slice(0, 1)\" :key=\"item.app_id\">\r\n            <div class=\"option-label\">{{ item.app_name }}</div>\r\n          </div>\r\n          <div class=\"options-item\" v-if=\"selectAppItems.length > 1\">\r\n            <div class=\"option-label\">...</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('label_output') }}</div>\r\n        <div class=\"options-list\">\r\n          <div\r\n            class=\"options-item\"\r\n            :class=\"{ 'is-required': item.required }\"\r\n            v-for=\"item in options.slice(0, 2)\"\r\n            :key=\"item.key\"\r\n          >\r\n            <div class=\"option-label\">{{ item.key }}</div>\r\n            <div class=\"option-type\">{{ item.typ }}</div>\r\n          </div>\r\n          <div class=\"options-item\" v-if=\"options.length > 2\">\r\n            <div class=\"option-label\">...</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { nextTick, onMounted, inject, watch, reactive, ref, computed } from 'vue'\r\nimport { useWorkflowStore } from '@/stores/modules/workflow'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.official-trigger-node.index')\r\n\r\nconst workflowStore = useWorkflowStore()\r\n\r\nconst resetSize = inject('resetSize')\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default() {\r\n      return {}\r\n    }\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst officialList = computed(() => workflowStore.officialList)\r\nwatch(\r\n  () => props.properties,\r\n  (newVal, oldVal) => {\r\n    const newDataRaw = newVal.node_params || '{}'\r\n    const oldDataRaw = oldVal.node_params || '{}'\r\n    if (newDataRaw != oldDataRaw) {\r\n      reset()\r\n    }\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nlet msg_type_map = {\r\n  message: 'text_private_message',\r\n  subscribe_unsubscribe: 'text_subscribe_unsubscribe',\r\n  qrcode_scan: 'text_qrcode_scan',\r\n  menu_click: 'text_menu_click'\r\n}\r\n\r\nconst formState = reactive({\r\n  msg_type: '',\r\n  app_ids: []\r\n})\r\n\r\nconst selectAppItems = computed(() => {\r\n  return formState.app_ids.map((item) => officialList.value.find((it) => it.app_id == item)).filter(Boolean)\r\n})\r\n\r\nconst outputs = ref([])\r\n\r\nconst options = computed(() => {\r\n  return [...outputs.value]\r\n})\r\n\r\nconst reset = () => {\r\n  if (!props.properties || !props.properties.node_params) {\r\n    return\r\n  }\r\n\r\n  let node_params = JSON.parse(props.properties.node_params)\r\n\r\n  outputs.value = node_params.trigger.outputs || []\r\n\r\n  let trigger_official_config = node_params.trigger.trigger_official_config\r\n\r\n  formState.msg_type = trigger_official_config.msg_type\r\n  formState.app_ids = trigger_official_config.app_ids\r\n    ? trigger_official_config.app_ids.split(',')\r\n    : []\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst test = ()=>{\r\n  let aa = officialList.value.find((it) => it.app_id == 'sdwdw')\r\n  console.log(selectAppItems.value,aa, '==')\r\n}\r\n\r\nonMounted(() => {\r\n  reset()\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    // this.width = 420\r\n    // this.height = 102\r\n    // 当节点作为边的起始节点（source）时的校验规则\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        isHovered,\r\n        isSelected,\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'official-trigger-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2020%2020'%20class='design-iconfont'%3e%3crect%20width='20'%20height='20'%20rx='6'%20fill='%2338F'/%3e%3cpath%20d='M12.4647%206.7C12.573%206.69991%2012.6803%206.72119%2012.7804%206.76263C12.8805%206.80406%2012.9714%206.86484%2013.048%206.94148C13.1246%207.01811%2013.1853%207.1091%2013.2266%207.20923C13.268%207.30936%2013.2892%207.41667%2013.289%207.525V14.675C13.289%2014.8937%2013.2022%2015.1034%2013.0476%2015.2581C12.893%2015.4128%2012.6834%2015.4998%2012.4647%2015.5H5.32363C5.21533%2015.5001%205.10807%2015.4788%205.00801%2015.4374C4.90796%2015.3959%204.81706%2015.3351%204.74055%2015.2585C4.66403%2015.1818%204.6034%2015.0908%204.56212%2014.9907C4.52084%2014.8906%204.49973%2014.7833%204.5%2014.675V7.525C4.5%207.30643%204.58673%207.0968%204.74115%206.94212C4.89557%206.78744%205.10506%206.70036%205.32363%206.7H12.4654H12.4647ZM8.8945%208.7625C8.82228%208.76241%208.75075%208.77658%208.68402%208.80419C8.61729%208.83181%208.55667%208.87233%208.50563%208.92343C8.4546%208.97453%208.41415%209.0352%208.38662%209.10197C8.35909%209.16873%208.34501%209.24028%208.34519%209.3125V10.55H7.10906C7.00013%2010.5497%206.89358%2010.5818%206.80294%2010.6423C6.71231%2010.7027%206.64168%2010.7887%206.60005%2010.8894C6.55841%2010.99%206.54765%2011.1008%206.56912%2011.2076C6.59059%2011.3144%206.64332%2011.4124%206.72063%2011.4891C6.82375%2011.5922%206.96331%2011.65%207.10906%2011.65H8.34519V12.8875C8.34537%2012.9961%208.37768%2013.1021%208.43804%2013.1924C8.4984%2013.2826%208.58412%2013.3529%208.68439%2013.3946C8.78466%2013.4362%208.895%2013.4472%209.00151%2013.4262C9.10803%2013.4052%209.20595%2013.3532%209.28294%2013.2766C9.334%2013.2255%209.37449%2013.1648%209.40209%2013.0981C9.42969%2013.0313%209.44387%2012.9597%209.44381%2012.8875V11.65H10.6799C10.7887%2011.6501%2010.8951%2011.618%2010.9856%2011.5576C11.0761%2011.4972%2011.1466%2011.4113%2011.1882%2011.3108C11.2298%2011.2103%2011.2406%2011.0996%2011.2193%2010.993C11.198%2010.8863%2011.1454%2010.7883%2011.0684%2010.7116C11.0174%2010.6604%2010.9569%2010.6198%2010.8902%2010.5921C10.8236%2010.5644%2010.7521%2010.5501%2010.6799%2010.55H9.44313V9.3125C9.44313%209.16675%209.38527%209.02696%209.28228%208.92383C9.17928%208.82071%209.03956%208.76268%208.89381%208.7625H8.8945ZM14.8139%204.5C14.9839%204.5003%2015.1477%204.56357%2015.2738%204.67758C15.3999%204.7916%2015.4792%204.94828%2015.4966%205.11737L15.5%205.1875V12.0666C15.5003%2012.1982%2015.4628%2012.327%2015.392%2012.4379C15.3213%2012.5488%2015.2202%2012.637%2015.1007%2012.6922C14.9813%2012.7473%2014.8486%2012.7671%2014.7183%2012.7491C14.588%2012.731%2014.4656%2012.676%2014.3656%2012.5905C14.2316%2012.4752%2014.1471%2012.3127%2014.1298%2012.1367L14.1264%2012.0666V6.14931C14.1263%206.08512%2014.1038%206.02296%2014.0628%205.97361C14.0217%205.92427%2013.9647%205.89084%2013.9016%205.87912L13.8521%205.87431H7.93269C7.76272%205.87433%207.5988%205.81127%207.47268%205.69734C7.34655%205.58341%207.2672%205.42672%207.25%205.25762L7.24656%205.1875C7.24649%205.01749%207.30941%204.85349%207.42318%204.72715C7.53694%204.60082%207.69348%204.52112%207.86256%204.50344L7.93338%204.5H14.8125H14.8139Z'%20fill='%23fff'/%3e%3c/svg%3e\"","<template>\r\n  <div\r\n    class=\"border-line line-left\"\r\n    :class=\"{ isSelected: isSelected, isHovered: isHovered }\"\r\n  ></div>\r\n  <div\r\n    class=\"border-line line-right\"\r\n    :class=\"{ isSelected: isSelected, isHovered: isHovered }\"\r\n  ></div>\r\n  <div class=\"border-line line-top\" :class=\"{ isSelected: isSelected, isHovered: isHovered }\"></div>\r\n  <div\r\n    class=\"border-line line-botttom\"\r\n    :class=\"{ isSelected: isSelected, isHovered: isHovered }\"\r\n  ></div>\r\n</template>\r\n\r\n<script setup>\r\nconst props = defineProps({\r\n  isSelected: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  isHovered: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.border-line {\r\n  position: absolute;\r\n\r\n  border-radius: 16px;\r\n  &.line-left {\r\n    left: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n\r\n    &.isHovered {\r\n      width: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      width: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n  &.line-right {\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    &.isHovered {\r\n      width: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      width: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n  &.line-top {\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n\r\n    &.isHovered {\r\n      height: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      height: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n  &.line-botttom {\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    &.isHovered {\r\n      height: 1px;\r\n      background: #2475fc;\r\n    }\r\n    &.isSelected {\r\n      height: 2px;\r\n      background: #2475fc;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"custom-group-content\">\r\n    <BorderLine :isHovered=\"isHovered\" :isSelected=\"isSelected\" />\r\n    <div class=\"header-box\" :style=\"{ background: properties.node_header_bg_color }\">\r\n      <div class=\"top-block\">\r\n        <div class=\"title-block\">\r\n          <img src=\"@/assets/svg/batch-group-node.svg\" alt=\"\" />\r\n          <div class=\"title-text\">{{ props.properties.node_name }}</div>\r\n        </div>\r\n        <div class=\"btn-block\">\r\n          <a-popover :title=\"null\" trigger=\"click\" v-model:open=\"isShowMenu\" placement=\"right\">\r\n            <template #content>\r\n              <NodeListPopup style=\"width: 500px;height: 550px;\" :excludedNodeTypes=\"excludedNodeTypes\" @addNode=\"handleAddNode\" type=\"loop-node\" />\r\n            </template>\r\n            <a-tooltip :title=\"t('tooltip_create_inner_node')\">\r\n              <div class=\"btn-item\" @click.stop=\"handleClick\">\r\n                <PlusCircleOutlined />\r\n              </div>\r\n            </a-tooltip>\r\n          </a-popover>\r\n\r\n          <a-tooltip :title=\"t('tooltip_run_test')\">\r\n            <div class=\"btn-item\" @click.stop=\"handleOpenTestModal\">\r\n              <CaretRightOutlined />\r\n            </div>\r\n          </a-tooltip>\r\n\r\n          <a-dropdown trigger=\"click\">\r\n            <div class=\"btn-item\" @click.stop=\"\">\r\n              <img class=\"btn-icon\" src=\"@/assets/img/workflow/node-menu-btn.svg\" alt=\"\" />\r\n            </div>\r\n            <template #overlay>\r\n              <a-menu>\r\n                <a-menu-item @click=\"handleDelete\">\r\n                  <div style=\"color: #fb363f\">{{ t('btn_delete') }}</div>\r\n                </a-menu-item>\r\n              </a-menu>\r\n            </template>\r\n          </a-dropdown>\r\n        </div>\r\n      </div>\r\n      <div class=\"info-block\">\r\n        <div class=\"info-item\">\r\n          <div class=\"info-label\">{{ t('label_execution_array') }}</div>\r\n          <div class=\"info-content\">\r\n            <div class=\"label-text\">input</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <div class=\"node-body\">\r\n      <div class=\"node-content\"></div>\r\n    </div>\r\n    <RunTest ref=\"runTestRef\" :batch_node_key=\"batch_node_key\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { generateRandomId } from '@/utils/index'\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, computed } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\nimport { CaretRightOutlined, PlusCircleOutlined } from '@ant-design/icons-vue'\r\nimport NodeListPopup from '../../node-list-popup/index.vue'\r\nimport RunTest from './components/run-test.vue'\r\nimport BorderLine from './components/border-line.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.batch-group-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  model: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  isHovered: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\nconst getGraph = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst addNode = inject('addNode')\r\nconst setData = inject('setData')\r\nconst resetSize = inject('resetSize')\r\nconst excludedNodeTypes = ref(['custom-group', 'batch-group', 'end-node', 'terminate-node', 'qa-node'])\r\n\r\nconst isShowMenu = ref(false)\r\n\r\nconst batch_node_key = computed(() => {\r\n  return getNode().id\r\n})\r\n\r\nconst handleAddNode = (node) => {\r\n  addNode(node)\r\n  isShowMenu.value = false\r\n}\r\nconst handleClick = () => {\r\n  isShowMenu.value = true\r\n}\r\n\r\nconst runTestRef = ref(null)\r\n\r\nconst handleOpenTestModal = () => {\r\n  let data = formState.batch_arrays[0]\r\n\r\n  if(data && data.key && data.typ && data.value){\r\n    runTestRef.value.open()\r\n  }else{\r\n    message.error(t('msg_fill_execution_array'))\r\n  }\r\n}\r\n\r\nconst formState = reactive({\r\n  chan_number: 10,\r\n  max_run_number: 500,\r\n  batch_arrays: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      value: '',\r\n      _id: generateRandomId(16)\r\n    }\r\n  ],\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: '',\r\n      value: '',\r\n      _id: generateRandomId(16)\r\n    }\r\n  ]\r\n})\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let batch = {}\r\n\r\n  try {\r\n    batch = JSON.parse(dataRaw).batch || {}\r\n  } catch (e) {\r\n    batch = {}\r\n  }\r\n\r\n  formState.chan_number = batch.chan_number\r\n  formState.batch_arrays = batch.batch_arrays\r\n  formState.output = batch.output\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    batch: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nwatch(\r\n  () => props.properties,\r\n  (val, oldVal) => {\r\n    if(JSON.stringify(val) !== JSON.stringify(oldVal)){\r\n      reset()\r\n    }\r\n    \r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst handleDelete = () => {\r\n  let node = getNode()\r\n  getGraph().deleteNode(node.id)\r\n}\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.custom-group-content {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  background: #fff;\r\n  display: flex;\r\n  flex-direction: column;\r\n  border-radius: 8px;\r\n  // border: 1px solid #fff;\r\n  &.isHovered {\r\n    // border: 1px solid #2475fc;\r\n  }\r\n  &.isSelected {\r\n    // border: 2px solid #2475fc;\r\n    // &::before {\r\n    //   content: '';\r\n    //   position: absolute;\r\n    //   top: 0;\r\n    //   left: 0;\r\n    //   width: 100%;\r\n    //   height: 100%;\r\n    //   border-radius: 8px;\r\n    //   border: 2px solid #2475fc;\r\n    // }\r\n  }\r\n  .header-box {\r\n    overflow: hidden;\r\n    padding: 16px;\r\n\r\n    .top-block {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      .title-block {\r\n        display: flex;\r\n        align-items: center;\r\n        flex: 1;\r\n        gap: 8px;\r\n        color: #262626;\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n        img {\r\n          width: 20px;\r\n          height: 20px;\r\n        }\r\n      }\r\n      .btn-block {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        .btn-item {\r\n          width: 24px;\r\n          height: 24px;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          cursor: pointer;\r\n          border-radius: 6px;\r\n          transition: all 0.2s ease-in-out;\r\n          font-size: 16px;\r\n          &:hover {\r\n            background: #e4e6eb;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .info-block {\r\n    margin-top: 16px;\r\n    padding-left: 20px;\r\n    .info-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      .info-label {\r\n        color: #262626;\r\n        font-size: 14px;\r\n      }\r\n      .info-content {\r\n        display: flex;\r\n        width: fit-content;\r\n        border: 1px solid #d9d9d9;\r\n        background: #fff;\r\n        gap: 4px;\r\n        border-radius: 4px;\r\n        color: #595959;\r\n        height: 22px;\r\n        .label-text {\r\n          padding: 2px 2px 2px 4px;\r\n          font-size: 12px;\r\n          display: flex;\r\n          align-items: center;\r\n        }\r\n        .label-value {\r\n          border-radius: 4px;\r\n          background: #e4e6eb;\r\n          color: #595959;\r\n          font-size: 12px;\r\n          padding: 1px 4px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .node-body{\r\n    flex: 1;\r\n    border-radius: 6px;\r\n    padding: 0 16px 16px;\r\n  }\r\n  .node-content {\r\n    width: 100%;\r\n    height: 100%;\r\n    background: #f2f4f7;\r\n  }\r\n}\r\n</style>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { dynamicGroup } from '@logicflow/extension'\r\nimport { createApp, h, nextTick } from 'vue'\r\nimport CustomGroupComponent from './index.vue'\r\nimport { allParentVariableNodeWhiteList } from '../../util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.base-node')\r\n\r\nfunction transformArray(arr, parent) {\r\n  // 使用map处理数组并返回新的数组\r\n  return arr.map((item) => {\r\n    let node_id = parent ? parent.node_id : item.node_id\r\n    let node_name = parent ? parent.node_name : item.node_name\r\n    let node_type = parent ? parent.node_type : item.node_type\r\n    let label = item.name || item.key\r\n    let text = parent ? `${parent.text}.${label}` : label // 路径\r\n    let children = item.children || item.subs || []\r\n\r\n    let value = ''\r\n    let original_value = ''\r\n\r\n    if (node_type == 1) {\r\n      original_value = `global.${text}`\r\n    } else {\r\n      if (parent) {\r\n        original_value = `${parent.original_value}.${item.key}`\r\n      } else {\r\n        original_value = `${node_id}.${item.key}`\r\n      }\r\n    }\r\n\r\n    value = `【${original_value}】`\r\n\r\n    let data = {\r\n      label: label,\r\n      value: value,\r\n      original_value: original_value,\r\n      node_id: node_id,\r\n      node_name: node_name,\r\n      node_type: node_type,\r\n      text: text,\r\n      key: item.key,\r\n      id: node_id,\r\n      typ: item.typ,\r\n      children: children || []\r\n    }\r\n\r\n    // 递归处理子节点\r\n    if (data.children && data.children.length > 0) {\r\n      data.children = transformArray(data.children, data)\r\n    }\r\n\r\n    return data\r\n  })\r\n}\r\n\r\n// 自定义分组\r\nclass CustomGroup extends dynamicGroup.view {\r\n  constructor(props) {\r\n    super(props)\r\n    this.div = null\r\n    this.app = null\r\n  }\r\n\r\n  /**\r\n   * getShape: 在 super.getShape() 的基础上，追加一个 foreignObject。\r\n   */\r\n  getShape() {\r\n    // 1. 保留父类的基础 shape 结构\r\n    const shape = super.getShape()\r\n    const { model } = this.props\r\n    const { width, height, x, y } = model\r\n    this.div = flh('div', {\r\n      xmlns: 'http://www.w3.org/1999/xhtml',\r\n      style: 'width: 100%; height: 100%;'\r\n    })\r\n\r\n    // 3. 创建 foreignObject 并通过 push 添加到 shape 的子元素中\r\n    shape.props.children.push(\r\n      flh('foreignObject', {\r\n        // foreignObject 的坐标是相对于分组左上角的，所以用 0, 0\r\n        x: x - width / 2,\r\n        y: y - height / 2,\r\n        width,\r\n        height,\r\n        overflow: 'unset',\r\n        children: [this.div]\r\n      })\r\n    )\r\n\r\n    // 异步挂载Vue组件\r\n    this.mountVueComponentOnNextTick(this.props)\r\n    return shape\r\n  }\r\n\r\n  /**\r\n   * mountVueComponentOnNextTick: 负责在 DOM 渲染后挂载和更新 Vue 实例。\r\n   */\r\n  async mountVueComponentOnNextTick() {\r\n    // const { model, graphModel } = this.props\r\n    const mountPoint = this.div.__e\r\n\r\n    if (!mountPoint) {\r\n      setTimeout(() => this.mountVueComponentOnNextTick(), 100)\r\n      return\r\n    }\r\n\r\n\r\n    // 如果 Vue 实例不存在，则创建并挂载\r\n    if (!this.app) {\r\n      this.r = h(CustomGroupComponent, {\r\n        isSelected: this.props.model.isSelected,\r\n        isHovered: this.props.model.isHovered,\r\n        properties: this.props.model.getProperties()\r\n      })\r\n\r\n      this.app = createApp({\r\n        render: () => this.r,\r\n        provide: () => ({\r\n          getNode: () => this.props.model,\r\n          getGraph: () => this.props.graphModel,\r\n          addNode: (data) => {\r\n            this.props.graphModel.eventCenter.emit('custom:addGroupNode', {\r\n              data,\r\n              group_id: this.props.model.id\r\n            })\r\n          },\r\n          resetSize: () => {\r\n            if (this.r && this.r.el) {\r\n              // 获取高度\r\n              let height = this.r.el.clientHeight\r\n              let width = this.r.el.clientWidth\r\n              this.props.model.properties = {\r\n                ...this.props.model.properties,\r\n                width: width,\r\n                height: height\r\n              }\r\n\r\n              this.props.model._width = width\r\n              this.props.model._height = height\r\n\r\n              // 视图变化  边的线位置更新\r\n              this.props.model.refreshBranch()\r\n            }\r\n          },\r\n          setData: (data) => {\r\n            data.dataRaw = data.node_params\r\n            nextTick(() => {\r\n              this.props.model.properties = {\r\n                ...this.props.model.properties,\r\n                ...data\r\n              }\r\n              // 获取高度\r\n              let height = null\r\n\r\n              if (this.r && this.r.el) {\r\n                height = this.r.el.clientHeight\r\n              }\r\n\r\n              this.props.model._height = height || data.height || this.props.model.properties.height\r\n              this.props.model.refreshBranch() // 视图变化  边的线位置更新\r\n            })\r\n          },\r\n          setTitle: (title) => {\r\n            this.props.model.properties.node_name = title\r\n          }\r\n        })\r\n      })\r\n      this.app.mount(mountPoint)\r\n    } else if (this.r && this.r.component) {\r\n      // 如果实例已存在，则只更新 props\r\n      const newProperties = this.props.model.getProperties()\r\n      const oldProperties = this.r.component.props.properties\r\n\r\n      this.r.component.props.isSelected = this.props.model.isSelected\r\n      this.r.component.props.isHovered = this.props.model.isHovered\r\n\r\n      if (JSON.stringify(newProperties) !== JSON.stringify(oldProperties)) {\r\n        this.r.component.props.properties = newProperties\r\n      }\r\n    }\r\n  }\r\n\r\n  getAnchorShape(anchorData) {\r\n    let edges = this.props.graphModel.getNodeEdges(this.props.model.id)\r\n    let sourceAnchorIds = edges.map((edge) => edge.sourceAnchorId)\r\n    let targetAnchorIds = edges.map((edge) => edge.targetAnchorId)\r\n    let anchorIsSelected = false\r\n\r\n    const { x, y, type } = anchorData\r\n    const radius = 10 // 圆形的半径\r\n\r\n    if (type === 'left') {\r\n      anchorIsSelected = targetAnchorIds.includes(anchorData.id)\r\n    } else {\r\n      anchorIsSelected = sourceAnchorIds.includes(anchorData.id)\r\n    }\r\n\r\n    // 圆形的SVG元素\r\n    const circle = flh('circle', {\r\n      className: `custom-anchor-circle`,\r\n      cx: x,\r\n      cy: y,\r\n      r: radius,\r\n      fill: '#fff', // 你可以根据需要设置颜色\r\n      stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n      'stroke-width': 2 // 你可以根据需要设置边框宽度\r\n    })\r\n\r\n    // 向右箭头的SVG路径元素\r\n    const arrowPath = flh(\r\n      'g',\r\n      {\r\n        className: `custom-anchor-arrow`,\r\n        transform: `translate(${x - radius - 2}, ${y - radius - 2})`\r\n      },\r\n      [\r\n        flh('circle', {\r\n          cx: 12,\r\n          cy: 12,\r\n          r: radius,\r\n          fill: '#2475FC', // 你可以根据需要设置颜色\r\n          stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n          'stroke-width': 1 // 你可以根据需要设置边框宽度\r\n        }),\r\n        flh('path', {\r\n          d: `M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z`,\r\n          fill: '#fff' // 你可以根据需要设置箭头颜色\r\n        })\r\n      ]\r\n    )\r\n\r\n    // 加号的SVG路径元素\r\n    const plusPath = flh(\r\n      'g',\r\n      {\r\n        className: `custom-anchor-plus ${anchorIsSelected ? 'anchor-hide' : ''}`,\r\n        transform: `translate(${x - radius - 2}, ${y - radius - 2})`\r\n      },\r\n      [\r\n        flh('circle', {\r\n          cx: 12,\r\n          cy: 12,\r\n          r: radius,\r\n          fill: '#2475FC', // 你可以根据需要设置颜色\r\n          stroke: '#2475FC', // 你可以根据需要设置边框颜色\r\n          'stroke-width': 1 // 你可以根据需要设置边框宽度\r\n        }),\r\n        flh('line', {\r\n          x1: 12,\r\n          y1: 6,\r\n          x2: 12,\r\n          y2: 18,\r\n          strokeWidth: 2.4,\r\n          strokeLinecap: 'round',\r\n          strokeLinejoin: 'round',\r\n          stroke: '#fff' // 你可以根据需要设置箭头颜色\r\n        }),\r\n        flh('line', {\r\n          x1: 6,\r\n          y1: 12,\r\n          x2: 18,\r\n          y2: 12,\r\n          strokeWidth: 2.4,\r\n          strokeLinecap: 'round',\r\n          strokeLinejoin: 'round',\r\n          stroke: '#fff' // 你可以根据需要设置箭头颜色\r\n        })\r\n      ]\r\n    )\r\n\r\n    // 创建一个SVG组元素来包含圆形和箭头\r\n    const group = flh(\r\n      'g',\r\n      {\r\n        id: anchorData.id,\r\n        className: `custom-anchor custom-anchor-${type} ${anchorIsSelected ? 'anchor-selected' : 'anchor-not-selected'}`,\r\n        onClick: (e) => {\r\n          e.stopPropagation()\r\n\r\n          const { graphModel, model } = this.props\r\n\r\n          if (type === 'right' && !anchorIsSelected) {\r\n            graphModel.eventCenter.emit('custom:showPopupMenu', { anchorData, model })\r\n          }\r\n        }\r\n      },\r\n      circle,\r\n      arrowPath,\r\n      plusPath\r\n    )\r\n\r\n    return group\r\n  }\r\n\r\n  /**\r\n   * 销毁时卸载 Vue 实例\r\n   */\r\n  destroy() {\r\n    if (this.app) {\r\n      this.app.unmount()\r\n      this.app = null\r\n    }\r\n    super.destroy()\r\n  }\r\n}\r\n\r\nclass CustomGroupModel extends dynamicGroup.model {\r\n  initNodeData(data) {\r\n    super.initNodeData(data)\r\n    this.width = data.width || 600\r\n    this.height = data.height || 420\r\n    this.collapsible = false\r\n    this.isRestrict = false // 限制拖出去\r\n    this.autoResize = false // 跟随节点 调整宽度\r\n    this.radius = 8\r\n    this.allowResize = false\r\n    this.autoExpand = false\r\n    this.transformWithContainer = true\r\n    this.allowRotate = true\r\n    this.stopMoveGraph = false\r\n    this.autoToFront = false;\r\n    this.properties = {\r\n      ...this.properties,\r\n      transformWithContainer: true, \r\n    }\r\n  }\r\n\r\n  // 自定义分组样式\r\n  getNodeStyle() {\r\n    const style = super.getNodeStyle()\r\n    // 将默认背景设置为透明，因为背景由我们的 Vue 组件控制\r\n    // 这可以防止父类矩形和我们的组件背景重叠\r\n    style.stroke = 'none'\r\n    style.strokeWidth = 2\r\n    style.fill = '#F0F2F5'\r\n    style.filter = 'drop-shadow(0 2px 3px rgba(0, 0, 0, 0.2))'\r\n    // 边框也可以在Vue组件里实现，这里设为透明\r\n    return style\r\n  }\r\n\r\n  getOutlineStyle() {\r\n    const style = super.getOutlineStyle()\r\n    style.stroke = 'none'\r\n    style.hover.stroke = 'none'\r\n\r\n    return style\r\n  }\r\n  getAnchorLineStyle() {\r\n    const style = super.getAnchorLineStyle()\r\n    style.stroke = '#2475FC'\r\n    return style\r\n  }\r\n\r\n  getAddableOutlineStyle() {\r\n    const style = super.getAddableOutlineStyle()\r\n    style.stroke = '#52c41a'\r\n    style.strokeDasharray = '4 4'\r\n    style.strokeWidth = 2\r\n    return style\r\n  }\r\n\r\n  isAllowAppendIn(nodeData) {\r\n    return !nodeData.properties.disabled_add_group\r\n  }\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: t('err_only_right_anchor'),\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: t('err_group_connection_rule'),\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: t('err_only_left_anchor'),\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let defaultAnchor = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 28,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 28,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return defaultAnchor\r\n  }\r\n\r\n  getAllParentVariable() {\r\n    const parentNodes = []\r\n    const visited = new Set()\r\n    const edges = this.incoming.edges\r\n    const { nodes } = this.graphModel\r\n\r\n    let startNode = nodes.find((node) => node.type === 'start-node')\r\n    // 插入起始节点(起始节点必传)\r\n    if (startNode) {\r\n      visited.add(startNode.id)\r\n      parentNodes.push(startNode)\r\n    }\r\n\r\n    // 递归函数用于遍历父节点\r\n    const traverseParents = (edges) => {\r\n      for (let i = 0; i < edges.length; i++) {\r\n        let edge = edges[i]\r\n        let node = edge.sourceNode\r\n\r\n        if (visited.has(node.id)) continue\r\n\r\n        visited.add(node.id)\r\n\r\n        if (allParentVariableNodeWhiteList.includes(node.type)) {\r\n          parentNodes.push(node)\r\n        }\r\n\r\n        traverseParents(node.incoming.edges)\r\n      }\r\n    }\r\n\r\n    // 获取所有父节点\r\n    traverseParents(edges)\r\n\r\n\r\n    let childernNodes = nodes.filter(item => item.properties.loop_parent_key == this.id)\r\n    childernNodes.forEach(item => {\r\n      parentNodes.push(item)\r\n    })\r\n\r\n\r\n    // 取出输出的变量\r\n    let variableArr = []\r\n\r\n    for (const node of parentNodes) {\r\n      // 如果节点类型既不是http-node也不是start-node，则跳过当前循环\r\n      if (!allParentVariableNodeWhiteList.includes(node.type)) {\r\n        continue\r\n      }\r\n\r\n      let node_params = JSON.parse(node.properties.node_params)\r\n\r\n      let obj = {\r\n        label: node.properties.node_name,\r\n        value: node.id,\r\n        node_id: node.id,\r\n        node_type: node.properties.node_type,\r\n        typ: 'node',\r\n        children: [],\r\n        loop_parent_key: node.properties.loop_parent_key,\r\n        group_node_key: this.id\r\n      }\r\n\r\n      if (node.type === 'http-node') {\r\n        obj.children = node_params.curl.output\r\n      }\r\n\r\n      if (node.type === 'http-tool-node') {\r\n        obj.children = node_params.curl.output\r\n      }\r\n\r\n      if (node.type === 'code-run-node') {\r\n        obj.children = node_params.code_run.output\r\n      }\r\n\r\n      if (node.type === 'parameter-extraction-node') {\r\n        obj.children = node_params.params_extractor.output\r\n      }\r\n\r\n      if (node.type === 'start-node') {\r\n        obj.children = [...node_params.start.diy_global, ...node_params.start.sys_global]\r\n      }\r\n\r\n      if (node.type === 'custom-group') {\r\n        obj.children = node_params.loop.output\r\n      }\r\n\r\n      if(node.type === 'import-library-node'){\r\n        obj.children = node_params.library_import.outputs\r\n      }\r\n\r\n      if(node.type === 'json-node'){\r\n        obj.children = node_params.json_encode.output\r\n      }\r\n\r\n      if(node.type === 'json-reverse-node'){\r\n        obj.children = node_params.json_decode.output\r\n      }\r\n\r\n      if (node.type === 'select-data-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'output_list',\r\n            typ: 'array<object>',\r\n            name: 'output_list',\r\n            label: 'output_list'\r\n          },\r\n          {\r\n            key: 'row_num',\r\n            typ: 'integer',\r\n            name: 'row_num',\r\n            label: 'row_num'\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'knowledge-base-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.lib_paragraph_list',\r\n            typ: 'string',\r\n            name: t('var_knowledge_base_reference'),\r\n            label: t('var_knowledge_base_reference')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'ai-dialogue-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.llm_reply_content',\r\n            typ: 'string',\r\n            name: t('var_ai_reply_content'),\r\n            label: t('var_ai_reply_content')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'specify-reply-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.llm_reply_content',\r\n            typ: 'string',\r\n            name: t('var_message_content'),\r\n            label: t('var_message_content')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'immediately-reply-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.llm_reply_content',\r\n            typ: 'string',\r\n            name: t('var_message_content'),\r\n            label: t('var_message_content')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'problem-optimization-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.question_optimize_reply_content',\r\n            typ: 'string',\r\n            name: t('var_question_optimization_result'),\r\n            label: t('var_question_optimization_result')\r\n          }\r\n        ]\r\n      }\r\n\r\n      if (node.type === 'mcp-node') {\r\n        obj.children = [\r\n          {\r\n            key: 'special.mcp_reply_content',\r\n            typ: 'string',\r\n            name: 'text',\r\n            label: t('var_tool_generated_content')\r\n          }\r\n        ]\r\n      }\r\n      if(node.type === 'image-generation-node'){\r\n        let image_num = node_params.image_generation.image_num \r\n        if(image_num > 0){\r\n          let list = []\r\n          for (let i = 0; i < +image_num; i++) {\r\n            let letter = String.fromCharCode('a'.charCodeAt(0) + i)\r\n            list.push({\r\n              key: `picture_url_${letter}`,\r\n              typ: 'string',\r\n              name: `picture_url_${letter}`,\r\n              label: `picture_url_${letter}`,\r\n            })\r\n          }\r\n          obj.children = list\r\n        }\r\n      }\r\n\r\n      if (node.type === 'zm-plugins-node') {\r\n        let output = node_params.plugin.output_obj ? JSON.parse(JSON.stringify(node_params.plugin.output_obj)) : []\r\n        \r\n        const loop = (arr) => {\r\n          arr.forEach((item) => {\r\n            item.name = item.key || ''\r\n            if (item.subs && item.subs.length > 0) {\r\n              loop(item.subs)\r\n            }\r\n          })\r\n        }\r\n\r\n        loop(output)\r\n\r\n        obj.children = output || []\r\n      }\r\n\r\n      obj.children.forEach((variable) => {\r\n        variable.node_id = node.id\r\n        variable.node_name = node.properties.node_name\r\n        variable.node_type = node.properties.node_type\r\n      })\r\n\r\n      obj.children = transformArray(obj.children, null)\r\n\r\n      variableArr.push(obj)\r\n    }\r\n\r\n    return variableArr\r\n  }\r\n  \r\n  refreshBranch() {\r\n    // 更新节点连接边的path\r\n    this.incoming.edges.forEach((edge) => {\r\n      // 调用自定义的更新方案\r\n      edge.updatePathByAnchor()\r\n    })\r\n    this.outgoing.edges.forEach((edge) => {\r\n      edge.updatePathByAnchor()\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'batch-group',\r\n  view: CustomGroup,\r\n  model: CustomGroupModel\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_model') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">\r\n                <model-name-text\r\n                  :useModel=\"formState.use_model\"\r\n                  :modelConfigId=\"formState.model_config_id\"\r\n                />\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_prompt') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\">\r\n                <at-text\r\n                  :options=\"valueOptions\"\r\n                  :defaultSelectedList=\"formState.prompt_tags\"\r\n                  :defaultValue=\"formState.prompt\"\r\n                  ref=\"atInputRef\"\r\n                />\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output') }}</div>\r\n          <div class=\"options-list\">\r\n            <div class=\"options-item\" v-for=\"item in outputList\" :key=\"item\">\r\n              <div class=\"option-label\">{{ item }}</div>\r\n              <div class=\"option-type\">string</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { getUuid } from '@/utils/index'\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount, computed } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport NodeCommon from '../base-node.vue'\r\nimport ModelNameText from '../model-name-text.vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.image-generation-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\nconst valueOptions = ref([])\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  model_config_id: void 0,\r\n  use_model: void 0,\r\n  size: void 0,\r\n  image_num: '1',\r\n  prompt: '',\r\n  prompt_tags: [],\r\n  input_images: [],\r\n  image_watermark: '1',\r\n  image_optimize_prompt: '1'\r\n})\r\n\r\nconst outputList = computed(() => {\r\n  let list = ['msg']\r\n  if (formState.image_num > 0) {\r\n    for (let i = 0; i < +formState.image_num; i++) {\r\n      let letter = String.fromCharCode('a'.charCodeAt(0) + i)\r\n      list.push(`picture_url_${letter}`)\r\n    }\r\n  }\r\n  return list\r\n})\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let image_generation = {}\r\n  try {\r\n    getValueOptions()\r\n    image_generation = JSON.parse(dataRaw).image_generation || {}\r\n    formState.model_config_id = image_generation.model_config_id\r\n    formState.use_model = image_generation.use_model\r\n    formState.size = image_generation.size\r\n    formState.image_num = image_generation.image_num\r\n    formState.prompt = image_generation.prompt\r\n    formState.prompt_tags = image_generation.prompt_tags\r\n    formState.input_images = image_generation.input_images\r\n    formState.image_watermark = image_generation.image_watermark\r\n    formState.image_optimize_prompt = image_generation.image_optimize_prompt\r\n  } catch (e) {\r\n    image_generation = {}\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nfunction getValueOptions() {\r\n  let options = getNode().getAllParentVariable()\r\n  valueOptions.value = options || []\r\n}\r\n\r\nwatch(\r\n  () => props.properties,\r\n  (newVal, oldVal) => {\r\n    const newDataRaw = newVal.dataRaw || newVal.node_params || '{}'\r\n    const oldDataRaw = oldVal.dataRaw || oldVal.node_params || '{}'\r\n\r\n    if (newDataRaw != oldDataRaw) {\r\n      reset()\r\n    }\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n})\r\n\r\nonBeforeUnmount(() => {})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n    .category-list {\r\n      width: 100%;\r\n      overflow: hidden;\r\n    }\r\n    .field-value {\r\n      width: 100%;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      height: 24px;\r\n      margin-bottom: 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n      .category-value {\r\n        width: 100%;\r\n      }\r\n\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n\r\n  .options-list {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  .options-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 22px;\r\n    padding: 2px 2px 2px 4px;\r\n    border-radius: 4px;\r\n    border: 1px solid #d9d9d9;\r\n\r\n    &.is-required .option-label::before {\r\n      vertical-align: middle;\r\n      content: '*';\r\n      color: #fb363f;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .option-type {\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      background-color: #e4e6eb;\r\n      color: var(--wf-color-text-3);\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'image-generation-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n    .field-list-item {\r\n      display: flex;\r\n      gap: 4px;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .right-arrow {\r\n        width: 24px;\r\n        height: 100%;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 13px;\r\n      }\r\n      .field-text {\r\n        max-width: 150px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        font-size: 12px;\r\n      }\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .field-key {\r\n        max-width: 200px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_input_params') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-text\">\r\n                <at-text\r\n                  :options=\"valueOptions\"\r\n                  :defaultSelectedList=\"formState.input_tags\"\r\n                  :defaultValue=\"formState.input_variable\"\r\n                  ref=\"atInputRef\"\r\n                  v-if=\"formState.input_variable.length > 0\"\r\n                />\r\n                <span v-else>--</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output_fields') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n              <span class=\"field-key\"> {{ item.key }}</span>\r\n              <span class=\"field-type\">{{ item.typ }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { haveOutKeyNode } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.json-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst valueOptions = ref([])\r\nconst formState = reactive({\r\n  input_variable: '',\r\n  input_tags: [],\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: 'string',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let json_encode = {}\r\n  try {\r\n    json_encode = JSON.parse(dataRaw).json_encode || {}\r\n  } catch (e) {\r\n    json_encode = {}\r\n  }\r\n\r\n  getValueOptions()\r\n  json_encode = JSON.parse(JSON.stringify(json_encode))\r\n  formState.input_variable = json_encode.input_variable\r\n  formState.input_tags = json_encode.input_tags || []\r\n  formState.output = json_encode.output\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    json_encode: {\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n\r\n  nextTick(() => {\r\n    update()\r\n  })\r\n}\r\n\r\nconst getValueOptions = () => {\r\n  let options = getNode().getAllParentVariable()\r\n\r\n  valueOptions.value = options || []\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'json-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n    .field-list-item {\r\n      display: flex;\r\n      gap: 4px;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .right-arrow {\r\n        width: 24px;\r\n        height: 100%;\r\n        border-radius: 4px;\r\n        background: #e4e6eb;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-size: 13px;\r\n      }\r\n      .field-text {\r\n        max-width: 150px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        font-size: 12px;\r\n      }\r\n    }\r\n    .field-value {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      .field-key {\r\n        max-width: 200px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_input_params') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-list-item\">\r\n              <div class=\"field-text\">\r\n                <UserQuestionText :value=\"formState.input_variable\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_output_fields') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\" v-for=\"(item, index) in formState.output\" :key=\"index\">\r\n              <span class=\"field-key\"> {{ item.key }}</span>\r\n              <span class=\"field-type\">{{ item.typ }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport UserQuestionText from '../user-question-text.vue'\r\nimport { haveOutKeyNode, formatSpacialKey } from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.json-reverse-node.index')\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst setData = inject('setData')\r\nconst graphModel = inject('getGraph')\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  input_variable: [],\r\n  output: [\r\n    {\r\n      key: '',\r\n      typ: 'object',\r\n      subs: []\r\n    }\r\n  ]\r\n})\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let json_decode = {}\r\n  try {\r\n    json_decode = JSON.parse(dataRaw).json_decode || {}\r\n  } catch (e) {\r\n    json_decode = {}\r\n  }\r\n\r\n  json_decode = JSON.parse(JSON.stringify(json_decode))\r\n  formState.input_variable = formatSpacialKey(json_decode.input_variable)\r\n  formState.output = json_decode.output\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nconst update = () => {\r\n  const data = JSON.stringify({\r\n    json_decode: {\r\n      input_variable: formState.input_variable ? formState.input_variable.join('.') : '',\r\n      ...formState\r\n    }\r\n  })\r\n\r\n  setData({\r\n    ...props.node,\r\n    node_params: data\r\n  })\r\n}\r\n\r\nconst onUpatateNodeName = (data) => {\r\n  if (!haveOutKeyNode.includes(data.node_type)) {\r\n    return\r\n  }\r\n\r\n  nextTick(() => {\r\n    update()\r\n  })\r\n}\r\n\r\n// --- Watchers and Lifecycle Hooks ---\r\nwatch(() => props.properties, reset, { deep: true })\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.on('custom:setNodeName', onUpatateNodeName)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  const mode = graphModel()\r\n\r\n  mode.eventCenter.off('custom:setNodeName', onUpatateNodeName)\r\n})\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'json-reverse-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n  >\r\n    <div class=\"specify-reply-node\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_voice_model') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              {{ formState.use_model }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_text') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              <at-text\r\n                v-if=\"formState.text.length > 0\"\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.text_tags\"\r\n                :defaultValue=\"formState.text\"\r\n                class=\"text\"\r\n                ref=\"atInputRef\"\r\n              />\r\n              <span v-else>--</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport {haveOutKeyNode} from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'SpecifyReplyNode',\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  components: {\r\n    NodeCommon,\r\n    AtText\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.voice-synthesis-node.index')\r\n    return { t }\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: {type: Boolean, default: false},\r\n    isHovered: {type: Boolean, default: false}\r\n  },\r\n  data() {\r\n    return {\r\n      menus: [],\r\n      valueOptions: [],\r\n      formState: {\r\n        use_model: '',\r\n        text: '',\r\n        text_tags: []\r\n      }\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        if (newVal.dataRaw !== oldVal.dataRaw) {\r\n          this.init()\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getValueOptions()\r\n\r\n      let dataRaw = this.properties.dataRaw || this.properties.node_params || '{}'\r\n      let node_params = JSON.parse(dataRaw)\r\n      let args = node_params?.text_to_audio?.arguments || {}\r\n      this.formState.use_model = args.use_model || '--'\r\n      this.formState.text = args.text || ''\r\n      this.formState.text_tags = args?.tag_map?.text || []\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n    getValueOptions() {\r\n      let options = this.getNode().getAllParentVariable()\r\n      this.valueOptions = options || []\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n\r\n.specify-reply-node {\r\n  position: relative;\r\n  z-index: 2;\r\n\r\n  .static-field-item-content{\r\n    flex: 1;\r\n    overflow: hidden;\r\n  }\r\n  .static-field-value {\r\n    height: 22px;\r\n    line-height: 20px;\r\n    font-size: 12px;\r\n    overflow: hidden;\r\n    .text{\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n    }\r\n  }\r\n\r\n  &:deep(.j-mention-at) {\r\n    padding: 0 8px;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    line-height: 16px;\r\n    font-weight: 400;\r\n    background: #f2f4f5;\r\n  }\r\n}\r\n</style>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height} = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'voice-synthesis-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n  >\r\n    <div class=\"specify-reply-node\">\r\n      <div class=\"static-field-list\">\r\n        <div class=\"static-field-item\">\r\n          <div class=\"static-field-item-label\">{{ t('label_clone_audio') }}</div>\r\n          <div class=\"static-field-item-content\">\r\n            <div class=\"static-field-value\">\r\n              <at-text\r\n                v-if=\"formState.file_url.length > 0\"\r\n                :options=\"valueOptions\"\r\n                :defaultSelectedList=\"formState.file_url_tags\"\r\n                :defaultValue=\"formState.file_url\"\r\n                ref=\"atInputRef\"\r\n                class=\"text\"\r\n              />\r\n              <span v-else>--</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport {haveOutKeyNode} from '@/views/workflow/components/util.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'SpecifyReplyNode',\r\n  inject: ['getNode', 'getGraph', 'setData', 'resetSize'],\r\n  components: {\r\n    NodeCommon,\r\n    AtText\r\n  },\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.voice-clone-node.index')\r\n    return { t }\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    },\r\n    isSelected: {type: Boolean, default: false},\r\n    isHovered: {type: Boolean, default: false}\r\n  },\r\n  data() {\r\n    return {\r\n      menus: [],\r\n      valueOptions: [],\r\n      formState: {\r\n        file_url: '',\r\n        file_url_tags: []\r\n      }\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    properties: {\r\n      handler(newVal, oldVal) {\r\n        if (newVal.dataRaw !== oldVal.dataRaw) {\r\n          this.init()\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getValueOptions()\r\n      let dataRaw = this.properties.dataRaw || this.properties.node_params || '{}'\r\n      let node_params = JSON.parse(dataRaw)\r\n      let args = node_params?.voice_clone?.arguments || {}\r\n      this.formState.file_url = args.file_url || '--'\r\n      this.formState.file_url_tags = args?.tag_map?.file_url || []\r\n      this.$nextTick(() => {\r\n        this.resetSize()\r\n      })\r\n    },\r\n    getValueOptions() {\r\n      let options = this.getNode().getAllParentVariable()\r\n      this.valueOptions = options || []\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../form-block.less';\r\n.specify-reply-node {\r\n  position: relative;\r\n  z-index: 2;\r\n  .static-field-item-content{\r\n    flex: 1;\r\n    overflow: hidden;\r\n  }\r\n  .static-field-value {\r\n    height: 22px;\r\n    line-height: 20px;\r\n    font-size: 12px;\r\n    overflow: hidden;\r\n    .text{\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n    }\r\n  }\r\n\r\n  &:deep(.j-mention-at) {\r\n    padding: 0 8px;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    line-height: 16px;\r\n    font-weight: 400;\r\n    background: #f2f4f5;\r\n  }\r\n}\r\n</style>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height} = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'voice-clone-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.start-node {\r\n  position: relative;\r\n  margin-bottom: 8px;\r\n\r\n  .start-node-options {\r\n    display: flex;\r\n    gap: 4px;\r\n    overflow: hidden;\r\n  }\r\n  .options-title {\r\n    line-height: 22px;\r\n    margin-right: 8px;\r\n    font-size: 14px;\r\n    color: #262626;\r\n    white-space: nowrap;\r\n  }\r\n  .options-list {\r\n    flex: 1;\r\n    display: flex;\r\n    gap: 8px;\r\n    overflow: hidden;\r\n  }\r\n  .options-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 22px;\r\n    padding: 2px 2px 2px 4px;\r\n    border-radius: 4px;\r\n    border: 1px solid #d9d9d9;\r\n    width: 100%;\r\n    overflow: hidden;\r\n\r\n    &.is-required .option-label::before {\r\n      vertical-align: middle;\r\n      content: '*';\r\n      color: #fb363f;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n      margin-right: 4px;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .option-type {\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      background-color: #e4e6eb;\r\n      color: var(--wf-color-text-3);\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :title=\"properties.node_name\"\r\n    :icon-url=\"properties.node_icon\"\r\n    :icon-name=\"properties.node_icon_name\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    :node_type=\"properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"start-node\">\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('label_request_url') }}</div>\r\n        <div class=\"options-list\">\r\n          <div class=\"options-item\">\r\n            <div class=\"option-label\">{{ formState.url }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"start-node\">\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('label_request_method') }}</div>\r\n        <div class=\"options-list\">\r\n          <div class=\"options-item\">\r\n            <div class=\"option-label\">{{ formState.method }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport NodeCommon from '../base-node.vue'\r\nimport { nextTick, onMounted, inject, watch, reactive } from 'vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.webhook-trigger-node.index')\r\nconst resetSize = inject('resetSize')\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default() {\r\n      return {}\r\n    }\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nwatch(\r\n  () => props.properties,\r\n  (newVal, oldVal) => {\r\n    const newDataRaw = newVal.node_params || '{}'\r\n    const oldDataRaw = oldVal.node_params || '{}'\r\n    if (newDataRaw != oldDataRaw) {\r\n      reset()\r\n    }\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst formState = reactive({\r\n  url: '',\r\n  method: 'GET',\r\n  switch_verify: '1',\r\n  switch_allow_ip: '0',\r\n  allow_ips: '',\r\n\r\n  params: [],\r\n  form: [],\r\n\r\n  x_form: [],\r\n\r\n  json: [],\r\n\r\n  request_content_type: 'none',\r\n\r\n  response_type: 'now',\r\n  response_now: ''\r\n})\r\n\r\nconst reset = () => {\r\n  if (!props.properties || !props.properties.node_params) {\r\n    return\r\n  }\r\n\r\n  let node_params = JSON.parse(props.properties.node_params)\r\n\r\n  let trigger_web_hook_config = node_params.trigger.trigger_web_hook_config\r\n  // formState.url = trigger_web_hook_config.url\r\n  // formState.method = trigger_web_hook_config.method || 'GET'\r\n  // formState.switch_verify = trigger_web_hook_config.switch_verify || '1'\r\n  // formState.switch_allow_ip = trigger_web_hook_config.switch_allow_ip || '0'\r\n  // formState.allow_ips = trigger_web_hook_config.allow_ips\r\n  //   ? trigger_web_hook_config.allow_ips.split(',').join('\\n')\r\n  //   : ''\r\n  // formState.params = trigger_web_hook_config.params || []\r\n  // formState.form = trigger_web_hook_config.form || []\r\n  // formState.x_form = trigger_web_hook_config.x_form || []\r\n  // formState.json = trigger_web_hook_config.json || []\r\n  // formState.request_content_type = trigger_web_hook_config.request_content_type || 'none'\r\n  // formState.response_type = trigger_web_hook_config.response_type || 'now'\r\n  // formState.response_now = trigger_web_hook_config.response_now || ''\r\n\r\n  Object.assign(formState, trigger_web_hook_config)\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  reset()\r\n})\r\n</script>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    // this.width = 420\r\n    // this.height = 102\r\n    // 当节点作为边的起始节点（source）时的校验规则\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        isHovered,\r\n        isSelected,\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'webhook-trigger-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"props.properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-name=\"props.properties.node_icon_name\"\r\n    :isSelected=\"props.isSelected\"\r\n    :isHovered=\"props.isHovered\"\r\n    :node-key=\"props.properties.node_key\"\r\n    :node_type=\"props.properties.node_type\"\r\n    style=\"width: 420px\"\r\n  >\r\n    <div class=\"ai-dialogue-node\">\r\n      <div class=\"field-list\">\r\n        <div class=\"field-item\">\r\n          <div class=\"field-item-label\">{{ t('label_knowledge_base') }}</div>\r\n          <div class=\"field-item-content\">\r\n            <div class=\"field-value\">\r\n              <span class=\"field-key\"> {{ library_name }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <template v-if=\"selectedLibraryType == 2\">\r\n          <div class=\"field-item\">\r\n            <div class=\"field-item-label\">{{ t('label_segment_question') }}</div>\r\n            <div class=\"field-item-content\">\r\n              <div class=\"field-value\">\r\n                <span class=\"field-key\">\r\n                  <at-text :options=\"valueOptions\" :defaultValue=\"formState.qa_question\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"field-item\">\r\n            <div class=\"field-item-label\">{{ t('label_segment_answer') }}</div>\r\n            <div class=\"field-item-content\">\r\n              <div class=\"field-value\">\r\n                <span class=\"field-key\">\r\n                  <at-text :options=\"valueOptions\" :defaultValue=\"formState.qa_answer\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </template>\r\n\r\n        <template v-if=\"selectedLibraryType != 2 && selectedLibraryType >= 0\">\r\n          <div class=\"field-item\" v-if=\"formState.import_type == 'content'\">\r\n            <div class=\"field-item-label\">{{ t('label_document_title') }}</div>\r\n            <div class=\"field-item-content\">\r\n              <div class=\"field-value\">\r\n                <span class=\"field-key\">\r\n                  <at-text :options=\"valueOptions\" :defaultValue=\"formState.normal_title\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"field-item\" v-if=\"formState.import_type == 'content'\">\r\n            <div class=\"field-item-label\">{{ t('label_document_content') }}</div>\r\n            <div class=\"field-item-content\">\r\n              <div class=\"field-value\">\r\n                <span class=\"field-key\">\r\n                  <at-text :options=\"valueOptions\" :defaultValue=\"formState.normal_content\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"field-item\" v-if=\"formState.import_type == 'url'\">\r\n            <div class=\"field-item-label\">{{ t('label_document_url') }}</div>\r\n            <div class=\"field-item-content\">\r\n              <div class=\"field-value\">\r\n                <span class=\"field-key\">\r\n                  <at-text :options=\"valueOptions\" :defaultValue=\"formState.normal_url\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </template>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, inject, nextTick, onBeforeUnmount, computed } from 'vue'\r\nimport NodeCommon from '../base-node.vue'\r\nimport AtText from '../../at-input/at-text.vue'\r\nimport { useWorkflowStore } from '@/stores/modules/workflow'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.nodes.import-library-node.index')\r\n\r\nconst workflowStore = useWorkflowStore()\r\n\r\nconst libraryLists = computed(() => workflowStore.libraryLists)\r\n\r\nconst props = defineProps({\r\n  properties: {\r\n    type: Object,\r\n    default: () => ({})\r\n  },\r\n  isSelected: { type: Boolean, default: false },\r\n  isHovered: { type: Boolean, default: false }\r\n})\r\n\r\nconst getNode = inject('getNode')\r\nconst resetSize = inject('resetSize')\r\n\r\nconst valueOptions = ref([])\r\n\r\n// --- State ---\r\nconst menus = ref([])\r\nconst formState = reactive({\r\n  library_group_id: '0',\r\n  library_id: [],\r\n  import_type: 'content',\r\n  normal_url: '',\r\n  normal_title: '',\r\n  normal_content: '',\r\n  normal_url_repeat_op: 'import',\r\n  qa_question: '',\r\n  qa_answer: '',\r\n  qa_images_variable: '',\r\n  qa_similar_question_variable: '',\r\n  qa_repeat_op: 'import',\r\n  outputs: [\r\n    {\r\n      key: 'msg',\r\n      typ: 'string'\r\n    }\r\n  ]\r\n})\r\n\r\nconst selectedLibraryRows = computed(() => {\r\n  return libraryLists.value.filter((item) => {\r\n    return formState.library_id.includes(item.id)\r\n  })\r\n})\r\n\r\nconst library_name = computed(() => {\r\n  return selectedLibraryRows.value[0]?.library_name\r\n})\r\n\r\nconst selectedLibraryType = computed(() => {\r\n  if (selectedLibraryRows.value && selectedLibraryRows.value.length) {\r\n    return selectedLibraryRows.value[0].type\r\n  }\r\n  return -1\r\n})\r\n\r\nconst reset = () => {\r\n  const dataRaw = props.properties.dataRaw || props.properties.node_params || '{}'\r\n  let library_import = {}\r\n  try {\r\n    getValueOptions()\r\n    library_import = JSON.parse(dataRaw).library_import || {}\r\n    for (let key in library_import) {\r\n      if (key == 'library_id') {\r\n        formState.library_id = library_import[key] ? library_import[key].split(',') : []\r\n      } else {\r\n        formState[key] = library_import[key]\r\n      }\r\n    }\r\n  } catch (e) {\r\n    image_generation = {}\r\n  }\r\n\r\n  nextTick(() => {\r\n    resetSize()\r\n  })\r\n}\r\n\r\nfunction getValueOptions() {\r\n  let options = getNode().getAllParentVariable()\r\n  valueOptions.value = options || []\r\n}\r\n\r\nwatch(\r\n  () => props.properties,\r\n  (newVal, oldVal) => {\r\n    const newDataRaw = newVal.dataRaw || newVal.node_params || '{}'\r\n    const oldDataRaw = oldVal.dataRaw || oldVal.node_params || '{}'\r\n\r\n    if (newDataRaw != oldDataRaw) {\r\n      reset()\r\n    }\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nonMounted(() => {\r\n  reset()\r\n  resetSize()\r\n})\r\n\r\nonBeforeUnmount(() => {})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.ai-dialogue-node {\r\n  .field-list {\r\n    .field-item {\r\n      display: flex;\r\n      margin-bottom: 8px;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n    .field-item-label {\r\n      width: auto;\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      font-weight: 400;\r\n      color: #262626;\r\n      text-align: right;\r\n    }\r\n    .field-item-content {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n    .category-list {\r\n      width: 100%;\r\n      overflow: hidden;\r\n    }\r\n    .field-value {\r\n      width: 100%;\r\n      line-height: 16px;\r\n      padding: 3px 4px;\r\n      height: 24px;\r\n      margin-bottom: 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #d9d9d9;\r\n      color: #595959;\r\n      background: #fff;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n      &:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n      .category-value {\r\n        width: 100%;\r\n      }\r\n\r\n      .field-type {\r\n        padding: 1px 8px;\r\n        margin-left: 4px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        line-height: 16px;\r\n        font-weight: 400;\r\n        background: #e4e6eb;\r\n      }\r\n    }\r\n  }\r\n\r\n  .options-list {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n  }\r\n  .options-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 22px;\r\n    padding: 2px 2px 2px 4px;\r\n    border-radius: 4px;\r\n    border: 1px solid #d9d9d9;\r\n\r\n    &.is-required .option-label::before {\r\n      vertical-align: middle;\r\n      content: '*';\r\n      color: #fb363f;\r\n      margin-right: 2px;\r\n    }\r\n\r\n    .option-label {\r\n      color: var(--wf-color-text-3);\r\n      font-size: 12px;\r\n      margin-right: 4px;\r\n    }\r\n\r\n    .option-type {\r\n      height: 18px;\r\n      line-height: 18px;\r\n      padding: 0 8px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      background-color: #e4e6eb;\r\n      color: var(--wf-color-text-3);\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\n\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map((edge) => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      }\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      }\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height} = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    let anchors = [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 25,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id\r\n      }\r\n    ]\r\n\r\n    return anchors\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'import-library-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode\r\n}\r\n","<style lang=\"less\" scoped>\r\n.start-node {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n\r\n  .node-desc {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: var(--wf-color-text-2);\r\n  }\r\n\r\n  .start-node-options {\r\n    display: flex;\r\n    gap: 4px;\r\n\r\n    .options-title {\r\n      line-height: 22px;\r\n      margin-right: 8px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n\r\n    .options-list {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n\r\n    .options-item {\r\n      display: flex;\r\n      align-items: center;\r\n      height: 22px;\r\n      padding: 2px 2px 2px 4px;\r\n      border-radius: 4px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &.is-required .option-label::before {\r\n        vertical-align: middle;\r\n        content: '*';\r\n        color: #fb363f;\r\n        margin-right: 2px;\r\n      }\r\n\r\n      .option-label {\r\n        color: var(--wf-color-text-3);\r\n        font-size: 12px;\r\n        margin-right: 4px;\r\n      }\r\n\r\n      .option-type {\r\n        height: 18px;\r\n        line-height: 18px;\r\n        padding: 0 8px;\r\n        border-radius: 4px;\r\n        font-size: 12px;\r\n        background-color: #e4e6eb;\r\n        color: var(--wf-color-text-3);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <node-common\r\n    :properties=\"properties\"\r\n    :title=\"properties.node_name\"\r\n    :menus=\"menus\"\r\n    :icon-url=\"robotAvatar\"\r\n    :isSelected=\"isSelected\"\r\n    :isHovered=\"isHovered\"\r\n    :node-key=\"properties.node_key\"\r\n    @handleMenu=\"handleMenu\"\r\n  >\r\n    <div class=\"start-node\">\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('label_input_params') }}</div>\r\n        <div class=\"options-list\" style=\"max-height: 82px;overflow: hidden;\">\r\n          <div\r\n            class=\"options-item\"\r\n            :class=\"{ 'is-required': item.required }\"\r\n            v-for=\"item in options\"\r\n            :key=\"item.key\"\r\n          >\r\n            <div class=\"option-label\">{{ item.key }}</div>\r\n            <div class=\"option-type\">{{ item.typ }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"start-node-options\">\r\n        <div class=\"options-title\">{{ t('label_exception_handling') }}</div>\r\n        <div class=\"options-list\">\r\n          <div class=\"options-item\">\r\n            <div class=\"option-label\">{{ t('msg_error_handling') }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </node-common>\r\n</template>\r\n\r\n<script>\r\nimport {jsonDecode} from '@/utils/index'\r\nimport NodeCommon from '../base-node.vue'\r\nimport {getRobotStartNode} from \"@/api/robot/index.js\";\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nexport default {\r\n  name: 'ZmWorkflowNode',\r\n  components: {\r\n    NodeCommon,\r\n  },\r\n  inject: ['getNode', 'getGraph', 'resetSize', 'setData'],\r\n  setup() {\r\n    const { t } = useI18n('views.workflow.components.nodes.zm-workflow-node.index')\r\n    return { t }\r\n  },\r\n  props: {\r\n    properties: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      },\r\n    },\r\n    isSelected: {type: Boolean, default: false},\r\n    isHovered: {type: Boolean, default: false},\r\n  },\r\n  data() {\r\n    return {\r\n      menus: [],\r\n      robotAvatar: '',\r\n      nodeParams: {},\r\n      options: []\r\n    }\r\n  },\r\n  mounted() {\r\n   this.init()\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.nodeParams = jsonDecode(this.properties.node_params)\r\n      this.robotAvatar = this.nodeParams?.workflow?.robot_info?.robot_avatar\r\n      this.loadRobotNode()\r\n    },\r\n    handleMenu(item) {\r\n      if (item.key === 'delete') {\r\n        let node = this.getNode()\r\n\r\n        this.getGraph().deleteNode(node.id)\r\n      }\r\n    },\r\n    loadRobotNode() {\r\n      getRobotStartNode({\r\n        robot_id: this.nodeParams?.workflow?.robot_id\r\n      }).then(res => {\r\n        let node_params = jsonDecode(res?.data?.node_params)\r\n        this.options = node_params?.start?.diy_global || []\r\n        this.update()\r\n        this.$nextTick(() => {\r\n          this.resetSize()\r\n        })\r\n      })\r\n    },\r\n    update() {\r\n      let nodeParams = this.nodeParams\r\n      let _data = nodeParams?.workflow?.params || []\r\n      if (!Array.isArray(_data) || !_data.length) {\r\n        // 首次添加时参数字段添加\r\n        let _state = JSON.parse(JSON.stringify(this.options))\r\n        for (let item of _state) {\r\n          item.variable = String(item.variable || \"\")\r\n        }\r\n        nodeParams.workflow.params = _state\r\n        this.setData({\r\n          node_params: JSON.stringify(nodeParams)\r\n        })\r\n      }\r\n    }\r\n  },\r\n}\r\n</script>\r\n","import { h as flh } from '@logicflow/core'\r\nimport { BaseVueNodeView, BaseVueNodeModel } from '../base-node.js'\r\nimport VueNode from './index.vue'\r\nclass VueHtmlNode extends BaseVueNodeView {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.renderVue(VueNode, props)\r\n  }\r\n}\r\n\r\nclass VueHtmlNodeModel extends BaseVueNodeModel {\r\n  setAttributes() {\r\n    const sourceRule01 = {\r\n      message: '只允许从右边的锚点连出',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        const sourceAnchorIds = sourceNode.graphModel.edges.map(edge => edge.sourceAnchorId)\r\n        const sourceAnchorId = sourceAnchor.id\r\n\r\n        return sourceAnchor.type === 'right' && !sourceAnchorIds.includes(sourceAnchorId)\r\n      },\r\n    }\r\n    const sourceRule02 = {\r\n      message: '分组里面的节点只能连接当前分组里面的节点,分组外面的节点只能连接分组外面的节点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if(sourceNode.properties.loop_parent_key){\r\n          return sourceNode.properties.loop_parent_key === targetNode.properties.loop_parent_key\r\n        }else{\r\n          if(targetNode.properties.loop_parent_key){\r\n            return false\r\n          }\r\n        }\r\n        return true\r\n      },\r\n    }\r\n    // sourceRules - 当节点作为边的起始节点（source）时的校验规则\r\n    this.sourceRules = [sourceRule01, sourceRule02]\r\n\r\n    const targetRule01 = {\r\n      message: '只允许连接左边的锚点',\r\n      validate: (sourceNode, targetNode, sourceAnchor, targetAnchor) => {\r\n        if (sourceNode.id == targetNode.id) {\r\n          return false\r\n        }\r\n\r\n        return targetAnchor.type === 'left'\r\n      },\r\n    }\r\n    // targetRules - 当节点作为边的目标节点（target）时的校验规则\r\n    this.targetRules = [targetRule01]\r\n  }\r\n\r\n  getDefaultAnchor() {\r\n    // 定义锚点位置\r\n    const { id, x, y, width, height, isHovered, isSelected } = this\r\n    const { nodeSortKey } = this.properties\r\n\r\n    return [\r\n      {\r\n        x: x - width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_left',\r\n        type: 'left',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y - height / 2 + 24,\r\n        id: nodeSortKey + '-anchor_right',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n      {\r\n        x: x + width / 2,\r\n        y: y + height / 2 - 28,\r\n        id: nodeSortKey + '-anchor_right_exception',\r\n        type: 'right',\r\n        nodeId: id,\r\n      },\r\n    ]\r\n  }\r\n}\r\n\r\nexport default {\r\n  type: 'zm-workflow-node',\r\n  model: VueHtmlNodeModel,\r\n  view: VueHtmlNode,\r\n}\r\n","\r\nimport { register } from '@logicflow/vue-node-registry'\r\nimport sessionTriggerNode from './session-trigger-node/index.js'\r\nimport startNode from './start-node/index.js'\r\nimport questionNode from './question-node/index.js'\r\nimport actionNode from './action-node/index.js'\r\nimport qaNode from './qa-node/index.js'\r\nimport aiDialogueNode from './ai-dialogue-node'\r\nimport httpNode from './http-node/index.js'\r\nimport httpToolNode from './http-tool-node/index.js'\r\nimport knowledgeBaseNode from './knowledge-base-node/index.js'\r\nimport endNode from './end-node/index.js'\r\nimport explainNode from './explain-node/index.js'\r\nimport variableAssignmentNode from './variable-assignment-node/index.js'\r\nimport judgeNode from './judge-node/index.js'\r\nimport specifyReplyNode from './specify-reply-node/index.js'\r\nimport immediatelyReplyNode from './immediately-reply-node/index.js'\r\nimport parameterExtractionNode from './parameter-extraction-node/index'\r\nimport problemOptimizationNode from './problem-optimization-node/index.js'\r\nimport addDataNode from './add-data-node/index.js'\r\nimport updateDataNode from './update-data-node/index.js'\r\nimport deleteDataNode from './delete-data-node/index.js'\r\nimport selectDataNode from './select-data-node/index.js'\r\nimport codeRunNode from './code-run-node/index.js'\r\nimport mcpNode from \"./mcp-node/index.js\";\r\nimport zmPluginsNode from \"./zm-plugins-node/index.js\";\r\nimport customGroupNode from './custom-group-node/index.js'\r\nimport groupStartNode from './group-start-node/index.js'\r\nimport terminateMode from './terminate-node/index.js'\r\nimport timingTriggerNode from './timing-trigger-node/index.js'\r\nimport officialTriggerNode from './official-trigger-node/index.js'\r\nimport batchGroupNode from './batch-group-node/index.js'\r\nimport imageGenerationNode from './image-generation-node/index.js'\r\nimport jsonNode from './json-node/index.js'\r\nimport jsonReverseNode from './json-reverse-node/index.js'\r\nimport voiceSynthesisNode from \"./voice-synthesis-node/index.js\";\r\nimport voiceCloneNode from \"./voice-clone-node/index.js\";\r\nimport webhookTriggerNode from './webhook-trigger-node/index.js'\r\nimport importLibraryNode from './import-library-node/index.js'\r\nimport zmWorkflowNode from \"./zm-workflow-node/index.js\";\r\n\r\n\r\n\r\nexport default function registerCustomNodes(lf) {\r\n  register(sessionTriggerNode, lf)\r\n  register(startNode, lf)\r\n  register(questionNode, lf)\r\n  register(actionNode, lf)\r\n  register(httpNode, lf)\r\n  register(httpToolNode, lf)\r\n  register(qaNode, lf)\r\n  register(aiDialogueNode, lf)\r\n  register(knowledgeBaseNode, lf)\r\n  register(endNode, lf)\r\n  register(terminateMode, lf)\r\n  register(explainNode, lf)\r\n  register(judgeNode, lf)\r\n  register(variableAssignmentNode, lf)\r\n  register(specifyReplyNode, lf)\r\n  register(immediatelyReplyNode, lf)\r\n  register(parameterExtractionNode, lf)\r\n  register(problemOptimizationNode, lf)\r\n  register(addDataNode, lf)\r\n  register(updateDataNode, lf)\r\n  register(deleteDataNode, lf)\r\n  register(selectDataNode, lf)\r\n  register(codeRunNode, lf)\r\n  register(mcpNode, lf)\r\n  register(zmPluginsNode, lf)\r\n  register(customGroupNode, lf)\r\n  register(groupStartNode, lf)\r\n  register(timingTriggerNode, lf)\r\n  register(officialTriggerNode, lf)\r\n  register(batchGroupNode, lf)\r\n  register(imageGenerationNode, lf)\r\n  register(jsonNode, lf)\r\n  register(jsonReverseNode, lf)\r\n  register(voiceSynthesisNode, lf)\r\n  register(voiceCloneNode, lf)\r\n  register(webhookTriggerNode, lf)\r\n  register(importLibraryNode, lf)\r\n  register(zmWorkflowNode, lf)\r\n}\r\n","<style lang=\"less\">\r\n.logic-flow-wrapper {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n/* 针对节点内容的foreignObject添加阴影 */\r\n\r\n.logic-flow-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  .lf-drag-able{\r\n    cursor: grab !important;\r\n  }\r\n  .lf-dragging{\r\n    cursor: grabbing !important;\r\n  }\r\n  .lf-node-content foreignObject {\r\n    filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.2)); /* 阴影效果 */\r\n    /* 如需外边框，可补充stroke相关样式（但foreignObject本身已有stroke=\"#000\"） */\r\n    /* stroke: #000; */\r\n    /* stroke-width: 2; */\r\n  }\r\n\r\n  .lf-edge-selected foreignObject{\r\n    filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.2)); /* 阴影效果 */\r\n  }\r\n\r\n  /* 自定义锚点样式 */\r\n  .custom-anchor {\r\n    cursor: pointer;\r\n\r\n    .custom-anchor-arrow,\r\n    .custom-anchor-plus {\r\n      display: none;\r\n    }\r\n  }\r\n  .custom-anchor.anchor-selected {\r\n    .custom-anchor-arrow {\r\n      display: block;\r\n    }\r\n  }\r\n  .custom-anchor.anchor-not-selected.custom-anchor-right:hover {\r\n    .custom-anchor-plus {\r\n      display: block !important;\r\n    }\r\n  }\r\n\r\n  .custom-anchor .anchor-hide {\r\n    display: none !important;\r\n  }\r\n\r\n  .lf-mini-map {\r\n    position: fixed !important;\r\n    padding: 6px;\r\n    border: none;\r\n    border-radius: 8px;\r\n    background-color: #fff;\r\n    filter: drop-shadow(0 4px 16px #0000001a);\r\n    z-index: 100;\r\n  }\r\n}\r\n.dont-show-again-checkbox {\r\n position: absolute;\r\n bottom: 26px;\r\n left: 24px;\r\n font-size: 12px;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"logic-flow-wrapper\">\r\n    <div ref=\"containerRef\" class=\"logic-flow-container\"></div>\r\n    <TeleportContainer :flow-id=\"flowId\" />\r\n\r\n    <CustomControl :lf=\"lf\" v-if=\"lf\" @runTest=\"handleRunTest\" @addNode=\"onCustomAddNode\" @zoomChange=\"handleZoomChange\" @autoLayout=\"handleAutoLayout\" />\r\n\r\n    <NodeFormDrawer\r\n      ref=\"nodeFormDrawerRef\"\r\n      v-model:open=\"nodeFormDrawerShow\"\r\n      :destroyOnClose=\"true\"\r\n      :node-id=\"selectedNode.id\"\r\n      :node=\"selectedNode.properties\"\r\n      :node-type=\"selectedNode.type\"\r\n      :lf=\"lf\"\r\n      @update-node=\"handleNodeChange\"\r\n      @change-title=\"handleChangeNodeName\"\r\n      v-if=\"selectedNode\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport '@logicflow/core/lib/style/index.css'\r\nimport '@logicflow/extension/lib/style/index.css'\r\nimport { onMounted, ref, onUnmounted, h, nextTick } from 'vue'\r\nimport { useStorage } from '@/hooks/web/useStorage'\r\nimport { Modal, Checkbox, message } from 'ant-design-vue'\r\nimport CustomControl from './custom-control/index.vue'\r\nimport NodeFormDrawer from './node-form-drawer/index.vue'\r\nimport { generateUniqueId } from '@/utils/index'\r\nimport LogicFlow from '@logicflow/core'\r\nimport { DndPanel, MiniMap, SelectionSelect, DynamicGroup } from '@logicflow/extension'\r\nimport { Elk } from './plugins/elk/elk.js'\r\nimport { GroupAutoResize } from './plugins/group-auto-resize'\r\nimport { register, getTeleport } from '@logicflow/vue-node-registry'\r\nimport { getNodesMap, createTriggerNode } from './node-list'\r\nimport customLineEdge from './edges/custom-line/index.js'\r\n// 贝塞尔曲线\r\nimport customBezierEdge from './edges/custom-bezier/index.js'\r\nimport { ContextPad } from './plugins/context-pad/index.js'\r\nimport { CanvasHistory } from './plugins/canvas-history/index.js'\r\nimport { CustomKeyboard } from './plugins/custom-keyboard/index.js'\r\nimport registerCustomNodes from './nodes/index.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.workflow-canvas')\r\n\r\nconst emit = defineEmits(['selectNode', 'onDeleteNode', 'onDeleteEdge', 'runTest', 'blankClick'])\r\n\r\nlet lf = null\r\nconst lfRef = ref(null)\r\nconst { setStorage, getStorage } = useStorage();\r\nconst DONT_SHOW_DELETE_CONFIRM_KEY = 'dont_show_delete_node_confirm';\r\nconst dontShowDeleteConfirm = ref(getStorage(DONT_SHOW_DELETE_CONFIRM_KEY) || false);\r\nconst nodeFormDrawerRef = ref(null)\r\nconst nodeFormDrawerShow = ref(false)\r\nconst selectedNode = ref(null)\r\nconst containerRef = ref(null)\r\nconst TeleportContainer = getTeleport()\r\nconst flowId = ref('')\r\nconst selectedElements = ref([]) // 用于存储当前“选中元素”\r\n\r\n\r\nconst canvasData = {\r\n  nodes: [\r\n  ]\r\n}\r\n\r\nconst miniMapOptions = {\r\n  width: 160,\r\n  height: 140,\r\n  bottomPosition: 24,\r\n  rightPosition: 16\r\n}\r\n\r\nconst selectionSelectOptions = {\r\n  exclusiveMode: false,\r\n}\r\n\r\nconst handleZoomChange = (value) => {\r\n  // zoom.value = value\r\n  if (lf) {\r\n    lf.zoom(value)\r\n  }\r\n}\r\n\r\nfunction initLogicFlow() {\r\n  if (containerRef.value) {\r\n    lf = new LogicFlow({\r\n      container: containerRef.value,\r\n      // width: containerRef.value.offsetWidth,\r\n      // height: containerRef.value.offsetHeight,\r\n      nodeTextEdit: false,\r\n      edgeTextEdit: false,\r\n      textEdit: false,\r\n      grid: false,\r\n      stopMoveGraph: false,\r\n      stopZoomGraph: true,\r\n      adjustEdge: false, // 允许调整边\r\n      adjustEdgeStartAndEnd: false, // 是否允许拖动边的端点来调整连线\r\n      adjustNodePosition: true, // 是否允许拖动节点\r\n      edgeSelectedOutline: true, // 边被选中时是否显示边的外框\r\n      nodeSelectedOutline: true, // 节点被选中时是否显示节点的外框\r\n      hoverOutline: true, // 鼠标hover节点时是否显示节点的外框\r\n      hideAnchors: false, // 是否隐藏锚点\r\n      // overlapMode: 0, // 元素重合的堆叠模式, 默认模式：0，节点层级优先，该模式下连线在下、节点在上、选中元素临时置\r\n      background: {\r\n        backgroundColor: '#f0f2f5'\r\n      },\r\n      plugins: [\r\n        DndPanel, \r\n        MiniMap, \r\n        ContextPad, \r\n        SelectionSelect, \r\n        CanvasHistory, \r\n        CustomKeyboard, \r\n        DynamicGroup,\r\n        GroupAutoResize,\r\n        Elk\r\n      ],\r\n      pluginsOptions: {\r\n        miniMap: miniMapOptions,\r\n        selectionSelect: selectionSelectOptions,\r\n        canvasHistory: {\r\n          maxHistorySize: 100\r\n        }\r\n      },\r\n      // history: false, // 关闭历史记录功能会导致小地图无法更新\r\n      keyboard: {\r\n        enabled: false,\r\n        shortcuts: [{\r\n          keys: [ // 屏蔽自带的ctrl + z, ctrl + y, ctrl + c\r\n            \"cmd + z\",\r\n            \"ctrl + z\",\r\n            \"cmd + y\",\r\n            \"ctrl + y\",\r\n            \"cmd + c\",\r\n            \"ctrl + c\",\r\n            'cmd + v',\r\n            'ctrl + v'\r\n          ],\r\n          callback: () => {\r\n            // 自定义逻辑\r\n          },\r\n        }],\r\n      }\r\n    })\r\n\r\n    lfRef.value = lf\r\n\r\n    registerCustomNodes(lf)\r\n    register(customLineEdge, lf)\r\n    register(customBezierEdge, lf)\r\n    \r\n\r\n    // lf.setDefaultEdgeType('custom-edge')\r\n    lf.setDefaultEdgeType('custom-bezier-edge')\r\n\r\n    lf.on('graph:rendered', ({ graphModel }) => {\r\n      flowId.value = graphModel.flowId\r\n    })\r\n\r\n    // 设置托拽节点时的zIndex\r\n    let dragNodeZIndexMap = {}\r\n    let nodeChildren = []\r\n\r\n    lf.on('node:dragstart', ({ data }) => {\r\n      let node = lf.graphModel.getElement(data.id)\r\n      dragNodeZIndexMap[node.id] = node.zIndex\r\n\r\n      nodeChildren = []\r\n\r\n      let nodeGroup = lf.graphModel.dynamicGroup.getGroupByNodeId(data.id)\r\n\r\n      if(nodeGroup){\r\n        nodeGroup.properties.width = nodeGroup._width\r\n        nodeGroup.properties.height = nodeGroup._height\r\n      }else{\r\n        if(!node.properties.loop_parent_key){\r\n          // 如果是非分组路面的节点  禁止拖到分组里面去\r\n          node.properties.disabled_add_group = true\r\n        }\r\n      }\r\n\r\n      // 判断是不是组\r\n      if(data.children && data.children.length > 0){\r\n        node.setZIndex(-9999)\r\n        nodeChildren = data.children || []\r\n\r\n        nodeChildren.forEach((item) => {\r\n          let nodeModel = lf.getNodeModelById(item);\r\n\r\n          dragNodeZIndexMap[nodeModel.id] = nodeModel.zIndex;\r\n          nodeModel.setZIndex(999999)\r\n        })\r\n      }else{\r\n        node.setZIndex(999999)\r\n      }\r\n\r\n      node.refreshBranch()\r\n    })\r\n\r\n    // 恢复托拽节点的zIndex\r\n    lf.on('node:drop', ({ data }) => {\r\n      let node = lf.graphModel.getElement(data.id)\r\n      let nodeGroup = lf.graphModel.dynamicGroup.getGroupByNodeId(data.id)\r\n\r\n      // 拖拽过程中组的子节点可能会丢失，需要重新添加\r\n      if(data.properties.loop_parent_key && !nodeGroup){\r\n        const groupModel = lf.getNodeModelById(data.properties.loop_parent_key);\r\n        groupModel.addChild(data.id)\r\n      }\r\n\r\n      if(data.children && data.children.length){\r\n        node.setZIndex(-9999)\r\n        data.children.forEach(item => {\r\n          let nodeModel = lf.getNodeModelById(item);\r\n          nodeModel.setZIndex(dragNodeZIndexMap[nodeModel.id])\r\n        })\r\n      }else{\r\n        node.setZIndex(dragNodeZIndexMap[node.id])\r\n      }\r\n\r\n      node.refreshBranch()\r\n    })\r\n\r\n    // 节点拖拽时动态调整边的offset\r\n    lf.on('node:drag', ({ data }) => {\r\n      const nodeId = data.id;\r\n      // 获取与当前节点相连的所有边\r\n      const relatedEdges = lf.graphModel.getNodeEdges(nodeId);\r\n      const nodeGroup = lf.graphModel.dynamicGroup.getGroupByNodeId(data.id)\r\n\r\n      // 拖拽过程中组的子节点可能会丢失，需要重新添加\r\n      // if(data.properties.loop_parent_key && !nodeGroup){\r\n      //   const groupModel = lf.getNodeModelById(data.properties.loop_parent_key);\r\n      //   groupModel.addChild(data.id)\r\n      // }\r\n\r\n      setTimeout(() => {\r\n        relatedEdges.forEach(edge => {\r\n          // 只处理目标边类型（如自定义贝塞尔边）\r\n          if (edge.type === 'custom-bezier-edge') {\r\n            // 获取边的起点和终点坐标\r\n            const { startPoint, endPoint } = edge;\r\n            \r\n            // 计算边的长度（勾股定理）\r\n            const dx = endPoint.x - startPoint.x;\r\n            const dy = endPoint.y - startPoint.y;\r\n            const length = Math.sqrt(dx * dx + dy * dy);\r\n            \r\n            // 计算新的offset（同上）\r\n            const baseOffset = 10;\r\n            const scale = 0.3;\r\n            let newOffset = baseOffset + length * scale;\r\n            const minOffset = 10;\r\n            const maxOffset = 1000;\r\n            newOffset = Math.round(newOffset)       \r\n            newOffset = Math.max(minOffset, Math.min(newOffset, maxOffset));          \r\n\r\n            edge.setProperties({\r\n              offset: newOffset,\r\n            });\r\n          }\r\n        });\r\n\r\n        if(nodeGroup){\r\n          nodeGroup.refreshBranch()\r\n        }\r\n      }, 0)\r\n    });\r\n\r\n    lf.on('node:add', () => {\r\n      // console.log('node:add', data)\r\n    })\r\n\r\n    // 添加自定义节点事件\r\n    lf.on('custom:addNode', (options) => {\r\n      onCustomAddNode(options)\r\n    })\r\n\r\n    lf.on('custom:addGroupNode', ({data, group_id}) => {\r\n      onCustomAddGroupNode(data ,group_id)\r\n    })\r\n\r\n    lf.on('group:add-node', ({ childId }) => {\r\n      const childModel = lf.getNodeModelById(childId);\r\n      // const groupModel = lf.getNodeModelById(data.id);\r\n      if(!childModel.properties.loop_parent_key){\r\n        // 移除\r\n        // console.log('移除')\r\n        // groupModel.removeChild(childId);\r\n      }\r\n      // 可以在这里执行自定义逻辑，比如更新UI状态\r\n      // updateGroupInfo(data.id, childId, 'add')\r\n    })\r\n    \r\n    // 元素点击\r\n    lf.on('element:click', (e) => {\r\n      selectedElements.value = [e.data]\r\n    })\r\n\r\n    // 点击节点\r\n    lf.on('node:click', ({ data }) => {\r\n      handleSelectedNode(data)\r\n    })\r\n\r\n    // 画布单击\r\n    lf.on('blank:click', () => {\r\n      handleBlankClick()\r\n    })\r\n\r\n    // 选区框选后触发\r\n    lf.on('selection:selected', (e) => {\r\n      let items = []\r\n\r\n      e.elements.forEach((element) => {\r\n        let data = lf.getDataById(element.id);\r\n        if(element.BaseType === 'node' || element.BaseType === 'edge'){\r\n          items.push(data)\r\n        }\r\n      })\r\n\r\n      selectedElements.value = items\r\n    })\r\n\r\n    // 节点删除\r\n    lf.on('node:delete', ({ data }) => {\r\n      let dataRaw = JSON.parse(JSON.stringify(data));\r\n      onDeleteNode(dataRaw)\r\n    })\r\n\r\n    // 边删除\r\n    lf.on('edge:delete', ({ data }) => {\r\n      let dataRaw = JSON.parse(JSON.stringify(data));\r\n      onDeleteEdge(dataRaw)\r\n    })\r\n\r\n    // 更新数据\r\n    // lf.on('custom:setData', (node) => {\r\n    //   console.log(node)\r\n    // })\r\n\r\n    // 更新NodeName\r\n    // lf.on('custom:setNodeName', (data) => {\r\n    //   console.log(data)\r\n    // })\r\n\r\n    // 自定义节点删除\r\n    lf.on('custom:node:delete', (node) => {\r\n      handleDeleteNode(node)\r\n    })\r\n\r\n    // 自定义边删除\r\n    lf.on('custom:edge:delete', (edge) => {\r\n      handleDeleteEdge(edge)\r\n    })\r\n\r\n    // 自定义键盘删除\r\n    lf.on('custom:keyoard:delete', () => {\r\n      handleKeyoardDelete()\r\n    })\r\n\r\n    // 监听批量粘贴事件\r\n    lf.on('custom:paste', handleBatchPaste)\r\n    // 监听历史记录状态变化\r\n    // lf.extension.canvasHistory.onHistoryChange((state) => {\r\n      // console.log('可撤销:', state.canUndo)\r\n      // console.log('可重做:', state.canRedo)\r\n      // console.log('历史记录数:', state.historySize)\r\n      // console.log('重做记录数:', state.redoSize)\r\n      // console.log('操作日志:', state)\r\n      // 撤销或重做操作后，清空选中元素\r\n      // selectedElements.value = []\r\n    // })\r\n\r\n    lf.render(canvasData)\r\n\r\n    lf.setZoomMiniSize(0.01)\r\n\r\n    lf.setZoomMaxSize(8)\r\n  }\r\n}\r\n\r\n\r\nconst createTriggerElements= (startNode) => {\r\n  const nodesMap = getNodesMap()\r\n  const node_params = JSON.parse(startNode.properties.node_params)\r\n  const { trigger_list } = node_params.start;\r\n\r\n  const triggerNodes = []\r\n  const triggerEdges = []\r\n  let offsetTop = 0;\r\n\r\n  trigger_list.forEach((item) => {\r\n    const type = `trigger_${item.trigger_type}`\r\n    const nodeId = generateUniqueId(type)\r\n    const nodeCongfig = nodesMap[type]\r\n    const nodeSortKey = nodeId.substring(0, 8) + nodeId.substring(nodeId.length - 8)\r\n    const edgeId = generateUniqueId(type)\r\n    // const icon = item.trigger_icon ? item.trigger_icon : nodeCongfig.properties.node_icon\r\n    const triggerNode = createTriggerNode(item)\r\n\r\n    triggerNode.id = nodeId\r\n    triggerNode.x = startNode.x - 600\r\n    triggerNode.y = startNode.y + offsetTop\r\n    triggerNode.properties.node_key = nodeId\r\n    triggerNode.properties.nodeSortKey = nodeSortKey\r\n\r\n    const edge = {\r\n      id: edgeId,\r\n      sourceNodeId: nodeId,\r\n      targetNodeId: startNode.id,\r\n      properties: {\r\n        isTriggerEdge: true,\r\n      }\r\n    }\r\n\r\n    offsetTop += nodeCongfig.height + 50\r\n\r\n    triggerNodes.push(triggerNode)\r\n    triggerEdges.push(edge)\r\n  })\r\n  \r\n  return {\r\n    nodes: triggerNodes,\r\n    edges: triggerEdges,\r\n  };\r\n}\r\n\r\nconst getData = () => {\r\n  const data = JSON.parse(JSON.stringify(lf.getGraphRawData()))\r\n  const nodes = []\r\n  const edges = []\r\n  const triggers = []\r\n\r\n  data.edges.forEach(edge => {\r\n    if(!edge.properties.isTriggerEdge){\r\n      edges.push(edge)\r\n    }\r\n  })\r\n\r\n  data.nodes.forEach(node => {\r\n    if(node.properties.isTriggerNode){\r\n      triggers.push(node)\r\n    }else{\r\n      nodes.push(node)\r\n    }\r\n  })\r\n\r\n  data.nodes = nodes;\r\n  data.edges = edges;\r\n  data.triggers = triggers;\r\n\r\n  return data;\r\n}\r\n\r\nconst setData = (data) => {\r\n  const nodesMap = getNodesMap()\r\n  let triggerElements = {\r\n    nodes: [],\r\n    edges: [],\r\n  }\r\n\r\n  data.nodes.forEach((node) => {\r\n    // 设置开始节点的宽高\r\n    let nodeCongfig = nodesMap[node.type]\r\n    node.properties.node_icon_name = nodeCongfig.properties.node_icon_name\r\n    if(!node.properties.node_header_bg_color) {\r\n      node.properties.node_header_bg_color = nodeCongfig.properties.node_header_bg_color || '#fff'\r\n    }\r\n\r\n    if (!node.properties.width) {\r\n      node.properties.width = nodeCongfig.width\r\n    }\r\n\r\n    if (!node.properties.height) {\r\n      node.properties.height = nodeCongfig.height\r\n    }\r\n    // 处理开始节点的触发器\r\n    if (node.type == 'start-node') {\r\n      triggerElements = createTriggerElements(node)\r\n    }\r\n  })\r\n\r\n  data.nodes.unshift(...triggerElements.nodes)\r\n\r\n  lf.clearData()\r\n  lf.graphModel.graphDataToModel(data)\r\n  lf.graphModel.translateCenter()\r\n  lf.extension.miniMap.show()\r\n\r\n  // 添加触发器边, 调用addEdge来产生边这样就不用计算边的位置了\r\n  triggerElements.edges.forEach(edge => {\r\n    lf.graphModel.addEdge(edge)\r\n  })\r\n\r\n  const history = lf.extension.canvasHistory\r\n  if (history) {\r\n    history.setInitialState(data)\r\n  }\r\n\r\n  handleSetNodeToGroup(data.nodes) // 给节点增加绑定关系\r\n}\r\n\r\nconst handleSetNodeToGroup = (nodes)=>{\r\n  nextTick(()=>{\r\n    nodes.forEach((node) => {\r\n    if(node.loop_parent_key){\r\n        const groupModel = lf.getNodeModelById(node.loop_parent_key);\r\n        if(groupModel){\r\n          groupModel.addChild(node.id)\r\n          lf.graphModel.dynamicGroup.sendNodeToFront(groupModel);\r\n        }\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\n// 自定义添加节点\r\nlet nodeNameMap = {}\r\n// 生成trigger节点位置\r\nconst getTriggerNodePosition = () => { \r\n  // 获取开始节点的位置\r\n  const { nodes } = lf.graphModel\r\n  const startNode = nodes.find((node) => node.type === 'start-node')\r\n\r\n  const x = startNode.x - 600\r\n  const y = startNode.y\r\n\r\n  return {\r\n    x,\r\n    y\r\n  }\r\n}\r\n\r\n// 调整组大小以适应节点\r\nconst resizeGroup = (groupModel, node) => {\r\n  // 计算节点的边界\r\n  const nodeLeftBoundary = node.x - node.width / 2;\r\n  const nodeRightBoundary = node.x + node.width / 2;\r\n  const nodeTopBoundary = node.y - node.height / 2;\r\n  const nodeBottomBoundary = node.y + node.height / 2;\r\n  \r\n  // 计算组的边界\r\n  const groupLeftBoundary = groupModel.x - groupModel._width / 2;\r\n  const groupRightBoundary = groupModel.x + groupModel._width / 2;\r\n  const groupTopBoundary = groupModel.y - groupModel._height / 2;\r\n  const groupBottomBoundary = groupModel.y + groupModel._height / 2;\r\n  \r\n  let needResize = false;\r\n  let newWidth = groupModel._width;\r\n  let newHeight = groupModel._height;\r\n  let deltaX = 0;\r\n  let deltaY = 0;\r\n  \r\n  // 检查右边界\r\n  if(nodeRightBoundary > groupRightBoundary - 20){\r\n    const extraWidth = nodeRightBoundary - groupRightBoundary + 50;\r\n    newWidth += extraWidth;\r\n    deltaX += extraWidth / 2;\r\n    needResize = true;\r\n  }\r\n  \r\n  // 检查左边界\r\n  if(nodeLeftBoundary < groupLeftBoundary + 20){\r\n    const extraWidth = groupLeftBoundary - nodeLeftBoundary + 50;\r\n    newWidth += extraWidth;\r\n    deltaX -= extraWidth / 2;\r\n    needResize = true;\r\n  }\r\n  \r\n  // 检查下边界\r\n  if(nodeBottomBoundary > groupBottomBoundary - 20){\r\n    const extraHeight = nodeBottomBoundary - groupBottomBoundary + 50;\r\n    newHeight += extraHeight;\r\n    deltaY += extraHeight / 2;\r\n    needResize = true;\r\n  }\r\n  \r\n  // 检查上边界\r\n  if(nodeTopBoundary < groupTopBoundary + 20){\r\n    const extraHeight = groupTopBoundary - nodeTopBoundary + 50;\r\n    newHeight += extraHeight;\r\n    deltaY -= extraHeight / 2;\r\n    needResize = true;\r\n  }\r\n  \r\n  // 如果需要调整大小，则更新组的尺寸和位置\r\n  if(needResize){\r\n    groupModel.properties.width = newWidth;\r\n    groupModel.properties.height = newHeight;\r\n    groupModel._width = newWidth;\r\n    groupModel._height = newHeight;\r\n    groupModel.width = newWidth;\r\n    groupModel.height = newHeight;\r\n    groupModel.x += deltaX;\r\n    groupModel.y += deltaY;\r\n  }\r\n};\r\n\r\n\r\nconst createNodeInfo = (options) => {\r\n  const data = options.node || options;\r\n  const anchorData = options.anchorData; // 来自右键菜单添加\r\n  const dropEvent = options.event;\r\n\r\n\r\n  data.id = data.id || generateUniqueId(data.type)\r\n  data.nodeSortKey = data.id.substring(0, 8) + data.id.substring(data.id.length - 8)\r\n  \r\n  // 处理节点的group绑定关系\r\n  if(anchorData){\r\n    let nodeGroup = lf.graphModel.dynamicGroup.getGroupByNodeId(anchorData.nodeId)\r\n    if(!nodeGroup){\r\n      data.properties.disabled_add_group = true\r\n    }else{\r\n      data.properties.loop_parent_key = nodeGroup.id\r\n    }\r\n  }\r\n\r\n  // 如果不是复制粘贴的节点，则处理节点名称递增\r\n  if (!options.isCopy) {\r\n    // 同一类型的节点多次添加时，从第二次添加开始，默认名称后面加上序号\r\n    if(nodeNameMap[data.type]){\r\n      nodeNameMap[data.type] = nodeNameMap[data.type] + 1\r\n      data.properties.node_name = data.properties.node_name + nodeNameMap[data.type]\r\n    }else{\r\n      nodeNameMap[data.type] = 1\r\n    }\r\n  }\r\n\r\n  data.properties.width = data.width\r\n  data.properties.height = data.height\r\n  data.properties.nodeSortKey = data.nodeSortKey\r\n\r\n  // 核心改动：判断坐标来源\r\n  if (dropEvent) {\r\n    // === 拖拽添加 ===\r\n    const { transformModel } = lf.graphModel;\r\n    // 1. 将浏览器视口坐标(clientX, clientY)转换为相对于画布容器的坐标\r\n    const { left, top } = containerRef.value.getBoundingClientRect();\r\n    const [canvasX, canvasY] = transformModel.HtmlPointToCanvasPoint([\r\n      dropEvent.clientX - left,\r\n      dropEvent.clientY - top\r\n    ]);\r\n    // 2. LogicFlow默认(x, y)为中心点，需减去宽高一半将其校正为左上角\r\n    data.x = canvasX + data.width / 2;\r\n    data.y = canvasY + data.height / 2;\r\n  } else if(!data.x && !data.y) { // 只有在没有预设坐标时才计算位置\r\n    if (anchorData) {\r\n    // === 从锚点添加 ===\r\n      data.x = anchorData.x + data.width + 100;\r\n      data.y = anchorData.y + data.height / 2 - 24;\r\n    } else {\r\n      // 触发器放到开始节点左边\r\n      if(options.isTriggerNode){\r\n        let pos = getTriggerNodePosition()\r\n        data.x = pos.x;\r\n        data.y = pos.y;\r\n        data.properties.disabled_add_group = true\r\n      }else{\r\n        // === 默认（点击）添加，放在画布中心 ===\r\n        const { transformModel } = lf.graphModel;\r\n        const point = transformModel.HtmlPointToCanvasPoint([\r\n          lf.graphModel.width / 2,\r\n          lf.graphModel.height / 2\r\n        ]);\r\n        data.x = point[0];\r\n        data.y = point[1];\r\n        data.properties.disabled_add_group = true // 从底部按钮添加的 禁止添加进入分组\r\n      }\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nconst onAddLoopGroup = (options) => {\r\n  setTimeout(() => {\r\n    onCustomAddGroupNode(\r\n      {\r\n        node: {\r\n          type: 'group-start-node',\r\n          with: 200,\r\n          properties: {\r\n            node_type: 27,\r\n            node_name: t('node_loop_start'),\r\n            node_icon_name: 'start-node',\r\n            node_params: JSON.stringify({})\r\n          }\r\n        }\r\n      },\r\n      options.id\r\n    )\r\n\r\n  }, 100)\r\n}\r\n\r\nconst onAddBatchGroup = (options) => {\r\n  setTimeout(() => {\r\n    onCustomAddGroupNode(\r\n      {\r\n        node: {\r\n          type: 'group-start-node',\r\n          with: 200,\r\n          properties: {\r\n            node_type: 31,\r\n            node_name: t('node_batch_start'),\r\n            node_icon_name: 'start-node',\r\n            node_params: JSON.stringify({})\r\n          }\r\n        }\r\n      },\r\n      options.id\r\n    )\r\n\r\n  }, 100)\r\n}\r\n\r\nconst onCustomAddNode = (options) => {\r\n  const nodeData = createNodeInfo(options);\r\n  const model = options.model; // 来自右键菜单添加\r\n  const anchorData = options.anchorData; // 来自右键菜单添加\r\n\r\n  // 情况选中状态\r\n  let hasSessionNode = false\r\n  // let zIndex = 0\r\n\r\n  lf.graphModel.nodes.forEach((node) => {\r\n    // if (node.zIndex > zIndex) {\r\n    //   zIndex = node.zIndex\r\n    // }\r\n\r\n    if(!hasSessionNode && node.type == 'session-trigger-node'){\r\n      hasSessionNode = true\r\n    }\r\n  })\r\n\r\n  // zIndex = zIndex + 1\r\n\r\n  if(hasSessionNode && nodeData.type == 'session-trigger-node'){\r\n    return message.error(t('msg_duplicate_session_trigger'))\r\n  }\r\n\r\n  // nodeData.zIndex = zIndex\r\n  // nodeData.groupZindex = zIndex\r\n\r\n  let node = lf.addNode(nodeData)\r\n\r\n  if (node.type == 'custom-group') {\r\n    onAddLoopGroup(node)\r\n  }\r\n\r\n  if(node.type == 'batch-group'){\r\n    onAddBatchGroup(node)\r\n  }\r\n\r\n  if(options.isTriggerNode){\r\n    const { nodes } = lf.graphModel\r\n    const startNode = nodes.find((node) => node.type === 'start-node')\r\n\r\n    let edge = {\r\n      type: 'custom-bezier-edge',\r\n      sourceNodeId: nodeData.id,\r\n      targetNodeId: startNode.id,\r\n      properties: {\r\n        isTriggerEdge: true,\r\n      }\r\n    }\r\n\r\n    lf.graphModel.addEdge(edge)\r\n    lf.graphModel.eventCenter.emit(\"custom:trigger-add\", nodeData);\r\n  }\r\n\r\n  if (anchorData) {\r\n    let targetAnchor = node.anchors.find((anchor) => anchor.type === 'left')\r\n\r\n    lf.graphModel.addEdge({\r\n      type: 'custom-bezier-edge',\r\n      sourceNodeId: model.id,\r\n      targetNodeId: node.id,\r\n      sourceAnchorId: anchorData.id,\r\n      targetAnchorId: targetAnchor.id,\r\n      startPoint: {\r\n        x: anchorData.x,\r\n        y: anchorData.y\r\n      },\r\n      endPoint: {\r\n        x: targetAnchor.x,\r\n        y: targetAnchor.y\r\n      }\r\n    })\r\n\r\n    // 获取锚点节点的分组\r\n    const nodeGroup = lf.graphModel.dynamicGroup.getGroupByNodeId(anchorData.nodeId)\r\n    // 如果有分组，则将节点添加到分组中并且调整分组大小和位置\r\n    if(nodeGroup && nodeGroup.id){\r\n      const groupModel = lf.getNodeModelById(nodeGroup.id);\r\n\r\n      groupModel.addChild(node.id);\r\n      \r\n      resizeGroup(groupModel, node);\r\n      \r\n      lf.graphModel.dynamicGroup.sendNodeToFront(groupModel);\r\n    }\r\n  }\r\n\r\n  // node.setZIndex(zIndex)\r\n\r\n  lf.graphModel.clearSelectElements()\r\n  node.setSelected(true)\r\n}\r\n\r\nconst onCustomAddGroupNode = (options, group_id) => {\r\n  const data = options.node || options;\r\n  data.id = generateUniqueId(data.type)\r\n  data.nodeSortKey = data.id.substring(0, 8) + data.id.substring(data.id.length - 8)\r\n\r\n  data.properties.width = data.width\r\n  data.properties.height = data.height\r\n  data.properties.nodeSortKey = data.nodeSortKey\r\n  data.properties.loop_parent_key = group_id  // 父节点的id\r\n  const groupModel = lf.getNodeModelById(group_id);\r\n\r\n  data.x = groupModel.x \r\n  data.y = groupModel.y \r\n  // 情况选中状态\r\n  let zIndex = 0\r\n  lf.graphModel.nodes.forEach((node) => {\r\n    if (node.zIndex > zIndex) {\r\n      zIndex = node.zIndex\r\n    }\r\n  })\r\n\r\n  zIndex = zIndex + 99\r\n\r\n  let node = lf.addNode(data)\r\n\r\n  groupModel.addChild(node.id);\r\n  node.setZIndex(zIndex)\r\n  lf.graphModel.clearSelectElements()\r\n  lf.graphModel.dynamicGroup.sendNodeToFront(groupModel);\r\n  // node.setSelected(true)\r\n}\r\n\r\nconst handleAutoLayout = async () => {\r\n  const graphData = lf.getGraphRawData()\r\n  const history = lf.extension.canvasHistory\r\n\r\n  // 开始事务，将布局前的状态记录下来\r\n  if (history) {\r\n    history.beginTransaction()\r\n  }\r\n\r\n  lf.extension.elk\r\n    .layout(graphData)\r\n    .then(() => {\r\n      // if(graphData.nodes.length > 10){\r\n      //   lf.fitView(32)\r\n      // }\r\n\r\n      // lf.translateCenter();\r\n\r\n      // 布局完成后提交事务\r\n      if (history) {\r\n        history.commitTransaction('auto-layout')\r\n      }\r\n    })\r\n    .catch((e) => {\r\n      message.error(t('msg_layout_failed') + e)\r\n      // 如果布局失败，回滚事务\r\n      if (history) {\r\n        history.rollbackTransaction()\r\n      }\r\n    })\r\n}\r\n\r\nconst handleBatchPaste = ({ originalNodes, basePoint, pasteBasePoint }) => {\r\n  const history = lf.extension.canvasHistory;\r\n\r\n  if (history) {\r\n    history.beginTransaction();\r\n  };\r\n\r\n  try {\r\n    const nodesToCreate = originalNodes.map(nodeData => {\r\n      const deltaX = nodeData.x - basePoint.x;\r\n      const deltaY = nodeData.y - basePoint.y;\r\n\r\n      // 关键：这里要创建一个新的对象，而不是修改剪贴板里的原始数据\r\n      const newNodeData = JSON.parse(JSON.stringify(nodeData));\r\n      newNodeData.x = pasteBasePoint.x + deltaX;\r\n      newNodeData.y = pasteBasePoint.y + deltaY;\r\n\r\n      // 调用核心函数生成最终节点信息\r\n      return createNodeInfo({ node: newNodeData, isCopy: true });\r\n    });\r\n\r\n    const { nodes: newNodes } = lf.addElements({ nodes: nodesToCreate });\r\n    lf.clearSelectElements();\r\n    newNodes.forEach(node => {\r\n      node.setSelected(true);\r\n    });\r\n\r\n    // selectedElements.value = newNodes\r\n\r\n  } finally {\r\n    if (history) {\r\n      history.commitTransaction('paste');\r\n    }\r\n  }\r\n}\r\n\r\nconst updateNode = (data) => {\r\n  if (data.height) {\r\n    data.properties.height = data.height\r\n  }\r\n\r\n  let node = lf.getNodeModelById(data.id)\r\n\r\n  node.height = data.properties.height || data.height || node.height\r\n  node.properties = data.properties\r\n\r\n  if (data.properties.node_type == 2 && data.properties.node_sub_type == 21) {\r\n    // 删除已经没有了的边\r\n    const edgeModels = node.graphModel.getNodeEdges(data.id)\r\n\r\n    edgeModels.forEach((edge) => {\r\n      // 锁定当前节点上的锚点，如果锚点不存在了，则删除连线\r\n      if (edge.sourceNodeId == node.id) {\r\n        let anchor = node.getAnchorInfo(edge.sourceAnchorId)\r\n        // 如果锚点不存在了，则删除连线\r\n        if (!anchor) {\r\n          node.graphModel.deleteEdgeById(edge.id)\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  node.refreshBranch()\r\n}\r\n\r\nfunction isNode(data){\r\n  let node = lf.getNodeModelById(data.id)\r\n  return node\r\n}\r\n\r\nfunction isEdge(data){\r\n  let edge = lf.getEdgeModelById(data.id)\r\n  return edge\r\n}\r\n\r\nfunction getTriggerNodes(){\r\n  const { nodes } = lf.getGraphData()\r\n\r\n  let triggerNodes = nodes.filter((node) => node.properties.isTriggerNode)\r\n\r\n  return triggerNodes;\r\n}\r\n\r\nconst handleDeleteNode = (node) => {\r\n  // 将右键点击的节点设置为当前唯一选中的元素\r\n  if (node && node.id) {\r\n    selectedElements.value = [node]\r\n  }\r\n\r\n  // 统一调用删除处理函数\r\n  deleteSelectedElements()\r\n}\r\n\r\nconst handleDeleteEdge = (data) => {\r\n  // 将右键点击的边设置为当前唯一选中的元素\r\n  if (data && data.id) {\r\n    selectedElements.value = [data]\r\n  }\r\n\r\n  // 统一调用删除处理函数\r\n  deleteSelectedElements()\r\n}\r\n\r\nconst handleKeyoardDelete = () => {\r\n  let selectElements = lf.getSelectElements(true)\r\n\r\n  selectedElements.value = [...selectElements.nodes, ...selectElements.edges]\r\n\r\n  // 统一调用删除处理函数\r\n  deleteSelectedElements()\r\n}\r\n\r\n// 处理删除选中元素\r\nconst deleteSelectedElements = () => {\r\n  if (selectedElements.value.length === 0) {\r\n    return\r\n  }\r\n\r\n  // 过滤掉不能删除的开始节点\r\n  const elementsToDelete = selectedElements.value.filter((el) => {\r\n    if (isNode(el)) {\r\n      return !['start-node', 'group-start-node'].includes(el.type)\r\n    }\r\n    return true // 边可以删除\r\n  })\r\n\r\n  if (elementsToDelete.length === 0) {\r\n    selectedElements.value = [] // 清空无效选择\r\n    return\r\n  }\r\n\r\n  // 限制删除触发器\r\n  const deletetTriggerNodes = selectedElements.value.filter((el) => el.properties.isTriggerNode === true)\r\n\r\n  if (deletetTriggerNodes.length > 0) {\r\n    // 必须保留一个触发器\r\n    const triggerNodes = getTriggerNodes();\r\n    if (triggerNodes.length - deletetTriggerNodes.length < 1) {\r\n      message.error(t('msg_keep_at_least_one_trigger'));\r\n      return;\r\n    }\r\n  }\r\n\r\n  // 定义核心删除逻辑，用于复用\r\n  const performDelete = () => {\r\n    const history = lf.extension.canvasHistory\r\n\r\n    // 1. 操作前：生成一个 \"即将删除\" 的快照，并用它替换掉最后一条历史记录\r\n    if (history) {\r\n      history.replaceLastState('replace-before-delete')\r\n    }\r\n\r\n    // 2. 执行所有删除操作\r\n    let isTriggerNode = false;\r\n\r\n    elementsToDelete.forEach((el) => {\r\n      if (isNode(el)) {\r\n        if(el.properties.isTriggerNode){\r\n          isTriggerNode = true;\r\n        }\r\n\r\n        lf.deleteNode(el.id)\r\n      } else if (isEdge(el)) {\r\n        lf.deleteEdge(el.id)\r\n      }\r\n    })\r\n\r\n    // 更新一下触发器的数据\r\n    if (isTriggerNode) {\r\n      lf.graphModel.eventCenter.emit(\"custom:trigger-change\", null);\r\n    }\r\n\r\n    // 3. 操作后：保存一次最终状态\r\n    if (history) {\r\n      history.saveCurrentState('delete')\r\n    }\r\n\r\n    // 4. 清空选中状态\r\n    selectedElements.value = []\r\n    lf.clearSelectElements()\r\n  }\r\n\r\n  // 判断是否需要弹窗\r\n  // 条件：当选中元素大于1个，或者选中元素为1个且是节点时，需要弹窗确认\r\n  if (dontShowDeleteConfirm.value) {\r\n    performDelete();\r\n    return;\r\n  }\r\n\r\n  if (elementsToDelete.length > 1 || (elementsToDelete.length === 1 && isNode(elementsToDelete[0]))) {\r\n    const title = elementsToDelete.length > 1 ? t('title_batch_delete') : t('title_delete_node')\r\n    const content = t('msg_confirm_delete_elements', { count: elementsToDelete.length })\r\n    let checkboxChecked = false\r\n\r\n    Modal.confirm({\r\n      title: title,\r\n      content: h('div', {}, [\r\n        h('p', content),\r\n        h(Checkbox, {\r\n          class: 'dont-show-again-checkbox',\r\n          onChange: (e) => {\r\n            checkboxChecked = e.target.checked\r\n          }\r\n        },\r\n        () => t('label_dont_show_again'))\r\n      ]),\r\n      onOk: () => {\r\n        if(checkboxChecked){\r\n          dontShowDeleteConfirm.value = true;\r\n          setStorage(DONT_SHOW_DELETE_CONFIRM_KEY, true);\r\n        }\r\n        performDelete()\r\n      },\r\n      onCancel: () => {\r\n        // 如果取消删除，不清空选择，以便用户继续操作\r\n      }\r\n    })\r\n  } else {\r\n    // 如果只选中1个边，则直接删除，不弹窗\r\n    performDelete()\r\n  }\r\n}\r\n\r\nconst noShowDrawerNode = ['group-start-node', 'terminate-node']\r\n// 选择节点\r\nconst handleSelectedNode = (data) => {\r\n  const node = JSON.parse(JSON.stringify(data))\r\n\r\n  node.properties.dataRaw =  node.properties.dataRaw || node.properties.node_params\r\n\r\n  emit('selectNode', node)\r\n\r\n  // 结束节点不支持编辑\r\n  if (noShowDrawerNode.includes(data.type)) {\r\n    return\r\n  }\r\n\r\n  selectedNode.value = node\r\n  nodeFormDrawerShow.value = true\r\n}\r\n\r\nconst handleNodeChange = (data) => {\r\n  selectedNode.value.properties = data\r\n\r\n  // 更新节点\r\n  updateNode(JSON.parse(JSON.stringify(selectedNode.value)))\r\n}\r\n\r\nconst handleChangeNodeName = (node_name) => {\r\n  selectedNode.value.properties.node_name = node_name;\r\n  // 先更新数据\r\n  updateNode(JSON.parse(JSON.stringify(selectedNode.value)))\r\n  // 在发送事件之前，确保数据已经更新\r\n  lf.graphModel.eventCenter.emit('custom:setNodeName',  {\r\n    node_name: node_name,\r\n    node_id: selectedNode.value.id,\r\n    node_type: selectedNode.value.type\r\n  })\r\n}\r\n\r\nconst onDeleteNode = (data) => {\r\n  emit('onDeleteNode', data)\r\n\r\n  if (selectedNode.value && data.id === selectedNode.value.id) {\r\n    nodeFormDrawerShow.value = false\r\n    setTimeout(() => {\r\n      selectedNode.value = null\r\n    }, 350)\r\n  }\r\n}\r\n\r\nconst onDeleteEdge = (data) => {\r\n  emit('onDeleteEdge', data)\r\n}\r\n\r\nconst handleRunTest = () => {\r\n  emit('runTest')\r\n}\r\n\r\nconst handleBlankClick = () => {\r\n  emit('blankClick')\r\n  if (nodeFormDrawerShow.value) {\r\n    nodeFormDrawerShow.value = false\r\n  }\r\n  // 清空“选中元素”\r\n  if (selectedElements.value.length > 0) {\r\n    selectedElements.value = []\r\n    lf.clearSelectElements()\r\n  }\r\n}\r\n\r\nconst focusOnNode = (nodeId) => {\r\n  if (!lf || !nodeId) return\r\n  \r\n  const nodeModel = lf.getNodeModelById(nodeId)\r\n  if (!nodeModel) return\r\n  handleZoomChange(1)\r\n  // 计算目标位置：节点中心偏左 150 像素\r\n  const targetX = nodeModel.x + 150\r\n  const targetY = nodeModel.y\r\n  \r\n  // 尝试使用 LogicFlow 的 focusOn 方法\r\n  try {\r\n    if (lf.focusOn) {\r\n      lf.focusOn({\r\n        id: nodeId,\r\n        coordinate: {\r\n          x: targetX,\r\n          y: targetY\r\n        }\r\n      })\r\n    } else {\r\n      // 如果没有 focusOn 方法，使用 translate 方法\r\n      const { transformModel } = lf.graphModel\r\n      const { width: canvasWidth, height: canvasHeight } = lf.graphModel\r\n      \r\n      // 获取当前的缩放比例\r\n      const { SCALE_X: scaleX, SCALE_Y: scaleY } = transformModel\r\n      \r\n      // 计算画布中心点在画布坐标系中的位置\r\n      const centerX = canvasWidth / 2\r\n      const centerY = canvasHeight / 2\r\n      \r\n      // 计算需要的平移量，使目标点移动到画布中心（考虑缩放比例）\r\n      const newTranslateX = (centerX - targetX) / scaleX\r\n      const newTranslateY = (centerY - targetY) / scaleY\r\n      \r\n      // 直接设置 transformModel 的平移属性\r\n      transformModel.TRANSLATE_X = newTranslateX\r\n      transformModel.TRANSLATE_Y = newTranslateY\r\n    }\r\n    handleSelectedNode({\r\n      id:nodeModel.id,\r\n      type: nodeModel.type,\r\n      properties: nodeModel.properties,\r\n      x: nodeModel.x,\r\n      y: nodeModel.y\r\n    })\r\n  } catch (error) {\r\n    console.error('Failed to focus on node:', error)\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  initLogicFlow()\r\n})\r\n\r\nonUnmounted(() => {\r\n  if (lf && lf.destroy) {\r\n    lf.destroy()\r\n  }\r\n})\r\n\r\ndefineExpose({\r\n  lfRef,\r\n  setData,\r\n  getData,\r\n  updateNode,\r\n  focusOnNode\r\n})\r\n</script>\r\n","<template>\r\n  <div>\r\n    <!-- <a-button @click=\"handleOpenTestModal\" style=\"background-color: #00ad3a\" type=\"primary\"\r\n      ><CaretRightOutlined />{{ t('btn_run_test') }}</a-button\r\n    > -->\r\n    <a-modal v-model:open=\"show\" :footer=\"null\" :width=\"820\" wrapClassName=\"no-padding-modal\">\r\n      <template #title>\r\n        <div class=\"modal-title-block\">\r\n          {{ t('btn_run_test') }}{{ formState.dialogue_id }}\r\n          <div class=\"run-detail\" v-if=\"resultList.length\">\r\n            <span>{{ t('label_total_time') }}：{{ formatTime(use_mills) }}</span>\r\n            <span>{{ t('label_token_usage') }}：{{ use_token }} {{ t('label_tokens') }}</span>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <div class=\"flex-content-box\">\r\n        <div class=\"test-model-box\">\r\n          <div class=\"top-title\">{{ t('title_start_node_params') }}</div>\r\n          <a-form\r\n            :model=\"formState\"\r\n            ref=\"formRef\"\r\n            layout=\"vertical\"\r\n            :wrapper-col=\"{ span: 24 }\"\r\n            autocomplete=\"off\"\r\n          >\r\n            <div v-show=\"!isShowQuestionForm\">\r\n              <a-form-item\r\n                :name=\"['globalState', item.key]\"\r\n                v-for=\"item in diy_global\"\r\n                :key=\"item.key\"\r\n                :rules=\"[{ required: item.required, message: t('msg_input_key', { key: item.key }) }]\"\r\n              >\r\n                <template #label>\r\n                  <a-flex :gap=\"4\"\r\n                    >{{ item.key }} <a-tag style=\"margin: 0\">{{ item.typ }}</a-tag>\r\n                    <a-tooltip :title=\"item.desc\">\r\n                      <div class=\"option-desc\">{{ item.desc }}</div>\r\n                    </a-tooltip>\r\n                  </a-flex>\r\n                </template>\r\n                <template v-if=\"item.typ == 'string'\">\r\n                  <a-input\r\n                    :placeholder=\"getDefaultPlaceholder(item)\"\r\n                    v-model:value=\"formState.globalState[item.key]\"\r\n                  />\r\n                </template>\r\n                <template v-if=\"item.typ == 'number'\">\r\n                  <a-input-number\r\n                    style=\"width: 100%\"\r\n                    :placeholder=\"getDefaultPlaceholder(item)\"\r\n                    v-model:value=\"formState.globalState[item.key]\"\r\n                  />\r\n                </template>\r\n                <template v-if=\"item.typ.includes('array')\">\r\n                  <div class=\"input-list-box\">\r\n                    <div\r\n                      class=\"input-list-item\"\r\n                      v-for=\"(input, i) in formState.globalState[item.key]\"\r\n                      :key=\"i\"\r\n                    >\r\n                      <a-form-item-rest\r\n                        ><a-input\r\n                          :placeholder=\"getDefaultPlaceholder(item)\"\r\n                          v-model:value=\"input.value\"\r\n                      /></a-form-item-rest>\r\n\r\n                      <CloseCircleOutlined\r\n                        v-if=\"formState.globalState[item.key].length > 1\"\r\n                        @click=\"handleDelItem(item.key, i)\"\r\n                      />\r\n                    </div>\r\n                    <div class=\"add-btn-box\">\r\n                      <a-button @click=\"handleAddItem(item.key)\" block type=\"dashed\">{{ t('btn_add') }}</a-button>\r\n                    </div>\r\n                  </div>\r\n                </template>\r\n              </a-form-item>\r\n            </div>\r\n\r\n            <template v-if=\"isShowQuestionForm\">\r\n              <a-form-item>\r\n                <template #label>\r\n                  <a-flex :gap=\"4\">question <a-tag style=\"margin: 0\">string</a-tag> </a-flex>\r\n                </template>\r\n                <a-input :placeholder=\"t('msg_input_key', { key: 'question' })\" v-model:value=\"formState.question\" />\r\n              </a-form-item>\r\n              <a-form-item v-if=\"question_multiple_switch\">\r\n                <template #label>\r\n                  <a-flex :gap=\"4\"\r\n                    >question_multiple <a-tag style=\"margin: 0\">string</a-tag>\r\n                  </a-flex>\r\n                </template>\r\n                <div class=\"input-list-box\">\r\n                  <div\r\n                    class=\"input-list-item\"\r\n                    v-for=\"(input, i) in formState.question_multiple\"\r\n                    :key=\"i\"\r\n                  >\r\n                    <a-form-item-rest\r\n                      ><a-input :placeholder=\"t('ph_input')\" v-model:value=\"input.value\"\r\n                    /></a-form-item-rest>\r\n\r\n                    <CloseCircleOutlined\r\n                      v-if=\"formState.question_multiple.length > 1\"\r\n                      @click=\"handleDelQuestionItem(i)\"\r\n                    />\r\n                  </div>\r\n                  <div class=\"add-btn-box\">\r\n                    <a-button @click=\"handleAddQuetionItem()\" block type=\"dashed\">{{ t('btn_add') }}</a-button>\r\n                  </div>\r\n                </div>\r\n              </a-form-item>\r\n            </template>\r\n          </a-form>\r\n\r\n          <div class=\"result-list-box loading-box\" v-if=\"loading\">\r\n            <a-spin v-if=\"loading\" :tip=\"t('msg_generating_test_result')\" />\r\n          </div>\r\n\r\n          <div class=\"result-list-box\" v-if=\"resultList.length > 0\">\r\n            <div\r\n              class=\"list-item-block\"\r\n              :class=\"{ active: currentNodeKey == item.node_key }\"\r\n              v-for=\"(item, index) in resultList\"\r\n              @click=\"handleChangeNodeKey(item)\"\r\n              :key=\"index\"\r\n            >\r\n              <div class=\"status-block\">\r\n                <CheckCircleFilled v-if=\"item.is_success\" style=\"color: #138b1b\" />\r\n                <CloseCircleFilled v-else style=\"color: #d81e06\" />\r\n              </div>\r\n              <div class=\"icon-name-box\">\r\n                <img :src=\"item.node_icon\" alt=\"\" />\r\n                <div class=\"node-name\">{{ item.node_name }}</div>\r\n              </div>\r\n              <div class=\"time-tag\" v-if=\"item.is_success\">{{ item.use_time }}ms</div>\r\n              <div class=\"right-active-icon\"><RightCircleOutlined /></div>\r\n              <!-- <div class=\"out-put-box\" v-if=\"item.is_success\">\r\n                <a-tooltip>\r\n                  <template #title>{{ item.output }}</template>\r\n                  <div class=\"out-text-box\">{{ item.output }}</div>\r\n                </a-tooltip>\r\n              </div> -->\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"save-btn-box\">\r\n            <a-button\r\n              :loading=\"loading\"\r\n              @click=\"handleSubmit\"\r\n              style=\"background-color: #00ad3a\"\r\n              type=\"primary\"\r\n              ><CaretRightOutlined />{{ isShowQuestionForm ? t('btn_continue_test') : t('btn_run_test') }} </a-button\r\n            >\r\n          </div>\r\n        </div>\r\n        <div class=\"preview-box\">\r\n          <template v-if=\"cuttentItem\">\r\n            <div class=\"preview-title\">\r\n              <div class=\"title-text\">{{ t('title_log_details') }}</div>\r\n              <div class=\"icon-name-box\">\r\n                <img :src=\"cuttentItem.node_icon\" alt=\"\" />\r\n                <div class=\"node-name\">{{ cuttentItem.node_name }}</div>\r\n              </div>\r\n              <div class=\"time-tag\" v-if=\"cuttentItem.is_success\">{{ cuttentItem.use_time }}ms</div>\r\n            </div>\r\n            <div class=\"preview-content-block\" v-if=\"currentImageList.length > 0\">\r\n              <div class=\"title-block\">{{ t('title_generated_image_log') }}</div>\r\n              <div class=\"preview-img-box\">\r\n                <ImageLogs :currentImageList=\"currentImageList\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_input') }}<CopyOutlined @click=\"handleCopy('input')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.input\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_output') }}<CopyOutlined @click=\"handleCopy('node_output')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.node_output\" />\r\n              </div>\r\n            </div>\r\n            <div class=\"preview-content-block\">\r\n              <div class=\"title-block\">{{ t('label_run_log') }}<CopyOutlined @click=\"handleCopy('output')\" /></div>\r\n              <div class=\"preview-code-box\">\r\n                <vue-json-pretty :data=\"cuttentItem.output\" />\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { isJsonString } from '@/utils/index'\r\nimport {\r\n  CaretRightOutlined,\r\n  CheckCircleFilled,\r\n  CloseCircleFilled,\r\n  CloseCircleOutlined,\r\n  RightCircleOutlined,\r\n  CopyOutlined\r\n} from '@ant-design/icons-vue'\r\nimport VueJsonPretty from 'vue-json-pretty'\r\nimport 'vue-json-pretty/lib/styles.css'\r\nimport { reactive, ref, computed, nextTick } from 'vue'\r\nimport { useRoute } from 'vue-router'\r\nimport { callWorkFlow } from '@/api/robot/index'\r\nimport { getImageUrl, formatTime } from '../util'\r\nimport { message } from 'ant-design-vue'\r\nimport { copyText } from '@/utils/index'\r\nimport ImageLogs from '@/views/workflow/components/image-logs/index.vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.components.run-test.index')\r\nconst DEFAULT_SUGGEST_MAP = computed(() => ({\r\n  openid: '38fjp8344ru43',\r\n  question: t('placeholder_hello'),\r\n  question_multiple: `{\"type\":\"text\", \"text\":\"${t('placeholder_what_is_this')}\"}`,\r\n  conversationid: '12345'\r\n}))\r\nconst props = defineProps({\r\n  lf: {\r\n    type: Object\r\n  },\r\n  start_node_params: {\r\n    default: () => {},\r\n    type: Object\r\n  },\r\n  isLockedByOther: { type: Boolean, default: false }\r\n})\r\n\r\nconst isShowQuestionForm = ref(false)\r\n\r\nconst diy_global = computed(() => {\r\n  return props.start_node_params.diy_global || []\r\n})\r\n\r\nconst question_multiple_switch = computed(() => {\r\n  let trigger_list = props.start_node_params.trigger_list || []\r\n  let result = false\r\n  trigger_list.forEach((item) => {\r\n    if (item.trigger_type == 1) {\r\n      result = item.chat_config?.question_multiple_switch\r\n    }\r\n  })\r\n  return result\r\n})\r\n\r\n// const golbalTips = `自定义全局变量（json格式）\r\n// 示例：\r\n//   {\r\n//     \"str\": \"字符串\",\r\n//     \"num\": 1,\r\n//     \"arr\": [\r\n//       \"a\",\r\n//       \"b\"\r\n//     ]\r\n//   }`\r\nconst emit = defineEmits(['save', 'getGlobal'])\r\nconst query = useRoute().query\r\n\r\nconst show = ref(false)\r\nconst currentNodeKey = ref('')\r\nconst resultList = ref([])\r\n\r\nconst cuttentItem = computed(() => {\r\n  if (!currentNodeKey.value) {\r\n    return null\r\n  }\r\n  return resultList.value.filter((item) => item.node_key == currentNodeKey.value)[0]\r\n})\r\n\r\nconst currentImageList = computed(() => {\r\n  let list = []\r\n  if (cuttentItem.value && cuttentItem.value.node_type == 33) {\r\n    let output = cuttentItem.value.output\r\n    for (let key in output) {\r\n      if (key.includes('picture_url_')) {\r\n        list.push(output[key])\r\n      }\r\n    }\r\n  }\r\n  return list\r\n})\r\n\r\nconst loading = ref(false)\r\n\r\nconst formState = reactive({\r\n  is_draft: true,\r\n  robot_key: query.robot_key,\r\n  global: '',\r\n  globalState: {},\r\n  question: '',\r\n  question_multiple: [\r\n    {\r\n      value: ''\r\n    }\r\n  ],\r\n  dialogue_id: '',\r\n  session_id: ''\r\n})\r\n\r\nconst handleOpenTestModal = () => {\r\n  isShowQuestionForm.value = false\r\n  getQuestionMultipleSwitchStatus()\r\n  let localData = localStorage.getItem('workflow_run_test_data') || '{}'\r\n  localData = JSON.parse(localData)\r\n\r\n  // formState.question = localData.question || ''\r\n  // formState.openid = localData.openid || ''\r\n  formState.global = localData.global || ''\r\n  formState.question = ''\r\n  formState.question_multiple = [\r\n    {\r\n      value: ''\r\n    }\r\n  ]\r\n  formState.dialogue_id = ''\r\n  formState.session_id = ''\r\n\r\n  resultList.value = []\r\n  currentNodeKey.value = ''\r\n  emit('getGlobal')\r\n  nextTick(() => {\r\n    diy_global.value.forEach((item) => {\r\n      formState.globalState[item.key] = setGlobalDefaultVal(item)\r\n    })\r\n    try {\r\n      let global = localData.global ? JSON.parse(localData.global) : {}\r\n      for (let key in formState.globalState) {\r\n        if (global[key]) {\r\n          if (Array.isArray(global[key])) {\r\n            formState.globalState[key] = global[key].map((item) => {\r\n              // 处理数组元素，将对象转换为字符串\r\n              let value = typeof item === 'object' ? JSON.stringify(item) : item\r\n              return {\r\n                value: value,\r\n                key: Math.random() * 1000\r\n              }\r\n            })\r\n          } else {\r\n            formState.globalState[key] = global[key]\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  })\r\n  show.value = true\r\n}\r\n\r\nfunction setGlobalDefaultVal(item) {\r\n  if (item.typ == 'string' || item.typ == 'number') {\r\n    return ''\r\n  }\r\n  return [\r\n    {\r\n      value: '',\r\n      key: Math.random() * 10000\r\n    }\r\n  ]\r\n}\r\n\r\nfunction getGlobalDefaultVal() {\r\n  let result = {}\r\n  diy_global.value.forEach((item) => {\r\n    if (item.typ == 'string') {\r\n      const v = (formState.globalState[item.key] || '').trim()\r\n      result[item.key] = v ? v : (DEFAULT_SUGGEST_MAP.value[item.key] ?? '')\r\n    }\r\n    if (item.typ == 'number') {\r\n      const raw = formState.globalState[item.key]\r\n      if (raw !== '' && raw != null) {\r\n        result[item.key] = +raw\r\n      } else {\r\n        const def = DEFAULT_SUGGEST_MAP.value[item.key]\r\n        result[item.key] = def != null && def !== '' && !isNaN(Number(def)) ? Number(def) : ''\r\n      }\r\n    }\r\n\r\n    if (item.typ.includes('array')) {\r\n      let list = formState.globalState[item.key]\r\n        .map((it) => {\r\n          it.value = typeof it.value == 'string' ? it.value.trim() : it.value\r\n\r\n          if (isJsonString(it.value)) {\r\n            return JSON.parse(it.value)\r\n          } else {\r\n            return it.value\r\n          }\r\n        })\r\n        .filter((it) => it)\r\n\r\n      if ((!Array.isArray(list) || list.length === 0) && DEFAULT_SUGGEST_MAP.value[item.key]) {\r\n        const def = DEFAULT_SUGGEST_MAP.value[item.key]\r\n        if (isJsonString(def)) {\r\n          list = [JSON.parse(def)]\r\n        } else {\r\n          list = [def]\r\n        }\r\n      }\r\n\r\n      result[item.key] = list\r\n    }\r\n\r\n    if (item.typ === 'object') {\r\n      if (isJsonString(item.value)) {\r\n        result[item.key] = JSON.parse(item.value)\r\n      }\r\n    }\r\n  })\r\n  return JSON.stringify(result)\r\n}\r\n\r\nfunction getQuestionMultipleSwitchStatus() {\r\n  const graphData = props.lf.getGraphData()\r\n  const sessionTriggerNode = graphData.nodes.find((node) => node.type === 'session-trigger-node')\r\n\r\n  if (sessionTriggerNode) {\r\n    const node_params = JSON.parse(sessionTriggerNode.properties.node_params || '{}')\r\n    const data = node_params.trigger || {}\r\n\r\n    return data.chat_config ? data.chat_config.question_multiple_switch : false\r\n  }\r\n}\r\n\r\nconst handleDelItem = (key, index) => {\r\n  formState.globalState[key].splice(index, 1)\r\n}\r\nconst handleAddItem = (key) => {\r\n  formState.globalState[key].push({\r\n    value: '',\r\n    key: Math.random() * 10000\r\n  })\r\n}\r\n\r\nconst handleDelQuestionItem = (index) => {\r\n  formState.question_multiple.splice(index, 1)\r\n}\r\nconst handleAddQuetionItem = (key) => {\r\n  formState.question_multiple.push({\r\n    value: ''\r\n  })\r\n}\r\n\r\nconst formRef = ref(null)\r\n\r\nconst use_token = ref(0)\r\nconst use_mills = ref(0)\r\n\r\nconst handleSubmit = () => {\r\n  formRef.value.validate().then(() => {\r\n    let postData = { ...formState }\r\n    const question_multiple_switch = getQuestionMultipleSwitchStatus()\r\n\r\n    postData.global = getGlobalDefaultVal()\r\n\r\n    delete postData.globalState\r\n    let question_multiple = postData.question_multiple.filter(item => item.value)\r\n    postData.question_multiple = JSON.stringify(question_multiple.map(item => item.value))\r\n\r\n    loading.value = true\r\n    resultList.value = []\r\n\r\n    const overrides = buildStorageOverrides()\r\n    if (Object.keys(overrides).length) {\r\n      localStorage.setItem(\r\n        'workflow_run_test_data',\r\n        JSON.stringify({ global: JSON.stringify(overrides) })\r\n      )\r\n    }\r\n\r\n    callWorkFlow({\r\n      ...postData,\r\n      question_multiple_switch\r\n    })\r\n      .then((res) => {\r\n        formState.dialogue_id = res.data.dialog_id\r\n        formState.session_id = res.data.session_id\r\n        let node_logs = res.data.node_logs || []\r\n        use_token.value = res.data.use_token\r\n        use_mills.value = res.data.use_mills\r\n        formateData(node_logs)\r\n      })\r\n      .catch((res) => {\r\n        resultList.value = []\r\n        isShowQuestionForm.value = false\r\n\r\n        let node_logs = res.data.node_logs || []\r\n        if (node_logs && node_logs.length) {\r\n          formateData(node_logs)\r\n        }\r\n      })\r\n      .finally(() => {\r\n        loading.value = false\r\n      })\r\n  })\r\n}\r\n\r\nconst formateData = (data) => {\r\n  let lastItem = data[data.length - 1]\r\n  if(lastItem.node_type == 43){\r\n    // 问答节点\r\n    isShowQuestionForm.value = true\r\n    message.success(t('msg_continue_qa_params'))\r\n  }else{\r\n    message.success(t('msg_test_result_generated'))\r\n    formState.question = ''\r\n    formState.question_multiple = [{value: ''}]\r\n    isShowQuestionForm.value = false\r\n  }\r\n  resultList.value = data.map((item) => {\r\n    let nodeIcon = getImageUrl(item.node_type)\r\n    // 如果node_type == 45 就是HTTP工具，node_icon用接口返回的动态数据\r\n    if (item.node_type == 45) {\r\n      nodeIcon = item.node_icon || getImageUrl(item.node_type)\r\n    }\r\n    return {\r\n      ...item,\r\n      is_success: item.error_msg === '<nil>',\r\n      node_icon: nodeIcon\r\n    }\r\n  })\r\n  currentNodeKey.value = resultList.value[0]?.node_key\r\n}\r\n\r\nconst handleChangeNodeKey = (item) => {\r\n  currentNodeKey.value = item.node_key\r\n}\r\n\r\nconst handleCopy = (key) => {\r\n  copyText(JSON.stringify(cuttentItem.value[key]))\r\n  message.success(t('msg_copy_success'))\r\n}\r\n\r\nconst open = () => {\r\n  handleOpenTestModal()\r\n}\r\n\r\nfunction getDefaultPlaceholder(item) {\r\n  const def = DEFAULT_SUGGEST_MAP.value[item.key]\r\n  return def ? `${def}` : t('ph_input')\r\n}\r\n\r\nfunction parseJSONMaybe(str) {\r\n  try {\r\n    return JSON.parse(str)\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n\r\nfunction deepEqual(a, b) {\r\n  return JSON.stringify(a) === JSON.stringify(b)\r\n}\r\n\r\nfunction buildStorageOverrides() {\r\n  const overrides = {}\r\n  diy_global.value.forEach((item) => {\r\n    const key = item.key\r\n    if (item.typ === 'string') {\r\n      const v = String(formState.globalState[key] || '').trim()\r\n      if (!v) return\r\n      const def = DEFAULT_SUGGEST_MAP.value[key]\r\n      if (def != null && v === String(def)) return\r\n      overrides[key] = v\r\n      return\r\n    }\r\n    if (item.typ === 'number') {\r\n      const raw = formState.globalState[key]\r\n      if (raw === '' || raw == null) return\r\n      const val = +raw\r\n      const def = DEFAULT_SUGGEST_MAP.value[key]\r\n      if (def != null && !isNaN(Number(def)) && val === Number(def)) return\r\n      overrides[key] = val\r\n      return\r\n    }\r\n    if (item.typ.includes('array')) {\r\n      const list = Array.isArray(formState.globalState[key]) ? formState.globalState[key] : []\r\n      const typed = list\r\n        .map((it) => String(it?.value || '').trim())\r\n        .filter((s) => s)\r\n        .map((s) => {\r\n          const o = parseJSONMaybe(s)\r\n          return o != null ? o : s\r\n        })\r\n      if (!typed.length) return\r\n      let defList = []\r\n      const def = DEFAULT_SUGGEST_MAP.value[key]\r\n      if (def != null) {\r\n        const o = parseJSONMaybe(String(def))\r\n        defList = o != null ? [o] : [String(def)]\r\n      }\r\n      if (defList.length && deepEqual(typed, defList)) return\r\n      overrides[key] = typed\r\n      return\r\n    }\r\n  })\r\n  return overrides\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.flex-content-box {\r\n  display: flex;\r\n  max-height: 70vh;\r\n  overflow: hidden;\r\n}\r\n.test-model-box {\r\n  flex: 1;\r\n  margin: 24px 0 0 0;\r\n  overflow-y: auto;\r\n  padding-right: 16px;\r\n  .top-title {\r\n    font-weight: 600;\r\n    margin-bottom: 16px;\r\n  }\r\n  .save-btn-box {\r\n    margin: 32px 0;\r\n    margin-top: 50px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n.tooltip-content {\r\n  white-space: pre-wrap;\r\n}\r\n.loading-box {\r\n  height: 100px;\r\n  justify-content: center;\r\n}\r\n.result-list-box {\r\n  margin: 24px 0;\r\n  width: 100%;\r\n  border: 1px solid #ebebeb;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 8px;\r\n  .list-item-block {\r\n    display: flex;\r\n    align-items: center;\r\n    overflow: hidden;\r\n    gap: 8px;\r\n    padding: 8px;\r\n    color: #333;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\r\n    .right-active-icon {\r\n      margin-left: auto;\r\n      color: #2475fc;\r\n      opacity: 0;\r\n    }\r\n    &:hover {\r\n      background: #f2f4f7;\r\n      .right-active-icon {\r\n        opacity: 1;\r\n      }\r\n    }\r\n    &.active {\r\n      color: #2475fc;\r\n      background: #e6efff;\r\n      .right-active-icon {\r\n        opacity: 0;\r\n      }\r\n    }\r\n    .status-block {\r\n      font-size: 20px;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      font-weight: 600;\r\n      img {\r\n        width: 24px;\r\n        height: 24px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n    .out-put-box {\r\n      flex: 1;\r\n      margin-left: 24px;\r\n      overflow: hidden;\r\n      .out-text-box {\r\n        background: #f2f2f2;\r\n        border-radius: 6px;\r\n        padding: 8px;\r\n        width: 100%;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.input-list-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  .input-list-item {\r\n    display: flex;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n.preview-box {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  border-left: 1px solid #d9d9d9;\r\n  padding: 16px;\r\n  .preview-title {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    .title-text {\r\n      font-size: 15px;\r\n      font-weight: 600;\r\n    }\r\n    .icon-name-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 14px;\r\n      margin-left: 12px;\r\n      img {\r\n        width: 16px;\r\n        height: 16px;\r\n      }\r\n    }\r\n    .time-tag {\r\n      width: fit-content;\r\n      border-radius: 4px;\r\n      height: 22px;\r\n      background: #d2f1dc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      padding: 0 4px;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n  .preview-content-block {\r\n    margin-top: 16px;\r\n    .title-block {\r\n      font-size: 15px;\r\n      color: #262626;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      .anticon-copy {\r\n        cursor: pointer;\r\n        &:hover {\r\n          color: #2475fc;\r\n        }\r\n      }\r\n    }\r\n    .preview-code-box {\r\n      width: fit-content;\r\n      min-width: 100%;\r\n      margin-top: 16px;\r\n      padding: 8px;\r\n      border-radius: 8px;\r\n      border: 1px solid #d9d9d9;\r\n\r\n      &::v-deep(.vjs-tree) {\r\n        width: fit-content;\r\n      }\r\n\r\n      &::v-deep(.vjs-tree-node) {\r\n        width: calc(100% + 16px);\r\n        padding-right: 16px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.modal-title-block {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  .run-detail {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 16px;\r\n    background: #bffbd7;\r\n    padding: 4px 16px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n    border-radius: 8px;\r\n  }\r\n}\r\n\r\n.option-desc {\r\n  max-width: 90px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  font-size: 14px;\r\n}\r\n\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.ml8 {\r\n  margin-left: 8px;\r\n}\r\n.page-header {\r\n  display: flex;\r\n  align-items: center;\r\n  height: 56px;\r\n  padding: 0 16px;\r\n  padding-left: 0;\r\n  box-shadow: 1px 1px 4px 0px rgba(0, 0, 0, 0.1);\r\n  z-index: 10;\r\n  background: #f0f2f5;\r\n  // border-bottom: 1px solid #e8eaec;\r\n  .header-left {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 40px;\r\n    height: 40px;\r\n    border-radius: 6px;\r\n    color: #000;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease-in;\r\n    &:hover {\r\n      background: #e4e6eb;\r\n    }\r\n  }\r\n  .header-content {\r\n    flex: 1;\r\n    display: flex;\r\n    align-items: center;\r\n    // padding-left: 20px;\r\n  }\r\n\r\n  .edit-box {\r\n    margin-left: 4px;\r\n\r\n    .edit-box-icon {\r\n      font-size: 18px;\r\n      cursor: pointer;\r\n\r\n      &:hover {\r\n        color: #2475fc;\r\n      }\r\n    }\r\n  }\r\n\r\n  .header-right {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n  }\r\n\r\n  .back-btn {\r\n    width: 20px;\r\n    height: 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n  }\r\n\r\n  .robot-avatar {\r\n    width: 32px;\r\n    height: 32px;\r\n    margin-right: 8px;\r\n    border-radius: 8px;\r\n  }\r\n\r\n  .robot-name {\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    color: #262626;\r\n  }\r\n  .robot-status-box {\r\n    display: flex;\r\n    gap: 2px;\r\n    align-items: center;\r\n    height: 22px;\r\n    width: fit-content;\r\n    font-size: 14px;\r\n    font-weight: 500;\r\n    border-radius: 6px;\r\n    padding: 0 6px;\r\n    .robot-status-icon {\r\n      font-size: 16px;\r\n    }\r\n\r\n    &.status-1 {\r\n      background: #ccdfff;\r\n      color: #2475fc;\r\n    }\r\n\r\n    &.status-0 {\r\n      background: #bfbfbf;\r\n      color: #fff;\r\n    }\r\n  }\r\n\r\n  .last-save-time {\r\n    font-size: 14px;\r\n    color: #8c8c8c;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n  }\r\n\r\n}\r\n.version-name {\r\n  color: #262626;\r\n}\r\n.lock-tip {\r\n  padding: 6px 85px;\r\n  background:#FFEBCC;\r\n  position: absolute;\r\n  min-height: 40px;\r\n  width: 100%;\r\n  top: 56px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 14px;\r\n  color: #000000;\r\n\r\n  .lock-info {\r\n    font-size: 12px;\r\n    color: #8c8c8c;\r\n  }\r\n}\r\n.auto-save-hint {\r\n  color: #FAAD14; /* Ant Design 的警示黄色 */\r\n  font-size: 12px;\r\n}\r\n</style>\r\n\r\n<style lang=\"less\">\r\n.popover-material {\r\n  .ant-popover-arrow {\r\n    bottom: 2px !important;\r\n  }\r\n  .ant-popover-inner {\r\n    box-shadow:\r\n      0 -3px 6px rgba(0, 0, 0, 0.1),\r\n      0 2px 8px rgba(0, 0, 0, 0.15),\r\n      -3px 0 6px rgba(0, 0, 0, 0.1),\r\n      3px 0 6px rgba(0, 0, 0, 0.1);\r\n  }\r\n  .ant-popover-inner-content {\r\n    padding: 0;\r\n  }\r\n  .lock-config {\r\n    display: flex;\r\n    align-items:center;\r\n    margin-top: 24px;\r\n    padding-left: 24px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"page-header\" :data-lf=\"lf\">\r\n    <!-- <div class=\"header-left\">\r\n      <div class=\"back-btn\" @click=\"onBack\"><LeftOutlined /></div>\r\n    </div> -->\r\n    <div class=\"header-content\">\r\n      <!-- <a-image :width=\"32\" :src=\"robotInfo.robot_avatar_url\" />\r\n      <div class=\"robot-name ml8\">{{ robotInfo.robot_name }}</div>\r\n      <div class=\"edit-box\" @click=\"onEdit\">\r\n        <svg-icon class=\"edit-box-icon\" name=\"edit\"></svg-icon>\r\n      </div> -->\r\n      <TopHeader />\r\n      <template v-if=\"robotInfo.start_node_key != ''\">\r\n        <div class=\"robot-status-box status-1\" @click=\"onEdit\">\r\n          <CheckCircleFilled class=\"robot-status-icon\" />\r\n          <div class=\"robot-status-text\">{{ t('status_published') }}</div>\r\n        </div>\r\n      </template>\r\n      <template v-else>\r\n        <div class=\"robot-status-box status-0\">\r\n          <ExclamationCircleFilled class=\"robot-status-icon\" />\r\n          <div class=\"robot-status-text\">{{ t('status_unpublished') }}</div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n    <div class=\"header-right\" v-if=\"props.showRight\">\r\n      <template v-if=\"currentVersion == '' && isEditing\">\r\n        <div class=\"last-save-time\" v-if=\"robotInfo.draft_save_time && robotInfo.draft_save_time != 0\">\r\n          {{ formatTime(robotInfo.draft_save_time, 'MM/DD HH:mm:ss') }} {{ robotInfo.draft_save_type == 'handle' ? t('save_type_manual') : t('save_type_auto') }}{{ t('save_draft') }}\r\n          <span v-if=\"isEditing && !isLockedByOther && (!autoSaveEnabled || !isLeader)\" class=\"auto-save-hint\">{{ t('msg_auto_save_stopped') }}</span>\r\n        </div>\r\n        <template v-if=\"!isLockedByOther\">\r\n          <a-button class=\"save-draft\" @click=\"handleSave('handle')\">{{ t('save_draft') }}</a-button>\r\n          <a-button type=\"primary\" :loading=\"props.saveLoading\"  class=\"publish-robot\" @click=\"handleRelease\">{{ t('publish_robot') }}</a-button>\r\n        </template>\r\n      </template>\r\n      <!-- <template v-else>\r\n        <div class=\"last-save-time\" v-if=\"currentVersion && currentVersion.version\">\r\n         <strong class=\"version-name\">v{{ currentVersion.version }}</strong> {{ formatTime(currentVersion?.create_time) }}\r\n        </div>\r\n      </template> -->\r\n      <a-button v-if=\"!isEditing && !currentVersion || isLockedByOther\" :disabled=\"isLockedByOther\" type=\"primary\" class=\"ml8\" @click=\"handleEdit\">\r\n        <template #icon>\r\n          <EditOutlined />\r\n        </template>\r\n        {{ t('btn_edit') }}\r\n      </a-button>\r\n      <a-tooltip :title=\"t('tooltip_history_details')\">\r\n        <a-button @click=\"getVersionRecord()\"><ClockCircleOutlined /></a-button>\r\n      </a-tooltip>\r\n      <!-- 管理员显示锁定图标 -->\r\n      <a-popover\r\n        v-if=\"isAdmin\"\r\n        trigger=\"click\"\r\n        placement=\"bottomRight\"\r\n        v-model:open=\"lockPopoverOpen\"\r\n        :overlay-style=\"{\r\n          width: '372px',\r\n          padding: '16px'\r\n        }\"\r\n        overlay-class-name=\"popover-material\"\r\n        @onOpenChange=\"visibleChange\"\r\n      >\r\n        <template #title>\r\n          <div style=\"display:flex;align-items:center;gap:8px;\" >\r\n            <svg-icon\r\n              class=\"lock-icon\"\r\n              name=\"lock-icon\"\r\n              style=\"font-size: 14px; color: #262626\"\r\n            ></svg-icon>\r\n            <span style=\"color: #262626;\">{{ t('title_lock_settings') }}</span>\r\n            <span style=\"color:#8c8c8c; font-weight: normal;\">{{ t('desc_lock_restriction') }}</span>\r\n          </div>\r\n        </template>\r\n        <template #content>\r\n          <div class=\"lock-config\">\r\n            <span style=\"color: #595959;\">{{ t('label_lock_after_edit') }}</span>\r\n            <a-input-number\r\n              v-model:value=\"lockMinutes\"\r\n              :min=\"10\"\r\n              :max=\"60\"\r\n              :precision=\"0\"\r\n              style=\"margin:0 4px;width:86px\"\r\n            />\r\n            <span style=\"color: #595959;\">{{ t('label_minutes_before_edit') }}</span>\r\n          </div>\r\n          <div style=\"margin-top: 24px;text-align:right;\">\r\n            <a-button class=\"ml8\" @click=\"lockPopoverOpen=false\">{{ t('btn_cancel') }}</a-button>\r\n            <a-button type=\"primary\" class=\"ml8\" :loading=\"lockLoading\" @click=\"saveLockConfig\">{{ t('btn_save') }}</a-button>\r\n          </div>\r\n        </template>\r\n        <a-button class=\"\" @click=\"lockPopoverOpen=true\" style=\"padding:5px 9px;\">\r\n          <svg-icon\r\n            class=\"lock-icon\"\r\n            name=\"lock-icon\"\r\n            style=\"font-size: 14px;\"\r\n          ></svg-icon>\r\n        </a-button>\r\n      </a-popover>\r\n    </div>\r\n    <div class=\"lock-tip\" v-if=\"isLockedByOther\">\r\n      <div>{{ t('msg_locked_by_other') }}</div>\r\n      <div class=\"lock-info\">（{{ t('label_user') + loginUserName || '--' }}  {{ t('label_ip') + lockRemoteAddr || '--' }}  {{ t('label_user_agent') + lockUserAgent || '--' }}）</div>\r\n    </div>\r\n    <RunTest ref=\"runTestRef\" :lf=\"lf\" :start_node_params=\"start_node_params\" @getGlobal=\"getGlobal\" @save=\"handleSave\" :isLockedByOther=\"isLockedByOther\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ExclamationCircleFilled, CheckCircleFilled, ClockCircleOutlined, EditOutlined } from '@ant-design/icons-vue'\r\nimport { computed, ref, onMounted, h } from 'vue'\r\nimport dayjs from 'dayjs'\r\n// front-end\\chat-ai-admin-vue\\src\\views\\robot\\robot-config\\components\\top-header.vue\r\nimport TopHeader from '@/views/robot/robot-config/components/top-header.vue'\r\nimport RunTest from './run-test/index.vue'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useUserStore } from '@/stores/modules/user'\r\nimport { saveDraftExTime, getAdminConfig } from '@/api/robot/index'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport { useEventBus } from '@/hooks/event/useEventBus.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.page-header')\r\n\r\nconst robotStore = useRobotStore()\r\n\r\nconst robotInfo = computed(() => {\r\n  return robotStore.robotInfo\r\n})\r\n\r\n// const router = useRouter()\r\n\r\nconst emit = defineEmits(['save', 'release', 'edit', 'getGlobal', 'getVersionRecord'])\r\nconst props = defineProps({\r\n  lf: { default: () => null, type: Object },\r\n  saveLoading: {\r\n    default: false,\r\n    type: Boolean\r\n  },\r\n  showRight: {\r\n    default: true,\r\n    type: Boolean\r\n  },\r\n  start_node_params: {\r\n    default: () => ({}),\r\n    type: Object\r\n  },\r\n  currentVersion:{\r\n    default: '',\r\n    type: String\r\n  },\r\n  isEditing: { default: true, type: Boolean },\r\n  isLockedByOther: { default: false, type: Boolean },\r\n  lockRemoteAddr: { default: '', type: String },\r\n  lockUserAgent: { default: '', type: String },\r\n  loginUserName: { default: '', type: String },\r\n  autoSaveEnabled: { default: true, type: Boolean },\r\n  isLeader: { default: true, type: Boolean }\r\n})\r\nconst runTestRef = ref(null)\r\n// 锁定设置仅超管/管理员显示\r\nconst userStore = useUserStore()\r\nconst isAdmin = computed(() => {\r\n  const role = userStore.userInfo?.role_type\r\n  // 约定：1=超级管理员，2=管理员（若后端不同可调整）\r\n  return role == 1 || role == 2\r\n})\r\n\r\n// 编辑锁设置弹层\r\nconst lockPopoverOpen = ref(false)\r\nconst lockMinutes = ref(10)\r\nconst lockLoading = ref(false)\r\n\r\nconst saveLockConfig = async () => {\r\n  lockLoading.value = true\r\n  try {\r\n    await saveDraftExTime({ draft_exptime: lockMinutes.value })\r\n    message.success(t('msg_lock_settings_saved'))\r\n    lockPopoverOpen.value = false\r\n  } catch (e) {\r\n    message.error(t('msg_save_failed'))\r\n  } finally {\r\n    lockLoading.value = false\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const res = await getAdminConfig()\r\n    const mins = +res?.data?.draft_exptime\r\n    if (typeof mins === 'number') {\r\n      lockMinutes.value = Math.max(10, Math.min(60, Math.round(mins)))\r\n    }\r\n  } catch (e) {\r\n    // console.warn('getAdminConfig failed', e)\r\n  }\r\n})\r\n\r\nconst visibleChange = () => {}\r\n\r\n// const onBack = () => {\r\n//   router.push('/')\r\n// }\r\n\r\nconst onEdit = () => {\r\n  emit('edit')\r\n}\r\n\r\nconst handleSave = (type = \"handle\") => {\r\n  const bus = useEventBus()\r\n  let hasError = false\r\n  const details = []\r\n  const onErr = (payload) => {\r\n    hasError = true\r\n    const comp = payload?.component || '未命名组件'\r\n    const type = payload?.typeDisplay || payload?.type || ''\r\n    const errs = Array.isArray(payload?.errors) ? payload.errors : []\r\n    errs.forEach(e => {\r\n      details.push(`【${comp}${type ? ' - ' + type : ''}】字段「${e.field_name}」：${e.message}`)\r\n    })\r\n  }\r\n  bus.on && bus.on('workflow:validate:error', onErr)\r\n  bus.emit && bus.emit('workflow:validate', { action: 'save' })\r\n  bus.off && bus.off('workflow:validate:error', onErr)\r\n  if (hasError) {\r\n    Modal.warning({\r\n      title: t('title_form_incomplete'),\r\n      content: details.length ? h('div', details.map(d => h('div', d))) : t('msg_complete_required_before_save')\r\n    })\r\n    return\r\n  }\r\n  emit('save', type)\r\n}\r\n\r\nconst handleRelease = () => {\r\n  const bus = useEventBus()\r\n  let hasError = false\r\n  const details = []\r\n  const onErr = (payload) => {\r\n    hasError = true\r\n    const comp = payload?.component || '未命名组件'\r\n    const type = payload?.typeDisplay || payload?.type || ''\r\n    const errs = Array.isArray(payload?.errors) ? payload.errors : []\r\n    errs.forEach(e => {\r\n      details.push(`【${comp}${type ? ' - ' + type : ''}】字段「${e.field_name}」：${e.message}`)\r\n    })\r\n  }\r\n  bus.on && bus.on('workflow:validate:error', onErr)\r\n  bus.emit && bus.emit('workflow:validate', { action: 'release' })\r\n  bus.off && bus.off('workflow:validate:error', onErr)\r\n  if (hasError) {\r\n    Modal.warning({\r\n      title: t('title_form_incomplete'),\r\n      content: details.length ? h('div', details.map(d => h('div', d))) : t('msg_complete_required_before_release')\r\n    })\r\n    return\r\n  }\r\n  emit('release')\r\n}\r\n\r\nconst getGlobal = () => {\r\n  emit('getGlobal')\r\n}\r\n\r\nconst getVersionRecord = () => {\r\n  emit('getVersionRecord')\r\n}\r\n\r\nconst handleEdit = () => {\r\n  emit('edit')\r\n}\r\nconst openRunTest = () => {\r\n  runTestRef.value.open()\r\n}\r\nfunction formatTime(time, formatType = 'YY-MM-DD HH:mm:ss') {\r\n  if (!time || time <= 0) {\r\n    return '--'\r\n  }\r\n  return dayjs(time * 1000).format(formatType)\r\n}\r\ndefineExpose({\r\n  openRunTest\r\n})\r\n</script>\r\n","<template>\r\n  <div>\r\n    <a-modal\r\n      v-model:open=\"open\"\r\n      :title=\"t('title_publish')\"\r\n      :ok-text=\"t('btn_publish_now')\"\r\n      @ok=\"handleOk\"\r\n      :confirmLoading=\"saveLoading\"\r\n      :width=\"600\"\r\n    >\r\n      <div class=\"form-box\">\r\n        <div class=\"form-item\">\r\n          <div class=\"form-label\">{{ t('label_version_number') }}</div>\r\n          <div class=\"form-content\">\r\n            <div class=\"version-input-box\">\r\n              v\r\n              <a-input-number v-model:value=\"value1\" :precision=\"0\" :min=\"0\" :max=\"1000\" />\r\n              <span>.</span>\r\n              <a-input-number v-model:value=\"value2\" :precision=\"0\" :min=\"0\" :max=\"1000\" />\r\n              <span>.</span>\r\n              <a-input-number v-model:value=\"value3\" :precision=\"0\" :min=\"0\" :max=\"1000\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-item\">\r\n          <div class=\"form-label\">{{ t('label_version_description') }}</div>\r\n          <div class=\"form-content\">\r\n            <a-textarea\r\n              v-model:value=\"version_desc\"\r\n              :placeholder=\"t('ph_version_desc')\"\r\n              :auto-size=\"{ minRows: 4, maxRows: 7 }\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { workFlowNextVersion, workFlowPublishVersion } from '@/api/robot/index'\r\nimport { message } from 'ant-design-vue'\r\nimport { useRoute } from 'vue-router'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.version-model')\r\n\r\nconst query = useRoute().query\r\nconst open = ref(false)\r\nlet node_list = ''\r\nconst robotStore = useRobotStore()\r\nconst value1 = ref('')\r\nconst value2 = ref('')\r\nconst value3 = ref('')\r\n\r\nconst version_desc = ref('')\r\n\r\nconst saveLoading = ref(false)\r\n\r\nconst emit = defineEmits(['ok', 'handleOpenErrorNode'])\r\n\r\nconst show = async (list) => {\r\n  let res = await getVersion()\r\n  if(res.res == 1){\r\n    if(res.data && res.data.err_node_key){\r\n      emit('handleOpenErrorNode', res.data.err_node_key)\r\n      return\r\n    }\r\n  }\r\n  version_desc.value = ''\r\n  node_list = list\r\n  open.value = true\r\n}\r\n\r\n// 唯一标识存取\r\nconst UNI_STORAGE_KEY = 'wf_uni_identifier'\r\nconst getUniIdentifier = () => {\r\n  try {\r\n    let id = localStorage.getItem(UNI_STORAGE_KEY)\r\n    if (!id) {\r\n      id = `${Date.now()}_${Math.random().toString(36).slice(2, 10)}`\r\n      localStorage.setItem(UNI_STORAGE_KEY, id)\r\n    }\r\n    return id\r\n  } catch (e) {\r\n    return `${Date.now()}_${Math.random().toString(36).slice(2, 10)}`\r\n  }\r\n}\r\n\r\n// 组装 user_agent（操作系统 + 浏览器信息）\r\nconst buildUserAgent = () => {\r\n  try {\r\n    const ua = navigator.userAgent || ''\r\n    const platform = navigator.platform || ''\r\n    let os = 'Unknown'\r\n    if (/Windows/i.test(ua)) os = 'Windows'\r\n    else if (/Macintosh|Mac OS X/i.test(ua)) os = 'MacOS'\r\n    else if (/Linux/i.test(ua)) os = 'Linux'\r\n    else if (/Android/i.test(ua)) os = 'Android'\r\n    else if (/iPhone|iPad|iPod/i.test(ua)) os = 'iOS'\r\n\r\n    let browser = 'Unknown'\r\n    let version = ''\r\n    const m = ua.match(/Edg\\/([\\d\\.]+)/) || ua.match(/Chrome\\/([\\d\\.]+)/) || ua.match(/Firefox\\/([\\d\\.]+)/) || ua.match(/Version\\/([\\d\\.]+).*Safari/)\r\n    if (m) {\r\n      if (ua.includes('Edg/')) browser = 'Edge'\r\n      else if (ua.includes('Chrome/')) browser = 'Chrome'\r\n      else if (ua.includes('Firefox/')) browser = 'Firefox'\r\n      else if (ua.includes('Safari') && !ua.includes('Chrome')) browser = 'Safari'\r\n      version = m[1]\r\n    }\r\n    return `platform=${platform}; os=${os}; browser=${browser}/${version}; ua=${ua}`\r\n  } catch (e) {\r\n    return 'ua=unknown'\r\n  }\r\n}\r\n\r\nconst handleOk = () => {\r\n  saveLoading.value = true\r\n  workFlowPublishVersion({\r\n    robot_key: query.robot_key,\r\n    node_list,\r\n    version: `${value1.value}.${value2.value}.${value3.value}`,\r\n    version_desc: version_desc.value,\r\n    uni_identifier: getUniIdentifier(),\r\n    user_agent: buildUserAgent(),\r\n    draft_save_type: 'automatic',\r\n    draft_save_time: +robotStore.robotInfo.draft_save_time || 0\r\n  })\r\n    .then(async(res) => {\r\n      // 刷新并同步最新草稿时间戳\r\n      await robotStore.getRobot(query.id)\r\n      robotStore.setDrafSaveTime({\r\n        draft_save_type: 'automatic',\r\n        draft_save_time: +robotStore.robotInfo.draft_save_time || 0,\r\n        uni_identifier: getUniIdentifier(),\r\n        user_agent: buildUserAgent()\r\n      })\r\n      open.value = false\r\n      if (res && res.res == 0) {\r\n        message.success(t('msg_publish_success'))\r\n        emit('ok')\r\n      }\r\n    }).catch((res)=>{\r\n      if(res.data && res.data.err_node_key){\r\n        emit('handleOpenErrorNode', res.data.err_node_key)\r\n      }\r\n      open.value = false\r\n    })\r\n    .finally(() => {\r\n      saveLoading.value = false\r\n    })\r\n}\r\n\r\nconst getVersion = async () => {\r\n  return workFlowNextVersion({\r\n    robot_key: query.robot_key\r\n  }).then((res) => {\r\n    let version_params = res.data.version_params || []\r\n    value1.value = version_params[0]\r\n    value2.value = version_params[1]\r\n    value3.value = version_params[2]\r\n    return res\r\n  }).catch((res)=>{\r\n    return res\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  show\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.form-box {\r\n  margin: 24px 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n  .form-item {\r\n    color: #262626;\r\n    font-size: 14px;\r\n    .form-label {\r\n      margin-bottom: 6px;\r\n    }\r\n  }\r\n  .version-input-box {\r\n    display: flex;\r\n    gap: 4px;\r\n    align-items: self-end;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div>\r\n    <a-drawer v-model:open=\"open\" :title=\"t('title_publish_detail')\" placement=\"right\" :width=\"400\" :bodyStyle=\"{ padding: '12px 24px' }\">\r\n      <div class=\"version-detail\">\r\n        <div class=\"version-list\" @click=\"handlePreviewVersion('')\" v-if=\"robotInfo.draft_save_time && robotInfo.draft_save_time != 0\">\r\n          <div class=\"version-header\">\r\n            <div class=\"version-title\">{{ t('label_current_draft') }}</div>\r\n          </div>\r\n          <div class=\"version-desc flex-center\">\r\n            {{ t('label_saved_at') }}{{ formatTime(robotInfo.draft_save_time, 'MM/DD HH:mm:ss') }}\r\n            <div class=\"version-file-box\">\r\n              <a-popover placement=\"topRight\" :overlay-style=\"{\r\n                'max-width': '372px'\r\n              }\">\r\n                <template #content>\r\n                  <div class=\"version-text\">\r\n                    IP：{{ currentIp || '--' }}\r\n                  </div>\r\n                  <div class=\"version-text\">\r\n                    User Agent：{{ currentUA || '--' }}\r\n                  </div>\r\n                </template>\r\n                <svg-icon\r\n                  class=\"file-icon\"\r\n                  name=\"file-icon\"\r\n                  style=\"font-size: 14px; color: #333\"\r\n                ></svg-icon>\r\n              </a-popover>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div\r\n          class=\"version-list\"\r\n          @click=\"handlePreviewVersion(item.version_id)\"\r\n          v-for=\"(item, index) in list\"\r\n          :key=\"item.version\"\r\n        >\r\n          <div class=\"version-header\">\r\n            <div class=\"version-title\">\r\n              v{{ item.version }}\r\n              <span class=\"time-text flex-center\">\r\n                {{ formatTime(item.create_time) }}\r\n                <div class=\"version-file-box\">\r\n                  <a-popover placement=\"topRight\" :overlay-style=\"{\r\n                    'max-width': '372px'\r\n                  }\">\r\n                    <template #content>\r\n                      <div class=\"version-text\">\r\n                        IP：{{ item.last_edit_ip || '--' }}\r\n                      </div>\r\n                      <div class=\"version-text\">\r\n                        User Agent：{{ item.last_edit_user_agent || '--' }}\r\n                      </div>\r\n                    </template>\r\n                    <svg-icon\r\n                      class=\"file-icon\"\r\n                      name=\"file-icon\"\r\n                      style=\"font-size: 14px; color: #333\"\r\n                    ></svg-icon>\r\n                  </a-popover>\r\n                </div>\r\n              </span>\r\n            </div>\r\n            <a-dropdown>\r\n              <div class=\"hover-btn-box\" @click.stop=\"\">\r\n                <EllipsisOutlined />\r\n              </div>\r\n\r\n              <template #overlay>\r\n                <a-menu>\r\n                  <a-menu-item :disabled=\"props.isLockedByOther\" @click=\"setVersion(item)\"> {{ t('btn_restore_version') }} </a-menu-item>\r\n                </a-menu>\r\n              </template>\r\n            </a-dropdown>\r\n          </div>\r\n          <div class=\"version-desc\">\r\n            {{ item.version_desc }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </a-drawer>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, h, computed } from 'vue'\r\nimport { workFlowVersions, workFlowVersionDetail, getNodeList, getDraftKey } from '@/api/robot/index'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport { EllipsisOutlined } from '@ant-design/icons-vue'\r\nimport dayjs from 'dayjs'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useRoute } from 'vue-router'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.publish-detail')\r\n\r\nconst query = useRoute().query\r\nconst open = ref(false)\r\nconst currentIp = ref('')\r\nconst currentUA = ref('')\r\n\r\nconst emit = defineEmits(['setVersion', 'preview'])\r\nconst props = defineProps({\r\n  isLockedByOther: { type: Boolean, default: false }\r\n})\r\nconst robotStore = useRobotStore()\r\nconst robotInfo = computed(() => {\r\n  return robotStore.robotInfo\r\n})\r\n\r\nconst list = ref([])\r\nconst showDrawer = () => {\r\n  open.value = true\r\n  getDetailList()\r\n  // 获取当前客户端信息\r\n  getDraftKey({\r\n    robot_key: query.robot_key\r\n  }).then((res) => {\r\n    // const res = {\"msg\":\"success\",\"res\":0,\"data\":{\"is_self\":true,\"lock_res\":true,\"lock_ttl\":955,\"remote_addr\":\"171.83.17.34\",\"robot_key\":\"yw5BnxX80G\",\"staff_id\":3432,\"user_agent\":\"Mozilla\\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\\/537.36 (KHTML, like Gecko) Chrome\\/142.0.0.0 Safari\\/537.36\"}}\r\n    const data = res?.data || {}\r\n    currentIp.value = data.remote_addr || ''\r\n    currentUA.value = data.user_agent || ''\r\n  })\r\n}\r\n\r\nconst getDetailList = () => {\r\n  workFlowVersions({\r\n    robot_key: query.robot_key\r\n  }).then((res) => {\r\n    list.value = res.data.versions || []\r\n  })\r\n}\r\n\r\nconst setVersion = (item) => {\r\n  Modal.confirm({\r\n    title: t('msg_confirm_restore_version', { version: item.version }),\r\n    icon: null,\r\n    content: h(\r\n      'div',\r\n      { style: 'color:red;' },\r\n      t('msg_restore_warning')\r\n    ),\r\n    onOk() {\r\n      workFlowVersionDetail({\r\n        robot_key: query.robot_key,\r\n        version_id: item.version_id\r\n      }).then((res) => {\r\n        emit('setVersion', res.data)\r\n        open.value = false\r\n        if (res.res == 0) {\r\n          message.success(t('msg_set_success'))\r\n        }\r\n      })\r\n    },\r\n    onCancel() {}\r\n  })\r\n}\r\n\r\nconst handlePreviewVersion = (version) => {\r\n  // if (props.isLockedByOther) {\r\n  //   message.warning('当前已有其他用户在编辑中，无法预览')\r\n  //   return\r\n  // }\r\n  if (version == '') {\r\n    getNodeList({\r\n      robot_key: query.robot_key,\r\n      data_type: 1\r\n    }).then((res) => {\r\n      emit('preview', res.data, version)\r\n      open.value = false\r\n    })\r\n  } else {\r\n    workFlowVersionDetail({\r\n      robot_key: query.robot_key,\r\n      version_id: version\r\n    }).then((res) => {\r\n      emit('preview', res.data, version)\r\n      open.value = false\r\n    })\r\n  }\r\n}\r\n\r\nfunction formatTime(time, formatType = 'YYYY-MM-DD HH:mm:ss') {\r\n  if (time <= 0) {\r\n    return '--'\r\n  }\r\n  return dayjs(time * 1000).format(formatType)\r\n}\r\n\r\ndefineExpose({\r\n  showDrawer\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.hover-btn-box {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  &:hover {\r\n    background-color: #e4e6eb;\r\n  }\r\n}\r\n\r\n.version-detail {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n  .version-list {\r\n    padding: 8px 16px;\r\n    border-radius: 6px;\r\n    background-color: #F2F4F7;\r\n    cursor: pointer;\r\n    .version-header {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      color: #000;\r\n      font-weight: 600;\r\n      margin-bottom: 8px;\r\n      .time-text {\r\n        color: #8c8c8c;\r\n        margin-left: 12px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.flex-center {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.version-file-box {\r\n  margin-left: 8px;\r\n}\r\n\r\n.version-title {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.version-desc {\r\n  // 保持返回的格式\r\n  white-space: pre-wrap;\r\n  color: #595959;\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.workflow-page {\r\n  display: flex;\r\n  flex-flow: column nowrap;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  position: relative;\r\n\r\n  .page-body {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-flow: row nowrap;\r\n    overflow: hidden;\r\n    background: #f0f2f5;\r\n\r\n    .page-left {\r\n      height: 100%;\r\n      padding: 8px;\r\n    }\r\n\r\n    .page-container {\r\n      flex: 1;\r\n      height: 100%;\r\n    }\r\n  }\r\n}\r\n\r\n.logic-flow-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"workflow-page\">\r\n    <PageHeader\r\n      ref=\"pageHeaderRef\"\r\n      @edit=\"handleClickEdit\"\r\n      @save=\"handleSave\"\r\n      @release=\"handleRelease\"\r\n      @getGlobal=\"getGlobal\"\r\n      @getVersionRecord=\"getVersionRecord\"\r\n      :lf=\"lf\"\r\n      :currentVersion=\"currentVersionData\"\r\n      :start_node_params=\"start_node_params\"\r\n      :saveLoading=\"saveLoading\"\r\n      :isEditing=\"isEditing\"\r\n      :isLockedByOther=\"isLockedByOther\"\r\n      :lockRemoteAddr=\"lockRemoteAddr\"\r\n      :lockUserAgent=\"lockUserAgent\"\r\n      :loginUserName=\"loginUserName\"\r\n      :autoSaveEnabled=\"autoSaveEnabled\"\r\n      :isLeader=\"isLeaderFlag\"\r\n    />\r\n    <div class=\"page-body\">\r\n      <div class=\"page-left\">\r\n        <PageSidebar />\r\n      </div>\r\n      <div class=\"page-container\">\r\n        <WorkflowCanvas\r\n          ref=\"workflowCanvasRef\"\r\n          @selectedNode=\"handleSelectedNode\"\r\n          @onDeleteNode=\"onDeleteNode\"\r\n          @runTest=\"handleRunTest\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <AddRobotAlert ref=\"addRobotAlertRef\" />\r\n    <VersionModel ref=\"versionModelRef\" @handleOpenErrorNode=\"handleOpenErrorNode\" />\r\n    <PublishDetail\r\n      ref=\"publishDetailRef\"\r\n      @preview=\"handlePreviewVersion\"\r\n      @setVersion=\"setVersion\"\r\n      :isLockedByOther=\"isLockedByOther\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useWorkflowStore } from '@/stores/modules/workflow'\r\nimport { getNodeList, saveNodes, getDraftKey, workFlowNextVersion } from '@/api/robot/index'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { generateUniqueId, duplicateRemoval, removeRepeat } from '@/utils/index'\r\nimport { onMounted, ref, onUnmounted, watch, computed, h, provide} from 'vue'\r\nimport { useRoute } from 'vue-router'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport dayjs from 'dayjs'\r\nimport PageSidebar from './components/page-sidebar.vue'\r\nimport WorkflowCanvas from './components/workflow-canvas.vue'\r\nimport PageHeader from './components/page-header.vue'\r\nimport AddRobotAlert from '@/views/robot/robot-list/components/add-robot-alert.vue'\r\nimport { getNodeTypes } from './components/node-list'\r\nimport VersionModel from './components/version-model.vue'\r\nimport PublishDetail from './components/publish-detail.vue'\r\nimport { getModelConfigOption } from '@/api/model/index'\r\nimport { getModelOptionsList } from '@/components/model-select/index.js'\r\nimport { useModelStore } from '@/stores/modules/model'\r\nimport {downloadPlugin, openPlugin} from \"@/api/plugins/index.js\"\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.workflow.index')\r\n\r\nconst modelStore = useModelStore()\r\n\r\nconst route = useRoute()\r\nconst query = route.query\r\nconst robot_key = ref(route.query.robot_key)\r\n\r\n// 唯一标识与 user_agent 组装\r\nconst UNI_STORAGE_KEY = 'wf_uni_identifier'\r\nconst getUniIdentifier = () => {\r\n  try {\r\n    let id = localStorage.getItem(UNI_STORAGE_KEY)\r\n    if (!id) {\r\n      id = `${Date.now()}_${Math.random().toString(36).slice(2, 10)}`\r\n      localStorage.setItem(UNI_STORAGE_KEY, id)\r\n    }\r\n    return id\r\n  } catch (e) {\r\n    return `${Date.now()}_${Math.random().toString(36).slice(2, 10)}`\r\n  }\r\n}\r\nconst buildUserAgent = () => {\r\n  try {\r\n    const ua = navigator.userAgent || ''\r\n    const platform = navigator.platform || ''\r\n    let os = 'Unknown'\r\n    if (/Windows/i.test(ua)) os = 'Windows'\r\n    else if (/Macintosh|Mac OS X/i.test(ua)) os = 'MacOS'\r\n    else if (/Linux/i.test(ua)) os = 'Linux'\r\n    else if (/Android/i.test(ua)) os = 'Android'\r\n    else if (/iPhone|iPad|iPod/i.test(ua)) os = 'iOS'\r\n    let browser = 'Unknown'\r\n    let version = ''\r\n    const m = ua.match(/Edg\\/([\\d\\.]+)/) || ua.match(/Chrome\\/([\\d\\.]+)/) || ua.match(/Firefox\\/([\\d\\.]+)/) || ua.match(/Version\\/([\\d\\.]+).*Safari/)\r\n    if (m) {\r\n      if (ua.includes('Edg/')) browser = 'Edge'\r\n      else if (ua.includes('Chrome/')) browser = 'Chrome'\r\n      else if (ua.includes('Firefox/')) browser = 'Firefox'\r\n      else if (ua.includes('Safari') && !ua.includes('Chrome')) browser = 'Safari'\r\n      version = m[1]\r\n    }\r\n    return `platform=${platform}; os=${os}; browser=${browser}/${version}; ua=${ua}`\r\n  } catch (e) {\r\n    return 'ua=unknown'\r\n  }\r\n}\r\n\r\nconst addRobotAlertRef = ref(null)\r\nconst workflowCanvasRef = ref(null)\r\n\r\nconst workflowStore = useWorkflowStore()\r\nconst robotStore = useRobotStore()\r\nconst lf = computed(() => {\r\n  return workflowCanvasRef.value?.lfRef\r\n})\r\n\r\n// 触发器列表\r\nconst triggerList = computed(() => workflowStore.triggerList)\r\n\r\nconst currentVersion = ref('')\r\nconst currentVersionData = ref('')\r\nconst pageHeaderRef = ref(null)\r\n\r\nconst loop_save_canvas_status = computed(()=>{\r\n  return robotStore.robotInfo.loop_save_canvas_status\r\n})\r\n\r\nwatch(loop_save_canvas_status, (val) => {\r\n  // 在循环节点里面打开 运行测试 保存一下草稿\r\n  if(val > 0){\r\n    handleSave('automatic')\r\n  }\r\n})\r\n\r\n// const nodes = []\r\nconst nodeTypes = getNodeTypes()\r\n\r\n// 协同编辑与自动保存控制\r\nconst isEditing = ref(true) // 是否处于可编辑状态\r\nconst isLockedByOther = ref(false) // 是否被其他人编辑锁定\r\nconst autoSaveEnabled = ref(true) // 是否允许自动保存\r\nlet inactivityTimer = null // 无改动计时器（5分钟）\r\nlet changeMonitorTimer = null // 变更监控定时器\r\nlet lastChangeTs = Date.now() // 最近一次检测到数据变更的时间戳\r\nlet lastChangeHash = '' // 最近一次快照hash\r\nconst INACTIVITY_MS = 5 * 60 * 1000\r\n// 他人持锁信息\r\nconst lockRemoteAddr = ref('')\r\nconst lockUserAgent = ref('')\r\nconst loginUserName = ref('')\r\n// 领导者状态用于 UI 提示\r\nconst isLeaderFlag = ref(false)\r\n// 跨标签页自动保存协调（仅允许一个标签执行自动保存）\r\nconst TAB_ID = `${Date.now()}_${Math.random()}`\r\nconst LEADER_TTL_MS = 60 * 1000\r\nconst HEARTBEAT_MS = 20 * 1000\r\nlet heartbeatTimer = null\r\nconst LEADER_PREFIX = 'wf_autosave_leader_'\r\nconst getLeaderKey = () => `${LEADER_PREFIX}${robot_key.value}`\r\nconst getOpenTabsKey = () => `wf_open_tabs_${robot_key.value}`\r\n\r\nfunction incrementOpenTabs () {\r\n  try {\r\n    const n = parseInt(localStorage.getItem(getOpenTabsKey()) || '0', 10) || 0\r\n    localStorage.setItem(getOpenTabsKey(), String(n + 1))\r\n  } catch (e) {\r\n    console.warn('incrementOpenTabs error', e)\r\n  }\r\n}\r\nfunction decrementOpenTabs () {\r\n  try {\r\n    const n = parseInt(localStorage.getItem(getOpenTabsKey()) || '0', 10) || 0\r\n    const next = Math.max(0, n - 1)\r\n    if (next <= 0) {\r\n      setTimeout(() => {\r\n        localStorage.removeItem(getOpenTabsKey())\r\n        // 所有同工作流页面关闭时，强制释放领导者键\r\n        localStorage.removeItem(getLeaderKey())\r\n      }, 0)\r\n    } else {\r\n      localStorage.setItem(getOpenTabsKey(), String(next))\r\n    }\r\n  } catch (e) {\r\n    console.warn('decrementOpenTabs error', e)\r\n   }\r\n}\r\n\r\nfunction cleanupExpiredLeaderKeys () {\r\n  try {\r\n    const now = Date.now()\r\n    for (let i = 0; i < localStorage.length; i++) {\r\n      const key = localStorage.key(i)\r\n      if (key && key.startsWith(LEADER_PREFIX)) {\r\n        const raw = localStorage.getItem(key)\r\n        let obj = null\r\n        try { obj = raw ? JSON.parse(raw) : null } catch (e) { obj = null }\r\n        if (!obj || typeof obj.ts !== 'number' || now - obj.ts > LEADER_TTL_MS) {\r\n          localStorage.removeItem(key)\r\n        }\r\n      }\r\n    }\r\n  } catch (e) {\r\n    console.warn('cleanupExpiredLeaderKeys error', e)\r\n   }\r\n}\r\nfunction getLeader () {\r\n  try {\r\n    const raw = localStorage.getItem(getLeaderKey())\r\n    return raw ? JSON.parse(raw) : null\r\n  } catch (e) {\r\n    return null\r\n  }\r\n}\r\nfunction becomeLeader () {\r\n  localStorage.setItem(getLeaderKey(), JSON.stringify({ tabId: TAB_ID, ts: Date.now() }))\r\n}\r\nfunction isLeader () {\r\n  const leader = getLeader()\r\n  if (!leader) {\r\n    becomeLeader()\r\n    return true\r\n  }\r\n  const expired = Date.now() - leader.ts > LEADER_TTL_MS\r\n  if (expired) {\r\n    becomeLeader()\r\n    return true\r\n  }\r\n  return leader.tabId === TAB_ID\r\n}\r\nfunction releaseLeader () {\r\n  const leader = getLeader()\r\n  if (leader && leader.tabId === TAB_ID) {\r\n    localStorage.removeItem(getLeaderKey())\r\n  }\r\n}\r\nfunction releaseSpecificLeader (key) {\r\n  try {\r\n    const raw = localStorage.getItem(key)\r\n    const obj = raw ? JSON.parse(raw) : null\r\n    if (obj && obj.tabId === TAB_ID) {\r\n      localStorage.removeItem(key)\r\n    }\r\n  } catch (e) {\r\n    // console.warn('releaseSpecificLeader parse error', e)\r\n  }\r\n}\r\nfunction storageHandler (e) {\r\n  if (e.key === getLeaderKey()) {\r\n    // 领导者变更时更新自动保存定时器\r\n    updateAutoSaveTimer()\r\n    cleanupExpiredLeaderKeys()\r\n    isLeaderFlag.value = isLeader()\r\n  }\r\n}\r\nfunction visibilityHandler () {\r\n  // 页面可见时尝试争取领导权，不可见时交由其他标签页\r\n  if (document.visibilityState === 'visible') {\r\n    isLeaderFlag.value = isLeader()\r\n  }\r\n  cleanupExpiredLeaderKeys()\r\n  updateAutoSaveTimer()\r\n}\r\nfunction startLeaderHeartbeat () {\r\n  stopLeaderHeartbeat()\r\n  // 初始化领导者身份\r\n  cleanupExpiredLeaderKeys()\r\n  isLeaderFlag.value = isLeader()\r\n  heartbeatTimer = setInterval(() => {\r\n    const leaderNow = isLeader()\r\n    isLeaderFlag.value = leaderNow\r\n    if (leaderNow) {\r\n      localStorage.setItem(getLeaderKey(), JSON.stringify({ tabId: TAB_ID, ts: Date.now() }))\r\n    }\r\n  }, HEARTBEAT_MS)\r\n  window.addEventListener('storage', storageHandler)\r\n  document.addEventListener('visibilitychange', visibilityHandler)\r\n  window.addEventListener('beforeunload', () => { releaseLeader(); decrementOpenTabs() })\r\n  window.addEventListener('pagehide', () => { releaseLeader(); decrementOpenTabs() })\r\n}\r\nfunction stopLeaderHeartbeat () {\r\n  heartbeatTimer && clearInterval(heartbeatTimer)\r\n  heartbeatTimer = null\r\n  window.removeEventListener('storage', storageHandler)\r\n  document.removeEventListener('visibilitychange', visibilityHandler)\r\n  window.removeEventListener('beforeunload', releaseLeader)\r\n}\r\n\r\nfunction computeCanvasHash () {\r\n  try {\r\n    const data = getCanvasData()\r\n    return JSON.stringify(data)\r\n  } catch (e) {\r\n    return ''\r\n  }\r\n}\r\n\r\nfunction startChangeMonitor () {\r\n  stopChangeMonitor()\r\n  // 记录进入编辑后的初始快照\r\n  lastChangeHash = computeCanvasHash()\r\n  lastChangeTs = Date.now()\r\n  changeMonitorTimer = setInterval(() => {\r\n    if (!isEditing.value) return\r\n    const hash = computeCanvasHash()\r\n    if (hash && hash !== lastChangeHash) {\r\n      lastChangeHash = hash\r\n      lastChangeTs = Date.now()\r\n      // 内容发生变化：若处于非领导者或自动保存已停用，立即恢复\r\n      ensureLeaderAndAutoSaveOnChange()\r\n    }\r\n  }, 2 * 1000)\r\n}\r\n\r\nfunction stopChangeMonitor () {\r\n  changeMonitorTimer && clearInterval(changeMonitorTimer)\r\n  changeMonitorTimer = null\r\n}\r\n\r\n// 当检测到内容变更且提示“可能在其他页面编辑”时，立即设为领导者并恢复自动保存\r\nfunction ensureLeaderAndAutoSaveOnChange () {\r\n  try {\r\n    if (!isEditing.value) return\r\n    if (isLockedByOther.value) return\r\n    const needRecover = (!autoSaveEnabled.value || !isLeader())\r\n    if (needRecover) {\r\n      becomeLeader()\r\n      autoSaveEnabled.value = true\r\n      updateAutoSaveTimer()\r\n    } else {\r\n      // 已是领导者且自动保存开启，也确保心跳与定时器正常\r\n      updateAutoSaveTimer()\r\n    }\r\n  } catch (e) {\r\n    // console.warn('ensureLeaderAndAutoSaveOnChange error', e)\r\n  }\r\n}\r\n\r\nfunction startInactivityWatcher () {\r\n  stopInactivityWatcher()\r\n  inactivityTimer = setInterval(() => {\r\n    if (isEditing.value && autoSaveEnabled.value) {\r\n      const idle = Date.now() - lastChangeTs\r\n      if (idle >= INACTIVITY_MS) {\r\n        autoSaveEnabled.value = false\r\n        message.warning(t('msg_auto_save_paused'))\r\n        updateAutoSaveTimer()\r\n      }\r\n    }\r\n  }, 30 * 1000)\r\n}\r\n\r\nfunction stopInactivityWatcher () {\r\n  inactivityTimer && clearInterval(inactivityTimer)\r\n  inactivityTimer = null\r\n}\r\n\r\n// 编辑锁，根据规范调用后端接口\r\nasync function checkEditLock () {\r\n  try {\r\n    const res = await getDraftKey({ robot_key: robot_key.value, uni_identifier: getUniIdentifier(), user_agent: buildUserAgent() })\r\n    // const res = {\"msg\":\"success\",\"res\":0,\"data\":{\"is_self\":true,\"lock_res\":true,\"lock_ttl\":955,\"remote_addr\":\"171.83.17.34\",\"robot_key\":\"yw5BnxX80G\",\"staff_id\":3432,\"user_agent\":\"Mozilla\\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\\/537.36 (KHTML, like Gecko) Chrome\\/142.0.0.0 Safari\\/537.36\"}}\r\n    const data = res?.data || {}\r\n    // lock_res 表示是否成功获取到编辑锁；is_self 表示是否为自己\r\n    // 若未获取到锁，则视为他人占用\r\n    isLockedByOther.value = !data.lock_res\r\n    lockRemoteAddr.value = data.remote_addr || ''\r\n    lockUserAgent.value = data.user_agent || ''\r\n    loginUserName.value = data.login_user_name || ''\r\n    robotStore.setIsLockedByOther(isLockedByOther.value)\r\n    updateAutoSaveTimer()\r\n  } catch (e) {\r\n    // 接口异常时默认不锁定，避免阻断编辑\r\n    isLockedByOther.value = false\r\n    robotStore.setIsLockedByOther(isLockedByOther.value)\r\n  }\r\n}\r\n\r\nasync function acquireEditLock () {\r\n  try {\r\n    const res = await getDraftKey({ robot_key: robot_key.value, uni_identifier: getUniIdentifier(), user_agent: buildUserAgent() })\r\n    // const res = {\"msg\":\"success\",\"res\":0,\"data\":{\"is_self\":true,\"lock_res\":true,\"lock_ttl\":955,\"remote_addr\":\"171.83.17.34\",\"robot_key\":\"yw5BnxX80G\",\"staff_id\":3432,\"user_agent\":\"Mozilla\\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\\/537.36 (KHTML, like Gecko) Chrome\\/142.0.0.0 Safari\\/537.36\"}}\r\n    const data = res?.data || {}\r\n    if (data.lock_res) {\r\n      isLockedByOther.value = false\r\n      lockRemoteAddr.value = ''\r\n      lockUserAgent.value = ''\r\n      loginUserName.value = ''\r\n      robotStore.setIsLockedByOther(isLockedByOther.value)\r\n      return true\r\n    }\r\n    // 他人占用\r\n    isLockedByOther.value = !data.lock_res\r\n    lockRemoteAddr.value = data.remote_addr || ''\r\n    lockUserAgent.value = data.user_agent || ''\r\n    loginUserName.value = data.login_user_name || ''\r\n    robotStore.setIsLockedByOther(isLockedByOther.value)\r\n    return false\r\n  } catch (e) {\r\n    // 异常时默认允许进入编辑（可根据需要改为严格模式）\r\n    isLockedByOther.value = false\r\n    robotStore.setIsLockedByOther(isLockedByOther.value)\r\n    return true\r\n  }\r\n}\r\n\r\nfunction releaseEditLock () {\r\n  // 规范未提供释放接口，此处占位以便未来对接后端释放\r\n}\r\n\r\nfunction getNode (list) {\r\n  list = list || []\r\n  let nodes = []\r\n  let edges = []\r\n\r\n  list.forEach((item) => {\r\n    // 边数据处理\r\n    if (item.node_type == 0) {\r\n      let edge = JSON.parse(item.node_info_json)\r\n\r\n      if(edge.type == 'custom-edge'){\r\n        edge.pointsList = [];\r\n        edge.type = 'custom-bezier-edge'\r\n      }\r\n\r\n      edges.push(edge)\r\n    } else {\r\n      const type = nodeTypes[item.node_type]\r\n\r\n      item.type = type\r\n\r\n      // 节点数据处理\r\n      let node = JSON.parse(item.node_info_json)\r\n\r\n      if (item.node_type != 0) {\r\n        node.type = nodeTypes[item.node_type]\r\n        node.id = item.node_key || generateUniqueId(node.type)\r\n        node.x = node.x || 0\r\n        node.y = node.y || 0\r\n      }\r\n\r\n      if (item.node_type == -1) {\r\n        item.node_params = node.dataRaw\r\n      }\r\n\r\n      if (!node.nodeSortKey) {\r\n        item.nodeSortKey = node.id.substring(0, 8) + node.id.substring(node.id.length - 8)\r\n      } else {\r\n        item.nodeSortKey = node.nodeSortKey\r\n      }\r\n\r\n      item.dataRaw = node.dataRaw || item.node_params\r\n\r\n      // 删除不要的参数\r\n      delete item.node_info_json\r\n\r\n      node.loop_parent_key = item.loop_parent_key // 父节点id\r\n\r\n      // 设置 properties\r\n      node.properties = item\r\n      node.properties.width = node.width\r\n      node.properties.height = node.height\r\n      nodes.push(node)\r\n    }\r\n  })\r\n\r\n  setWorkflowData({ nodes: nodes, edges: edges })\r\n}\r\n\r\nconst toAddRobot = (val) => {\r\n  // router.push({ name: 'addRobot' })\r\n  addRobotAlertRef.value.open(val, true)\r\n}\r\n\r\nconst setWorkflowData = (data) => {\r\n  workflowCanvasRef.value.setData(data)\r\n}\r\n\r\nconst getCanvasData = () => {\r\n  let data = workflowCanvasRef.value.getData()\r\n\r\n  let list = []\r\n  let edgeMap = {}\r\n  // 先处理边数据\r\n  data.edges.forEach((item) => {\r\n    let obj = {\r\n      node_key: item.id,\r\n      node_name: 'edge',\r\n      node_type: 0\r\n    }\r\n\r\n    let node_info_json = {\r\n      ...item\r\n    }\r\n\r\n    obj.node_info_json = node_info_json\r\n\r\n    list.push(obj)\r\n    if (item.sourceAnchorId) {\r\n      edgeMap[item.sourceAnchorId] = item.targetNodeId\r\n    }\r\n\r\n    if (item.targetAnchorId) {\r\n      edgeMap[item.targetAnchorId] = item.sourceNodeId\r\n    }\r\n  })\r\n\r\n  data.nodes.forEach((item) => {\r\n    let obj = {\r\n      ...item.properties,\r\n      node_type: +item.properties.node_type,\r\n      node_key: item.id\r\n    }\r\n\r\n    obj.node_info_json = {\r\n      type: item.type,\r\n      x: item.x,\r\n      y: item.y,\r\n      width: item.properties.width,\r\n      height: item.properties.height,\r\n      id: item.id,\r\n      nodeSortKey: obj.nodeSortKey,\r\n      dataRaw: item.properties.node_params,\r\n    }\r\n\r\n    // 关联next_node_key\r\n    obj.next_node_key = edgeMap[obj.nodeSortKey + '-anchor_right'] || ''\r\n    obj.prev_node_key = edgeMap[obj.nodeSortKey + '-anchor_left'] || ''\r\n\r\n    let node_params = JSON.parse(obj.node_params)\r\n\r\n    // 开始节点\r\n    if (obj.node_type == 1) {\r\n\r\n    }\r\n\r\n    if (obj.node_type == 2) {\r\n      // 判断分支\r\n      if (node_params.term && node_params.term.length > 0) {\r\n        node_params.term.forEach((msg, index) => {\r\n          let key = obj.nodeSortKey + '-anchor_' + index\r\n          msg.next_node_key = edgeMap[key] || ''\r\n        })\r\n      }\r\n    }\r\n\r\n    if (obj.node_type == 3) {\r\n      // 问题分类\r\n      if (node_params.cate && node_params.cate.categorys && node_params.cate.categorys.length > 0) {\r\n        node_params.cate.categorys.forEach((msg, index) => {\r\n          let key = obj.nodeSortKey + '-anchor_' + index\r\n          msg.next_node_key = edgeMap[key] || ''\r\n        })\r\n      }\r\n    }\r\n\r\n    if (obj.node_type == 43) {\r\n      // 问答\r\n      if(node_params.question.answer_type == 'menu'){\r\n        if (node_params.question && node_params.question.reply_content_list && node_params.question.reply_content_list.length > 0) {\r\n          let menu_content = node_params.question.reply_content_list[0].smart_menu?.menu_content || []\r\n          menu_content.forEach((msg, index) => {\r\n            let key = obj.nodeSortKey + '-anchor_' + index\r\n            msg.next_node_key = edgeMap[key] || ''\r\n          })\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    if (obj.node_type == 17) {\r\n      // 代码运行\r\n      let exception = edgeMap[obj.nodeSortKey + '-anchor_right_exception']\r\n      if (exception) {\r\n        node_params.code_run.exception = exception\r\n      }\r\n    }\r\n\r\n    if (obj.node_type == 41) {\r\n      // 工作流\r\n      let exception = edgeMap[obj.nodeSortKey + '-anchor_right_exception']\r\n      if (exception) {\r\n        node_params.workflow.exception = exception\r\n      }\r\n    }\r\n\r\n    obj.node_params = node_params\r\n\r\n    // 删除无用字段\r\n    delete obj.dataRaw\r\n\r\n    list.push(obj)\r\n  })\r\n\r\n  return list\r\n}\r\n\r\nconst handleSave = async (type) => {\r\n  if (isLockedByOther.value) {\r\n    // 手动保存时给出提示，自动保存静默跳过\r\n    if (type === 'handle') {\r\n      message.warning(t('msg_save_locked_by_other'))\r\n    }\r\n    return\r\n  }\r\n  if (!isEditing.value) return\r\n  if (!autoSaveEnabled.value && type === 'automatic') return\r\n  let list = getCanvasData()\r\n\r\n  if (type === 'handle') {\r\n    // 手动保存增强：传入服务端最近草稿时间戳与覆盖标识\r\n    // await robotStore.getRobot(query.id)\r\n    const clientDraftTs = +robotStore.robotInfo.draft_save_time || 0\r\n    const basePayload = {\r\n      robot_key: robot_key.value,\r\n      data_type: 1,\r\n      node_list: JSON.stringify(list),\r\n      draft_save_type: 'handle',\r\n      draft_save_time: clientDraftTs,\r\n      re_cover_save: 0,\r\n      uni_identifier: getUniIdentifier(),\r\n      user_agent: buildUserAgent()\r\n    }\r\n\r\n    const result = await confirmOverrideAndSave(basePayload, false)\r\n  \r\n    if (result.saved) {\r\n      message.success(t('msg_save_success'))\r\n    } else if (!result.behind) {\r\n      // message.error('保存失败，请稍后重试')\r\n    }\r\n    return\r\n  }\r\n\r\n  // 自动保存沿用原逻辑，但在成功后刷新 robotInfo 的草稿时间戳\r\n  try {\r\n    await saveNodes({\r\n      robot_key: robot_key.value,\r\n      data_type: 1,\r\n      node_list: JSON.stringify(list),\r\n      draft_save_type: 'automatic',\r\n      draft_save_time: +robotStore.robotInfo.draft_save_time || 0,\r\n      uni_identifier: getUniIdentifier(),\r\n      user_agent: buildUserAgent()\r\n    })\r\n    await robotStore.getRobot(query.id)\r\n    const ts = +robotStore.robotInfo.draft_save_time || dayjs().unix()\r\n    robotStore.setDrafSaveTime({\r\n      draft_save_type: 'automatic',\r\n      draft_save_time: ts\r\n    })\r\n  } catch (e) {\r\n    // 自动保存失败不提示\r\n  }\r\n}\r\n\r\nlet timer = null\r\nlet autoBehindConfirming = false\r\n// behind 弹窗节流与封装\r\nlet autoBehindPromptShown = false // 本会话内已提示过自动保存覆盖\r\nlet lastAutoBehindPromptTs = 0 // 上次提示时间戳\r\nconst AUTO_PROMPT_COOLDOWN_MS = 2 * 60 * 1000 // 自动保存覆盖弹窗最短提示间隔\r\nconst BEHIND_MODAL_TEXT = computed(() => t('msg_confirm_override_draft'))\r\n\r\nasync function confirmOverrideAndSave (basePayload, isAuto) {\r\n  try {\r\n     const payload = { ...basePayload, uni_identifier: getUniIdentifier(), user_agent: buildUserAgent() }\r\n    const res = await saveNodes(payload)\r\n    const behind = res?.data?.behind_draft == 1 || res?.behind_draft == 1\r\n    if (!behind) {\r\n      // 正常保存成功后刷新服务端草稿时间戳\r\n      await robotStore.getRobot(query.id)\r\n      const ts = +robotStore.robotInfo.draft_save_time || dayjs().unix()\r\n      robotStore.setDrafSaveTime({\r\n        draft_save_type: isAuto ? 'automatic' : 'handle',\r\n        draft_save_time: ts\r\n      })\r\n      return { saved: true, behind: false }\r\n    }\r\n\r\n    // 版本落后：自动保存节流，手动保存每次提示\r\n    if (isAuto) {\r\n      const now = Date.now()\r\n      if (autoBehindConfirming || (autoBehindPromptShown && (now - lastAutoBehindPromptTs < AUTO_PROMPT_COOLDOWN_MS))) {\r\n        // 自动保存在提示后的一段时间内不再弹窗，减轻干扰；暂停自动保存\r\n        autoSaveEnabled.value = false\r\n        updateAutoSaveTimer()\r\n        return { saved: false, behind: true }\r\n      }\r\n      autoBehindConfirming = true\r\n      autoBehindPromptShown = true\r\n      lastAutoBehindPromptTs = now\r\n    }\r\n\r\n    return await new Promise((resolve) => {\r\n      Modal.confirm({\r\n        title: t('title_prompt'),\r\n        icon: null,\r\n        content: BEHIND_MODAL_TEXT.value,\r\n        okText: t('btn_confirm'),\r\n        cancelText: t('btn_cancel'),\r\n        async onOk () {\r\n          const forcePayload = { ...basePayload, re_cover_save: 1, uni_identifier: getUniIdentifier(), user_agent: buildUserAgent() }\r\n          const res2 = await saveNodes(forcePayload)\r\n          if (res2 && res2.res == 0 || !res2?.data?.behind_draft) {\r\n            await robotStore.getRobot(query.id)\r\n            const ts = +robotStore.robotInfo.draft_save_time || dayjs().unix()\r\n            robotStore.setDrafSaveTime({\r\n              draft_save_type: isAuto ? 'automatic' : 'handle',\r\n              draft_save_time: ts\r\n            })\r\n          }\r\n          if (isAuto) {\r\n            autoSaveEnabled.value = true\r\n            updateAutoSaveTimer()\r\n            autoBehindConfirming = false\r\n            autoBehindPromptShown = false // 覆盖后重置，允许未来再次提示\r\n            lastAutoBehindPromptTs = Date.now()\r\n          }\r\n          resolve({ saved: true, behind: true })\r\n        },\r\n        onCancel () {\r\n          if (isAuto) {\r\n            autoSaveEnabled.value = false // 取消后暂停自动保存，避免频繁提示\r\n            updateAutoSaveTimer()\r\n            autoBehindConfirming = false\r\n            // 保留 autoBehindPromptShown=true；在冷却时间后允许再次提醒\r\n            lastAutoBehindPromptTs = Date.now()\r\n          }\r\n          resolve({ saved: false, behind: true })\r\n        }\r\n      })\r\n    })\r\n  } catch (e) {\r\n    // 若后端以异常形式返回 behind_draft，可视作落后处理；否则静默失败\r\n    const behind = e?.data?.behind_draft == 1 || e?.behind_draft == 1\r\n    if (!behind) return { saved: false, behind: false }\r\n    if (isAuto) {\r\n      const now = Date.now()\r\n      if (autoBehindConfirming || (autoBehindPromptShown && (now - lastAutoBehindPromptTs < AUTO_PROMPT_COOLDOWN_MS))) {\r\n        autoSaveEnabled.value = false\r\n        updateAutoSaveTimer()\r\n        return { saved: false, behind: true }\r\n      }\r\n      autoBehindConfirming = true\r\n      autoBehindPromptShown = true\r\n      lastAutoBehindPromptTs = now\r\n    }\r\n    return await new Promise((resolve) => {\r\n      Modal.confirm({\r\n        title: t('title_prompt'),\r\n        icon: null,\r\n        content: BEHIND_MODAL_TEXT.value,\r\n        okText: t('btn_confirm'),\r\n        cancelText: t('btn_cancel'),\r\n        async onOk () {\r\n          const forcePayload = { ...basePayload, re_cover_save: 1, uni_identifier: getUniIdentifier(), user_agent: buildUserAgent() }\r\n          const res2 = await saveNodes(forcePayload)\r\n          if (res2 && res2.res == 0 || !res2?.data?.behind_draft) {\r\n            await robotStore.getRobot(query.id)\r\n            const ts = +robotStore.robotInfo.draft_save_time || dayjs().unix()\r\n            robotStore.setDrafSaveTime({\r\n              draft_save_type: isAuto ? 'automatic' : 'handle',\r\n              draft_save_time: ts\r\n            })\r\n          }\r\n          if (isAuto) {\r\n            autoSaveEnabled.value = true\r\n            updateAutoSaveTimer()\r\n            autoBehindConfirming = false\r\n            autoBehindPromptShown = false\r\n            lastAutoBehindPromptTs = Date.now()\r\n          }\r\n          resolve({ saved: true, behind: true })\r\n        },\r\n        onCancel () {\r\n          if (isAuto) {\r\n            autoSaveEnabled.value = false\r\n            updateAutoSaveTimer()\r\n            autoBehindConfirming = false\r\n            lastAutoBehindPromptTs = Date.now()\r\n          }\r\n          resolve({ saved: false, behind: true })\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\n// 自动保存（含版本落后弹窗确认）\r\nasync function handleAutoSaveWithConflictCheck () {\r\n  if (isLockedByOther.value) return\r\n  if (!isEditing.value) return\r\n  if (!autoSaveEnabled.value) return\r\n\r\n  const list = getCanvasData()\r\n  const clientDraftTs = +robotStore.robotInfo.draft_save_time || 0\r\n  const basePayload = {\r\n    robot_key: robot_key.value,\r\n    data_type: 1,\r\n    node_list: JSON.stringify(list),\r\n    draft_save_type: 'automatic',\r\n    draft_save_time: clientDraftTs,\r\n    re_cover_save: 0,\r\n    uni_identifier: getUniIdentifier()\r\n  }\r\n  await confirmOverrideAndSave(basePayload, true)\r\n}\r\nfunction updateAutoSaveTimer () {\r\n  timer && clearInterval(timer)\r\n  timer = null\r\n  // 同步领导者状态以便 UI 及时展示\r\n  isLeaderFlag.value = isLeader()\r\n  if (import.meta.env.PROD && isEditing.value && autoSaveEnabled.value && !isLockedByOther.value && isLeader()) {\r\n    timer = setInterval(() => {\r\n      handleAutoSaveWithConflictCheck()\r\n    }, 1 * 60 * 1000)\r\n  }\r\n}\r\n\r\nonUnmounted(() => {\r\n  timer && clearInterval(timer)\r\n  stopInactivityWatcher()\r\n  stopChangeMonitor()\r\n  stopLeaderHeartbeat()\r\n  releaseEditLock()\r\n  releaseLeader()\r\n  decrementOpenTabs()\r\n})\r\n\r\n\r\nconst versionModelRef = ref(null)\r\n\r\nconst saveLoading = ref(false)\r\n\r\nconst openVersionModel = (node_list) => {\r\n  versionModelRef.value.show(node_list)\r\n}\r\n// 发布机器人\r\nconst handleRelease = async () => {\r\n  if (isLockedByOther.value) {\r\n    message.warning(t('msg_publish_locked_by_other'))\r\n    return\r\n  }\r\n  let list = getCanvasData()\r\n\r\n  let errorNodes = []\r\n  for (let i = 0; i < list.length; i++) {\r\n    let node = list[i]\r\n    // 跳过边节点\r\n    if (node.node_type == 0 || node.node_type == -1 || node.node_type == 43) {\r\n      // 跳过\r\n      continue\r\n    }\r\n    if(!node.loop_parent_key){\r\n      // 分组里面的不用校验\r\n      if (node.node_type == 1) {\r\n        if (node.next_node_key == '') {\r\n          errorNodes.push(node)\r\n        }\r\n      } else if (node.node_type == 7 || node.node_type == 3) {\r\n        if (node.prev_node_key == '') {\r\n          errorNodes.push(node)\r\n        }\r\n      } else {\r\n        if (node.next_node_key == '' || node.prev_node_key == '') {\r\n          errorNodes.push(node)\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  if (errorNodes.length > 0) {\r\n    // message.error(t('msg_unconnected_nodes'))\r\n    // return\r\n  }\r\n\r\n  // 先保存草稿，再发布\r\n  // saveLoading.value = true;\r\n  try {\r\n    // message.loading('保存中...')\r\n    await saveNodes({\r\n      robot_key: robot_key.value,\r\n      data_type: 1,\r\n      node_list: JSON.stringify(list),\r\n      draft_save_type: 'handle',\r\n      draft_save_time: +robotStore.robotInfo.draft_save_time || 0,\r\n      uni_identifier: getUniIdentifier(),\r\n      user_agent: buildUserAgent()\r\n    })\r\n    // 保存后刷新服务端草稿时间戳\r\n    await robotStore.getRobot(query.id)\r\n    robotStore.setDrafSaveTime({\r\n      draft_save_type: 'handle',\r\n      draft_save_time: +robotStore.robotInfo.draft_save_time || 0\r\n    })\r\n    openVersionModel(JSON.stringify(list))\r\n    // const res = await saveNodes({\r\n    //   robot_key: robot_key.value,\r\n    //   data_type: 2,\r\n    //   node_list: JSON.stringify(list)\r\n    // })\r\n    // setTimeout(()=>{\r\n    //   message.destroy()\r\n    //   saveLoading.value = false;\r\n    //   if (res && res.res == 0) {\r\n    //     message.success('发布成功')\r\n    //   }\r\n    // },400)\r\n  } catch (e) {\r\n    saveLoading.value = false;\r\n    // message.success('发布失败，请重试')\r\n  }\r\n}\r\n\r\n// 选择节点\r\nlet selectedNode = ref(null)\r\nconst handleSelectedNode = (data) => {\r\n  selectedNode.value = data\r\n  // 结束节点不支持编辑\r\n  if (data.properties.node_sub_type == 51) {\r\n    return\r\n  }\r\n\r\n  // 内容发生变更（节点选择通常伴随编辑行为），尝试恢复自动保存并设置为领导者\r\n  ensureLeaderAndAutoSaveOnChange()\r\n\r\n}\r\n\r\n// 删除节点\r\nconst onDeleteNode = () => {\r\n  // 删除节点属于内容变更，立即恢复自动保存并设置为领导者\r\n  ensureLeaderAndAutoSaveOnChange()\r\n}\r\n\r\nconst getModelList = async () => {\r\n  return getModelConfigOption({\r\n    model_type: 'LLM'\r\n  }).then((res) => {\r\n    let list = res.data || []\r\n    let { newList  } = getModelOptionsList(list)\r\n    robotStore.setModelList(newList)\r\n  })\r\n}\r\n\r\nconst start_node_params = ref({\r\n  diy_global: [],\r\n  sys_global: [],\r\n})\r\nconst getGlobal = () => {\r\n  let list = getCanvasData()\r\n  let start_node = list.filter(item => item.node_type == 1)\r\n  if (start_node.length > 0) {\r\n    start_node_params.value = start_node[0].node_params.start\r\n  }\r\n}\r\n\r\nconst publishDetailRef = ref(null)\r\nconst getVersionRecord = () => {\r\n  // 历史记录打开时，禁止自动保存\r\n  autoSaveEnabled.value = false\r\n  updateAutoSaveTimer()\r\n  publishDetailRef.value.showDrawer()\r\n}\r\n\r\nconst setVersion = (data) => {\r\n  if (isLockedByOther.value) {\r\n    message.warning(t('msg_restore_locked_by_other'))\r\n    return\r\n  }\r\n  // 版本恢复前，先保存当前草稿一次\r\n  const currentDraft = getCanvasData()\r\n  saveNodes({\r\n    robot_key: robot_key.value,\r\n    data_type: 1,\r\n    node_list: JSON.stringify(currentDraft),\r\n    draft_save_type: 'handle',\r\n    draft_save_time: +robotStore.robotInfo.draft_save_time || 0,\r\n    uni_identifier: getUniIdentifier(),\r\n    user_agent: buildUserAgent()\r\n  }).then(() => {\r\n    // 刷新草稿时间戳\r\n    robotStore.getRobot(query.id).then(() => {\r\n      robotStore.setDrafSaveTime({\r\n        draft_save_type: 'handle',\r\n        draft_save_time: +robotStore.robotInfo.draft_save_time || 0\r\n      })\r\n    })\r\n    // 设置为当前的版本（切换到恢复的版本数据）\r\n    currentVersion.value = ''\r\n    currentVersionData.value = null\r\n    getNode(data)\r\n    message.success(t('msg_draft_saved_and_restored'))\r\n    // 恢复后重新启用自动保存（回到编辑态）\r\n    isEditing.value = true\r\n    autoSaveEnabled.value = true\r\n    updateAutoSaveTimer()\r\n  })\r\n}\r\n\r\nconst handlePreviewVersion = async (data, version) => {\r\n  // 在发布详情中切换/预览前，先保存当前草稿，避免丢失\r\n  if (!isLockedByOther.value) {\r\n    const currentDraft = getCanvasData()\r\n    try {\r\n      await saveNodes({\r\n        robot_key: robot_key.value,\r\n        data_type: 1,\r\n        node_list: JSON.stringify(currentDraft),\r\n        draft_save_type: 'automatic',\r\n        draft_save_time: +robotStore.robotInfo.draft_save_time || 0,\r\n        uni_identifier: getUniIdentifier(),\r\n        user_agent: buildUserAgent()\r\n      })\r\n      // 更新本地草稿时间，保持发布详情“最近保存于”显示\r\n      await robotStore.getRobot(query.id)\r\n      robotStore.setDrafSaveTime({\r\n        draft_save_type: 'automatic',\r\n        draft_save_time: +robotStore.robotInfo.draft_save_time || 0\r\n      })\r\n    } catch (e) {\r\n      // 失败不阻断切换，但建议后端容错\r\n    }\r\n  }\r\n  // currentVersion.value = version.version_id || ''\r\n  currentVersionData.value = version\r\n  clearInterval(timer)\r\n  getNode(data)\r\n}\r\n// 运行测试\r\nconst handleRunTest = async () => {\r\n  if (isLockedByOther.value) {\r\n    message.warning(t('msg_save_locked_by_other'))\r\n    return\r\n  }\r\n  if (!isEditing.value) return\r\n\r\n  let list = getCanvasData()\r\n\r\n  await saveNodes({\r\n    robot_key: robot_key.value,\r\n    data_type: 1,\r\n    node_list: JSON.stringify(list),\r\n    draft_save_type: 'automatic',\r\n    draft_save_time: +robotStore.robotInfo.draft_save_time || 0,\r\n    uni_identifier: getUniIdentifier(),\r\n    user_agent: buildUserAgent()\r\n  })\r\n  await robotStore.getRobot(query.id)\r\n  workFlowNextVersion({\r\n    robot_key: robot_key.value,\r\n  }).then(res => {\r\n    pageHeaderRef.value.openRunTest()\r\n  }).catch((res) => {\r\n    if(res.data && res.data.err_node_key){\r\n      handleOpenErrorNode(res.data.err_node_key)\r\n    }\r\n  })\r\n\r\n}\r\n\r\n// 头部“编辑”按钮\r\nconst handleClickEdit = async () => {\r\n  if (isLockedByOther.value) {\r\n    message.warning(t('msg_edit_locked_by_other'))\r\n    return\r\n  }\r\n  const ok = await acquireEditLock()\r\n  if (ok) {\r\n    isEditing.value = true\r\n    autoSaveEnabled.value = true\r\n    // 重新记录快照并启动无改动监控\r\n    lastChangeHash = computeCanvasHash()\r\n    lastChangeTs = Date.now()\r\n    startChangeMonitor()\r\n    updateAutoSaveTimer()\r\n    message.success(t('msg_enter_edit_mode'))\r\n    toAddRobot(1)\r\n  }\r\n}\r\n\r\nconst checkNodePluginStatus = (nds) => {\r\n  nds = Array.isArray(nds) ? nds : []\r\n  let closeNds = []\r\n  let updateNds = []\r\n  nds.forEach(nd => {\r\n    if (nd.node_type == 21) {\r\n      if (nd.has_loaded === \"\" || nd.plugin_version !== nd.remote_plugin_version) {\r\n        updateNds.push(nd)\r\n      } else if (nd.has_loaded === \"false\") {\r\n        closeNds.push(nd)\r\n      }\r\n    }\r\n  })\r\n  if (closeNds.length || updateNds.length) {\r\n    let names = [...new Set([...closeNds.map(i => i.node_name), ...updateNds.map(i => i.node_name)])]\r\n    const titleStyle = {\r\n      'font-weight': 500,\r\n      'margin-top': '8px',\r\n      'margin-bottom': '4px',\r\n    }\r\n    const nameStyle = {'color': '#8c8c8c'}\r\n    Modal.confirm({\r\n      title: t('title_workflow_fix'),\r\n      content: h('div', {}, [\r\n        h('div', {style: titleStyle}, t('msg_plugin_abnormal_prompt')),\r\n        h('div', {style: nameStyle}, names.join('、'))\r\n      ]),\r\n      onOk: async () => {\r\n        const tasks = []\r\n        if (closeNds.length) tasks.push(openPlugin({name: closeNds.map(i => i.plugin_name).toString()}))\r\n        if (updateNds.length) {\r\n          tasks.push(downloadPlugin({\r\n            download_data: JSON.stringify(updateNds.map(i => ({\r\n              url: i.latest_version_detail_url,\r\n              version_id: i.latest_version_detail_id\r\n            })))\r\n          }))\r\n        }\r\n        await Promise.all(tasks)\r\n        message.success(t('msg_operation_reload'))\r\n        setTimeout(() => {\r\n          window.location.reload()\r\n        }, 1200)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nconst init = async () => {\r\n  await getModelList()\r\n  await workflowStore.getTriggerList(robot_key.value);\r\n  workflowStore.getTriggerOfficialMsg(robot_key.value)\r\n  await modelStore.getAllmodelList()\r\n  workflowStore.getAllLibraryList();\r\n\r\n  const res = await getNodeList({\r\n    robot_key: robot_key.value,\r\n    data_type: 1\r\n  })\r\n\r\n  getNode(res.data)\r\n  checkNodePluginStatus(res.data)\r\n}\r\n\r\nconst handleAutoSaveDraft = async (type = 'automatic') => {\r\n  await handleSave(type)\r\n}\r\n\r\nprovide('handleAutoSaveDraft', handleAutoSaveDraft)\r\n\r\nconst handleOpenErrorNode = (data) => {\r\n  workflowCanvasRef.value.focusOnNode(data)\r\n}\r\n\r\nonMounted(async () => {\r\n  // 记录当前工作流的打开页面计数\r\n  incrementOpenTabs()\r\n\r\n  await init()\r\n\r\n  // 初次进入：若存在草稿记录则默认查看模式，需要点击编辑按钮进入编辑\r\n  await checkEditLock()\r\n  if (isLockedByOther.value) {\r\n    isEditing.value = false\r\n    autoSaveEnabled.value = false\r\n    message.warning(t('msg_switched_to_view_mode'))\r\n  } else {\r\n    // 无他人占用，直接进入编辑模式（无需手动点击编辑）\r\n    const ok = await acquireEditLock()\r\n    if (ok) {\r\n      isEditing.value = true\r\n      autoSaveEnabled.value = true\r\n    } else {\r\n      isEditing.value = false\r\n      autoSaveEnabled.value = false\r\n    }\r\n  }\r\n  // 启动领导者协调与心跳，仅允许一个标签页自动保存\r\n  startLeaderHeartbeat()\r\n  updateAutoSaveTimer()\r\n\r\n  // 监听路由中 robot_key 变化，切换工作流时释放旧领导者并重启心跳\r\n  let currentLeaderKey = getLeaderKey()\r\n  watch(() => route.query.robot_key, (newKey) => {\r\n    if (!newKey || newKey === robot_key.value) return\r\n    // 释放旧工作流的领导者占用（仅当本标签页是旧键的领导者时）\r\n    releaseSpecificLeader(currentLeaderKey)\r\n    // 更新旧工作流的打开页面计数\r\n    decrementOpenTabs()\r\n    // 切换到新的工作流键\r\n    robot_key.value = newKey\r\n    currentLeaderKey = getLeaderKey()\r\n    // 新工作流计数+1\r\n    incrementOpenTabs()\r\n    // 重新争取领导者并重启自动保存评估\r\n    startLeaderHeartbeat()\r\n    updateAutoSaveTimer()\r\n  })\r\n\r\n  // 活动监听与5分钟无操作停止\r\n  startInactivityWatcher()\r\n  startChangeMonitor()\r\n  if (route.query.show_tips) {\r\n    message.info(t('msg_canvas_scroll_tips'), 6)\r\n  }\r\n})\r\n\r\n</script>\r\n"],"names":["getTriggerConfigList","params","request","getTriggerOfficialMessage","useWorkflowStore","defineStore","triggerList","ref","officialList","triggerOfficialList","libraryLists","robot_key","isRefresh","res","item","error","getLibraryList","t","useI18n","globalStore","useGlobalStore","router","useRouter","route","useRoute","activeMenuKey","computed","sidebarHide","handleTooltipShow","onHandleClick","menus","onMenuClick","onMounted","_createElementBlock","_normalizeClass","__props","_openBlock","_hoisted_1","_createVNode","_component_a_tooltip","$event","_unref","_createElementVNode","_hoisted_2","_hoisted_3","_Fragment","_renderList","_createBlock","CuTooltip","_component_svg_icon","_hoisted_5","_toDisplayString","_sfc_main","newValue","inputText","numberPart","validValue","$data","$options","args","_withDirectives","$setup","emit","__emit","workflowStore","keyword","list","handleAddNode","node","createTriggerNode","handleSubClick","sub","_component_a_input_search","_hoisted_4","_hoisted_6","_hoisted_7","_hoisted_8","DownOutlined","RightOutlined","_hoisted_9","_withModifiers","_hoisted_10","_hoisted_11","_imports_0","_hoisted_12","_createTextVNode","loadData","getRobotList","_list","i","showList","createWorkflowNode","props","getHttpTools","arr","_a","kw","info","n","url","_b","tool","curl","newNode","addHttpToolNode","handleOpenAddHttp","formatMethod","m","cleanupUrl","j","_component_a_popover","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_d","_c","_f","_e","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","p","_h","_g","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","h","_j","_i","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","o","_hoisted_35","_vShow","_hoisted_36","isPublicNetwork","usePublicNetworkCheck","tabActive","mcpHttpTab","watch","newVal","allGroupNodes","allPluginNodes","allMcpNodes","mcpKeyword","getAllGroupNodes","getAllMcpNodes","getAllPluginNodes","showMcpNodes","handleMouseDownOnNode","event","isDragged","startX","startY","nodeData","ghost","moveGhost","e","onMouseMove","onMouseUp","addMcpNode","mcp","getMcpNode","handleAddTrigger","handleAddWorkflow","addPluginNode","action","name","getPluginActionNode","tabChange","key","handleOpenAddMcp","isActionsPlugin","node_params","jsonDecode","pluginHasAction","handleAddHttpToolNode","group","field","_hoisted_37","HttpToolList","_hoisted_38","_hoisted_39","_hoisted_40","getPluginActions","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_50","_hoisted_51","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_70","_hoisted_72","_hoisted_73","_hoisted_42","_hoisted_44","_hoisted_45","_hoisted_74","_hoisted_75","_hoisted_76","PublicNetworkCheck","_hoisted_77","TriggerList","_hoisted_78","WorkflowList","excludedNodeTypes","eventCenter","zoom","handleFitView","setZoom","value","chagneZoom","handleReduce","handleAmplify","onGraphTransform","isShowMenu","nodeListRef","nodeListTabActive","handleShowNodeList","handleRunTest","handleAutoLayout","documentClick","handleMouseMove","showTriggerLit","onBeforeUnmount","ZoomSelect","_component_a_button","PlusOutlined","CaretRightOutlined","PartitionOutlined","NodeListPopup","_renderSlot","_ctx","changeTitle","inject","deleteNode","close","chagneTimer","getImggeUrl","__vite_glob_0_0","__vite_glob_0_1","__vite_glob_0_2","__vite_glob_0_3","__vite_glob_0_4","__vite_glob_0_5","__vite_glob_0_6","__vite_glob_0_7","__vite_glob_0_8","__vite_glob_0_9","__vite_glob_0_10","__vite_glob_0_11","__vite_glob_0_12","__vite_glob_0_13","__vite_glob_0_14","__vite_glob_0_15","__vite_glob_0_16","__vite_glob_0_17","__vite_glob_0_18","__vite_glob_0_19","__vite_glob_0_20","__vite_glob_0_21","__vite_glob_0_22","__vite_glob_0_23","__vite_glob_0_24","__vite_glob_0_25","__vite_glob_0_26","__vite_glob_0_27","__vite_glob_0_28","__vite_glob_0_29","__vite_glob_0_30","__vite_glob_0_31","__vite_glob_0_32","__vite_glob_0_33","__vite_glob_0_34","__vite_glob_0_35","__vite_glob_0_36","__vite_glob_0_37","__vite_glob_0_38","__vite_glob_0_39","__vite_glob_0_40","__vite_glob_0_41","__vite_glob_0_42","__vite_glob_0_43","__vite_glob_0_44","__vite_glob_0_45","__vite_glob_0_46","__vite_glob_0_47","__vite_glob_0_48","__vite_glob_0_49","__vite_glob_0_50","__vite_glob_0_51","__vite_glob_0_52","__vite_glob_0_53","__vite_glob_0_54","__vite_glob_0_55","__vite_glob_0_56","__vite_glob_0_57","__vite_glob_0_58","__vite_glob_0_59","__vite_glob_0_60","__vite_glob_0_61","__vite_glob_0_62","__vite_glob_0_63","__vite_glob_0_64","__vite_glob_0_65","__vite_glob_0_66","__vite_glob_0_67","__vite_glob_0_68","__vite_glob_0_69","__vite_glob_0_70","__vite_glob_0_71","__vite_glob_0_72","__vite_glob_0_73","__vite_glob_0_74","__vite_glob_0_75","__vite_glob_0_76","__vite_glob_0_77","__vite_glob_0_78","__vite_glob_0_79","__vite_glob_0_80","__vite_glob_0_81","__vite_glob_0_82","__vite_glob_0_83","__vite_glob_0_84","__vite_glob_0_85","__vite_glob_0_86","__vite_glob_0_87","__vite_glob_0_88","__vite_glob_0_89","__vite_glob_0_90","__vite_glob_0_91","__vite_glob_0_92","__vite_glob_0_93","__vite_glob_0_94","__vite_glob_0_95","__vite_glob_0_96","__vite_glob_0_97","__vite_glob_0_98","__vite_glob_0_99","__vite_glob_0_100","__vite_glob_0_101","__vite_glob_0_102","__vite_glob_0_103","__vite_glob_0_104","__vite_glob_0_105","__vite_glob_0_106","__vite_glob_0_107","__vite_glob_0_108","__vite_glob_0_109","__vite_glob_0_110","__vite_glob_0_111","__vite_glob_0_112","__vite_glob_0_113","__vite_glob_0_114","__vite_glob_0_115","__vite_glob_0_116","__vite_glob_0_117","__vite_glob_0_118","__vite_glob_0_119","__vite_glob_0_120","__vite_glob_0_121","__vite_glob_0_122","__vite_glob_0_123","__vite_glob_0_124","__vite_glob_0_125","__vite_glob_0_126","__vite_glob_0_127","__vite_glob_0_128","__vite_glob_0_129","__vite_glob_0_130","__vite_glob_0_131","__vite_glob_0_132","__vite_glob_0_133","__vite_glob_0_134","__vite_glob_0_135","__vite_glob_0_136","__vite_glob_0_137","__vite_glob_0_138","__vite_glob_0_139","__vite_glob_0_140","__vite_glob_0_141","__vite_glob_0_142","__vite_glob_0_143","__vite_glob_0_144","__vite_glob_0_145","__vite_glob_0_146","__vite_glob_0_147","__vite_glob_0_148","__vite_glob_0_149","__vite_glob_0_150","__vite_glob_0_151","__vite_glob_0_152","__vite_glob_0_153","__vite_glob_0_154","__vite_glob_0_155","__vite_glob_0_156","__vite_glob_0_157","__vite_glob_0_158","__vite_glob_0_159","__vite_glob_0_160","__vite_glob_0_161","__vite_glob_0_162","__vite_glob_0_163","__vite_glob_0_164","__vite_glob_0_165","__vite_glob_0_166","__vite_glob_0_167","__vite_glob_0_168","__vite_glob_0_169","__vite_glob_0_170","__vite_glob_0_171","__vite_glob_0_172","__vite_glob_0_173","__vite_glob_0_174","__vite_glob_0_175","__vite_glob_0_176","__vite_glob_0_177","__vite_glob_0_178","__vite_glob_0_179","__vite_glob_0_180","__vite_glob_0_181","__vite_glob_0_182","__vite_glob_0_183","__vite_glob_0_184","__vite_glob_0_185","__vite_glob_0_186","__vite_glob_0_187","__vite_glob_0_188","__vite_glob_0_189","__vite_glob_0_190","__vite_glob_0_191","__vite_glob_0_192","__vite_glob_0_193","__vite_glob_0_194","__vite_glob_0_195","__vite_glob_0_196","__vite_glob_0_197","__vite_glob_0_198","__vite_glob_0_199","__vite_glob_0_200","__vite_glob_0_201","__vite_glob_0_202","__vite_glob_0_203","__vite_glob_0_204","__vite_glob_0_205","__vite_glob_0_206","__vite_glob_0_207","__vite_glob_0_208","__vite_glob_0_209","__vite_glob_0_210","__vite_glob_0_211","__vite_glob_0_212","__vite_glob_0_213","__vite_glob_0_214","__vite_glob_0_215","__vite_glob_0_216","__vite_glob_0_217","__vite_glob_0_218","__vite_glob_0_219","__vite_glob_0_220","__vite_glob_0_221","__vite_glob_0_222","__vite_glob_0_223","__vite_glob_0_224","__vite_glob_0_225","__vite_glob_0_226","__vite_glob_0_227","__vite_glob_0_228","__vite_glob_0_229","__vite_glob_0_230","__vite_glob_0_231","__vite_glob_0_232","__vite_glob_0_233","__vite_glob_0_234","__vite_glob_0_235","__vite_glob_0_236","__vite_glob_0_237","__vite_glob_0_238","__vite_glob_0_239","__vite_glob_0_240","__vite_glob_0_241","__vite_glob_0_242","__vite_glob_0_243","__vite_glob_0_244","__vite_glob_0_245","__vite_glob_0_246","__vite_glob_0_247","__vite_glob_0_248","__vite_glob_0_249","__vite_glob_0_250","__vite_glob_0_251","__vite_glob_0_252","__vite_glob_0_253","__vite_glob_0_254","__vite_glob_0_255","__vite_glob_0_256","__vite_glob_0_257","__vite_glob_0_258","__vite_glob_0_259","__vite_glob_0_260","__vite_glob_0_261","__vite_glob_0_262","__vite_glob_0_263","__vite_glob_0_264","__vite_glob_0_265","__vite_glob_0_266","__vite_glob_0_267","__vite_glob_0_268","__vite_glob_0_269","__vite_glob_0_270","__vite_glob_0_271","__vite_glob_0_272","__vite_glob_0_273","__vite_glob_0_274","__vite_glob_0_275","__vite_glob_0_276","__vite_glob_0_277","__vite_glob_0_278","__vite_glob_0_279","__vite_glob_0_280","__vite_glob_0_281","__vite_glob_0_282","__vite_glob_0_283","__vite_glob_0_284","__vite_glob_0_285","__vite_glob_0_286","__vite_glob_0_287","__vite_glob_0_288","__vite_glob_0_289","__vite_glob_0_290","__vite_glob_0_291","__vite_glob_0_292","__vite_glob_0_293","__vite_glob_0_294","__vite_glob_0_295","__vite_glob_0_296","__vite_glob_0_297","__vite_glob_0_298","__vite_glob_0_299","__vite_glob_0_300","__vite_glob_0_301","__vite_glob_0_302","__vite_glob_0_303","__vite_glob_0_304","__vite_glob_0_305","__vite_glob_0_306","__vite_glob_0_307","__vite_glob_0_308","__vite_glob_0_309","__vite_glob_0_310","__vite_glob_0_311","__vite_glob_0_312","__vite_glob_0_313","__vite_glob_0_314","__vite_glob_0_315","__vite_glob_0_316","__vite_glob_0_317","__vite_glob_0_318","__vite_glob_0_319","__vite_glob_0_320","__vite_glob_0_321","__vite_glob_0_322","__vite_glob_0_323","__vite_glob_0_324","__vite_glob_0_325","__vite_glob_0_326","__vite_glob_0_327","__vite_glob_0_328","__vite_glob_0_329","__vite_glob_0_330","__vite_glob_0_331","__vite_glob_0_332","nodeIconUrl","localTitle","handleTitleChange","handleDeleteNode","handleClose","_component_a_input","_component_a_dropdown","_component_a_menu","_component_a_menu_item","CloseOutlined","_imports_0$b","typOptions","NodeFormLayout","NodeFormHeader","QuestionCircleOutlined","formRules","data","variables","output","index","triggerVariableMap","message","_component_NodeFormLayout","_component_NodeFormHeader","$props","_component_PlusOutlined","_component_QuestionCircleOutlined","_component_a_modal","_component_a_form","_component_a_form_item","_cache","_component_a_select","_component_a_select_option","_component_a_switch","_component_a_textarea","val","path","valuePath","find","options","level","itemValue","values","currentOptions","found","levelIndex","panelEl","rect","viewportWidth","estimatedNextPanelWidth","getTreeOptions","result","opt","CascadePanel","htmlStr","div","text","textContent","jMention","selectedListMap","mySelectedList","JMention","html","defaultSelectedList","treeOptions","selectedList","replacedValues","regex","len","selection","range","startOffset","startContainer","textBeforeCursor","childNodes","lastAtIndex","dropdownListRect","viewportHeight","top","left","width","height","nodeList","lastChar","isExistStartWith","dataSet","prevCharOffset","prevCharNode","prevSibling","span","newRange","selectedValuePath","selectedPath","isInit","direction","leftMatch","topMatch","currentLeft","currentTop","newLeft","_Teleport","_component_CascadePanel","robotStore","useRobotStore","atInputRef","modelList","variableOptions","variableOptionsSelect","showMoreBtn","hanldeShowMore","changeValue","formState","getOptions","nodeModel","handleOptions","getVlaueVariableList","formatQuestionValue","lists","str1","str2","formRef","reactive","handleModelChange","update","dataRaw","oldData","init","question_optimize","model_config_id","use_model","context_pair","temperature","max_token","prompt","prompt_tags","question_value","enable_thinking","role","importPromptRef","handleSavePrompt","nextTick","onDropdownVisibleChange","visible","choosable_thinking","onVectorModelLoaded","choosable_thinking_map","show_enable_thinking","ModelSelect","UpOutlined","_component_a_radio_group","_component_a_radio","_component_a_form_item_rest","_component_a_slider","_component_a_input_number","AtInput","_withCtx","label","payload","_component_a_cascader","labels","ImportPrompt","open","computedPlaceholder","show","showAtList","handleOk","__expose","getNode","knowledgeQuoteOptions","onShowAddPromptModal","fullAtInputRef","handleOpenFullAtModal","handleRefreshAtInput","llm","libs_node_key","_component_a_flex","DownloadOutlined","FullscreenOutlined","_component_ImportPrompt","FullAtInput","_imports_0$a","useDataTableStore","resolve","getFormList","form_id","getFormFieldList","dataTableStore","state","columns","dataSource","onSelectChange","selectedRowKeys","selectedRows","formId","getList","openAddLibrary","loading","_component_a_table","atInputOptions","getAtInputOptions","changeAtInputValue","change","onChangeSelect","handleDel","fieldSelectAlertRef","handleAddField","FieldSelectAlert","loaclValue","saveCheckedList","triggerChange","tableSelectAlertRef","selectedRow","handleSelectData","onSelectOk","record","handleClear","TableSelectAlert","onSelectTable","getFieldList","onChangeFields","toRaw","getTableList","DataTableSelect","FieldListSelect","robotInfo","group_id","groupLists","getGroupList","getLibraryListGroup","totalNumber","handleChangeGroup","checkedList","searchKeyword","onSearch","showOptions","handleChangeChecked","onRefresh","SearchOutlined","_component_cu_scroll","_component_a_alert","SyncOutlined","_component_a_spin","_component_a_checkbox","retrievalModeList","metaList","handleSelectRetrievalMode","checkRerank","handleSave","WeightSelect","MetaFilterBox","rrf_weight","wxAppLibary","libs","getSpecifyAbilityConfig","_data","libraryList","librarySelectAlertRef","selectedLibraryRows","handleDelKonwledge","onChangeLibrarySelected","handleOpenSelectLibraryAlert","recallSettingsAlertRef","handleOpenRecallSettingsAlert","onChangeRecallSettings","CloseCircleOutlined","SettingOutlined","LibrarySelectAlert","RecallSettingsAlert","filterTypOptions","widthPx","onAddSubs","onDelOutput","onTypeChange","showAddBtn","op","PlusCircleOutlined","_component_SubsKey","code","cmOptions","cmRef","onChange","handleRefresh","onReady","onInput","Codemirror","is_in_loop_node","matchAngleBrackets","str","match","foundFieldTyp","filterItem","type","local_test_params","handleOpenTestModal","resultStr","localFormData","typ","setGlobalDefaultVal","filetrLocalData","it","handleDelItem","handleAddItem","isErrorStatus","errorMsg","handleSubmit","postData","test_params_data","isJson","testCodeRun","trimmedStr","parsed","handleCopy","copyText","isInLoopNode","recognizeOpen","showJsonError","editIndex","jsonData","handleOpenRecognizeModal","handleSaveValue","newData","_component_a_tag","ImportOutlined","input","CopyOutlined","VueJsonPretty","defaultCode","pythonCode","getDefaultCode","handleChangeLanguage","resetTemp","Modal","recursionData","formatParams","code_run","specialKey","specialNodeList","handleAddParams","onDelParams","handleAddOutPut","codeEditBoxRef","openEditCodeBox","runTestRef","CodeEditBox","SubKey","RunTest","tableData","getConfigList","handleAddKey","getUuid","getHttpAuthConfig","getParmas","errorIndex","resultList","http_auth_config_list","uni_key","saveHttpAuthConfig","column","_component_a_popconfirm","isLockedByOther","test_params","testResult","runTestStatus","fields","generateRandomId","callWorkFlowHttpTest","err","handleAutoExtractOutput","handleAutoSaveDraft","atInputRefs","parseCurlModalRef","showParseModal","handleParseResult","parsedData","headers","body","body_raw","handleValue","getFieldDefaultValue","handleAutoExtract","setAtInputRef","el","handleAddHeader","onDelHeader","handleAddBody","onDelBody","addAuthenticationModalRef","handleOpenAuthenticationModal","handleSaveAuthentication","handleDelAuthentication","CodeOutlined","_hoisted_41","_hoisted_43","ParseCurlModal","AddAuthenticationModal","curlInput","parseError","placeholderText","hide","handleParse","curlCommand","PLACEHOLDER","cleanCommand","out","parseCurl","decodedQuery","decodedKey","decodedValue","decodedData","toolInfoRef","curlData","toolInfo","getFilterRules","getFieldTypeRules","rules","getFilterRulesByType","fieldType","getFilterRuleLabel","ruleValue","rule","r","isMultiple","operatorOptionsMap","changeAtInputValue2","addCondition","rowData","removeCondition","selectField","option","ruleRows","selectRule","changeType","row","setData","onConditionChagne","where","whereDataConditions","form","whereDataFormatter","conditions","ruleArr","QueryConditionFilter","valueOptions","loop_parent_key","gropModel","loop","diy_global","getValueOptions","assign","handleAdd","dropdownVisibleChange","modalTitle","oprateType","checkKey","INDEX","add","addSub","edit","currentIndex","addParamsModalRef","handleEditOutput","onOutputAdd","onOutputEdit","EditOutlined","AddParamsModal","params_extractor","onOutputAddSub","_imports_1$4","collapsed","toggleCollapse","operatorOptions","HolderOutlined","selectedKeys","_component_a_tree","switcherCls","dataRef","outputFields","changeSoreField","changeLimit","CollapsePanel","SortSelector","_imports_1","OutputFields","cate","items","handleAddcategory","onDelcategory","checkedHeader","intermediateChildren","handleIntermediateOption","existing","merged","seen","child","term","terms","handleAddCondition","handleDelCondition","handleAddBranch","handleDelBranch","handleVariableChange","getTypeByVariable","baseTypeOptions","baseTypeOptions2","slectItem","getTypeOptions","draggable","graphModel","reply","haveOutKeyNode","tag","_component_FullscreenOutlined","_component_AtInput","_component_FullAtInput","nodeParams","getValueVariableList","np","loadProvider","getTMcpProviderInfo","tools","inputSchema","requireds","_imports_0$9","_imports_1$3","_imports_2$1","_imports_2","current","handleShowImg","_component_a_carousel","LeftCircleOutlined","RightCircleOutlined","_component_a_image_preview_group","vis","_component_a_image","currentNodeKey","cuttentItem","currentImageList","localData","getFieldLists","loop_test_params","is_need_question","is_need_openid","callLoopWorkFlowParams","use_token","use_mills","loop_test_params_data","callLoopWorkFlow","node_logs","formateData","getImageUrl","handleChangeNodeKey","formatStr","formatTime","CheckCircleFilled","CloseCircleFilled","ImageLogs","loopArraysOptions","filterArrayFields","filterNodes","nodes","filteredChildren","loop_arrays_default","intermediate_params_default","output_default","outputOptions","childList","handleAddLoopArrays","onDelLoopArrays","handleLoopArrChange","selectedOptions","handleAddIntermediateParams","onDelIntermediateParams","handleAddOutputArrays","onDelOutputArrays","handleOutputArrChange","filterItem1","_imports_3","fieldMap","formatPlaceholder","innerValue","innerTags","handleChange","tags","showFull","input_type_map","tag_map","f","d","AtFullInput","getFeiShuOperator","FeiShuOperator","getFeiShuOperatorMap","map","feiShuOperatorMap","ShowFieldTypes","FieldTypesOperatorMap","getFieldOperator","BatchActions","getBatchActionParams","filterKeys","changeOperator","stateStruct","activeField","fullDefaultValue","fullDefaultTags","field_names","filter","sort","page_size","onConditionChange","conjunction","changeValueByFull","target","activeKey","activeIdx","idx","cur","nodePrams","base","old","VIEW_SELECT_OPTIONS","roleIdType","advancedChange","pluginName","actionComponentMap","FeishuSearchData","FeishuInsertData","FeishuUpdateData","FeishuDelData","FeishuCreateBitable","FeishuCreateTable","FeishuCreateView","FeishuAddMembers","FeishuUpdateAdvanced","childRef","configModalRef","configData","currentConfigName","loadingF","tables","currentConfig","outputData","loadConfig","nodeParamsAssign","outputFormat","showConfigModal","refresh","getPluginConfigData","loadTables","isValidURL","runPlugin","tableChange","loadFields","paramsFormat","getPluginActionDefaultArguments","v","arg","compInit","tableSetChange","tokenChange","configChange","prevTableId","exists","table","prevArgs","nextPart","mergedTagMap","mergedArgs","pluginOutputToTree","FeishuBatchBox","_resolveDynamicComponent","FeishuConfigModal","fieldRules","ok","_args","validateField","getLabel","getPlaceholder","setState","$slots","apps","syncing","config","loadWxApps","getParams","app_id","app_secret","loadTags","baseParams","sortObjectKeys","getWechatAppList","syncTags","appChange","tagTypeChange","tagChange","filterOption","PluginFormRender","keyName","app","templates","getRegObj","loadTemplates","_","secret","templateChange","content","parseWxTemplateToObj","syncTemplates","wxTemplateContCheck","changeFieldValue","linkTypeChange","obj","lines","s","regObj","line","hasObjectPropRows","isObjectWithProps","getReplyMode","fieldRuleMap","applyFunctionalTips","mode","backendOuter","propMeta","initializeObjectField","k","onSelectObjectProp","prop","mapPropType","keys","presetKey","validateAll","errors","dataItems","fieldRef","plginName","useEventBus","onWorkflowValidate","msgTypeChange","mapMsgFieldType","bus","typeItem","onChangeReceiver","ReplyData","_imports_0$8","isObject","isPlainObject","ctor","prot","Q","Z","L","nn","u","a","c","X","q","l","rn","y","b","tn","U","g","O","S","w","P","M","x","H","A","z","I","E","N","en","on","R","D","G","W","B","un","an","fn","ln","dn","_defineProperty","DIRTY_PATHS","DIRTY_PATH_KEYS","NORMALIZING","PATH_REFS","POINT_REFS","RANGE_REFS","_objectWithoutPropertiesLoose","source","excluded","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","getCharacterDistance","isRTL","isLTR","codepoints","codepointsIteratorRTL","CodepointType","right","distance","gb11","gb12Or13","char","getCodepointType","intersects","endsWithEmojiZWJ","endsWithOddNumberOfRIs","isBoundaryPair","SPACE","PUNCTUATION","CHAMELEON","getWordDistance","dist","started","charDist","remaining","splitByCharacterDistance","isWordCharacter","at","nextChar","nextRemaining","end","char1","isLowSurrogate","char2","isHighSurrogate","charCode","reExtend","rePrepend","reSpacingMark","reL","reV","reT","reLV","reLVT","reExtPict","NonBoundaryPairs","endingEmojiZWJ","endingRIs","numRIs","isElement","Node","Editor","Element","elementVal","elementKey","element","_excluded$4","_excluded2$3","ownKeys$8","object","enumerableOnly","symbols","sym","_objectSpread$8","IS_EDITOR_CACHE","editor","voids","reverse","Text","Path","anchor","focus","unit","fragment","cachedIsEditor","isEditor","Range","Operation","point","Point","children","first","isNormalizing","start","levels","marks","_node","_rest","prev","block","prevNode","prevPath","blockPath","rest","pointAfterLocation","to","parent","next","universal","from","Span","last","nodeEntries","_ref","matches","hit","isLower","force","getDirtyPaths","getDirtyPathKeys","popDirtyPath","allPaths","_ref2","allPathKeys","dirtyPath","entry","max","_dirtyPath","_entry","parentPath","depth","edge","firstPath","lastPath","affinity","pathRefs","refs","pointRefs","isNewBlock","blockText","leafTextRemaining","leafTextOffset","isFirst","calcDistance","pointBeforeLocation","previous","rangeRefs","endBlock","before","skip","_excluded$3","_excluded2$2","IS_NODE_LIST_CACHE","root","ancestor","childPath","another","properties","newRoot","produce","leaf","_leaf","cachedResult","isNodeList","pass","visited","nextIndex","newPath","_newPath","ownKeys$7","_objectSpread$7","inversePath","inverseNewPath","newProperties","_properties","_newProperties","paths","common","av","bv","min","as","bs","al","bl","operation","_op","_op2","position","_op3","_position","_op4","onp","copy","ownKeys$6","_objectSpread$6","offset","_excluded$2","ownKeys$5","_objectSpread$5","rs","re","ts","te","isAfterStart","isBeforeEnd","s1","e1","s2","e2","affinityAnchor","affinityFocus","isCollapsed","isDeepEqual","_key","_excluded$1","_excluded2$1","ownKeys$4","_objectSpread$4","loose","omitText","decorations","leaves","dec","length","middle","after","off","_off","ownKeys$3","_objectSpread$3","applyToDraft","_path","_point","_path2","_node2","_parent","_index","_point2","_key2","_path3","_node3","_parent2","_index2","truePath","newParent","newIndex","_point3","_key3","_path4","_index3","_parent3","_point4","_key4","_prev","preferNext","_path5","_offset","_text","_node4","_before","_after","_point5","_key5","_path6","_node5","_key6","_key7","_key8","_value","_path7","_node6","_parent4","_index4","_before2","_after2","_before3","_after3","_point6","_key9","GeneralTransforms","createDraft","finishDraft","isDraft","_excluded","_excluded2","ownKeys$2","_objectSpread$2","NodeTransforms","hanging","select","pointRef","Transforms","_matchPath","pathRef","isAtEnd","matchPath","parentNodeEntry","toPath","_toPath","splitPath","_toPath2","commonPath","isPreviousSibling","emptyAncestor","hasSingleChildNest","emptyRef","toRef","targets","_ref3","depths","_ref4","split","rangeRef","splitMode","endAtEndOfNode","startAtStartOfNode","hasChanges","always","deleteRange","beforeRef","highest","voidMatch","nudge","voidNode","voidPath","afterPath","siblingHeight","afterRef","highestPath","lowestPath","isEnd","_ref5","_loop","roots","rootPath","_ret","commonNodeEntry","commonNode","wrapperPath","wrapper","ownKeys$1","_objectSpread$1","SelectionTransforms","opts","oldProps","newProps","TextTransforms","furthestVoid","_end","endOfDoc","startBlock","isAcrossBlocks","isSingleText","startVoid","endVoid","startRef","endRef","inlineElementMatch","_inlinePath","blockMatch","isBlockStart","isBlockEnd","isBlockEmpty","mergeStart","mergeEnd","matcher","isRoot","starts","middles","ends","starting","hasBlocks","inlineMatch","inlinePath","isInlineStart","isInlineEnd","middleRef","blockPathRef","_end2","ownKeys","_objectSpread","editorRef","shallowRef","activeEditor","valueHtml","toolbarConfig","editorConfig","file","insertFn","base64","getBase64","showVariable","varDialogStyle","tagAllData","selectedIdSet","initData","decodeVariable","handleCreated","SlateEditor","updateDialogPosition","getCaretRectSafe","onSelectOption","selectOption","set","insertAtCaret","handleDirectionChange","unwrapRoot","save","Toolbar","_tags","newsContRef","articleData","currentNewsIndex","currentNews","thumbTypeOpts","comOpts","fansComOpts","addNews","articleTypeChange","articleChange","article","changeStateFieldValue","showContModal","changeContent","delNews","addItem","delItem","_hoisted_49","_hoisted_52","_hoisted_53","ZmRadioGroup","_hoisted_69","_hoisted_71","_hoisted_79","_hoisted_80","_hoisted_81","_hoisted_82","_hoisted_83","_hoisted_84","_hoisted_85","_hoisted_86","_hoisted_87","_hoisted_88","_hoisted_89","_hoisted_90","_hoisted_91","DraftNewsCont","DraftNewspicCont","ExclamationCircleFilled","compMap","OfficialDraftStore","OfficialDraftOperate","currentComp","loginVisible","userInfo","scriptEl","showLogin","loadDingScript","renderLoginComp","callback","loginResult","redirectUrl","authCode","getUserInfo","dingtalk_code","dingtalk_app_key","dingtalk_app_secret","baseConfigReady","baseId","operatorId","loadRemoteData","setTable","tbInfo","setTypeChange","switchOptions","rednerDesc","_k","_l","_m","_n","_o","_p","_q","_r","_s","_component_a_range_picker","dates","dateStrings","_t","_u","_v","_w","_x","_y","_z","_A","_B","_C","_D","DingLoginBox","_E","DingTableSelect","_F","_G","_H","_I","_J","pluginNameForCache","hasCacheSetting","paramList","clickUrl","clickTitle","paramsMap","hasOfficial","meta","sortedEnum","tagLists","tagTypes","syncingTags","dateRangeTypes","dateAnchors","settingsOpen","showTagComponents","enumList","selected","related","hasPluginConfigComponent","hasAdvancedSetting","useAdv","anyAdvField","displayParamList","isCacheField","cacheParamList","advancedParamList","isAdv","pc","changed","def","loadFieldTags","loadCacheForEmptyFields","tagMap","endKey","typeKey","typeVal","buildArguments","injectConfigArgs","buildTagMap","buildRendering","storeAllToCache","onChangeDynamic","extras","onFieldChange","sanitizeStr","buildCacheKey","fieldKey","title","cache","cfg","beginKey","beginVal","endVal","beginTags","endTags","mergedTags","raw","msg","enums","isValidDateStr","dayjs","interval","allowedDays","service","syncFieldTags","dateRangeTypeChange","getRangeValue","onDateRangeCalendarChange","onDateRangeChange","getDisabledDateForRange","endMax","maxInterval","limit","names","defName","wantName","schemaData","settingsShowChange","cfgName","FieldList","PluginConfigModal","descText","loginInfo","loginStatus","goLogin","useOfficialArticleLogin","useUserStore","username","QrcodeBox","pluginCompMap","FeishuBittableBox","OfficialAccountBox","OfficialTagBox","OfficialTemplateBox","OfficialSendMessageBox","OfficialDraftBox","HttpToolBox","OfficialArticleBox","customFieldsSortMap","actionInfo","isMultiNode","remoteInfo","showDesc","loadPluginInfo","loadPluginParams","getPluginInfo","pName","business","sortFields","DynamicApiBox","getGraph","selectedValues","onChangeQuestionMultipleqSwitch","trigger","_imports_0$7","getMonthDays","every_type","week_number","month_day","cron_config","_component_a_time_picker","_imports_0$6","trigger_options","selectAppItems","trigger_official_config","outputs","handleOpenAppModal","wxAppRef","handleAppChange","handleDelOfficial","id","SelectWechatApp","_imports_0$5","_imports_1$2","batch_test_params","callBatchWorkFlowParams","batch_test_params_data","callBatchWorkFlow","batchArraysOptions","outputArrarysOptions","getOutputOptions","batch_arrays_default","onBatchArrVisibleChange","handleBatchArrChange","batch","changeOutputValue","placeholderMap","typeOptions","filterOutputOption","filterCalueOptions","traverse","newItem","finish","onDelItem","_component_a_segmented","getDefaultRadioOpt","defaultRadioOpt","getDefaultVoiceOpts","defaultVoiceOpts","getEmotionMap","emotionMap","audioSampleRates","audioBitrate","audioFormats","getAudioChannels","audioChannels","formatMap","getEffectMap","effectMap","getLanguageMap","languageMap","getVoiceSettingSliderConfig","voiceSettingSliderConfig","getVoiceModifySliderConfig","voiceModifySliderConfig","getVoiceOutputObj","voiceOutputObj","getVoiceCloneOutputObj","voiceCloneOutputObj","_state","txt","getVoiceList","rows","voiceModalRef","voiceSelectOpts","voiceOptions","voiceId","customValue","showVoiceOpts","voice_id","voice_name","changeVoiceId","showVoiceModal","modelChange","voiceSetTypeChange","voiceChange","_component_a_row","_component_a_col","SelectVoiceModal","_imports_0$4","_imports_1$1","options1","options2","promptInputRef","outputImggeList","letter","handleChangeModel","currentModelConfig","getCurrentModelConfig","image_generation_config","allSizeOptions","getSizeOptions","sizeOptions","image_max","show_image_optimize_prompt","show_image_watermark","image_inputs_image_max","image_generation","changeImgListValue","baseList","handleFilterOptions","AddKeyModal","trigger_web_hook_config","globalOptions","strGlobalOptions","addKeyModalRef","handleAddKeyModal","handleEditKey","onKeyAdd","onKeyEdit","onKeyAddSub","handleCopyText","_component_a_input_group","groupListMap","variableOptionsArr","library_import","library_id","defaultList","selectedLibraryType","getLibraryGroup","json_encode","json_decode","formatSpacialKey","_imports_0$3","defaultMenu","menu_content","changeMenuValue","question","reply_content_list","findItem","onDragEnd","onDelete","handleAddMenu","loadRobotNode","getRobotStartNode","_params","_it","formComponents","StartNodeForm","ProblemOptimizationForm","AiDialogueNodeFrom","AddDataForm","KnowledgeBaseNodeForm","CodeRunNodeForm","HttpNodeForm","HttpToolNodeForm","DeleteDataForm","VariableAssignmentNodeForm","UpdateDataForm","ParameterExtractionNodeForm","SelectDataForm","QuestionNodeForm","JudgeNodeForm","SpecifyReplyNodeForm","ImmediatelyReplyNodeForm","McpForm","CustomGroupNodeForm","BatchGroupForm","ZmPluginsNodeForm","SessionTriggerForm","TimingTriggerForm","EndNodeForm","OfficialTriggerNodeForm","ImageGenerationNodeForm","VoiceCloneForm","VoiceSynthesisForm","ExplainNodeForm","WebhookTriggerNodeForm","ImportLibraryNodeForm","JsonNodeForm","JsonReverseNodeForm","QaNodeForm","ZmWorkflowNodeForm","metaParams","provide","nodeFormComponent","componentName","_Transition","_component_a_result","arrayToTree","flatData","idKey","parentIdKey","childrenKey","tree","mappedItem","parentId","Elk","lf","ELK","graphData","originalGraphData","edges","nodeMap","newNodes","edgeMap","elkNodes","elkEdges","elkGraph","newElkGraph","updateNodePositions","parentElkNode","parentX","parentY","elkNode","originalNode","actualX","actualY","originalEdge","newEdge","section","startPoint","endPoint","dx","dy","controlPoint1","controlPoint2","groupNode","viewWidth","viewHeight","minX","minY","maxX","maxY","halfWidth","halfHeight","graphWidth","graphHeight","padding","scaleX","scaleY","newZoom","__publicField","GroupAutoResize","model","groupX","groupY","groupWidth","groupHeight","nodeLeft","nodeRight","nodeTop","nodeBottom","groupLeft","groupRight","groupTop","groupBottom","newGroupWidth","newGroupHeight","newGroupX","newGroupY","needsResize","diff","selectedElements","DEFAULT_WIDTH","DEFAULT_HEIGHT","PolylineEdge","vh","VueNode","createApp","customWidth","customHeight","arrowConfig","pointsList","positionData","wrapperStyle","dom","PolylineEdgeModel","generateUniqueId","style","sourceNodeModel","sourceAnchor","targetNodeModel","targetAnchor","customLineEdge","CustomEdge","CustomEdgeModel","BezierEdge","stroke","strokeWidth","elementWidth","elementHeight","getBezierPoint","x0","y0","x1","y1","x2","y2","x3","y3","t2","t3","mt","mt2","mt3","getBezierLength","segments","prevPoint","currentPoint","findMidPoint","totalLength","targetLength","low","high","midT","epsilon","getPartialLength","currentT","midPoint","BezierEdgeModel","customBezierEdge","PopupMenu","_component_PopupMenu","WIDTH","HEIGHT","ContextPad","ContextPadView","container","anchorData","canvasHeight","canvasWidth","menuHeight","menuWidth","CanvasHistory","ctrlKey","metaKey","isCtrlOrCmd","selectElements","selectedElementIds","snapshot","currentState","previousState","stateToRestore","eventName","toolOverlay","historyDetails","redoDetails","currentHistoryIndex","CustomKeyboard","transform","SCALE_X","SCALE_Y","transformModel","canvasX","canvasY","isCanvas","validNodes","basePoint","pasteBasePoint","transformArray","node_id","node_name","node_type","original_value","BaseVueNodeView","HtmlNode","anchorList","sourceAnchorIds","targetAnchorIds","anchorIsSelected","radius","circle","flh","arrowPath","plusPath","rootEl","BaseVueNodeModel","HtmlNodeModel","startNode","parentNodes","traverseParents","allParentVariableNodeWhiteList","HasOutputPluginNames","variableArr","groupNodes","image_num","variable","_normalizeStyle","NodeCommon","oldVal","newDataRaw","oldDataRaw","_component_node_common","sourceRule01","sourceNode","targetNode","sourceAnchorId","sourceRule02","targetRule01","isHovered","isSelected","nodeSortKey","sessionTriggerNode","VueHtmlNodeModel","VueHtmlNode","diyGlobalMap","triggerNodes","triggerData","allowedNodeTypes","modelStore","useModelStore","allModelList","storeToRefs","getModelOptionsList","setText","findLabelByValue","foundLabel","labelArr","resetSize","reset","UserQuestionText","ModelNameText","getQuestionNodeAnchor","defaultAnchor","anchorListPos","questionNode","anchors","actionNode","nextNode","handleDelEdg","delEdges","onUpatateNodeName","AtText","customAnchor","qaNode","questionTextRef","aiDialogueNode","handleConsole","ArrowRightOutlined","httpNode","httpToolNode","knowledgeBaseNode","endNode","explainNode","getKeyValue","variableAssignmentNode","updateAnchorList","ifBoxRefs","getRuleLabel","updateAnchor","ifBoxCountOffsetTop","margin","subItemHeight","subItemNum","subItem","userQuestionText","offsetTop","offsetHeight","judgeNode","_component_AtText","specifyReplyNode","immediatelyReplyNode","parameterExtractionNode","problemOptimizationNode","_imports_0$2","onUnmounted","addDataNode","field_type","updateDataNode","deleteDataNode","selectDataNode","codeRunNode","atTextRef","patchTags","schema","req","_component_at_text","mcpNode","config_name","table_name","render","FeishuTableRender","OfficialSendMessageRender","DynamicRender","tagMaps","customHandleFunc","schemaAction","isAction","oldArgs","updatedArgs","isDefaultableField","cacheVal","currentUse","newNodeParamsStr","robotKey","hash","pair","nextTags","article_type_text","_component_DynamicRender","_component_FeishuTableRender","_component_OfficialSendMessageRender","zmPluginsNode","_imports_0$1","addNode","loop_node_key","handleClick","handleDelete","BorderLine","CustomGroup$1","dynamicGroup","shape","mountPoint","CustomGroupComponent","oldProperties","CustomGroupModel$1","customGroupNode","CustomGroup","CustomGroupModel","groupStartNode","terminateMode","week_number_map","timingTriggerNode","msg_type_map","test","aa","officialTriggerNode","batch_node_key","batchGroupNode","outputList","imageGenerationNode","jsonNode","jsonReverseNode","voiceSynthesisNode","voiceCloneNode","webhookTriggerNode","library_name","importLibraryNode","zmWorkflowNode","registerCustomNodes","register","DONT_SHOW_DELETE_CONFIRM_KEY","lfRef","setStorage","getStorage","useStorage","dontShowDeleteConfirm","nodeFormDrawerRef","nodeFormDrawerShow","selectedNode","containerRef","TeleportContainer","getTeleport","flowId","canvasData","miniMapOptions","selectionSelectOptions","handleZoomChange","initLogicFlow","LogicFlow","DndPanel","MiniMap","SelectionSelect","DynamicGroup","dragNodeZIndexMap","nodeChildren","nodeGroup","nodeId","relatedEdges","newOffset","minOffset","maxOffset","onCustomAddNode","onCustomAddGroupNode","childId","handleSelectedNode","handleBlankClick","onDeleteNode","onDeleteEdge","handleDeleteEdge","handleKeyoardDelete","handleBatchPaste","createTriggerElements","nodesMap","getNodesMap","trigger_list","triggerEdges","nodeCongfig","edgeId","triggerNode","getData","triggers","triggerElements","history","handleSetNodeToGroup","groupModel","nodeNameMap","getTriggerNodePosition","resizeGroup","nodeLeftBoundary","nodeRightBoundary","nodeTopBoundary","nodeBottomBoundary","groupLeftBoundary","groupRightBoundary","groupTopBoundary","groupBottomBoundary","needResize","newWidth","newHeight","deltaX","deltaY","extraWidth","extraHeight","createNodeInfo","dropEvent","pos","onAddLoopGroup","onAddBatchGroup","hasSessionNode","zIndex","originalNodes","nodesToCreate","newNodeData","updateNode","isNode","isEdge","getTriggerNodes","deleteSelectedElements","elementsToDelete","deletetTriggerNodes","performDelete","isTriggerNode","checkboxChecked","Checkbox","noShowDrawerNode","handleNodeChange","handleChangeNodeName","focusOnNode","targetX","targetY","centerX","centerY","newTranslateX","newTranslateY","CustomControl","NodeFormDrawer","DEFAULT_SUGGEST_MAP","isShowQuestionForm","question_multiple_switch","query","getQuestionMultipleSwitchStatus","global","getGlobalDefaultVal","isJsonString","handleDelQuestionItem","handleAddQuetionItem","question_multiple","overrides","buildStorageOverrides","callWorkFlow","nodeIcon","getDefaultPlaceholder","parseJSONMaybe","deepEqual","typed","defList","userStore","isAdmin","lockPopoverOpen","lockMinutes","lockLoading","saveLockConfig","saveDraftExTime","getAdminConfig","mins","visibleChange","onEdit","hasError","details","onErr","comp","handleRelease","getGlobal","getVersionRecord","handleEdit","openRunTest","time","formatType","TopHeader","ClockCircleOutlined","UNI_STORAGE_KEY","node_list","value1","value2","value3","version_desc","saveLoading","getVersion","getUniIdentifier","buildUserAgent","ua","platform","os","browser","version","workFlowPublishVersion","workFlowNextVersion","version_params","currentIp","currentUA","showDrawer","getDetailList","getDraftKey","workFlowVersions","setVersion","workFlowVersionDetail","handlePreviewVersion","getNodeList","_component_a_drawer","EllipsisOutlined","INACTIVITY_MS","LEADER_TTL_MS","HEARTBEAT_MS","LEADER_PREFIX","AUTO_PROMPT_COOLDOWN_MS","addRobotAlertRef","workflowCanvasRef","currentVersion","currentVersionData","pageHeaderRef","loop_save_canvas_status","nodeTypes","getNodeTypes","isEditing","autoSaveEnabled","inactivityTimer","changeMonitorTimer","lastChangeTs","lastChangeHash","lockRemoteAddr","lockUserAgent","loginUserName","isLeaderFlag","TAB_ID","heartbeatTimer","getLeaderKey","getOpenTabsKey","incrementOpenTabs","decrementOpenTabs","cleanupExpiredLeaderKeys","now","getLeader","becomeLeader","isLeader","leader","releaseLeader","releaseSpecificLeader","storageHandler","updateAutoSaveTimer","visibilityHandler","startLeaderHeartbeat","stopLeaderHeartbeat","leaderNow","computeCanvasHash","getCanvasData","startChangeMonitor","stopChangeMonitor","ensureLeaderAndAutoSaveOnChange","startInactivityWatcher","stopInactivityWatcher","checkEditLock","acquireEditLock","setWorkflowData","toAddRobot","node_info_json","exception","clientDraftTs","basePayload","confirmOverrideAndSave","saveNodes","timer","autoBehindConfirming","autoBehindPromptShown","lastAutoBehindPromptTs","BEHIND_MODAL_TEXT","isAuto","forcePayload","res2","handleAutoSaveWithConflictCheck","versionModelRef","openVersionModel","getModelList","getModelConfigOption","newList","start_node_params","start_node","publishDetailRef","currentDraft","handleOpenErrorNode","handleClickEdit","checkNodePluginStatus","nds","closeNds","updateNds","nd","titleStyle","nameStyle","tasks","openPlugin","downloadPlugin","currentLeaderKey","newKey","PageHeader","PageSidebar","WorkflowCanvas","AddRobotAlert","VersionModel","PublishDetail"],"mappings":"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","x_google_ignoreList":[92,93,94]}