import{g as x,j as T}from"./index-B551IHpY.js";import{X as E,f as L,w as B,e as k,o as b,a1 as y,_ as r,a2 as _,Y as N,a9 as M,F as I,G as O,a7 as f,k as V,a5 as g,ae as A}from"./vue-chunks-CXJTX1FC.js";import{b as D}from"../../index-0TFHdij1.js";import{bl as G,v as F,E as R,u as X}from"./ui-antd-D3ZAJ1Vq.js";const $=E("model",()=>{const l=L([]);return{allModelList:l,getAllmodelList:async()=>{try{if(l.value.length==0){const n=await x();l.value=n.data}return l.value}catch(n){}}}});function j(l){let i=l||[],n={};return i.forEach(e=>{e.key=e.config_info.id,e.id=e.config_info.id,e.config_name=e.config_info.config_name,e.model_config_id=e.config_info.id,e.children=e.use_model_configs.map(o=>(o.thinking_type==2&&(n[e.config_info.id+"#"+o.use_model_name]=!0),{...o,key:e.config_info.id+"_"+o.use_model_name,value:e.config_info.id+"_"+o.use_model_name,model_config_id:e.config_info.id,name:o.use_model_name,label:o.show_model_name}))}),{newList:i,choosableThinking:n}}function W(l,i,n="LLM"){if(!l||!i)return"";let e=$();if(e.allModelList.length==0)return"";let o=e.allModelList;o=o.map(c=>({...c,use_model_configs:c.use_model_configs.filter(p=>p.model_type==n)}));let d=o.find(c=>c.config_info.id==l),a=null;return d&&(a=d.use_model_configs.find(c=>c.use_model_name==i)),a?`${d.config_info.config_name||d.config_info.show_model_name||d.model_name}  ${a.show_model_name||a.use_model_name}`:""}const q={key:0,class:"model-show-block"},K=["src"],Y={class:"name-text"},z=["src"],H={__name:"model-select",props:{modelType:{type:String,validator:l=>["TEXT EMBEDDING","RERANK","LLM"].includes(l),required:!0},modeName:{type:[String,Number],default:""},modeId:{type:[String,Number],default:""},placeholder:{type:String,default:"请选择嵌入模型"}},emits:["change","update:modeName","update:modeId","loaded"],setup(l,{emit:i}){const n=i,e=l,o=L();B([()=>e.modeId,()=>e.modeName],([t,s])=>{!t||!s?o.value=void 0:o.value=t+"-"+s},{immediate:!0});const d=L([]),a=k(()=>e.modeId?d.value.find(t=>t.key==e.modeId):{}),c=k(()=>a.value.children&&a.value.children.length?a.value.children.find(t=>t.use_model_name==e.modeName):{}),p=(t,s)=>{s&&(n("update:modeName",s.modelName),n("update:modeId",s.modelId),n("change",t,s))},w=()=>{T({model_type:e.modelType}).then(t=>{let s=t.data||[],{newList:h,choosableThinking:v}=j(s);d.value=h,n("loaded",d.value,v)})};return b(()=>{w(),e.modeId&&e.modeName&&(o.value=e.modeId+"-"+e.modeName)}),(t,s)=>{const h=R,v=F,S=G,C=X;return r(),y(C,{value:o.value,placeholder:l.placeholder,onChange:p,style:{width:"100%"},allowClear:!0,class:"modal-seclet-new"},{clearIcon:_(()=>[a.value?(r(),N("div",q,[g("img",{class:"icon",src:a.value.model_icon_url,alt:""},null,8,K),g("div",Y,f(a.value.config_name||a.value.model_name)+" "+f(c.value.show_model_name||c.value.use_model_name),1)])):A("",!0)]),default:_(()=>[(r(!0),N(I,null,M(d.value,u=>(r(),y(S,{key:u.key},{label:_(()=>[V(h,{align:"center",gap:6},{default:_(()=>[g("img",{class:"model-icon",src:u.model_icon_url,alt:""},null,8,z),g("span",null,f(u.config_name||u.model_name),1)]),_:2},1024)]),default:_(()=>[(r(!0),N(I,null,M(u.children,m=>(r(),y(v,{value:m.value,modelId:m.model_config_id,modelName:m.name,key:m.key},{default:_(()=>[O(f(m.show_model_name||m.name),1)]),_:2},1032,["value","modelId","modelName"]))),128))]),_:2},1024))),128))]),_:1},8,["value","placeholder"])}}},Z=D(H,[["__scopeId","data-v-7aff1ed2"]]);export{Z as M,j as a,W as g,$ as u};
