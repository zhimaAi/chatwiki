import{b as F}from"../../index-BZRrEp3V.js";import{as as w,at as L,a as u}from"./ui-antd-BWf8LxGy.js";import{e as M,f as T,w as U,Y as r,_ as p,k as f,a5 as s,a2 as N,u as v,a7 as x,F as B,a9 as z,ad as A}from"./vue-chunks-Ci-XTWEs.js";const D={class:"ant-upload-drag-icon"},E={class:"ant-upload-hint"},I={__name:"upload-input",props:{value:{type:Array,default:()=>[]},maxCount:{type:Number,default:1},type:{type:[String,Number],default:0}},emits:["change","update:value"],setup(g,{emit:_}){const c=_,t=g;let o=["pdf","docx","ofd","txt","md","xlsx","csv","html"];t.type==2&&(o=["docx","csv","xlsx"]);const h=M(()=>o.map(e=>`.${e}`).join(",")),a=T([]);U(()=>t.value,e=>{a.value=e},{immediate:!0});let n=null;const C=()=>{if(a.value.length>=t.maxCount)return u.error("一次最多上传"+t.maxCount+"个文件")},d=()=>{a.value.length>t.maxCount&&u.error("一次最多上传"+t.maxCount+"个文件");let e=[...a.value];c("change",e),c("update:value",e)},b=e=>{y(e),d()},y=e=>{for(let l=0;l<a.value.length;l++)if(a.value[l].uid===e.uid){a.value.splice(l,1);break}},k=e=>{const l=e.name.split(".").pop();return o.includes(l.toLowerCase())?e.size/1024/1024<100?(a.value=[...a.value||[],e],a.value.length>t.maxCount&&(a.value=a.value.splice(0,t.maxCount)),n&&clearTimeout(n),n=setTimeout(()=>{d(),clearTimeout(n)},50),!1):(u.error("文件大小不能超过100M"),!1):(u.error("不支持的文件格式"),!1)};return(e,l)=>{const m=L;return p(),r("div",{class:A(["upload-input",{disabled:a.value.length>=t.maxCount}])},[f(m,{"file-list":a.value,name:"file",multiple:!0,"max-count":t.maxCount,accept:h.value,beforeUpload:k,onRemove:b,class:"ant-upload-drag"},{default:N(()=>[s("div",D,[f(v(w))]),l[1]||(l[1]=s("div",{class:"ant-upload-text"},"点击或将文件拖拽到这里上传",-1)),s("div",E,[s("p",null,"一次只能上传"+x(t.maxCount)+"个文档，单个文件不超过100M",1),s("p",null,[l[0]||(l[0]=s("span",null,"支持文件类型：",-1)),(p(!0),r(B,null,z(v(o),i=>(p(),r("span",{class:"ant-upload-hint-ext",key:i},"."+x(i),1))),128))])])]),_:1,__:[1]},8,["file-list","max-count","accept"]),s("div",{class:"disabled-mask",onClick:C})],2)}}},W=F(I,[["__scopeId","data-v-150e6faa"]]);export{W as U};
