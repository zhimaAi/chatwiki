import{b as L,V as U,M as B,k as f}from"../../index-uZrSGPJ2.js";import{F as M}from"./index-BuYscfp6.js";import{P as N}from"./PlusOutlined-C4d6M8_0.js";import{e as s,w as S,M as w,N as n,a7 as V,k as h,S as I,W as d,Q as k,u as x,a1 as A,a2 as J}from"./vue-chunks-Dagx-vSq.js";import{_ as G}from"./index-BpPh0jW3.js";const R=t=>(A("data-v-0ae5df67"),t=t(),J(),t),z={class:"avatar-uploader"},D=["src"],E=R(()=>d("div",{class:"ant-upload-text"},"上传照片",-1)),Q=["src"],T={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(t,{emit:y}){function v(e){return new Promise((o,l)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>o(a.result),a.onerror=p=>l(p)})}const m=y,P=t,r=s([]),g=s(!1),i=s("");S(()=>P.value,e=>{i.value=e},{immediate:!0});const b=M.useInjectFormItemContext(),C=()=>{let e={imageUrl:i.value,file:r.value[0].originFileObj};m("change",e),m("update:value",e.imageUrl),b.onFieldChange()},F=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size/1024<100?(r.value=[e],v(e).then(a=>{i.value=a,g.value=!1,C()}),!1):(f.error("知识库封面图片大小不能超过100kb"),!1):(f.error("知识库封面只支持JPG、PNG格式的图片"),!1),u=s(!1),_=s(""),c=s(""),O=()=>{u.value=!1,c.value=""},j=async e=>{!e.url&&!e.preview&&(e.preview=await v(e.originFileObj)),_.value=e.url||e.preview,u.value=!0,c.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)};return(e,o)=>{const l=G,a=B;return n(),w("div",z,[t.value?(n(),w("img",{key:0,class:"avatar",src:t.value,alt:"avatar"},null,8,D)):V("",!0),h(l,{class:"upload-upload","file-list":r.value,"onUpdate:fileList":o[0]||(o[0]=p=>r.value=p),"list-type":"picture-card","show-upload-list":!1,"before-upload":F,accept:".jpg,.png,.jpeg",onPreview:j},{default:I(()=>[d("div",null,[g.value?(n(),k(x(U),{key:0})):(n(),k(x(N),{key:1})),E])]),_:1},8,["file-list"]),h(a,{open:u.value,title:c.value,footer:null,onCancel:O},{default:I(()=>[d("img",{alt:"example",style:{width:"100%"},src:_.value},null,8,Q)]),_:1},8,["open","title"])])}}},Y=L(T,[["__scopeId","data-v-0ae5df67"]]);export{Y as A};
