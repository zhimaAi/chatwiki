{"version":3,"file":"cu-scroll-CpIj948h.js","sources":["../../../../front-end/chat-ai-admin-vue/src/components/cu-scroll/cu-scroll.vue"],"sourcesContent":["<style lang=\"less\" scoped>\r\n.scroll-wrapper {\r\n  position: relative;\r\n  height: 100%;\r\n  overflow: hidden;\r\n\r\n  .scroll-content {\r\n    min-height: 100%;\r\n  }\r\n}\r\n.cu-scrolbar-box {\r\n  :deep(.bscroll-vertical-scrollbar) {\r\n    transition: opacity 0.4s;\r\n    opacity: 0;\r\n  }\r\n  &:hover {\r\n    :deep(.bscroll-vertical-scrollbar) {\r\n      opacity: 1;\r\n    }\r\n  }\r\n}\r\n</style>\r\n<template>\r\n  <div\r\n    class=\"scroll-wrapper\"\r\n    :class=\"{ 'cu-scrolbar-box': props.scrollbar.interactive }\"\r\n    ref=\"scroller\"\r\n  >\r\n    <div class=\"scroll-content\">\r\n      <slot></slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted, nextTick } from 'vue'\r\nimport BScroll from '@better-scroll/core'\r\nimport ScrollBar from '@better-scroll/scroll-bar'\r\nimport MouseWheel from '@better-scroll/mouse-wheel'\r\nimport ObserveDOM from '@better-scroll/observe-dom'\r\nimport Pullup from '@better-scroll/pull-up'\r\n\r\nBScroll.use(MouseWheel)\r\nBScroll.use(ScrollBar)\r\nBScroll.use(ObserveDOM)\r\nBScroll.use(Pullup)\r\n\r\nconst emit = defineEmits(['onScrollEnd', 'scroll'])\r\n\r\nconst props = defineProps({\r\n  scrollX: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  scrollY: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  scrollbar: {\r\n    type: [Boolean, Object],\r\n    default: () => {\r\n      return {\r\n        minSize: 0,\r\n        interactive: true,\r\n        scrollbarTrackClickable: true,\r\n      }\r\n    }\r\n  },\r\n  pullUpLoad: {\r\n    // 布尔和对象\r\n    type: [Boolean, Object],\r\n    default: true\r\n  },\r\n  disableMouse: {\r\n    // 禁止数据按下拖动\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nlet mouseDownHandler = null // 保存 mousedown 监听器的引用\r\n\r\nconst scroller = ref(null)\r\nlet scrollController = null\r\n\r\nconst refresh = () => {\r\n  scrollController.refresh()\r\n}\r\n\r\nconst scrollToElement = (option) => {\r\n  let { el, time, offsetX, offsetY, easing } = option\r\n  /**\r\n   * scrollToElement(el, time, offsetX, offsetY, easing)\r\n   * {DOM | string} el 滚动到的目标元素, 如果是字符串，则内部会尝试调用 querySelector 转换成 DOM 对象。\r\n   * {number} time 滚动动画执行的时长（单位 ms）\r\n   * {number | boolean} offsetX 相对于目标元素的横轴偏移量，如果设置为 true，则滚到目标元素的中心位置\r\n   * {number | boolean} offsetY 相对于目标元素的纵轴偏移量，如果设置为 true，则滚到目标元素的中心位置\r\n   * {Object} easing 缓动函数，一般不建议修改，如果想修改，参考源码中的 packages/shared-utils/src/ease.ts 里的写法\r\n   */\r\n  scrollController.scrollToElement(el, time, offsetX, offsetY, easing)\r\n}\r\n\r\nconst enable = () => {\r\n  scrollController.enable()\r\n}\r\n\r\nconst disable = () => {\r\n  scrollController.disable()\r\n}\r\n\r\nonMounted(() => {\r\n  scrollController = new BScroll(scroller.value, {\r\n    scrollX: props.scrollX,\r\n    scrollY: props.scrollY,\r\n    scrollbar: props.scrollbar,\r\n    observeDOM: true,\r\n    pullUpLoad: props.pullUpLoad,\r\n    // 不派发 scroll 事件\r\n    probeType: 0,\r\n    mouseWheel: {\r\n      speed: 20,\r\n      invert: false,\r\n      easeTime: 300\r\n    },\r\n    preventDefault: false,\r\n    bounce: false,\r\n    click: true\r\n  })\r\n\r\n  scrollController.on('pullingUp', () => {\r\n    emit('onScrollEnd')\r\n\r\n    nextTick(() => {\r\n      scrollController.finishPullUp()\r\n    })\r\n  })\r\n\r\n  scrollController.on('scroll', (position)=>{\r\n    emit('scroll', position)\r\n  })\r\n\r\n  // 定义 mousedown 事件处理函数\r\n  mouseDownHandler = (e) => {\r\n    const startY = e.clientY\r\n\r\n    const mouseMoveHandler = (e) => {\r\n      const deltaY = e.clientY - startY\r\n      if (Math.abs(deltaY) > 5) {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      }\r\n    }\r\n\r\n    const removeListeners = () => {\r\n      document.removeEventListener('mousemove', mouseMoveHandler)\r\n      document.removeEventListener('mouseup', removeListeners)\r\n    }\r\n\r\n    document.addEventListener('mousemove', mouseMoveHandler)\r\n    document.addEventListener('mouseup', removeListeners, { once: true })\r\n  }\r\n\r\n  // 添加 mousedown 监听\r\n  if (props.disableMouse) {\r\n    scroller.value?.addEventListener('mousedown', mouseDownHandler)\r\n  }\r\n})\r\n\r\nonUnmounted(() => {\r\n  // 移除 mousedown 监听（确保 scroller.value 存在）\r\n  if (scroller.value && mouseDownHandler) {\r\n    scroller.value.removeEventListener('mousedown', mouseDownHandler)\r\n  }\r\n})\r\n\r\ndefineExpose({\r\n  refresh,\r\n  scrollToElement,\r\n  enable,\r\n  disable,\r\n})\r\n</script>\r\n"],"names":["BScroll","MouseWheel","ScrollBar","ObserveDOM","Pullup","emit","__emit","props","__props","mouseDownHandler","scroller","ref","scrollController","refresh","scrollToElement","option","el","time","offsetX","offsetY","easing","enable","disable","onMounted","nextTick","position","e","startY","mouseMoveHandler","deltaY","removeListeners","_a","onUnmounted","__expose","_createElementBlock","_createElementVNode","_hoisted_1","_renderSlot","_ctx"],"mappings":"+nBA0CAA,EAAQ,IAAIC,CAAU,EACtBD,EAAQ,IAAIE,CAAS,EACrBF,EAAQ,IAAIG,CAAU,EACtBH,EAAQ,IAAII,CAAM,EAElB,MAAMC,EAAOC,EAEPC,EAAQC,EA+Bd,IAAIC,EAAmB,KAEvB,MAAMC,EAAWC,EAAI,IAAI,EACzB,IAAIC,EAAmB,KAEvB,MAAMC,EAAU,IAAM,CACpBD,EAAiB,QAAO,CAC1B,EAEME,EAAmBC,GAAW,CAClC,GAAI,CAAE,GAAAC,EAAI,KAAAC,EAAM,QAAAC,EAAS,QAAAC,EAAS,OAAAC,CAAM,EAAKL,EAS7CH,EAAiB,gBAAgBI,EAAIC,EAAMC,EAASC,EAASC,CAAM,CACrE,EAEMC,EAAS,IAAM,CACnBT,EAAiB,OAAM,CACzB,EAEMU,EAAU,IAAM,CACpBV,EAAiB,QAAO,CAC1B,EAEA,OAAAW,EAAU,IAAM,OACdX,EAAmB,IAAIZ,EAAQU,EAAS,MAAO,CAC7C,QAASH,EAAM,QACf,QAASA,EAAM,QACf,UAAWA,EAAM,UACjB,WAAY,GACZ,WAAYA,EAAM,WAElB,UAAW,EACX,WAAY,CACV,MAAO,GACP,OAAQ,GACR,SAAU,GAChB,EACI,eAAgB,GAChB,OAAQ,GACR,MAAO,EACX,CAAG,EAEDK,EAAiB,GAAG,YAAa,IAAM,CACrCP,EAAK,aAAa,EAElBmB,EAAS,IAAM,CACbZ,EAAiB,aAAY,CAC/B,CAAC,CACH,CAAC,EAEDA,EAAiB,GAAG,SAAWa,GAAW,CACxCpB,EAAK,SAAUoB,CAAQ,CACzB,CAAC,EAGDhB,EAAoBiB,GAAM,CACxB,MAAMC,EAASD,EAAE,QAEXE,EAAoBF,GAAM,CAC9B,MAAMG,EAASH,EAAE,QAAUC,EACvB,KAAK,IAAIE,CAAM,EAAI,IACrBH,EAAE,eAAc,EAChBA,EAAE,gBAAe,EAErB,EAEMI,EAAkB,IAAM,CAC5B,SAAS,oBAAoB,YAAaF,CAAgB,EAC1D,SAAS,oBAAoB,UAAWE,CAAe,CACzD,EAEA,SAAS,iBAAiB,YAAaF,CAAgB,EACvD,SAAS,iBAAiB,UAAWE,EAAiB,CAAE,KAAM,GAAM,CACtE,EAGIvB,EAAM,gBACRwB,EAAArB,EAAS,QAAT,MAAAqB,EAAgB,iBAAiB,YAAatB,GAElD,CAAC,EAEDuB,EAAY,IAAM,CAEZtB,EAAS,OAASD,GACpBC,EAAS,MAAM,oBAAoB,YAAaD,CAAgB,CAEpE,CAAC,EAEDwB,EAAa,CACX,QAAApB,EACA,gBAAAC,EACA,OAAAO,EACA,QAAAC,CACF,CAAC,cA7JCY,EAQM,MAAA,CAPJ,SAAM,iBAAgB,CAAA,kBACO3B,EAAM,UAAU,WAAW,CAAA,CAAA,UACpD,WAAJ,IAAIG,IAEJyB,EAEM,MAFNC,EAEM,CADJC,EAAaC,EAAA,OAAA,UAAA,CAAA,EAAA,OAAA,EAAA"}