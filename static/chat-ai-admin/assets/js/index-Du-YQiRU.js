import{r as y,E as Z,e as T,b as f,t as r,y as n,q as L,u as t,a1 as Me,p as e,a as q,F as D,l as F,h as xe,v as a,_ as h,ah as ue,c as ce,j as pe,am as Pe,Y as Ae,G as oe,i as Ue,ag as Ne,x as Re}from"./vue-chunks-BdaA73Wf.js";import{u as V,a6 as E,_ as Te,aq as Be,a8 as ne,a5 as me,l as je}from"../../index-DSFcP5NQ.js";import{L as Ee}from"./list-tabs-Dv38O5dh.js";import{F as we,c as Ce,I as ge,G as $e,M as z,b as B,m as ve,N as Je,a4 as Se,B as he,v as fe,u as be,s as ze,r as Le,a1 as se,p as De,a9 as Fe,O as le,ad as Ve,aH as qe,ac as Q,z as Ye,at as He,an as Ge,W as ye,q as Qe,x as Ze,H as Ke}from"./ui-antd-Dl1wwwCD.js";import{E as We}from"./empty-box-DAN5iPDv.js";import{u as ke}from"./index-B_UHbFfL.js";import{h as Xe}from"./other-LrIFyvU9.js";import{g as et}from"./index-Cg7-0swo.js";import{_ as K}from"./emoji-mart-BBMRoEa3.js";import{d as tt}from"./utils-CvB22N-W.js";import{Z as at}from"./zm-radio-group-B3tVhfsZ.js";import{L as ot}from"./loading-box-CQ9Pukre.js";import{s as nt}from"./index-C67uUbSa.js";import{u as st}from"./robot-CIzNpArp.js";import"./editor-cherry-CFIsbKoN.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./empty-BFmzY9bl.js";const lt={__name:"comb-store-modal",props:{type:{type:[Number,String],default:1}},emits:["ok"],setup(g,{expose:o,emit:s}){const{t:_}=V("views.robot.robot-config.payment.components.comb-store-modal"),C=s,O=g,w=y(null),m=y(!1),u=Z({});function S(l){w.value=l||null,Object.assign(u,l||{id:0,name:"",duration:"",count:"",price:""}),m.value=!0}function k(){try{if(!u.name)throw _("msg_input_package_name");if(O.type==2&&!u.duration)throw _("msg_input_package_duration");if(!u.count)throw _("msg_input_package_count");if(!u.price)throw _("msg_input_package_price");let l=Me(u);O.type==1&&delete l.duration,m.value=!1,C("ok",JSON.parse(JSON.stringify(l)))}catch(l){B.error(l)}}return o({show:S}),(l,i)=>{const M=ge,x=Ce,b=$e,p=we,N=z;return f(),T(N,{title:w.value?t(_)("title_edit_package"):t(_)("title_create_package"),open:m.value,"onUpdate:open":i[4]||(i[4]=$=>m.value=$),onOk:k},{default:r(()=>[n(p,{layout:"vertical"},{default:r(()=>[n(x,{label:t(_)("label_package_name"),required:""},{default:r(()=>[n(M,{value:u.name,"onUpdate:value":i[0]||(i[0]=$=>u.name=$),valueModifiers:{trim:!0},placeholder:t(_)("ph_package_name_example"),maxlength:6},null,8,["value","placeholder"])]),_:1},8,["label"]),g.type==2?(f(),T(x,{key:0,label:t(_)("label_duration"),required:""},{default:r(()=>[n(b,{value:u.duration,"onUpdate:value":i[1]||(i[1]=$=>u.duration=$),min:0,precision:0,placeholder:t(_)("ph_input"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"])):L("",!0),n(x,{label:t(_)("label_count"),required:""},{default:r(()=>[n(b,{value:u.count,"onUpdate:value":i[2]||(i[2]=$=>u.count=$),min:0,precision:0,placeholder:t(_)("ph_input"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"]),n(x,{label:t(_)("label_price"),required:""},{default:r(()=>[n(b,{value:u.price,"onUpdate:value":i[3]||(i[3]=$=>u.price=$),min:0,precision:2,placeholder:t(_)("ph_input"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1},8,["title","open"])}}},Ie=(g={})=>E.get({url:"/manage/robotPayment/getPaymentSetting",params:g}),ct=(g={})=>E.post({url:"/manage/robotPayment/savePaymentSetting",data:g}),it=(g={})=>E.post({url:"/manage/robotPayment/copyPaymentSetting",data:g}),_t=(g={})=>E.post({url:"/manage/robotPayment/addAuthCode",data:g}),dt=(g={})=>E.post({url:"/manage/robotPayment/deleteAuthCode",data:g}),rt=(g={})=>E.get({url:"/manage/robotPayment/getAuthCodeList",params:g}),ut=(g={})=>E.get({url:"/manage/robotPayment/getAuthCodeStats",params:g}),pt=(g={})=>E.post({url:"/manage/robotPayment/addAuthCodeManager",data:g}),mt=(g={})=>E.get({url:"/manage/robotPayment/getAuthCodeManager",params:g}),gt=(g={})=>E.post({url:"/manage/robotPayment/deleteAuthCodeManager",data:g}),vt={class:"data-list"},ht=["onClick"],ft=["src"],bt={class:"info"},yt={class:"tit"},kt={class:"desc"},xt={key:1,class:"status-tag waiting"},wt={__name:"copy-config-modal",props:{robotId:{type:[Number,String]}},setup(g,{expose:o}){const{t:s}=V("views.robot.robot-config.payment.components.copy-config-modal"),_=g,C=y(!1),O=y(!1),w=y(!1),m=y([]);function u(){S(),C.value=!0}function S(){O.value=!0,et().then(l=>{const i=(l==null?void 0:l.data)||[];m.value=i.filter(M=>M.id!=_.robotId)}).finally(()=>{O.value=!1})}function k(){let l=m.value.filter(i=>i.checked).map(i=>i.id);if(!l.length)return B.error(s("error_select_app"));w.value=!0,it({from_robot_id:_.robotId,to_robot_id:l.toString()}).then(i=>{B.success(s("msg_operation_completed")),C.value=!1}).finally(()=>{w.value=!1})}return o({show:u}),(l,i)=>{const M=ve,x=Je,b=z;return f(),T(b,{title:t(s)("modal_title"),open:C.value,"onUpdate:open":i[0]||(i[0]=p=>C.value=p),"confirm-loading":w.value,width:"669px",onOk:k},{default:r(()=>[n(M,{type:"info",class:"zm-alert-info",message:t(s)("alert_message")},null,8,["message"]),e("div",vt,[(f(!0),q(D,null,F(m.value,(p,N)=>(f(),q("div",{key:N,class:xe(["data-item",{disabled:p.has_published!=1}]),onClick:$=>p.checked=!p.checked},[e("img",{class:"avatar",src:p.robot_avatar},null,8,ft),e("div",bt,[e("div",null,[e("div",yt,a(p.robot_name),1),e("div",kt,a(p.robot_intro),1)]),p.has_published==1?(f(),T(x,{key:0,checked:p.checked,"onUpdate:checked":$=>p.checked=$},null,8,["checked","onUpdate:checked"])):(f(),q("span",xt,[n(t(Se)),h(" "+a(t(s)("status_unpublished")),1)]))])],10,ht))),128))])]),_:1},8,["title","open","confirm-loading"])}}},Ct=K(wt,[["__scopeId","data-v-31454299"]]),$t={class:"content"},St={class:"left"},qt={class:"form-box"},It={class:"form-item"},Ot={class:"form-item-tit"},Mt={class:"form-item"},Pt={class:"form-item-tit"},At={class:"form-item"},Ut={class:"form-item-tit"},Nt={class:"combo-table mt8"},Rt={class:"ant-table-cell",width:"120"},Tt={class:"ant-table-cell",width:"100"},Bt={class:"ant-table-cell",width:"120"},jt={class:"ant-table-cell",width:"100"},Et={class:"ant-table-cell",width:"140"},Jt={class:"ant-table-row"},zt={class:"ant-table-cell"},Lt={class:"drag-btn"},Dt={class:"ant-table-cell"},Ft={class:"ant-table-cell"},Vt={class:"ant-table-cell"},Yt={class:"ant-table-cell"},Ht=["onClick"],Gt=["onClick"],Qt={class:"form-item"},Zt={class:"form-item-tit"},Kt={key:0,class:"qrcode-box mt8"},Wt=["src"],Xt={class:"right"},ea={class:"tit"},ta={class:"preview-box",id:"previewBox"},aa={class:"tip"},oa=["src"],na={class:"title"},sa={class:"table-box"},la={key:0},ca={class:"footer"},ia={__name:"settings-box",props:{config:{type:Object}},emits:["update"],setup(g,{emit:o}){const{t:s}=V("views.robot.robot-config.payment.components.settings-box"),_=o,C=g,O=ue(),w=y(null),m=y(null),u=y(!1),S=y(!1),k=y(""),l=Z({robot_id:O.query.id,try_count:3,package_type:"2",count_package:[],duration_package:[],contact_qrcode:"",package_poster:""}),i=y([]),M=y(-1),x=ce(()=>k.value==""?!1:k.value!=JSON.stringify(l));pe(()=>{b()});function b(){N(JSON.parse(JSON.stringify(C.config)))}async function p(){u.value=!0,Ie({robot_id:O.query.id}).then(c=>{let d=(c==null?void 0:c.data)||{};_("update",JSON.parse(JSON.stringify(d))),d.count_package=ne(d.count_package,[]),d.duration_package=ne(d.duration_package,[]),N(d)}).finally(()=>{u.value=!1})}function N(c){Object.assign(l,c),k.value=JSON.stringify(l),j()}function $(c=null,d=-1){M.value=d,w.value.show(c)}function j(){i.value=l.package_type==1?l.count_package:l.duration_package}function J(c){M.value>-1?i.value[M.value]=c:i.value.push(c)}function W(c,d){z.confirm({title:s("modal_title_tip"),icon:oe(le),content:s("modal_confirm_delete_package"),okText:s("modal_btn_confirm"),cancelText:s("modal_btn_cancel"),onOk(){i.value.splice(d,1)}})}function Y(c){try{if(!(c.type==="image/jpeg"||c.type==="image/png"))throw s("error_image_format");if(!(c.size/1024<1024*2))throw s("error_image_size");ke({category:"library_image",file:c}).then(R=>{l.contact_qrcode=R.data.link})}catch(d){B.error(d)}return!1}function X(){z.confirm({title:s("modal_title_tip"),icon:oe(le),content:s("modal_confirm_delete_qrcode"),okText:s("modal_btn_confirm"),cancelText:s("modal_btn_cancel"),onOk(){l.contact_qrcode=""}})}function ee(){m.value.show()}function I(){return Xe(document.getElementById("previewBox"),{useCORS:!0}).then(async function(c){const d=await Be(c),{data:U}=await ke({category:"library_image",file:d});return l.package_poster=U.link,U})}function te(){const c=l.package_type==1?"count_package":"duration_package";l[c]=i.value}function ie(){S.value=!0,Ue(async()=>{await I(),te();let c=JSON.parse(JSON.stringify(l));c.count_package=JSON.stringify(c.count_package),c.duration_package=JSON.stringify(c.duration_package),ct(c).then(d=>{B.success(s("msg_saved")),p()}).finally(()=>{S.value=!1})})}return(c,d)=>{const U=ve,R=he,H=fe,A=be,ae=ze,_e=Le,de=Te,re=De,P=Fe;return f(),q("div",null,[n(U,{type:"info","show-icon":"",message:t(s)("alert_info_message"),class:"zm-alert-info"},null,8,["message"]),e("div",$t,[e("div",St,[n(R,{onClick:ee},{default:r(()=>[h(a(t(s)("btn_copy_settings")),1)]),_:1}),e("div",qt,[e("div",It,[e("div",Ot,a(t(s)("label_allow_trial_count")),1),n(A,{value:l.try_count,"onUpdate:value":d[0]||(d[0]=v=>l.try_count=v),style:{width:"320px"}},{default:r(()=>[(f(),q(D,null,F(50,v=>n(H,{key:v,value:v},{default:r(()=>[h(a(v),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),e("div",Mt,[e("div",Pt,a(t(s)("label_package_plan")),1),n(_e,{value:l.package_type,"onUpdate:value":d[1]||(d[1]=v=>l.package_type=v),onChange:j},{default:r(()=>[n(ae,{value:"1"},{default:r(()=>[h(a(t(s)("radio_charge_by_count")),1)]),_:1}),n(ae,{value:"2"},{default:r(()=>[h(a(t(s)("radio_charge_by_duration")),1)]),_:1})]),_:1},8,["value"])]),e("div",At,[e("div",Ut,a(t(s)("label_package_plan")),1),e("div",null,[n(R,{type:"primary",ghost:"",disabled:i.value.length>9,onClick:d[2]||(d[2]=v=>$())},{default:r(()=>[n(t(se)),h(" "+a(t(s)("btn_add_package"))+" ("+a(i.value.length)+"/10) ",1)]),_:1},8,["disabled"]),e("table",Nt,[e("thead",null,[e("tr",null,[e("th",Rt,a(t(s)("table_header_package_name")),1),e("th",Tt,a(t(s)("table_header_duration")),1),e("th",Bt,a(t(s)("table_header_total_count")),1),e("th",jt,a(t(s)("table_header_cost")),1),e("th",Et,a(t(s)("table_header_operation")),1)])]),n(t(Pe),{modelValue:i.value,"onUpdate:modelValue":d[3]||(d[3]=v=>i.value=v),onEnd:te,"item-key":"id",group:"table-rows",handle:".drag-btn",class:"ant-table-tbody",tag:"tbody"},{item:r(({element:v,index:G})=>[e("tr",Jt,[e("td",zt,[e("span",Lt,[n(de,{name:"drag"})]),h(" "+a(v.name),1)]),e("td",Dt,a(v.duration),1),e("td",Ft,a(v.count),1),e("td",Vt,a(v.price),1),e("td",Yt,[e("a",{onClick:Oe=>$(v,G)},a(t(s)("btn_edit")),9,Ht),e("a",{onClick:Oe=>W(v,G),class:"ml16"},a(t(s)("btn_delete")),9,Gt)])])]),_:1},8,["modelValue"])]),i.value.length?L("",!0):(f(),T(We,{key:0}))])]),e("div",Qt,[e("div",Zt,a(t(s)("label_contact_qrcode")),1),e("div",null,[n(re,{accept:".png,.jpg,.jpeg","show-upload-list":!1,"before-upload":Y},{default:r(()=>[n(R,{type:"primary",ghost:""},{default:r(()=>[n(t(se)),h(" "+a(t(s)("btn_upload_image")),1)]),_:1})]),_:1}),l.contact_qrcode?(f(),q("div",Kt,[e("img",{class:"qrcode",src:l.contact_qrcode},null,8,Wt),e("a",{onClick:X},a(t(s)("btn_delete_qrcode")),1)])):L("",!0)])])])]),e("div",Xt,[e("div",ea,a(t(s)("label_preview_title")),1),e("div",ta,[e("div",{class:xe(["wrap",{"no-qrcode":!l.contact_qrcode}])},[e("div",aa,[n(t(Se),{class:"icon"}),h(" "+a(t(s)("preview_tip_usage_exhausted")),1)]),l.contact_qrcode?(f(),q("img",{key:0,class:"qrcode",src:l.contact_qrcode,crossorigin:"anonymous"},null,8,oa)):L("",!0),e("div",na,a(t(s)("preview_title_package")),1),e("div",sa,[e("table",null,[(f(!0),q(D,null,F(i.value,(v,G)=>(f(),q("tr",{key:G},[e("td",null,a(v.name),1),l.package_type==2?(f(),q("td",la,a(v.duration)+a(t(s)("preview_unit_day")),1)):L("",!0),e("td",null,a(v.count)+a(t(s)("preview_unit_count")),1),e("td",null,a(v.price)+a(t(s)("preview_unit_yuan")),1)]))),128))])])],2)])])]),e("div",ca,[n(P,{open:x.value,content:t(s)("popover_save_tip"),getPopupContainer:v=>v},{default:r(()=>[n(R,{type:"primary",style:{width:"120px"},loading:S.value,onClick:Ae(ie,["stop"])},{default:r(()=>[h(a(t(s)("btn_save")),1)]),_:1},8,["loading"])]),_:1},8,["open","content","getPopupContainer"])]),n(lt,{ref_key:"packageRef",ref:w,type:l.package_type,onOk:J},null,8,["type"]),n(Ct,{ref_key:"copyRef",ref:m,"robot-id":t(O).query.id},null,8,["robot-id"])])}}},_a=K(ia,[["__scopeId","data-v-b25c3e3d"]]),da={class:"count-box"},ra={key:1,class:"success-box"},ua={class:"tit"},pa={class:"code-list"},ma={__name:"auth-code-modal",props:{robotId:{type:[Number,String]},packages:{type:Array}},emits:["addManager","ok"],setup(g,{expose:o,emit:s}){const{t:_}=V("views.robot.robot-config.payment.components.auth-code-modal"),C=s,O=g,w=y(!1),m=y(!1),u=y(!1),S=y([]),k=Z({package_id:void 0,count:1,remark:""}),l=ce(()=>{const b=[{label:"1",value:1},{label:"5",value:5},{label:"10",value:10},{label:"50",value:50}];return b.push({label:_("label_custom"),value:[1,5,10,50].includes(k.count)?"":k.count}),b});function i(){S.value=[],u.value=!1,w.value=!0}function M(){if(u.value){C("ok");let b=S.value.map(p=>p.content);me(b.join(`
`)),B.success(_("msg_copy_success"))}w.value=!1}function x(){if(u.value)C("ok"),w.value=!1;else{if(!k.package_id)return B.error(_("msg_select_package"));if(!k.count)return B.error(_("msg_select_count"));m.value=!0,_t({...k,robot_id:O.robotId}).then(b=>{S.value=(b==null?void 0:b.data)||[],u.value=!0}).finally(()=>{m.value=!1})}}return o({show:i}),(b,p)=>{const N=ve,$=fe,j=be,J=Ce,W=$e,Y=ge,X=we,ee=z;return f(),T(ee,{title:t(_)("title_add_auth_code"),open:w.value,"onUpdate:open":p[5]||(p[5]=I=>w.value=I),"confirm-loading":m.value,"cancel-text":u.value?t(_)("btn_copy"):t(_)("btn_cancel"),onOk:x,onCancel:M},{default:r(()=>[u.value?(f(),q("div",ra,[e("div",ua,[n(t(Ve),{class:"icon"}),h(" "+a(t(_)("msg_add_success")),1)]),e("div",pa,[(f(!0),q(D,null,F(S.value,I=>(f(),q("div",{class:"code-item",key:I.content},a(I.content),1))),128))])])):(f(),q(D,{key:0},[n(N,{type:"info",class:"zm-alert-info"},{message:r(()=>[h(a(t(_)("msg_add_manager_tip")),1),e("a",{onClick:p[0]||(p[0]=I=>C("addManager"))},a(t(_)("msg_add_manager_link")),1)]),_:1}),n(X,{layout:"vertical",class:"mt16"},{default:r(()=>[n(J,{label:t(_)("label_package"),required:""},{default:r(()=>[n(j,{value:k.package_id,"onUpdate:value":p[1]||(p[1]=I=>k.package_id=I),placeholder:t(_)("ph_select_package")},{default:r(()=>[(f(!0),q(D,null,F(g.packages,I=>(f(),T($,{value:I.id},{default:r(()=>[h(a(I.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(J,{label:t(_)("label_count"),required:""},{default:r(()=>[e("div",da,[n(at,{value:k.count,"onUpdate:value":p[2]||(p[2]=I=>k.count=I),options:l.value},null,8,["value","options"]),n(W,{style:{width:"130px"},value:k.count,"onUpdate:value":p[3]||(p[3]=I=>k.count=I),min:1,max:1e3,placeholder:t(_)("ph_input")},null,8,["value","placeholder"])])]),_:1},8,["label"]),n(J,{label:t(_)("label_remark")},{default:r(()=>[n(Y,{value:k.remark,"onUpdate:value":p[4]||(p[4]=I=>k.remark=I),valueModifiers:{trim:!0},placeholder:t(_)("ph_input"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})],64))]),_:1},8,["title","open","confirm-loading","cancel-text"])}}},ga=K(ma,[["__scopeId","data-v-9462ddc0"]]),va="/assets/img/example-01-DKlscM3E.png",ha="/assets/img/example-02-nLVgsFwr.png",fa={class:"main"},ba={__name:"manager-modal",props:{robotId:{type:[Number,String]}},setup(g,{expose:o}){const{t:s}=V("views.robot.robot-config.payment.components.manager-modal"),_=g,C=y(!1),O=y(!1),w=y("");function m(){S(),C.value=!0}function u(){C.value=!1}function S(){O.value=!0,pt({robot_id:_.robotId}).then(l=>{var i;w.value=(i=l==null?void 0:l.data)==null?void 0:i.code}).finally(()=>{O.value=!1})}function k(){me(w.value),B.success(s("msg_copy_success"))}return o({show:m}),(l,i)=>{const M=he,x=z;return f(),T(x,{title:t(s)("title_add_manager"),open:C.value,"onUpdate:open":i[0]||(i[0]=b=>C.value=b),width:"669px"},{footer:r(()=>[n(M,{type:"primary",onClick:u},{default:r(()=>[h(a(t(s)("btn_confirm")),1)]),_:1})]),default:r(()=>[e("div",fa,[e("span",null,a(t(s)("msg_reply_in_account")),1),e("span",{class:"code-box",onClick:k},[h(a(w.value)+" ",1),n(t(qe))]),e("span",null,a(t(s)("msg_set_admin_tip")),1)]),i[1]||(i[1]=e("div",{class:"example"},[e("img",{src:va}),e("img",{src:ha})],-1))]),_:1},8,["title","open"])}}},ya=K(ba,[["__scopeId","data-v-54c006be"]]),ka={class:"content"},xa={class:"overview-box"},wa={class:"overview-block"},Ca={class:"overview-item"},$a={class:"tit"},Sa={class:"count"},qa={class:"val"},Ia={class:"label"},Oa={class:"overview-item"},Ma={class:"tit"},Pa={class:"count"},Aa={class:"val"},Ua={class:"label"},Na={class:"overview-item"},Ra={class:"tit"},Ta={class:"count"},Ba={class:"val"},ja={class:"label"},Ea={class:"overview-block"},Ja={class:"overview-item"},za={class:"tit"},La={class:"count"},Da={class:"val"},Fa={class:"label"},Va={class:"overview-item"},Ya={class:"tit"},Ha={class:"count"},Ga={class:"val"},Qa={class:"label"},Za={class:"overview-item"},Ka={class:"tit"},Wa={class:"count"},Xa={class:"val"},eo={class:"label"},to={class:"main-box"},ao={class:"main-tit"},oo={class:"tip-info"},no={class:"user-list"},so=["src"],lo={class:"main-box"},co={class:"main-tit"},io={class:"filter-box"},_o={class:"left"},ro={class:"right"},uo={key:0,class:"code-box"},po={class:"zm-line2"},mo=["onClick"],go={__name:"auth-code-box",props:{config:{type:Object}},setup(g){const{t:o}=V("views.robot.robot-config.payment.components.auth-code-box"),s=g,_=ue(),C=y(null),O=y(null),w=y(!1),m=Z({today_exchange_count:"0",today_exchange_price:"",today_generate_count:"0",today_generate_price:"",total_exchange_count:"0",total_exchange_price:"",total_generate_count:"0",total_generate_price:"",yesterday_exchange_count:"0",yesterday_exchange_price:"",yesterday_generate_count:"0",yesterday_generate_price:""}),u=y([]),S=y([]),k=y([{title:o("label_auth_code"),dataIndex:"content",width:200},{title:o("label_package_name"),dataIndex:"package_name",width:100},{title:o("label_duration"),dataIndex:"package_duration",width:120},{title:o("label_count"),dataIndex:"package_count",width:120},{title:o("label_cost"),dataIndex:"package_price",width:100},{title:o("label_usage_status"),dataIndex:"usage_status_text",width:120},{title:o("label_exchanger"),dataIndex:"exchanger_openid",width:160},{title:o("label_exchange_time"),dataIndex:"exchange_date",width:160},{title:o("label_use_time"),dataIndex:"use_date",width:160},{title:o("label_create_time"),dataIndex:"create_date",width:160},{title:o("label_creator"),dataIndex:"creator_name",width:100},{title:o("label_remark"),dataIndex:"remark",width:160},{title:o("label_action"),dataIndex:"action",fixed:"right",width:100}]),l=Z({content:"",openid:"",usage_status:void 0}),i=Z({current:1,pageSize:50,total:0}),M={1:o("usage_status_unused"),2:o("usage_status_exchanged"),3:o("usage_status_used")},x=ce(()=>{var d;let c=((d=s.config)==null?void 0:d.package_type)==1?s.config.count_package:s.config.duration_package;return Array.isArray(c)?c:[]});pe(()=>{b()});function b(){p(),N(),j()}function p(){ut({robot_id:_.query.id}).then(c=>{Object.assign(m,(c==null?void 0:c.data)||{})})}function N(){mt({robot_id:_.query.id}).then(c=>{u.value=(c==null?void 0:c.data)||[]})}function $(){S.value=[],i.total=0,i.current=1,j()}function j(){let c={robot_id:_.query.id,page:i.current,size:i.pageSize,...l};rt(c).then(d=>{var R,H;let U=((R=d==null?void 0:d.data)==null?void 0:R.list)||[];U.forEach(A=>{A.usage_status_text=M[A==null?void 0:A.usage_status],A.exchange_date=J(A.exchange_time),A.create_date=J(A.create_time),A.use_date=J(A.use_time)}),S.value=U,i.total=Number(((H=d==null?void 0:d.data)==null?void 0:H.total)||0)})}function J(c){return c>0?tt(c*1e3).format("YYYY-MM-DD HH:mm"):""}function W(c){Object.assign(i,c),j()}function Y(){O.value.show()}function X(){C.value.show()}function ee(c){z.confirm({title:o("title_confirm"),icon:oe(le),content:o("msg_confirm_delete_code"),okText:o("btn_confirm"),cancelText:o("btn_cancel"),onOk(){dt({id:c.id}).then(()=>{B.success(o("msg_deleted")),j()})}})}function I(c){z.confirm({title:o("title_confirm"),icon:oe(le),content:o("msg_confirm_delete_manager"),okText:o("btn_confirm"),cancelText:o("btn_cancel"),onOk(){gt({id:c.id,robot_id:_.query.id}).then(()=>{B.success(o("msg_deleted")),N()})}})}function te(){let c=[],d=[];k.value.forEach(U=>{U.dataIndex!=="action"&&(c.push(U.title),d.push(U.dataIndex))}),je(c.toString()+`
`,S.value,d,`${_.query.robot_key}${o("title_auth_code_detail")}.csv`)}function ie(c){me(c),B.success(o("msg_copied"))}return(c,d)=>{const U=Ye,R=he,H=Ge,A=ge,ae=fe,_e=be,de=Qe,re=Ze;return f(),q("div",ka,[e("div",xa,[e("div",wa,[e("div",Ca,[e("div",$a,[h(a(t(o)("title_today_generate"))+" ",1),n(t(Q))]),e("div",Sa,a(m.today_generate_count),1),e("div",qa,[e("span",Ia,a(t(o)("label_price"))+"：",1),h(a(m.today_generate_price||0),1)])]),e("div",Oa,[e("div",Ma,[h(a(t(o)("title_yesterday_generate"))+" ",1),n(t(Q))]),e("div",Pa,a(m.yesterday_generate_count),1),e("div",Aa,[e("span",Ua,a(t(o)("label_price"))+"：",1),h(a(m.yesterday_generate_price||0),1)])]),e("div",Na,[e("div",Ra,[h(a(t(o)("title_total_generate"))+" ",1),n(t(Q))]),e("div",Ta,a(m.total_generate_count),1),e("div",Ba,[e("span",ja,a(t(o)("label_price"))+"：",1),h(a(m.total_generate_price||0),1)])])]),e("div",Ea,[e("div",Ja,[e("div",za,[h(a(t(o)("title_today_exchange"))+" ",1),n(t(Q))]),e("div",La,a(m.today_exchange_count),1),e("div",Da,[e("span",Fa,a(t(o)("label_price"))+"：",1),h(a(m.today_exchange_price||0),1)])]),e("div",Va,[e("div",Ya,[h(a(t(o)("title_yesterday_exchange"))+" ",1),n(t(Q))]),e("div",Ha,a(m.yesterday_exchange_count),1),e("div",Ga,[e("span",Qa,a(t(o)("label_price"))+"：",1),h(a(m.yesterday_exchange_price||0),1)])]),e("div",Za,[e("div",Ka,[h(a(t(o)("title_total_exchange"))+" ",1),n(t(Q))]),e("div",Wa,a(m.total_exchange_count),1),e("div",Xa,[e("span",eo,a(t(o)("label_price"))+"：",1),h(a(m.total_exchange_price||0),1)])])])]),e("div",to,[e("div",ao,[h(a(t(o)("title_auth_code_manager"))+" ",1),n(U,{type:"vertical"}),e("span",oo,a(t(o)("msg_manager_tip")),1)]),e("div",null,[n(R,{type:"primary",ghost:"",onClick:Y},{default:r(()=>[n(t(se)),h(" "+a(t(o)("btn_add_manager")),1)]),_:1}),e("div",no,[(f(!0),q(D,null,F(u.value,P=>(f(),T(H,{key:P.id},{default:r(()=>[e("img",{class:"avatar",src:P.manager_avatar},null,8,so),h(" "+a(P.manager_nickname)+" ",1),n(t(He),{class:"close",onClick:v=>I(P)},null,8,["onClick"])]),_:2},1024))),128))])])]),e("div",lo,[e("div",co,a(t(o)("title_auth_code_detail")),1),e("div",null,[e("div",io,[e("div",_o,[n(A,{value:l.content,"onUpdate:value":d[0]||(d[0]=P=>l.content=P),valueModifiers:{trim:!0},onChange:$,"allow-clear":"",placeholder:t(o)("ph_search_code"),style:{width:"200px"}},{suffix:r(()=>[n(t(ye))]),_:1},8,["value","placeholder"]),n(A,{value:l.openid,"onUpdate:value":d[1]||(d[1]=P=>l.openid=P),valueModifiers:{trim:!0},onChange:$,"allow-clear":"",placeholder:t(o)("ph_search_openid"),style:{width:"200px"}},{suffix:r(()=>[n(t(ye))]),_:1},8,["value","placeholder"]),n(_e,{value:l.usage_status,"onUpdate:value":d[2]||(d[2]=P=>l.usage_status=P),onChange:$,"allow-clear":"",placeholder:t(o)("label_usage_status"),style:{width:"200px"}},{default:r(()=>[(f(),q(D,null,F(M,(P,v)=>n(ae,{key:v,value:v},{default:r(()=>[h(a(P),1)]),_:2},1032,["value"])),64))]),_:1},8,["value","placeholder"])]),e("div",ro,[n(R,{onClick:te},{default:r(()=>[h(a(t(o)("btn_export")),1)]),_:1}),n(R,{type:"primary",onClick:X},{default:r(()=>[n(t(se)),h(" "+a(t(o)("btn_add")),1)]),_:1})])]),n(re,{scroll:{x:1200},loading:w.value,"data-source":S.value,columns:k.value,pagination:i,onChange:W},{bodyCell:r(({column:P,record:v})=>[P.dataIndex==="content"?(f(),q("div",uo,[e("span",null,a(v.content),1),n(t(qe),{class:"icon",onClick:G=>ie(v.content)},null,8,["onClick"])])):L("",!0),P.dataIndex==="remark"?(f(),T(de,{key:1,title:v.remark},{default:r(()=>[e("div",po,a(v.remark),1)]),_:2},1032,["title"])):L("",!0),P.dataIndex==="action"?(f(),q("a",{key:2,onClick:G=>ee(v)},a(t(o)("btn_delete")),9,mo)):L("",!0)]),_:1},8,["loading","data-source","columns","pagination"])])]),n(ga,{ref_key:"codeRef",ref:C,packages:x.value,robotId:t(_).query.id,onAddManager:Y,onOk:j},null,8,["packages","robotId"]),n(ya,{ref_key:"managerRef",ref:O,robotId:t(_).query.id},null,8,["robotId"])])}}},vo=K(go,[["__scopeId","data-v-b169fd1c"]]),ho={class:"_container"},fo={class:"main-tit"},bo={class:"link"},yo={class:"tab-box"},ko={__name:"index",setup(g){const{t:o}=V("views.robot.robot-config.payment.index"),s=ue(),_=Ne(),C=st(),O=ce(()=>C.paymentSwitchStatus==="1"),w=y(!0),m=y({}),u=y(2),S=y([{title:o("tab_billing_settings"),value:1},{title:o("tab_auth_code_management"),value:2}]);pe(()=>{s.query.form_guide==1?u.value=1:u.value=Number(localStorage.getItem("zm:payment:tab:active")||1),k()});function k(){w.value=!0,Ie({robot_id:s.query.id}).then(x=>{let b=(x==null?void 0:x.data)||{};!b||!Object.keys(b).length&&!s.query.form_guide?_.push({path:"/robot/ability/payment-guide",query:s.query}):l(b)}).finally(()=>{w.value=!1})}function l(x){x.count_package=ne(x.count_package,[]),x.duration_package=ne(x.duration_package,[]),m.value=x}function i(){localStorage.setItem("zm:payment:tab:active",u.value)}function M(x){const b=x?"1":"0",p=()=>nt({robot_id:s.query.id,ability_type:"robot_payment",switch_status:b}).then(()=>{C.setPaymentSwitchStatus(b),B.success(o("msg_operation_success")),window.dispatchEvent(new CustomEvent("robotAbilityUpdated",{detail:{robotId:s.query.id}}))});b==="0"?z.confirm({title:o("modal_title_tip"),content:o("modal_confirm_close"),onOk:p}):p()}return(x,b)=>{const p=Ke,N=Re("router-link");return f(),q("div",ho,[e("div",fo,[e("div",null,[h(a(t(o)("title_app_charging"))+" ",1),n(p,{checked:O.value,"checked-children":t(o)("switch_on"),"un-checked-children":t(o)("switch_off"),onChange:M},null,8,["checked","checked-children","un-checked-children"])]),n(N,{to:{path:"/robot/ability/payment-guide",query:t(s).query}},{default:r(()=>[e("a",bo,a(t(o)("link_view_feature_intro")),1)]),_:1},8,["to"])]),e("div",yo,[n(Ee,{tabs:S.value,value:u.value,"onUpdate:value":b[0]||(b[0]=$=>u.value=$),onChange:i},null,8,["tabs","value"])]),w.value?(f(),T(ot,{key:0})):u.value==1?(f(),T(_a,{key:1,config:m.value,onUpdate:l},null,8,["config"])):(f(),T(vo,{key:2,config:m.value},null,8,["config"]))])}}},zo=K(ko,[["__scopeId","data-v-4375d3d5"]]);export{zo as default};
//# sourceMappingURL=index-Du-YQiRU.js.map
