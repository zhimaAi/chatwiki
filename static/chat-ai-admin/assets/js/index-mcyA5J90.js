import{u as V,O as G,P as H,Q as J,R as K,S as W}from"../../index-DSFcP5NQ.js";import{_ as q}from"./emoji-mart-BBMRoEa3.js";import{u as X,v as Y,I as A,aj as Z,M as I,b as F,c as j,V as z,F as P,m as ee,B as oe,x as te,a4 as ae,O as le}from"./ui-antd-Dl1wwwCD.js";import{r as v,E as N,e as D,b as $,t as r,p as n,v as m,u as s,y as i,a as B,l as ne,F as se,a1 as Q,_ as ie,q as ce}from"./vue-chunks-BdaA73Wf.js";import"./neo4j-MWxXN7EM.js";import"./editor-cherry-CFIsbKoN.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";const de={class:"add-domain-form"},_e={class:"form-item"},ue={class:"form-label"},re={class:"form-input-box"},pe={class:"form-tip"},me={__name:"add-domain-modal ",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(O,{expose:l,emit:g}){const b=O;function d(t){return t=t.replace("ã€‚",".").toLowerCase(),t=t.replace(/\/$/,""),t=t.replace(/(^\s*)|(\s*$)/g,""),t=t.replace("http://",""),t=t.replace("https://",""),t}const{t:h}=V("views.user.domain.components.add-domain-modal"),L=g,a=v(!1),x=v(h("add_title")),p=v([{label:"http",value:"http:"},{label:"https",value:"https:"}]),o=N({id:null,url:"",protocol:"http:"}),S=()=>{try{if(o.url){const t=new URL(o.url);t.protocol=="http:"||t.protocol=="https:"?o.protocol=t.protocol:o.protocol="http:",o.url=t.hostname}}catch{o.url=d(o.url)}},U=()=>{if(!o.url)return F.error(h("url_required"));o.url=d(o.url),L("ok",{...o})};return l({open:t=>{t?(o.url=t.url,o.protocol=t.protocol,o.id=t.id,x.value=h("edit_title")):(o.id=null,o.url="",o.protocol="http:",x.value=h("add_title")),a.value=!0},close:()=>{a.value=!1}}),(t,f)=>{const C=Y,k=X,e=A,_=Z,w=I;return $(),D(w,{open:a.value,"onUpdate:open":f[2]||(f[2]=y=>a.value=y),title:x.value,onOk:U,confirmLoading:b.confirmLoading},{default:r(()=>[n("div",de,[n("div",_e,[n("div",ue,m(s(h)("domain_label")),1),n("div",re,[i(_,{compact:"",style:{width:"100%"}},{default:r(()=>[i(k,{value:o.protocol,"onUpdate:value":f[0]||(f[0]=y=>o.protocol=y),style:{width:"20%"}},{default:r(()=>[($(!0),B(se,null,ne(p.value,y=>($(),D(C,{value:y.value,key:y.value},{default:r(()=>[n("span",null,m(y.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),i(e,{value:o.url,"onUpdate:value":f[1]||(f[1]=y=>o.url=y),style:{width:"80%"},placeholder:s(h)("domain_placeholder"),onBlur:S},null,8,["value","placeholder"])]),_:1})])]),n("div",pe,m(s(h)("domain_tip")),1)])]),_:1},8,["open","title","confirmLoading"])}}},fe=q(me,[["__scopeId","data-v-8b335374"]]),ve={class:"upload-ssl-form"},he={class:"domain"},ke={__name:"upload-ssl",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(O,{expose:l,emit:g}){const b=g,{t:d}=V("views.user.domain.components.upload-ssl"),h=O,L=v(),a=N({id:"",domain:"",ssl_certificate:"",ssl_certificate_key:""}),x={ssl_certificate:[{required:!0,message:d("certificate_required")}],ssl_certificate_key:[{required:!0,message:d("private_key_required")}]},p=v(!1),o=u=>{a.id=u.id,a.domain=u.url,a.ssl_certificate="",a.ssl_certificate_key="",p.value=!0},S=()=>{p.value=!1},U=()=>{L.value.validate().then(()=>{b("ok",Q(a))}).catch(u=>{})};return l({open:o,close:S}),(u,c)=>{const t=z,f=j,C=P,k=I;return $(),D(k,{open:p.value,"onUpdate:open":c[2]||(c[2]=e=>p.value=e),title:s(d)("title"),onOk:U,confirmLoading:h.confirmLoading},{default:r(()=>[n("div",ve,[n("div",he,m(s(d)("domain_label"))+m(u.domain),1),i(C,{ref_key:"formRef",ref:L,model:a,rules:x,autocomplete:"off",layout:"vertical"},{default:r(()=>[i(f,{label:s(d)("certificate_file_label"),name:"ssl_certificate"},{default:r(()=>[i(t,{rows:5,value:a.ssl_certificate,"onUpdate:value":c[0]||(c[0]=e=>a.ssl_certificate=e)},null,8,["value"])]),_:1},8,["label"]),i(f,{label:s(d)("private_key_label"),name:"ssl_certificate_key"},{default:r(()=>[i(t,{rows:5,value:a.ssl_certificate_key,"onUpdate:value":c[1]||(c[1]=e=>a.ssl_certificate_key=e)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["open","title","confirmLoading"])}}},ye=q(ke,[["__scopeId","data-v-d79bd84e"]]),ge={class:"upload-ssl-form"},be={__name:"upload-validation-file",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(O,{expose:l,emit:g}){const b=g,{t:d}=V("views.user.domain.components.upload-validation-file"),h=O,L=v(),a=N({id:"",file_name:"",file_content:""}),x={file_name:[{required:!0,message:d("file_name_required")}],file_content:[{required:!0,message:d("file_content_required")}]},p=v(!1),o=u=>{a.id=u.id,a.file_name="",a.file_content="",p.value=!0},S=()=>{p.value=!1},U=()=>{L.value.validate().then(()=>{b("ok",Q(a))}).catch(u=>{})};return l({open:o,close:S}),(u,c)=>{const t=A,f=j,C=z,k=P,e=I;return $(),D(e,{open:p.value,"onUpdate:open":c[2]||(c[2]=_=>p.value=_),title:s(d)("title"),onOk:U,confirmLoading:h.confirmLoading},{default:r(()=>[n("div",ge,[i(k,{ref_key:"formRef",ref:L,model:a,rules:x,autocomplete:"off",layout:"vertical"},{default:r(()=>[i(f,{label:s(d)("file_name_label"),name:"file_name"},{default:r(()=>[i(t,{value:a.file_name,"onUpdate:value":c[0]||(c[0]=_=>a.file_name=_)},null,8,["value"])]),_:1},8,["label"]),i(f,{label:s(d)("file_content_label"),name:"file_content"},{default:r(()=>[i(C,{rows:5,value:a.file_content,"onUpdate:value":c[1]||(c[1]=_=>a.file_content=_)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["open","title","confirmLoading"])}}},Le=q(be,[["__scopeId","data-v-a41d0e9a"]]),xe={class:"domain-page"},we={class:"page-container"},$e={class:"page-title"},Ce={class:"domain-tips"},Se={class:"tip-text"},Ue={class:"list-action-box"},Oe={class:"list-box"},Re={key:0},Fe={key:1},Be={key:2,class:"action-box"},De=["onClick"],Ve=["onClick"],qe=["onClick"],Ie=["onClick"],Ee={__name:"index",setup(O){const{t:l}=V("views.user.domain.index"),g=v(null),b=v(!1),d=[{title:l("table_column_domain"),dataIndex:"url",key:"url"},{title:l("table_column_certificate"),dataIndex:"is_upload",key:"is_upload",width:300},{title:l("table_column_action"),key:"action"}],h=()=>{g.value.open()},L=e=>{let _={id:e.id,url:e.url,protocol:"http:"};try{const w=new URL(e.url);w.protocol=="http:"||w.protocol=="https:"?_.protocol=w.protocol:_.protocol="http:",_.url=w.hostname}catch{}g.value.open(_)},a=e=>{b.value=!0;let _=`${e.protocol}//${e.url}`;J({url:_,id:e.id||void 0}).then(()=>{F.success(l("save_success")),b.value=!1,g.value.close(),k()}).catch(()=>{b.value=!1})},x=e=>{I.confirm({title:l("delete_confirm_title"),icon:i(le),content:l("delete_confirm_content"),onOk(){H({id:e.id}).then(()=>{F.success(l("delete_success")),k()})},onCancel(){}})},p=v(null),o=v(!1),S=e=>{p.value.open(e)},U=e=>{o.value=!0;let _={id:e.id,ssl_certificate:e.ssl_certificate,ssl_certificate_key:e.ssl_certificate_key};K(_).then(()=>{o.value=!1,p.value.close(),F.success(l("upload_success")),k()}).catch(()=>{o.value=!1})},u=v(null),c=v(!1),t=e=>{u.value.open(e)},f=e=>{c.value=!0,W({...e}).then(()=>{c.value=!1,u.value.close(),F.success(l("upload_success")),k()}).catch(()=>{c.value=!1})},C=v([]),k=async()=>{const e=await G();C.value=e.data||[]};return k(),(e,_)=>{const w=ee,y=oe,T=te;return $(),B("div",xe,[n("div",we,[n("div",$e,m(s(l)("page_title")),1),n("div",Ce,[i(w,{type:"info","show-icon":""},{icon:r(()=>[n("div",null,[i(s(ae),{style:{"font-size":"16px"}})])]),description:r(()=>[n("div",Se,[n("div",null,m(s(l)("domain_tip_1")),1),n("div",null,m(s(l)("domain_tip_2")),1)])]),_:1})]),n("div",Ue,[n("div",null,[i(y,{type:"primary",onClick:h},{default:r(()=>[ie(m(s(l)("add_domain_btn")),1)]),_:1})])]),n("div",Oe,[i(T,{columns:d,"data-source":C.value},{bodyCell:r(({column:E,record:R})=>[E.key==="url"?($(),B("span",Re,m(R.url),1)):E.key==="is_upload"?($(),B("span",Fe,m(R.is_upload?s(l)("certificate_uploaded"):s(l)("certificate_not_uploaded")),1)):E.key==="action"?($(),B("span",Be,[n("a",{class:"action-btn",onClick:M=>S(R)},m(s(l)("upload_certificate")),9,De),n("a",{class:"action-btn",onClick:M=>t(R)},m(s(l)("upload_validation_file")),9,Ve),n("a",{class:"action-btn",onClick:M=>L(R)},m(s(l)("edit")),9,qe),n("a",{class:"action-btn",onClick:M=>x(R)},m(s(l)("delete")),9,Ie)])):ce("",!0)]),_:1},8,["data-source"])])]),i(fe,{ref_key:"addDomainModalRef",ref:g,confirmLoading:b.value,onOk:a},null,8,["confirmLoading"]),i(ye,{ref_key:"uploadSSLRef",ref:p,"confirm-loading":o.value,onOk:U},null,8,["confirm-loading"]),i(Le,{ref_key:"uploadValidationFileRef",ref:u,"confirm-loading":c.value,onOk:f},null,8,["confirm-loading"])])}}},Je=q(Ee,[["__scopeId","data-v-06ac489b"]]);export{Je as default};
//# sourceMappingURL=index-mcyA5J90.js.map
