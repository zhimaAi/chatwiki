import{e as m,ab as A,f as D,w as Z,Y as l,a5 as a,F as R,a9 as j,aa as G,_ as o,ae as x,u as y,ad as B,k as t,a7 as S,a2 as i,G as F,a1 as T,af as H,o as ee,b as te,ag as oe,B as ae,r as U,a4 as E,J as se,a3 as ne,a6 as V}from"./vue-chunks-BSjLwu6d.js";import{b as P,e as J,j as K,d as W,h as N,f as re,R as le,r as ie}from"../../index-0SFcfYGN.js";import{L as ce}from"./layout-logo-D1EVuQYu.js";import{g as ue}from"./index-B4oOBcCh.js";import{g as _e,b as Y,c as Q,h as q,D as X,i as de,j as pe,F as z,k as me,e as ve,f as be,M as he,a as ye}from"./ui-antd-BIopZvX3.js";import{v as fe}from"./validate-8MtiUsxW.js";import{u as ke}from"./global-BjRUvN9c.js";import"./utils-BMKRjDTh.js";const ge={class:"navbar-wrapper"},we={class:"navbar"},Ce=["onClick"],$e={class:"nav-name"},Se={class:"down-icon"},Le=["onClick"],Me={class:"nav-name"},xe={__name:"layout-navbar",setup(I){const d=J(),r=G(),u=A(),p=m(()=>u.meta.activeMenu||""),v=m(()=>u.path.split("/")[1]),c=D(localStorage.getItem("local__robot_menu_key")||"robot_detail"),b=[{id:1,key:"robot",label:"robot",title:"机器人",icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:"知识库",icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:"文档",icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:"搜索",icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:"会话",icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}],C=m(()=>d.top_navigate),L=m(()=>C.value.filter(n=>n.open).map(n=>b.find(_=>_.key===n.id)).filter(Boolean)),g=e=>{r.push(e.path)},$=(e,n)=>{localStorage.setItem("local__robot_menu_key",e),c.value=e,h(n)},h=e=>{c.value=="robot_detail"?f():g(e)},f=async()=>{try{const{data:e=[]}=await ue();if(e.length===0){r.push("/robot/list");return}const n=localStorage.getItem("last_local_robot_id");let _;n&&(_=e.find(s=>s.id==n)),_=_||e[0];const{id:w,robot_key:M,application_type:k}=_;r.push({path:`/robot/config/${k==1?"workflow":"basic-config"}`,query:{id:w,robot_key:M}})}catch{r.push("/robot/list")}};return Z(()=>u.path,()=>{},{immediate:!0}),(e,n)=>{const _=W,w=Q,M=Y,k=X;return o(),l("div",ge,[a("div",we,[(o(!0),l(R,null,j(L.value,s=>(o(),l(R,null,[y(K)(s.permission)?(o(),l(R,{key:0},[s.key==="robot"?(o(),l("div",{key:0,class:B(["nav-menu",{active:s.key===v.value||s.key===p.value}]),onClick:O=>h(s)},[t(_,{class:"nav-icon",name:s.icon},null,8,["name"]),a("span",$e,S(s.title),1),t(k,null,{overlay:i(()=>[t(M,null,{default:i(()=>[t(w,{key:"1",onClick:O=>$("robot_detail",s)},{default:i(()=>[a("div",{class:B(["robot-ment-item",{"robot-active-item":c.value=="robot_detail"}])},[t(y(q),{class:"anticon-check"}),n[0]||(n[0]=F(" 进入机器人详情 "))],2)]),_:2},1032,["onClick"]),t(w,{key:"2",onClick:O=>$("robot_list",s)},{default:i(()=>[a("div",{class:B(["robot-ment-item",{"robot-active-item":c.value=="robot_list"}])},[t(y(q)),n[1]||(n[1]=F(" 进入机器人管理 "))],2)]),_:2},1032,["onClick"])]),_:2},1024)]),default:i(()=>[a("div",Se,[t(y(_e))])]),_:2},1024)],10,Ce)):(o(),l("div",{key:1,class:B(["nav-menu",{active:s.key===v.value||s.key===p.value}]),onClick:O=>g(s)},[t(_,{class:"nav-icon",name:s.icon},null,8,["name"]),a("span",Me,S(s.title),1)],10,Le))],64)):x("",!0)],64))),256))])])}}},Re=P(xe,[["__scopeId","data-v-2c245402"]]),Ie={class:"layout-breadcrumb"},Pe={key:1,class:"page-title"},Te={__name:"layout-breadcrumb",props:{title:{type:[String,Boolean],default:""},items:{type:[Array,Boolean],default:()=>[]}},setup(I){const d=I;return(r,u)=>{const p=H("router-link"),v=pe,c=de;return o(),l("div",Ie,[d.items.length>0?(o(),T(c,{key:0},{default:i(()=>[(o(!0),l(R,null,j(d.items,(b,C)=>(o(),l(R,{key:b.title},[C!==d.items.length-1?(o(),T(v,{key:0},{default:i(()=>[t(p,{to:b.path},{default:i(()=>[F(S(b.title),1)]),_:2},1032,["to"])]),_:2},1024)):(o(),T(v,{key:1},{default:i(()=>[F(S(b.title),1)]),_:2},1024))],64))),128))]),_:1})):(o(),l("div",Pe,S(d.title),1))])}}},Be=P(Te,[["__scopeId","data-v-c69a461d"]]),De={class:"layout-footer"},Fe={class:"copyright-text"},Ne={__name:"layout-footer",setup(I){const d=N(),{t:r}=re(),u=D(null);return ee(()=>{u.value=setInterval(()=>{setTimeout(()=>{d.refreshToken()},0)},le)}),te(()=>{clearInterval(u.value),u.value=null}),(p,v)=>(o(),l("div",De,[a("div",Fe,S(y(r)("common.copyright")),1)]))}},Oe=P(Ne,[["__scopeId","data-v-ab337acb"]]),je={key:0,class:"user-dropdown"},Ue=["src"],Ee={class:"user-name"},Ve=["onClick"],qe={class:"menu-name"},ze={__name:"user-dropdown",setup(I){const d=J(),r=G(),u=N(),{userInfo:p,avatar:v,user_name:c}=oe(u),b=()=>{u.logoutConfirm(!0)},C=()=>{window.open("/#/user/model","_blank","noopener")},L=[{id:1,key:"robot",label:"robot",title:"应用",icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:"知识库",icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:"文档",icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:"搜索",icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:"会话",icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}],g=m(()=>d.top_navigate),$=m(()=>g.value.filter(e=>!e.open).map(e=>L.find(n=>n.key===e.id)).filter(Boolean)),h=f=>{r.push(f.path)};return(f,e)=>{const n=W,_=Q,w=Y,M=X;return y(p)?(o(),l("div",je,[t(M,null,{overlay:i(()=>[t(w,null,{default:i(()=>[t(_,null,{default:i(()=>[a("a",{class:"menu-item",href:"javascript:;",onClick:C},[t(n,{class:"menu-icon",name:"system-setting"}),e[1]||(e[1]=a("span",{class:"menu-name"},"系统管理",-1))])]),_:1}),(o(!0),l(R,null,j($.value,k=>(o(),l(R,null,[y(K)(k.permission)?(o(),T(_,{key:0},{default:i(()=>[a("a",{class:"menu-item",href:"javascript:;",onClick:s=>h(k)},[t(n,{class:"menu-icon",name:k.icon},null,8,["name"]),a("span",qe,S(k.title),1)],8,Ve)]),_:2},1024)):x("",!0)],64))),256)),t(_,null,{default:i(()=>[a("a",{class:"menu-item",href:"javascript:;",onClick:b},[t(n,{class:"menu-icon",name:"logout"}),e[2]||(e[2]=a("span",{class:"menu-name"},"退出登录",-1))])]),_:1})]),_:1})]),default:i(()=>[a("div",{class:"user-dropdown-link",onClick:e[0]||(e[0]=ae(()=>{},["prevent"]))},[a("img",{class:"user-avatar",src:y(v),alt:""},null,8,Ue),a("span",Ee,S(y(c)),1),t(n,{name:"arrow-down",style:{"font-size":"16px",color:"#8c8c8c"}})])]),_:1})])):x("",!0)}}},Ae=P(ze,[["__scopeId","data-v-73a10ef4"]]),Ge={class:"form-box"},He={__name:"reset-password",setup(I,{expose:d}){const r=N(),u=z.useForm,p=D(!0),v=D("重置登录密码"),c=U({password:"",check_password:"",id:r.userInfo.user_id}),b=U({password:[{message:"请输入登录密码",required:!0},{validator:async(f,e)=>!fe(e)&&e?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(f,e)=>e!=c.password&&e?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:C,validate:L,validateInfos:g}=u(c,b),$=()=>{L().then(()=>{ie({...se(c)}).then(f=>{ye.success("修改成功"),p.value=!1,r.reset(!0)})})},h=()=>{r.setResetPassModal()};return d({open}),(f,e)=>{const n=me,_=be,w=ve,M=z,k=he;return o(),l("div",null,[t(k,{open:p.value,"onUpdate:open":e[2]||(e[2]=s=>p.value=s),title:v.value,onOk:$,width:"520px",onCancel:h},{default:i(()=>[t(n,{class:"alert-box",message:"您还未修改初始密码，为了保障您的数据安全，请您尽快重置密码。",type:"info","show-icon":""}),a("div",Ge,[t(M,{layout:"vertical"},{default:i(()=>[t(w,E({label:"登录密码"},y(g).password),{default:i(()=>[t(_,{value:c.password,"onUpdate:value":e[0]||(e[0]=s=>c.password=s),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),t(w,E({label:"确认密码"},y(g).check_password),{default:i(()=>[t(_,{value:c.check_password,"onUpdate:value":e[1]||(e[1]=s=>c.check_password=s),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},Je=P(He,[["__scopeId","data-v-9de4c189"]]),Ke={class:"admin-layout"},We={key:0,class:"layout-header-wrapper"},Ye={class:"layout-header"},Qe={class:"header-left"},Xe={class:"header-body"},Ze={class:"header-right"},et={class:"item-box"},tt={class:"layout-body"},ot={key:0,class:"layout-breadcrumb-wrapper"},at={key:1,class:"layout-footer-wrapper"},st={__name:"index",setup(I){const d=ke(),r=A(),u=N(),p=m(()=>r.name!="robotWorkflow"?!1:d.hideLayoutTopAndBottom||!1),v=m(()=>r.meta.isCustomPage||!1),c=m(()=>r.meta.pageStyle||{}),b=m(()=>r.meta.bgColor||"#ffffff"),C=m(()=>r.meta.breadcrumb||[]),L=m(()=>r.meta.hideTitle||!1),g=m(()=>r.meta.title||!1),$=m(()=>{var h;return((h=u.userInfo)==null?void 0:h.d_pass)==1&&u.isShowResetPassModal});return(h,f)=>{const e=H("router-view");return o(),l("div",Ke,[p.value?x("",!0):(o(),l("div",We,[a("div",Ye,[a("div",Qe,[t(ce)]),a("div",Xe,[t(Re)]),a("div",Ze,[a("div",et,[t(Ae)])])])])),a("div",tt,[v.value?ne(h.$slots,"default",{key:0},()=>[t(e)],!0):(o(),l("div",{key:1,class:"page-wrapper",style:V({"background-color":b.value})},[L.value?x("",!0):(o(),l("div",ot,[t(Be,{items:C.value,title:g.value},null,8,["items","title"])])),a("div",{class:"page-container",style:V({...c.value})},[t(e)],4)],4))]),p.value?x("",!0):(o(),l("div",at,[t(Oe)])),$.value?(o(),T(Je,{key:2})):x("",!0)])}}},pt=P(st,[["__scopeId","data-v-85411cc0"]]);export{pt as default};
