import{_ as it}from"./cu-scroll-ufyFyI_5.js";import{_ as at}from"./page-alert-hUfedjgw.js";import{b as Q,$ as V,a2 as lt,M as P,er as X,k as E,E as Z,d as rt,es as pt,h as ut,B as mt,et as _t}from"../../index-CzPebXix.js";import{z as M,ag as dt,N as h,O as _,j as e,U as o,X as s,H as ct,S as N,a6 as K,Z as c,u as f,_ as d,F as I,a1 as J,a0 as H,d as v,q as ft,W as B,a3 as gt,a7 as vt}from"./vue-chunks-BRsu9_To.js";import{E as bt}from"./EditOutlined-D08WQbiX.js";import{D as yt}from"./index-7Ecr060x.js";import{_ as ht,a as wt,b as kt}from"./index-Bh3NMpRp.js";import{_ as xt}from"./index-BwqnaIPU.js";import{_ as St}from"./index-Dhmpqx9n.js";import{u as $t}from"./util-BwuffJOK.js";import{U as Ct}from"./index-CO6rvZOl.js";import{F as W,_ as qt}from"./index-BgVvqN-n.js";import{T as Ot,_ as Ft}from"./index-YQhVm4Ni.js";import{_ as Dt}from"./TextArea-DrgXbuSS.js";import{U as Kt,I as Et}from"./import-knowledge-modal-jyTSsOxk.js";import{B as Lt,_ as Rt}from"./index-CyLUFO3Y.js";import{L as Ut}from"./LeftOutlined-BKUTcRtP.js";import"./index-BSz5XTfh.js";import{D as zt}from"./dropdown-DTOAy9tU.js";import{D as At}from"./DownOutlined-DXKkgIsm.js";import{M as Bt,_ as Mt}from"./index-DlQVT6K6.js";import{_ as Nt}from"./index-w2fyHr10.js";import{_ as It}from"./index-BhUXTHsq.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Trigger-Bvakuge0.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./Password-fnCqxsm2.js";import"./Input-DFtZp9vk.js";import"./FormItemContext-B2RmG14m.js";import"./index-Bxqtz4sn.js";import"./inputProps-jdR54afw.js";import"./DownloadOutlined-CeWsYko2.js";import"./index-hvcgcTJ4.js";import"./CheckOutlined-Mk6nTpyE.js";import"./useRefs-CRRjy_qY.js";import"./collapseMotion-Brd6xpAT.js";import"./useMergedState-C0iIHNGF.js";import"./index-BYVEo4R0.js";import"./List-D7uk7Chm.js";import"./index-Bhf8G0AA.js";import"./CaretDownFilled-DSht_iiA.js";import"./index-BhHQj-ne.js";import"./responsiveObserve-DqAe0rZk.js";import"./index-0UwCX3b0.js";import"./RightOutlined-DH_YROnp.js";import"./index-6HDf6TPN.js";import"./slide-CsbPJG8I.js";import"./SearchOutlined-a_gTycfl.js";import"./move-CkiYyFmr.js";import"./index-DLRiQ5Ho.js";import"./Checkbox-oqMTsvET.js";import"./index-Di5l0R3t.js";import"./RadioButton-h1wW1k6O.js";import"./CaretDownOutlined-Byn8iz8T.js";import"./index-BFhVTGQQ.js";import"./Search-Cf7bcOZJ.js";import"./isPlainObject-OEy0Jz8l.js";import"./colors-DfoziJR7.js";import"./index-CYUphznb.js";import"./Col-CFxRRwN8.js";import"./QuestionCircleOutlined-DTfTQPH4.js";import"./pick-Sm8BXOZJ.js";import"./PlusOutlined-BlmIiILr.js";import"./validate-8MtiUsxW.js";import"./model-select-BRz1sNBY.js";import"./index-BfxXXGE8.js";import"./SettingOutlined-BAFh-2qK.js";import"./UpOutlined-B_3G2J2r.js";import"./SyncOutlined-BnnoShgX.js";import"./index-Bd3BpNCC.js";import"./shallowequal-C0xnIuy8.js";const Qt={class:"subsection-box"},Pt={class:"qa-list-box"},Tt={class:"list-item"},jt={class:"list-content"},Vt={class:"status-error"},Jt={class:"similar-question-list"},Ht={class:"list-item list-item-answer"},Wt={class:"list-content"},Xt={class:"fragment-img"},Zt=["src"],Gt={key:0,class:"status-block status-green"},Yt={key:1,class:"status-block status-gray"},te=["href"],ee={class:"right-opration"},oe=["onClick"],se=["onClick"],ne={__name:"subsection-box",props:{paragraphLists:{type:Array,default:()=>[]},total:{type:[Number,String],default:0},isLoading:{type:Boolean,default:!1}},emits:["handleDelParagraph","openEditSubscription"],setup(L,{expose:F,emit:R}){const w=R,k=L,g=M({selectedRowKeys:[]}),x=r=>{g.selectedRowKeys=r},l=()=>{g.selectedRowKeys=[]},S=r=>{w("openEditSubscription",r)},q=r=>{P.confirm({title:"提示",icon:e(Z),content:"确认是否删除该分段?",onOk(){return new Promise((u,O)=>{X({ids:r}).then(D=>{E.success("删除成功"),w("handleDelParagraph",r),u()}).catch(()=>{u()})})},onCancel(){}})};return F({handleOpenEditModal:S,state:g,resetSelect:l}),(r,u)=>{const O=xt,D=St,p=ht,i=wt,m=dt("viewer");return _(),h("div",Qt,[e(i,{"data-source":L.paragraphLists,"row-key":"id","row-selection":{selectedRowKeys:g.selectedRowKeys,onChange:x},pagination:!1,loading:k.isLoading},{default:o(()=>[e(p,{key:"id","data-index":"id",width:1148},{title:o(()=>[c("问答（共"+d(k.total)+"个）",1)]),default:o(({record:n})=>[s("div",Pt,[s("div",Tt,[u[0]||(u[0]=s("div",{class:"list-label"},"问题",-1)),s("div",jt,[n.status==2?(_(),N(O,{key:0,placement:"top"},{title:o(()=>[s("span",null,d(n.errmsg),1)]),default:o(()=>[s("span",null,[s("span",Vt,[e(f(V))])])]),_:2},1024)):K("",!0),c(" "+d(n.question)+" ",1),n.similar_questions&&n.similar_questions.length?(_(),N(D,{key:1,placement:"topLeft",overlayInnerStyle:{"padding-right":"2px"}},{content:o(()=>[s("div",Jt,[(_(!0),h(I,null,J(n.similar_questions,($,b)=>(_(),h("div",{class:"similar-question-list-item",key:b},d($),1))),128))])]),title:o(()=>[s("span",null,"共 "+d(n.similar_questions.length)+" 个相似问法",1)]),default:o(()=>[s("a",null,"（"+d(n.similar_questions.length)+"）",1)]),_:2},1024)):K("",!0)])]),s("div",Ht,[u[1]||(u[1]=s("div",{class:"list-label"},"答案",-1)),s("div",Wt,d(n.answer),1)]),ct((_(),h("div",Xt,[(_(!0),h(I,null,J(n.images,($,b)=>(_(),h("img",{key:b,src:$,alt:""},null,8,Zt))),128))])),[[m]])])]),_:1}),e(p,{title:"是否导入知识库",key:"is_import","data-index":"is_import",width:180},{default:o(({record:n})=>[n.is_import==1?(_(),h("div",Gt,[e(f(lt)),u[2]||(u[2]=c("已导入 "))])):K("",!0),n.is_import==0?(_(),h("div",Yt,[e(f(V)),u[3]||(u[3]=c("未导入 "))])):K("",!0),s("div",null,[s("a",{href:`/#/library/details/knowledge-document?id=${n.library_id}`,target:"_blank"},d(n.library_name),9,te)])]),_:1}),e(p,{title:"操作",key:"action","data-index":"action",width:120},{default:o(({record:n,index:$})=>[s("div",ee,[s("div",{class:"hover-btn-box",onClick:H(b=>S(n),["stop"])},[e(f(bt))],8,oe),s("div",{class:"hover-btn-box",onClick:H(b=>q(n.id),["stop"])},[e(f(yt))],8,se)])]),_:1})]),_:1},8,["data-source","row-selection","loading"])])}}},ie=Q(ne,[["__scopeId","data-v-5c44c0f0"]]),ae={class:"form-box"},le={class:"upload-box-wrapper"},re={key:0},pe={__name:"edit-subsection",emits:["ok"],setup(L,{expose:F,emit:R}){const w=R,k=v(!1),g=v("1"),x=W.useForm,l=M({images:[],question:"",answer:"",id:""}),S=M({question:[{required:!0,message:"请输入分段问题",trigger:"change"}],answer:[{required:!0,message:"请输入分段答案",trigger:"change"}]}),{validate:q,validateInfos:r}=x(l,S),u=()=>{q().then(()=>{O()}).catch(p=>{})},O=()=>{let p={...l},i=new FormData;for(let m in p)$t.isArray(p[m])?p[m].forEach(n=>{i.append(m,n)}):i.append(m,p[m]);pt(i).then(m=>{E.success("编辑成功"),k.value=!1,w("ok")})};return F({show:p=>{l.question=p.question,l.answer=p.answer,l.id=p.id,l.title=p.title,l.images=p.images||[],k.value=!0}}),ft(()=>{}),(p,i)=>{const m=Dt,n=qt,$=rt,b=Ft,U=Ot,z=W,a=P;return _(),N(a,{open:k.value,"onUpdate:open":i[4]||(i[4]=t=>k.value=t),onOk:u,title:"编辑分段",wrapClassName:"no-padding-modal",bodyStyle:{"max-height":"670px","overflow-y":"auto","padding-right":"12px"},width:944},{default:o(()=>[s("div",ae,[e(z,{layout:"vertical"},{default:o(()=>[e(n,B({ref:"question",label:"分段问题"},f(r).question),{default:o(()=>[e(m,{placeholder:"请输入分段问题",value:l.question,"onUpdate:value":i[0]||(i[0]=t=>l.question=t),style:{height:"100px"}},null,8,["value"])]),_:1},16),e(n,B({ref:"answer",label:"分段答案"},f(r).answer),{default:o(()=>[e(m,{placeholder:"请输入分段问题",value:l.answer,"onUpdate:value":i[1]||(i[1]=t=>l.answer=t),style:{height:"100px"}},null,8,["value"])]),_:1},16),e(n,B({label:"附件"},f(r).images),{default:o(()=>[s("div",le,[e(U,{activeKey:g.value,"onUpdate:activeKey":i[2]||(i[2]=t=>g.value=t),size:"small"},{default:o(()=>[e(b,{key:"1"},{tab:o(()=>[s("span",null,[e($,{name:"img-icon",style:{"font-size":"14px",color:"#2475fc"}}),i[5]||(i[5]=c(" 图片 ")),l.images.length?(_(),h("span",re,"("+d(l.images.length)+")",1)):K("",!0)])]),_:1})]),_:1},8,["activeKey"]),e(Ct,{value:l.images,"onUpdate:value":i[3]||(i[3]=t=>l.images=t)},null,8,["value"])])]),_:1},16)]),_:1})])]),_:1},8,["open"])}}},ue=Q(pe,[["__scopeId","data-v-da7576bf"]]),me={class:"main-content-box"},_e={class:"breadcrumb-block"},de={class:"btn-wrapper-box"},ce={class:"content-block"},fe={class:"pagination-box"},ge={__name:"index",setup(L){const F=ut(),w=gt().query,k=w.file_name,g=v(""),x=v(null),l=v(0),S=v(!1),q=v([]),r=v({page:1,size:100}),u=v(null),O=a=>{u.value.show(JSON.parse(JSON.stringify(a)))},D=(a,t)=>{r.value.page=a,r.value.size=t,i()},p=()=>{r.value.page=1,i()},i=()=>{S.value=!0,_t({...r.value,id:w.id,is_import:g.value}).then(a=>{let t=a.data.list||[];t.forEach(C=>{C.images&&(C.images=JSON.parse(C.images))}),q.value=t,l.value=a.data.total,z(a.data.total,a.data.import_total),x.value.resetSelect()}).finally(()=>{S.value=!1})};i();const m=v(null),n=()=>{let a=x.value.state.selectedRowKeys;if(a.length==0)return E.error("请选择你要导入的问答");m.value.show({id:w.id,ids:a.join(",")})},$=()=>{let a=x.value.state.selectedRowKeys;if(a.length==0)return E.error("请选择你要删除的问答");P.confirm({title:"提示",icon:e(Z),content:"确认是否删除选中的分段?",onOk(){X({ids:a.join(",")}).then(t=>{E.success("删除成功"),i()})},onCancel(){}})},b=a=>{let t=F.getToken,C=`/manage/exportFAQFileAllQA?id=${w.id}&token=${t}&ext=${a}`;window.location.href=C},U=v([]),z=(a,t)=>{U.value=[{value:"",payload:{num:a,title:"全部"}},{value:0,payload:{num:a-t,title:"未导入"}},{value:1,payload:{num:t,title:"已导入"}}]};return(a,t)=>{const C=vt("router-link"),T=Rt,G=Lt,Y=Nt,A=mt,j=Mt,tt=Bt,et=zt,ot=It,st=kt,nt=it;return _(),h(I,null,[s("div",me,[e(nt,{style:{"padding-right":"48px"},scrollbar:{minSize:80,fade:!1,interactive:!0,scrollbarTrackClickable:!0}},{default:o(()=>[s("div",_e,[e(G,null,{default:o(()=>[e(T,null,{default:o(()=>[e(C,{to:"/ai-extract-faq/list"},{default:o(()=>[e(f(Ut)),t[5]||(t[5]=c(" 文档提取FAQ "))]),_:1,__:[5]})]),_:1}),e(T,null,{default:o(()=>[c(d(f(k)),1)]),_:1})]),_:1})]),e(at,{class:"mb16",title:"使用说明"},{default:o(()=>t[6]||(t[6]=[s("div",null,[s("p",null," 您可以查看、编辑提取处的问答对，并直接将问答对导入到知识库中。您也可以将知识库下载成文档，批量导入导问答知识库中。 ")],-1)])),_:1,__:[6]}),s("div",de,[e(Y,{onChange:p,value:g.value,"onUpdate:value":t[0]||(t[0]=y=>g.value=y),options:U.value},{label:o(({payload:y={}})=>[s("div",null,d(y.title)+"（"+d(y.num)+"）",1)]),_:1},8,["value","options"]),e(ot,{gap:8},{default:o(()=>[e(A,{onClick:n,type:"primary",icon:e(f(Kt))},{default:o(()=>t[7]||(t[7]=[c("导入知识库")])),_:1,__:[7]},8,["icon"]),e(A,{onClick:$},{default:o(()=>t[8]||(t[8]=[c("批量删除")])),_:1,__:[8]}),e(et,null,{overlay:o(()=>[e(tt,null,{default:o(()=>[e(j,{onClick:t[1]||(t[1]=y=>b("docx")),key:"1"},{default:o(()=>t[9]||(t[9]=[c("下载为docx")])),_:1,__:[9]}),e(j,{onClick:t[2]||(t[2]=y=>b("xlsx")),key:"2"},{default:o(()=>t[10]||(t[10]=[c("下载为xlsx")])),_:1,__:[10]})]),_:1})]),default:o(()=>[e(A,{type:"primary"},{default:o(()=>[t[11]||(t[11]=c(" 下载 ")),e(f(At))]),_:1,__:[11]})]),_:1})]),_:1})]),s("div",ce,[e(ie,{ref_key:"subsectionBoxRef",ref:x,total:l.value,isLoading:S.value,paragraphLists:q.value,onOpenEditSubscription:O,onHandleDelParagraph:i},null,8,["total","isLoading","paragraphLists"]),s("div",fe,[e(st,{current:r.value.page,"onUpdate:current":t[3]||(t[3]=y=>r.value.page=y),"page-size":r.value.size,"onUpdate:pageSize":t[4]||(t[4]=y=>r.value.size=y),total:l.value,pageSizeOptions:["100","200","500","1000"],"show-size-changer":"",onChange:D},null,8,["current","page-size","total"])])])]),_:1})]),e(ue,{ref_key:"editSubscriptionRef",ref:u,onOk:i},null,512),e(Et,{ref_key:"importKnowledgeModalRef",ref:m,onOk:p},null,512)],64)}}},No=Q(ge,[["__scopeId","data-v-f8f8a40f"]]);export{No as default};
