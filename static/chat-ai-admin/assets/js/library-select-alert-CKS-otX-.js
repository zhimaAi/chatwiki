import{_ as Z}from"./cu-scroll-CeyRYmkN.js";import{b as ee,F as te,ay as se}from"../../index-ZzVqUZIR.js";import{u as ae}from"./robot-No_anTgb.js";import{k as oe,I as le,X as ne,B as ie,av as ce,p as re,ax as de,ay as ue,ah as pe,E as _e,N as ve,M as he,a as fe}from"./ui-antd-BJtyvQX6.js";import{r as ge,f as d,e as ye,a1 as k,_ as i,a2 as l,a5 as t,k as o,u as p,G as S,ad as x,Y as _,ae as me,F as B,a9 as G,a7 as f}from"./vue-chunks-yZ4gwLzA.js";const be={class:"library-checkbox-box"},ke={class:"list-tools"},xe={class:"list-group-box"},Le={key:0,class:"group-head-box"},Ce={class:"classify-box"},we=["onClick"],Se={class:"classify-title"},Be={class:"right-content"},Ge={style:{flex:"1",overflow:"hidden"}},Ie={class:"list-box",ref:"scrollContainer"},Ne={class:"library-name"},Oe={class:"library-desc"},Re={__name:"library-select-alert",props:{showWxType:{type:Boolean,default:!1}},emits:["change"],setup(I,{expose:N,emit:O}){const R=ae(),{robotInfo:V}=R,A=O,E=I,c=ge({indeterminate:!1,checkAll:!1,checkedList:[]}),u=d("");let L="library-list-hide-group-key";const r=d(localStorage.getItem(L)==1),F=()=>{r.value=!r.value,localStorage.setItem(L,r.value?1:0)},C=d([]),T=()=>{se().then(a=>{let e=a.data||[],n=0;e.forEach(b=>{n+=+b.total}),C.value=[{group_name:"全部",total:n,id:""},...e]})},H=a=>{u.value=a.id,h()},v=d(!1),K=a=>{u.value="",h(),T(),c.checkedList=a,v.value=!0},M=()=>{v.value=!1,$()},g=d(""),U=()=>{h()},y=d([]),W=ye(()=>E.showWxType?y.value:y.value.filter(a=>a.type!=3)),$=()=>{A("change",[...c.checkedList])},h=async()=>{const a=await te({library_name:g.value,type:"",show_open_docs:1});if(a){let e=a.data||[];u.value!=""&&(e=e.filter(n=>n.group_id==u.value)),y.value=e}},z=a=>{let e=a.target.value;c.checkedList.includes(e)?c.checkedList=c.checkedList.filter(n=>n!=e):c.checkedList.push(e)},m=d(!1),D=async()=>{m.value=!0,await h(),m.value=!1,fe.success("刷新完成")},X=()=>{window.open("/#/library/list")};return N({open:K}),(a,e)=>{const n=oe,b=le,w=ie,Y=Z,j=re,q=ve,J=_e,P=pe,Q=he;return i(),k(Q,{width:"946px",open:v.value,"onUpdate:open":e[1]||(e[1]=s=>v.value=s),title:"关联知识库",onOk:M},{default:l(()=>[t("div",be,[o(n,{message:"请选择关联知识库，机器人会根据知识库内上传的文档回复用户的提问。每个机器人最多关联5个知识库",type:"info"}),t("div",ke,[t("div",null,[o(b,{style:{width:"282px"},value:g.value,"onUpdate:value":e[0]||(e[0]=s=>g.value=s),placeholder:"请输入知识库名称搜索",onChange:U},{suffix:l(()=>[o(p(ne),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),t("div",null,[o(w,{style:{"margin-right":"8px"},onClick:D},{default:l(()=>[o(p(ce)),e[2]||(e[2]=S(" 刷新 ",-1))]),_:1}),o(w,{type:"primary",ghost:"",onClick:X},{default:l(()=>[...e[3]||(e[3]=[S("新建知识库",-1)])]),_:1})])]),t("div",xe,[t("div",{class:x(["group-list-box",{"hide-group":r.value}])},[o(Y,{style:{"padding-right":"16px"}},{default:l(()=>[r.value?me("",!0):(i(),_("div",Le,[...e[4]||(e[4]=[t("div",{class:"head-title"},[t("div",null,"知识库分组")],-1)])])),t("div",Ce,[(i(!0),_(B,null,G(C.value,s=>(i(),_("div",{class:x(["classify-item",{active:s.id==u.value}]),onClick:Ve=>H(s),key:s.id},[t("div",Se,f(s.group_name),1),t("div",Be,[t("div",{class:x(["num",{"num-block":s.id<=0}])},f(s.total),3)])],10,we))),128))])]),_:1}),o(j,{placement:"right",title:r.value?"展开分组":"收起分组"},{default:l(()=>[t("div",{class:"hide-group-box",onClick:F},[r.value?(i(),k(p(ue),{key:1})):(i(),k(p(de),{key:0}))])]),_:1},8,["title"])],2),t("div",Ge,[o(P,{spinning:m.value,delay:100},{default:l(()=>[o(J,{value:c.checkedList,style:{width:"100%"}},{default:l(()=>[t("div",Ie,[(i(!0),_(B,null,G(W.value,s=>(i(),_("div",{class:"list-item-wraapper",key:s.id},[o(q,{class:"list-item",value:s.id,onChange:z,disabled:p(V).default_library_id==s.id},{default:l(()=>[t("div",Ne,f(s.library_name),1),t("div",Oe,f(s.library_intro),1)]),_:2},1032,["value","disabled"])]))),128))],512)]),_:1},8,["value"])]),_:1},8,["spinning"])])])])]),_:1},8,["open"])}}},Ke=ee(Re,[["__scopeId","data-v-9ea21e50"]]);export{Ke as L};
