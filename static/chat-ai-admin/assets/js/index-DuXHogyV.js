import{_ as J}from"./cu-scroll-CeyRYmkN.js";import{s as W,g as V,a as j,b as A,d as D}from"./index-BT8AeJHF.js";import{f as v,Y as c,_ as n,k as _,a2 as i,a5 as s,G as y,ae as $,F as N,a9 as U,B as q,a7 as b,ab as E,r as F,u as G,a1 as L}from"./vue-chunks-yZ4gwLzA.js";import{b as R}from"../../index-ZzVqUZIR.js";import{W as H,q as P,R as Q,N as Y,M as T,a as z,a2 as K,B as X,x as Z,p as ee,H as te,J as oe,O as se}from"./ui-antd-BJtyvQX6.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./utils-smNh_pj2.js";const ae={class:"form-modal-box"},ne={class:"form-item"},le={class:"form-content"},ie={class:"form-item"},de={class:"form-content"},_e={key:0,class:"robot-list"},ce={class:"robot-name-text"},re={__name:"add-sensitive-modal",props:{robotList:{type:Array,default:()=>[]}},emits:["ok"],setup(I,{expose:O,emit:u}){const B=u,k=I,x=v(!1),M=v("添加敏感词"),w=v(""),m=v(""),p=v(0),r=v([]),t=o=>{x.value=!0,w.value=o.id||"",m.value=o.words||"",p.value=+o.trigger_type||0,r.value=o.robot_ids||[]},d=o=>{r.value.includes(o.id)?r.value=r.value.filter(e=>e!==o.id):r.value.push(o.id)},h=()=>{if(!m.value)return z.error("请输入敏感词");if(p.value==1&&r.value.length==0)return z.error("请选择机器人");W({id:w.value,words:m.value,trigger_type:p.value,robot_ids:r.value.join(",")}).then(o=>{z.success(w.value?"修改成功":"添加成功"),x.value=!1,B("ok")})};return O({show:t}),(o,e)=>{const S=H,C=Q,f=P,g=Y,a=T;return n(),c("div",null,[_(a,{open:x.value,"onUpdate:open":e[2]||(e[2]=l=>x.value=l),title:M.value,onOk:h,width:620},{default:i(()=>[s("div",ae,[s("div",ne,[e[3]||(e[3]=s("div",{class:"form-label"},[y("敏感词"),s("span",null,"(一行一个，最多1000个敏感词)")],-1)),s("div",le,[_(S,{value:m.value,"onUpdate:value":e[0]||(e[0]=l=>m.value=l),placeholder:"请输入敏感词",style:{height:"160px"}},null,8,["value"])])]),s("div",ie,[e[6]||(e[6]=s("div",{class:"form-label"},"生效机器人",-1)),s("div",de,[_(f,{value:p.value,"onUpdate:value":e[1]||(e[1]=l=>p.value=l)},{default:i(()=>[_(C,{value:0},{default:i(()=>[...e[4]||(e[4]=[y("所有机器人",-1)])]),_:1}),_(C,{value:1},{default:i(()=>[...e[5]||(e[5]=[y("指定机器人",-1)])]),_:1})]),_:1},8,["value"]),p.value==1?(n(),c("div",_e,[(n(!0),c(N,null,U(k.robotList,l=>(n(),c("div",{class:"checked-item",key:l.id},[_(g,{onClick:q($e=>d(l),["stop"]),checked:r.value.includes(l.id)},{default:i(()=>[s("div",ce,b(l.robot_name),1)]),_:2},1032,["onClick","checked"])]))),128))])):$("",!0)])])])]),_:1},8,["open","title"])])}}},ue=R(re,[["__scopeId","data-v-24f596c8"]]),pe={class:"user-model-page"},ve={class:"page-title"},me={class:"add-block"},ke={class:"list-wrapper"},he={class:"content-box"},fe={class:"text-over-box"},ge={key:1,class:"text-over-box"},be={key:0},ye={class:"text-over-box"},xe={key:1,class:"text-over-box"},we=["onClick"],Ce=["onClick"],Se={__name:"index",setup(I){E().query;const O=v([]),u=F({page:1,size:20,total:0}),B=t=>{u.page=t.current,u.size=t.pageSize,k()},k=()=>{j({...u}).then(t=>{let d=t.data.list||[];O.value=d.map(h=>{let o=JSON.parse(h.robot_data),e=o.map(f=>f.robot_name).join(";"),S=o.map(f=>f.id),C=h.words.split(`
`).join("；");return{...h,robot_data:o,robot_name_desc:e,robot_ids:S,words_desc:C}}),u.total=t.data.total})};k();const x=t=>{A({id:t.id}).then(d=>{k()})},M=t=>{T.confirm({title:"删除确认",icon:_(se),content:`确定要删除敏感词[${t.words_desc}]吗？`,okText:"删除",okType:"danger",cancelText:"取消",onOk(){D({id:t.id}).then(d=>{z.success("删除成功"),k()})},onCancel(){}})},w=v(null),m=(t={})=>{w.value.show(JSON.parse(JSON.stringify(t)))},p=v([]);V().then(t=>{p.value=t.data||[]});const r=[{title:"敏感词",dataIndex:"words_desc",key:"words_desc",ellipsis:!0,width:300},{title:"生效机器人",dataIndex:"robot_name_desc",key:"robot_name_desc",ellipsis:!0,width:300},{title:"是否启用",key:"status",dataIndex:"status",width:150},{title:"操作",key:"action",width:120}];return(t,d)=>{const h=X,o=ee,e=te,S=oe,C=Z,f=J;return n(),c("div",pe,[s("div",ve,[d[2]||(d[2]=y(" 敏感词管理 ",-1)),s("div",me,[_(h,{type:"primary",onClick:d[0]||(d[0]=g=>m()),icon:_(G(K))},{default:i(()=>[...d[1]||(d[1]=[y("添加敏感词",-1)])]),_:1},8,["icon"])])]),s("div",ke,[_(f,null,{default:i(()=>[s("div",he,[_(C,{columns:r,"data-source":O.value,pagination:{current:u.page,total:u.total,pageSize:u.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:B},{bodyCell:i(({column:g,record:a})=>[g.key==="words_desc"?(n(),c(N,{key:0},[a.words_desc.length>20?(n(),L(o,{key:0,overlayStyle:{"max-width":"500px"}},{title:i(()=>[y(b(a.words_desc),1)]),default:i(()=>[s("div",fe,b(a.words_desc),1)]),_:2},1024)):(n(),c("div",ge,b(a.words_desc),1))],64)):$("",!0),g.key==="robot_name_desc"?(n(),c(N,{key:1},[a.trigger_type==0?(n(),c("div",be,"所有机器人")):(n(),c(N,{key:1},[a.robot_name_desc.length>20?(n(),L(o,{key:0,overlayStyle:{"max-width":"500px"}},{title:i(()=>[y(b(a.robot_name_desc),1)]),default:i(()=>[s("div",ye,b(a.robot_name_desc),1)]),_:2},1024)):(n(),c("div",xe,b(a.robot_name_desc),1))],64))],64)):$("",!0),g.key==="status"?(n(),L(e,{key:2,onChange:l=>x(a),checked:a.status==1,"checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked"])):$("",!0),g.key==="action"?(n(),L(S,{key:3,gap:12,style:{"white-space":"nowrap"}},{default:i(()=>[s("a",{onClick:l=>m(a)},"编辑",8,we),s("a",{onClick:l=>M(a)},"删除",8,Ce)]),_:2},1024)):$("",!0)]),_:1},8,["data-source","pagination"])])]),_:1}),_(ue,{onOk:k,robotList:p.value,ref_key:"addaddSensitiveModalRef",ref:w},null,8,["robotList"])])])}}},Te=R(Se,[["__scopeId","data-v-f3afdccf"]]);export{Te as default};
