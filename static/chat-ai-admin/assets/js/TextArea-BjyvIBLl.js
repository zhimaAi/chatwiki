import{v as Se,bn as T,P as we,bm as Ce,bg as ae,N as O,bs as ze,cj as N,cG as Ae,y as ie,t as z,q as B,G as Ie,J as Re}from"../../index-D5kWFI_D.js";import{F as re,u as $e}from"./FormItemContext-FSdunmL7.js";import{a as ue,g as de,B as Ee,u as Te}from"./index-DhRq8W09.js";import{e as Q,j as R,d as _,o as ne,h as ce,b as k,w as J,f as fe,s as V,x as le}from"./vue-chunks-BRsu9_To.js";import{R as _e}from"./index-Dl5gOyIo.js";import{d as ve,t as Fe,r as K,f as Ve}from"./inputProps-BEjYvl-5.js";const oe=e=>e!=null&&(Array.isArray(e)?Se(e).length:!0);function Be(e){return oe(e.addonBefore)||oe(e.addonAfter)}const Pe=["text","input"],je=Q({compatConfig:{MODE:3},name:"ClearableLabeledInput",inheritAttrs:!1,props:{prefixCls:String,inputType:we.oneOf(Ce("text","input")),value:T(),defaultValue:T(),allowClear:{type:Boolean,default:void 0},element:T(),handleReset:Function,disabled:{type:Boolean,default:void 0},direction:{type:String},size:{type:String},suffix:T(),prefix:T(),addonBefore:T(),addonAfter:T(),readonly:{type:Boolean,default:void 0},focused:{type:Boolean,default:void 0},bordered:{type:Boolean,default:!0},triggerFocus:{type:Function},hidden:Boolean,status:String,hashId:String},setup(e,g){let{slots:o,attrs:r}=g;const u=re.useInject(),x=a=>{const{value:c,disabled:n,readonly:f,handleReset:s,suffix:i=o.suffix}=e,m=!n&&!f&&c,b=`${a}-clear-icon`;return R(ze,{onClick:s,onMousedown:A=>A.preventDefault(),class:O({[`${b}-hidden`]:!m,[`${b}-has-suffix`]:!!i},b),role:"button"},null)},h=(a,c)=>{const{value:n,allowClear:f,direction:s,bordered:i,hidden:m,status:b,addonAfter:A=o.addonAfter,addonBefore:$=o.addonBefore,hashId:E}=e,{status:S,hasFeedback:I}=u;if(!f)return ae(c,{value:n,disabled:e.disabled});const F=O(`${a}-affix-wrapper`,`${a}-affix-wrapper-textarea-with-clear-btn`,ue(`${a}-affix-wrapper`,de(S,b),I),{[`${a}-affix-wrapper-rtl`]:s==="rtl",[`${a}-affix-wrapper-borderless`]:!i,[`${r.class}`]:!Be({addonAfter:A,addonBefore:$})&&r.class},E);return R("span",{class:F,style:r.style,hidden:m},[ae(c,{style:null,value:n,disabled:e.disabled}),x(a)])};return()=>{var a;const{prefixCls:c,inputType:n,element:f=(a=o.element)===null||a===void 0?void 0:a.call(o)}=e;return n===Pe[0]?h(c,f):null}}}),Me=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,ke=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],U={};let y;function De(e){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const o=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(g&&U[o])return U[o];const r=window.getComputedStyle(e),u=r.getPropertyValue("box-sizing")||r.getPropertyValue("-moz-box-sizing")||r.getPropertyValue("-webkit-box-sizing"),x=parseFloat(r.getPropertyValue("padding-bottom"))+parseFloat(r.getPropertyValue("padding-top")),h=parseFloat(r.getPropertyValue("border-bottom-width"))+parseFloat(r.getPropertyValue("border-top-width")),c={sizingStyle:ke.map(n=>`${n}:${r.getPropertyValue(n)}`).join(";"),paddingSize:x,borderSize:h,boxSizing:u};return g&&o&&(U[o]=c),c}function He(e){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;y||(y=document.createElement("textarea"),y.setAttribute("tab-index","-1"),y.setAttribute("aria-hidden","true"),document.body.appendChild(y)),e.getAttribute("wrap")?y.setAttribute("wrap",e.getAttribute("wrap")):y.removeAttribute("wrap");const{paddingSize:u,borderSize:x,boxSizing:h,sizingStyle:a}=De(e,g);y.setAttribute("style",`${a};${Me}`),y.value=e.value||e.placeholder||"";let c,n,f,s=y.scrollHeight;if(h==="border-box"?s+=x:h==="content-box"&&(s-=u),o!==null||r!==null){y.value=" ";const m=y.scrollHeight-u;o!==null&&(c=m*o,h==="border-box"&&(c=c+u+x),s=Math.max(c,s)),r!==null&&(n=m*r,h==="border-box"&&(n=n+u+x),f=s>n?"":"hidden",s=Math.min(n,s))}const i={height:`${s}px`,overflowY:f,resize:"none"};return c&&(i.minHeight=`${c}px`),n&&(i.maxHeight=`${n}px`),i}const W=0,X=1,q=2,Le=Q({compatConfig:{MODE:3},name:"ResizableTextArea",inheritAttrs:!1,props:ve(),setup(e,g){let{attrs:o,emit:r,expose:u}=g,x,h;const a=_(),c=_({}),n=_(q);ne(()=>{N.cancel(x),N.cancel(h)});const f=()=>{try{if(a.value&&document.activeElement===a.value.input){const d=a.value.getSelectionStart(),j=a.value.getSelectionEnd(),M=a.value.getScrollTop();a.value.setSelectionRange(d,j),a.value.setScrollTop(M)}}catch{}},s=_(),i=_();ce(()=>{const d=e.autoSize||e.autosize;d?(s.value=d.minRows,i.value=d.maxRows):(s.value=void 0,i.value=void 0)});const m=k(()=>!!(e.autoSize||e.autosize)),b=()=>{n.value=W};J([()=>e.value,s,i,m],()=>{m.value&&b()},{immediate:!0});const A=_();J([n,a],()=>{if(a.value)if(n.value===W)n.value=X;else if(n.value===X){const d=He(a.value.input,!1,s.value,i.value);n.value=q,A.value=d}else f()},{immediate:!0,flush:"post"});const $=fe(),E=_(),S=()=>{N.cancel(E.value)},I=d=>{n.value===q&&(r("resize",d),m.value&&(S(),E.value=N(()=>{b()})))};ne(()=>{S()}),u({resizeTextarea:()=>{b()},textArea:k(()=>{var d;return(d=a.value)===null||d===void 0?void 0:d.input}),instance:$}),Ae(e.autosize===void 0);const P=()=>{const{prefixCls:d,disabled:j}=e,M=ie(e,["prefixCls","onPressEnter","autoSize","autosize","defaultValue","allowClear","type","maxlength","valueModifiers"]),G=O(d,o.class,{[`${d}-disabled`]:j}),D=m.value?A.value:null,H=[o.style,c.value,D],C=z(z(z({},M),o),{style:H,class:G});return(n.value===W||n.value===X)&&H.push({overflowX:"hidden",overflowY:"hidden"}),C.autofocus||delete C.autofocus,C.rows===0&&delete C.rows,R(_e,{onResize:I,disabled:!m.value},{default:()=>[R(Ee,B(B({},C),{},{ref:a,tag:"textarea"}),null)]})};return()=>P()}});function ge(e,g){return[...e||""].slice(0,g).join("")}function se(e,g,o,r){let u=o;return e?u=ge(o,r):[...g||""].length<o.length&&[...o||""].length>r&&(u=g),u}const Ue=Q({compatConfig:{MODE:3},name:"ATextarea",inheritAttrs:!1,props:ve(),setup(e,g){let{attrs:o,expose:r,emit:u}=g;var x;const h=$e(),a=re.useInject(),c=k(()=>de(a.status,e.status)),n=V((x=e.value)!==null&&x!==void 0?x:e.defaultValue),f=V(),s=V(""),{prefixCls:i,size:m,direction:b}=Ie("input",e),[A,$]=Te(i),E=Re(),S=k(()=>e.showCount===""||e.showCount||!1),I=k(()=>Number(e.maxlength)>0),F=V(!1),P=V(),d=V(0),j=t=>{F.value=!0,P.value=s.value,d.value=t.currentTarget.selectionStart,u("compositionstart",t)},M=t=>{var l;F.value=!1;let v=t.currentTarget.value;if(I.value){const w=d.value>=e.maxlength+1||d.value===((l=P.value)===null||l===void 0?void 0:l.length);v=se(w,P.value,v,e.maxlength)}v!==s.value&&(C(v),K(t.currentTarget,t,Y,v)),u("compositionend",t)},G=fe();J(()=>e.value,()=>{var t;"value"in G.vnode.props,n.value=(t=e.value)!==null&&t!==void 0?t:""});const D=t=>{var l;Fe((l=f.value)===null||l===void 0?void 0:l.textArea,t)},H=()=>{var t,l;(l=(t=f.value)===null||t===void 0?void 0:t.textArea)===null||l===void 0||l.blur()},C=(t,l)=>{n.value!==t&&(e.value===void 0?n.value=t:le(()=>{var v,w,p;f.value.textArea.value!==s.value&&((p=(v=f.value)===null||v===void 0?void 0:(w=v.instance).update)===null||p===void 0||p.call(w))}),le(()=>{l&&l()}))},me=t=>{t.keyCode===13&&u("pressEnter",t),u("keydown",t)},he=t=>{const{onBlur:l}=e;l==null||l(t),h.onFieldBlur()},Y=t=>{u("update:value",t.target.value),u("change",t),u("input",t),h.onFieldChange()},xe=t=>{K(f.value.textArea,t,Y),C("",()=>{D()})},ee=t=>{let l=t.target.value;if(n.value!==l){if(I.value){const v=t.target,w=v.selectionStart>=e.maxlength+1||v.selectionStart===l.length||!v.selectionStart;l=se(w,s.value,l,e.maxlength)}K(t.currentTarget,t,Y,l),C(l)}},be=()=>{var t,l;const{class:v}=o,{bordered:w=!0}=e,p=z(z(z({},ie(e,["allowClear"])),o),{class:[{[`${i.value}-borderless`]:!w,[`${v}`]:v&&!S.value,[`${i.value}-sm`]:m.value==="small",[`${i.value}-lg`]:m.value==="large"},ue(i.value,c.value),$.value],disabled:E.value,showCount:null,prefixCls:i.value,onInput:ee,onChange:ee,onBlur:he,onKeydown:me,onCompositionstart:j,onCompositionend:M});return!((t=e.valueModifiers)===null||t===void 0)&&t.lazy&&delete p.onInput,R(Le,B(B({},p),{},{id:(l=p==null?void 0:p.id)!==null&&l!==void 0?l:h.id.value,ref:f,maxlength:e.maxlength,lazy:e.lazy}),null)};return r({focus:D,blur:H,resizableTextArea:f}),ce(()=>{let t=Ve(n.value);!F.value&&I.value&&(e.value===null||e.value===void 0)&&(t=ge(t,e.maxlength)),s.value=t}),()=>{var t;const{maxlength:l,bordered:v=!0,hidden:w}=e,{style:p,class:pe}=o,ye=z(z(z({},e),o),{prefixCls:i.value,inputType:"text",handleReset:xe,direction:b.value,bordered:v,style:S.value?void 0:p,hashId:$.value,disabled:(t=e.disabled)!==null&&t!==void 0?t:E.value});let Z=R(je,B(B({},ye),{},{value:s.value,status:e.status}),{element:be});if(S.value||a.hasFeedback){const te=[...s.value].length;let L="";typeof S.value=="object"?L=S.value.formatter({value:s.value,count:te,maxlength:l}):L=`${te}${I.value?` / ${l}`:""}`,Z=R("div",{hidden:w,class:O(`${i.value}-textarea`,{[`${i.value}-textarea-rtl`]:b.value==="rtl",[`${i.value}-textarea-show-count`]:S.value,[`${i.value}-textarea-in-form-item`]:a.isFormItemInput},`${i.value}-textarea-show-count`,pe,$.value),style:p,"data-count":typeof L!="object"?L:void 0},[Z,a.hasFeedback&&R("span",{class:`${i.value}-textarea-suffix`},[a.feedbackIcon])])}return A(Z)}}});export{Ue as _};
