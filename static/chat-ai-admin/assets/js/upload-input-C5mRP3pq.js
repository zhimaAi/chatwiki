import{u as F}from"../../index-DSFcP5NQ.js";import{_ as L}from"./emoji-mart-BBMRoEa3.js";import{ar as T,as as U,b as i}from"./ui-antd-Dl1wwwCD.js";import{c as N,r as z,w as B,a as d,b as m,y as v,p as s,t as I,u as r,v as p,F as M,l as A,h as D}from"./vue-chunks-BdaA73Wf.js";const E={class:"ant-upload-drag-icon"},R={class:"ant-upload-text"},S={class:"ant-upload-hint"},V={__name:"upload-input",props:{value:{type:Array,default:()=>[]},maxCount:{type:Number,default:1},type:{type:[String,Number],default:0}},emits:["change","update:value"],setup(h,{emit:C}){const{t:o}=F("views.library.add-library.components.upload-input"),f=C,a=h;let n=["pdf","docx","ofd","txt","md","xlsx","csv","html"];a.type==2&&(n=["docx","csv","xlsx"]);const g=N(()=>n.map(e=>`.${e}`).join(",")),t=z([]);B(()=>a.value,e=>{t.value=e},{immediate:!0});let u=null;const b=()=>{if(t.value.length>=a.maxCount)return i.error(o("max_files_error",{maxCount:a.maxCount}))},_=()=>{t.value.length>a.maxCount&&i.error(o("max_files_error",{maxCount:a.maxCount}));let e=[...t.value];f("change",e),f("update:value",e)},y=e=>{k(e),_()},k=e=>{for(let l=0;l<t.value.length;l++)if(t.value[l].uid===e.uid){t.value.splice(l,1);break}},w=e=>{const l=e.name.split(".").pop();return n.includes(l.toLowerCase())?e.size/1024/1024<100?(t.value=[...t.value||[],e],t.value.length>a.maxCount&&(t.value=t.value.splice(0,a.maxCount)),u&&clearTimeout(u),u=setTimeout(()=>{_(),clearTimeout(u)},50),!1):(i.error(o("file_size_error")),!1):(i.error(o("unsupported_format_error")),!1)};return(e,l)=>{const x=U;return m(),d("div",{class:D(["upload-input",{disabled:t.value.length>=a.maxCount}])},[v(x,{"file-list":t.value,name:"file",multiple:!0,"max-count":a.maxCount,accept:g.value,beforeUpload:w,onRemove:y,class:"ant-upload-drag"},{default:I(()=>[s("div",E,[v(r(T))]),s("div",R,p(r(o)("upload_text")),1),s("div",S,[s("p",null,p(r(o)("upload_hint",{maxCount:a.maxCount})),1),s("p",null,[s("span",null,p(r(o)("support_file_types")),1),(m(!0),d(M,null,A(r(n),c=>(m(),d("span",{class:"ant-upload-hint-ext",key:c},"."+p(c),1))),128))])])]),_:1},8,["file-list","max-count","accept"]),s("div",{class:"disabled-mask",onClick:b})],2)}}},q=L(V,[["__scopeId","data-v-b8994e3b"]]);export{q as U};
//# sourceMappingURL=upload-input-C5mRP3pq.js.map
