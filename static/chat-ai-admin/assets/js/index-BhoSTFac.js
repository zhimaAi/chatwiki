import{b as le,d as ie}from"../../index-CPkdGIiL.js";import{f as l,w as ce,o as re,ab as ue,aa as pe,b as de,y as _e,Y as u,ae as L,a5 as n,k as i,F as b,a2 as r,ad as O,a1 as U,a9 as ve,af as me,_ as c,G as p,a7 as z,ah as fe,u as ge}from"./vue-chunks-Ci-XTWEs.js";import{a as V,x as W}from"./index-CPuy80m4.js";import{e as ye}from"./index-Bu5ae_-0.js";import{X as be,ah as ke,B as he,a2 as xe,k as we,M as G,ag as Ce,a3 as Ae,a as F}from"./ui-antd-Bw8cEW5z.js";import"./utils-ChQO-_r6.js";const Se="/assets/img/empty-icon-y2RWoHsC.png",Ie={key:0,class:"ability-banner"},Be={class:"user-model-page"},De={class:"breadcrumb-wrap"},Re={key:0,class:"loading-box"},Te={key:0,class:"empty-box"},Me={class:"mp-list-block"},Ee=["onClick"],Ne=["src"],Le={class:"mp-name"},Oe={class:"tabs-box"},Ue={class:"list-wrapper"},ze={class:"content-wrapper"},Ve={class:"enable-tip-footer"},We={class:"footer-actions"},Ge=160,Fe=8,He=96,H="article_group_send_ai_comment_tip_until",Ke={__name:"index",setup($e){const k=ue(),_=pe(),K=[{label:"群发管理",value:"group-send"},{label:"草稿箱",value:"draft-box"}],D=()=>k.name==="exploreArticleGroupSendDraftBox"?"draft-box":"group-send",R=()=>{_.back()},h=l(D()),f=l(!1),$=()=>{V({ability_type:"official_account_batch_send"}).then(t=>{var o;const e=t.data,s=(o=e==null?void 0:e.user_config)==null?void 0:o.switch_status;f.value=String(s||"0")==="1"})},x=l(!0),Y=()=>{V({ability_type:"official_account_ai_comment"}).then(t=>{var s,o;const e=(o=(s=t==null?void 0:t.data)==null?void 0:s.user_config)==null?void 0:o.switch_status;x.value=String(e||"0")==="1",Q()})},T=()=>{N();const t=_.resolve({path:"/explore/index"});window.open(t.href,"_blank")},j=t=>{const e=t?"1":"0";if(e==="0"){G.confirm({title:"提示",content:"关闭后，该功能默认关闭不再支持使用，确认关闭？",onOk:()=>{W({ability_type:"official_account_batch_send",switch_status:e}).then(s=>{s&&s.res==0&&(f.value=!1,F.success("操作成功"))})}});return}W({ability_type:"official_account_batch_send",switch_status:e}).then(s=>{s&&s.res==0&&(f.value=!0,F.success("操作成功"))})};ce(()=>k.name,()=>{h.value=D()});const q=t=>{const e={"group-send":"/explore/index/article-group-send/group-send","draft-box":"/explore/index/article-group-send/draft-box"};_.replace(e[t])};re(()=>{k.name==="exploreArticleGroupSend"&&_.replace("/explore/index/article-group-send/group-send"),P(),$(),Y()}),de(()=>{window.removeEventListener("resize",I)});const w=l(!0),M=l([]),C=l(""),A=l(""),d=l([]),S=l(""),v=l(!1),E=l(null),m=l(0);function I(){const t=E.value;if(!t){m.value=0;return}const e=t.clientWidth||0,s=Ge+Fe,o=Math.floor((e-He)/s);m.value=Math.max(o,0)}const P=()=>{w.value=!0,ye({app_type:"official_account"}).then(t=>{const e=t.data||[];M.value=e,d.value=e.map(o=>({id:o.id,appid:o.app_id,name:o.app_name,logo:o.app_avatar,access_key:o.access_key}));const s=d.value[0];s&&(S.value=s.appid,C.value=s.appid,A.value=s.access_key)}).finally(()=>{w.value=!1,_e(I),window.addEventListener("resize",I)})};function X(t){S.value=t.appid,v.value=!0,C.value=t.appid,A.value=t.access_key}const J=()=>{const t=_.resolve({path:"/user/official-account"});window.open(t.href,"_blank")},g=l(!1),B=l(!1),Q=()=>{const t=Number(localStorage.getItem(H)||0),e=Date.now();!x.value&&t<=e&&(g.value=!0)},N=()=>{if(B.value){const t=Date.now()+2592e5;localStorage.setItem(H,String(t))}},Z=()=>{N(),g.value=!1};return(t,e)=>{const s=ie,o=be,ee=ke,y=he,te=xe,ne=we,se=me("router-view"),oe=Ce,ae=G;return c(),u(b,null,[x.value?L("",!0):(c(),u("div",Ie,[i(s,{name:"tip-icon",style:{"font-size":"16px",color:"white"}}),e[4]||(e[4]=n("span",null,"AI评论精选功能暂未开启，您可到探索 > 功能 > AI评论精选开启",-1)),n("a",{class:"go-enable",href:"javascript:void(0);",onClick:T},"去开启")])),n("div",Be,[n("div",De,[i(s,{onClick:R,name:"back",style:{"font-size":"20px"}}),n("span",{onClick:R,class:"breadcrumb-title"},"文章群发"),i(o,{checked:f.value,"checked-children":"开","un-checked-children":"关",onChange:j},null,8,["checked"]),e[5]||(e[5]=n("span",{class:"switch-desc"},"开启后，用户可以在文章管理中群发文章给公众号用户，该群发支持使用AI评论精选功能自动删评，回复，精选评论。",-1))]),w.value?(c(),u("div",Re,[i(ee)])):(c(),u(b,{key:1},[M.value.length===0?(c(),u("div",Te,[e[7]||(e[7]=n("img",{src:Se},null,-1)),e[8]||(e[8]=n("div",{class:"title"},"暂未绑定公众号",-1)),i(y,{type:"primary",onClick:J},{default:r(()=>e[6]||(e[6]=[p("去绑定公众号")])),_:1,__:[6]})])):(c(),u(b,{key:1},[n("div",Me,[n("div",{class:O(["mp-list",{expanded:v.value}]),ref_key:"mpListRef",ref:E},[(c(!0),u(b,null,ve(v.value?d.value:d.value.slice(0,m.value),a=>(c(),u("div",{class:O(["mp-card",{selected:a.appid===S.value}]),key:a.id,onClick:Ye=>X(a)},[n("img",{src:a.logo,class:"mp-logo"},null,8,Ne),n("span",Le,z(a.name),1)],10,Ee))),128)),!v.value&&d.value.length>m.value?(c(),U(y,{key:0,type:"dashed",class:"more-btn",onClick:e[0]||(e[0]=a=>v.value=!0)},{default:r(()=>[p(" 更多 +"+z(d.value.length-m.value),1)]),_:1})):L("",!0)],2)]),n("div",Oe,[i(te,{value:h.value,"onUpdate:value":e[1]||(e[1]=a=>h.value=a),options:K,onChange:q},null,8,["value"])]),i(ne,{class:"alert-box",style:{margin:"16px 48px 0"}},{message:r(()=>e[9]||(e[9]=[n("div",null,"1. 本功能仅限认证的公众号。支持同步微信公众后台未发布的草稿箱。",-1),n("div",null,"2. 群发的内容不会显示在文章管理内。请注意群发和已发布的区别。",-1)])),_:1}),n("div",Ue,[n("div",ze,[i(se,null,{default:r(({Component:a})=>[(c(),U(fe(a),{"app-id":C.value,"access-key":A.value},null,8,["app-id","access-key"]))]),_:1})])])],64))],64))]),i(ae,{open:g.value,"onUpdate:open":e[3]||(e[3]=a=>g.value=a),footer:null},{title:r(()=>[n("span",null,[i(ge(Ae),{style:{color:"#faad14","margin-right":"8px"}}),e[10]||(e[10]=p("未开启AI评论精选"))])]),default:r(()=>[e[14]||(e[14]=n("div",null,[n("span",{style:{color:"red"}},"AI评论精选功能暂未开启"),p("，您可到探索 > 功能 > AI评论精选开启")],-1)),n("div",Ve,[i(oe,{checked:B.value,"onUpdate:checked":e[2]||(e[2]=a=>B.value=a)},{default:r(()=>e[11]||(e[11]=[p("3天内不在提示")])),_:1,__:[11]},8,["checked"]),n("div",We,[i(y,{onClick:Z},{default:r(()=>e[12]||(e[12]=[p("取消")])),_:1,__:[12]}),i(y,{type:"primary",onClick:T},{default:r(()=>e[13]||(e[13]=[p("去开启")])),_:1,__:[13]})])])]),_:1,__:[14]},8,["open"])],64)}}},Ze=le(Ke,[["__scopeId","data-v-ef8cff50"]]);export{Ze as default};
