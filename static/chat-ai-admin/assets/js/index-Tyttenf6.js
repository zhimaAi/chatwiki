import{e as p,aa as K,f as U,w as oe,Y as n,a5 as o,F as P,ab as G,a9 as j,_ as a,ae as M,u as y,ac as N,k as e,a7 as f,a2 as l,G as F,a1 as B,af as W,o as Y,b as ae,ag as se,B as ne,r as V,a4 as q,J as re,a3 as le,a6 as z}from"./vue-chunks-DCKTEHpB.js";import{u as ce}from"./global-orsXQkGD.js";import{_ as T,b as E,a as Q,e as X,d as A,c as O,R as ie,r as ue,f as _e}from"../../index-C1Xsov4S.js";import{a as de,L as pe}from"./locale-dropdown-vtxPpzP9.js";import{g as me}from"./index-DLEjqKv8.js";import{D as ve,e as Z,f as ee,g as H,h as te,i as be,j as he,F as J,k as ye,b as fe,c as ge,M as ke,a as we}from"./ui-antd-D64OvTpt.js";import{v as Ce}from"./validate-8MtiUsxW.js";import{u as $e}from"./guide-BNDDG3tF.js";import"./utils-D9NMMoMR.js";const Se={class:"navbar-wrapper"},xe={class:"navbar"},Le=["onClick"],Me={class:"nav-name"},Re={class:"down-icon"},Ie=["onClick"],Pe={class:"nav-name"},Te={__name:"layout-navbar",setup(R){const{t}=E("layout.navbar"),r=Q(),m=j(),c=K(),h=p(()=>c.meta.activeMenu||""),v=p(()=>c.path.split("/")[1]),b=U(localStorage.getItem("local__robot_menu_key")||"robot_detail"),g=p(()=>[{id:0,key:"explore",label:"explore",title:t("explore"),icon:"nav-explore",path:"/explore/index",permission:["AbilityCenter"]},{id:1,key:"robot",label:"robot",title:t("robot"),icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:t("knowledge_base"),icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:t("document"),icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:t("search"),icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:t("session"),icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}]),$=p(()=>r.top_navigate),x=p(()=>$.value.filter(_=>_.open).map(_=>g.value.find(d=>d.key===_.id)).filter(Boolean)),L=u=>{m.push(u.path)},k=(u,_)=>{localStorage.setItem("local__robot_menu_key",u),b.value=u,S(_)},S=u=>{b.value=="robot_detail"?i():L(u)},i=async()=>{try{const{data:u=[]}=await me();if(u.length===0){m.push("/robot/list");return}const _=localStorage.getItem("last_local_robot_id");let d;_&&(d=u.find(s=>s.id==_)),d=d||u[0];const{id:w,robot_key:I,application_type:C}=d;m.push({path:`/robot/config/${C==1?"workflow":"basic-config"}`,query:{id:w,robot_key:I}})}catch{m.push("/robot/list")}};return oe(()=>c.path,()=>{},{immediate:!0}),(u,_)=>{const d=A,w=ee,I=Z,C=te;return a(),n("div",Se,[o("div",xe,[(a(!0),n(P,null,G(x.value,s=>(a(),n(P,{key:s.key},[y(X)(s.permission)?(a(),n(P,{key:0},[s.key==="robot"?(a(),n("div",{key:0,class:N(["nav-menu",{active:s.key===v.value||s.key===h.value}]),onClick:D=>S(s)},[e(d,{class:"nav-icon",name:s.icon},null,8,["name"]),o("span",Me,f(s.title),1),e(C,null,{overlay:l(()=>[e(I,null,{default:l(()=>[e(w,{key:"1",onClick:D=>k("robot_detail",s)},{default:l(()=>[o("div",{class:N(["robot-ment-item",{"robot-active-item":b.value=="robot_detail"}])},[e(y(H),{class:"anticon-check"}),F(" "+f(y(t)("enter_robot_detail")),1)],2)]),_:1},8,["onClick"]),e(w,{key:"2",onClick:D=>k("robot_list",s)},{default:l(()=>[o("div",{class:N(["robot-ment-item",{"robot-active-item":b.value=="robot_list"}])},[e(y(H)),F(" "+f(y(t)("enter_robot_manage")),1)],2)]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[o("div",Re,[e(y(ve))])]),_:2},1024)],10,Le)):(a(),n("div",{key:1,class:N(["nav-menu",{active:s.key===v.value||s.key===h.value}]),onClick:D=>L(s)},[e(d,{class:"nav-icon",name:s.icon},null,8,["name"]),o("span",Pe,f(s.title),1)],10,Ie))],64)):M("",!0)],64))),128))])])}}},Be=T(Te,[["__scopeId","data-v-9aad59da"]]),De={class:"layout-breadcrumb"},Ne={key:1,class:"page-title"},Ue={__name:"layout-breadcrumb",props:{title:{type:[String,Boolean],default:""},items:{type:[Array,Boolean],default:()=>[]}},setup(R){const t=R;return(r,m)=>{const c=W("router-link"),h=he,v=be;return a(),n("div",De,[t.items.length>0?(a(),B(v,{key:0},{default:l(()=>[(a(!0),n(P,null,G(t.items,(b,g)=>(a(),n(P,{key:b.title},[g!==t.items.length-1?(a(),B(h,{key:0},{default:l(()=>[e(c,{to:b.path},{default:l(()=>[F(f(b.title),1)]),_:2},1032,["to"])]),_:2},1024)):(a(),B(h,{key:1},{default:l(()=>[F(f(b.title),1)]),_:2},1024))],64))),128))]),_:1})):(a(),n("div",Ne,f(t.title),1))])}}},Fe=T(Ue,[["__scopeId","data-v-c69a461d"]]),Oe={class:"layout-footer"},Ge={class:"copyright-text"},je={__name:"layout-footer",setup(R){const t=O(),{t:r}=E(),m=U(null);return Y(()=>{m.value=setInterval(()=>{setTimeout(()=>{t.refreshToken()},0)},ie)}),ae(()=>{clearInterval(m.value),m.value=null}),(c,h)=>(a(),n("div",Oe,[o("div",Ge,f(y(r)("common.copyright")),1)]))}},Ee=T(je,[["__scopeId","data-v-ab337acb"]]),Ae={key:0,class:"user-dropdown"},Ve=["src"],qe={class:"user-name"},ze={class:"menu-name"},He=["onClick"],Je={class:"menu-name"},Ke={class:"menu-name"},We={__name:"user-dropdown",setup(R){const{t}=E(),r=Q(),m=j(),c=O(),{userInfo:h,avatar:v,user_name:b}=se(c),g=p(()=>b.value.length>11?b.value.substring(0,11)+"...":b.value),$=()=>{c.logoutConfirm(!0)},x=()=>{window.open("/#/user/model","_blank","noopener")},L=p(()=>[{id:1,key:"robot",label:"robot",title:t("layout.navbar.application"),icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:t("layout.navbar.knowledge_base"),icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:t("layout.navbar.document"),icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:t("layout.navbar.search"),icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:t("layout.navbar.session"),icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}]),k=p(()=>r.top_navigate),S=p(()=>k.value.filter(_=>!_.open).map(_=>L.value.find(d=>d.key===_.id)).filter(Boolean)),i=u=>{m.push(u.path)};return(u,_)=>{const d=A,w=ee,I=Z,C=te;return y(h)?(a(),n("div",Ae,[e(C,null,{overlay:l(()=>[e(I,null,{default:l(()=>[e(w,null,{default:l(()=>[o("a",{class:"menu-item",href:"javascript:;",onClick:x},[e(d,{class:"menu-icon",name:"system-setting"}),o("span",ze,f(y(t)("layout.navbar.system_manage")),1)])]),_:1}),(a(!0),n(P,null,G(S.value,s=>(a(),n(P,{key:s.id},[y(X)(s.permission)?(a(),B(w,{key:0},{default:l(()=>[o("a",{class:"menu-item",href:"javascript:;",onClick:D=>i(s)},[e(d,{class:"menu-icon",name:s.icon},null,8,["name"]),o("span",Je,f(s.title),1)],8,He)]),_:2},1024)):M("",!0)],64))),128)),e(w,null,{default:l(()=>[e(de)]),_:1}),e(w,null,{default:l(()=>[o("a",{class:"menu-item",href:"javascript:;",onClick:$},[e(d,{class:"menu-icon",name:"logout"}),o("span",Ke,f(y(t)("layout.navbar.logout")),1)])]),_:1})]),_:1})]),default:l(()=>[o("div",{class:"user-dropdown-link",onClick:_[0]||(_[0]=ne(()=>{},["prevent"]))},[o("img",{class:"user-avatar",src:y(v),alt:""},null,8,Ve),o("span",qe,f(g.value),1),e(d,{name:"arrow-down",style:{"font-size":"16px",color:"#8c8c8c"}})])]),_:1})])):M("",!0)}}},Ye=T(We,[["__scopeId","data-v-03d7d650"]]),Qe={class:"form-box"},Xe={__name:"reset-password",setup(R,{expose:t}){const r=O(),m=J.useForm,c=U(!0),h=U("重置登录密码"),v=V({password:"",check_password:"",id:r.userInfo.user_id}),b=V({password:[{message:"请输入登录密码",required:!0},{validator:async(S,i)=>!Ce(i)&&i?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(S,i)=>i!=v.password&&i?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:g,validate:$,validateInfos:x}=m(v,b),L=()=>{$().then(()=>{ue({...re(v)}).then(S=>{we.success("修改成功"),c.value=!1,r.reset(!0)})})},k=()=>{r.setResetPassModal()};return t({open}),(S,i)=>{const u=ye,_=ge,d=fe,w=J,I=ke;return a(),n("div",null,[e(I,{open:c.value,"onUpdate:open":i[2]||(i[2]=C=>c.value=C),title:h.value,onOk:L,width:"520px",onCancel:k},{default:l(()=>[e(u,{class:"alert-box",message:"您还未修改初始密码，为了保障您的数据安全，请您尽快重置密码。",type:"info","show-icon":""}),o("div",Qe,[e(w,{layout:"vertical"},{default:l(()=>[e(d,q({label:"登录密码"},y(x).password),{default:l(()=>[e(_,{value:v.password,"onUpdate:value":i[0]||(i[0]=C=>v.password=C),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),e(d,q({label:"确认密码"},y(x).check_password),{default:l(()=>[e(_,{value:v.check_password,"onUpdate:value":i[1]||(i[1]=C=>v.check_password=C),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},Ze=T(Xe,[["__scopeId","data-v-9de4c189"]]),et={class:"nav-name"},tt={__name:"beginner-guide-tag",setup(R){const t=$e(),r=_e(),m=p(()=>r.role_type),c=p(()=>+t.total_process),h=j(),v=()=>{t.getUseGuideProcess(),h.push("/guide")};return Y(()=>{t.getUseGuideProcess()}),(b,g)=>{const $=A;return m.value==1&&c.value!=100?(a(),n("div",{key:0,class:"beginner-guide-tag",onClick:v},[g[0]||(g[0]=o("span",{class:"red-dot"},null,-1)),e($,{class:"nav-icon",name:"guide"}),o("span",et,"新手指引 ("+f(c.value)+"%)",1)])):M("",!0)}}},ot=T(tt,[["__scopeId","data-v-0b757696"]]),at={class:"admin-layout"},st={key:0,class:"layout-header-wrapper"},nt={class:"layout-header"},rt={class:"header-left"},lt={class:"header-body"},ct={class:"header-right"},it={class:"item-box"},ut={class:"layout-body"},_t={key:0,class:"layout-breadcrumb-wrapper"},dt={key:1,class:"layout-footer-wrapper"},pt={__name:"index",setup(R){const t=ce(),r=K(),m=O(),c=p(()=>r.name!="robotWorkflow"?!1:t.hideLayoutTopAndBottom||!1),h=p(()=>r.meta.isCustomPage||!1),v=p(()=>r.meta.pageStyle||{}),b=p(()=>r.meta.bgColor||"#ffffff"),g=p(()=>r.meta.breadcrumb||[]),$=p(()=>r.meta.hideTitle||!1),x=p(()=>r.meta.title||!1),L=p(()=>{var k;return((k=m.userInfo)==null?void 0:k.d_pass)==1&&m.isShowResetPassModal});return(k,S)=>{const i=W("router-view");return a(),n("div",at,[c.value?M("",!0):(a(),n("div",st,[o("div",nt,[o("div",rt,[e(pe),e(ot)]),o("div",lt,[e(Be)]),o("div",ct,[o("div",it,[e(Ye)])])])])),o("div",ut,[h.value?le(k.$slots,"default",{key:0},()=>[e(i)],!0):(a(),n("div",{key:1,class:"page-wrapper",style:z({"background-color":b.value})},[$.value?M("",!0):(a(),n("div",_t,[e(Fe,{items:g.value,title:x.value},null,8,["items","title"])])),o("div",{class:"page-container",style:z({...v.value})},[e(i)],4)],4))]),c.value?M("",!0):(a(),n("div",dt,[e(Ee)])),L.value?(a(),B(Ze,{key:2})):M("",!0)])}}},Ct=T(pt,[["__scopeId","data-v-1b1fdac0"]]);export{Ct as default};
