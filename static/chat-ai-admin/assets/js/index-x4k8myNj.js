import{K as Re,q as Se,t as Q,v as aa,w as la,x as Nt,y as Je,P as Me,z as na,A as Pt,C as oa,F as st,G as sa,H as ia,J as ra,L as da,N as $t,O as ca,Q as it,S as rt,T as ua,U as _a,V as pa,b as fe,f as va,W as ma,M as me,k as re,X as Et,n as Oe,Y as mt,Z as fa,r as ha,$ as Bt,B as Qe,E as He,a0 as ga,a1 as Rt,d as ya,a2 as ka,a3 as ba,a4 as xa,a5 as wa,a6 as Ca,a7 as Sa,a8 as $a,a9 as La}from"../../index-CzPebXix.js";import{a as Da,p as Va,e as ft,d as D,b as G,w as Ee,s as ke,j as t,x as Ae,G as we,h as ht,ac as Pe,ad as Ia,N as E,O as w,F as ue,a1 as Ke,a5 as Mt,_ as j,u as Y,U as l,S as oe,X as f,z as _e,W as ye,Z as R,a6 as J,a0 as qe,q as Ta}from"./vue-chunks-BRsu9_To.js";import{_ as Oa}from"./cu-scroll-ufyFyI_5.js";import{g as At}from"./index-jmRHMddk.js";import{g as Kt}from"./index-B9BKV930.js";import{v as jt}from"./validate-8MtiUsxW.js";import{F as $e,_ as Ge}from"./index-BgVvqN-n.js";import{P as Xe}from"./PlusOutlined-BlmIiILr.js";import{_ as Na}from"./index-7Ecr060x.js";import{d as ut}from"./role_avatar-DL0r08JY.js";import{g as Ze,a as Ft,b as Pa,s as Ea,d as Ba,c as Ra,e as Ma,f as Aa,h as Ka}from"./index-8giw5C6U.js";import"./index-BFhVTGQQ.js";import{I as gt}from"./Input-DFtZp9vk.js";import{u as ja,b as Fa,c as Ua,d as Ha,e as za,t as Lt,B as Wa,f as Ya,g as qa,h as Ja,S as Ut,a as Ht}from"./index-6HDf6TPN.js";import{T as Qa,c as Ga,a as _t,u as Xa,g as Za,r as el,_ as tl}from"./index-BYVEo4R0.js";import{u as Dt}from"./useMergedState-C0iIHNGF.js";import{u as al,F as ll}from"./FormItemContext-B2RmG14m.js";import{g as nl,a as ol}from"./index-Bxqtz4sn.js";import{g as sl}from"./index-BhHQj-ne.js";import"./index-Di5l0R3t.js";import{_ as yt,R as zt,a as il}from"./RadioButton-h1wW1k6O.js";import{D as rl}from"./dayjs-DSnEW89Q.js";import{_ as Wt,E as dl}from"./Password-fnCqxsm2.js";import{_ as Yt}from"./index-w2fyHr10.js";import{a as et,_ as kt}from"./index-Bh3NMpRp.js";import{_ as bt}from"./Search-Cf7bcOZJ.js";import"./index-BSz5XTfh.js";import{D as qt}from"./dropdown-DTOAy9tU.js";import{M as cl}from"./MoreOutlined-DHg0Dtfc.js";import{M as Jt,_ as Qt}from"./index-DlQVT6K6.js";import{C as ul}from"./CaretDownOutlined-Byn8iz8T.js";import{_ as Gt}from"./index-BwqnaIPU.js";import{_ as _l}from"./index-Dhmpqx9n.js";import{D as pl}from"./DownOutlined-DXKkgIsm.js";import{U as vl}from"./UserOutlined-E0XEmwFB.js";import{C as dt}from"./CheckOutlined-Mk6nTpyE.js";import{E as ml}from"./EditOutlined-D08WQbiX.js";import"./QuestionCircleOutlined-DTfTQPH4.js";import{_ as fl}from"./index-Bpi-EtQQ.js";import{_ as xt}from"./index-BhUXTHsq.js";import{_ as hl}from"./TextArea-DrgXbuSS.js";import{_ as gl,C as yl}from"./index-DLRiQ5Ho.js";import{_ as kl,a as bl}from"./index-C5-M_Gan.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./Trigger-Bvakuge0.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-OEy0Jz8l.js";import"./Col-CFxRRwN8.js";import"./responsiveObserve-DqAe0rZk.js";import"./collapseMotion-Brd6xpAT.js";import"./DownloadOutlined-CeWsYko2.js";import"./index-hvcgcTJ4.js";import"./useRefs-CRRjy_qY.js";import"./inputProps-jdR54afw.js";import"./slide-CsbPJG8I.js";import"./index-Bhf8G0AA.js";import"./List-D7uk7Chm.js";import"./SearchOutlined-a_gTycfl.js";import"./move-CkiYyFmr.js";import"./CaretDownFilled-DSht_iiA.js";import"./Checkbox-oqMTsvET.js";import"./index-D17QejXF.js";import"./index-BukWVUqX.js";import"./colors-DfoziJR7.js";import"./ClockCircleOutlined-bBTx_Knl.js";import"./shallowequal-C0xnIuy8.js";import"./index-0UwCX3b0.js";import"./LeftOutlined-BKUTcRtP.js";import"./RightOutlined-DH_YROnp.js";function xl(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function wl(e){const{label:_,value:b,children:o}=e||{},i=b||"value";return{_title:_?[_]:["title","label"],value:i,key:i,children:o||"children"}}function pt(e){return e.disabled||e.disableCheckbox||e.checkable===!1}function Cl(e,_){const b=[];function o(i){i.forEach(s=>{b.push(s[_.value]);const n=s[_.children];n&&o(n)})}return o(e),b}function Vt(e){return e==null}const Xt=Symbol("TreeSelectContextPropsKey");function Sl(e){return Va(Xt,e)}function $l(){return Da(Xt,{})}const Ll={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Dl=ft({compatConfig:{MODE:3},name:"OptionList",inheritAttrs:!1,setup(e,_){let{slots:b,expose:o}=_;const i=ja(),s=Fa(),n=$l(),a=D(),$=Ua(()=>n.treeData,[()=>i.open,()=>n.treeData],v=>v[0]),u=G(()=>{const{checkable:v,halfCheckedKeys:y,checkedKeys:H}=s;return v?{checked:H,halfChecked:y}:null});Ee(()=>i.open,()=>{Ae(()=>{var v;i.open&&!i.multiple&&s.checkedKeys.length&&((v=a.value)===null||v===void 0||v.scrollTo({key:s.checkedKeys[0]}))})},{immediate:!0,flush:"post"});const m=G(()=>String(i.searchValue).toLowerCase()),L=v=>m.value?String(v[s.treeNodeFilterProp]).toLowerCase().includes(m.value):!1,C=ke(s.treeDefaultExpandedKeys),V=ke(null);Ee(()=>i.searchValue,()=>{i.searchValue&&(V.value=Cl(we(n.treeData),we(n.fieldNames)))},{immediate:!0});const N=G(()=>s.treeExpandedKeys?s.treeExpandedKeys.slice():i.searchValue?V.value:C.value),g=v=>{var y;C.value=v,V.value=v,(y=s.onTreeExpand)===null||y===void 0||y.call(s,v)},d=v=>{v.preventDefault()},c=(v,y)=>{let{node:H}=y;var O,x;const{checkable:p,checkedKeys:r}=s;p&&pt(H)||((O=n.onSelect)===null||O===void 0||O.call(n,H.key,{selected:!r.includes(H.key)}),i.multiple||(x=i.toggleOpen)===null||x===void 0||x.call(i,!1))},S=D(null),P=G(()=>s.keyEntities[S.value]),F=v=>{S.value=v};return o({scrollTo:function(){for(var v,y,H=arguments.length,O=new Array(H),x=0;x<H;x++)O[x]=arguments[x];return(y=(v=a.value)===null||v===void 0?void 0:v.scrollTo)===null||y===void 0?void 0:y.call(v,...O)},onKeydown:v=>{var y;const{which:H}=v;switch(H){case Re.UP:case Re.DOWN:case Re.LEFT:case Re.RIGHT:(y=a.value)===null||y===void 0||y.onKeydown(v);break;case Re.ENTER:{if(P.value){const{selectable:O,value:x}=P.value.node||{};O!==!1&&c(null,{node:{key:S.value},selected:!s.checkedKeys.includes(x)})}break}case Re.ESC:i.toggleOpen(!1)}},onKeyup:()=>{}}),()=>{var v;const{prefixCls:y,multiple:H,searchValue:O,open:x,notFoundContent:p=(v=b.notFoundContent)===null||v===void 0?void 0:v.call(b)}=i,{listHeight:r,listItemHeight:k,virtual:I,dropdownMatchSelectWidth:B,treeExpandAction:z}=n,{checkable:te,treeDefaultExpandAll:ce,treeIcon:h,showTreeIcon:X,switcherIcon:le,treeLine:T,loadData:U,treeLoadedKeys:ie,treeMotion:M,onTreeLoad:Z,checkedKeys:pe}=s;if($.value.length===0)return t("div",{role:"listbox",class:`${y}-empty`,onMousedown:d},[p]);const Ce={fieldNames:n.fieldNames};return ie&&(Ce.loadedKeys=ie),N.value&&(Ce.expandedKeys=N.value),t("div",{onMousedown:d},[P.value&&x&&t("span",{style:Ll,"aria-live":"assertive"},[P.value.node.value]),t(Qa,Se(Se({ref:a,focusable:!1,prefixCls:`${y}-tree`,treeData:$.value,height:r,itemHeight:k,virtual:I!==!1&&B!==!1,multiple:H,icon:h,showIcon:X,switcherIcon:le,showLine:T,loadData:O?null:U,motion:M,activeKey:S.value,checkable:te,checkStrictly:!0,checkedKeys:u.value,selectedKeys:te?[]:pe,defaultExpandAll:ce},Ce),{},{onActiveChange:F,onSelect:c,onCheck:c,onExpand:g,onLoad:Z,filterTreeNode:L,expandAction:z}),Q(Q({},b),{checkable:s.customSlots.treeCheckable}))])}}}),Vl="SHOW_ALL",Zt="SHOW_PARENT",wt="SHOW_CHILD";function It(e,_,b,o){const i=new Set(e);return _===wt?e.filter(s=>{const n=b[s];return!(n&&n.children&&n.children.some(a=>{let{node:$}=a;return i.has($[o.value])})&&n.children.every(a=>{let{node:$}=a;return pt($)||i.has($[o.value])}))}):_===Zt?e.filter(s=>{const n=b[s],a=n?n.parent:null;return!(a&&!pt(a.node)&&i.has(a.key))}):e}const je=()=>null;je.inheritAttrs=!1;je.displayName="ATreeSelectNode";je.isTreeSelectNode=!0;var Il=function(e,_){var b={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&_.indexOf(o)<0&&(b[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)_.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(b[o[i]]=e[o[i]]);return b};function Tl(e){return e&&e.type&&e.type.isTreeSelectNode}function Ol(e){function _(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return aa(b).map(o=>{var i,s,n;if(!Tl(o))return null;const a=o.children||{},$=o.key,u={};for(const[H,O]of Object.entries(o.props))u[la(H)]=O;const{isLeaf:m,checkable:L,selectable:C,disabled:V,disableCheckbox:N}=u,g={isLeaf:m||m===""||void 0,checkable:L||L===""||void 0,selectable:C||C===""||void 0,disabled:V||V===""||void 0,disableCheckbox:N||N===""||void 0},d=Q(Q({},u),g),{title:c=(i=a.title)===null||i===void 0?void 0:i.call(a,d),switcherIcon:S=(s=a.switcherIcon)===null||s===void 0?void 0:s.call(a,d)}=u,P=Il(u,["title","switcherIcon"]),F=(n=a.default)===null||n===void 0?void 0:n.call(a),v=Q(Q(Q({},P),{title:c,switcherIcon:S,key:$,isLeaf:m}),g),y=_(F);return y.length&&(v.children=y),v})}return _(e)}function vt(e){if(!e)return e;const _=Q({},e);return"props"in _||Object.defineProperty(_,"props",{get(){return _}}),_}function Nl(e,_,b,o,i,s){let n=null,a=null;function $(){function u(m){let L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return m.map((V,N)=>{const g=`${L}-${N}`,d=V[s.value],c=b.includes(d),S=u(V[s.children]||[],g,c),P=t(je,V,{default:()=>[S.map(F=>F.node)]});if(_===d&&(n=P),c){const F={pos:g,node:P,children:S};return C||a.push(F),F}return null}).filter(V=>V)}a||(a=[],u(o),a.sort((m,L)=>{let{node:{props:{value:C}}}=m,{node:{props:{value:V}}}=L;const N=b.indexOf(C),g=b.indexOf(V);return N-g}))}Object.defineProperty(e,"triggerNode",{get(){return $(),n}}),Object.defineProperty(e,"allCheckedNodes",{get(){return $(),i?a:a.map(u=>{let{node:m}=u;return m})}})}function Pl(e,_){let{id:b,pId:o,rootPId:i}=_;const s={},n=[];return e.map($=>{const u=Q({},$),m=u[b];return s[m]=u,u.key=u.key||m,u}).forEach($=>{const u=$[o],m=s[u];m&&(m.children=m.children||[],m.children.push($)),(u===i||!m&&i===null)&&n.push($)}),n}function El(e,_,b){const o=ke();return Ee([b,e,_],()=>{const i=b.value;e.value?o.value=b.value?Pl(we(e.value),Q({id:"id",pId:"pId",rootPId:null},i!==!0?i:{})):we(e.value).slice():o.value=Ol(we(_.value))},{immediate:!0,deep:!0}),o}const Bl=e=>{const _=ke({valueLabels:new Map}),b=ke();return Ee(e,()=>{b.value=we(e.value)},{immediate:!0}),[G(()=>{const{valueLabels:i}=_.value,s=new Map,n=b.value.map(a=>{var $;const{value:u}=a,m=($=a.label)!==null&&$!==void 0?$:i.get(u);return s.set(u,m),Q(Q({},a),{label:m})});return _.value.valueLabels=s,n})]},Rl=(e,_)=>{const b=ke(new Map),o=ke({});return ht(()=>{const i=_.value,s=Ga(e.value,{fieldNames:i,initWrapper:n=>Q(Q({},n),{valueEntities:new Map}),processEntity:(n,a)=>{const $=n.node[i.value];a.valueEntities.set($,n)}});b.value=s.valueEntities,o.value=s.keyEntities}),{valueEntities:b,keyEntities:o}},Ml=(e,_,b,o,i,s)=>{const n=ke([]),a=ke([]);return ht(()=>{let $=e.value.map(L=>{let{value:C}=L;return C}),u=_.value.map(L=>{let{value:C}=L;return C});const m=$.filter(L=>!o.value[L]);b.value&&({checkedKeys:$,halfCheckedKeys:u}=_t($,!0,o.value,i.value,s.value)),n.value=Array.from(new Set([...m,...$])),a.value=u}),[n,a]},Al=(e,_,b)=>{let{treeNodeFilterProp:o,filterTreeNode:i,fieldNames:s}=b;return G(()=>{const{children:n}=s.value,a=_.value,$=o==null?void 0:o.value;if(!a||i.value===!1)return e.value;let u;if(typeof i.value=="function")u=i.value;else{const L=a.toUpperCase();u=(C,V)=>{const N=V[$];return String(N).toUpperCase().includes(L)}}function m(L){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const V=[];for(let N=0,g=L.length;N<g;N++){const d=L[N],c=d[n],S=C||u(a,vt(d)),P=m(c||[],S);(S||P.length)&&V.push(Q(Q({},d),{[n]:P}))}return V}return m(e.value)})};function ea(){return Q(Q({},Je(Ya(),["mode"])),{prefixCls:String,id:String,value:{type:[String,Number,Object,Array]},defaultValue:{type:[String,Number,Object,Array]},onChange:{type:Function},searchValue:String,inputValue:String,onSearch:{type:Function},autoClearSearchValue:{type:Boolean,default:void 0},filterTreeNode:{type:[Boolean,Function],default:void 0},treeNodeFilterProp:String,onSelect:Function,onDeselect:Function,showCheckedStrategy:{type:String},treeNodeLabelProp:String,fieldNames:{type:Object},multiple:{type:Boolean,default:void 0},treeCheckable:{type:Boolean,default:void 0},treeCheckStrictly:{type:Boolean,default:void 0},labelInValue:{type:Boolean,default:void 0},treeData:{type:Array},treeDataSimpleMode:{type:[Boolean,Object],default:void 0},loadData:{type:Function},treeLoadedKeys:{type:Array},onTreeLoad:{type:Function},treeDefaultExpandAll:{type:Boolean,default:void 0},treeExpandedKeys:{type:Array},treeDefaultExpandedKeys:{type:Array},onTreeExpand:{type:Function},virtual:{type:Boolean,default:void 0},listHeight:Number,listItemHeight:Number,onDropdownVisibleChange:{type:Function},treeLine:{type:[Boolean,Object],default:void 0},treeIcon:Me.any,showTreeIcon:{type:Boolean,default:void 0},switcherIcon:Me.any,treeMotion:Me.any,children:Array,treeExpandAction:String,showArrow:{type:Boolean,default:void 0},showSearch:{type:Boolean,default:void 0},open:{type:Boolean,default:void 0},defaultOpen:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:Me.any,maxTagPlaceholder:{type:Function},dropdownPopupAlign:Me.any,customSlots:Object})}function Kl(e){return!e||typeof e!="object"}const jl=ft({compatConfig:{MODE:3},name:"TreeSelect",inheritAttrs:!1,props:Nt(ea(),{treeNodeFilterProp:"value",autoClearSearchValue:!0,showCheckedStrategy:wt,listHeight:200,listItemHeight:20,prefixCls:"vc-tree-select"}),setup(e,_){let{attrs:b,expose:o,slots:i}=_;const s=Ha(Pe(e,"id")),n=G(()=>e.treeCheckable&&!e.treeCheckStrictly),a=G(()=>e.treeCheckable||e.treeCheckStrictly),$=G(()=>e.treeCheckStrictly||e.labelInValue),u=G(()=>a.value||e.multiple),m=G(()=>wl(e.fieldNames)),[L,C]=Dt("",{value:G(()=>e.searchValue!==void 0?e.searchValue:e.inputValue),postState:K=>K||""}),V=K=>{var W;C(K),(W=e.onSearch)===null||W===void 0||W.call(e,K)},N=El(Pe(e,"treeData"),Pe(e,"children"),Pe(e,"treeDataSimpleMode")),{keyEntities:g,valueEntities:d}=Rl(N,m),c=K=>{const W=[],q=[];return K.forEach(ae=>{d.value.has(ae)?q.push(ae):W.push(ae)}),{missingRawValues:W,existRawValues:q}},S=Al(N,L,{fieldNames:m,treeNodeFilterProp:Pe(e,"treeNodeFilterProp"),filterTreeNode:Pe(e,"filterTreeNode")}),P=K=>{if(K){if(e.treeNodeLabelProp)return K[e.treeNodeLabelProp];const{_title:W}=m.value;for(let q=0;q<W.length;q+=1){const ae=K[W[q]];if(ae!==void 0)return ae}}},F=K=>xl(K).map(q=>Kl(q)?{value:q}:q),v=K=>F(K).map(q=>{let{label:ae}=q;const{value:de,halfChecked:se}=q;let ee;const ne=d.value.get(de);return ne&&(ae=ae??P(ne.node),ee=ne.node.disabled),{label:ae,value:de,halfChecked:se,disabled:ee}}),[y,H]=Dt(e.defaultValue,{value:Pe(e,"value")}),O=G(()=>F(y.value)),x=ke([]),p=ke([]);ht(()=>{const K=[],W=[];O.value.forEach(q=>{q.halfChecked?W.push(q):K.push(q)}),x.value=K,p.value=W});const r=G(()=>x.value.map(K=>K.value)),{maxLevel:k,levelEntities:I}=Xa(g),[B,z]=Ml(x,p,n,g,k,I),te=G(()=>{const q=It(B.value,e.showCheckedStrategy,g.value,m.value).map(se=>{var ee,ne,ge;return(ge=(ne=(ee=g.value[se])===null||ee===void 0?void 0:ee.node)===null||ne===void 0?void 0:ne[m.value.value])!==null&&ge!==void 0?ge:se}).map(se=>{const ee=x.value.find(ne=>ne.value===se);return{value:se,label:ee==null?void 0:ee.label}}),ae=v(q),de=ae[0];return!u.value&&de&&Vt(de.value)&&Vt(de.label)?[]:ae.map(se=>{var ee;return Q(Q({},se),{label:(ee=se.label)!==null&&ee!==void 0?ee:se.value})})}),[ce]=Bl(te),h=(K,W,q)=>{const ae=v(K);if(H(ae),e.autoClearSearchValue&&C(""),e.onChange){let de=K;n.value&&(de=It(K,e.showCheckedStrategy,g.value,m.value).map(Te=>{const Ye=d.value.get(Te);return Ye?Ye.node[m.value.value]:Te}));const{triggerValue:se,selected:ee}=W||{triggerValue:void 0,selected:void 0};let ne=de;if(e.treeCheckStrictly){const xe=p.value.filter(Te=>!de.includes(Te.value));ne=[...ne,...xe]}const ge=v(ne),Ve={preValue:x.value,triggerValue:se};let Ie=!0;(e.treeCheckStrictly||q==="selection"&&!ee)&&(Ie=!1),Nl(Ve,se,K,N.value,Ie,m.value),a.value?Ve.checked=ee:Ve.selected=ee;const be=$.value?ge:ge.map(xe=>xe.value);e.onChange(u.value?be:be[0],$.value?null:ge.map(xe=>xe.label),Ve)}},X=(K,W)=>{let{selected:q,source:ae}=W;var de,se,ee;const ne=we(g.value),ge=we(d.value),Ve=ne[K],Ie=Ve==null?void 0:Ve.node,be=(de=Ie==null?void 0:Ie[m.value.value])!==null&&de!==void 0?de:K;if(!u.value)h([be],{selected:!0,triggerValue:be},"option");else{let xe=q?[...r.value,be]:B.value.filter(Te=>Te!==be);if(n.value){const{missingRawValues:Te,existRawValues:Ye}=c(xe),St=Ye.map(ot=>ge.get(ot).key);let nt;q?{checkedKeys:nt}=_t(St,!0,ne,k.value,I.value):{checkedKeys:nt}=_t(St,{halfCheckedKeys:z.value},ne,k.value,I.value),xe=[...Te,...nt.map(ot=>ne[ot].node[m.value.value])]}h(xe,{selected:q,triggerValue:be},ae||"option")}q||!u.value?(se=e.onSelect)===null||se===void 0||se.call(e,be,vt(Ie)):(ee=e.onDeselect)===null||ee===void 0||ee.call(e,be,vt(Ie))},le=K=>{if(e.onDropdownVisibleChange){const W={};Object.defineProperty(W,"documentClickClose",{get(){return!1}}),e.onDropdownVisibleChange(K,W)}},T=(K,W)=>{const q=K.map(ae=>ae.value);if(W.type==="clear"){h(q,{},"selection");return}W.values.length&&X(W.values[0].value,{selected:!1,source:"selection"})},{treeNodeFilterProp:U,loadData:ie,treeLoadedKeys:M,onTreeLoad:Z,treeDefaultExpandAll:pe,treeExpandedKeys:Ce,treeDefaultExpandedKeys:ze,onTreeExpand:Le,virtual:Fe,listHeight:Ne,listItemHeight:he,treeLine:We,treeIcon:Be,showTreeIcon:Ue,switcherIcon:A,treeMotion:ve,customSlots:tt,dropdownMatchSelectWidth:at,treeExpandAction:lt}=Ia(e);za(Lt({checkable:a,loadData:ie,treeLoadedKeys:M,onTreeLoad:Z,checkedKeys:B,halfCheckedKeys:z,treeDefaultExpandAll:pe,treeExpandedKeys:Ce,treeDefaultExpandedKeys:ze,onTreeExpand:Le,treeIcon:Be,treeMotion:ve,showTreeIcon:Ue,switcherIcon:A,treeLine:We,treeNodeFilterProp:U,keyEntities:g,customSlots:tt})),Sl(Lt({virtual:Fe,listHeight:Ne,listItemHeight:he,treeData:S,fieldNames:m,onSelect:X,dropdownMatchSelectWidth:at,treeExpandAction:lt}));const De=D();return o({focus(){var K;(K=De.value)===null||K===void 0||K.focus()},blur(){var K;(K=De.value)===null||K===void 0||K.blur()},scrollTo(K){var W;(W=De.value)===null||W===void 0||W.scrollTo(K)}}),()=>{var K;const W=Je(e,["id","prefixCls","customSlots","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","virtual","listHeight","listItemHeight","onDropdownVisibleChange","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"]);return t(Wa,Se(Se(Se({ref:De},b),W),{},{id:s,prefixCls:e.prefixCls,mode:u.value?"multiple":void 0,displayValues:ce.value,onDisplayValuesChange:T,searchValue:L.value,onSearch:V,OptionList:Dl,emptyOptions:!N.value.length,onDropdownVisibleChange:le,tagRender:e.tagRender||i.tagRender,dropdownMatchSelectWidth:(K=e.dropdownMatchSelectWidth)!==null&&K!==void 0?K:!0}),i)}}}),Fl=e=>{const{componentCls:_,treePrefixCls:b,colorBgElevated:o}=e,i=`.${b}`;return[{[`${_}-dropdown`]:[{padding:`${e.paddingXS}px ${e.paddingXS/2}px`},Za(b,Pt(e,{colorBgContainer:o})),{[i]:{borderRadius:0,"&-list-holder-inner":{alignItems:"stretch",[`${i}-treenode`]:{[`${i}-node-content-wrapper`]:{flex:"auto"}}}}},sl(`${b}-checkbox`,e),{"&-rtl":{direction:"rtl",[`${i}-switcher${i}-switcher_close`]:{[`${i}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function Ul(e,_){return na("TreeSelect",b=>{const o=Pt(b,{treePrefixCls:_.value});return[Fl(o)]})(e)}const Tt=(e,_,b)=>b!==void 0?b:`${e}-${_}`;function Hl(){return Q(Q({},Je(ea(),["showTreeIcon","treeMotion","inputIcon","getInputElement","treeLine","customSlots"])),{suffixIcon:Me.any,size:rt(),bordered:pa(),treeLine:_a([Boolean,Object]),replaceFields:ua(),placement:rt(),status:rt(),popupClassName:String,dropdownClassName:String,"onUpdate:value":it(),"onUpdate:treeExpandedKeys":it(),"onUpdate:searchValue":it()})}const ct=ft({compatConfig:{MODE:3},name:"ATreeSelect",inheritAttrs:!1,props:Nt(Hl(),{choiceTransitionName:"",listHeight:256,treeIcon:!1,listItemHeight:26,bordered:!0}),slots:Object,setup(e,_){let{attrs:b,slots:o,expose:i,emit:s}=_;oa(!(e.treeData===void 0&&o.default)),st(e.multiple!==!1||!e.treeCheckable,"TreeSelect","`multiple` will always be `true` when `treeCheckable` is true"),st(e.replaceFields===void 0,"TreeSelect","`replaceFields` is deprecated, please use fieldNames instead"),st(!e.dropdownClassName,"TreeSelect","`dropdownClassName` is deprecated. Please use `popupClassName` instead.");const n=al(),a=ll.useInject(),$=G(()=>nl(a.status,e.status)),{prefixCls:u,renderEmpty:m,direction:L,virtual:C,dropdownMatchSelectWidth:V,size:N,getPopupContainer:g,getPrefixCls:d,disabled:c}=sa("select",e),{compactSize:S,compactItemClassnames:P}=ia(u,L),F=G(()=>S.value||N.value),v=ra(),y=G(()=>{var M;return(M=c.value)!==null&&M!==void 0?M:v.value}),H=G(()=>d()),O=G(()=>e.placement!==void 0?e.placement:L.value==="rtl"?"bottomRight":"bottomLeft"),x=G(()=>Tt(H.value,da(O.value),e.transitionName)),p=G(()=>Tt(H.value,"",e.choiceTransitionName)),r=G(()=>d("select-tree",e.prefixCls)),k=G(()=>d("tree-select",e.prefixCls)),[I,B]=qa(u),[z]=Ul(k,r),te=G(()=>$t(e.popupClassName||e.dropdownClassName,`${k.value}-dropdown`,{[`${k.value}-dropdown-rtl`]:L.value==="rtl"},B.value)),ce=G(()=>!!(e.treeCheckable||e.multiple)),h=G(()=>e.showArrow!==void 0?e.showArrow:e.loading||!ce.value),X=D();i({focus(){var M,Z;(Z=(M=X.value).focus)===null||Z===void 0||Z.call(M)},blur(){var M,Z;(Z=(M=X.value).blur)===null||Z===void 0||Z.call(M)}});const le=function(){for(var M=arguments.length,Z=new Array(M),pe=0;pe<M;pe++)Z[pe]=arguments[pe];s("update:value",Z[0]),s("change",...Z),n.onFieldChange()},T=M=>{s("update:treeExpandedKeys",M),s("treeExpand",M)},U=M=>{s("update:searchValue",M),s("search",M)},ie=M=>{s("blur",M),n.onFieldBlur()};return()=>{var M,Z,pe;const{notFoundContent:Ce=(M=o.notFoundContent)===null||M===void 0?void 0:M.call(o),prefixCls:ze,bordered:Le,listHeight:Fe,listItemHeight:Ne,multiple:he,treeIcon:We,treeLine:Be,showArrow:Ue,switcherIcon:A=(Z=o.switcherIcon)===null||Z===void 0?void 0:Z.call(o),fieldNames:ve=e.replaceFields,id:tt=n.id.value,placeholder:at=(pe=o.placeholder)===null||pe===void 0?void 0:pe.call(o)}=e,{isFormItemInput:lt,hasFeedback:De,feedbackIcon:K}=a,{suffixIcon:W,removeIcon:q,clearIcon:ae}=Ja(Q(Q({},e),{multiple:ce.value,showArrow:h.value,hasFeedback:De,feedbackIcon:K,prefixCls:u.value}),o);let de;Ce!==void 0?de=Ce:de=m("Select");const se=Je(e,["suffixIcon","itemIcon","removeIcon","clearIcon","switcherIcon","bordered","status","onUpdate:value","onUpdate:treeExpandedKeys","onUpdate:searchValue"]),ee=$t(!ze&&k.value,{[`${u.value}-lg`]:F.value==="large",[`${u.value}-sm`]:F.value==="small",[`${u.value}-rtl`]:L.value==="rtl",[`${u.value}-borderless`]:!Le,[`${u.value}-in-form-item`]:lt},ol(u.value,$.value,De),P.value,b.class,B.value),ne={};return e.treeData===void 0&&o.default&&(ne.children=ca(o.default())),I(z(t(jl,Se(Se(Se(Se({},b),se),{},{disabled:y.value,virtual:C.value,dropdownMatchSelectWidth:V.value,id:tt,fieldNames:ve,ref:X,prefixCls:u.value,class:ee,listHeight:Fe,listItemHeight:Ne,treeLine:!!Be,inputIcon:W,multiple:he,removeIcon:q,clearIcon:ae,switcherIcon:ge=>el(r.value,A,ge,o.leafIcon,Be),showTreeIcon:We,notFoundContent:de,getPopupContainer:g==null?void 0:g.value,treeMotion:null,dropdownClassName:te.value,choiceTransitionName:p.value,onChange:le,onBlur:ie,onSearch:U,onTreeExpand:T},ne),{},{transitionName:x.value,customSlots:Q(Q({},o),{treeCheckable:()=>t("span",{class:`${u.value}-tree-checkbox-inner`},null)}),maxTagPlaceholder:e.maxTagPlaceholder||o.maxTagPlaceholder,placement:O.value,showArrow:De||Ue,placeholder:at}),Q(Q({},o),{treeCheckable:()=>t("span",{class:`${u.value}-tree-checkbox-inner`},null)}))))}}}),Ot=je,Ct=Q(ct,{TreeNode:je,SHOW_ALL:Vl,SHOW_PARENT:Zt,SHOW_CHILD:wt,install:e=>(e.component(ct.name,ct),e.component(Ot.displayName,Ot),e)}),zl={class:"page-tabs"},Wl=["onClick"],Yl={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(e,{emit:_}){const{t:b}=va(),o=_,i=e,s=D([{value:1,title:b("views.user.model.teamMembers"),langKey:"views.user.model.teamMembers"}]),n=a=>{o("update:value",a),o("change",a)};return(a,$)=>(w(),E("div",zl,[(w(!0),E(ue,null,Ke(s.value,u=>(w(),E("div",{class:Mt(["tab-item",{active:i.value==u.value}]),onClick:m=>n(u.value),key:u.value},j(Y(b)(u.langKey)),11,Wl))),128))]))}},ql=fe(Yl,[["__scopeId","data-v-d59c98da"]]),Jl={class:"avatar-uploader"},Ql=["src"],Gl={key:1},Xl=["src"],Zl={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(e,{emit:_}){function b(d){return new Promise((c,S)=>{const P=new FileReader;P.readAsDataURL(d),P.onload=()=>c(P.result),P.onerror=F=>S(F)})}const o=_,i=e,s=D([]),n=D(!1),a=D("");Ee(()=>i.value,d=>{a.value=d},{immediate:!0});const $=$e.useInjectFormItemContext(),u=()=>{let d={imageUrl:a.value,file:s.value[0].originFileObj};o("change",d),o("update:value",d.imageUrl),$.onFieldChange()},m=d=>d.type==="image/jpeg"||d.type==="image/png"?d.size/1024<1024?(s.value=[d],b(d).then(P=>{a.value=P,n.value=!1,u()}),!1):(re.error("成员头像图片大小不能超过1M"),!1):(re.error("机器人头像只支持JPG、PNG格式的图片"),!1),L=D(!1),C=D(""),V=D(""),N=()=>{L.value=!1,V.value=""},g=async d=>{!d.url&&!d.preview&&(d.preview=await b(d.originFileObj)),C.value=d.url||d.preview,L.value=!0,V.value=d.name||d.url.substring(d.url.lastIndexOf("/")+1)};return(d,c)=>{const S=Na,P=me;return w(),E("div",Jl,[t(S,{"file-list":s.value,"onUpdate:fileList":c[0]||(c[0]=F=>s.value=F),"list-type":"picture-card","show-upload-list":!1,"before-upload":m,accept:".jpg,.png,.jpeg",onPreview:g},{default:l(()=>[a.value?(w(),E("img",{key:0,class:"avatar",src:a.value,alt:"avatar"},null,8,Ql)):(w(),E("div",Gl,[n.value?(w(),oe(Y(ma),{key:0})):(w(),oe(Y(Xe),{key:1})),c[1]||(c[1]=f("div",{class:"ant-upload-text"},"上传照片",-1))]))]),_:1},8,["file-list"]),t(P,{open:L.value,title:V.value,footer:null,onCancel:N},{default:l(()=>[f("img",{alt:"example",style:{width:"100%"},src:C.value},null,8,Xl)]),_:1},8,["open","title"])])}}},en=fe(Zl,[["__scopeId","data-v-662035a2"]]),tn={class:"form-box"},an={class:"avatar-box"},ln={class:"flex-item-box"},nn={class:"flex-item-box"},on={class:"flex-item-box"},sn={class:"flex-item-box"},rn={key:0,style:{"margin-top":"4px"}},dn={__name:"add-team-members",emits:["ok"],setup(e,{expose:_,emit:b}){const o=b,i=$e.useForm,s=D(!1),n=D("添加团队成员"),a=_e({user_name:"",nick_name:"",avatar:"",avatar_url:"",user_roles:"3",password:"",check_password:"",department_ids:[],expire_time_type:0,expire_time:"",id:""}),$=D([]),u=()=>{Ze({}).then(v=>{let y=v.data||[];$.value=mt(y)})},m=v=>{a.avatar=v.file},L=D([]);Et({page:1,size:200,search:""}).then(v=>{let y=v.data.list||[];L.value=y.filter(H=>H.id!="1"&&H.role_type!=1)});const C=_e({user_name:[{message:"请输入登录账号",required:!0},{validator:async(v,y)=>!/^[a-zA-Z0-9_.-]+$/.test(y)&&y?Promise.reject("账号只能为字母、数字、“-”、“_”,“.”的组合"):Promise.resolve()}],nick_name:[{message:"请输入昵称",required:!0}],avatar_url:[{message:"请上传头像",required:!0}],user_roles:[{message:"请选择成员角色",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(v,y)=>!jt(y)&&y?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(v,y)=>y!=a.password&&y?Promise.reject("两次输入的密码不一致"):Promise.resolve()}],expire_time:[{validator:async(v,y)=>a.expire_time_type==1&&!y?Promise.reject("请选择指定日期"):Promise.resolve()}],department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:V,validate:N,validateInfos:g}=i(a,C),d=v=>{n.value="添加团队成员",s.value=!0,V(),a.user_name="",a.nick_name="",a.avatar="",a.avatar_url=ut,a.user_roles="3",a.password="",a.check_password="",a.expire_time_type=0,a.expire_time="",a.department_ids=v?[v]:[],a.id="",u()},c=v=>{n.value="编辑团队成员",a.user_name=v.user_name,a.nick_name=v.nick_name,a.avatar_url=v.avatar||ut,a.avatar="",a.user_roles=v.user_roles,a.password="",a.check_password="",a.id=v.id,v.expire_time>0?(a.expire_time_type=1,a.expire_time=Oe(v.expire_time*1e3)):(a.expire_time_type=0,a.expire_time=""),a.department_ids=v.departments.map(y=>+y.id),delete C.password,delete C.check_password,s.value=!0,u()},S=D(!1),P=()=>{N().then(()=>{let v={...we(a)};v.expire_time_type==1?v.expire_time=Oe(v.expire_time).unix():v.expire_time=0,v.department_ids=a.department_ids.join(","),delete v.avatar_url,S.value=!0,fa(v).then(y=>{re.success(`${n.value}成功`),s.value=!1,o("ok")}).finally(()=>{S.value=!1})})},F=v=>v&&v<Oe().startOf("day");return _({add:d,edit:c}),(v,y)=>{const H=gt,O=Ge,x=Ht,p=Ut,r=Ct,k=Wt,I=zt,B=yt,z=rl,te=$e,ce=me;return w(),E("div",null,[t(ce,{open:s.value,"onUpdate:open":y[9]||(y[9]=h=>s.value=h),title:n.value,onOk:P,width:"746px"},{default:l(()=>[f("div",tn,[f("div",an,[t(en,{value:a.avatar_url,"onUpdate:value":y[0]||(y[0]=h=>a.avatar_url=h),onChange:m},null,8,["value"]),y[10]||(y[10]=f("div",{class:"tip"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1))]),t(te,{layout:"vertical",autocomplete:"off"},{default:l(()=>[f("div",ln,[t(O,ye({label:"成员昵称"},Y(g).nick_name),{default:l(()=>[t(H,{maxlength:100,type:"text",placeholder:"请输入昵称",value:a.nick_name,"onUpdate:value":y[1]||(y[1]=h=>a.nick_name=h)},null,8,["value"])]),_:1},16),t(O,ye({label:"登录账号"},Y(g).user_name),{default:l(()=>[t(H,{disabled:a.id!="",type:"text",placeholder:"账号只能为字母、数字、“-”、“_”,“.”的组合",value:a.user_name,"onUpdate:value":y[2]||(y[2]=h=>a.user_name=h)},null,8,["disabled","value"])]),_:1},16)]),f("div",nn,[t(O,ye({label:"成员角色"},Y(g).user_roles),{default:l(()=>[t(p,{value:a.user_roles,"onUpdate:value":y[3]||(y[3]=h=>a.user_roles=h),style:{width:"100%"},placeholder:"请选择成员角色"},{default:l(()=>[(w(!0),E(ue,null,Ke(L.value,h=>(w(),oe(x,{key:h.id,value:h.id},{default:l(()=>[R(j(h.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16),t(O,ye({label:"选择部门"},Y(g).department_ids,{name:"department_ids"}),{default:l(()=>[t(r,{value:a.department_ids,"onUpdate:value":y[4]||(y[4]=h=>a.department_ids=h),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":$.value,"tree-node-filter-prop":"label"},{title:l(({value:h,label:X})=>[f("div",null,j(X),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),f("div",on,[a.id?J("",!0):(w(),oe(O,ye({key:0,label:"登录密码"},Y(g).password),{default:l(()=>[t(k,{value:a.password,"onUpdate:value":y[5]||(y[5]=h=>a.password=h),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16)),a.id?J("",!0):(w(),oe(O,ye({key:1,label:"确认密码"},Y(g).check_password),{default:l(()=>[t(k,{value:a.check_password,"onUpdate:value":y[6]||(y[6]=h=>a.check_password=h),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16))]),f("div",sn,[t(O,ye({label:"过期时间"},Y(g).expire_time,{required:""}),{default:l(()=>[t(B,{value:a.expire_time_type,"onUpdate:value":y[7]||(y[7]=h=>a.expire_time_type=h)},{default:l(()=>[t(I,{value:0},{default:l(()=>y[11]||(y[11]=[R("永久有效")])),_:1,__:[11]}),t(I,{value:1},{default:l(()=>y[12]||(y[12]=[R("指定时间")])),_:1,__:[12]})]),_:1},8,["value"]),a.expire_time_type==1?(w(),E("div",rn,[t(z,{showNow:!1,format:"YYYY-MM-DD HH:mm","disabled-date":F,value:a.expire_time,"onUpdate:value":y[8]||(y[8]=h=>a.expire_time=h),"show-time":{defaultValue:Y(Oe)("00:00","HH:mm")}},null,8,["value","show-time"])])):J("",!0)]),_:1},16)])]),_:1})])]),_:1},8,["open","title"])])}}},cn=fe(dn,[["__scopeId","data-v-e2c6d008"]]),un={class:"form-box"},_n={__name:"reset-password",emits:["ok"],setup(e,{expose:_,emit:b}){const o=b,i=$e.useForm,s=D(!1),n=D("重置登录密码"),a=_e({password:"",check_password:"",id:""}),$=_e({password:[{message:"请输入登录密码",required:!0},{validator:async(N,g)=>!jt(g)&&g?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(N,g)=>g!=a.password&&g?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:u,validate:m,validateInfos:L}=i(a,$),C=N=>{N.id,s.value=!0,u(),a.password="",a.check_password="",a.id=N.id},V=()=>{m().then(()=>{ha({...we(a)}).then(N=>{re.success("修改成功"),s.value=!1,o("ok")})})};return _({open:C}),(N,g)=>{const d=Wt,c=Ge,S=$e,P=me;return w(),E("div",null,[t(P,{open:s.value,"onUpdate:open":g[2]||(g[2]=F=>s.value=F),title:n.value,onOk:V,width:"476px"},{default:l(()=>[f("div",un,[t(S,{layout:"vertical"},{default:l(()=>[t(c,ye({label:"登录密码"},Y(L).password),{default:l(()=>[t(d,{value:a.password,"onUpdate:value":g[0]||(g[0]=F=>a.password=F),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),t(c,ye({label:"确认密码"},Y(L).check_password),{default:l(()=>[t(d,{value:a.check_password,"onUpdate:value":g[1]||(g[1]=F=>a.check_password=F),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},pn=fe(_n,[["__scopeId","data-v-d0706fa4"]]),vn={key:0,class:"form-wrapper"},mn={class:"select"},fn={class:"tools-wrapper"},hn=["src"],gn={class:"item-name"},yn={key:1,class:"form-wrapper"},kn={class:"main-tabs-box"},bn={class:"select"},xn={class:"tools-wrapper"},wn={class:"item-name"},Cn={class:"tools-wrapper"},Sn={class:"item-name"},$n={key:2,class:"form-wrapper"},Ln={class:"select"},Dn={class:"tools-wrapper"},Vn={class:"item-name"},In={__name:"see-model-alert",props:{robotList:{type:Array,default:()=>[]},libraryList:{type:Array,default:()=>[]},formList:{type:Array,default:()=>[]}},emits:["save","ok"],setup(e,{expose:_,emit:b}){const o=b,i=e,s=D([]),n=D(""),a=D(!1),$=D([]),u=D([]),m=p=>{const r=[];return p.map(k=>{r.push(k.id)}),r},L=p=>{s.value=p},C=D(1),V=[{value:2,payload:{title:"部门知识库"}},{value:1,payload:{title:"成员知识库"}}],N=D(V);let g=null;const d=D(1),c=D(1),S=D(),P=async(p,r,k)=>{s.value=[],d.value=p,c.value=1,C.value=1,g=JSON.parse(JSON.stringify(k)),S.value=g.id,k=JSON.parse(JSON.stringify(k)),N.value=V,k.managed_robot_list=k.managed_robot_list||[],k.managed_library_list=k.managed_library_list||[],k.managed_form_list=k.managed_form_list||[];let I=[];p==1?(n.value="添加成员管理的机器人",I=i.robotList,I.forEach(B=>{let z=k.managed_robot_list.filter(te=>te.id==B.id);z.length?B.operate_rights=z[0].operate_rights:B.operate_rights="4"}),r&&r=="edit"&&(n.value="编辑成员管理的机器人",s.value=m(k.managed_robot_list))):p==2?(n.value="添加成员管理的知识库",I=i.libraryList,I.forEach(B=>{let z=k.managed_library_list.filter(te=>te.id==B.id);z.length?B.operate_rights=z[0].operate_rights:B.operate_rights="4"}),r&&r=="edit"&&(n.value="编辑成员管理的知识库",s.value=m(k.managed_library_list))):p==3&&(n.value="添加成员管理的数据库",I=i.formList,I.forEach(B=>{let z=k.managed_form_list.filter(te=>te.id==B.id);z.length?B.operate_rights=z[0].operate_rights:B.operate_rights="4"}),r&&r=="edit"&&(n.value="编辑成员管理的数据库",s.value=m(k.managed_form_list))),$.value=I,a.value=!0},F=()=>{Ft({object_type:d.value,identity_type:c.value,identity_id:S.value,tab:c.value}).then(p=>{u.value=p.data||[]})},v=()=>{C.value==2&&F()},y=(p,r)=>{s.value=[],c.value=1,C.value=1,d.value=p,S.value=r;let k=[];p==1?(n.value="批量修改成员管理的机器人",k=i.robotList):p==2?(n.value="批量修改成员管理的知识库",k=i.libraryList):p==3&&(n.value="批量修改成员管理的数据库",k=i.formList),k.forEach(I=>{I.operate_rights="4"}),$.value=k,a.value=!0},H=(p,r,k)=>{s.value=[],r.is_user?c.value=1:c.value=2,S.value=r.id,N.value=[{value:2,payload:{title:c.value==1?"部门知识库":"上级知识库"}},{value:1,payload:{title:c.value==1?"成员知识库":"部门知识库"}}],C.value=1,d.value=p;let I=[];p==1?(n.value=`添加${c==1?"成员":"部门"}管理的机器人`,I=i.robotList):p==2?(n.value=`添加${c==1?"成员":"部门"}管理的知识库`,I=i.libraryList):p==3&&(n.value=`添加${c==1?"成员":"部门"}管理的数据库`,I=i.formList),I.forEach(B=>{let z=k.filter(te=>te.object_id==B.id);z.length?B.operate_rights=z[0].operate_rights:B.operate_rights="4"}),s.value=k.map(B=>B.object_id),$.value=I,a.value=!0},O=()=>{let p={identity_ids:S.value,identity_type:c.value,object_type:d.value},r=[];$.value.forEach(k=>{s.value.includes(k.id)&&r.push({object_id:+k.id,object_type:+d.value,operate_rights:+k.operate_rights})}),p.object_array=JSON.stringify(r),Pa(p).then(k=>{a.value=!1,re.success("保存成功"),o("ok")})},x=()=>{};return _({open:P,handleBatchOpen:y,handleDepartmentOpen:H}),(p,r)=>{const k=kt,I=zt,B=yt,z=et,te=Yt,ce=me;return w(),oe(ce,{class:"add-model-alert",width:"800px",open:a.value,"onUpdate:open":r[1]||(r[1]=h=>a.value=h),title:n.value,onOk:O,onCancel:x},{default:l(()=>[d.value==1?(w(),E("div",vn,[f("div",mn,"已选择("+j(s.value.length)+")",1),t(z,{"data-source":$.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:s.value,onChange:L}},{default:l(()=>[t(k,{title:"机器人","data-index":"robot_name",width:350},{default:l(({record:h})=>[f("div",fn,[f("img",{class:"model-logo",src:h.robot_avatar,alt:""},null,8,hn),f("div",gn,j(h.robot_name),1)])]),_:1}),t(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:h})=>[t(B,{value:h.operate_rights,"onUpdate:value":X=>h.operate_rights=X},{default:l(()=>[t(I,{value:"4"},{default:l(()=>r[2]||(r[2]=[R("管理")])),_:1,__:[2]}),t(I,{value:"2"},{default:l(()=>r[3]||(r[3]=[R("编辑")])),_:1,__:[3]}),t(I,{value:"1"},{default:l(()=>r[4]||(r[4]=[R("查看")])),_:1,__:[4]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):d.value==2?(w(),E("div",yn,[f("div",kn,[t(te,{value:C.value,"onUpdate:value":r[0]||(r[0]=h=>C.value=h),options:N.value,onChange:v},{label:l(({payload:h})=>[R(j(h.title),1)]),_:1},8,["value","options"])]),C.value==1?(w(),E(ue,{key:0},[f("div",bn,"已选择("+j(s.value.length)+")",1),t(z,{"data-source":$.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:s.value,onChange:L}},{default:l(()=>[t(k,{title:"知识库","data-index":"library_name",width:350},{default:l(({record:h})=>[f("div",xn,[f("div",wn,j(h.library_name),1)])]),_:1}),t(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:h})=>[t(B,{value:h.operate_rights,"onUpdate:value":X=>h.operate_rights=X},{default:l(()=>[t(I,{value:"4"},{default:l(()=>r[5]||(r[5]=[R("管理")])),_:1,__:[5]}),t(I,{value:"2"},{default:l(()=>r[6]||(r[6]=[R("编辑")])),_:1,__:[6]}),t(I,{value:"1"},{default:l(()=>r[7]||(r[7]=[R("查看")])),_:1,__:[7]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])],64)):(w(),oe(z,{key:1,"data-source":u.value,pagination:!1,scroll:{y:500},"row-key":"id"},{default:l(()=>[t(k,{title:"知识库","data-index":"name",width:350},{default:l(({record:h})=>[f("div",Cn,[f("div",Sn,j(h.name),1)])]),_:1}),t(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:h})=>[t(B,{value:h.operate_rights,"onUpdate:value":X=>h.operate_rights=X,disabled:""},{default:l(()=>[t(I,{value:"4"},{default:l(()=>r[8]||(r[8]=[R("管理")])),_:1,__:[8]}),t(I,{value:"2"},{default:l(()=>r[9]||(r[9]=[R("编辑")])),_:1,__:[9]}),t(I,{value:"1"},{default:l(()=>r[10]||(r[10]=[R("查看")])),_:1,__:[10]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source"]))])):d.value==3?(w(),E("div",$n,[f("div",Ln,"已选择("+j(s.value.length)+")",1),t(z,{"data-source":$.value,pagination:!1,scroll:{y:500},"row-key":"id","row-selection":{selectedRowKeys:s.value,onChange:L}},{default:l(()=>[t(k,{title:"数据库","data-index":"name",width:350},{default:l(({record:h})=>[f("div",Dn,[f("div",Vn,j(h.name),1)])]),_:1}),t(k,{title:"权限","data-index":"operate_rights",width:350},{default:l(({record:h})=>[t(B,{value:h.operate_rights,"onUpdate:value":X=>h.operate_rights=X},{default:l(()=>[t(I,{value:"4"},{default:l(()=>r[11]||(r[11]=[R("管理")])),_:1,__:[11]}),t(I,{value:"2"},{default:l(()=>r[12]||(r[12]=[R("编辑")])),_:1,__:[12]}),t(I,{value:"1"},{default:l(()=>r[13]||(r[13]=[R("查看")])),_:1,__:[13]})]),_:2},1032,["value","onUpdate:value"])]),_:1})]),_:1},8,["data-source","row-selection"])])):J("",!0)]),_:1},8,["open","title"])}}},ta=fe(In,[["__scopeId","data-v-0706de39"]]),Tn={class:"form-box"},On={class:"form-item"},Nn={class:"form-content"},Pn={key:0,class:"form-item"},En={class:"form-content"},Bn={__name:"add-department",emits:["ok"],setup(e,{expose:_,emit:b}){const o=D(!1),i=b,s=_e({department_name:"",id:"",pid:""}),n=D(""),a=C=>{s.id="",s.pid=C.id>0?C.id||"":void 0,s.department_name="",n.value="添加部门",o.value=!0,m()},$=C=>{s.id=C.id||"",s.pid=C.pid||"",s.department_name=C.title||"",n.value="重命名",o.value=!0},u=D([]),m=()=>{Ze({}).then(C=>{let V=C.data||[];u.value=mt(V)})},L=()=>{if(!s.department_name)return re.error("请输入部门名称");if(!s.id&&!s.pid)return re.error("请选择所属部门");Ea({...s}).then(C=>{re.success("修改成功"),o.value=!1,i("ok")})};return _({show:a,rename:$}),(C,V)=>{const N=gt,g=Ct,d=me;return w(),E("div",null,[t(d,{open:o.value,"onUpdate:open":V[2]||(V[2]=c=>o.value=c),title:n.value,onOk:L,width:472},{default:l(()=>[f("div",Tn,[f("div",On,[V[3]||(V[3]=f("div",{class:"form-label"},"部门名称",-1)),f("div",Nn,[t(N,{maxLength:10,value:s.department_name,"onUpdate:value":V[0]||(V[0]=c=>s.department_name=c),placeholder:"请输入部门名称"},null,8,["value"])])]),s.id?J("",!0):(w(),E("div",Pn,[V[4]||(V[4]=f("div",{class:"form-label"},"所属部门",-1)),f("div",En,[t(g,{value:s.pid,"onUpdate:value":V[1]||(V[1]=c=>s.pid=c),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"","tree-default-expand-all":"","tree-data":u.value,"tree-node-filter-prop":"label"},{title:l(({value:c,label:S})=>[f("div",null,j(S),1)]),_:1},8,["value","tree-data"])])]))])]),_:1},8,["open","title"])])}}},Rn=fe(Bn,[["__scopeId","data-v-0fb87f68"]]),Mn={class:"del-box"},An={class:"icon-box"},Kn={class:"footer-btn"},jn={class:"set-box"},Fn={class:"set-item"},Un={__name:"del-department",emits:["ok"],setup(e,{expose:_,emit:b}){const o=D(!1),i=D(!1),s=b,n=_e({id:"",new_department_id:void 0});let a=[];const $=g=>{if(a=[],a=u(g),n.new_department_id=void 0,n.id=g.id,g.children.length==0){me.confirm({title:"提示",icon:t(He),content:"确定删除该部门",onOk(){C()}});return}o.value=!0,N()};function u(g){let d=[g.id];if(g.children&&g.children.length>0)for(const c of g.children)d=d.concat(u(c));return d}const m=()=>{i.value=!0},L=()=>{n.new_department_id="",C()},C=()=>{Ba({...n}).then(g=>{i.value=!1,o.value=!1,re.success("删除成功"),s("ok",n.id)})},V=D([]),N=()=>{Ra().then(g=>{let d=g.data||[];V.value=d.filter(c=>!a.includes(+c.id))})};return _({show:$}),(g,d)=>{const c=Qe,S=me,P=Ht,F=Ut;return w(),E("div",null,[t(S,{open:o.value,"onUpdate:open":d[1]||(d[1]=v=>o.value=v),title:null,footer:null,width:480,closable:!1},{default:l(()=>[f("div",Mn,[f("div",An,[t(Y(Bt))]),d[7]||(d[7]=f("div",{class:"top-title"},"删除部门",-1)),d[8]||(d[8]=f("div",{class:"content"}," 确认删除部门么？直接删除后，该部门成员归属到默认部门或设置新的部门 ",-1)),f("div",Kn,[t(c,{onClick:d[0]||(d[0]=v=>o.value=!1)},{default:l(()=>d[4]||(d[4]=[R("关闭")])),_:1,__:[4]}),t(c,{danger:"",onClick:L},{default:l(()=>d[5]||(d[5]=[R("直接删除")])),_:1,__:[5]}),t(c,{type:"primary",onClick:m},{default:l(()=>d[6]||(d[6]=[R("删除并设置")])),_:1,__:[6]})])])]),_:1},8,["open"]),t(S,{open:i.value,"onUpdate:open":d[3]||(d[3]=v=>i.value=v),title:"设置部门",width:472,onOk:C},{default:l(()=>[f("div",jn,[d[10]||(d[10]=f("div",{class:"set-desc"},"删除之前请先将之前部门的成员换到其他团队",-1)),f("div",Fn,[d[9]||(d[9]=f("div",{class:"set-label"},"所属部门",-1)),f("div",null,[t(F,{value:n.new_department_id,"onUpdate:value":d[2]||(d[2]=v=>n.new_department_id=v),style:{width:"100%"},placeholder:"请选择"},{default:l(()=>[(w(!0),E(ue,null,Ke(V.value,v=>(w(),oe(P,{key:v.id,value:v.id},{default:l(()=>[R(j(v.department_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])])]),_:1},8,["open"])])}}},Hn=fe(Un,[["__scopeId","data-v-de653ece"]]),zn={class:"department-tree-search"},Wn={class:"flex-block"},Yn={class:"tree-list-box"},qn={style:{"margin-right":"4px"}},Jn={class:"action-btn toggle-btn"},Qn={class:"doc-item"},Gn={key:0,class:"tree-title"},Xn={style:{color:"#f50"}},Zn={style:{color:"#f50"}},eo={key:1,class:"tree-title"},to={class:"use-num"},ao={key:2,class:"doc-action-box"},lo={__name:"department-tree",emits:["select","save","refresh"],setup(e,{expose:_,emit:b}){const o=b;let i=[];const s=[],n=(p,r)=>{let k;for(let I=0;I<r.length;I++){const B=r[I];B.children&&(B.children.some(z=>z.key===p)?k=B.key:n(p,B.children)&&(k=n(p,B.children)))}return k},a=D([]),$=D([]),u=D(""),m=D(!0),L=D([]);let C="",V={};const N=p=>{a.value=p,m.value=!1};Ee(u,p=>{const r=s.map(k=>k.title.indexOf(p)>-1?n(k.key,L.value):null).filter((k,I,B)=>k&&B.indexOf(k)===I);a.value=r,u.value=p,m.value=!0});const g=p=>{for(let r=0;r<p.length;r++){const k=p[r],I=k.key;s.push({key:I,title:k.title}),k.children&&g(k.children)}},d=p=>{Ze({}).then(r=>{let k=r.data||[];i=[],i=ga(k),g(i),L.value=i,p&&(k.forEach(I=>{I.is_default==1&&(C=I.id,V=I)}),Ae(()=>{C&&($.value=[C],o("select",V))}))})};d(!0);let c={};const S=p=>{$.value[0]==p?Ae(()=>{C&&($.value=[C],o("select",V))}):o("refresh"),d()},P=D(),F=p=>{P.value.show(p)},v=p=>{P.value.rename(p)},y=(p,r)=>{r.node.is_user,r.node.id,r.selected||Ae(()=>{$.value=[r.node.id]}),c={...r.node},o("select",c)},H=D(null),O=p=>{H.value.show(p)},x=()=>{d(),o("refresh")};return _({getLists:d}),(p,r)=>{const k=bt,I=Gt,B=Qt,z=Jt,te=qt,ce=tl;return w(),E(ue,null,[f("div",zn,[f("div",Wn,[t(k,{value:u.value,"onUpdate:value":r[0]||(r[0]=h=>u.value=h),placeholder:"搜索部门",style:{flex:"1"}},null,8,["value"]),f("div",{class:"add-btn-box",onClick:r[1]||(r[1]=h=>F({}))},[t(Y(Xe))])]),f("div",Yn,[t(ce,{"expanded-keys":a.value,selectedKeys:$.value,"onUpdate:selectedKeys":r[3]||(r[3]=h=>$.value=h),"auto-expand-parent":m.value,onSelect:y,"tree-data":L.value,blockNode:"",onExpand:N},{switcherIcon:l(({switcherCls:h})=>[f("div",qn,[f("span",Jn,[t(Y(ul),{style:{"font-size":"12px"},class:Mt(h)},null,8,["class"])])])]),title:l(h=>[f("div",Qn,[h.title.indexOf(u.value)>-1&&u.value?(w(),E("span",Gn,[h.title.length>3&&h.level>3?(w(),oe(I,{key:0},{title:l(()=>[R(j(h.title),1)]),default:l(()=>[R(" "+j(h.title.substring(0,h.title.indexOf(u.value)))+" ",1),f("span",Xn,j(u.value),1),R(" "+j(h.title.substring(h.title.indexOf(u.value)+u.value.length)),1)]),_:2},1024)):(w(),E(ue,{key:1},[R(j(h.title.substring(0,h.title.indexOf(u.value)))+" ",1),f("span",Zn,j(u.value),1),R(" "+j(h.title.substring(h.title.indexOf(u.value)+u.value.length)),1)],64))])):(w(),E("span",eo,[h.title.length>3&&h.level>3?(w(),oe(I,{key:0},{title:l(()=>[R(j(h.title),1)]),default:l(()=>[R(" "+j(h.title),1)]),_:2},1024)):(w(),E(ue,{key:1},[R(j(h.title),1)],64))])),f("div",to,j(h.children_nums),1),h.is_user?J("",!0):(w(),E("div",ao,[t(te,null,{overlay:l(()=>[t(z,null,{default:l(()=>[t(B,{key:"addDoc",onClick:qe(X=>F(h),["stop","prevent"])},{default:l(()=>r[4]||(r[4]=[f("span",{class:"menu-name"},"添加子部门",-1)])),_:2,__:[4]},1032,["onClick"]),t(B,{key:"importDoc",onClick:qe(X=>v(h),["stop","prevent"])},{default:l(()=>r[5]||(r[5]=[f("span",{class:"menu-name"},"重命名",-1)])),_:2,__:[5]},1032,["onClick"]),h.is_default!=1?(w(),oe(B,{key:"del",onClick:qe(X=>O(h),["stop","prevent"])},{default:l(()=>r[6]||(r[6]=[f("span",{class:"menu-name",style:{color:"#fb363f"}},"删 除",-1)])),_:2,__:[6]},1032,["onClick"])):J("",!0)]),_:2},1024)]),default:l(()=>[f("span",{class:"action-btn",onClick:r[2]||(r[2]=qe(()=>{},["stop"]))},[t(Y(cl))])]),_:2},1024)]))])]),_:1},8,["expanded-keys","selectedKeys","auto-expand-parent","tree-data"])])]),t(Rn,{ref_key:"addDepartmentRef",ref:P,onOk:x},null,512),t(Hn,{ref_key:"delDepartmentRef",ref:H,onOk:S},null,512)],64)}}},no=fe(lo,[["__scopeId","data-v-f461874a"]]),oo={class:"main-content-box"},so={style:{"margin-top":"12px"}},io={key:0},ro={key:1},co={key:2},uo={class:"list-content"},_o={key:0},po={key:1},vo={key:2},mo={key:0,class:"user-block"},fo={class:"role-menu-box"},ho=["onClick"],go={class:"menu-header"},yo={key:0,class:"check-box"},ko=["onClick"],bo={class:"menu-header"},xo={key:0,class:"check-box"},wo=["onClick"],Co={class:"menu-header"},So={key:0,class:"check-box"},$o={class:"hover-btn-box"},Lo={key:0},Do={key:1},Vo={key:2},Io=["onClick"],To={__name:"knowledge-permissions",props:{treeParmas:{type:Object,default:()=>({})}},setup(e){const _=D("2"),b=D([]),o=e;Ee(()=>o.treeParmas,c=>{i()},{deep:!0});const i=()=>{Ft({object_type:_.value,identity_type:o.treeParmas.is_user?1:2,identity_id:o.treeParmas.id}).then(c=>{let S=c.data||[];b.value=S})};i();const s=()=>{i()},n=(c,S)=>{let P=S==4?"管理":S==2?"编辑":"查看";me.confirm({title:"提示?",icon:t(He),content:"确认修改该数据权限为【"+P+"】",okText:"确认",cancelText:"取消",onOk:()=>{let F=[{object_id:+c.object_id,object_type:+c.object_type,operate_rights:+S}];Ma({identity_ids:c.identity_id,identity_type:2,object_array:JSON.stringify(F)}).then(v=>{re.success("修改成功"),i()})},onCancel(){}})},a=c=>{me.confirm({title:"提示?",icon:t(He),content:"确认删除该条数据",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Aa({identity_id:c.identity_id,identity_type:2,object_id:c.object_id,object_type:c.object_type}).then(S=>{re.success("删除成功"),i()})},onCancel(){}})},$=D([]),u=D([]),m=D([]),L=async()=>{await At().then(c=>{$.value=c.data}).catch(()=>{})},C=async()=>{await Rt({type:""}).then(c=>{u.value=c.data}).catch(()=>{})},V=async()=>{await Kt().then(c=>{m.value=c.data}).catch(()=>{})},N=D(null),g=async()=>{if(!o.treeParmas.id)return re.error("请先选择部门");let c=_.value;c==1?await L():c==2?await C():c==3&&await V(),N.value.handleDepartmentOpen(c,o.treeParmas,b.value)},d=D([{dataIndex:"name",key:"name"},{title:"权限",dataIndex:"role",key:"role"},{title:"操作",dataIndex:"action",key:"action",width:80}]);return(c,S)=>{const P=il,F=yt,v=Qe,y=_l,H=et;return w(),E(ue,null,[f("div",oo,[t(F,{value:_.value,"onUpdate:value":S[0]||(S[0]=O=>_.value=O),onChange:s},{default:l(()=>[t(P,{value:"2"},{default:l(()=>S[1]||(S[1]=[R("知识库")])),_:1,__:[1]}),t(P,{value:"1"},{default:l(()=>S[2]||(S[2]=[R("机器人")])),_:1,__:[2]}),t(P,{value:"3"},{default:l(()=>S[3]||(S[3]=[R("数据库")])),_:1,__:[3]})]),_:1},8,["value"]),f("div",so,[t(v,{type:"primary",onClick:g},{default:l(()=>[_.value==2?(w(),E("span",io,"添加知识库权限")):J("",!0),_.value==1?(w(),E("span",ro,"添加机器人权限")):J("",!0),_.value==3?(w(),E("span",co,"添加数据库权限")):J("",!0)]),_:1})]),f("div",uo,[t(H,{columns:d.value,"data-source":b.value,pagination:!1},{headerCell:l(({column:O})=>[O.key==="name"?(w(),E(ue,{key:0},[_.value==2?(w(),E("span",_o,"知识库")):J("",!0),_.value==1?(w(),E("span",po,"机器人")):J("",!0),_.value==3?(w(),E("span",vo,"数据库")):J("",!0)],64)):J("",!0)]),bodyCell:l(({column:O,record:x})=>[O.key==="name"?(w(),E("div",mo,j(x.name),1)):J("",!0),O.key==="role"?(w(),oe(y,{key:1,placement:"bottomRight",title:null,overlayInnerStyle:{padding:"2px"}},{content:l(()=>[f("div",fo,[f("div",{class:"role-menu",onClick:p=>n(x,4)},[f("div",go,[t(Y(vl)),S[4]||(S[4]=f("span",{class:"title"},"管理",-1))]),S[5]||(S[5]=f("div",{class:"desc"},"可编辑，可删除，可查看",-1)),x.operate_rights==4?(w(),E("div",yo,[t(Y(dt))])):J("",!0)],8,ho),f("div",{class:"role-menu",onClick:p=>n(x,2)},[f("div",bo,[t(Y(ml)),S[6]||(S[6]=f("span",{class:"title"},"编辑",-1))]),S[7]||(S[7]=f("div",{class:"desc"},"可编辑，可查看",-1)),x.operate_rights==2?(w(),E("div",xo,[t(Y(dt))])):J("",!0)],8,ko),f("div",{class:"role-menu",onClick:p=>n(x,1)},[f("div",Co,[t(Y(dl)),S[8]||(S[8]=f("span",{class:"title"},"查看",-1))]),S[9]||(S[9]=f("div",{class:"desc"},"仅查看",-1)),x.operate_rights==1?(w(),E("div",So,[t(Y(dt))])):J("",!0)],8,wo)])]),default:l(()=>[f("div",$o,[x.operate_rights==4?(w(),E("span",Lo,"管理")):J("",!0),x.operate_rights==2?(w(),E("span",Do,"编辑")):J("",!0),x.operate_rights==1?(w(),E("span",Vo,"查看")):J("",!0),t(Y(pl))])]),_:2},1024)):J("",!0),O.key==="action"?(w(),E("a",{key:2,onClick:p=>a(x)},"删除",8,Io)):J("",!0)]),_:1},8,["columns","data-source"])])]),t(ta,{ref_key:"seeModelAlertRef",ref:N,robotList:$.value,libraryList:u.value,formList:m.value,onOk:i},null,8,["robotList","libraryList","formList"])],64)}}},Oo=fe(To,[["__scopeId","data-v-d9967a89"]]),No={__name:"batch-edit-department",emits:["ok"],setup(e,{expose:_,emit:b}){const o=D(!1),i=b,s=$e.useForm,n=_e({user_ids:"",department_ids:[]}),a=_e({department_ids:[{message:"请选择部门",required:!0}]}),{resetFields:$,validate:u,validateInfos:m}=s(n,a),L=d=>{n.user_ids=d,n.department_ids=[],o.value=!0,V()},C=D([]),V=()=>{Ze({}).then(d=>{let c=d.data||[];C.value=mt(c)})},N=D(!1),g=()=>{u().then(()=>{let d={...n};d.department_ids=n.department_ids.join(","),N.value=!0,Ka(d).then(c=>{re.success("批量修改部门成功"),o.value=!1,i("ok")}).finally(()=>{N.value=!1})})};return _({show:L}),(d,c)=>{const S=Ct,P=Ge,F=$e,v=me;return w(),E("div",null,[t(v,{open:o.value,"onUpdate:open":c[1]||(c[1]=y=>o.value=y),title:"批量修改部门",onOk:g,confirmLoading:N.value},{default:l(()=>[t(F,{layout:"vertical",style:{"margin-top":"24px"}},{default:l(()=>[t(P,ye({label:"选择部门"},Y(m).department_ids),{default:l(()=>[t(S,{value:n.department_ids,"onUpdate:value":c[0]||(c[0]=y=>n.department_ids=y),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"",multiple:"","tree-default-expand-all":"","tree-data":C.value,"tree-node-filter-prop":"label"},{title:l(({value:y,label:H})=>[f("div",null,j(H),1)]),_:1},8,["value","tree-data"])]),_:1},16)]),_:1})]),_:1},8,["open","confirmLoading"])])}}},Po={class:"flex-content-box"},Eo={class:"left-department-box"},Bo={class:"team-members-pages"},Ro={class:"main-tabs-block"},Mo={class:"list-box"},Ao={class:"user-box"},Ko=["src"],jo={class:"name-info"},Fo={class:"user-name"},Uo={class:"nick-name"},Ho={key:0,class:"list-content"},zo={key:1,class:"list-preview list-content"},Wo={style:{display:"inline"}},Yo={class:"list-item-box"},qo={class:"list-item"};const Jo={key:0,class:"status-block green"},Qo={key:1,class:"status-block yellow"},Go=["onClick"],Xo=["onClick"],Zo=["onClick"],es={__name:"team-members",setup(e){const _=D(1),b=[{value:1,payload:{title:"团队成员"}}],o=_e({page:1,size:10,total:0,search:""}),i=D([]),s=D([]),n=D([]),a=D(null),$=T=>{o.page=T.current,o.size=T.pageSize,g()},u=_e({id:""}),m=T=>{Object.assign(u,{...T}),_.value==1&&L()},L=()=>{o.page=1,g()},C=D([]),V=T=>{let U=[];return T.map(ie=>{U.push(ie.name||ie.department_name)}),U.join(", ")},N=D(!1),g=()=>{let T={page:o.page,size:o.size,search:o.search};u.id&&u.is_default!=1&&(T.department_id=u.id),N.value=!0,ba(T).then(U=>{let ie=U.data.list;ie.forEach(M=>{M.create_time=Oe(M.create_time*1e3).format("YYYY-MM-DD HH:mm"),M.expire_time_desc=M.expire_time=="0"?"永久有效":Oe(M.expire_time*1e3).format("YYYY-MM-DD HH:mm"),M.expire_status=0,(M.expire_time=="0"||Oe().unix()<M.expire_time)&&(M.expire_status=1),M.managed_robot_list=M.managed_robot_list?JSON.parse(M.managed_robot_list):[],M.managed_library_list=M.managed_library_list?JSON.parse(M.managed_library_list):[],M.managed_form_list=M.managed_form_list?JSON.parse(M.managed_form_list):[],M.departments=M.departments?JSON.parse(M.departments):[]}),C.value=ie,P.selectedRowKeys=[],o.total=+U.data.total}).finally(()=>{N.value=!1})},d=()=>{_.value==1&&L()},c=D(null),S=()=>{g(),c.value.getLists()},P=_e({selectedRowKeys:[]}),F=T=>{P.selectedRowKeys=T},v=T=>({disabled:T.role_type==1}),y=T=>{xa({user_id:T.id}).then(U=>{re.success(T.login_switch==1?"关闭成功":"开启成功"),g()})},H=D(null),O=()=>{H.value.add(u.id)},x=T=>{H.value.edit(T)},p=D(null),r=T=>{p.value.open(T)},k=T=>{me.confirm({title:"提示?",icon:t(He),content:"确认删除该用户",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{wa({id:T.id}).then(U=>{re.success("删除成功"),g()})},onCancel(){}})},I=async()=>{await At().then(T=>{i.value=T.data}).catch(()=>{})},B=async()=>{await Rt({type:""}).then(T=>{s.value=T.data}).catch(()=>{})},z=async()=>{await Kt().then(T=>{n.value=T.data}).catch(()=>{})},te=async T=>{let U=[];if(P.selectedRowKeys.forEach(ie=>{C.value.filter(Z=>Z.id==ie)[0].role_type==1||U.push(ie)}),P.selectedRowKeys=U,P.selectedRowKeys.length==0)return re.error("请选择要修改的成员");T==1?await I():T==2?await B():T==3&&await z(),a.value.handleBatchOpen(T,P.selectedRowKeys.join(","))},ce=D(null),h=()=>{if(P.selectedRowKeys.length==0)return re.error("请选择要修改的成员");ce.value.show(P.selectedRowKeys.join(","))},X=async(T,U)=>{T==1?await I():T==2?await B():T==3&&await z(),a.value.open(T,"add",U)},le=async(T,U)=>{T==1?await I():T==2?await B():T==3&&await z(),a.value.open(T,"edit",U)};return(T,U)=>{const ie=Oa,M=Yt,Z=Qe,pe=Qt,Ce=Jt,ze=qt,Le=xt,Fe=bt,Ne=Gt,he=kt,We=ya,Be=fl,Ue=et;return w(),E("div",Po,[f("div",Eo,[t(ie,{style:{"padding-right":"24px"}},{default:l(()=>[t(no,{ref_key:"departmentTreeRef",ref:c,onSelect:m,onRefresh:g},null,512)]),_:1})]),f("div",Bo,[t(ie,{style:{"padding-right":"24px"}},{default:l(()=>[f("div",Ro,[t(M,{value:_.value,"onUpdate:value":U[0]||(U[0]=A=>_.value=A),options:b,onChange:d},{label:l(({payload:A})=>[R(j(A.title),1)]),_:1},8,["value"])]),_.value==1?(w(),E(ue,{key:0},[t(Le,{justify:"space-between"},{default:l(()=>[t(Le,{gap:8},{default:l(()=>[t(Z,{type:"primary",onClick:O},{icon:l(()=>[t(Y(Xe))]),default:l(()=>[U[5]||(U[5]=R(" 添加团队成员 "))]),_:1,__:[5]}),J("",!0),t(Z,{onClick:h},{default:l(()=>U[10]||(U[10]=[R("批量修改部门")])),_:1,__:[10]})]),_:1}),t(Fe,{value:o.search,"onUpdate:value":U[4]||(U[4]=A=>o.search=A),placeholder:"输入成员账号或昵称搜索",style:{width:"288px"},onSearch:L},null,8,["value"])]),_:1}),f("div",Mo,[t(Ue,{"data-source":C.value,scroll:{x:1100},loading:N.value,"row-key":"id","row-selection":{selectedRowKeys:P.selectedRowKeys,onChange:F,getCheckboxProps:v},pagination:{current:o.page,total:o.total,pageSize:o.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:$},{default:l(()=>[t(he,{title:"成员名称","data-index":"user_name",width:"190px"},{default:l(({record:A})=>[f("div",Ao,[f("img",{src:A.avatar||Y(ut),alt:""},null,8,Ko),f("div",jo,[f("div",Fo,[A.user_name&&A.user_name.length>7?(w(),oe(Ne,{key:0,title:A.user_name},{default:l(()=>[R(j(A.user_name),1)]),_:2},1032,["title"])):(w(),E(ue,{key:1},[R(j(A.user_name),1)],64))]),f("div",Uo,[A.nick_name&&A.nick_name.length>7?(w(),oe(Ne,{key:0,title:A.nick_name},{default:l(()=>[R(j(A.nick_name),1)]),_:2},1032,["title"])):(w(),E(ue,{key:1},[R(j(A.nick_name),1)],64))])])])]),_:1}),t(he,{title:"角色","data-index":"role_name",width:"100px"},{default:l(({record:A})=>[R(j(A.role_name),1)]),_:1}),t(he,{"data-index":"departments",width:"200px"},{title:l(()=>U[11]||(U[11]=[R(" 部门 ")])),default:l(({record:A})=>[A.departments&&A.departments.length==0?(w(),E("div",Ho," -- ")):(w(),E("div",zo,[t(Ne,null,{title:l(()=>[f("div",Wo,j(V(A.departments)),1)]),default:l(()=>[f("div",Yo,[f("div",qo,j(V(A.departments)),1)])]),_:2},1024)]))]),_:1}),J("",!0),J("",!0),J("",!0),t(he,{title:"状态","data-index":"expire_status",width:"120px"},{default:l(({record:A})=>[A.expire_status==1?(w(),E("div",Jo,[t(Y(ka)),U[21]||(U[21]=R("生效中 "))])):J("",!0),A.expire_status==0?(w(),E("div",Qo,[t(Y(Bt)),U[22]||(U[22]=R("已过期 "))])):J("",!0)]),_:1}),t(he,{title:"过期时间","data-index":"expire_time_desc",width:"130px"},{default:l(({record:A})=>[R(j(A.expire_time_desc),1)]),_:1}),t(he,{title:"登录","data-index":"login_switch",width:"90px",fixed:"right"},{default:l(({record:A})=>[t(Be,{onChange:ve=>y(A),checked:A.login_switch=="1",disabled:A.role_type=="1","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked","disabled"])]),_:1}),t(he,{title:"操作","data-index":"action",width:"176px",fixed:"right"},{default:l(({record:A})=>[A.role_type=="1"?(w(),oe(Le,{key:0,gap:16},{default:l(()=>U[23]||(U[23]=[f("span",{class:"disabled"},"编辑",-1),f("span",{class:"disabled"},"重置密码",-1),f("span",{class:"disabled"},"删除",-1)])),_:1,__:[23]})):(w(),oe(Le,{key:1,gap:16},{default:l(()=>[f("a",{onClick:ve=>x(A)},"编辑",8,Go),f("a",{onClick:ve=>r(A)},"重置密码",8,Xo),f("a",{onClick:ve=>k(A)},"删除",8,Zo)]),_:2},1024))]),_:1})]),_:1},8,["data-source","loading","row-selection","pagination"])])],64)):(w(),oe(Oo,{key:1,treeParmas:u},null,8,["treeParmas"]))]),_:1}),t(cn,{ref_key:"addTeamMembersRef",ref:H,onOk:S},null,512),t(pn,{ref_key:"resetPasswordRef",ref:p,onOk:g},null,512),t(ta,{ref_key:"seeModelAlertRef",ref:a,robotList:i.value,libraryList:s.value,formList:n.value,onOk:g},null,8,["robotList","libraryList","formList"]),t(No,{ref_key:"batchEditDepartmentRef",ref:ce,onOk:S},null,512)])])}}},ts=fe(es,[["__scopeId","data-v-86831311"]]),as={class:"form-box"},ls={class:"title-row"},ns={class:"check-num"},os={key:0},ss={__name:"add-role",emits:["ok"],setup(e,{expose:_,emit:b}){const o=b,i=$e.useForm,s=D([]),n=D({}),a=D(!1),$=D("添加角色"),u=D(""),m=_e({name:"",mark:"",role_type:""}),L=_e({name:[{message:"请输入角色名称",required:!0}]}),{resetFields:C,validate:V,validateInfos:N}=i(m,L),g=async()=>{await Ca().then(O=>{let x=O.data||[];x.forEach(p=>{p.uni_key=="System"&&(p.children=p.children.filter(r=>r.uni_key!="AccountManage"))}),s.value=x;for(let p=0;p<x.length;p++){const r=x[p];n.value[r.uni_key]=[]}})},d=async()=>{await g(),$.value="添加角色",u.value="",a.value=!0,m.name="",m.mark="",C()},c=O=>{$.value="编辑角色",u.value=O.id,Sa({id:O.id}).then(x=>{let p=x.data,r=p.role_permission||[];m.name=p.name,m.mark=p.mark,m.role_type=p.role_type,n.value=S(s.value,r),a.value=!0})},S=(O,x)=>{let p={};return O.forEach(r=>{p[r.uni_key]=[];for(let k=0;k<r.children.length;k++){const I=r.children[k];x.includes(I.uni_key)&&p[r.uni_key].push(I.uni_key),I.children&&I.children.length>0&&I.children.forEach(B=>{x.includes(B.uni_key)&&p[r.uni_key].push(B.uni_key)})}}),p},P=O=>{let x=[];for(let p in O)O[p].map(k=>{x.push(k)});return x},F=()=>{V().then(()=>{let O=P(n.value),x={id:u.value,mark:m.mark};m.role_type==0&&(x.name=m.name,x.role_type=m.role_type,x.uni_keys=O.join(",")),$a(x).then(p=>{a.value=!1,re.success("保存成功"),o("ok")})})},v=(O,x)=>{O.children&&Ae(()=>{if(!n.value[x].includes(O.uni_key)){let p=O.children.map(r=>r.uni_key);n.value[x]=n.value[x].filter(r=>!p.includes(r))}})},y=(O,x,p)=>{Ae(()=>{n.value[p].includes(O.uni_key)&&(n.value[p].push(x.uni_key),n.value[p]=[...new Set(n.value[p])])})},H=O=>{let x=O.length;return O.forEach(p=>{p.children&&p.children.length&&(x=x+p.children.length)}),x};return Ta(()=>{g()}),_({add:d,edit:c}),(O,x)=>{const p=gt,r=Ge,k=hl,I=xt,B=yl,z=bl,te=kl,ce=gl,h=$e,X=me;return w(),E("div",null,[t(X,{open:a.value,"onUpdate:open":x[2]||(x[2]=le=>a.value=le),title:$.value,onOk:F,width:"746px"},{default:l(()=>[f("div",as,[t(h,{layout:"vertical"},{default:l(()=>[t(r,ye({label:"角色名称"},Y(N).name),{default:l(()=>[t(p,{type:"text",maxlength:100,disabled:m.role_type>0,placeholder:"请输入角色名称",value:m.name,"onUpdate:value":x[0]||(x[0]=le=>m.name=le)},null,8,["disabled","value"])]),_:1},16),t(r,{label:"角色备注"},{default:l(()=>[t(k,{value:m.mark,"onUpdate:value":x[1]||(x[1]=le=>m.mark=le),placeholder:"请输入角色备注"},null,8,["value"])]),_:1}),t(r,{label:"角色权限"},{default:l(()=>[(w(!0),E(ue,null,Ke(s.value,le=>(w(),E("div",{class:"role-check-box",key:le.uni_key},[t(I,{class:"title-boock",justify:"space-between"},{default:l(()=>[f("div",ls,j(le.name),1),f("div",ns,j(n.value[le.uni_key].length)+"/"+j(H(le.children)),1)]),_:2},1024),t(ce,{value:n.value[le.uni_key],"onUpdate:value":T=>n.value[le.uni_key]=T,style:{width:"100%"}},{default:l(()=>[t(te,{gutter:[0,12]},{default:l(()=>[(w(!0),E(ue,null,Ke(le.children,T=>(w(),oe(z,{span:T.children&&T.children.length?12:6,key:T.uni_key},{default:l(()=>[t(B,{onChange:U=>v(T,le.uni_key),disabled:m.role_type>0,value:T.uni_key},{default:l(()=>[R(j(T.name),1)]),_:2},1032,["onChange","disabled","value"]),T.children&&T.children.length>0?(w(),E("span",os,[x[3]||(x[3]=R("( ")),(w(!0),E(ue,null,Ke(T.children,U=>(w(),oe(B,{onChange:ie=>y(U,T,le.uni_key),key:U.uni_key,disabled:m.role_type>0,value:U.uni_key},{default:l(()=>[R(j(U.name),1)]),_:2},1032,["onChange","disabled","value"]))),128)),x[4]||(x[4]=R(" )"))])):J("",!0)]),_:2},1032,["span"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])]))),128))]),_:1})]),_:1})])]),_:1},8,["open","title"])])}}},is=fe(ss,[["__scopeId","data-v-3c53c3cd"]]),rs={class:"team-members-pages"},ds={class:"list-box"},cs={__name:"role-permissions",setup(e){D("");const _=_e({page:1,size:10,total:0,search:""}),b=D([{}]),o=m=>{_.page=m.current,_.size=m.pageSize,s()},i=()=>{_.page=1,s()},s=()=>{let m={page:_.page,size:_.size,search:_.search};Et(m).then(L=>{let C=L.data.list;C.forEach(V=>{V.update_time=Oe(V.update_time*1e3).format("YYYY-MM-DD HH:mm")}),b.value=C,_.total=+L.data.total})};i();const n=D(null),a=()=>{n.value.add()},$=m=>{n.value.edit(m)},u=m=>{me.confirm({title:"提示?",icon:t(He),content:"确认删除该角色",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{La({id:m.id}).then(L=>{re.success("删除成功"),s()})},onCancel(){}})};return(m,L)=>{const C=Qe,V=bt,N=xt,g=kt,d=et;return w(),E("div",rs,[t(N,{justify:"space-between"},{default:l(()=>[t(C,{type:"primary",onClick:a},{icon:l(()=>[t(Y(Xe))]),default:l(()=>[L[1]||(L[1]=R(" 添加角色 "))]),_:1,__:[1]}),t(V,{value:_.search,"onUpdate:value":L[0]||(L[0]=c=>_.search=c),placeholder:"输入角色名称",style:{width:"288px"},onSearch:i},null,8,["value"])]),_:1}),f("div",ds,[t(d,{"data-source":b.value,pagination:{current:_.page,total:_.total,pageSize:_.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:o},{default:l(()=>[t(g,{title:"角色","data-index":"name",width:"157px"},{default:l(({record:c})=>[R(j(c.name),1)]),_:1}),t(g,{title:"备注","data-index":"mark",width:"480px"},{default:l(({record:c})=>[R(j(c.mark),1)]),_:1}),t(g,{title:"最近修改时间","data-index":"update_time",width:"150px"},{default:l(({record:c})=>[R(j(c.update_time),1)]),_:1}),t(g,{title:"最近修改人","data-index":"operate_name",width:"130px"},{default:l(({record:c})=>[R(j(c.operate_name),1)]),_:1}),t(g,{title:"创建人","data-index":"create_name",width:"130px"},{default:l(({record:c})=>[R(j(c.create_name),1)]),_:1}),t(g,{title:"操作","data-index":"action",width:"178px"},{default:l(({record:c})=>[t(N,{gap:16,class:"action-box"},{default:l(()=>[t(C,{type:"link",onClick:S=>$(c)},{default:l(()=>L[2]||(L[2]=[R("编辑")])),_:2,__:[2]},1032,["onClick"]),t(C,{type:"link",onClick:S=>u(c),disabled:c.role_type<=3&&c.role_type>0},{default:l(()=>L[3]||(L[3]=[R("删除")])),_:2,__:[3]},1032,["onClick","disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),t(is,{ref_key:"addRoleRef",ref:n,onOk:s},null,512)])}}},us=fe(cs,[["__scopeId","data-v-e2c92e52"]]),_s={class:"user-model-page"},ps={class:"list-wrapper"},vs={__name:"index",setup(e){const _=D(1),b=()=>{_.value};return(o,i)=>(w(),E("div",_s,[t(ql,{value:_.value,"onUpdate:value":i[0]||(i[0]=s=>_.value=s),onChange:b},null,8,["value"]),f("div",ps,[_.value==1?(w(),oe(ts,{key:0})):(w(),oe(us,{key:1}))])]))}},Bi=fe(vs,[["__scopeId","data-v-752bf84e"]]);export{Bi as default};
