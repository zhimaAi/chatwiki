import{L as i,M as k,V as e,j as t,X as L,Y as R,S as le,a8 as N,P as z,Q as o,W as et,a2 as we,r as w,d as G,A as P,E as ne,G as ie,u as I,a9 as K,a3 as H,a4 as W,a0 as tt,F as B,a1 as T,w as me,k as ot,ac as be,ae as ye,b as Se,h as Me,v as je,y as st,ab as nt,U as it,a6 as at,p as lt}from"./vue-chunks-XoCroLmQ.js";import{_ as Q,c as ae,B as te,K as ct,N as Oe,e as Z,M as ce,O as ve,P as rt,Q as dt,S as ke,E as _t}from"../../index-BokOG9ZU.js";import{_ as he}from"./index-D_iED9iI.js";import{C as ut,E as pt}from"./cu-upload-BMhc0ky3.js";import"./index-BitUTYbL.js";import{I as re}from"./Input-CUxLS_nc.js";import{_ as ge}from"./TextArea-TiJWDxF4.js";import{C as mt}from"./cu-scroll-BkH1o8JX.js";import{c as vt,s as ht}from"./index-_RnYw74I.js";import{_ as ft}from"./index-CuGlvjpm.js";import{S as qe}from"./index-Bf_Ayn3y.js";import{_ as De,T as Ne}from"./index-CTUPCv9m.js";import{P as Ce}from"./PlusOutlined-B3xrJfbK.js";import{_ as de}from"./index-LNRiZDUc.js";import{c as Ve}from"./index-DsZKODME.js";import{S as Be,a as Pe,_ as Qe}from"./index-DgLLvjt3.js";import{_ as Te}from"./index-D-eQgOQ1.js";import{_ as Ie}from"./index-D35cinO1.js";import{Q as Y}from"./QuestionCircleOutlined-DEWzrvxy.js";import{_ as Re}from"./index-BPT5gdLF.js";import{_ as bt,a as yt}from"./index-D3MKxuxN.js";import{_ as _e}from"./index-BOYSy9Pq.js";import{g as Fe}from"./index-CbAgVi9e.js";import{S as kt}from"./SearchOutlined-BfUHdq7e.js";import{S as gt}from"./SyncOutlined-HsySBC9D.js";import{C as Je,_ as Ke}from"./index-BJ6pqfZz.js";import{_ as $t}from"./index-D8UclsBd.js";import{g as He}from"./index-naxAOiU8.js";import{_ as xt}from"./empty-CzGZrENG.js";import{d as Ee}from"./vuedraggable.umd-BaM7Cu0d.js";import"./index-BgMvvztK.js";import{R as wt,_ as St}from"./RadioButton-DYdQQdGT.js";import{F as ze,_ as qt}from"./index-fISAHuLd.js";import{u as Ct}from"./robot-DcQccRC9.js";import"./dayjs-D8VPPBbu.js";import"./axios-Cm0UX6qg.js";import"./qs-D73tJGQG.js";import"./crypto-js-D323TfIu.js";import"./FormItemContext-Ch_K4tn1.js";import"./index-Co375E0k.js";import"./Search-CbUpX_hw.js";import"./inputProps-CWzf5mAp.js";import"./Password-D_H-hnpK.js";import"./index-CnyiohbP.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./colors-Cfqlh7qR.js";import"./index-CvsTLiPQ.js";import"./shallowequal-BeorLzKa.js";import"./collapseMotion-DWwsCVG2.js";import"./slide-BpJSAeCl.js";import"./Dropdown-aJrAR27s.js";import"./useRefs-C13sH2-_.js";import"./pick-CWDMpHLW.js";import"./isMobile-D_4OiXLP.js";import"./CheckOutlined-Byfa85ke.js";import"./DownOutlined-I-3QmTPt.js";import"./move-ChusaJh2.js";import"./responsiveObserve-Cyut9UHK.js";const It={class:"edit-box-header"},Rt={class:"left-box"},Et={class:"edit-box-title"},Ut={key:0},Lt={key:0,class:"title-tip"},At={class:"right-box"},Ot={class:"extra-box"},zt={class:"actions-box"},Mt={__name:"edit-box",props:{iconName:{type:String,default:""},title:{type:String,default:""},isEdit:{type:Boolean,default:!1},bodyStyle:{type:Object,default:()=>({})}},emits:["update:isEdit","save","edit"],setup(p,{emit:r}){const b=r,h=p,s=a=>{b("edit"),b("update:isEdit",a)},d=()=>{b("save")};return(a,q)=>{const n=ae,S=te,c=he;return i(),k("div",{class:we(["edit-box",{"is-edit":p.isEdit}])},[e("div",It,[e("div",Rt,[t(n,{class:"edit-box-icon",name:h.iconName},null,8,["name"]),e("span",Et,[L(R(h.title)+" ",1),a.$slots.icon?(i(),k("span",Ut,[le(a.$slots,"icon",{},void 0,!0)])):N("",!0)]),a.$slots.tip?(i(),k("span",Lt,[le(a.$slots,"tip",{},void 0,!0)])):N("",!0)]),e("div",At,[e("div",Ot,[le(a.$slots,"extra",{},()=>[e("div",zt,[h.isEdit?(i(),z(c,{key:0,gap:8},{default:o(()=>[t(S,{onClick:d,size:"small",type:"primary"},{default:o(()=>[L("保存")]),_:1}),t(S,{onClick:q[0]||(q[0]=x=>s(!1)),size:"small"},{default:o(()=>[L("取消")]),_:1})]),_:1})):(i(),z(S,{key:1,onClick:q[1]||(q[1]=x=>s(!0)),size:"small"},{default:o(()=>[L("修改")]),_:1}))])],!0)])])]),e("div",{class:"edit-box-body",style:et({...p.bodyStyle})},[le(a.$slots,"default",{},void 0,!0)],4)],2)}}},X=Q(Mt,[["__scopeId","data-v-1b63f826"]]),We=p=>(H("data-v-c384f413"),p=p(),W(),p),jt={class:"robot-form-box"},Dt={class:"form-item"},Nt=We(()=>e("div",{class:"form-item-label"},"机器人名称/头像",-1)),Vt={class:"form-item-body robot-name-item"},Bt={class:"robot-avetar-upload"},Pt=["src"],Qt={class:"robot-name-box"},Tt={class:"form-item"},Ft=We(()=>e("div",{class:"form-item-label"},"简介",-1)),Jt={class:"form-item-body"},Kt={class:"robot-info-box"},Ht={class:"robot-name-box"},Wt=["src"],Gt={class:"robot-name"},Zt={class:"robot-intro"},Yt={__name:"basic-config",setup(p){const r=w(!1),{robotInfo:b,updateRobotInfo:h}=G("robotInfo"),s=P({robot_name:"",robot_avatar:"",robot_avatar_url:"",robot_intro:""}),d=()=>{h({...K(s)}),r.value=!1},a=n=>{let S=n[0];return s.robot_avatar=S,ct(S).then(c=>{s.robot_avatar_url=c}),!1},q=()=>{s.robot_name=b.robot_name,s.robot_intro=b.robot_intro,s.robot_avatar=b.robot_avatar,s.robot_avatar_url=b.robot_avatar_url};return(n,S)=>{const c=re,x=ge;return i(),z(X,{class:"basic-config",title:"基本配置","icon-name":"jibenpeizhi",isEdit:r.value,"onUpdate:isEdit":S[2]||(S[2]=l=>r.value=l),onSave:d,onEdit:q},{default:o(()=>[ne(e("div",jt,[e("div",Dt,[Nt,e("div",Vt,[t(ut,{accept:"image/*",onChange:a},{default:o(()=>[e("div",Bt,[s.robot_avatar_url?(i(),k("img",{key:0,class:"robot-avetar",src:s.robot_avatar_url},null,8,Pt)):N("",!0)])]),_:1}),e("div",Qt,[t(c,{value:s.robot_name,"onUpdate:value":S[0]||(S[0]=l=>s.robot_name=l),placeholder:"请输入机器人名称"},null,8,["value"])])])]),e("div",Tt,[Ft,e("div",Jt,[t(x,{rows:3,value:s.robot_intro,"onUpdate:value":S[1]||(S[1]=l=>s.robot_intro=l),placeholder:"请输入机器人简介，比如 ZHIMA CHATAI 基于大语言模型提供ZHIMA CHATAI 产品帮助。","allow-clear":""},null,8,["value"])])])],512),[[ie,r.value]]),ne(e("div",Kt,[e("div",Ht,[e("img",{class:"robot-avatar",src:I(b).robot_avatar_url,alt:""},null,8,Wt),e("span",Gt,R(I(b).robot_name),1)]),e("div",Zt,R(I(b).robot_intro||"还没有设置机器人介绍，快来写一段简介吧"),1)],512),[[ie,!r.value]])]),_:1},8,["isEdit"])}}},Xt=Q(Yt,[["__scopeId","data-v-c384f413"]]),Ge=p=>(H("data-v-896a48d0"),p=p(),W(),p),eo={class:"ai-create-box"},to={class:"input-box"},oo=Ge(()=>e("span",null,"生成",-1)),so={class:"quick-tags-box"},no=Ge(()=>e("div",{class:"quick-label"},"快捷生成：",-1)),io={class:"ai-list-box"},ao={key:0,class:"loading-box"},lo={key:0,class:"prompt-list-box"},co={class:"prompt-list"},ro={class:"prompt-header"},_o={class:"prompt-title"},uo={class:"prompt-content"},po={class:"prompt-list"},mo={class:"prompt-header"},vo={class:"prompt-title"},ho={class:"prompt-content"},fo={class:"prompt-list"},bo={class:"prompt-header"},yo={class:"prompt-title"},ko={class:"prompt-content"},go={class:"prompt-list"},$o={class:"prompt-header"},xo={class:"prompt-title"},wo={class:"prompt-content"},So={class:"prompt-list"},qo={class:"prompt-header"},Co={class:"prompt-title"},Io={class:"prompt-content"},Ro={class:"prompt-header"},Eo={class:"prompt-title"},Uo={class:"prompt-content"},Lo={key:1,class:"empty-box"},Ao={__name:"ai-create-prompt",emits:["handleAiSave"],setup(p,{expose:r,emit:b}){const h=Oe.PRESENTED_IMAGE_SIMPLE,s=w(!1),d=w(!1),a=tt().query,q=b,n=w(""),S=w(!1),c=[{title:"创建一个电商行业售后客服"},{title:"创建一个英语教育机构官网售前机器人"}],x=w("在上方输入框输入要求，点击生成提示词"),l=()=>{_.value=!1,y.promptStruct=C,n.value="",x.value="在上方输入框输入要求，点击生成提示词",s.value=!0},_=w(!1),C={role:{subject:"",describe:""},task:{subject:"",describe:""},constraints:{subject:"",describe:""},output:{subject:"",describe:""},tone:{subject:"",describe:""},custom:[]},y=P({promptStruct:C}),f=g=>{n.value=g},v=()=>{if(!n.value)return Z.error("请输入AI 生成提示词");if(S.value)return Z.error("正在生成中...");S.value=!0,vt({id:a.id,demand:n.value}).then(g=>{y.promptStruct=JSON.parse(g.data.promptStruct),_.value=!0}).finally(()=>{S.value=!1}).catch(g=>{_.value=!1,x.value=g.msg})},$=()=>{if(!_.value)return Z.error("请先生成提示词");q("handleAiSave",y.promptStruct),s.value=!1};return r({show:l}),(g,u)=>{const O=te,V=re,F=ae,M=ft,m=qe,A=Oe,J=mt,ee=ce;return i(),k("div",null,[t(ee,{open:s.value,"onUpdate:open":u[1]||(u[1]=D=>s.value=D),title:"AI 生成提示词",width:746},{footer:o(()=>[t(O,{type:"primary",loading:d.value,onClick:$},{default:o(()=>[L("使用该提示")]),_:1},8,["loading"])]),default:o(()=>[e("div",eo,[e("div",to,[t(V,{style:{width:"100%"},value:n.value,"onUpdate:value":u[0]||(u[0]=D=>n.value=D),size:"large",onPressEnter:v,placeholder:"请输入AI 生成提示词例如：创建一个电商行业售后客服"},null,8,["value"]),e("div",{class:"btn-box",onClick:v},[t(F,{name:"ai-mark"}),oo])]),e("div",so,[no,(i(),k(B,null,T(c,D=>t(M,{key:D.title,onClick:E=>f(D.title),color:"blue"},{default:o(()=>[L(R(D.title),1)]),_:2},1032,["onClick"])),64))]),e("div",io,[t(J,{style:{height:"100%"}},{default:o(()=>[S.value?(i(),k("div",ao,[t(m,{tip:"正在生成中..."})])):(i(),k(B,{key:1},[_.value?(i(),k("div",lo,[e("div",co,[e("div",ro,[e("div",_o,R(y.promptStruct.role.subject),1)]),e("div",uo,R(y.promptStruct.role.describe),1)]),e("div",po,[e("div",mo,[e("div",vo,R(y.promptStruct.task.subject),1)]),e("div",ho,R(y.promptStruct.task.describe),1)]),e("div",fo,[e("div",bo,[e("div",yo,R(y.promptStruct.constraints.subject),1)]),e("div",ko,R(y.promptStruct.constraints.describe),1)]),e("div",go,[e("div",$o,[e("div",xo,R(y.promptStruct.output.subject),1)]),e("div",wo,R(y.promptStruct.output.describe),1)]),e("div",So,[e("div",qo,[e("div",Co,R(y.promptStruct.tone.subject),1)]),e("div",Io,R(y.promptStruct.tone.describe),1)]),(i(!0),k(B,null,T(y.promptStruct.custom,(D,E)=>(i(),k("div",{class:"prompt-list",key:E+D.key?D.key:""},[e("div",Ro,[e("div",Eo,R(D.subject),1)]),e("div",Uo,R(D.describe),1)]))),128))])):(i(),k("div",Lo,[t(A,{image:I(h),description:x.value},null,8,["image","description"])]))],64))]),_:1})])])]),_:1},8,["open"])])}}},Oo=Q(Ao,[["__scopeId","data-v-896a48d0"]]),zo={class:"prompt-box"},Mo={class:"tab-header"},jo={key:0,class:"opt-block"},Do={key:1,class:"opt-block"},No={key:0,class:"prompt-list-box"},Vo={class:"prompt-list"},Bo={class:"prompt-header"},Po={class:"prompt-title"},Qo={key:0,class:"btn-wrapper-box"},To={class:"prompt-content"},Fo={class:"prompt-list"},Jo={class:"prompt-header"},Ko={class:"prompt-title"},Ho={key:0,class:"btn-wrapper-box"},Wo={class:"prompt-content"},Go={class:"prompt-list"},Zo={class:"prompt-header"},Yo={class:"prompt-title"},Xo={key:0,class:"btn-wrapper-box"},es={class:"prompt-content"},ts={class:"prompt-list"},os={class:"prompt-header"},ss={class:"prompt-title"},ns={key:0,class:"btn-wrapper-box"},is={class:"swich-item"},as={class:"swich-item"},ls={class:"prompt-content"},cs={class:"prompt-list"},rs={class:"prompt-header"},ds={class:"prompt-title"},_s={key:0,class:"btn-wrapper-box"},us={class:"prompt-content"},ps={class:"prompt-header"},ms={class:"prompt-title",style:{flex:"1"}},vs={key:0,class:"btn-wrapper-box"},hs=["onClick"],fs={class:"prompt-content"},bs={key:0,class:"add-theme-block"},ys={key:1,class:"diy-prompt-box"},ks={key:0,class:"diy-switch-box"},gs={class:"swich-item"},$s={class:"swich-item"},oe="- 请使用markdown格式回答问题。",se="- 当你选择的知识点中包含图片、链接数据时，你需要在你的答案对应位置输出这些数据，不要改写或忽略这些数据。",xs={__name:"system-prompt-words",setup(p){const r=w(!1),{robotInfo:b,updateRobotInfo:h}=G("robotInfo");let s={role:"请输入，告知大模型要扮演的身份、职责、沟通风格等，比如“你扮演一名经验丰富的电商行业售后客服AI助手，具备良好的沟通能力和解决问题的能力。”",task:"请输入，比如“根据提供的知识库资料，找到对应的售后知识（每个知识点之间使用⧼-split_line-⧽进行分割），快速准确回答用户的问题。”",constraints:"请输入对大模型在回复时的要求，比如“你的回答应该使用自然的对话方式，简单直接地回答，不要解释你的答案；当用户问题没有找到相关知识点时，直接告诉用户问题暂时无法回答，不能胡编乱造，否则你将受到惩罚。”",output:"请输入对大模型输出格式的要求，比如“请使用markdown格式输出”",tone:"请告知语言风格要求，比如“专业而不失亲切，适当使用emoji增强可读性”"};const d=w({}),a=w(!1),q=w(!1),n=w(!1),S=w(!1),c=P({prompt:"",prompt_struct:{role:{subject:"",describe:""},task:{subject:"",describe:""},constraints:{subject:"",describe:""},output:{subject:"",describe:""},tone:{subject:"",describe:""},custom:[]}}),x=(M,m)=>M.includes(m),l=w(b.prompt_type);me(()=>b,()=>{c.prompt=b.prompt,c.prompt_struct=b.prompt_struct,d.value=b.prompt_struct_default},{immediate:!0,deep:!0}),me(()=>c.prompt_struct.output.describe,M=>{a.value=x(M,oe),q.value=x(M,se)},{immediate:!0,deep:!0}),me(()=>c.prompt,M=>{n.value=x(M,oe),S.value=x(M,se)},{immediate:!0,deep:!0});const _=(M,m)=>{M?(m=="outSwitch"&&(c.prompt_struct.output.describe?c.prompt_struct.output.describe+=`
`+oe:c.prompt_struct.output.describe+=oe),m=="imgSwitch"&&(c.prompt_struct.output.describe?c.prompt_struct.output.describe+=`
`+se:c.prompt_struct.output.describe+=se)):(m=="outSwitch"&&(c.prompt_struct.output.describe=c.prompt_struct.output.describe.replace(new RegExp(oe,"g"),"")),m=="imgSwitch"&&(c.prompt_struct.output.describe=c.prompt_struct.output.describe.replace(new RegExp(se,"g"),"")),c.prompt_struct.output.describe=c.prompt_struct.output.describe.trim())},C=(M,m)=>{M?(m=="outDiySwitch"&&(c.prompt?c.prompt+=`
`+oe:c.prompt+=oe),m=="imgDiySwitch"&&(c.prompt?c.prompt+=`
`+se:c.prompt+=se)):(m=="outDiySwitch"&&(c.prompt=c.prompt.replace(new RegExp(oe,"g"),"")),m=="imgDiySwitch"&&(c.prompt=c.prompt.replace(new RegExp(se,"g"),"")),c.prompt=c.prompt.trim())},y=M=>{c.prompt_struct[M].describe=d.value[M].describe},f=()=>{c.prompt_struct.custom.push({subject:"",describe:"",key:Math.random()*1e4}),l.value=1},v=M=>{c.prompt_struct.custom.splice(M,1)},$=()=>{h({...K(c),prompt_type:l.value}),r.value=!1},g=M=>{l.value=1,h({prompt_type:l.value,prompt:c.prompt,prompt_struct:M}),r.value=!1},u=()=>{r.value=!0},O=()=>{r.value=!1},V=w(null),F=()=>{V.value.show()};return(M,m)=>{const A=De,J=Ne,ee=ae,D=te,E=he,j=ge,pe=de,Xe=re;return i(),k("div",zo,[e("div",Mo,[t(J,{activeKey:l.value,"onUpdate:activeKey":m[0]||(m[0]=U=>l.value=U)},{default:o(()=>[(i(),z(A,{key:1,tab:"结构化提示词"})),(i(),z(A,{key:0,tab:"自定义提示词"}))]),_:1},8,["activeKey"]),r.value?(i(),k("div",jo,[e("div",{class:"ai-mark-box",onClick:F},[t(ee,{name:"ai-mark"}),L(" AI自动生成 ")]),t(E,{gap:8},{default:o(()=>[t(D,{size:"small",type:"primary",onClick:$},{default:o(()=>[L("保存")]),_:1}),t(D,{size:"small",onClick:O},{default:o(()=>[L("取消")]),_:1})]),_:1})])):(i(),k("div",Do,[t(D,{size:"small",onClick:u},{default:o(()=>[L("修改")]),_:1})]))]),l.value==1?(i(),k("div",No,[e("div",Vo,[e("div",Bo,[e("div",Po,R(c.prompt_struct.role.subject),1),r.value?(i(),k("div",Qo,[e("a",{onClick:m[1]||(m[1]=U=>y("role"))},"恢复默认")])):N("",!0)]),e("div",To,[t(j,{bordered:!1,disabled:!r.value,value:c.prompt_struct.role.describe,"onUpdate:value":m[2]||(m[2]=U=>c.prompt_struct.role.describe=U),placeholder:I(s).role,"auto-size":{minRows:1,maxRows:5}},null,8,["disabled","value","placeholder"])])]),e("div",Fo,[e("div",Jo,[e("div",Ko,R(c.prompt_struct.task.subject),1),r.value?(i(),k("div",Ho,[e("a",{onClick:m[3]||(m[3]=U=>y("task"))},"恢复默认")])):N("",!0)]),e("div",Wo,[t(j,{bordered:!1,disabled:!r.value,value:c.prompt_struct.task.describe,"onUpdate:value":m[4]||(m[4]=U=>c.prompt_struct.task.describe=U),placeholder:I(s).task,"auto-size":{minRows:1,maxRows:5}},null,8,["disabled","value","placeholder"])])]),e("div",Go,[e("div",Zo,[e("div",Yo,R(c.prompt_struct.constraints.subject),1),r.value?(i(),k("div",Xo,[e("a",{onClick:m[5]||(m[5]=U=>y("constraints"))},"恢复默认")])):N("",!0)]),e("div",es,[t(j,{bordered:!1,disabled:!r.value,value:c.prompt_struct.constraints.describe,"onUpdate:value":m[6]||(m[6]=U=>c.prompt_struct.constraints.describe=U),placeholder:I(s).constraints,"auto-size":{minRows:1,maxRows:5}},null,8,["disabled","value","placeholder"])])]),e("div",ts,[e("div",os,[e("div",ss,R(c.prompt_struct.output.subject),1),r.value?(i(),k("div",ns,[e("div",is,[L(" 输出markdown： "),t(pe,{onChange:m[7]||(m[7]=U=>_(U,"outSwitch")),checked:a.value,"onUpdate:checked":m[8]||(m[8]=U=>a.value=U),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),e("div",as,[L(" 回复图片： "),t(pe,{onChange:m[9]||(m[9]=U=>_(U,"imgSwitch")),checked:q.value,"onUpdate:checked":m[10]||(m[10]=U=>q.value=U),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),e("a",{onClick:m[11]||(m[11]=U=>y("output"))},"恢复默认")])):N("",!0)]),e("div",ls,[t(j,{bordered:!1,disabled:!r.value,value:c.prompt_struct.output.describe,"onUpdate:value":m[12]||(m[12]=U=>c.prompt_struct.output.describe=U),placeholder:I(s).output,"auto-size":{minRows:1,maxRows:5}},null,8,["disabled","value","placeholder"])])]),e("div",cs,[e("div",rs,[e("div",ds,R(c.prompt_struct.tone.subject),1),r.value?(i(),k("div",_s,[e("a",{onClick:m[13]||(m[13]=U=>y("tone"))},"恢复默认")])):N("",!0)]),e("div",us,[t(j,{bordered:!1,disabled:!r.value,value:c.prompt_struct.tone.describe,"onUpdate:value":m[14]||(m[14]=U=>c.prompt_struct.tone.describe=U),placeholder:I(s).tone,"auto-size":{minRows:1,maxRows:5}},null,8,["disabled","value","placeholder"])])]),(i(!0),k(B,null,T(c.prompt_struct.custom,(U,Ae)=>(i(),k("div",{class:"prompt-list",key:Ae+U.key?U.key:""},[e("div",ps,[e("div",ms,[t(Xe,{bordered:!1,disabled:!r.value,style:{width:"100%"},value:U.subject,"onUpdate:value":fe=>U.subject=fe,placeholder:"请输入主题"},null,8,["disabled","value","onUpdate:value"])]),r.value?(i(),k("div",vs,[e("div",{class:"hover-btn-box",onClick:fe=>v(Ae)},[t(I(ve))],8,hs)])):N("",!0)]),e("div",fs,[t(j,{bordered:!1,disabled:!r.value,value:U.describe,"onUpdate:value":fe=>U.describe=fe,placeholder:"请输入","auto-size":{minRows:1,maxRows:5}},null,8,["disabled","value","onUpdate:value"])])]))),128)),r.value?(i(),k("div",bs,[t(D,{onClick:f,block:"",icon:ot(I(Ce))},{default:o(()=>[L("添加主题")]),_:1},8,["icon"])])):N("",!0)])):(i(),k("div",ys,[r.value?(i(),k("div",ks,[e("div",gs,[L(" 输出markdown： "),t(pe,{size:"small",onChange:m[15]||(m[15]=U=>C(U,"outDiySwitch")),checked:n.value,"onUpdate:checked":m[16]||(m[16]=U=>n.value=U),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),e("div",$s,[L(" 回复图片： "),t(pe,{size:"small",onChange:m[17]||(m[17]=U=>C(U,"imgDiySwitch")),checked:S.value,"onUpdate:checked":m[18]||(m[18]=U=>S.value=U),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])])])):N("",!0),t(j,{bordered:r.value,value:c.prompt,"onUpdate:value":m[19]||(m[19]=U=>c.prompt=U),disabled:!r.value,placeholder:"请输入","auto-size":{minRows:5,maxRows:15}},null,8,["bordered","value","disabled"])])),t(Oo,{onHandleAiSave:g,ref_key:"aiCreatePromptRef",ref:V},null,512)])}}},ws=Q(xs,[["__scopeId","data-v-d7a4087c"]]),$e=p=>(H("data-v-ba5c9280"),p=p(),W(),p),Ss={class:"actions-box"},qs={class:"model-name"},Cs={key:0,class:"form-box"},Is={class:"form-item"},Rs=$e(()=>e("div",{class:"form-item-label"},[e("span",null,"LLM模型 ")],-1)),Es={class:"form-item-body"},Us=["src"],Ls={key:0},As={key:1},Os={class:"form-item"},zs={class:"form-item-label"},Ms=$e(()=>e("span",null,"温度 ",-1)),js={class:"form-item-body"},Ds={class:"number-box"},Ns={class:"number-slider-box"},Vs={class:"number-input-box"},Bs={class:"form-item"},Ps={class:"form-item-label"},Qs=$e(()=>e("span",null,"最大token ",-1)),Ts={class:"form-item-body"},Fs={class:"number-box"},Js={class:"number-slider-box"},Ks={class:"number-input-box"},Hs={class:"form-item"},Ws={class:"form-item-label"},Gs=$e(()=>e("span",null,"上下文数量 ",-1)),Zs={class:"form-item-body"},Ys={class:"number-box"},Xs={class:"number-slider-box"},en={class:"number-input-box"},tn={__name:"model-settings",setup(p){const r=["azure","ollama","xinference","openaiAgent"],b=["azure"],h=P({sm:24,md:24,lg:12,xl:8,xxl:8}),s=w([]),d=w(!1),{robotInfo:a,updateRobotInfo:q}=G("robotInfo"),n=P({use_model:void 0,model_config_id:"",temperature:0,max_token:0,context_pair:0}),S=w(""),c=w(""),x=w(""),l=(v,$)=>{const g=$.current_obj;n.use_model=r.indexOf(g.model_define)>-1&&g.deployment_name?g.deployment_name:g.name,S.value=g.model_define,n.model_config_id=g.id||$.model_config_id},_=()=>{x.value=n.use_model,b.indexOf(S.value)>-1&&(n.use_model="默认"),q({...K(n)}),d.value=!1},C=v=>{v||(S.value=c.value),r.indexOf(S.value)>-1?n.use_model=x.value:n.use_model=a.use_model,n.model_config_id=a.model_config_id,n.temperature=a.temperature,n.max_token=a.max_token,n.context_pair=a.context_pair,d.value=v};function y(v,$,g){const u=new Set(v.map(O=>O.model_define));return $.filter(O=>{let V=O[g];u.has(V)&&v.filter(F=>{if(F.model_define==V)return F.children=dt(F.children,O.children),!1})}),v}return(()=>{Ve({model_type:"LLM"}).then(v=>{x.value=a.use_model;let $=v.data||[],g=[];s.value=$.map(u=>{g=[];for(let O=0;O<u.model_info.llm_model_list.length;O++){const V=u.model_info.llm_model_list[O];r.indexOf(u.model_info.model_define)>-1&&a.model_config_id==u.model_config.id&&(x.value=u.model_config.deployment_name,S.value=u.model_info.model_define,c.value=u.model_info.model_define),g.push({name:V,deployment_name:u.model_config.deployment_name,id:u.model_config.id,model_define:u.model_info.model_define})}return{id:u.model_config.id,name:u.model_info.model_name,model_define:u.model_info.model_define,icon:u.model_info.model_icon_url,children:g,deployment_name:u.model_config.deployment_name}}),s.value=y(rt(s.value,"model_define"),s.value,"model_define")})})(),(v,$)=>{const g=te,u=he,O=Re,V=Be,F=Pe,M=Qe,m=bt,A=_e,J=Te,ee=Ie,D=yt;return i(),z(X,{class:"setting-box",title:"模型设置","icon-name":"moxingshezhi",isEdit:d.value,"onUpdate:isEdit":$[9]||($[9]=E=>d.value=E)},{extra:o(()=>[e("div",Ss,[d.value?(i(),z(u,{key:0,gap:8},{default:o(()=>[t(g,{onClick:_,size:"small",type:"primary"},{default:o(()=>[L("保存")]),_:1}),t(g,{onClick:$[0]||($[0]=E=>C(!1)),size:"small"},{default:o(()=>[L("取消")]),_:1})]),_:1})):(i(),k(B,{key:1},[e("span",qs,R(x.value),1),t(O,{type:"vertical"}),t(g,{onClick:$[1]||($[1]=E=>C(!0)),size:"small"},{default:o(()=>[L("修改")]),_:1})],64))])]),default:o(()=>[d.value?(i(),k("div",Cs,[t(D,{gutter:[32,16]},{default:o(()=>[t(m,be(ye(h)),{default:o(()=>[e("div",Is,[Rs,e("div",Es,[t(M,{value:n.use_model,"onUpdate:value":$[2]||($[2]=E=>n.use_model=E),placeholder:"请选择LLM模型",onChange:l,style:{width:"100%"}},{default:o(()=>[(i(!0),k(B,null,T(s.value,E=>(i(),z(F,{key:E.id},{label:o(()=>[t(u,{align:"center",gap:6},{default:o(()=>[e("img",{class:"model-icon",src:E.icon,alt:""},null,8,Us),L(R(E.name),1)]),_:2},1024)]),default:o(()=>[(i(!0),k(B,null,T(E.children,j=>(i(),z(V,{value:r.indexOf(E.model_define)>-1&&j.deployment_name?j.deployment_name:j.name+j.id,model_config_id:E.id,current_obj:j,key:j.name+j.id},{default:o(()=>[r.indexOf(E.model_define)>-1&&j.deployment_name?(i(),k("span",Ls,R(j.deployment_name),1)):(i(),k("span",As,R(j.name),1))]),_:2},1032,["value","model_config_id","current_obj"]))),128))]),_:2},1024))),128))]),_:1},8,["value"])])])]),_:1},16),t(m,be(ye(h)),{default:o(()=>[e("div",Os,[e("div",zs,[Ms,t(A,null,{title:o(()=>[L("温度越低，回答越严谨。温度越高，回答越发散。")]),default:o(()=>[t(I(Y),{class:"question-icon"})]),_:1})]),e("div",js,[e("div",Ds,[e("div",Ns,[t(J,{class:"custom-slider",value:n.temperature,"onUpdate:value":$[3]||($[3]=E=>n.temperature=E),min:0,max:2,step:.1},null,8,["value"])]),e("div",Vs,[t(ee,{value:n.temperature,"onUpdate:value":$[4]||($[4]=E=>n.temperature=E),min:0,max:2,step:.1},null,8,["value"])])])])])]),_:1},16),t(m,be(ye(h)),{default:o(()=>[e("div",Bs,[e("div",Ps,[Qs,t(A,null,{title:o(()=>[L("问题+答案的最大token数，如果出现回答被截断，可调高此值")]),default:o(()=>[t(I(Y),{class:"question-icon"})]),_:1})]),e("div",Ts,[e("div",Fs,[e("div",Js,[t(J,{class:"custom-slider",value:n.max_token,"onUpdate:value":$[5]||($[5]=E=>n.max_token=E),min:0,max:100*1024},null,8,["value"])]),e("div",Ks,[t(ee,{value:n.max_token,"onUpdate:value":$[6]||($[6]=E=>n.max_token=E),min:0,max:100*1024},null,8,["value"])])])])])]),_:1},16),t(m,be(ye(h)),{default:o(()=>[e("div",Hs,[e("div",Ws,[Gs,t(A,null,{title:o(()=>[L("提示词中携带的历史聊天记录轮次。设置为0则不携带聊天记录。最多设置10轮。注意，携带的历史聊天记录越多，消耗的token相应也就越多。")]),default:o(()=>[t(I(Y),{class:"question-icon"})]),_:1})]),e("div",Zs,[e("div",Ys,[e("div",Xs,[t(J,{class:"custom-slider",value:n.context_pair,"onUpdate:value":$[7]||($[7]=E=>n.context_pair=E),min:0,max:10},null,8,["value"])]),e("div",en,[t(ee,{value:n.context_pair,"onUpdate:value":$[8]||($[8]=E=>n.context_pair=E),min:0,max:10},null,8,["value"])])])])])]),_:1},16)]),_:1})])):N("",!0)]),_:1},8,["isEdit"])}}},on=Q(tn,[["__scopeId","data-v-ba5c9280"]]),sn={class:"library-checkbox-box"},nn={class:"list-tools"},an={class:"list-box",ref:"scrollContainer"},ln={class:"library-name"},cn={class:"library-desc"},rn={__name:"library-select-alert",emits:["change"],setup(p,{expose:r,emit:b}){const h=b,s=P({indeterminate:!1,checkAll:!1,checkedList:[]}),d=w(!1),a=f=>{l(),s.checkedList=f,d.value=!0},q=()=>{d.value=!1,x()},n=w(""),S=()=>{l()},c=w([]),x=()=>{h("change",[...s.checkedList])},l=async()=>{const f=await Fe({library_name:n.value});if(f){let v=f.data||[];c.value=v}},_=w(!1),C=async()=>{_.value=!0,await l(),_.value=!1,Z.success("刷新完成")},y=()=>{window.open("/#/library/add")};return r({open:a}),(f,v)=>{const $=$t,g=re,u=te,O=Je,V=Ke,F=qe,M=ce;return i(),z(M,{width:"746px",open:d.value,"onUpdate:open":v[2]||(v[2]=m=>d.value=m),title:"关联知识库",onOk:q},{default:o(()=>[e("div",sn,[t($,{message:"请选择关联知识库，机器人会根据知识库内上传的文档回复用户的提问。每个机器人最多关联5个知识库",type:"info"}),e("div",nn,[e("div",null,[t(g,{style:{width:"282px"},value:n.value,"onUpdate:value":v[0]||(v[0]=m=>n.value=m),placeholder:"请输入知识库名称搜索",onChange:S},{suffix:o(()=>[t(I(kt),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),e("div",null,[t(u,{style:{"margin-right":"8px"},onClick:C},{default:o(()=>[t(I(gt)),L(" 刷新 ")]),_:1}),t(u,{type:"primary",ghost:"",onClick:y},{default:o(()=>[L("新建知识库")]),_:1})])]),t(F,{spinning:_.value,delay:100},{default:o(()=>[t(V,{value:s.checkedList,"onUpdate:value":v[1]||(v[1]=m=>s.checkedList=m),style:{width:"100%"}},{default:o(()=>[e("div",an,[(i(!0),k(B,null,T(c.value,m=>(i(),k("div",{class:"list-item-wraapper",key:m.id},[t(O,{class:"list-item",value:m.id},{default:o(()=>[e("div",ln,R(m.library_name),1),e("div",cn,R(m.library_intro),1)]),_:2},1032,["value"])]))),128))],512)]),_:1},8,["value"])]),_:1},8,["spinning"])])]),_:1},8,["open"])}}},dn=Q(rn,[["__scopeId","data-v-1c861116"]]),xe=p=>(H("data-v-10169782"),p=p(),W(),p),_n={class:"recall-settings-box"},un={class:"form-box"},pn={class:"form-item is-required"},mn=xe(()=>e("div",{class:"form-item-label"},[e("span",null,"检索模式")],-1)),vn={class:"form-item-body"},hn={class:"retrieval-mode-items"},fn=["onClick"],bn={class:"retrieval-mode-title"},yn={class:"title-text"},kn={class:"retrieval-mode-desc"},gn={class:"form-item"},$n={class:"form-item-label"},xn=xe(()=>e("span",null,"Top K ",-1)),wn={class:"form-item-body"},Sn={class:"number-box"},qn={class:"number-slider-box"},Cn={class:"number-input-box"},In={class:"form-item"},Rn={class:"form-item-label"},En=xe(()=>e("span",null,"相似度阈值 ",-1)),Un={class:"form-item-body"},Ln={class:"number-box"},An={class:"number-slider-box"},On={class:"number-input-box"},zn={class:"form-item"},Mn={class:"form-item-label"},jn=xe(()=>e("span",null,"Rerank模型",-1)),Dn={class:"form-item-body"},Nn=["src"],Vn={__name:"recall-settings-alert",emits:["change"],setup(p,{expose:r,emit:b}){const h=b,s=w([{iconName:"search",title:"混合检索",value:1,isRecommendation:!0,desc:"同时执行全文检索和向量检索，使用RRF算法进行排序，从两中查询结果中选择更匹配用户问题的结果"},{iconName:"file-search",title:"向量检索",value:2,desc:"将用户提问转成向量之后与知识库分段匹配相似度，返回相似度高的结果"},{iconName:"comment-search",title:"全文检索",value:3,desc:"通过分词匹配文档中的词汇，返回包含这些词汇的文本片段"}]),d=P({rerank_status:0,rerank_use_model:void 0,rerank_model_config_id:void 0,search_type:1}),a=w(!1),q=y=>{C(),d.rerank_status=y.rerank_status||0,d.rerank_use_model=y.rerank_use_model||void 0,d.rerank_model_config_id=y.rerank_model_config_id||"",d.top_k=y.top_k,d.similarity=y.similarity,d.search_type=y.search_type,a.value=!0},n=(y,f)=>{d.rerank_model_config_id=f.rerank_model_config_id},S=y=>{d.search_type=y},c=()=>d.rerank_status==1&&!d.rerank_model_config_id,x=()=>{if(c())return Z.error("请选择Rerank模型");a.value=!1,l()},l=()=>{h("change",K(d))},_=w([]),C=()=>{Ve({model_type:"RERANK"}).then(y=>{let f=y.data||[];_.value=f.map(v=>({id:v.model_config.id,name:v.model_info.model_name,icon:v.model_info.model_icon_url,children:v.model_info.rerank_model_list}))})};return r({open:q}),(y,f)=>{const v=ae,$=_e,g=Te,u=Ie,O=de,V=Be,F=Pe,M=Qe,m=ce;return i(),z(m,{width:"472px",open:a.value,"onUpdate:open":f[6]||(f[6]=A=>a.value=A),title:"召回设置",onOk:x},{default:o(()=>[e("div",_n,[e("div",un,[e("div",pn,[mn,e("div",vn,[e("div",hn,[(i(!0),k(B,null,T(s.value,A=>(i(),k("div",{class:we(["retrieval-mode-item",{active:d.search_type==A.value}]),key:A.value,onClick:J=>S(A.value)},[d.search_type==A.value?(i(),z(v,{key:0,class:"check-arrow",name:"check-arrow-filled"})):N("",!0),e("div",bn,[t(v,{name:A.iconName,class:"title-icon"},null,8,["name"]),e("span",yn,R(A.title),1),A.isRecommendation?(i(),z(v,{key:0,class:"recommendation-icon",name:"recommendation"})):N("",!0)]),e("div",kn,R(A.desc),1)],10,fn))),128))])])]),e("div",gn,[e("div",$n,[xn,t($,null,{title:o(()=>[L("最多从知识库中召回分段数，最低为1，最高为10。召回分段数越多，消耗的token也会越多。")]),default:o(()=>[t(I(Y),{class:"question-icon"})]),_:1})]),e("div",wn,[e("div",Sn,[e("div",qn,[t(g,{class:"custom-slider",value:d.top_k,"onUpdate:value":f[0]||(f[0]=A=>d.top_k=A),min:1,max:10},null,8,["value"])]),e("div",Cn,[t(u,{value:d.top_k,"onUpdate:value":f[1]||(f[1]=A=>d.top_k=A),min:1,max:10},null,8,["value"])])])])]),e("div",In,[e("div",Rn,[En,t($,null,{title:o(()=>[L("召回时，只会召回相似度大于阈值的文本分段。取值范围：0~1，阈值越大回答的越准确，建议不超过0.9")]),default:o(()=>[t(I(Y),{class:"question-icon"})]),_:1})]),e("div",Un,[e("div",Ln,[e("div",An,[t(g,{class:"custom-slider",value:d.similarity,"onUpdate:value":f[2]||(f[2]=A=>d.similarity=A),min:0,max:1,step:.01},null,8,["value"])]),e("div",On,[t(u,{value:d.similarity,"onUpdate:value":f[3]||(f[3]=A=>d.similarity=A),min:0,max:1,step:.01},null,8,["value"])])])])]),e("div",zn,[e("div",Mn,[jn,L("   "),t(O,{checkedValue:1,unCheckedValue:0,checked:d.rerank_status,"onUpdate:checked":f[4]||(f[4]=A=>d.rerank_status=A)},null,8,["checked"])]),e("div",Dn,[t(M,{value:d.rerank_use_model,"onUpdate:value":f[5]||(f[5]=A=>d.rerank_use_model=A),placeholder:"请选择Rerank模型",onChange:n,style:{width:"320px"}},{default:o(()=>[(i(!0),k(B,null,T(_.value,A=>(i(),z(F,{key:A.id},{label:o(()=>[e("span",null,[e("img",{class:"model-icon",src:A.icon,alt:""},null,8,Nn)])]),default:o(()=>[(i(!0),k(B,null,T(A.children,J=>(i(),z(V,{value:J,rerank_model_config_id:A.id,key:J},{default:o(()=>[e("span",null,R(J),1)]),_:2},1032,["value","rerank_model_config_id"]))),128))]),_:2},1024))),128))]),_:1},8,["value"])])])])])]),_:1},8,["open"])}}},Bn=Q(Vn,[["__scopeId","data-v-10169782"]]),Pn={class:"actions-box"},Qn={key:0,class:"library-list"},Tn=["onClick"],Fn={class:"library-name"},Jn={class:"library-intro"},Kn={__name:"index",setup(p){const r=w(!1),{robotInfo:b,updateRobotInfo:h}=G("robotInfo"),s=P({library_ids:[],rerank_status:0,rerank_use_model:void 0,rerank_model_config_id:"",top_k:0,similarity:0,search_type:1}),d=w([]),a=w(null),q=Se(()=>d.value.filter(f=>s.library_ids.includes(f.id))),n=f=>{let v=s.library_ids.indexOf(f.id);s.library_ids.splice(v,1),C()},S=f=>{s.library_ids=[...f],C()},c=()=>{a.value.open([...s.library_ids])},x=w(null),l=()=>{x.value.open(K(s))},_=f=>{s.rerank_status=f.rerank_status,s.rerank_use_model=f.rerank_use_model,s.rerank_model_config_id=f.rerank_model_config_id,s.top_k=f.top_k,s.similarity=f.similarity,s.search_type=f.search_type,C()},C=()=>{let f={...K(s)};f.library_ids=f.library_ids.join(","),h({...f})};return(async()=>{const f=await Fe();f&&(d.value=f.data||[])})(),Me(()=>{s.library_ids=b.library_ids.split(","),s.rerank_status=b.rerank_status||0,s.rerank_use_model=b.rerank_use_model||void 0,s.rerank_model_config_id=b.rerank_model_config_id||"",s.top_k=b.top_k,s.similarity=b.similarity,s.search_type=b.search_type}),(f,v)=>{const $=te,g=he;return i(),z(X,{class:"setting-box",title:"关联知识库","icon-name":"guanlianzhishiku",isEdit:r.value,"onUpdate:isEdit":v[0]||(v[0]=u=>r.value=u),bodyStyle:{padding:0}},{extra:o(()=>[e("div",Pn,[t(g,{gap:8},{default:o(()=>[t($,{size:"small",onClick:l},{default:o(()=>[L("召回设置")]),_:1}),t($,{size:"small",onClick:c},{default:o(()=>[L("关联知识库")]),_:1})]),_:1})])]),default:o(()=>[q.value.length>0?(i(),k("div",Qn,[(i(!0),k(B,null,T(q.value,u=>(i(),k("div",{class:"library-item",key:u.id},[e("span",{class:"close-btn",onClick:O=>n(u)},[t(I(ve))],8,Tn),e("div",Fn,R(u.library_name),1),e("div",Jn,R(u.library_intro),1)]))),128))])):N("",!0),t(dn,{ref_key:"librarySelectAlertRef",ref:a,onChange:S},null,512),t(Bn,{ref_key:"recallSettingsAlertRef",ref:x,onChange:_},null,512)]),_:1},8,["isEdit"])}}},Hn=Q(Kn,[["__scopeId","data-v-75c29a43"]]),Wn=p=>(H("data-v-890ab853"),p=p(),W(),p),Gn={class:"library-checkbox-box"},Zn={class:"list-box",ref:"scrollContainer"},Yn={class:"library-name"},Xn={class:"library-desc"},ei={key:0,class:"empty-box"},ti=Wn(()=>e("img",{src:xt,alt:""},null,-1)),oi={__name:"library-select-alert",emits:["change"],setup(p,{expose:r,emit:b}){const h=b,s=P({indeterminate:!1,checkAll:!1,checkedList:[]}),d=w(!1),a=_=>{c(),s.checkedList=_,d.value=!0},q=()=>{d.value=!1,S()};w("");const n=w([]),S=()=>{h("change",[...s.checkedList])},c=async()=>{const _=await He();if(_){let C=_.data||[];n.value=C}},x=w(!1),l=()=>{window.open("/#/database/list")};return r({open:a}),(_,C)=>{const y=Je,f=Ke,v=qe,$=ce;return i(),z($,{width:"746px",open:d.value,"onUpdate:open":C[1]||(C[1]=g=>d.value=g),title:"关联数据表",onOk:q},{default:o(()=>[e("div",Gn,[t(v,{spinning:x.value,delay:100},{default:o(()=>[t(f,{value:s.checkedList,"onUpdate:value":C[0]||(C[0]=g=>s.checkedList=g),style:{width:"100%"}},{default:o(()=>[e("div",Zn,[(i(!0),k(B,null,T(n.value,g=>(i(),k("div",{class:"list-item-wraapper",key:g.id},[t(y,{class:"list-item",value:g.id},{default:o(()=>[e("div",Yn,R(g.name),1),e("div",Xn,R(g.description),1)]),_:2},1032,["value"])]))),128))],512)]),_:1},8,["value"])]),_:1},8,["spinning"]),!x.value&&!n.value.length?(i(),k("div",ei,[ti,e("div",null,[L(" 暂无数据表, 请先去添加数据表 "),e("a",{onClick:l}," 去添加")])])):N("",!0)])]),_:1},8,["open"])}}},si=Q(oi,[["__scopeId","data-v-890ab853"]]),ni=p=>(H("data-v-6977bc22"),p=p(),W(),p),ii=ni(()=>e("span",null,"关联数据库表，可以在机器人对话时，搜集用户数据进行存储，或者调用存储的数据回答用户提问。",-1)),ai={class:"actions-box"},li={key:0,class:"library-list"},ci=["onClick"],ri={class:"library-name"},di={class:"library-intro"},_i={__name:"index",setup(p){const r=w(!1),{robotInfo:b,updateRobotInfo:h}=G("robotInfo"),s=P({form_ids:[]}),d=w([]),a=w(null),q=Se(()=>d.value.filter(_=>s.form_ids.includes(_.id))),n=_=>{let C=s.form_ids.indexOf(_.id);s.form_ids.splice(C,1),x()},S=_=>{s.form_ids=[..._],x()},c=()=>{a.value.open([...s.form_ids])},x=()=>{let _={...K(s)};_.form_ids=_.form_ids.join(","),h({..._})};return(async()=>{const _=await He();_&&(d.value=_.data||[])})(),Me(()=>{s.form_ids=b.form_ids.split(",")}),(_,C)=>{const y=_e,f=te,v=he;return i(),z(X,{class:"setting-box",title:"数据库","icon-name":"guanlianzhishiku",isEdit:r.value,"onUpdate:isEdit":C[0]||(C[0]=$=>r.value=$),bodyStyle:{padding:0}},{tip:o(()=>[t(y,{placement:"top"},{title:o(()=>[ii]),default:o(()=>[t(I(Y))]),_:1})]),extra:o(()=>[e("div",ai,[t(v,{gap:8},{default:o(()=>[t(f,{size:"small",onClick:c},{default:o(()=>[L("关联数据表")]),_:1})]),_:1})])]),default:o(()=>[q.value.length>0?(i(),k("div",li,[(i(!0),k(B,null,T(q.value,$=>(i(),k("div",{class:"library-item",key:$.id},[e("span",{class:"close-btn",onClick:g=>n($)},[t(I(ve))],8,ci),e("div",ri,R($.name),1),e("div",di,R($.description),1)]))),128))])):N("",!0),t(si,{ref_key:"librarySelectAlertRef",ref:a,onChange:S},null,512)]),_:1},8,["isEdit"])}}},ui=Q(_i,[["__scopeId","data-v-6977bc22"]]),pi={class:"form-box"},mi={class:"question-title"},vi={class:"question-options"},hi={class:"question-option"},fi={class:"drag-btn"},bi={class:"action-box"},yi={class:"robot-info-box"},ki={class:"robot-welcome-content"},gi={class:"robot-welcome-question"},$i={__name:"welcome-words",setup(p){const r=w(!1),b=w(!1),{robotInfo:h,updateRobotInfo:s,scrollBoxToBottom:d}=G("robotInfo"),a=P({welcomes:{content:"",question:[]}}),q=()=>{let l=!1;if(a.welcomes.question.length>0){for(let _=0;_<a.welcomes.question.length;_++)if(!a.welcomes.question[_].content){l=_+1;break}}return l},n=()=>{a.welcomes.question.push({content:"",id:ke(8)})},S=l=>{a.welcomes.question.splice(l,1)},c=()=>{if(!a.welcomes.content)return Z.error("请输入欢迎语");if(q())return Z.error("引导问题内容不能为空");s({...K(a)}),r.value=!1},x=()=>{let l={...h.welcomes},_=[];l.question.forEach(({content:C,id:y})=>{let f={id:y,content:C};f.id||(f.id=ke(6)),_.push(f)}),a.welcomes.content=l.content,a.welcomes.question=_};return(l,_)=>{const C=ge,y=ae,f=re;return i(),z(X,{class:"setting-box",title:"欢迎语","icon-name":"huanyingyu",isEdit:r.value,"onUpdate:isEdit":_[4]||(_[4]=v=>r.value=v),onSave:c,onEdit:x},{default:o(()=>[ne(e("div",pi,[e("div",mi,[t(C,{value:a.welcomes.content,"onUpdate:value":_[0]||(_[0]=v=>a.welcomes.content=v),placeholder:"请输入欢迎语"},null,8,["value"])]),e("div",vi,[t(I(Ee),{modelValue:a.welcomes.question,"onUpdate:modelValue":_[1]||(_[1]=v=>a.welcomes.question=v),"item-key":"id",handle:".drag-btn",onStart:_[2]||(_[2]=v=>b.value=!0),onEnd:_[3]||(_[3]=v=>b.value=!1)},{item:o(({element:v,index:$})=>[e("div",hi,[e("span",fi,[t(y,{name:"drag"})]),t(f,{class:"question-option-content",value:v.content,"onUpdate:value":g=>v.content=g,placeholder:"请输入问题"},null,8,["value","onUpdate:value"]),e("div",bi,[t(I(ve),{class:"del-btn",onClick:g=>S($)},null,8,["onClick"])])])]),_:1},8,["modelValue"]),e("div",{class:"add-btn",onClick:n},[t(I(Ce),{class:"add-btn-icon"}),L("添加引导问题 ")])])],512),[[ie,r.value]]),ne(e("div",yi,[e("div",ki,R(I(h).welcomes.content),1),e("div",gi,[(i(!0),k(B,null,T(I(h).welcomes.question,(v,$)=>(i(),k("div",{class:"question-item",key:$},R(v.content),1))),128))])],512),[[ie,!r.value]])]),_:1},8,["isEdit"])}}},xi=Q($i,[["__scopeId","data-v-9b840ded"]]),wi=p=>(H("data-v-aca01d0e"),p=p(),W(),p),Si=wi(()=>e("span",null,"仅知识库模式下，用户提问没有在知识库中大于score阈值的分段时，会直接回复未知问题提示语。",-1)),qi={class:"form-box"},Ci={class:"question-title"},Ii={class:"question-options"},Ri={class:"question-option"},Ei={class:"drag-btn"},Ui={class:"action-box"},Li={class:"robot-info-box"},Ai={class:"robot-unknown-content"},Oi={class:"robot-unknown-question"},zi={__name:"unknown-problem-prompt",setup(p){const r=w(!1),b=w(!1),{robotInfo:h,updateRobotInfo:s,scrollBoxToBottom:d}=G("robotInfo"),a=P({unknown_question_prompt:{content:"",question:[]}}),q=()=>{a.unknown_question_prompt.question.push({content:"",id:ke(8)}),st(()=>{d()})},n=x=>{a.unknown_question_prompt.question.splice(x,1)},S=()=>{s({...K(a)}),r.value=!1},c=()=>{let x={...h.unknown_question_prompt},l=[];x.question&&x.question.forEach(({content:_,id:C})=>{let y={id:C,content:_};y.id||(y.id=ke(6)),l.push(y)}),x.content&&(a.unknown_question_prompt.content=x.content),l&&(a.unknown_question_prompt.question=l)};return je(()=>{}),(x,l)=>{const _=_e,C=ge,y=ae,f=re;return i(),z(X,{class:"setting-box",title:"未知问题提示语","icon-name":"unknown-prompt",isEdit:r.value,"onUpdate:isEdit":l[4]||(l[4]=v=>r.value=v),onSave:S,onEdit:c},{tip:o(()=>[t(_,{placement:"top",overlayInnerStyle:{width:"400px"}},{title:o(()=>[Si]),default:o(()=>[t(I(Y))]),_:1})]),default:o(()=>[ne(e("div",qi,[e("div",Ci,[t(C,{value:a.unknown_question_prompt.content,"onUpdate:value":l[0]||(l[0]=v=>a.unknown_question_prompt.content=v),placeholder:"请输入未知问题提示语"},null,8,["value"])]),e("div",Ii,[t(I(Ee),{modelValue:a.unknown_question_prompt.question,"onUpdate:modelValue":l[1]||(l[1]=v=>a.unknown_question_prompt.question=v),"item-key":"id",handle:".drag-btn",onStart:l[2]||(l[2]=v=>b.value=!0),onEnd:l[3]||(l[3]=v=>b.value=!1)},{item:o(({element:v,index:$})=>[e("div",Ri,[e("span",Ei,[t(y,{name:"drag"})]),t(f,{class:"question-option-content",value:v.content,"onUpdate:value":g=>v.content=g,placeholder:"请输入问题"},null,8,["value","onUpdate:value"]),e("div",Ui,[t(I(ve),{class:"del-btn",onClick:g=>n($)},null,8,["onClick"])])])]),_:1},8,["modelValue"]),e("div",{class:"add-btn",onClick:q},[t(I(Ce),{class:"add-btn-icon"}),L("添加引导问题 ")])])],512),[[ie,r.value]]),ne(e("div",Li,[e("div",Ai,R(I(h).unknown_question_prompt.content),1),e("div",Oi,[(i(!0),k(B,null,T(I(h).unknown_question_prompt.question,(v,$)=>(i(),k("div",{class:"question-item",key:$},R(v.content),1))),128))])],512),[[ie,!r.value]])]),_:1},8,["isEdit"])}}},Mi=Q(zi,[["__scopeId","data-v-aca01d0e"]]),Ze=p=>(H("data-v-8d50dfeb"),p=p(),W(),p),ji=Ze(()=>e("span",null,null,-1)),Di=Ze(()=>e("div",{class:"robot-info-box"},[e("div",{class:"robot-prompt"}," 开启后，进行知识库搜索时，会根据对话记录，利用AI补全问题缺失的信息 ")],-1)),Ni={__name:"problem-optimization",setup(p){w(!1);const{robotInfo:r,updateRobotInfo:b}=G("robotInfo");P({prompt:""});const h=s=>{b({})};return(s,d)=>{const a=de;return i(),z(X,{class:"setting-box",title:"问题优化","icon-name":"problem-optimization"},{extra:o(()=>[ji]),default:o(()=>[Di,t(a,{onChange:h,class:"switch-item",checkedValue:"true",unCheckedValue:"false",checked:I(r).enable_question_optimize,"onUpdate:checked":d[0]||(d[0]=q=>I(r).enable_question_optimize=q),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})}}},Vi=Q(Ni,[["__scopeId","data-v-8d50dfeb"]]),Ye=p=>(H("data-v-e2bb2e45"),p=p(),W(),p),Bi=Ye(()=>e("span",null,null,-1)),Pi=Ye(()=>e("div",{class:"robot-info-box"},[e("div",{class:"robot-prompt"}," 开启后，机器人回答问题后，自动根据对话内容提供3条用户提问建议 ")],-1)),Qi={__name:"suggested-issues",setup(p){w(!1);const{robotInfo:r,updateRobotInfo:b}=G("robotInfo"),h=s=>{b({})};return(s,d)=>{const a=de;return i(),z(X,{class:"setting-box",title:"用户问题建议","icon-name":"suggested-issues"},{extra:o(()=>[Bi]),default:o(()=>[Pi,t(a,{onChange:h,class:"switch-item",checkedValue:"true",unCheckedValue:"false",checked:I(r).enable_question_guide,"onUpdate:checked":d[0]||(d[0]=q=>I(r).enable_question_guide=q),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})}}},Ti=Q(Qi,[["__scopeId","data-v-e2bb2e45"]]),Ue=p=>(H("data-v-fc008010"),p=p(),W(),p),Fi={class:"direct-title"},Ji={class:"direct-desc"},Ki={class:"qa"},Hi={class:"prompt-form-item-label"},Wi=Ue(()=>e("span",{class:"qa-title"},"QA文档直接回复答案",-1)),Gi={class:"direct-switch"},Zi={class:"similarity"},Yi=Ue(()=>e("span",null,"相似度超过",-1)),Xi={class:"number-input-box"},ea=Ue(()=>e("span",null,"时直接回复答案",-1)),ta={__name:"chat-edit-alert",emits:["save"],setup(p,{expose:r,emit:b}){const h=b,s=w(1),d=()=>[{direct_id:1,direct_title:"仅知识库模式",direct_desc:"用户提问时,从知识库检索文档,大语言模型(LLM)根据检索出来的文档分段进行回复。如果没有符合的分段，则不由LLM回复，直接回复未知问题提示语。",chat_type:"1",library_qa_direct_reply_score:"0.900",library_qa_direct_reply_switch:0,isQaDirectReply:!0},{direct_id:3,direct_title:"混合模式",direct_desc:"用户提问时,从知识库检索文档,大语言模型(LLM)根据检索出来的文档分段进行回复。如索果没有符合的分段,则由大语言模型自行组织回复。",chat_type:"3",mixture_qa_direct_reply_score:"0.900",mixture_qa_direct_reply_switch:0,isQaDirectReply:!0},{direct_id:2,direct_title:"直连模式",direct_desc:"用户提问时，直接由LLM生成答案，不从关联知识库中检索。",chat_type:"2",isQaDirectReply:!1}],a=P(d()),q=w(!1),n=P({chat_type:"",library_qa_direct_reply_score:"",library_qa_direct_reply_switch:"false",mixture_qa_direct_reply_score:"",mixture_qa_direct_reply_switch:"false"}),S=()=>{n.chat_type=s.value.toString(),a.forEach(l=>{l.chat_type==s.value&&(n.chat_type=="3"?(n.mixture_qa_direct_reply_switch=l.mixture_qa_direct_reply_switch==1?"true":"false",n.mixture_qa_direct_reply_score=l.mixture_qa_direct_reply_score.toString()):n.chat_type=="1"&&(n.library_qa_direct_reply_switch=l.library_qa_direct_reply_switch==1?"true":"false",n.library_qa_direct_reply_score=l.library_qa_direct_reply_score.toString()))}),c(),Object.assign(a,d()),q.value=!1},c=()=>{h("save",K(n))};je(()=>{});const x=l=>{s.value=parseInt(l.chat_type),n.chat_type=l.chat_type,n.library_qa_direct_reply_score=l.library_qa_direct_reply_score,n.library_qa_direct_reply_switch=l.library_qa_direct_reply_switch,n.mixture_qa_direct_reply_score=l.mixture_qa_direct_reply_score,n.mixture_qa_direct_reply_switch=l.mixture_qa_direct_reply_switch,a.forEach(_=>{_.chat_type=="3"?(_.mixture_qa_direct_reply_score=l.mixture_qa_direct_reply_score,_.mixture_qa_direct_reply_switch=l.mixture_qa_direct_reply_switch=="true"?1:0):_.chat_type=="1"&&(_.library_qa_direct_reply_score=l.library_qa_direct_reply_score,_.library_qa_direct_reply_switch=l.library_qa_direct_reply_switch=="true"?1:0)}),q.value=!0};return me(()=>q.value,l=>{l===!1&&Object.assign(a,d())},{immediate:!0}),r({open:x}),(l,_)=>{const C=_e,y=de,f=Ie,v=wt,$=St,g=ce;return i(),z(g,{width:"746px",open:q.value,"onUpdate:open":_[1]||(_[1]=u=>q.value=u),title:"聊天模式设置",onOk:S},{default:o(()=>[t($,{class:"direct-box",value:s.value,"onUpdate:value":_[0]||(_[0]=u=>s.value=u)},{default:o(()=>[(i(!0),k(B,null,T(a,u=>(i(),z(v,{class:we(["direct-item",{active:s.value==u.direct_id}]),value:u.direct_id,key:u.direct_id},{default:o(()=>[e("div",Fi,R(u.direct_title),1),e("div",Ji,R(u.direct_desc),1),ne(e("div",Ki,[e("div",Hi,[Wi,t(C,null,nt({default:o(()=>[t(I(Y),{class:"question-icon"})]),_:2},[u.chat_type=="1"?{name:"title",fn:o(()=>[L("仅知识库模式下，检索出来的score排名最高的分段为QA模式，且score超过置顶阈值是，直接回复分段的答案，不经过大语言模型（LLM）生成回复。")]),key:"0"}:u.chat_type=="3"?{name:"title",fn:o(()=>[L("混合模式下，检索出来的score排名最高的分段为QA模式，且score超过置顶阈值是，直接回复分段的答案，不经过大语言模型（LLM）生成回复。")]),key:"1"}:void 0]),1024),e("div",Gi,[u.chat_type=="1"?(i(),z(y,{key:0,checkedValue:1,unCheckedValue:0,checked:u.library_qa_direct_reply_switch,"onUpdate:checked":O=>u.library_qa_direct_reply_switch=O},null,8,["checked","onUpdate:checked"])):u.chat_type=="3"?(i(),z(y,{key:1,checkedValue:1,unCheckedValue:0,checked:u.mixture_qa_direct_reply_switch,"onUpdate:checked":O=>u.mixture_qa_direct_reply_switch=O},null,8,["checked","onUpdate:checked"])):N("",!0)])])],512),[[ie,u.isQaDirectReply&&s.value==u.direct_id]]),ne(e("div",Zi,[Yi,e("div",Xi,[u.chat_type=="1"?(i(),z(f,{key:0,value:u.library_qa_direct_reply_score,"onUpdate:value":O=>u.library_qa_direct_reply_score=O,disabled:!u.library_qa_direct_reply_switch,min:0,max:1,step:.01},null,8,["value","onUpdate:value","disabled"])):u.chat_type=="3"?(i(),z(f,{key:1,value:u.mixture_qa_direct_reply_score,"onUpdate:value":O=>u.mixture_qa_direct_reply_score=O,disabled:!u.mixture_qa_direct_reply_switch,min:0,max:1,step:.01},null,8,["value","onUpdate:value","disabled"])):N("",!0)]),ea],512),[[ie,u.isQaDirectReply&&s.value==u.direct_id]])]),_:2},1032,["class","value"]))),128))]),_:1},8,["value"])]),_:1},8,["open"])}}},oa=Q(ta,[["__scopeId","data-v-fc008010"]]),Le=p=>(H("data-v-2120501a"),p=p(),W(),p),sa=Le(()=>e("span",null,"仅知识库模式：用户提问时，从知识库检索文档，大语言模型（LLM）根据检索出来的文档分段进行回复。如果没有符合的分段，则不由LLM回复，直接回复未知问题提示语。",-1)),na=Le(()=>e("br",null,null,-1)),ia=Le(()=>e("span",null,"直连模式：用户提问时，直接由LLM生成答案，不从关联知识库中检索。",-1)),aa={class:"actions-box"},la={class:"model-name"},ca={class:"form-box"},ra={__name:"index",setup(p){const r=w(!1),b=w(null),{robotInfo:h,updateRobotInfo:s}=G("robotInfo"),d=P({chat_type:h.chat_type,library_qa_direct_reply_score:h.library_qa_direct_reply_score,library_qa_direct_reply_switch:h.library_qa_direct_reply_switch,mixture_qa_direct_reply_score:h.mixture_qa_direct_reply_score,mixture_qa_direct_reply_switch:h.mixture_qa_direct_reply_switch}),a=S=>{d.chat_type=S.chat_type,d.library_qa_direct_reply_score=S.library_qa_direct_reply_score,d.library_qa_direct_reply_switch=S.library_qa_direct_reply_switch,d.mixture_qa_direct_reply_score=S.mixture_qa_direct_reply_score,d.mixture_qa_direct_reply_switch=S.mixture_qa_direct_reply_switch,q()},q=()=>{s({...K(d)}),r.value=!1},n=()=>{b.value.open(K(d)),r.value=!0};return(S,c)=>{const x=_e,l=Re,_=te;return i(),z(X,{class:"setting-box",title:"聊天模式","icon-name":"chat-mode",isEdit:r.value,"onUpdate:isEdit":c[1]||(c[1]=C=>r.value=C),bodyStyle:{padding:0}},{tip:o(()=>[t(x,{placement:"top",overlayInnerStyle:{width:"400px"}},{title:o(()=>[sa,na,ia]),default:o(()=>[t(I(Y))]),_:1})]),extra:o(()=>[e("div",aa,[e("span",la,R(I(h).chat_type=="1"?"仅知识库":I(h).chat_type=="2"?"直连模式":"混合模式"),1),t(l,{type:"vertical"}),t(_,{size:"small",onClick:c[0]||(c[0]=C=>n(!0))},{default:o(()=>[L("修改")]),_:1})])]),default:o(()=>[e("div",ca,[t(oa,{ref_key:"ChatEditAlertRef",ref:b,onSave:a},null,512)])]),_:1},8,["isEdit"])}}},da=Q(ra,[["__scopeId","data-v-2120501a"]]),_a=p=>(H("data-v-0548f52d"),p=p(),W(),p),ua={class:"switch-box"},pa={class:"switch-box-body"},ma={class:"switch-box-header"},va={class:"left-box"},ha={class:"switch-box-title"},fa={key:0,class:"title-tip"},ba={class:"right-box"},ya={class:"extra-box"},ka=_a(()=>e("div",{class:"extra-box"},null,-1)),ga={class:"switch-desc"},$a={class:"switch-box-right"},xa={__name:"switch-box",props:{iconName:{type:String,default:""},title:{type:String,default:""},value:{type:Boolean,default:!1}},emits:["update:value","change"],setup(p,{emit:r}){const b=r,h=p,s=w(h.value),d=a=>{b("update:value",a),b("change",a)};return(a,q)=>{const n=ae,S=de;return i(),k("div",ua,[e("div",pa,[e("div",ma,[e("div",va,[t(n,{class:"switch-box-icon",name:h.iconName},null,8,["name"]),e("span",ha,R(h.title),1),a.$slots.tip?(i(),k("span",fa,[le(a.$slots,"tip",{},void 0,!0)])):N("",!0)]),e("div",ba,[e("div",ya,[le(a.$slots,"extra",{},()=>[ka],!0)])])]),e("div",ga,[le(a.$slots,"default",{},void 0,!0)])]),e("div",$a,[t(S,{checked:s.value,"onUpdate:checked":q[0]||(q[0]=c=>s.value=c),onChange:d,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])])])}}},wa=Q(xa,[["__scopeId","data-v-0548f52d"]]),Sa="/assets/img/empty-Bx9z1cwf.png",qa="/assets/img/phone-head-CDwwPhYa.png",Ca="/assets/img/phone-body-CbEf8GZP.png",Ia="/assets/img/phone-footer-ClQtNpln.png",ue=p=>(H("data-v-dce83f0d"),p=p(),W(),p),Ra={class:"common-problem-box"},Ea={class:"left-content-box"},Ua={key:0,class:"empty-box"},La=ue(()=>e("img",{src:Sa,alt:""},null,-1)),Aa=ue(()=>e("div",{class:"title"},"暂无数据",-1)),Oa=ue(()=>e("div",{class:"desc"},"常见问题会显示在每条对话后面,供用户快速提问",-1)),za={key:1,class:"lists-box"},Ma={class:"drag-btn"},ja={class:"title"},Da={class:"opration-box"},Na={class:"preview-box"},Va=ue(()=>e("div",{class:"phone-head"},[e("img",{class:"head-img",src:qa,alt:""})],-1)),Ba={class:"phone-body"},Pa=ue(()=>e("div",null,[e("img",{class:"body-img",src:Ca,alt:""})],-1)),Qa={key:0,class:"question-box"},Ta=ue(()=>e("div",{class:"name"},"常见问题",-1)),Fa=ue(()=>e("div",{class:"phone-footer"},[e("img",{class:"footer-img",src:Ia,alt:""})],-1)),Ja={__name:"common-problem",setup(p){w(!1);const{robotInfo:r,updateRobotInfo:b}=G("robotInfo"),h=Se(()=>r.common_question_list?JSON.parse(r.common_question_list):[]),s=w([]);s.value=h.value,me(h,()=>{s.value=h.value});const d=ze.useForm,a=w(!1),q=w("添加问题"),n=P({question:"",index:-1}),S=P({question:[{message:"请输入问题名称",required:!0}]}),{resetFields:c,validate:x,validateInfos:l}=d(n,S),_=()=>{if(h.value.length>=10)return Z.error("最多设置10条常用问题");a.value=!0,c(),n.question="",n.index=-1},C=(g,u)=>{a.value=!0,c(),n.question=g,n.index=u},y=g=>{let u=[];u=h.value.filter((O,V)=>g!=V),ce.confirm({title:"提醒",icon:t(_t),content:"确定要删除该问题吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk(){b({common_question_list:JSON.stringify(u)})},onCancel(){}})},f=()=>{x().then(()=>{let g=[];n.index>=0?g=h.value.map((u,O)=>O===n.index?n.question:u):g=[n.question,...h.value],b({common_question_list:JSON.stringify(g)}),a.value=!1})},v=g=>{b({})},$=g=>{b({common_question_list:JSON.stringify(s.value)})};return(g,u)=>{const O=_e,V=de,F=Re,M=te,m=ae,A=re,J=qt,ee=ze,D=ce;return i(),k("div",Ra,[e("div",Ea,[t(X,{class:"setting-box",title:"常见问题设置","icon-name":"common-quession"},{icon:o(()=>[t(O,null,{title:o(()=>[L("最多10条。开启后，常见问题会显示在每条问答后面")]),default:o(()=>[t(I(Y),{class:"quess-icon"})]),_:1})]),extra:o(()=>[t(V,{onChange:v,class:"switch-item",checkedValue:"true",unCheckedValue:"false",checked:I(r).enable_common_question,"onUpdate:checked":u[0]||(u[0]=E=>I(r).enable_common_question=E),"checked-children":"开","un-checked-children":"关"},null,8,["checked"]),t(F,{type:"vertical"}),t(M,{type:"primary",size:"small",onClick:_},{default:o(()=>[L("添加")]),_:1})]),default:o(()=>[h.value.length==0?(i(),k("div",Ua,[La,Aa,Oa,t(M,{onClick:_,type:"primary"},{default:o(()=>[L("立即添加")]),_:1})])):(i(),k("div",za,[t(I(Ee),{modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=E=>s.value=E),handle:".drag-btn","item-key":"index",onEnd:$},{item:o(({element:E,index:j})=>[(i(),k("div",{class:"list-item",key:j},[e("span",Ma,[t(m,{name:"drag"})]),e("div",ja,R(E),1),e("div",Da,[t(I(pt),{onClick:pe=>C(E,j)},null,8,["onClick"]),t(I(ve),{onClick:pe=>y(j)},null,8,["onClick"])])]))]),_:1},8,["modelValue"])]))]),_:1})]),e("div",Na,[Va,e("div",Ba,[Pa,h.value.length&&I(r).enable_common_question=="true"?(i(),k("div",Qa,[Ta,(i(!0),k(B,null,T(h.value,E=>(i(),k("div",{class:"list-item",key:E},R(E),1))),128))])):N("",!0)]),Fa]),t(D,{open:a.value,"onUpdate:open":u[3]||(u[3]=E=>a.value=E),title:q.value,onOk:f,width:"476px"},{default:o(()=>[t(ee,{class:"form-box",layout:"vertical"},{default:o(()=>[t(J,it({label:"问题名称"},I(l).question),{default:o(()=>[t(A,{maxLength:100,value:n.question,"onUpdate:value":u[2]||(u[2]=E=>n.question=E),placeholder:"请输入问题"},null,8,["value"])]),_:1},16)]),_:1})]),_:1},8,["open","title"])])}}},Ka=Q(Ja,[["__scopeId","data-v-dce83f0d"]]),Ha=e("span",null,null,-1),Wa=e("div",null,"开启后，机器人回答时，在回答后面显示引用的知识库文档",-1),Ga={__name:"display-aitations",setup(p){const{robotInfo:r,updateRobotInfo:b}=G("robotInfo"),h=w(!1);me(()=>r.answer_source_switch,d=>{h.value=d=="true"},{immediate:!0});const s=()=>{b({answer_source_switch:h.value?"true":"false"})};return(d,a)=>(i(),z(wa,{title:"显示引文","icon-name":"jibenpeizhi",value:h.value,"onUpdate:value":a[0]||(a[0]=q=>h.value=q),onChange:s},{extra:o(()=>[Ha]),default:o(()=>[Wa]),_:1},8,["value"]))}},Za={key:0,class:"robot-config-page"},Ya={class:"setting-box"},Xa={class:"setting-box"},el={class:"setting-box"},tl={class:"setting-box"},ol={class:"setting-box"},sl={class:"setting-box"},nl={class:"setting-box"},il={class:"setting-box"},al={class:"setting-box"},ll={class:"setting-box"},cl={class:"setting-box"},rl={key:1,class:"robot-config-page"},dl={__name:"index",setup(p){const r=Ct(),b=w(null),{robotInfo:h}=at(r),{getRobot:s}=r,d=()=>{b.value.scrollTop=b.value.scrollHeight},a=w(1),q=w(!1),n=P(h.value);lt("robotInfo",{robotInfo:n,updateRobotInfo:x=>{let l=JSON.parse(JSON.stringify(x));x.robot_avatar&&(l.robot_avatar=new File([x.robot_avatar],x.robot_avatar.name)),Object.assign(n,l),c()},scrollBoxToBottom:d});const c=()=>{let x;n.robot_avatar&&(x=new File([n.robot_avatar],n.robot_avatar.name));let l=JSON.parse(JSON.stringify(K(n)));x&&(l.robot_avatar=x);let _=l.welcomes;_.question=_.question.map(y=>y.content),l.welcomes=JSON.stringify(_),l.prompt_struct=JSON.stringify(l.prompt_struct);let C=l.unknown_question_prompt;C.question=C.question.map(y=>y.content),l.unknown_question_prompt=JSON.stringify(C),delete l.robot_avatar_url,q.value=!0,ht(l).then(y=>{if(y.res!=0)return Z.error(y.msg);q.value=!1,Z.success("保存成功"),s(n.id)}).catch(()=>{q.value=!1})};return(x,l)=>{const _=De,C=Ne;return i(),k(B,null,[t(C,{activeKey:a.value,"onUpdate:activeKey":l[0]||(l[0]=y=>a.value=y)},{default:o(()=>[(i(),z(_,{key:1,tab:"基础配置"})),(i(),z(_,{key:2,tab:"常见问题"}))]),_:1},8,["activeKey"]),a.value==1?(i(),k("div",Za,[e("div",{class:"scroll-box",ref_key:"scrollBox",ref:b},[e("div",Ya,[t(Xt)]),e("div",Xa,[t(ws)]),e("div",el,[t(on)]),e("div",tl,[t(Hn)]),e("div",ol,[t(ui)]),e("div",sl,[t(xi)]),e("div",nl,[t(da)]),e("div",il,[t(Mi)]),e("div",al,[t(Vi)]),e("div",ll,[t(Ti)]),e("div",cl,[t(Ga)])],512)])):(i(),k("div",rl,[t(Ka)]))],64)}}},vc=Q(dl,[["__scopeId","data-v-d71a21ff"]]);export{vc as default};
