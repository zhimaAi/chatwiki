import{f as d,e as $,ae as k,ad as o,ar as n,ak as G,ac as r,k as i,G as u,as as l,F as w,ax as J,ai as K,at as g,u as A,B as P,av as j,y as q,J as B}from"./vue-chunks-CGLjTDrY.js";import{L as H}from"./loading-box-CAF9T3Ud.js";import{E as Q}from"./empty-box-C5iAwHZS.js";import{e as X}from"./index-AgSL8KLK.js";import{_ as Y,f as Z}from"../../index-C5-B0r5-.js";import{o as ee,V as ae,ai as se,a9 as te,N as le,B as oe,M as ne}from"./ui-antd-B11sc9DP.js";const ie={style:{"margin-bottom":"12px"}},de={class:"wechat-app-list"},pe=["onClick"],ue={class:"item-body"},ce=["src"],re={class:"app-info"},ve={class:"app-name"},fe={class:"app-desc"},_e={class:"ext-info-list"},me={key:0,class:"status-block status-success"},ke={key:1,class:"status-block status-warning"},ge={__name:"select-wechat-app",props:{title:{type:String,default:"选择公众号"},okText:{type:String,default:"确 定"},disabledAppIds:{type:Array,default:()=>[]}},emits:["ok"],setup(c,{expose:I,emit:S}){const E=S,_=c,F=j();Z();const v=d(!1),m=d(!1),L=d(!1),f=d(!1),N=d({}),p=d([]),t=d([]),h=$(()=>p.value.filter(a=>!_.disabledAppIds.includes(a.app_id)));function T(a,e){N.value=a,t.value=Array.isArray(e)?e:[],M(),v.value=!0}function V(){v.value=!1}function M(){m.value=!0,X({app_type:"official_account",app_name:""}).then(a=>{p.value=a.data||[]}).finally(()=>{m.value=!1})}function R(){let a=p.value.filter(e=>t.value.includes(e.app_id));E("ok",B(t.value),B(a))}function y(){const a=F.resolve({path:"/user/official-account"});window.open(a.href,"_blank")}function U(a){if(_.disabledAppIds.includes(a.app_id))return;let e=t.value.indexOf(a.app_id);e>-1?t.value.splice(e,1):t.value.push(a.app_id),b()}function b(){q(()=>{f.value=t.value.length===h.value.length})}function z(){f.value?(t.value=[],p.value.map(a=>{_.disabledAppIds.includes(a.app_id)||t.value.push(a.app_id)})):t.value=[]}return I({open:T,close:V}),(a,e)=>{const D=ee,x=ae,O=le,C=oe,W=ne;return o(),k(W,{open:v.value,"onUpdate:open":e[3]||(e[3]=s=>v.value=s),title:c.title,"confirm-loading":L.value,width:"626px"},{footer:n(()=>[i(C,{type:"primary",disabled:!t.value.length,onClick:R},{default:n(()=>[u(g(c.okText),1)]),_:1},8,["disabled"])]),default:n(()=>[G(a.$slots,"alert",{},()=>[i(D,{type:"info",class:"zm-alert-info mt12"},{message:n(()=>[e[4]||(e[4]=u(" 公众号列表数据来源：系统管理>公众号管理。",-1)),l("a",{onClick:y},"前往编辑公众号、添加公众号")]),_:1})],!0),m.value?(o(),k(H,{key:0,style:{margin:"10vh 0"}})):p.value.length?(o(),r(w,{key:1},[l("div",ie,[i(x,{checked:f.value,"onUpdate:checked":e[0]||(e[0]=s=>f.value=s),disabled:!h.value.length,onChange:z},{default:n(()=>[...e[5]||(e[5]=[u("全选 ",-1)])]),_:1},8,["checked","disabled"])]),i(O,{value:t.value,"onUpdate:value":e[2]||(e[2]=s=>t.value=s)},{default:n(()=>[l("div",de,[(o(!0),r(w,null,J(p.value,s=>(o(),r("div",{key:s.id,class:K(["wechat-app-item",{disabled:c.disabledAppIds.includes(s.app_id)}]),onClick:he=>U(s)},[l("div",ue,[l("img",{class:"app-avatar",src:s.app_avatar,alt:""},null,8,ce),l("div",re,[l("div",ve,g(s.app_name),1),l("div",fe,"Appid："+g(s.app_id),1)])]),l("div",_e,[s.account_is_verify=="true"?(o(),r("div",me,[i(A(se)),e[6]||(e[6]=u(" 已认证 ",-1))])):(o(),r("div",ke,[i(A(te)),e[7]||(e[7]=u(" 未认证 ",-1))])),l("span",{onClick:e[1]||(e[1]=P(()=>{},["stop"]))},[i(x,{value:s.app_id,disabled:c.disabledAppIds.includes(s.app_id),onChange:b},null,8,["value","disabled"])])])],10,pe))),128))])]),_:1},8,["value"])],64)):(o(),k(Q,{key:2,title:"暂未绑定公众号"},{desc:n(()=>[i(C,{type:"primary",onClick:y},{default:n(()=>[...e[8]||(e[8]=[u("绑定公众号",-1)])]),_:1})]),_:1}))]),_:3},8,["open","title","confirm-loading"])}}},Be=Y(ge,[["__scopeId","data-v-c0d74817"]]);export{Be as S};
