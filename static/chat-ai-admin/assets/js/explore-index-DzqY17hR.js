import{_ as F}from"./cu-scroll-BmJNJRCz.js";import{a9 as O,Y as y,_ as g,F as R,ab as T,a5 as n,k as i,a7 as $,a2 as v,u as L,G as C,f as k,o as U,w as V}from"./vue-chunks-DCKTEHpB.js";import{g as z}from"./index-DLEjqKv8.js";import{w as Y,x as N}from"./index-CTy81fs2.js";import{_ as q,d as G,ae as J,ad as K}from"../../index-C1Xsov4S.js";import{p as W,J as j,M as B,O as H,B as P,a as M}from"./ui-antd-D64OvTpt.js";import{_ as Q}from"./main-tab-B3vUjkqO.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./utils-D9NMMoMR.js";import"./list-tabs-BOqV1hiy.js";import"./index-BsqRrb1q.js";const X={class:"list-box"},Z=["onClick"],tt={class:"explore-info"},ot={class:"explore-info-content"},et={class:"explore-title"},st={class:"item-body"},nt={class:"support-box"},at={class:"item-footer"},lt={__name:"index",props:{list:{type:Array,default:()=>[]}},emits:["switchChange","clickItem"],setup(D,{emit:x}){const m=x,_=O(),d=D,f=(p,c)=>m("switchChange",p,c),I=async(p,c)=>{try{const r=p==null?void 0:p.target;if(r&&typeof r.closest=="function"&&r.closest(".no-bubble"))return;if(c.robot_only_show=="1"){const u=_.resolve({path:c.menu.path});window.open(u.href,"_blank");return}}catch{}m("clickItem",c)};return(p,c)=>{const r=G,u=W,S=j;return g(),y("div",X,[(g(!0),y(R,null,T(d.list,s=>{var t,o;return g(),y("div",{class:"list-item-wrapper",key:s.id},[n("div",{class:"list-item",onClick:e=>I(e,s)},[n("div",tt,[i(r,{class:"explore-icon",name:s.ability_type,style:{"font-size":"62px",color:"white"}},null,8,["name"]),n("div",ot,[n("div",et,$(s.explore_name||s.name),1),c[0]||(c[0]=n("div",{class:"explore-type"},"ChatWiki",-1))])]),n("div",st,[i(u,{title:L(K)(s.explore_intro,s,14,2,12),placement:"top"},{default:v(()=>[n("div",{class:"explore-desc",ref_for:!0,ref:e=>L(J)(e,s)},$(s.explore_intro),513)]),_:2},1032,["title"]),n("span",nt,[(g(!0),y(R,null,T(s.support_channels_list,e=>(g(),y("span",{key:e,class:"support-item"},[i(r,{name:"support",class:"icon"}),C(" "+$(e),1)]))),128))])]),n("div",at,[i(S,{checked:((t=s.user_config)==null?void 0:t.switch_status)=="1"||((o=s.robot_config)==null?void 0:o.switch_status)=="1","checked-children":"开","un-checked-children":"关",class:"no-bubble",onChange:e=>f(s,e)},null,8,["checked","onChange"])])],8,Z)])}),128))])}}},it=q(lt,[["__scopeId","data-v-7b849fa5"]]),ct={"bg-color":"#f5f9ff",class:"explore-page"},rt={class:"explore-page-body"},_t={class:"list-toolbar"},pt={class:"toolbar-box"},ut={class:"list-group-box"},ft={class:"enable-tip-footer"},dt={class:"footer-actions"},E="explore_enable_tip_suppress_until",bt={__name:"explore-index",setup(D){const x=k(null),m=k([]),_=k(!1),d=k(!1),f=O();U(()=>{let t=localStorage.getItem("zm:explore:active");t>1?x.value.change(t):p()});let I=k([]);const p=()=>{Y().then(t=>{const o=((t==null?void 0:t.data)||[]).map(e=>({...e,explore_name:e.name,explore_intro:e.introduction}));m.value=o,I.value=(t==null?void 0:t.data)||[]})},c=(t,o)=>{const e=o?"1":"0";if(e==="0"){const l={robot_auto_reply:"关闭后，该功能默认关闭不再支持使用，所有的公众号菜单都会停用，确认关闭？",library_ability_official_account:"关闭后，知识库模块将不再显示公众号知识库模块，历史已导入的文章将无法引用，确认关闭？",robot_payment:"关闭后，设置的收费策略将失效，确认关闭？"};B.confirm({title:"提示",content:l[t.ability_type]||"关闭后，该功能默认关闭不再支持使用，所有的公众号菜单都会停用，确认关闭？",onOk:()=>{N({ability_type:t.ability_type,switch_status:e}).then(a=>{a&&a.res==0&&(M.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e))})}});return}N({ability_type:t.ability_type,switch_status:e}).then(l=>{if(l&&l.res==0){if(M.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e),t.ability_type==="library_ability_official_account")return;const a=Number(localStorage.getItem(E)||0),b=Date.now();a<=b&&(d.value=!1,t.robot_only_show!=1&&(_.value=!0))}})},r=t=>{switch(t.ability_type){case"library_ability_official_account":const o=f.resolve({path:"/library/list",query:{active:3}});window.open(o.href,"_blank");break;default:t.module_type==="robot"&&t.robot_only_show==0&&s(t);break}},u=()=>{if(d.value){const t=Date.now()+2592e5;localStorage.setItem(E,String(t))}},S=()=>{u(),_.value=!1},s=async t=>{var e;u(),_.value=!1;const o=localStorage.getItem("last_local_robot_id");try{const{data:l=[]}=await z();if(!l.length){const w=f.resolve({path:"/robot/list"});window.open(w.href,"_blank");return}let a;o&&(a=l.find(w=>w.id==o)),a=a||l[0];const{id:b,robot_key:h}=a;if((e=t.menu)!=null&&e.path){const w=f.resolve({path:t.menu.path,query:{id:b,robot_key:h}});window.open(w.href,"_blank");return}const A=f.resolve({path:"/robot/config/function-center",query:{id:b,robot_key:h}});window.open(A.href,"_blank")}catch{const a=f.resolve({path:"/robot/list"});window.open(a.href,"_blank")}};return V(_,(t,o)=>{o&&!t&&u()}),(t,o)=>{const e=F,l=H,a=P,b=B;return g(),y("div",ct,[n("div",rt,[n("div",_t,[n("div",pt,[i(Q,{ref_key:"tabRef",ref:x},null,512)])]),n("div",ut,[i(e,{style:{"padding-right":"16px",flex:"1"}},{default:v(()=>[i(it,{list:m.value,onSwitchChange:c,onClickItem:r},null,8,["list"])]),_:1})])]),i(b,{open:_.value,"onUpdate:open":o[1]||(o[1]=h=>_.value=h),title:"提示",footer:null},{default:v(()=>[o[5]||(o[5]=n("div",null,"开启该功能后请到机器人>功能中心，配置并使用该功能",-1)),n("div",ft,[i(l,{checked:d.value,"onUpdate:checked":o[0]||(o[0]=h=>d.value=h)},{default:v(()=>[...o[2]||(o[2]=[C("3天内不再提醒",-1)])]),_:1},8,["checked"]),n("div",dt,[i(a,{onClick:S},{default:v(()=>[...o[3]||(o[3]=[C("取消",-1)])]),_:1}),i(a,{type:"primary",onClick:s},{default:v(()=>[...o[4]||(o[4]=[C("去使用",-1)])]),_:1})])])]),_:1},8,["open"])])}}},Dt=q(bt,[["__scopeId","data-v-f55f2df2"]]);export{Dt as default};
