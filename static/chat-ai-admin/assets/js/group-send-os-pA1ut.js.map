{"version":3,"file":"group-send-os-pA1ut.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/explore/article-group-send/components/comment-drawer.vue","../../../../front-end/chat-ai-admin-vue/src/views/explore/article-group-send/group-send.vue"],"sourcesContent":["<template>\r\n  <a-drawer v-model:open=\"open\" :title=\"t('drawer_title')\" :width=\"420\" :destroyOnClose=\"true\">\r\n    <div class=\"article-card\">\r\n      <img v-if=\"article.thumb_url\" class=\"thumb\" :src=\"article.thumb_url\" />\r\n      <img v-else class=\"thumb\" src=\"@/assets/img/default-cover.png\" />\r\n      <div class=\"info\">\r\n        <div class=\"title\">{{ article.title }}</div>\r\n        <div class=\"meta\">{{ t('article_group_label') }}{{ article.group_name }}</div>\r\n        <div class=\"digest\">{{ article.digest }}</div>\r\n      </div>\r\n    </div>\r\n    <div class=\"comment-header\">{{ t('comment_header', { total: pagination.total }) }}</div>\r\n    <div class=\"list-box\" v-if=\"!isLoading\" ref=\"bodyAnchorRef\">\r\n      <div class=\"comment-item\" v-for=\"it in list\" :key=\"it.id\">\r\n        <a-avatar :size=\"40\" :src=\"userAvatar\" />\r\n        <div class=\"comment-content\">\r\n          <div class=\"top-line\">\r\n            <span class=\"name\">{{ formatUserName(it.open_id) }}</span>\r\n            <a-tag v-if=\"isSelected(it)\" color=\"#FF4D4F\" style=\"margin-right: 0;\">{{ t('tag_selected') }}</a-tag>\r\n            <span class=\"time\">{{ formatDisplayChatTime(it.comment_create_time) }}</span>\r\n            <div class=\"delete-status\" v-if=\"it.delete_status == '1'\">{{ t('deleted_status') }}</div>\r\n            <span class=\"actions\" v-else>\r\n              <DeleteOutlined class=\"delete-icon\" @click=\"handleDelete(it)\" />\r\n            </span>\r\n          </div>\r\n          <div class=\"text\">{{ it.content_text }}</div>\r\n          <div class=\"ai-reply\" v-if=\"it.reply_comment_text\">\r\n            <div class=\"top-line ai-reply-content\">\r\n              <a-avatar :size=\"32\" :src=\"defaultAvatar\" style=\"flex-basis: 32px;\" />\r\n              <div class=\"ai-replay-content-right\">\r\n                <div class=\"ai-replay-content-right-top\">\r\n                  <span class=\"name ai\">{{ t('ai_bot_name') }}</span>\r\n                  <span class=\"time\">{{ formatDisplayChatTime(it.reply_create_time) }}</span>\r\n                  <div class=\"delete-status\" v-if=\"it.delete_status == '1'\">{{ t('deleted_status') }}</div>\r\n                  <span class=\"actions\" v-else>\r\n                    <DeleteOutlined class=\"delete-icon\" @click=\"handleDeleteReply(it)\" />\r\n                  </span>\r\n                </div>\r\n                <div class=\"text\">{{ it.reply_comment_text }}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"empty\" v-if=\"list.length === 0\"><a-empty :description=\"t('empty_no_comment')\" /></div>\r\n      <div class=\"load-more-tips\" v-else>\r\n        <span v-if=\"loadingMore\">{{ t('load_more_loading') }}</span>\r\n        <span v-else-if=\"!hasMore\">{{ t('load_more_no_more') }}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"loading-box\" v-else><a-spin /></div>\r\n  </a-drawer>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, createVNode, watch, nextTick, onMounted, onUnmounted } from 'vue'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport { DeleteOutlined, ExclamationCircleOutlined } from '@ant-design/icons-vue'\r\nimport { getCommentList, deleteComment, deleteCommentReply } from '@/api/robot'\r\nimport { DEFAULT_ROBOT_AVATAR, DEFAULT_USER_AVATAR } from '@/constants/index'\r\nimport { formatDisplayChatTime, addNoReferrerMeta, removeNoReferrerMeta } from '@/utils/index.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.explore.article-group-send.components.comment-drawer')\r\n\r\nconst defaultAvatar = DEFAULT_ROBOT_AVATAR\r\nconst userAvatar = DEFAULT_USER_AVATAR\r\nconst open = ref(false)\r\nconst article = ref({})\r\nconst isLoading = ref(false)\r\nconst pagination = reactive({ page: 1, size: 20, total: 0 })\r\nconst list = ref([])\r\nconst hasMore = ref(true)\r\nconst loadingMore = ref(false)\r\nconst bodyAnchorRef = ref(null)\r\nlet bodyEl = null\r\n\r\nconst show = (record) => {\r\n  article.value = { ...record }\r\n  open.value = true\r\n  pagination.page = 1\r\n  loadComments()\r\n}\r\n\r\nconst loadComments = () => {\r\n  isLoading.value = true\r\n  getCommentList({ task_id: article.value.id, page: pagination.page, size: pagination.size })\r\n    .then((res) => {\r\n      const data = res?.data || {}\r\n      list.value = Array.isArray(data.list) ? data.list : []\r\n      pagination.page = +data.page || pagination.page\r\n      pagination.size = +data.size || pagination.size\r\n      pagination.total = +data.total || list.value.length || 0\r\n      hasMore.value = list.value.length < pagination.total\r\n    })\r\n    .finally(() => { isLoading.value = false })\r\n}\r\n\r\nconst handleDelete = (item) => {\r\n  Modal.confirm({\r\n    title: t('modal_delete_comment_title'),\r\n    icon: createVNode(ExclamationCircleOutlined),\r\n    okText: t('btn_delete'),\r\n    cancelText: t('btn_cancel'),\r\n    onOk: async () => {\r\n      await deleteComment({ msg_id: item.msg_data_id, comment_id: item.user_comment_id, access_key: article.value.access_key })\r\n      message.success(t('message_delete_success'))\r\n      loadComments()\r\n    }\r\n  })\r\n}\r\n\r\nconst handleDeleteReply = (item) => {\r\n  Modal.confirm({\r\n    title: t('modal_delete_reply_title'),\r\n    icon: createVNode(ExclamationCircleOutlined),\r\n    okText: t('btn_delete'),\r\n    cancelText: t('btn_cancel'),\r\n    onOk: async () => {\r\n      await deleteCommentReply({ msg_id: item.msg_data_id, comment_id: item.user_comment_id, access_key: article.value.access_key })\r\n      message.success(t('message_delete_success'))\r\n      loadComments()\r\n    }\r\n  })\r\n}\r\n\r\ndefineExpose({ show })\r\n\r\nconst formatUserName = (open_id) => {\r\n  if (!open_id) return t('default_user_name')\r\n  const suf = String(open_id).slice(-4)\r\n  return t('user_name_with_suffix', { suf })\r\n}\r\n\r\nconst isSelected = (it) => {\r\n  if (String(it.comment_type) === '1') return true\r\n  const text = String(it.ai_comment_result_text || '')\r\n  return text.includes(t('auto_feature_keyword'))\r\n}\r\n\r\nconst tryAttach = () => {\r\n  if (bodyAnchorRef.value) {\r\n    bodyEl = bodyAnchorRef.value.closest('.ant-drawer-body')\r\n    if (bodyEl) bodyEl.addEventListener('scroll', onBodyScroll, { passive: true })\r\n  }\r\n}\r\n\r\nconst detach = () => {\r\n  if (bodyEl) {\r\n    bodyEl.removeEventListener('scroll', onBodyScroll)\r\n    bodyEl = null\r\n  }\r\n}\r\n\r\nconst onBodyScroll = () => {\r\n  if (!hasMore.value || loadingMore.value || !bodyEl) return\r\n  const threshold = 80\r\n  const nearBottom = bodyEl.scrollTop + bodyEl.clientHeight >= bodyEl.scrollHeight - threshold\r\n  if (nearBottom) {\r\n    loadingMore.value = true\r\n    const nextPage = pagination.page + 1\r\n    getCommentList({ task_id: article.value.id, page: nextPage, size: pagination.size })\r\n      .then((res) => {\r\n        const data = res?.data || {}\r\n        const nextList = Array.isArray(data.list) ? data.list : []\r\n        pagination.page = +data.page || nextPage\r\n        pagination.size = +data.size || pagination.size\r\n        pagination.total = +data.total || pagination.total\r\n        list.value = list.value.concat(nextList)\r\n        hasMore.value = list.value.length < pagination.total\r\n      })\r\n      .finally(() => { loadingMore.value = false })\r\n  }\r\n}\r\n\r\nwatch(open, (val) => {\r\n  if (val) {\r\n    hasMore.value = true\r\n    loadingMore.value = false\r\n    nextTick(tryAttach)\r\n  } else {\r\n    detach()\r\n  }\r\n})\r\n\r\nonMounted(() => { addNoReferrerMeta() })\r\nonUnmounted(() => { removeNoReferrerMeta() })\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.article-card {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 12px;\r\n  border: 1px solid #edeff2;\r\n  border-radius: 8px;\r\n  background: #fff;\r\n}\r\n.article-card .thumb {\r\n  width: 146px;\r\n  height: 96px;\r\n  border-radius: 6px;\r\n  object-fit: cover;\r\n}\r\n.article-card .info {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n.article-card .info .source {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  font-size: 12px;\r\n  color: #8c8c8c;\r\n}\r\n.article-card .info .source .brand {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 0 6px;\r\n  height: 20px;\r\n  border: 1px solid #00000026;\r\n  background: #0000000a;\r\n  border-radius: 6px;\r\n  font-size: 12px;\r\n  color: #bfbfbf;\r\n}\r\n.article-card .info .title {\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  line-height: 22px;\r\n  color: #262626;\r\n}\r\n.article-card .info .meta {\r\n  margin-top: 2px;\r\n  font-size: 12px;\r\n  line-height: 20px;\r\n  color: #8c8c8c;\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 1;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.article-card .info .digest {\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 2;\r\n  flex: 1 0 0;\r\n  overflow: hidden;\r\n  color: #595959;\r\n  text-overflow: ellipsis;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 22px;\r\n}\r\n\r\n.comment-header {\r\n  margin: 12px 0;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  color: #262626;\r\n}\r\n\r\n.comment-item {\r\n  display: flex;\r\n  gap: 8px;\r\n  align-items: flex-start;\r\n  padding: 12px 0;\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.comment-content {\r\n  flex: 1;\r\n}\r\n\r\n.top-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n}\r\n\r\n.name {\r\n  font-size: 14px;\r\n  color: #262626;\r\n}\r\n\r\n.time {\r\n  font-size: 12px;\r\n  color: #8c8c8c;\r\n}\r\n\r\n.delete-status {\r\n  font-size: 12px;\r\n  color: #FF4D4F;\r\n  margin-left: auto;\r\n}\r\n\r\n.actions {\r\n  margin-left: auto;\r\n  opacity: 0;\r\n  transition: opacity 0.2s;\r\n  display: flex;\r\n  padding: 4px;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 4px;\r\n  border-radius: 6px;\r\n\r\n  &:hover {\r\n    background: #E4E6EB;\r\n  }\r\n}\r\n\r\n.delete-icon {\r\n  font-size: 16px;\r\n  color: #8c8c8c;\r\n  cursor: pointer;\r\n}\r\n\r\n.comment-item:hover .actions {\r\n  opacity: 1;\r\n}\r\n\r\n.text {\r\n  margin-top: 4px;\r\n  font-size: 14px;\r\n  color: #595959;\r\n  white-space: pre-wrap;\r\n}\r\n\r\n.ai-reply {\r\n  margin-top: 16px;\r\n\r\n  .ai-reply-content {\r\n    display: flex; \r\n    align-items: self-start; \r\n    gap: 8px;\r\n\r\n    .ai-replay-content-right {\r\n      flex: 1;\r\n\r\n      .ai-replay-content-right-top {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 4px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.loading-box {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 24px 0;\r\n}\r\n\r\n.empty {\r\n  padding: 24px 0;\r\n}\r\n\r\n.load-more-tips {\r\n  padding: 8px 0;\r\n  text-align: center;\r\n  font-size: 12px;\r\n  color: #8c8c8c;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"group-send-wrapper\">\r\n        <div class=\"toolbar\">\r\n          <a-button type=\"primary\" @click=\"handleCreateSend\">{{ t('btn_create_send') }}</a-button>\r\n          <!-- <a-button :disabled=\"selectedRowKeys.length === 0\">批量管理</a-button> -->\r\n        </div>\r\n\r\n        <div class=\"table-box\">\r\n          <a-table :columns=\"columns\" :data-source=\"taskList\" :loading=\"loadingTasks\" row-key=\"id\"\r\n            :pagination=\"{ current: pager.page, pageSize: pager.size, total: pager.total, showSizeChanger: true, pageSizeOptions: ['10', '20', '50', '100'] }\"\r\n            @change=\"onTableChange\" :row-class-name=\"rowClassName\">\r\n            <template #headerCell=\"{ column }\">\r\n              <span v-if=\"typeof column.title === 'string'\">{{ column.title }}</span>\r\n            </template>\r\n            <template #expandIcon=\"{ expanded, onExpand, record }\">\r\n              <span class=\"expand-icon\" @click=\"onExpand(record)\">\r\n                <svg-icon v-if=\"expanded\" name=\"table-hide\" size=\"16px\" />\r\n                <svg-icon v-else name=\"table-expand\" size=\"16px\" />\r\n              </span>\r\n            </template>\r\n            <template #expandedRowRender=\"{ record }\">\r\n                <div class=\"expanded-draft\">\r\n                <img v-if=\"record.thumb_url\" class=\"thumb\" :src=\"record.thumb_url\" />\r\n                <img v-else class=\"thumb\" src=\"@/assets/img/default-cover.png\" />\r\n                <div class=\"info\">\r\n                  <div class=\"title\">{{ record.title }}</div>\r\n                  <div class=\"meta\">{{ t('expanded_group_label') }}{{ record.group_name }}</div>\r\n                  <div class=\"digest\">{{ record.digest || t('expanded_no_digest') }}</div>\r\n                </div>\r\n                <div class=\"expanded-meta\" @click=\"openCommentDrawer(record)\">\r\n                  <svg-icon name=\"comment\" size=\"32px\" style=\"color: transparent;\" />\r\n                  {{ record.max_comment_id }}\r\n                </div>\r\n              </div>\r\n            </template>\r\n            <template #bodyCell=\"{ column, record }\">\r\n              <template v-if=\"column.key === 'task_name'\">\r\n                <div class=\"task-cell\">\r\n                  <a-tag v-if=\"record.is_top == '1'\" color=\"blue\">{{ t('tag_pinned') }}</a-tag>\r\n                  <span class=\"name\">{{ record.task_name }}</span>\r\n                </div>\r\n              </template>\r\n              <template v-else-if=\"column.key === 'send_time'\">\r\n                <div class=\"send-time-cell\">\r\n                  <div class=\"status-tag\" :class=\"{'status-sending': record.send_status == '1', 'status-success': record.send_status == '2'}\">\r\n                    <svg-icon style=\"color: white;\" name=\"status-fail\" v-if=\"record.send_status == '-1'\" />\r\n                    <svg-icon style=\"color: white;\" name=\"status-fail\" v-else-if=\"record.send_status == '0'\" />\r\n                    <svg-icon style=\"color: white;\" name=\"status-sending\" v-else-if=\"record.send_status == '1'\" />\r\n                    <svg-icon style=\"color: white;\" name=\"status-success\" v-else-if=\"record.send_status == '2'\" />\r\n                    <svg-icon style=\"color: white;\" name=\"status-fail\" v-else-if=\"record.send_status == '3'\" />\r\n                    {{ statusTextMap[record.send_status] }}\r\n                    <a-tooltip :title=\"record.send_res?.errmsg\" v-if=\"record.send_status === '3'\">\r\n                      <ExclamationCircleOutlined style=\"font-size: 16px; color: #FF4D4F;\" />\r\n                    </a-tooltip>\r\n                  </div>\r\n                  <div v-if=\"record.send_time != '0'\" class=\"time\">{{ t('scheduled_send_prefix') }}{{ formatTime(record.send_time) }}</div>\r\n                  <div v-else class=\"time\">{{ t('immediate_send_prefix') }}{{ formatTime(record.create_time) }}</div>\r\n                </div>\r\n              </template>\r\n              <template v-else-if=\"column.key === 'receiver'\">\r\n                <span style=\"color: #595959;\">{{ toUserTypeMap[record.to_user_type] || t('receiver_all_fans') }}</span>\r\n              </template>\r\n              <template v-else-if=\"column.key === 'open_status'\">\r\n                <a-switch :checked=\"record.open_status == '1'\" :checked-children=\"t('switch_on')\" :un-checked-children=\"t('switch_off')\"\r\n                  @change=\"onToggleOpen(record, $event)\" />\r\n              </template>\r\n              <template v-else-if=\"column.key === 'comment_status'\">\r\n                <a-switch :checked=\"record.comment_status == '1'\" :checked-children=\"t('switch_on')\" :un-checked-children=\"t('switch_off')\"\r\n                  @change=\"onToggleMessageComment(record, $event)\" />\r\n              </template>\r\n              <template v-else-if=\"column.key === 'ai_comment_status'\">\r\n                <div class=\"ai-comment-cell\">\r\n                  <a-switch :checked=\"record.ai_comment_status == '1'\" :checked-children=\"t('switch_on')\" :un-checked-children=\"t('switch_off')\"\r\n                    @change=\"onToggleAiComment(record, $event)\" />\r\n                  <div class=\"comment-rule-cell\">\r\n                    <span class=\"rule\">\r\n                      <span v-if=\"record.is_default == '1'\" class=\"default-tag\">{{ t('tag_default') }}</span>\r\n                      {{ record.comment_rule_name || t('default_rule_name') }}\r\n                    </span>\r\n                    <a class=\"edit-link\" @click=\"editCommentRule(record)\">{{ t('link_edit_rule') }}</a>\r\n                  </div>\r\n                </div>\r\n              </template>\r\n              <template v-else-if=\"column.key === 'actions'\">\r\n                  <a-space style=\"gap: 16px;\">\r\n                  <a @click=\"editTask(record)\">{{ t('action_edit_task') }}</a>\r\n                  <a-dropdown>\r\n                    <a>{{ t('action_more') }}</a>\r\n                    <template #overlay>\r\n                      <a-menu>\r\n                        <a-menu-item @click=\"toggleTop(record)\">{{ record.is_top == '1' ? t('menu_unpin') : t('menu_pin')\r\n                          }}</a-menu-item>\r\n                        <a-menu-item @click=\"deleteTask(record)\">{{ t('menu_delete_task') }}</a-menu-item>\r\n                      </a-menu>\r\n                    </template>\r\n                  </a-dropdown>\r\n                </a-space>\r\n              </template>\r\n            </template>\r\n          </a-table>\r\n        </div>\r\n\r\n        \r\n        <CommentDrawer ref=\"commentDrawerRef\" />\r\n        <CommentRuleModal ref=\"commentRuleModalRef\" @updated=\"getTaskList\" />\r\n        <CreateSendModal ref=\"editSendModalRef\" :app-id=\"appId\" :access-key=\"accessKey\" @updated=\"getTaskList\" @created=\"getTaskList\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, createVNode, onMounted, onUnmounted, watch } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport { getSpecifyAbilityConfig } from '@/api/explore'\r\nimport {\r\n  getBatchSendTaskList,\r\n  setBatchSendTaskTopStatus,\r\n  deleteBatchSendTask,\r\n  setBatchSendTaskEnableStatus,\r\n  setBatchSendTaskCommentRuleStatus,\r\n  changeCommentStatus\r\n} from '@/api/robot'\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons-vue'\r\nimport CommentDrawer from './components/comment-drawer.vue'\r\nimport CommentRuleModal from './components/comment-rule-modal.vue'\r\nimport CreateSendModal from './components/create-send-modal.vue'\r\nimport { addNoReferrerMeta, removeNoReferrerMeta } from '@/utils/index.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst router = useRouter()\r\nconst { t } = useI18n('views.explore.article-group-send.group-send')\r\n\r\nconst props = defineProps({\r\n  appId: { type: String, default: '' },\r\n  accessKey: { type: String, default: '' }\r\n})\r\n\r\n\r\nconst taskList = ref([])\r\nconst loadingTasks = ref(false)\r\nconst pager = reactive({ page: 1, size: 10, total: 0 })\r\n\r\nconst statusTextMap = {\r\n  '-1': t('status_deleted'),\r\n  '0': t('status_not_sent'),\r\n  '1': t('status_sending'),\r\n  '2': t('status_sent'),\r\n  '3': t('status_failed'),\r\n}\r\nconst toUserTypeMap = { '0': t('receiver_all_fans') }\r\n\r\nconst columns = [\r\n  { title: t('column_task_name'), dataIndex: 'task_name', key: 'task_name' },\r\n  { title: t('column_send_time'), dataIndex: 'send_time', key: 'send_time' },\r\n  { title: t('column_receiver'), dataIndex: 'receiver', key: 'receiver' },\r\n  { title: t('column_open_status'), dataIndex: 'open_status', key: 'open_status' },\r\n  { title: t('column_comment_status'), dataIndex: 'comment_status', key: 'comment_status' },\r\n  { title: t('column_ai_comment_status'), dataIndex: 'ai_comment_status', key: 'ai_comment_status' },\r\n  { title: t('column_actions'), dataIndex: 'actions', key: 'actions' },\r\n]\r\n\r\nconst onTableChange = (pagination) => {\r\n  pager.page = pagination.current\r\n  pager.size = pagination.pageSize\r\n  getTaskList()\r\n}\r\n\r\nconst rowClassName = (record) => {\r\n  return record.is_top == '1' ? 'row-top' : ''\r\n}\r\n\r\nconst getTaskList = () => {\r\n  loadingTasks.value = true\r\n  getBatchSendTaskList({ page: pager.page, size: pager.size, app_id: props.appId }).then((res) => {\r\n    const data = res?.data || { list: [], total: 0 }\r\n    data.list.forEach(item => {\r\n      item.send_res = JSON.parse(item.send_res || '{}')\r\n    })\r\n    taskList.value = data.list || []\r\n    pager.total = +data.total || 0\r\n  }).finally(() => { loadingTasks.value = false })\r\n}\r\n\r\nconst toggleTop = async (record) => {\r\n  if (record.is_top == '1') {\r\n    Modal.confirm({\r\n      title: t('modal_unpin_title'),\r\n      icon: createVNode(ExclamationCircleOutlined),\r\n      onOk: async () => {\r\n        await setBatchSendTaskTopStatus({ task_id: record.id, is_top: record.is_top == '1' ? 0 : 1 })\r\n        message.success(t('message_unpinned'))\r\n        getTaskList()\r\n      }\r\n    })\r\n    return\r\n  }\r\n  await setBatchSendTaskTopStatus({ task_id: record.id, is_top: record.is_top == '1' ? 0 : 1 })\r\n  message.success(record.is_top == '1' ? t('message_unpinned') : t('message_pinned'))\r\n  getTaskList()\r\n}\r\n\r\nconst deleteTask = (record) => {\r\n  Modal.confirm({\r\n    title: t('modal_delete_task_title', { name: record.task_name }),\r\n    icon: createVNode(ExclamationCircleOutlined),\r\n    onOk: async () => {\r\n      await deleteBatchSendTask({ task_id: record.id })\r\n      message.success(t('message_delete_success'))\r\n      getTaskList()\r\n    }\r\n  })\r\n}\r\n\r\nconst onToggleOpen = async (record, checked) => {\r\n  const open_status = checked ? 1 : 0\r\n  if (!checked) {\r\n    Modal.confirm({\r\n      title: t('modal_close_send_title'),\r\n      icon: createVNode(ExclamationCircleOutlined),\r\n      onOk: async () => {\r\n        await setBatchSendTaskEnableStatus({ task_id: record.id, open_status })\r\n        record.open_status = String(open_status)\r\n        message.success(t('message_send_closed'))\r\n        getTaskList()\r\n      }\r\n    })\r\n    return\r\n  }\r\n  await setBatchSendTaskEnableStatus({ task_id: record.id, open_status })\r\n  record.open_status = String(open_status)\r\n  message.success(t('message_operation_success'))\r\n}\r\n\r\nconst onToggleAiComment = async (record, checked) => {\r\n  if (checked) {\r\n    try {\r\n      const res = await getSpecifyAbilityConfig({ ability_type: 'official_account_ai_comment' })\r\n      const status = res?.data?.user_config?.switch_status\r\n      if (String(status || '0') !== '1') {\r\n        Modal.confirm({\r\n          title: t('modal_ai_comment_title'),\r\n          content: createVNode('div', null, [\r\n            createVNode('span', { style: 'color: #ff4d4f;' }, t('modal_ai_comment_not_enabled')),\r\n            createVNode('span', null, t('modal_ai_comment_not_enabled_tip'))\r\n          ]),\r\n          okText: t('modal_ai_comment_ok'),\r\n          cancelText: t('btn_cancel'),\r\n          onOk: () => {\r\n            router.push('/explore/index/ai-comment-management')\r\n          }\r\n        })\r\n        return\r\n      }\r\n    } catch (e) {\r\n      console.error(e)\r\n    }\r\n  }\r\n\r\n  const ai_comment_status = checked ? 1 : 0\r\n  if (!checked) {\r\n    Modal.confirm({\r\n      title: t('modal_close_ai_rule_title'),\r\n      icon: createVNode(ExclamationCircleOutlined),\r\n      onOk: async () => {\r\n        await setBatchSendTaskCommentRuleStatus({ task_id: record.id, ai_comment_status })\r\n        record.ai_comment_status = String(ai_comment_status)\r\n        message.success(t('message_ai_rule_closed'))\r\n        getTaskList()\r\n      }\r\n    })\r\n    return\r\n  }\r\n  await setBatchSendTaskCommentRuleStatus({ task_id: record.id, ai_comment_status })\r\n  record.ai_comment_status = String(ai_comment_status)\r\n  // message.success('操作成功')\r\n  commentRuleModalRef.value && commentRuleModalRef.value.show({ ...record })\r\n}\r\n\r\nconst onToggleMessageComment = async (record, checked) => {\r\n  const comment_status = checked ? 1 : 0\r\n  if (!checked) {\r\n    Modal.confirm({\r\n      title: t('modal_close_comment_title'),\r\n      icon: createVNode(ExclamationCircleOutlined),\r\n      onOk: async () => {\r\n        await changeCommentStatus({ task_id: record.id, msg_id: record.msg_data_id, access_key: props.accessKey, comment_status })\r\n        record.comment_status = String(comment_status)\r\n        message.success(t('message_comment_closed'))\r\n        getTaskList()\r\n      }\r\n    })\r\n    return\r\n  }\r\n  await changeCommentStatus({ task_id: record.id, msg_id: record.msg_data_id, access_key: props.accessKey, comment_status })\r\n  record.comment_status = String(comment_status)\r\n  message.success(t('message_operation_success'))\r\n}\r\n\r\nconst editSendModalRef = ref(null)\r\nconst editTask = (record) => { editSendModalRef.value && editSendModalRef.value.show({ task: record }) }\r\nconst handleCreateSend = () => { editSendModalRef.value && editSendModalRef.value.show({}) }\r\nconst commentRuleModalRef = ref(null)\r\nconst editCommentRule = (record) => { commentRuleModalRef.value && commentRuleModalRef.value.show({ ...record }) }\r\n\r\n\r\nconst formatTime = (ts) => {\r\n  if (!ts) return ''\r\n  const d = new Date(Number(ts) * 1000)\r\n  const yy = String(d.getFullYear()).slice(2)\r\n  const m = String(d.getMonth() + 1).padStart(2, '0')\r\n  const dd = String(d.getDate()).padStart(2, '0')\r\n  const hh = String(d.getHours()).padStart(2, '0')\r\n  const mm = String(d.getMinutes()).padStart(2, '0')\r\n  return `${yy}-${m}-${dd} ${hh}:${mm}`\r\n}\r\n\r\nwatch(() => props.appId, () => {\r\n  pager.page = 1\r\n  if (props.appId) getTaskList()\r\n}, { immediate: true })\r\n\r\nonMounted(() => { addNoReferrerMeta() })\r\nonUnmounted(() => { removeNoReferrerMeta() })\r\n\r\nconst commentDrawerRef = ref(null)\r\nconst openCommentDrawer = (record) => { commentDrawerRef.value && commentDrawerRef.value.show({ ...record }) }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n\r\n.line-box {\r\n  height: 1px;\r\n  background: #F0F0F0;\r\n  margin-top: 16px;\r\n}\r\n\r\n.toolbar {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.table-box {\r\n  margin-top: 12px;\r\n}\r\n\r\n.task-cell {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  color: #262626;\r\n}\r\n\r\n::v-deep(.ant-table-tbody > tr.row-top > td) {\r\n  background-color: #F5F5F5 !important;\r\n}\r\n\r\n.send-time-cell {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  color: #595959;\r\n\r\n  .status-tag {\r\n    display: flex;\r\n    padding: 0 6px;\r\n    align-items: center;\r\n    gap: 2px;\r\n    border-radius: 6px;\r\n    background: #FAE4DC;\r\n    color: #ED744A;\r\n    font-size: 14px;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    line-height: 22px;\r\n  }\r\n\r\n  .status-sending {\r\n    background: #D4E3FC;\r\n    color: #2475FC;\r\n  }\r\n\r\n  .status-success {\r\n    background: #CAFCE4;\r\n    color: #21A665;\r\n  }\r\n}\r\n\r\n.expanded-draft {\r\n  display: flex;\r\n  gap: 12px;\r\n  align-items: center;\r\n  padding: 12px;\r\n  border: 1px solid #edeff2;\r\n  border-radius: 8px;\r\n  margin-left: 48px;\r\n}\r\n\r\n.expand-icon {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n}\r\n\r\n.expanded-draft .thumb {\r\n  width: 146px;\r\n  height: 96px;\r\n  border-radius: 6px;\r\n  object-fit: cover;\r\n}\r\n\r\n.expanded-draft .info {\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.expanded-draft .info .title {\r\n  font-weight: 600;\r\n  color: #262626;\r\n}\r\n\r\n.expanded-draft .info .meta {\r\n  color: #8c8c8c;\r\n  margin: 4px 0;\r\n}\r\n\r\n.expanded-draft .info .digest {\r\n  color: #595959;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n}\r\n\r\n.expanded-draft .expanded-meta {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 2px;\r\n  color: #8c8c8c;\r\n  font-size: 12px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 20px;\r\n  margin-left: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.ai-comment-cell {\r\n  .comment-rule-cell {\r\n    display: block;\r\n    margin-top: 4px;\r\n    color: #8C8C8C;\r\n    font-size: 12px;\r\n\r\n    .edit-link {\r\n      margin-left: 4px;\r\n    }\r\n\r\n    .default-tag {\r\n      color: #1677ff;\r\n      background: #e6f4ff;\r\n      padding: 0px 2px;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      border: 1px solid #91caff;\r\n    }\r\n  }\r\n}\r\n\r\n \r\n</style>\r\n"],"names":["t","useI18n","defaultAvatar","DEFAULT_ROBOT_AVATAR","userAvatar","DEFAULT_USER_AVATAR","open","ref","article","isLoading","pagination","reactive","list","hasMore","loadingMore","bodyAnchorRef","bodyEl","show","record","loadComments","getCommentList","res","data","handleDelete","item","Modal","createVNode","ExclamationCircleOutlined","deleteComment","message","handleDeleteReply","deleteCommentReply","__expose","formatUserName","open_id","suf","isSelected","it","tryAttach","onBodyScroll","detach","nextPage","nextList","watch","val","nextTick","onMounted","addNoReferrerMeta","onUnmounted","removeNoReferrerMeta","_createBlock","_component_a_drawer","$event","_unref","_createElementVNode","_hoisted_1","_createElementBlock","_openBlock","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_29","_createVNode","_component_a_spin","_Fragment","_renderList","_component_a_avatar","_hoisted_9","_hoisted_10","_hoisted_11","_component_a_tag","_hoisted_12","_hoisted_13","_hoisted_14","DeleteOutlined","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_component_a_empty","_hoisted_26","router","useRouter","props","__props","taskList","loadingTasks","pager","statusTextMap","toUserTypeMap","columns","onTableChange","getTaskList","rowClassName","getBatchSendTaskList","toggleTop","setBatchSendTaskTopStatus","deleteTask","deleteBatchSendTask","onToggleOpen","checked","open_status","setBatchSendTaskEnableStatus","onToggleAiComment","getSpecifyAbilityConfig","status","_b","_a","e","ai_comment_status","setBatchSendTaskCommentRuleStatus","commentRuleModalRef","onToggleMessageComment","comment_status","changeCommentStatus","editSendModalRef","editTask","handleCreateSend","editCommentRule","formatTime","ts","d","yy","m","dd","hh","mm","commentDrawerRef","openCommentDrawer","_hoisted_2","_component_a_button","_component_a_table","_withCtx","column","expanded","onExpand","_component_svg_icon","_normalizeClass","_createTextVNode","_component_a_tooltip","_component_a_switch","_component_a_space","_component_a_dropdown","_component_a_menu","_component_a_menu_item","CommentDrawer","CommentRuleModal","CreateSendModal"],"mappings":"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"}