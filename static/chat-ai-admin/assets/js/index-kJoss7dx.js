import{_ as V,b as q,O as P,P as X,Q as Y,S as j,T as H}from"../../index-C1Xsov4S.js";import{v as K,w as W,I as A,al as Z,M as I,a as F,b as Q,X as T,F as z,k as ee,B as oe,y as te,a6 as ae,Q as le}from"./ui-antd-D64OvTpt.js";import{f as v,r as N,a1 as D,_ as $,a2 as r,a5 as n,a7 as f,u as s,k as i,Y as B,ab as ne,F as se,J as G,G as ie,ae as ce}from"./vue-chunks-DCKTEHpB.js";import"./utils-D9NMMoMR.js";const de={class:"add-domain-form"},_e={class:"form-item"},ue={class:"form-label"},re={class:"form-input-box"},pe={class:"form-tip"},fe={__name:"add-domain-modal ",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(O,{expose:l,emit:g}){const b=O;function d(t){return t=t.replace("ã€‚",".").toLowerCase(),t=t.replace(/\/$/,""),t=t.replace(/(^\s*)|(\s*$)/g,""),t=t.replace("http://",""),t=t.replace("https://",""),t}const{t:h}=q("views.user.domain.components.add-domain-modal"),L=g,a=v(!1),x=v(h("add_title")),p=v([{label:"http",value:"http:"},{label:"https",value:"https:"}]),o=N({id:null,url:"",protocol:"http:"}),S=()=>{try{if(o.url){const t=new URL(o.url);t.protocol=="http:"||t.protocol=="https:"?o.protocol=t.protocol:o.protocol="http:",o.url=t.hostname}}catch{o.url=d(o.url)}},U=()=>{if(!o.url)return F.error(h("url_required"));o.url=d(o.url),L("ok",{...o})};return l({open:t=>{t?(o.url=t.url,o.protocol=t.protocol,o.id=t.id,x.value=h("edit_title")):(o.id=null,o.url="",o.protocol="http:",x.value=h("add_title")),a.value=!0},close:()=>{a.value=!1}}),(t,m)=>{const C=W,k=K,e=A,_=Z,w=I;return $(),D(w,{open:a.value,"onUpdate:open":m[2]||(m[2]=y=>a.value=y),title:x.value,onOk:U,confirmLoading:b.confirmLoading},{default:r(()=>[n("div",de,[n("div",_e,[n("div",ue,f(s(h)("domain_label")),1),n("div",re,[i(_,{compact:"",style:{width:"100%"}},{default:r(()=>[i(k,{value:o.protocol,"onUpdate:value":m[0]||(m[0]=y=>o.protocol=y),style:{width:"20%"}},{default:r(()=>[($(!0),B(se,null,ne(p.value,y=>($(),D(C,{value:y.value,key:y.value},{default:r(()=>[n("span",null,f(y.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),i(e,{value:o.url,"onUpdate:value":m[1]||(m[1]=y=>o.url=y),style:{width:"80%"},placeholder:s(h)("domain_placeholder"),onBlur:S},null,8,["value","placeholder"])]),_:1})])]),n("div",pe,f(s(h)("domain_tip")),1)])]),_:1},8,["open","title","confirmLoading"])}}},me=V(fe,[["__scopeId","data-v-7c0ef0a4"]]),ve={class:"upload-ssl-form"},he={class:"domain"},ke={__name:"upload-ssl",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(O,{expose:l,emit:g}){const b=g,{t:d}=q("views.user.domain.components.upload-ssl"),h=O,L=v(),a=N({id:"",domain:"",ssl_certificate:"",ssl_certificate_key:""}),x={ssl_certificate:[{required:!0,message:d("certificate_required")}],ssl_certificate_key:[{required:!0,message:d("private_key_required")}]},p=v(!1),o=u=>{a.id=u.id,a.domain=u.url,a.ssl_certificate="",a.ssl_certificate_key="",p.value=!0},S=()=>{p.value=!1},U=()=>{L.value.validate().then(()=>{b("ok",G(a))}).catch(u=>{})};return l({open:o,close:S}),(u,c)=>{const t=T,m=Q,C=z,k=I;return $(),D(k,{open:p.value,"onUpdate:open":c[2]||(c[2]=e=>p.value=e),title:s(d)("title"),onOk:U,confirmLoading:h.confirmLoading},{default:r(()=>[n("div",ve,[n("div",he,f(s(d)("domain_label"))+f(u.domain),1),i(C,{ref_key:"formRef",ref:L,model:a,rules:x,autocomplete:"off",layout:"vertical"},{default:r(()=>[i(m,{label:s(d)("certificate_file_label"),name:"ssl_certificate"},{default:r(()=>[i(t,{rows:5,value:a.ssl_certificate,"onUpdate:value":c[0]||(c[0]=e=>a.ssl_certificate=e)},null,8,["value"])]),_:1},8,["label"]),i(m,{label:s(d)("private_key_label"),name:"ssl_certificate_key"},{default:r(()=>[i(t,{rows:5,value:a.ssl_certificate_key,"onUpdate:value":c[1]||(c[1]=e=>a.ssl_certificate_key=e)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["open","title","confirmLoading"])}}},ye=V(ke,[["__scopeId","data-v-18ec9bda"]]),ge={class:"upload-ssl-form"},be={__name:"upload-validation-file",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(O,{expose:l,emit:g}){const b=g,{t:d}=q("views.user.domain.components.upload-validation-file"),h=O,L=v(),a=N({id:"",file_name:"",file_content:""}),x={file_name:[{required:!0,message:d("file_name_required")}],file_content:[{required:!0,message:d("file_content_required")}]},p=v(!1),o=u=>{a.id=u.id,a.file_name="",a.file_content="",p.value=!0},S=()=>{p.value=!1},U=()=>{L.value.validate().then(()=>{b("ok",G(a))}).catch(u=>{})};return l({open:o,close:S}),(u,c)=>{const t=A,m=Q,C=T,k=z,e=I;return $(),D(e,{open:p.value,"onUpdate:open":c[2]||(c[2]=_=>p.value=_),title:s(d)("title"),onOk:U,confirmLoading:h.confirmLoading},{default:r(()=>[n("div",ge,[i(k,{ref_key:"formRef",ref:L,model:a,rules:x,autocomplete:"off",layout:"vertical"},{default:r(()=>[i(m,{label:s(d)("file_name_label"),name:"file_name"},{default:r(()=>[i(t,{value:a.file_name,"onUpdate:value":c[0]||(c[0]=_=>a.file_name=_)},null,8,["value"])]),_:1},8,["label"]),i(m,{label:s(d)("file_content_label"),name:"file_content"},{default:r(()=>[i(C,{rows:5,value:a.file_content,"onUpdate:value":c[1]||(c[1]=_=>a.file_content=_)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["open","title","confirmLoading"])}}},Le=V(be,[["__scopeId","data-v-b6a0eb24"]]),xe={class:"domain-page"},we={class:"page-container"},$e={class:"page-title"},Ce={class:"domain-tips"},Se={class:"tip-text"},Ue={class:"list-action-box"},Oe={class:"list-box"},Re={key:0},Fe={key:1},Be={key:2,class:"action-box"},De=["onClick"],Ve=["onClick"],qe=["onClick"],Ie=["onClick"],Me={__name:"index",setup(O){const{t:l}=q("views.user.domain.index"),g=v(null),b=v(!1),d=[{title:l("table_column_domain"),dataIndex:"url",key:"url"},{title:l("table_column_certificate"),dataIndex:"is_upload",key:"is_upload",width:300},{title:l("table_column_action"),key:"action"}],h=()=>{g.value.open()},L=e=>{let _={id:e.id,url:e.url,protocol:"http:"};try{const w=new URL(e.url);w.protocol=="http:"||w.protocol=="https:"?_.protocol=w.protocol:_.protocol="http:",_.url=w.hostname}catch{}g.value.open(_)},a=e=>{b.value=!0;let _=`${e.protocol}//${e.url}`;Y({url:_,id:e.id||void 0}).then(()=>{F.success(l("save_success")),b.value=!1,g.value.close(),k()}).catch(()=>{b.value=!1})},x=e=>{I.confirm({title:l("delete_confirm_title"),icon:i(le),content:l("delete_confirm_content"),onOk(){X({id:e.id}).then(()=>{F.success(l("delete_success")),k()})},onCancel(){}})},p=v(null),o=v(!1),S=e=>{p.value.open(e)},U=e=>{o.value=!0;let _={id:e.id,ssl_certificate:e.ssl_certificate,ssl_certificate_key:e.ssl_certificate_key};j(_).then(()=>{o.value=!1,p.value.close(),F.success(l("upload_success")),k()}).catch(()=>{o.value=!1})},u=v(null),c=v(!1),t=e=>{u.value.open(e)},m=e=>{c.value=!0,H({...e}).then(()=>{c.value=!1,u.value.close(),F.success(l("upload_success")),k()}).catch(()=>{c.value=!1})},C=v([]),k=async()=>{const e=await P();C.value=e.data||[]};return k(),(e,_)=>{const w=ee,y=oe,J=te;return $(),B("div",xe,[n("div",we,[n("div",$e,f(s(l)("page_title")),1),n("div",Ce,[i(w,{type:"info","show-icon":""},{icon:r(()=>[n("div",null,[i(s(ae),{style:{"font-size":"16px"}})])]),description:r(()=>[n("div",Se,[n("div",null,f(s(l)("domain_tip_1")),1),n("div",null,f(s(l)("domain_tip_2")),1)])]),_:1})]),n("div",Ue,[n("div",null,[i(y,{type:"primary",onClick:h},{default:r(()=>[ie(f(s(l)("add_domain_btn")),1)]),_:1})])]),n("div",Oe,[i(J,{columns:d,"data-source":C.value},{bodyCell:r(({column:M,record:R})=>[M.key==="url"?($(),B("span",Re,f(R.url),1)):M.key==="is_upload"?($(),B("span",Fe,f(R.is_upload?s(l)("certificate_uploaded"):s(l)("certificate_not_uploaded")),1)):M.key==="action"?($(),B("span",Be,[n("a",{class:"action-btn",onClick:E=>S(R)},f(s(l)("upload_certificate")),9,De),n("a",{class:"action-btn",onClick:E=>t(R)},f(s(l)("upload_validation_file")),9,Ve),n("a",{class:"action-btn",onClick:E=>L(R)},f(s(l)("edit")),9,qe),n("a",{class:"action-btn",onClick:E=>x(R)},f(s(l)("delete")),9,Ie)])):ce("",!0)]),_:1},8,["data-source"])])]),i(me,{ref_key:"addDomainModalRef",ref:g,confirmLoading:b.value,onOk:a},null,8,["confirmLoading"]),i(ye,{ref_key:"uploadSSLRef",ref:p,"confirm-loading":o.value,onOk:U},null,8,["confirm-loading"]),i(Le,{ref_key:"uploadValidationFileRef",ref:u,"confirm-loading":c.value,onOk:m},null,8,["confirm-loading"])])}}},Te=V(Me,[["__scopeId","data-v-851a60be"]]);export{Te as default};
