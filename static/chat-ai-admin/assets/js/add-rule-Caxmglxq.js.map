{"version":3,"file":"add-rule-Caxmglxq.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/robot/robot-config/auto-reply/add-rule.vue"],"sourcesContent":["<template>\r\n  <div class=\"subManage-edit\">\r\n    <a-breadcrumb class=\"subManage-breadcrumb\">\r\n      <a-breadcrumb-item><a :href=\"autoReplyUrl\">{{ t('breadcrumb_keyword_reply') }}</a></a-breadcrumb-item>\r\n      <a-breadcrumb-item>{{ t('breadcrumb_add_rule') }}</a-breadcrumb-item>\r\n    </a-breadcrumb>\r\n\r\n    <div class=\"main\">\r\n      <a-form ref=\"formRef\" :model=\"form\" :rules=\"rules\">\r\n        <a-form-item :label=\"t('label_rule_name')\" name=\"name\" :rules=\"[{ required: true, message: t('msg_input_rule_name') }]\">\r\n          <a-input v-model:value=\"form.name\" :placeholder=\"t('ph_input')\" style=\"width: 512px;\" />\r\n        </a-form-item>\r\n\r\n        <div class=\"nav-box\" style=\"padding-top: 10px;\">\r\n          <svg-icon name=\"set-keywords\" style=\"font-size: 16px;\"></svg-icon>\r\n          {{ t('title_set_keywords') }}\r\n        </div>\r\n\r\n        <!-- 精准匹配 -->\r\n        <div class=\"item-box\">\r\n          <div class=\"item-title-box\">\r\n            <div class=\"item-title\">{{ t('title_exact_match') }}</div>\r\n            <a-tooltip>\r\n              <template #title>{{ t('tip_exact_match') }}</template>\r\n              <QuestionCircleOutlined style=\"color: #8C8C8C;\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"flex\" style=\"gap:8px;align-items:center;\">\r\n            <template v-if=\"addingFull\">\r\n              <a-input\r\n                ref=\"fullInputRef\"\r\n                v-model:value=\"fullKeywordInput\"\r\n                :placeholder=\"t('ph_input_keyword')\"\r\n                style=\"width:260px;\"\r\n                @pressEnter=\"confirmAddFull\"\r\n                @blur=\"confirmAddFull\"\r\n              />\r\n            </template>\r\n            <template v-else>\r\n              <a-button type=\"dashed\" class=\"add-btn\" @click=\"startAddFull\">\r\n                <template #icon>\r\n                  <PlusOutlined />\r\n                </template>\r\n                {{ t('btn_add_keyword') }}\r\n              </a-button>\r\n            </template>\r\n          </div>\r\n          <div class=\"tag-container\" style=\"margin-top:8px;\">\r\n            <a-tag v-for=\"item in fullKeywords\" :key=\"item\" closable @close=\"removeFullKeyword(item)\">\r\n              {{ item }}\r\n            </a-tag>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 模糊匹配 -->\r\n        <div class=\"item-box\" style=\"margin-top: 12px;\">\r\n          <div class=\"item-title-box\">\r\n            <div class=\"item-title\">{{ t('title_fuzzy_match') }}</div>\r\n            <a-tooltip>\r\n              <template #title>{{ t('tip_fuzzy_match') }}</template>\r\n              <QuestionCircleOutlined style=\"color: #8C8C8C;\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"flex\" style=\"gap:8px;align-items:center;\">\r\n            <template v-if=\"addingHalf\">\r\n              <a-input\r\n                ref=\"halfInputRef\"\r\n                v-model:value=\"halfKeywordInput\"\r\n                :placeholder=\"t('ph_input_keyword')\"\r\n                style=\"width:260px;\"\r\n                @pressEnter=\"confirmAddHalf\"\r\n                @blur=\"confirmAddHalf\"\r\n              />\r\n            </template>\r\n            <template v-else>\r\n              <a-button type=\"dashed\" class=\"add-btn\" @click=\"startAddHalf\">\r\n                <template #icon>\r\n                  <PlusOutlined />\r\n                </template>\r\n                {{ t('btn_add_keyword') }}\r\n              </a-button>\r\n            </template>\r\n          </div>\r\n          <div class=\"tag-container\" style=\"margin-top:8px;\">\r\n            <a-tag v-for=\"item in halfKeywords\" :key=\"item\" closable @close=\"removeHalfKeyword(item)\">\r\n              {{ item }}\r\n            </a-tag>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 回复内容 -->\r\n        <div class=\"nav-box\" style=\"margin-top: 24px;\">\r\n          <svg-icon name=\"reply-content\" style=\"font-size: 16px;\"></svg-icon>\r\n          {{ t('title_reply_content') }}\r\n        </div>\r\n        <div class=\"item-box\">\r\n          <MultiReply v-for=\"(it, idx) in replyList\" :key=\"idx\" ref=\"replyRefs\" v-model:value=\"replyList[idx]\" :reply_index=\"idx\"\r\n            @change=\"onContentChange\" @del=\"onDelItem\" />\r\n          <a-button type=\"dashed\" style=\"width: 694px;\" :disabled=\"replyList.length >= 5\" @click=\"addReplyItem\">\r\n            <template #icon>\r\n              <PlusOutlined />\r\n            </template>\r\n            {{ t('btn_add_reply_content') }}({{replyList.length}}/5)\r\n          </a-button>\r\n        </div>\r\n\r\n        <!-- 回复设置 -->\r\n        <div class=\"nav-box\" style=\"margin-top: 24px;\">\r\n          <svg-icon name=\"reply-settings\" style=\"font-size: 16px;\"></svg-icon>\r\n          {{ t('title_reply_settings') }}\r\n        </div>\r\n        <div class=\"item-box\">\r\n          <div class=\"item-title-box\">\r\n            <div class=\"item-title\">{{ t('label_reply_method') }}</div>\r\n          </div>\r\n          <div class=\"radio-container\">\r\n            <a-radio-group v-model:value=\"form.reply_num\" @change=\"handleReplyTypeChange\">\r\n              <a-radio value=\"0\">{{ t('reply_all') }}</a-radio>\r\n              <a-radio value=\"1\">{{ t('reply_random') }}</a-radio>\r\n            </a-radio-group>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 保存 底部固定 -->\r\n        <div class=\"btn-container\">\r\n          <a-button type=\"primary\" @click=\"onSubmit\">{{ t('btn_save') }}</a-button>\r\n        </div>\r\n      </a-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport { QuestionCircleOutlined, PlusOutlined } from '@ant-design/icons-vue'\r\nimport { onMounted, ref, reactive, computed, nextTick, toRaw } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { message } from 'ant-design-vue'\r\nimport MultiReply from '@/components/replay-card/multi-reply.vue'\r\nimport { getRobotKeywordReply, saveRobotKeywordReply, checkKeyWordRepeat } from '@/api/explore/index.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.robot.robot-config.auto-reply.add-rule')\r\nconst query = useRoute().query\r\nconst ruleId = ref(+query.rule_id || +query['rule-id'] || 0)\r\nconst router = useRouter()\r\nconst autoReplyUrl = computed(() => `/#/robot/ability/auto-reply?id=${query.id}&robot_key=${query.robot_key}`)\r\nconst formRef = ref(null)\r\nconst form = reactive({\r\n  name: '',\r\n  reply_num: '0'\r\n})\r\nconst rules = {\r\n  name: [\r\n    { required: true, message: t('msg_input_rule_name'), trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 关键词集合\r\nconst fullKeywords = ref([])\r\nconst halfKeywords = ref([])\r\nconst fullKeywordInput = ref('')\r\nconst halfKeywordInput = ref('')\r\nconst addingFull = ref(false)\r\nconst addingHalf = ref(false)\r\nconst fullInputRef = ref(null)\r\nconst halfInputRef = ref(null)\r\nconst addingFullBusy = ref(false)\r\nconst startAddFull = () => {\r\n  addingFull.value = true\r\n  nextTick(() => {\r\n    const comp = fullInputRef.value\r\n    if (comp?.focus) comp.focus()\r\n    else comp?.$el?.querySelector('input')?.focus()\r\n  })\r\n}\r\nconst confirmAddFull = async () => {\r\n  if (addingFullBusy.value) return\r\n  const v = (fullKeywordInput.value || '').trim()\r\n  if (!v) { message.warning(t('msg_input_keyword')); return }\r\n  if (fullKeywords.value.includes(v)) { message.warning(t('msg_keyword_exists')); return }\r\n  try {\r\n    addingFullBusy.value = true\r\n    const res = await checkKeyWordRepeat({ id: ruleId.value, robot_id: query.id, keyword: v })\r\n    const repeat = res?.data?.is_repeat\r\n    const ruleName = res?.data?.rule_name || ''\r\n    if (repeat) {\r\n      message.error(t('msg_keyword_duplicate', { ruleName }))\r\n      return\r\n    }\r\n    fullKeywords.value.push(v)\r\n    fullKeywordInput.value = ''\r\n    addingFull.value = false\r\n  } catch (e) {\r\n    message.error(t('msg_check_failed'))\r\n  } finally {\r\n    addingFullBusy.value = false\r\n  }\r\n}\r\nconst removeFullKeyword = (k) => {\r\n  fullKeywords.value = fullKeywords.value.filter((x) => x !== k)\r\n}\r\nconst addingHalfBusy = ref(false)\r\nconst startAddHalf = () => {\r\n  addingHalf.value = true\r\n  nextTick(() => {\r\n    const comp = halfInputRef.value\r\n    if (comp?.focus) comp.focus()\r\n    else comp?.$el?.querySelector('input')?.focus()\r\n  })\r\n}\r\nconst confirmAddHalf = async () => {\r\n  if (addingHalfBusy.value) return\r\n  const v = (halfKeywordInput.value || '').trim()\r\n  if (!v) { message.warning(t('msg_input_keyword')); return }\r\n  if (halfKeywords.value.includes(v)) { message.warning(t('msg_keyword_exists')); return }\r\n  try {\r\n    addingHalfBusy.value = true\r\n    const res = await checkKeyWordRepeat({ id: ruleId.value, robot_id: query.id, keyword: v })\r\n    const repeat = res?.data?.is_repeat\r\n    const ruleName = res?.data?.rule_name || ''\r\n    if (repeat) {\r\n      message.error(t('msg_keyword_duplicate', { ruleName }))\r\n      return\r\n    }\r\n    halfKeywords.value.push(v)\r\n    halfKeywordInput.value = ''\r\n    addingHalf.value = false\r\n  } catch (e) {\r\n    message.error(t('msg_check_failed'))\r\n  } finally {\r\n    addingHalfBusy.value = false\r\n  }\r\n}\r\nconst removeHalfKeyword = (k) => {\r\n  halfKeywords.value = halfKeywords.value.filter((x) => x !== k)\r\n}\r\n\r\n// 回复内容列表\r\nconst replyList = ref([{ type: 'text', description: '' }])\r\nconst replyRefs = ref([])\r\nconst addReplyItem = () => {\r\n  if (replyList.value.length >= 5) {\r\n    message.warning(t('msg_max_reply_content'))\r\n    return\r\n  }\r\n  replyList.value.push({ type: 'text', description: '' })\r\n}\r\nconst onContentChange = (payload) => {\r\n  const { reply_index, ...rest } = payload\r\n  if (reply_index >= 0 && reply_index < replyList.value.length) {\r\n    replyList.value[reply_index] = rest\r\n  }\r\n}\r\nconst onDelItem = (index) => {\r\n  replyList.value.splice(index, 1)\r\n}\r\n\r\nfunction mapApiTypeToTabType (t) {\r\n  switch (t) {\r\n    case 'text': return 1\r\n    case 'image': return 2\r\n    case 'card': return 6\r\n    case 'imageText': return 1 // 兜底为文本\r\n    default: return 1\r\n  }\r\n}\r\n\r\nconst handleReplyTypeChange = () => {\r\n\r\n}\r\n\r\nfunction mapApiReplyToItem (rc) {\r\n  const typeStr = rc?.type || rc?.reply_type || 'text'\r\n  const tabType = mapApiTypeToTabType(typeStr)\r\n  let content = ''\r\n  if (tabType === 1) content = rc?.description || ''\r\n  else if (tabType === 2) content = rc?.thumb_url || rc?.pic || ''\r\n  else if (tabType === 6) content = ''\r\n  return {\r\n    id: rc?.id || '',\r\n    content,\r\n    type: tabType,\r\n    type_main_id: rc?.type_main_id || '',\r\n    extra: rc?.extra || {},\r\n    err_msg: rc?.err_msg || {},\r\n    delay_time: rc?.delay_time || '',\r\n    key: rc?.key || ''\r\n  }\r\n}\r\n\r\nfunction serializeReplyContent (list) {\r\n  return (list || []).map((it) => ({ ...it, status: '1' }))\r\n}\r\n\r\nfunction serializeReplyTypeCodes (list) {\r\n  const map = { text: '2', image: '4', card: '3', imageText: '1', url: '5', smartMenu: '6' }\r\n  return list.map((it) => map[it.type] || '').filter(Boolean)\r\n}\r\n\r\nconst onSubmit = () => {\r\n  formRef.value?.validate().then(async () => {\r\n    if (!fullKeywords.value.length && !halfKeywords.value.length) {\r\n      message.warning(t('msg_at_least_one_keyword'))\r\n      return\r\n    }\r\n    if (!replyList.value.length) {\r\n      message.warning(t('msg_at_least_one_reply'))\r\n      return\r\n    }\r\n    for (const comp of replyRefs.value) {\r\n      if (comp && comp.validate) {\r\n        const ok = await comp.validate()\r\n        if (!ok) { return }\r\n      }\r\n    }\r\n    const payload = {\r\n      robot_id: query.id,\r\n      name: form.name,\r\n      full_keyword: fullKeywords.value,\r\n      half_keyword: halfKeywords.value,\r\n      reply_content: JSON.stringify(serializeReplyContent(replyList.value)),\r\n      reply_type: serializeReplyTypeCodes(replyList.value),\r\n      reply_num: form.reply_num\r\n    }\r\n    if (ruleId.value) payload.id = ruleId.value\r\n    try {\r\n      const res = await saveRobotKeywordReply(payload)\r\n      if (res && res.res == 0) {\r\n        message.success(t('msg_save_success'))\r\n        router.push({ path: '/robot/ability/auto-reply', query: { id: query.id, robot_key: query.robot_key } })\r\n      }\r\n    } catch (e) {\r\n      // message.error('保存失败，请稍后重试')\r\n    }\r\n  })\r\n}\r\n\r\n\r\nonMounted(async () => {\r\n  const copyId = +(query.copy_id || 0)\r\n  if (!ruleId.value && copyId) {\r\n    try {\r\n      const res = await getRobotKeywordReply({ id: copyId })\r\n      const data = res?.data || {}\r\n      form.name = `${(data?.name || '')}${t('label_copy_suffix')}`\r\n      // fullKeywords.value = Array.isArray(data?.full_keyword) ? data.full_keyword : []\r\n      // halfKeywords.value = Array.isArray(data?.half_keyword) ? data.half_keyword : []\r\n      const list = Array.isArray(data?.reply_content) ? data.reply_content : []\r\n      replyList.value = list.map((rc) => ({\r\n        type: (rc?.type || rc?.reply_type || 'text'),\r\n        description: rc?.description || '',\r\n        thumb_url: rc?.thumb_url || rc?.pic || '',\r\n        title: rc?.title || '',\r\n        url: rc?.url || '',\r\n        appid: rc?.appid || '',\r\n        page_path: rc?.page_path || '',\r\n        smart_menu_id: rc?.smart_menu_id || '',\r\n        smart_menu: rc?.smart_menu || {},\r\n      }))\r\n      form.reply_num = data.reply_num\r\n    } catch (e) {\r\n      message.error(t('msg_load_failed'))\r\n    }\r\n    return\r\n  }\r\n  if (!ruleId.value) return\r\n  try {\r\n    const res = await getRobotKeywordReply({ id: ruleId.value })\r\n    const data = res?.data || {}\r\n    form.name = data?.name || ''\r\n    fullKeywords.value = Array.isArray(data?.full_keyword) ? data.full_keyword : []\r\n    halfKeywords.value = Array.isArray(data?.half_keyword) ? data.half_keyword : []\r\n    const list = Array.isArray(data?.reply_content) ? data.reply_content : []\r\n    replyList.value = list.map((rc) => ({\r\n      type: (rc?.type || rc?.reply_type || 'text'),\r\n      description: rc?.description || '',\r\n      thumb_url: rc?.thumb_url || rc?.pic || '',\r\n      title: rc?.title || '',\r\n      url: rc?.url || '',\r\n      appid: rc?.appid || '',\r\n      page_path: rc?.page_path || '',\r\n      smart_menu_id: rc?.smart_menu_id || '',\r\n      smart_menu: rc?.smart_menu || {},\r\n    }))\r\n    form.reply_num = data.reply_num\r\n  } catch (e) {\r\n    message.error(t('msg_load_failed'))\r\n  }\r\n})\r\n\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.subManage-edit {\r\n  padding: 16px 24px;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-bottom: 1px solid #fff;\r\n  border-right: 1px solid #fff;\r\n  background-color: #fff;\r\n  overflow-x: hidden;\r\n  overflow-y: auto;\r\n\r\n  .subManage-breadcrumb {\r\n    display: flex;\r\n    align-items: center;\r\n    color: #000000;\r\n    font-family: \"PingFang SC\";\r\n    font-size: 14px;\r\n    font-style: normal;\r\n    line-height: 22px;\r\n    padding-bottom: 16px;\r\n  }\r\n\r\n  .main {\r\n    padding: 0 8px;\r\n    border-radius: 6px;\r\n    background-color: white;\r\n    padding-bottom: 80px;\r\n\r\n    .title {\r\n      border-radius: 6px;\r\n      padding: 12px 0 12px 24px;\r\n      align-items: flex-start;\r\n      border-bottom: 1px solid var(--07, #F0F0F0);\r\n      background: #FFF;\r\n      display: flex;\r\n      align-items: center;\r\n      color: #262626;\r\n      font-family: \"PingFang SC\";\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 600;\r\n      line-height: 22px;\r\n      gap: 8px;\r\n      margin-bottom: 24px;\r\n    }\r\n  }\r\n}\r\n\r\n.mr-8 {\r\n  margin-right: 8px;\r\n}\r\n\r\n.mr16 {\r\n  margin-right: 16px;\r\n}\r\n\r\n.nav-box {\r\n  color: #262626;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 600;\r\n  line-height: 22px;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.tag-container .ant-tag {\r\n  margin-right: 8px;\r\n}\r\n\r\n.flex {\r\n  display: flex;\r\n}\r\n\r\n.item-title-box {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2px;\r\n  color: #262626;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 22px;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.btn-container {\r\n  position: fixed;\r\n  bottom: 0;\r\n  right: 16px;\r\n  display: flex;\r\n  width: calc(100% - 270px);\r\n  padding: 16px 1055px 16px 32px;\r\n  align-items: center;\r\n  border-radius: 0 0 2px 2px;\r\n  background: #FFF;\r\n  box-shadow: 0 -8px 4px 0 #0000000a;\r\n}\r\n</style>\r\n"],"names":["t","useI18n","query","useRoute","ruleId","ref","router","useRouter","autoReplyUrl","computed","formRef","form","reactive","rules","fullKeywords","halfKeywords","fullKeywordInput","halfKeywordInput","addingFull","addingHalf","fullInputRef","halfInputRef","addingFullBusy","startAddFull","nextTick","comp","_b","_a","confirmAddFull","v","message","res","checkKeyWordRepeat","repeat","ruleName","removeFullKeyword","k","x","addingHalfBusy","startAddHalf","confirmAddHalf","removeHalfKeyword","replyList","replyRefs","addReplyItem","onContentChange","payload","reply_index","rest","onDelItem","index","handleReplyTypeChange","serializeReplyContent","list","it","serializeReplyTypeCodes","map","onSubmit","saveRobotKeywordReply","onMounted","copyId","getRobotKeywordReply","data","rc","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_component_a_breadcrumb","_component_a_breadcrumb_item","_createElementVNode","_unref","_hoisted_2","_hoisted_3","_component_a_form","_component_a_form_item","_component_a_input","_cache","$event","_hoisted_4","_component_svg_icon","_createTextVNode","_hoisted_5","_hoisted_6","_hoisted_7","_toDisplayString","_component_a_tooltip","QuestionCircleOutlined","_hoisted_8","_createBlock","_component_a_button","PlusOutlined","_hoisted_9","_Fragment","_renderList","item","_component_a_tag","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","idx","MultiReply","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_component_a_radio_group","_component_a_radio","_hoisted_22"],"mappings":"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"}