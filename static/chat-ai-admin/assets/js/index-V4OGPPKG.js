import{_ as ge}from"./cu-scroll-CpIj948h.js";import{u as le,c as Ie,bt as Be,bl as Ne,_ as Ue,aw as Se,bD as W,aY as Oe,d as Le,br as Te}from"../../index-DSFcP5NQ.js";import{c as ve,ah as _e,ag as ye,E as te,r as y,e as v,b as r,t as i,p as c,y as t,q as u,z as he,a as k,m as Z,u as a,v as s,_ as m,F as S,h as A,D as pe,i as Me,G as be}from"./vue-chunks-BdaA73Wf.js";import{A as De}from"./avatar-input-BcFDFUIh.js";import{M as ee}from"./model-select-CMPvMrAQ.js";import{O as Ae}from"./open-grapg-modal-wgsaRjH8.js";import{_ as oe}from"./emoji-mart-BBMRoEa3.js";import{F as me,c as je,I as Pe,V as Ve,u as Ee,v as Re,H as Fe,q as Ge,ac as j,J as Ke,G as Je,r as Qe,s as Xe,b as X,M as ne,ad as Ye,B as He,a1 as We,x as Ze,X as ea,U as fe,a9 as aa,D as ta,h as ae,aa as na,ab as la,O as ke,Z as _a,$ as oa}from"./ui-antd-Dl1wwwCD.js";import{i as ia,e as sa,f as ca}from"./index-o_l8g-wS.js";import{A as ra}from"./add-collaborator-Ww1-CyL9.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./neo4j-MWxXN7EM.js";import"./editor-cherry-CFIsbKoN.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";import"./index-MT9fcN3v.js";const da={class:"add-library-page"},ua={class:"form-box"},ha={class:"form-item-tip"};const pa={class:"form-item-tip"},ma={class:"indexing-methods-box"},fa={class:"list-title-block"},ka={class:"list-content"},ga={class:"list-title-block"},va={class:"list-content"},ya={class:"form-alert-tip"},ba={class:"select-card-box"},xa={class:"card-title"},wa={class:"card-desc"},Ca={class:"card-title"},$a={class:"card-desc"},qa={class:"card-title"},za={class:"card-desc"},Ia={class:"card-title"},Ba={class:"card-desc"},Na={class:"main-title-block"},Ua={class:"unit-text"},Sa={class:"main-title-block"},Oa={class:"unit-text"},La={__name:"knowledge-config",setup(ie){const{t:n}=le("views.library.library-details.knowledge-config"),d=Ie(),T=ve(()=>{var _;return((_=d.companyInfo)==null?void 0:_.neo4j_status)=="true"}),q=_e(),b=ye(),z=q.query,$=Be,w=n("default_ai_chunk_prompt"),e=te({library_name:"",library_intro:"",use_model:"",is_offline:"",model_config_id:"",avatar:$,avatar_file:"",graph_switch:!1,graph_model_config_id:void 0,graph_use_model:"",chunk_type:1,normal_chunk_default_separators_no:[12,11],normal_chunk_default_chunk_size:512,normal_chunk_default_chunk_overlap:50,semantic_chunk_default_chunk_size:512,semantic_chunk_default_chunk_overlap:50,semantic_chunk_default_threshold:90,normal_chunk_default_not_merged_text:"false",ai_chunk_size:5e3,ai_chunk_model:"",ai_chunk_model_config_id:"",ai_chunk_prumpt:w,qa_index_type:1,group_id:0,father_chunk_paragraph_type:2,father_chunk_separators_no:[],father_chunk_chunk_size:1024,son_chunk_separators_no:[],son_chunk_chunk_size:512,sync_official_history_type:2,enable_cron_sync_official_content:!0,app_id_list:""}),P=y(0),I=y({}),M=y([]);Ne().then(_=>{M.value=_.data.map(l=>({label:l.name,value:l.no}))});const O=y(!0),g=y(!1);(()=>{Se({id:z.id}).then(_=>{I.value=_.data,P.value=I.value.is_offline?2:1,e.library_name=_.data.library_name,e.qa_index_type=_.data.qa_index_type,e.library_intro=_.data.library_intro,e.use_model=_.data.use_model,e.is_offline=_.data.is_offline,e.group_id=_.data.group_id,e.model_config_id=_.data.model_config_id,e.avatar=_.data.avatar?_.data.avatar:$,e.avatar_file=_.data.avatar_file?_.data.avatar_file:"",e.graph_switch=_.data.graph_switch!="0",e.graph_model_config_id=_.data.graph_model_config_id>0?_.data.graph_model_config_id:void 0,e.graph_use_model=_.data.graph_use_model,e.chunk_type=+_.data.chunk_type,e.normal_chunk_default_separators_no=W(_.data.normal_chunk_default_separators_no,[12,11]),e.normal_chunk_default_chunk_size=_.data.normal_chunk_default_chunk_size,e.normal_chunk_default_not_merged_text=_.data.normal_chunk_default_not_merged_text,e.normal_chunk_default_chunk_overlap=_.data.normal_chunk_default_chunk_overlap,e.semantic_chunk_default_chunk_size=_.data.semantic_chunk_default_chunk_size,e.semantic_chunk_default_chunk_overlap=_.data.semantic_chunk_default_chunk_overlap,e.semantic_chunk_default_threshold=_.data.semantic_chunk_default_threshold,e.ai_chunk_size=_.data.ai_chunk_size||5e3,e.ai_chunk_model=_.data.ai_chunk_model,e.ai_chunk_model_config_id=_.data.ai_chunk_model_config_id,e.ai_chunk_prumpt=_.data.ai_chunk_prumpt||w,e.father_chunk_paragraph_type=+_.data.father_chunk_paragraph_type||2,e.father_chunk_separators_no=W(_.data.father_chunk_separators_no,[12,11]),e.father_chunk_chunk_size=+_.data.father_chunk_chunk_size||1024,e.son_chunk_separators_no=W(_.data.son_chunk_separators_no,[8,10]),e.son_chunk_chunk_size=+_.data.son_chunk_chunk_size||512,e.sync_official_history_type=Number(_.data.sync_official_history_type),e.enable_cron_sync_official_content=_.data.enable_cron_sync_official_content==="true",e.app_id_list=_.data.official_app_id||"",g.value=_.data.type==3,O.value=_.data.type==2})})();const R=y([{iconName:"high-active",title:"高质量",value:1,is_offline:!1,desc:"使用在线的嵌入模型，在召回时具有更高的准确度，但需要花费token"}]),V=me.useForm,F=te({library_name:[{required:!0,message:n("validator_library_name_required"),trigger:"blur"}],use_model:[{required:!0,message:n("validator_embedding_model_required"),trigger:"change"}]}),{validateInfos:E}=V(e,F),Y=_=>{e.avatar=_.imageUrl,e.avatar_file=_.file,f()},G=()=>!1,p=()=>{f()},C=y([]),se=_=>{C.value=_,Me(()=>{(!e.ai_chunk_model||!Number(e.ai_chunk_model_config_id))&&xe()})},xe=()=>{if(C.value.length>0){let _=null,l=null;for(let N of C.value)if(N.model_define==="tongyi"){_=N;for(let h of _.children)if(h.name==="qwen-max"){l=h;break}break}_||(_=C.value[0],l=_.children[0]),_&&l&&(e.ai_chunk_model=l.name,e.ai_chunk_model_config_id=l.model_config_id)}},ce=y(null),we=_=>{if(_){e.graph_switch=!1;let l={graph_model_config_id:e.graph_model_config_id,graph_use_model:e.graph_use_model};if((!e.graph_model_config_id||!e.graph_use_model)&&C.value.length>0){let N=C.value[0];if(N){let h=N.children[0];l.graph_use_model=h.name,l.graph_model_config_id=h.model_config_id}}ce.value.show(l)}else e.graph_switch=!1,f()},K=_=>{e.chunk_type=_,f()},Ce=_=>{_.graph_model_config_id&&(e.graph_switch=!0,e.graph_model_config_id=_.graph_model_config_id,e.graph_use_model=_.graph_use_model,f(()=>{ne.confirm({title:n("modal_graph_enabled_title"),content:n("modal_graph_enabled_content"),cancelText:n("modal_graph_enabled_cancel"),okText:n("modal_graph_enabled_ok"),icon:be(Ye,{style:{color:"#52c41a"}}),onOk:()=>b.push({path:"/library/details/knowledge-document",query:{id:z.id}})})}))},f=(_=null)=>{if(!e.library_name)return X.error(n("validator_library_name"));let l={library_name:e.library_name,qa_index_type:e.qa_index_type,library_intro:e.library_intro,use_model:e.use_model,model_config_id:e.model_config_id,is_offline:e.is_offline,graph_switch:e.graph_switch?1:0,graph_model_config_id:e.graph_model_config_id,graph_use_model:e.graph_use_model,chunk_type:e.chunk_type,normal_chunk_default_separators_no:JSON.stringify(e.normal_chunk_default_separators_no),normal_chunk_default_chunk_size:e.normal_chunk_default_chunk_size,normal_chunk_default_chunk_overlap:e.normal_chunk_default_chunk_overlap,normal_chunk_default_not_merged_text:e.normal_chunk_default_not_merged_text,semantic_chunk_default_chunk_size:e.semantic_chunk_default_chunk_size,semantic_chunk_default_chunk_overlap:e.semantic_chunk_default_chunk_overlap,semantic_chunk_default_threshold:e.semantic_chunk_default_threshold,ai_chunk_size:e.ai_chunk_size,ai_chunk_model:e.ai_chunk_model,ai_chunk_model_config_id:e.ai_chunk_model_config_id,ai_chunk_prumpt:e.ai_chunk_prumpt,father_chunk_paragraph_type:e.father_chunk_paragraph_type,father_chunk_separators_no:JSON.stringify(e.father_chunk_separators_no),father_chunk_chunk_size:e.father_chunk_chunk_size,son_chunk_separators_no:JSON.stringify(e.son_chunk_separators_no),son_chunk_chunk_size:e.son_chunk_chunk_size,group_id:e.group_id,app_id_list:e.app_id_list,sync_official_history_type:e.sync_official_history_type,enable_cron_sync_official_content:Number(e.enable_cron_sync_official_content),id:q.query.id};e.avatar_file&&(l.avatar=e.avatar_file),Oe(l).then(N=>{typeof _=="function"?_():X.success(n("msg_edit_success"))})},re=_=>{_!=e.qa_index_type&&(e.qa_index_type=_,f())};return(_,l)=>{const N=Pe,h=je,de=Ve,J=Re,Q=Ee,D=Ge,H=Fe,x=Ue,U=Je,L=Ke,ue=Xe,$e=Qe,qe=me,ze=ge;return r(),v(ze,null,{default:i(()=>[c("div",da,[c("div",ua,[t(qe,{"label-col":{span:6}},{default:i(()=>[t(h,Z({ref:"name",label:a(n)("label_library_name")},a(E).library_name),{default:i(()=>[t(N,{onBlur:f,value:e.library_name,"onUpdate:value":l[0]||(l[0]=o=>e.library_name=o),placeholder:a(n)("ph_library_name")},null,8,["value","placeholder"])]),_:1},16,["label"]),t(h,{label:a(n)("label_library_intro")},{default:i(()=>[t(de,{onBlur:f,value:e.library_intro,"onUpdate:value":l[1]||(l[1]=o=>e.library_intro=o),placeholder:a(n)("ph_library_intro")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(h,Z({ref:"name",label:a(n)("label_library_avatar")},a(E).avatar),{default:i(()=>[t(De,{value:e.avatar,"onUpdate:value":l[2]||(l[2]=o=>e.avatar=o),onChange:Y},null,8,["value"]),c("div",ha,s(a(n)("tip_library_avatar")),1)]),_:1},16,["label"]),g.value?(r(),v(h,{key:0,label:a(n)("label_history_time")},{default:i(()=>[t(Q,{value:e.sync_official_history_type,"onUpdate:value":l[3]||(l[3]=o=>e.sync_official_history_type=o),onChange:f},{default:i(()=>[t(J,{value:10},{default:i(()=>[m(s(a(n)("option_all")),1)]),_:1}),t(J,{value:1},{default:i(()=>[m(s(a(n)("option_half_year")),1)]),_:1}),t(J,{value:2},{default:i(()=>[m(s(a(n)("option_one_year")),1)]),_:1}),t(J,{value:3},{default:i(()=>[m(s(a(n)("option_three_years")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"])):u("",!0),g.value?(r(),v(h,{key:1},{label:i(()=>[t(D,{title:a(n)("tooltip_daily_sync")},{default:i(()=>[m(s(a(n)("label_daily_sync"))+" ",1),t(a(j),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1},8,["title"])]),default:i(()=>[t(H,{checked:e.enable_cron_sync_official_content,"onUpdate:checked":l[4]||(l[4]=o=>e.enable_cron_sync_official_content=o),onChange:f,"checked-children":a(n)("switch_on"),"un-checked-children":a(n)("switch_off")},null,8,["checked","checked-children","un-checked-children"])]),_:1})):u("",!0),t(h,Z({label:a(n)("label_embedding_model")},a(E).use_model),{default:i(()=>[u("",!0),t(ee,{modelType:"TEXT EMBEDDING",modeName:e.use_model,"onUpdate:modeName":l[5]||(l[5]=o=>e.use_model=o),modeId:e.model_config_id,"onUpdate:modeId":l[6]||(l[6]=o=>e.model_config_id=o),style:{width:"472px"},onChange:p},null,8,["modeName","modeId"])]),_:1},16,["label"]),he(t(h,{label:a(n)("label_generate_graph")},{default:i(()=>[t(H,{onChange:we,checked:e.graph_switch,"checked-children":a(n)("switch_on"),"un-checked-children":a(n)("switch_off")},null,8,["checked","checked-children","un-checked-children"]),c("div",pa,s(a(n)("tip_generate_graph")),1)]),_:1},8,["label"]),[[pe,T.value]]),he(t(h,{label:a(n)("label_graph_model")},{default:i(()=>[t(ee,{modelType:"LLM",modeName:e.graph_use_model,"onUpdate:modeName":l[7]||(l[7]=o=>e.graph_use_model=o),modeId:e.graph_model_config_id,"onUpdate:modeId":l[8]||(l[8]=o=>e.graph_model_config_id=o),style:{width:"472px"},onChange:p,onLoaded:se},null,8,["modeName","modeId"])]),_:1},8,["label"]),[[pe,e.graph_switch&&T.value]]),O.value?(r(),v(h,{key:2,label:a(n)("label_indexing_method")},{default:i(()=>[c("div",ma,[c("div",{class:A(["list-item",{active:e.qa_index_type==1}]),onClick:l[9]||(l[9]=o=>re(1))},[t(x,{class:"check-icon",name:"check-arrow-filled"}),c("div",fa,[t(x,{name:"file-search"}),m(" "+s(a(n)("indexing_qa_answer_title")),1)]),c("div",ka,s(a(n)("indexing_qa_answer_desc")),1)],2),c("div",{class:A(["list-item",{active:e.qa_index_type==2}]),onClick:l[10]||(l[10]=o=>re(2))},[t(x,{class:"check-icon",name:"check-arrow-filled"}),c("div",ga,[t(x,{name:"comment-search"}),m(" "+s(a(n)("indexing_qa_question_title")),1)]),c("div",va,s(a(n)("indexing_qa_question_desc")),1)],2)])]),_:1},8,["label"])):u("",!0),O.value?u("",!0):(r(),k(S,{key:3},[t(h,{label:a(n)("label_segmentation_type"),required:""},{default:i(()=>[c("div",ya,s(a(n)("tip_segmentation_type")),1),c("div",ba,[c("div",{class:A(["select-card-item",{active:e.chunk_type==1}]),onClick:l[11]||(l[11]=o=>K(1))},[t(x,{class:"check-arrow",name:"check-arrow-filled"}),c("div",xa,[t(x,{name:"ordinary-segmentation",class:"title-icon"}),m(" "+s(a(n)("segmentation_ordinary_title")),1)]),c("div",wa,s(a(n)("segmentation_ordinary_desc")),1)],2),c("div",{class:A(["select-card-item",{active:e.chunk_type==2}]),onClick:l[12]||(l[12]=o=>K(2))},[t(x,{class:"check-arrow",name:"check-arrow-filled"}),c("div",Ca,[t(x,{name:"semantic-segmentation",class:"title-icon"}),m(" "+s(a(n)("segmentation_semantic_title")),1)]),c("div",$a,s(a(n)("segmentation_semantic_desc")),1)],2),O.value?u("",!0):(r(),k("div",{key:0,class:A(["select-card-item",{active:e.chunk_type==4}]),onClick:l[13]||(l[13]=o=>K(4))},[t(x,{class:"check-arrow",name:"check-arrow-filled"}),c("div",qa,[t(x,{name:"semantic-segmentation",class:"title-icon"}),m(" "+s(a(n)("segmentation_parent_child_title")),1)]),c("div",za,s(a(n)("segmentation_parent_child_desc")),1)],2)),c("div",{class:A(["select-card-item",{active:e.chunk_type==3}]),onClick:l[14]||(l[14]=o=>K(3))},[t(x,{class:"check-arrow",name:"check-arrow-filled"}),c("div",Ia,[t(x,{name:"semantic-segmentation",class:"title-icon"}),m(" "+s(a(n)("segmentation_ai_title")),1)]),c("div",Ba,s(a(n)("segmentation_ai_desc")),1)],2)])]),_:1},8,["label"]),e.chunk_type==1?(r(),k(S,{key:0},[t(h,{label:a(n)("label_segmentation_separators"),required:""},{default:i(()=>[t(Q,{onChange:f,value:e.normal_chunk_default_separators_no,"onUpdate:value":l[15]||(l[15]=o=>e.normal_chunk_default_separators_no=o),mode:"tags",style:{width:"100%"},placeholder:a(n)("ph_segmentation_separators"),options:M.value},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(h,{label:a(n)("label_segmentation_max_length"),required:""},{default:i(()=>[t(L,{gap:8,align:"center"},{default:i(()=>[t(U,{onBlur:f,value:e.normal_chunk_default_chunk_size,"onUpdate:value":l[16]||(l[16]=o=>e.normal_chunk_default_chunk_size=o),style:{width:"220px"},precision:0,min:1,max:1e4},null,8,["value"]),m(" "+s(a(n)("unit_characters")),1)]),_:1})]),_:1},8,["label"]),t(h,{label:a(n)("label_segmentation_overlap")},{default:i(()=>[t(L,{gap:8,align:"center"},{default:i(()=>[t(U,{onBlur:f,value:e.normal_chunk_default_chunk_overlap,"onUpdate:value":l[17]||(l[17]=o=>e.normal_chunk_default_chunk_overlap=o),style:{width:"220px"},precision:0,min:1,max:5e3},null,8,["value"]),m(" "+s(a(n)("unit_characters")),1)]),_:1})]),_:1},8,["label"]),t(h,null,{label:i(()=>[m(s(a(n)("label_auto_merge"))+" ",1),t(D,{title:a(n)("tooltip_auto_merge")},{default:i(()=>[t(a(j))]),_:1},8,["title"])]),default:i(()=>[t(H,{onChange:f,checkedValue:"false",unCheckedValue:"true",checked:e.normal_chunk_default_not_merged_text,"onUpdate:checked":l[18]||(l[18]=o=>e.normal_chunk_default_not_merged_text=o),"checked-children":a(n)("switch_on"),"un-checked-children":a(n)("switch_off")},null,8,["checked","checked-children","un-checked-children"])]),_:1})],64)):u("",!0),e.chunk_type==2?(r(),k(S,{key:1},[e.chunk_type==2?(r(),v(h,{key:0,required:""},{label:i(()=>[m(s(a(n)("label_segmentation_threshold"))+" ",1),t(D,null,{title:i(()=>[m(s(a(n)("tooltip_segmentation_threshold")),1)]),default:i(()=>[t(a(j),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:i(()=>[t(U,{onBlur:f,value:e.semantic_chunk_default_threshold,"onUpdate:value":l[19]||(l[19]=o=>e.semantic_chunk_default_threshold=o),style:{width:"100%"},placeholder:a(n)("ph_segmentation_threshold"),precision:0,min:0,max:100},null,8,["value","placeholder"])]),_:1})):u("",!0),t(h,{label:a(n)("label_segmentation_max_length"),required:""},{default:i(()=>[t(L,{gap:8,align:"center"},{default:i(()=>[t(U,{onBlur:f,value:e.semantic_chunk_default_chunk_size,"onUpdate:value":l[20]||(l[20]=o=>e.semantic_chunk_default_chunk_size=o),style:{width:"220px"},precision:0,min:1,max:1e5},null,8,["value"]),m(" "+s(a(n)("unit_characters")),1)]),_:1})]),_:1},8,["label"]),t(h,{label:a(n)("label_segmentation_overlap")},{default:i(()=>[t(L,{gap:8,align:"center"},{default:i(()=>[t(U,{onBlur:f,value:e.semantic_chunk_default_chunk_overlap,"onUpdate:value":l[21]||(l[21]=o=>e.semantic_chunk_default_chunk_overlap=o),style:{width:"220px"},precision:0,min:1,max:1e5},null,8,["value"]),m(" "+s(a(n)("unit_characters")),1)]),_:1})]),_:1},8,["label"])],64)):u("",!0),e.chunk_type==3?(r(),k(S,{key:2},[e.chunk_type==3?(r(),v(h,{key:0,required:""},{label:i(()=>[m(s(a(n)("label_ai_model")),1)]),default:i(()=>[t(ee,{modelType:"LLM",placeholder:a(n)("ph_ai_model"),modeName:e.ai_chunk_model,"onUpdate:modeName":l[22]||(l[22]=o=>e.ai_chunk_model=o),modeId:e.ai_chunk_model_config_id,"onUpdate:modeId":l[23]||(l[23]=o=>e.ai_chunk_model_config_id=o),style:{width:"300px"},onChange:p,onLoaded:se},null,8,["placeholder","modeName","modeId"])]),_:1})):u("",!0),t(h,{label:a(n)("label_prompt_setting"),required:""},{default:i(()=>[t(L,{gap:8,align:"center"},{default:i(()=>[t(de,{onBlur:f,maxLength:500,style:{height:"80px"},value:e.ai_chunk_prumpt,"onUpdate:value":l[24]||(l[24]=o=>e.ai_chunk_prumpt=o),placeholder:a(w)},null,8,["value","placeholder"])]),_:1})]),_:1},8,["label"]),t(h,null,{label:i(()=>[m(s(a(n)("label_max_characters"))+" ",1),t(D,null,{title:i(()=>[m(s(a(n)("tooltip_max_characters")),1)]),default:i(()=>[t(a(j),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:i(()=>[t(U,{onBlur:f,class:"form-item-inptu-numbner",value:e.ai_chunk_size,"onUpdate:value":l[25]||(l[25]=o=>e.ai_chunk_size=o),placeholder:a(n)("ph_max_characters"),precision:0,min:0,formatter:o=>parseInt(o),parser:o=>parseInt(o)},null,8,["value","placeholder","formatter","parser"]),m(" "+s(a(n)("unit_characters")),1)]),_:1})],64)):u("",!0),e.chunk_type==4&&!O.value?(r(),k(S,{key:3},[c("div",Na,s(a(n)("title_father_chunk")),1),t(h,{label:a(n)("label_chunk_type")},{default:i(()=>[t($e,{onChange:f,value:e.father_chunk_paragraph_type,"onUpdate:value":l[26]||(l[26]=o=>e.father_chunk_paragraph_type=o)},{default:i(()=>[t(ue,{value:1},{default:i(()=>[m(s(a(n)("radio_full_text"))+" ",1),t(D,{title:a(n)("tooltip_full_text")},{default:i(()=>[t(a(j))]),_:1},8,["title"])]),_:1}),t(ue,{value:2},{default:i(()=>[m(s(a(n)("radio_paragraph"))+" ",1),t(D,{title:a(n)("tooltip_paragraph")},{default:i(()=>[t(a(j))]),_:1},8,["title"])]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),e.father_chunk_paragraph_type==2?(r(),v(h,{key:0,label:a(n)("label_segmentation_separators")},{default:i(()=>[t(Q,{placeholder:a(n)("ph_select"),onChange:f,style:{width:"100%"},mode:"tags",options:M.value,value:e.father_chunk_separators_no,"onUpdate:value":l[27]||(l[27]=o=>e.father_chunk_separators_no=o)},null,8,["placeholder","options","value"])]),_:1},8,["label"])):u("",!0),e.father_chunk_paragraph_type==2?(r(),v(h,{key:1,label:a(n)("label_segmentation_max_length")},{default:i(()=>[t(L,{align:"center",gap:8},{default:i(()=>[t(U,{style:{flex:"1"},onBlur:f,value:e.father_chunk_chunk_size,"onUpdate:value":l[28]||(l[28]=o=>e.father_chunk_chunk_size=o),placeholder:a(n)("ph_chunk_max_length"),min:200,max:1e4,precision:0,formatter:o=>parseInt(o),parser:o=>parseInt(o)},null,8,["value","placeholder","formatter","parser"]),c("span",Ua,s(a(n)("unit_characters")),1)]),_:1})]),_:1},8,["label"])):u("",!0),c("div",Sa,s(a(n)("title_son_chunk")),1),t(h,{label:a(n)("label_segmentation_separators")},{default:i(()=>[t(Q,{placeholder:a(n)("ph_select"),onChange:f,style:{width:"100%"},mode:"tags",options:M.value,value:e.son_chunk_separators_no,"onUpdate:value":l[29]||(l[29]=o=>e.son_chunk_separators_no=o)},null,8,["placeholder","options","value"])]),_:1},8,["label"]),t(h,{label:a(n)("label_segmentation_max_length")},{default:i(()=>[t(L,{align:"center",gap:8},{default:i(()=>[t(U,{style:{flex:"1"},onBlur:f,value:e.son_chunk_chunk_size,"onUpdate:value":l[30]||(l[30]=o=>e.son_chunk_chunk_size=o),placeholder:a(n)("ph_chunk_max_length"),min:200,max:1e4,precision:0,formatter:o=>parseInt(o),parser:o=>parseInt(o)},null,8,["value","placeholder","formatter","parser"]),c("span",Oa,s(a(n)("unit_characters")),1)]),_:1})]),_:1},8,["label"])],64)):u("",!0)],64))]),_:1})]),t(Ae,{onOk:Ce,ref_key:"openGrapgModalRef",ref:ce},null,512)])]),_:1})}}},Ta=oe(La,[["__scopeId","data-v-c3952826"]]),Ma={class:"content-box"},Da={key:0,class:"add-btn-block"},Aa={class:"list-content"},ja={key:0,class:"user-block"},Pa={class:"name-box"},Va={class:"name"},Ea={class:"remark-text"},Ra={key:0,class:"hover-btn-box"},Fa={key:0},Ga={key:1},Ka={key:2},Ja={key:1,class:"hover-btn-box"},Qa={class:"role-menu-box"},Xa=["onClick"],Ya={class:"menu-header"},Ha={class:"title"},Wa={class:"desc"},Za={key:0,class:"check-box"},et=["onClick"],at={class:"menu-header"},tt={class:"title"},nt={class:"desc"},lt={key:0,class:"check-box"},_t=["onClick"],ot={class:"menu-header"},it={class:"title"},st={class:"desc"},ct={key:0,class:"check-box"},rt={class:"hover-btn-box"},dt={key:0},ut={key:1},ht={key:2},pt=["onClick"],mt={__name:"role-permission",setup(ie){const n=_e().query,{t:d}=le("views.library.library-details.knowledge-config.role-permission"),T=Le(),q=ve(()=>T.user_name),b=y(Te(n.id)),z=y([]),$=te({object_id:n.id,object_type:2}),w=()=>{ia({...$}).then(g=>{let B=g.data||[];z.value=B})};w();const e=y(null),P=()=>{e.value.show(z.value,[{object_id:+n.id,object_type:2,operate_rights:4}])},I=(g,B)=>{let R=B==4?d("manage"):B==2?d("edit"):d("view");ne.confirm({title:d("confirmTitle"),icon:t(ke),content:d("confirmModifyPermission",{permission:R}),okText:d("confirm"),cancelText:d("cancel"),onOk:()=>{let V=[{object_id:+g.object_id,object_type:+g.object_type,operate_rights:+B}];sa({identity_ids:g.identity_id,identity_type:g.identity_type,object_array:JSON.stringify(V)}).then(F=>{X.success(d("modifySuccess")),w()})},onCancel(){}})},M=g=>{ne.confirm({title:d("confirmTitle"),icon:t(ke),content:d("confirmDelete"),okText:d("confirm"),okType:"danger",cancelText:d("cancel"),onOk:()=>{ca({identity_id:g.identity_id,identity_type:g.identity_type,object_id:g.object_id,object_type:g.object_type}).then(B=>{X.success(d("deleteSuccess")),w()})},onCancel(){}})},O=y([{title:d("name"),dataIndex:"name",key:"name"},{title:d("permission"),dataIndex:"operate_rights",key:"operate_rights"},{title:d("operation"),dataIndex:"action",key:"action",width:80}]);return(g,B)=>{const R=He,V=ea,F=aa,E=Ze,Y=ge;return r(),v(Y,null,{default:i(()=>[c("div",Ma,[b.value==4?(r(),k("div",Da,[t(R,{type:"primary",onClick:P,icon:be(a(We))},{default:i(()=>[m(s(a(d)("addCollaborator")),1)]),_:1},8,["icon"])])):u("",!0),c("div",Aa,[t(E,{columns:O.value,"data-source":z.value,pagination:!1},{bodyCell:i(({column:G,record:p})=>[G.key==="name"?(r(),k("div",ja,[t(V,{shape:"square",src:p.avatar,size:40},{icon:i(()=>[p.avatar?u("",!0):(r(),v(a(fe),{key:0}))]),_:2},1032,["src"]),c("div",Pa,[c("div",Va,s(p.user_name),1),c("div",Ea,s(p.name),1)])])):u("",!0),G.key==="operate_rights"?(r(),k(S,{key:1},[b.value==2||p.user_name==q.value?(r(),k("div",Ra,[p.operate_rights==4?(r(),k("span",Fa,s(a(d)("manage")),1)):u("",!0),p.operate_rights==2?(r(),k("span",Ga,s(a(d)("edit")),1)):u("",!0),p.operate_rights==1?(r(),k("span",Ka,s(a(d)("view")),1)):u("",!0)])):p.role_type==1||p.is_creator==1?(r(),k("div",Ja,s(a(d)("manage")),1)):(r(),v(F,{key:2,placement:"bottomRight",title:null,overlayInnerStyle:{padding:"2px"}},{content:i(()=>[c("div",Qa,[c("div",{class:"role-menu",onClick:C=>I(p,4)},[c("div",Ya,[t(a(fe)),c("span",Ha,s(a(d)("manage")),1)]),c("div",Wa,s(a(d)("manageDesc")),1),p.operate_rights==4?(r(),k("div",Za,[t(a(ae))])):u("",!0)],8,Xa),c("div",{class:"role-menu",onClick:C=>I(p,2)},[c("div",at,[t(a(na)),c("span",tt,s(a(d)("edit")),1)]),c("div",nt,s(a(d)("editDesc")),1),p.operate_rights==2?(r(),k("div",lt,[t(a(ae))])):u("",!0)],8,et),c("div",{class:"role-menu",onClick:C=>I(p,1)},[c("div",ot,[t(a(la)),c("span",it,s(a(d)("view")),1)]),c("div",st,s(a(d)("viewDesc")),1),p.operate_rights==1?(r(),k("div",ct,[t(a(ae))])):u("",!0)],8,_t)])]),default:i(()=>[c("div",rt,[p.operate_rights==4?(r(),k("span",dt,s(a(d)("manage")),1)):u("",!0),p.operate_rights==2?(r(),k("span",ut,s(a(d)("edit")),1)):u("",!0),p.operate_rights==1?(r(),k("span",ht,s(a(d)("view")),1)):u("",!0),t(a(ta))])]),_:2},1024))],64)):u("",!0),G.key==="action"?(r(),k(S,{key:2},[b.value==4&&p.user_name!=q.value?(r(),k(S,{key:0},[p.role_type!=1&&p.is_creator!=1?(r(),k("a",{key:0,onClick:C=>M(p)},s(a(d)("remove")),9,pt)):u("",!0)],64)):u("",!0)],64)):u("",!0)]),_:1},8,["columns","data-source"])])]),t(ra,{onOk:w,ref_key:"addCollaboratorRef",ref:e},null,512)]),_:1})}}},ft=oe(mt,[["__scopeId","data-v-1b20c4b3"]]),kt={class:"page-container-box"},gt={class:"content-box"},vt={__name:"index",setup(ie){const{t:n}=le("views.library.library-details.knowledge-config.index"),d=_e(),T=ye(),q=d.query,b=y(+q.activeKey||1),z=()=>{let $={...q};b.value>1?$.activeKey=b.value:delete $.activeKey,T.push({query:{...$}})};return($,w)=>{const e=oa,P=_a;return r(),k("div",kt,[t(P,{activeKey:b.value,"onUpdate:activeKey":w[0]||(w[0]=I=>b.value=I),onChange:z},{default:i(()=>[(r(),v(e,{key:1,tab:a(n)("knowledgeConfig")},null,8,["tab"])),u("",!0)]),_:1},8,["activeKey"]),c("div",gt,[b.value==1?(r(),v(Ta,{key:0})):u("",!0),b.value==2?(r(),v(ft,{key:1})):u("",!0)])])}}},Vt=oe(vt,[["__scopeId","data-v-2c8d6305"]]);export{Vt as default};
//# sourceMappingURL=index-V4OGPPKG.js.map
