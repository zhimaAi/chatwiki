import{b as j,L as U,k as f,M as B}from"../../index-DJqZYlN8.js";import{F as M}from"./index-BearFCS_.js";import{e as s,w as N,M as n,N as w,a7 as S,k as h,S as I,W as d,Q as k,u as x,a1 as V,a2 as A}from"./vue-chunks-Dpmhapcm.js";import{P as J}from"./PlusOutlined-CTNlEK-E.js";import{_ as G}from"./index-O15OSOpm.js";const R=t=>(V("data-v-82e98fe9"),t=t(),A(),t),z={class:"avatar-uploader"},D=["src"],E=R(()=>d("div",{class:"ant-upload-text"},"上传照片",-1)),Q=["src"],T={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(t,{emit:y}){function v(e){return new Promise((o,l)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>o(a.result),a.onerror=p=>l(p)})}const m=y,P=t,r=s([]),g=s(!1),i=s("");N(()=>P.value,e=>{i.value=e},{immediate:!0});const b=M.useInjectFormItemContext(),C=()=>{let e={imageUrl:i.value,file:r.value[0].originFileObj};m("change",e),m("update:value",e.imageUrl),b.onFieldChange()},F=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size/1024<100?(r.value=[e],v(e).then(a=>{i.value=a,g.value=!1,C()}),!1):(f.error("知识库封面图片大小不能超过100kb"),!1):(f.error("知识库封面只支持JPG、PNG格式的图片"),!1),u=s(!1),_=s(""),c=s(""),L=()=>{u.value=!1,c.value=""},O=async e=>{!e.url&&!e.preview&&(e.preview=await v(e.originFileObj)),_.value=e.url||e.preview,u.value=!0,c.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)};return(e,o)=>{const l=G,a=B;return n(),w("div",z,[t.value?(n(),w("img",{key:0,class:"avatar",src:t.value,alt:"avatar"},null,8,D)):S("",!0),h(l,{class:"upload-upload","file-list":r.value,"onUpdate:fileList":o[0]||(o[0]=p=>r.value=p),"list-type":"picture-card","show-upload-list":!1,"before-upload":F,accept:".jpg,.png,.jpeg",onPreview:O},{default:I(()=>[d("div",null,[g.value?(n(),k(x(U),{key:0})):(n(),k(x(J),{key:1})),E])]),_:1},8,["file-list"]),h(a,{open:u.value,title:c.value,footer:null,onCancel:L},{default:I(()=>[d("img",{alt:"example",style:{width:"100%"},src:_.value},null,8,Q)]),_:1},8,["open","title"])])}}},Y=j(T,[["__scopeId","data-v-82e98fe9"]]);export{Y as A};
