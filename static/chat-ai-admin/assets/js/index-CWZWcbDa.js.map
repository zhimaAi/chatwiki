{"version":3,"file":"index-CWZWcbDa.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/robot/robot-config/custom-menu/menu-act-editor.vue","../../../../front-end/chat-ai-admin-vue/src/assets/img/iphone-bg.png","../../../../front-end/chat-ai-admin-vue/src/views/robot/robot-config/custom-menu/custom-menu.vue","../../../../front-end/chat-ai-admin-vue/src/views/robot/robot-config/custom-menu/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"menu-act-editor\">\r\n    <div class=\"radio-row\">\r\n      <a-radio-group v-model:value=\"state.choose_act_item\" @change=\"emitChange\">\r\n        <a-radio :value=\"1\">å‘é€æ¶ˆæ¯</a-radio>\r\n        <a-radio :value=\"2\">è·³è½¬ç½‘é¡µ</a-radio>\r\n        <a-radio :value=\"3\">è·³è½¬å°ç¨‹åº</a-radio>\r\n        <a-radio :value=\"5\">æ¨é€äº‹ä»¶</a-radio>\r\n      </a-radio-group>\r\n    </div>\r\n\r\n    <div v-if=\"state.choose_act_item === 1\" class=\"block\">\r\n      <div class=\"label\">å›å¤å†…å®¹</div>\r\n      <div class=\"reply-list\">\r\n        <MultiReply v-for=\"(it, idx) in replyList\" :key=\"idx\" ref=\"replyRefs\" v-model:value=\"replyList[idx]\" :reply_index=\"idx\"\r\n          @change=\"onContentChange\" @del=\"onDelItem\" />\r\n        <a-button type=\"dashed\" style=\"width: 100%\" :disabled=\"replyList.length >= 5\" @click=\"addReply\">\r\n          <PlusOutlined /> æ·»åŠ å›å¤å†…å®¹({{ replyList.length }}/5)\r\n        </a-button>\r\n      </div>\r\n      <div class=\"label\">å›å¤æ–¹å¼</div>\r\n      <a-radio-group v-model:value=\"reply_num\" @change=\"emitChange\"><a-radio :value=\"0\">å…¨éƒ¨å›å¤</a-radio><a-radio\r\n          :value=\"1\">éšæœºå›å¤ä¸€æ¡</a-radio></a-radio-group>\r\n    </div>\r\n\r\n    <div v-else-if=\"state.choose_act_item === 2\" class=\"block block-box\">\r\n      <div class=\"label\"><span class=\"required\">*</span>è·³è½¬é“¾æ¥</div>\r\n      <a-form class=\"link-form\" :model=\"linkModel\" :rules=\"rules.link\" ref=\"linkForm\" layout=\"horizontal\">\r\n        <a-form-item name=\"linkUrl\">\r\n          <a-input v-model:value=\"linkModel.linkUrl\" placeholder=\"è¯·è¾“å…¥é“¾æ¥\" @blur=\"emitChange\" />\r\n        </a-form-item>\r\n      </a-form>\r\n      <div class=\"tip\">è®¢é˜…è€…ç‚¹å‡»è¯¥èœå•ä¼šè·³åˆ°ä»¥ä¸‹é“¾æ¥ã€‚å¿…é¡»ä»¥http://æˆ–https://å¼€å¤´</div>\r\n    </div>\r\n\r\n    <div v-else-if=\"state.choose_act_item === 3\" class=\"block block-box\">\r\n      <div class=\"form-grid\">\r\n        <a-form :model=\"miniCard\" :rules=\"rules.card\" ref=\"cardForm\" layout=\"horizontal\" :labelCol=\"cardLabelCol\"\r\n          :wrapperCol=\"cardWrapperCol\">\r\n          <a-alert type=\"info\" style=\"margin-bottom: 16px;\"\r\n            message=\"å°ç¨‹åºå¡ç‰‡ä»…æ”¯æŒåœ¨å…¬ä¼—å·ï¼Œå¾®ä¿¡å®¢æœå’Œå¾®ä¿¡å°ç¨‹åºä¸­å‘é€ï¼Œå…¶ä»–æ¸ é“ä¼šå‘é€å¤±è´¥ï¼›å…¬ä¼—å·å†…å›å¤å¿…é¡»æ˜¯å…³è”å°ç¨‹åºï¼Œå¾®ä¿¡å°ç¨‹åºå†…å›å¤å¿…é¡»æ˜¯å½“å‰çš„å°ç¨‹åº\" />\r\n          <a-form-item label=\"å°ç¨‹åºappID\" name=\"appid\">\r\n            <a-input v-model:value=\"miniCard.appid\" placeholder=\"è¯·è¾“å…¥å°ç¨‹åºappID\" />\r\n            <div style=\"margin-top: 2px; color: #FB363F;\">å°ç¨‹åºå³ä¸Šè§’ä¸‰ä¸ªç‚¹>åå­—>æ›´å¤šèµ„æ–™>Appid;å…¬ä¼—å·å†…å›å¤æ—¶å¿…é¡»è·Ÿå°ç¨‹åºæ˜¯å…³è”å…³ç³»</div>\r\n          </a-form-item>\r\n          <a-form-item label=\"å°ç¨‹åºè·¯å¾„\" name=\"page_path\">\r\n            <a-input v-model:value=\"miniCard.page_path\" placeholder=\"è¯·è¾“å…¥å°ç¨‹åºè·¯å¾„\" />\r\n            <div style=\"margin-top: 2px; color: #8C8C8C;\">è¯·è”ç³»å°ç¨‹åºå¼€å‘è€…è·å–è·¯å¾„,æ¯”å¦‚/pages/index/index,æ³¨æ„ï¼Œè·¯å¾„å»ºè®®ä»¥/å¼€å¤´</div>\r\n          </a-form-item>\r\n          <a-form-item label=\"å¤‡ç”¨ç½‘é¡µ\" name=\"standbyUrl\">\r\n            <a-input v-model:value=\"miniCard.standbyUrl\" placeholder=\"è¯·è¾“å…¥å¤‡ç”¨ç½‘é¡µ\" />\r\n            <div style=\"margin-top: 2px; color: #8C8C8C;\">å½“ä¸å¡«æ—¶å°†ä½¿ç”¨é»˜è®¤çš„ç½‘é¡µï¼Œæ—§ç‰ˆå¾®ä¿¡å®¢æˆ·ç«¯æ— æ³•æ”¯æŒå°ç¨‹åºï¼Œç”¨æˆ·ç‚¹å‡»èœå•æ—¶å°†ä¼šæ‰“å¼€å¤‡ç”¨ç½‘é¡µ</div>\r\n          </a-form-item>\r\n        </a-form>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-else-if=\"state.choose_act_item === 5\" class=\"block block-box\">\r\n      <div class=\"label\"><span class=\"required\">*</span>è®¾ç½®keyå€¼</div>\r\n      <a-input v-model:value=\"eventKey\" placeholder=\"è¯·è¾“å…¥keyå€¼\" @blur=\"emitChange\" />\r\n      <div class=\"tip\">è®¾å®škeyå€¼ï¼Œå¯ä»¥ç”¨äºè·Ÿå…¶ä»–ç³»ç»Ÿåšäº¤äº’ã€‚ä¾¿äºåŒæ—¶ä½¿ç”¨ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¼€å‘è·Ÿå°å®¢æœåå°çš„èœå•åŠŸèƒ½ã€‚å¦‚éœ€ä½¿ç”¨å°å®¢æœåå°çš„è‡ªåŠ¨æ‰“æ ‡ç­¾ï¼Œè¯·å‹¿åœ¨å¤šä¸ªèœå•å†…è®¾ç½®ç›¸åŒçš„æ¨é€äº‹ä»¶å€¼ã€‚</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\nimport MultiReply from '@/components/replay-card/multi-reply.vue'\r\nimport { PlusOutlined } from '@ant-design/icons-vue'\r\n\r\nconst replyRefs = ref([])\r\nconst props = defineProps({\r\n  value: {\r\n    type: Object,\r\n    default: () => ({\r\n      choose_act_item: 0,\r\n      act_params: {}\r\n    })\r\n  }\r\n})\r\nconst emit = defineEmits(['update:value', 'change'])\r\n\r\nconst state = reactive({\r\n  choose_act_item: Number(props.value?.choose_act_item || 0)\r\n})\r\nconst replyList = ref(((props.value?.act_params || {}).replyList && (props.value?.act_params || {}).replyList.length) ? (props.value?.act_params || {}).replyList : [{ type: 'text', description: '' }])\r\nconst reply_num = ref(Number((props.value?.act_params || {}).reply_num || 0))\r\nconst linkModel = reactive({\r\n  linkUrl: String((props.value?.act_params || {}).linkUrl || '')\r\n})\r\nconst eventKey = ref(String((props.value?.act_params || {}).key || ''))\r\nconst miniCard = reactive({\r\n  appid: (props.value?.act_params || {}).appid || '',\r\n  page_path: (props.value?.act_params || {}).page_path || '',\r\n  standbyUrl: (props.value?.act_params || {}).standbyUrl || ''\r\n})\r\nconst cardForm = ref(null)\r\nconst linkForm = ref(null)\r\nconst cardLabelCol = { span: 4 }\r\nconst cardWrapperCol = { span: 20 }\r\n\r\nconst rules = {\r\n  card: {\r\n    appid: [\r\n      {\r\n        required: true,\r\n        message: 'è¯·è¾“å…¥å°ç¨‹åºappID'\r\n      }\r\n    ],\r\n    page_path: [\r\n      {\r\n        required: true,\r\n        message: 'è¯·è¾“å…¥å°ç¨‹åºè·¯å¾„'\r\n      }\r\n    ],\r\n    standbyUrl: [\r\n      {\r\n        required: true,\r\n        pattern: /^https?:\\/\\//,\r\n        message: 'å¤‡ç”¨ç½‘é¡µéœ€ä»¥http://æˆ–https://å¼€å¤´'\r\n      }\r\n    ]\r\n  },\r\n  link: {\r\n    linkUrl: [\r\n      {\r\n        required: true,\r\n        message: 'è¯·è¾“å…¥é“¾æ¥'\r\n      },\r\n      {\r\n        pattern: /^https?:\\/\\//,\r\n        message: 'é“¾æ¥éœ€ä»¥http://æˆ–https://å¼€å¤´'\r\n      }\r\n    ]\r\n  }\r\n}\r\n\r\nwatch(() => props.value, (val) => {\r\n  state.choose_act_item = Number(val?.choose_act_item || 0)\r\n  const ap = val?.act_params || {}\r\n  replyList.value = (Array.isArray(ap.replyList) && ap.replyList.length) ? ap.replyList : [{ type: 'text', description: '' }]\r\n  reply_num.value = Number(ap.reply_num || 0)\r\n  linkModel.linkUrl = String(ap.linkUrl || '')\r\n  eventKey.value = String(ap.key || '')\r\n  miniCard.appid = ap.appid || ''\r\n  miniCard.page_path = ap.page_path || ''\r\n  miniCard.standbyUrl = ap.standbyUrl || ''\r\n  replyRefs.value = []\r\n}, { immediate: false })\r\n\r\nwatch(() => miniCard, () => {\r\n  emitChange()\r\n}, { deep: true })\r\n\r\nfunction addReply () {\r\n  if (replyList.value.length >= 5) return;\r\n  replyList.value.push({ type: 'text', description: '' })\r\n}\r\nfunction onContentChange (payload) {\r\n  const { reply_index, ...rest } = payload || {};\r\n  if (reply_index >= 0 && reply_index < replyList.value.length) {\r\n    replyList.value[reply_index] = rest;\r\n    emitChange()\r\n  }\r\n}\r\nfunction onDelItem (index) {\r\n  replyList.value.splice(index, 1);\r\n  emitChange()\r\n}\r\nasync function emitChange () {\r\n  emit('update:value', getValue());\r\n  emit('change', getValue())\r\n}\r\nfunction getValue () {\r\n  const act_params = {};\r\n  if (state.choose_act_item === 1) {\r\n    Object.assign(act_params, {\r\n      replyList: replyList.value,\r\n      reply_num: reply_num.value\r\n    });\r\n  }\r\n  if (state.choose_act_item === 2) {\r\n    Object.assign(act_params, {\r\n      linkUrl: linkModel.linkUrl\r\n    });\r\n  }\r\n  if (state.choose_act_item === 3) {\r\n    Object.assign(act_params, {\r\n      appid: miniCard.appid,\r\n      page_path: miniCard.page_path,\r\n      standbyUrl: miniCard.standbyUrl\r\n    });\r\n  }\r\n  if (state.choose_act_item === 5) {\r\n    Object.assign(act_params, {\r\n      key: eventKey.value\r\n    });\r\n  }\r\n  return {\r\n    choose_act_item: state.choose_act_item,\r\n    act_params\r\n  }\r\n}\r\n\r\n\r\nasync function validate () {\r\n  const item = Number(state.choose_act_item || 0);\r\n  if (item === 1) {\r\n    if (!replyList.value.length) {\r\n      message.error('è¯·æ·»åŠ å›å¤å†…å®¹');\r\n      return false\r\n    }\r\n    for (const comp of replyRefs.value) {\r\n      if (comp && comp.validate) {\r\n        const ok = await comp.validate();\r\n        if (!ok) {\r\n          return false\r\n        }\r\n      }\r\n    }\r\n    return true\r\n  }\r\n  if (item === 2) {\r\n    try {\r\n      await linkForm.value?.validate();\r\n      return true\r\n    } catch (_e) {\r\n      const s = String(linkModel.linkUrl || '').trim();\r\n      if (!s) {\r\n        message.error('è¯·è¾“å…¥é“¾æ¥')\r\n      } else {\r\n        message.error('é“¾æ¥éœ€ä»¥http://æˆ–https://å¼€å¤´')\r\n      }\r\n      return false\r\n    }\r\n  }\r\n  if (item === 3) {\r\n    try {\r\n      await cardForm.value?.validate();\r\n      return true\r\n    } catch (_e) {\r\n      message.error('è¯·å®Œå–„å°ç¨‹åºå¿…å¡«é¡¹');\r\n      return false\r\n    }\r\n  } if (item === 5) {\r\n    const s = String(eventKey.value || '').trim();\r\n    if (!s) {\r\n      message.error('è¯·è¾“å…¥æ¨é€äº‹ä»¶key');\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n  return true\r\n}\r\n\r\ndefineExpose({\r\n  getValue,\r\n  validate\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.radio-row {\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.label {\r\n  color: #262626;\r\n  font-weight: 400;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.required {\r\n  color: #FB363F;\r\n  margin-right: 4px;\r\n}\r\n\r\n.tip {\r\n  color: #8c8c8c;\r\n  font-size: 12px;\r\n  margin-top: 4px;\r\n}\r\n\r\n.reply-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.block-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: self-start;\r\n  width: 694px;\r\n  padding: 16px 24px;\r\n  border-radius: 6px;\r\n  background: #F2F4F7;\r\n\r\n  .link-form {\r\n    width: 100%;\r\n\r\n    .ant-form-item {\r\n      margin-bottom: 0px;\r\n    }\r\n  }\r\n}\r\n\r\n.form-grid {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n}\r\n</style>\r\n","export default \"__VITE_ASSET__B8DKomad__\"","<template>\r\n  <div class=\"user-model-page\">\r\n    <!-- <div class=\"page-title\">å…³æ³¨åè‡ªåŠ¨å›å¤</div> -->\r\n    <div class=\"breadcrumb-wrap\">\r\n      <svg-icon @click=\"goBack\" name=\"back\" style=\"font-size: 20px;\" />\r\n      <div @click=\"goBack\" class=\"breadcrumb-title\">è‡ªå®šä¹‰èœå•</div>\r\n      <a-switch\r\n        :checked=\"abilitySwitchChecked\"\r\n        checked-children=\"å¼€\"\r\n        un-checked-children=\"å…³\"\r\n        @change=\"onAbilitySwitchChange\"\r\n      />\r\n      <span class=\"switch-tip\">å¼€å¯åï¼Œå…¬ä¼—å·æ˜¾ç¤ºè‡ªå®šä¹‰èœå•ï¼›å…³é—­åï¼Œç²‰ä¸å°†æ— æ³•çœ‹åˆ°èœå•ã€‚</span>\r\n    </div>\r\n    <a-alert>\r\n      <template #message>\r\n        <p>1. å›å¤æ¶ˆæ¯å¯ä»¥é€‰æ‹©å›å¤å›¾æ–‡ã€å›¾ç‰‡ã€å°ç¨‹åºå¡ç‰‡ã€æ–‡æœ¬ã€æ™ºèƒ½èœå•ã€å¤šå›¾æ–‡ç­‰ï¼Œå¯ä»¥æ·»åŠ å¤šæ¡å›å¤ï¼Œè¯·å€¼é‡ä½¿ç”¨å…³é—­èœå•åŠŸèƒ½ï¼Œä¸€æ—¦å…³é—­èœå•ï¼Œå°†ä¼šåœç”¨è‡ªå®šä¹‰èœå•åŠŸèƒ½ï¼Œç²‰ä¸å°†æ— æ³•çœ‹åˆ°è‡ªå®šä¹‰èœå•ã€‚</p>\r\n        <p>2. å¤åˆ¶åˆ°å…¶ä»–å…¬ä¼—å·åï¼Œåªä¼šå¤åˆ¶é»˜è®¤èœå•ä¸”ä¸ä¼šè‡ªåŠ¨åŒæ­¥åˆ°å¾®ä¿¡ï¼Œéœ€è¦ä¿å­˜åæ‰ä¼šåŒæ­¥åˆ°å¾®ä¿¡ï¼Œè·³è½¬å°ç¨‹åºæ—¶ï¼Œå°ç¨‹åºå¿…é¡»è·Ÿå…¬ä¼—å·æ˜¯å…³è”å…³ç³»ã€‚</p>\r\n        <p>3. å¦‚æœéœ€è¦ç«‹åˆ»æŸ¥çœ‹æ•ˆæœï¼Œè¯·å–æ¶ˆå…³æ³¨åé‡æ–°å…³æ³¨ã€‚</p>\r\n      </template>\r\n    </a-alert>\r\n    <!-- å…¬ä¼—å·åˆ—è¡¨ -->\r\n    <div class=\"mp-list-block\">\r\n      <div class=\"mp-list\" :class=\"{ expanded }\" ref=\"mpListRef\">\r\n        <div class=\"mp-card\" v-for=\"mp in (expanded ? mpAccounts : mpAccounts.slice(0, visibleCount))\" :key=\"mp.id\"\r\n          :class=\"{ selected: mp.appid === selectedAppid }\" @click=\"selectMp(mp)\">\r\n          <img :src=\"mp.logo\" class=\"mp-logo\" />\r\n          <span class=\"mp-name\">{{ mp.name }}</span>\r\n        </div>\r\n        <a-button v-if=\"!expanded && mpAccounts.length > visibleCount\" type=\"dashed\" class=\"more-btn\"\r\n          @click=\"expanded = true\">\r\n          æ›´å¤š +{{ mpAccounts.length - visibleCount }}\r\n        </a-button>\r\n      </div>\r\n    </div>\r\n    <div class=\"search-block\">\r\n      <Tooltip title=\"åŒæ­¥èœå•ä¼šæ‹‰å–å…¬ä¼—å·å½“å‰æ­£åœ¨ç”Ÿæ•ˆçš„èœå•ã€‚è¯·æ³¨æ„å›å¤å†…å®¹éƒ¨åˆ†éœ€è¦é‡æ–°å¡«å……å†…å®¹ã€‚\">\r\n        <a-button @click=\"syncMenu\" :loading=\"syncLoading\">\r\n          åŒæ­¥èœå•\r\n          <QuestionCircleOutlined style=\"font-size: 16px;\" />\r\n        </a-button>\r\n      </Tooltip>\r\n\r\n      <!-- å¼€å…³æ§åˆ¶ -->\r\n      <div class=\"flex\" style=\"gap: 4px; align-items: center;\">\r\n        <a-switch v-model:checked=\"appMenuSwitch\" :checkedValue=\"'1'\" :un-checkedValue=\"'0'\" checked-children=\"å¼€\" un-checked-children=\"å…³\" @change=\"onAppSwitchChange\" />\r\n        <span style=\"font-size: 14px; color: #8c8c8c;\">å…³é—­åï¼Œè¯¥å…¬ä¼—å·çš„èœå•åŠŸèƒ½å°†è¢«åœç”¨</span>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"main\">\r\n      <div class=\"main-left\">\r\n        <div class=\"iphone-mock\" :style=\"{ backgroundImage: `url(${iphoneBg})` }\">\r\n          <div class=\"bottom-menu\" ref=\"bottomMenuRef\">\r\n            <Draggable :list=\"menus\" item-key=\"id\" class=\"root-menu-draggable\" :animation=\"200\" :ghost-class=\"'ghost'\"\r\n              @start=\"onRootDragStart\" @end=\"onRootDragEnd\">\r\n              <template #item=\"{ element, index }\">\r\n                <div class=\"root-menu-item\" :class=\"{ active: activeRootIndex === index && activeSubIndex === -1 }\"\r\n                  @click=\"onSelectRoot(index)\">\r\n                  <span class=\"name\">{{ element.menu_name || 'ä¸»èœå•' }}</span>\r\n                  <svg-icon class=\"del-root\" name=\"delete-line\" @click.stop=\"removeRootMenu(index)\"\r\n                    style=\"font-size: 18px;\" />\r\n                  <div v-if=\"activeRootIndex === index\" class=\"submenu-panel\" @click.stop>\r\n                    <div class=\"submenu-card\" :style=\"{ width: rootItemWidth + 'px' }\">\r\n                      <Draggable :list=\"element.sub_menu_list\" item-key=\"'k_'+index\" class=\"sub-menu-draggable\"\r\n                        :animation=\"200\" :ghost-class=\"'ghost'\" @start=\"onSubDragStart(index)\" @end=\"onSubDragEnd(index)\">\r\n                        <template #item=\"{ element: sub, index: si }\">\r\n                          <div class=\"sub-menu-item\"\r\n                            :class=\"{ active: activeRootIndex === index && activeSubIndex === si }\"\r\n                            @click.stop=\"onSelectSub(index, si)\">\r\n                            <span class=\"text\">{{ sub.menu_name || 'å­èœå•' }}</span>\r\n                            <svg-icon class=\"del\" name=\"delete-line\" @click.stop=\"removeSubMenu(index, si)\"\r\n                              style=\"font-size: 18px;\" />\r\n                          </div>\r\n                        </template>\r\n                      </Draggable>\r\n                      <div class=\"submenu-add\" v-if=\"(element.sub_menu_list || []).length < 5\"\r\n                        @click=\"addSubMenu(index)\">\r\n                        <PlusOutlined />\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"submenu-arrow\"></div>\r\n                  </div>\r\n                </div>\r\n              </template>\r\n            </Draggable>\r\n            <div v-if=\"menus.length < 3\" class=\"root-menu-add\" @click=\"addRootMenu\">\r\n              <PlusOutlined />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"main-right\">\r\n        <div v-if=\"editing.type === 'root'\" class=\"editor\">\r\n          <div class=\"form-item\">\r\n            <div class=\"label\"><span class=\"required\">*</span>ä¸»èœå•åç§°</div>\r\n            <a-input ref=\"rootNameInputRef\" v-model:value=\"menus[activeRootIndex].menu_name\" placeholder=\"è¯·è¾“å…¥åç§°\" @input=\"onRootNameInput\" maxLength=\"5\" />\r\n            <div class=\"emoji-row\">\r\n              <a-popover v-model:open=\"showEmoji\" placement=\"bottomLeft\" trigger=\"click\" :getPopupContainer=\"getPopup\">\r\n                <template #content>\r\n                  <Picker :data=\"emojiIndex\" :emojiSize=\"18\" :showPreview=\"false\" set=\"apple\" @select=\"onEmojiSelect\" />\r\n                </template>\r\n                <a-tooltip title=\"æ’å…¥è¡¨æƒ…\">ğŸ˜Š</a-tooltip>\r\n              </a-popover>\r\n            </div>\r\n            <div class=\"tip\">æ”¯æŒemojiè¡¨æƒ…ï¼Œä¸»èœå•æœ€å¤šæ”¯æŒ5ä¸ªæ±‰å­—ï¼Œå­èœå•æœ€å¤š18ä¸ªæ±‰å­—</div>\r\n          </div>\r\n          <template v-if=\"(menus[activeRootIndex].sub_menu_list || []).length === 0\">\r\n            <div class=\"form-item\">\r\n              <div class=\"label\">èœå•åŠŸèƒ½</div>\r\n              <MenuActEditor ref=\"actEditorRef\" :key=\"'root-'+activeRootIndex\" v-model:value=\"menus[activeRootIndex].act\" />\r\n            </div>\r\n          </template>\r\n        </div>\r\n\r\n        <div v-else-if=\"editing.type === 'sub'\" class=\"editor\">\r\n          <div class=\"form-item\">\r\n            <div class=\"label\"><span class=\"required\">*</span>å­èœå•åç§°</div>\r\n            <a-input ref=\"subNameInputRef\" v-model:value=\"menus[activeRootIndex].sub_menu_list[activeSubIndex].menu_name\" placeholder=\"è¯·è¾“å…¥åç§°\"\r\n              @input=\"onSubNameInput\" maxLength=\"18\" />\r\n            <div class=\"emoji-row\">\r\n              <a-popover v-model:open=\"showSubEmoji\" placement=\"bottomLeft\" trigger=\"click\" :getPopupContainer=\"getPopup\">\r\n                <template #content>\r\n                  <Picker :data=\"emojiIndex\" :emojiSize=\"18\" :showPreview=\"false\" set=\"apple\" @select=\"onSubEmojiSelect\" />\r\n                </template>\r\n                <a-tooltip title=\"æ’å…¥è¡¨æƒ…\">ğŸ˜Š</a-tooltip>\r\n              </a-popover>\r\n            </div>\r\n            <div class=\"tip\">æ”¯æŒemojiè¡¨æƒ…ï¼Œä¸»èœå•æœ€å¤šæ”¯æŒ5ä¸ªæ±‰å­—ï¼Œå­èœå•æœ€å¤š18ä¸ªæ±‰å­—</div>\r\n          </div>\r\n          <div class=\"form-item\">\r\n            <div class=\"label\">èœå•åŠŸèƒ½</div>\r\n            <MenuActEditor ref=\"actEditorRef\" :key=\"'sub-'+activeRootIndex+'-'+activeSubIndex\" v-model:value=\"menus[activeRootIndex].sub_menu_list[activeSubIndex].act\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"footer-save\">\r\n      <a-button type=\"primary\" @click=\"onSave\" :loading=\"saveLoading\">ä¿å­˜å¹¶åº”ç”¨</a-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, onMounted, onUnmounted, nextTick, watch } from 'vue'\r\nimport { QuestionCircleOutlined, PlusOutlined } from '@ant-design/icons-vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { getCustomMenuList, saveCustomMenu, syncWxMenuToShow } from '@/api/explore/index.js'\r\nimport { getWechatAppList } from '@/api/robot'\r\nimport { message, Tooltip, Modal } from 'ant-design-vue'\r\nimport { getSpecifyAbilityConfig, saveUserAbility, closeWxMenu } from '@/api/explore'\r\nimport emojiDataJson from 'emoji-mart-vue-fast/data/all.json'\r\nimport 'emoji-mart-vue-fast/css/emoji-mart.css'\r\nimport { Picker, EmojiIndex } from 'emoji-mart-vue-fast/src'\r\nimport MenuActEditor from './menu-act-editor.vue'\r\nimport Draggable from 'vuedraggable'\r\nimport iphoneBg from '@/assets/img/iphone-bg.png'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\nconst mpAccounts = ref([])\r\nconst selectedAppid = ref('')\r\nconst expanded = ref(false)\r\nconst mpListRef = ref(null)\r\nconst visibleCount = ref(0)\r\nconst CARD_WIDTH = 160\r\nconst GAP = 8\r\nconst MORE_BTN_WIDTH = 96\r\nconst syncLoading = ref(false)\r\nconst saveLoading = ref(false)\r\n\r\nfunction calcVisibleCount () {\r\n  const el = mpListRef.value\r\n  if (!el) { visibleCount.value = 0; return }\r\n  const w = el.clientWidth || 0\r\n  const per = CARD_WIDTH + GAP\r\n  const count = Math.floor((w - MORE_BTN_WIDTH) / per)\r\n  visibleCount.value = Math.max(count, 0)\r\n  calcRootItemWidth()\r\n}\r\n\r\nconst syncMenu = async () => {\r\n  if (!selectedAppid.value) { message.error('è¯·é€‰æ‹©å…¬ä¼—å·'); return }\r\n  syncLoading.value = true\r\n  syncWxMenuToShow({ appid: selectedAppid.value }).then((res) => {\r\n    const list = Array.isArray(res?.data?.list) ? res.data.list : []\r\n    const roots = list.filter((it) => Number(it.menu_level) === 1)\r\n    const subs = list.filter((it) => Number(it.menu_level) === 2)\r\n    if (roots.length) {\r\n      menus.value = roots\r\n        .sort((a, b) => Number(a.seq_id || 0) - Number(b.seq_id || 0))\r\n        .map((r) => {\r\n          const inlineSubs = Array.isArray(r.sub_menu_list) ? r.sub_menu_list : []\r\n          const byParentSubs = subs.filter((s) => Number(s.parent_menu_id || 0) === Number(r.id || 0))\r\n          const children = (inlineSubs.length ? inlineSubs : byParentSubs).slice().sort((a, b) => Number(a.seq_id || 0) - Number(b.seq_id || 0))\r\n          return {\r\n            id: Number(r.id || 0),\r\n            admin_user_id: Number(r.admin_user_id || 0),\r\n            appid: String(r.appid || ''),\r\n            seq_id: Number(r.seq_id || 0),\r\n            menu_name: r.menu_name || 'ä¸»èœå•',\r\n            menu_level: 1,\r\n            parent_menu_id: 0,\r\n            act: toAct(r),\r\n            sub_menu_list: children.map((sm, si) => ({\r\n              id: Number(sm.id || 0),\r\n              admin_user_id: Number(sm.admin_user_id || 0),\r\n              appid: String(sm.appid || ''),\r\n              seq_id: Number(sm.seq_id || si),\r\n              menu_name: sm.menu_name || 'å­èœå•',\r\n              menu_level: 2,\r\n              parent_menu_id: Number(r.id || 0),\r\n              act: toAct(sm)\r\n            }))\r\n          }\r\n        })\r\n      activeRootIndex.value = 0\r\n      activeSubIndex.value = -1\r\n      editing.type = 'root'\r\n    }\r\n    nextTick(calcRootItemWidth)\r\n    message.success('åŒæ­¥èœå•æˆåŠŸ')\r\n  }).finally(() => {\r\n    syncLoading.value = false\r\n  })\r\n}\r\n\r\nconst getWechatAppListFn = async () => {\r\n  try {\r\n    const prev = selectedAppid.value\r\n    const res = await getWechatAppList({ app_type: 'official_account', app_name: '' })\r\n    const list = Array.isArray(res?.data) ? res.data : []\r\n    // åªéœ€è¦account_is_verifyä¸ºtrueçš„å…¬ä¼—å·\r\n    mpAccounts.value = list\r\n      .filter((it) => it.account_is_verify == 'true')\r\n      .map((it) => ({\r\n        id: it.id,\r\n        appid: it.app_id,\r\n        name: it.app_name,\r\n        logo: it.app_avatar,\r\n        custom_menu_status: String(it.custom_menu_status || '0')\r\n      }))\r\n    if (prev) {\r\n      const hit = mpAccounts.value.find((it) => it.appid === prev)\r\n      selectedAppid.value = hit ? prev : (mpAccounts.value[0]?.appid || '')\r\n    } else {\r\n      selectedAppid.value = mpAccounts.value[0]?.appid || ''\r\n    }\r\n  } catch (_e) {\r\n    mpAccounts.value = []\r\n    selectedAppid.value = ''\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  initAbilitySwitch()\r\n  await getWechatAppListFn()\r\n  initAppMenuSwitch()\r\n  nextTick(calcVisibleCount)\r\n  window.addEventListener('resize', calcVisibleCount)\r\n  if (selectedAppid.value) {\r\n    loadMenuList()\r\n  }\r\n})\r\nonUnmounted(() => { window.removeEventListener('resize', calcVisibleCount) })\r\n\r\nfunction selectMp (mp) {\r\n  selectedAppid.value = mp.appid\r\n  expanded.value = true\r\n  initAppMenuSwitch()\r\n  if (selectedAppid.value) {\r\n    loadMenuList()\r\n  }\r\n}\r\n\r\nconst abilitySwitchChecked = ref(false)\r\nconst initAbilitySwitch = () => {\r\n  getSpecifyAbilityConfig({ ability_type: 'official_custom_menu' }).then((res) => {\r\n    const st = res?.data?.user_config?.switch_status\r\n    abilitySwitchChecked.value = String(st || '0') === '1'\r\n  })\r\n}\r\nconst onAbilitySwitchChange = (checked) => {\r\n  const newStatus = checked ? '1' : '0'\r\n  if (newStatus === '0') {\r\n    Modal.confirm({\r\n      title: 'æç¤º',\r\n      content: 'å…³é—­åï¼Œè¯¥åŠŸèƒ½é»˜è®¤å…³é—­ä¸å†æ”¯æŒä½¿ç”¨ï¼Œæ‰€æœ‰çš„å…¬ä¼—å·èœå•éƒ½ä¼šåœç”¨ï¼Œç¡®è®¤å…³é—­ï¼Ÿ',\r\n      onOk: () => {\r\n        saveUserAbility({ ability_type: 'official_custom_menu', switch_status: newStatus }).then((res) => {\r\n          if (res && res.res == 0) {\r\n            abilitySwitchChecked.value = false\r\n            message.success('æ“ä½œæˆåŠŸ')\r\n            // åˆ·æ–°å…¬ä¼—å·åˆ—è¡¨\r\n            nextTick(async () => {\r\n              await getWechatAppListFn()\r\n              initAppMenuSwitch()\r\n            })\r\n          }\r\n        })\r\n      }\r\n    })\r\n    return\r\n  }\r\n  saveUserAbility({ ability_type: 'official_custom_menu', switch_status: newStatus }).then((res) => {\r\n    if (res && res.res == 0) {\r\n      abilitySwitchChecked.value = true\r\n      message.success('æ“ä½œæˆåŠŸ')\r\n    }\r\n  })\r\n}\r\n\r\nconst appMenuSwitch = ref('1')\r\nconst initAppMenuSwitch = () => {\r\n  if (!selectedAppid.value) { appMenuSwitch.value = '0'; return }\r\n  const cur = mpAccounts.value.find((it) => it.appid === selectedAppid.value)\r\n  appMenuSwitch.value = String(cur?.custom_menu_status || '0')\r\n}\r\nconst onAppSwitchChange = (checked) => {\r\n  const switch_status = checked\r\n  if (!selectedAppid.value) { message.error('è¯·é€‰æ‹©å…¬ä¼—å·'); return }\r\n  if (switch_status === '0') {\r\n    Modal.confirm({\r\n      title: 'æç¤º',\r\n      content: abilitySwitchChecked.value ? 'è¯¥å…¬ä¼—å·è‡ªå®šä¹‰èœå•åŠŸèƒ½å°†è¢«åœç”¨ï¼Œç²‰ä¸å°†æ— æ³•çœ‹åˆ°èœå•ã€‚è¯·è°¨æ…æ“ä½œï¼åç»­å¦‚éœ€å¼€å¯èœå•ï¼Œå¯ä»¥å¼€å¯åŠŸèƒ½åä¿å­˜' : 'å½“å‰èœå•æ˜¯å…³é—­çŠ¶æ€ï¼Œä¿å­˜ä»…æ˜¯æœ¬åœ°ä¿å­˜,ä¸ä¼šåŒæ­¥åˆ°å¾®ä¿¡ã€‚',\r\n      onOk: async () => {\r\n        try {\r\n          await closeWxMenu({ appid: selectedAppid.value })\r\n          message.success('æ“ä½œæˆåŠŸ')\r\n        } finally {\r\n          await getWechatAppListFn()\r\n          initAppMenuSwitch()\r\n        }\r\n      },\r\n      onCancel: () => {\r\n        appMenuSwitch.value = '1'\r\n      }\r\n    })\r\n    return\r\n  }\r\n  // å¼€å¯\r\n  Modal.confirm({\r\n    title: 'æç¤º',\r\n    content: abilitySwitchChecked.value ? 'å¼€å¯åï¼Œè¯·ä¿å­˜è¯¥å…¬ä¼—å·çš„èœå•ï¼Œä¿å­˜æˆåŠŸåå°†åŒæ­¥åˆ°å¾®ä¿¡' : 'å½“å‰èœå•æ˜¯å…³é—­çŠ¶æ€ï¼Œä¿å­˜ä»…æ˜¯æœ¬åœ°ä¿å­˜,ä¸ä¼šåŒæ­¥åˆ°å¾®ä¿¡ã€‚',\r\n    onOk: async () => {\r\n      const menu_json = toMenuJson()\r\n      saveCustomMenu({ appid: selectedAppid.value, menu_json: JSON.stringify(menu_json) })\r\n        .then(() => { message.success('ä¿å­˜æˆåŠŸ') })\r\n        .finally(async () => {\r\n          await getWechatAppListFn()\r\n          initAppMenuSwitch()\r\n        })\r\n    },\r\n    onCancel: () => {\r\n      appMenuSwitch.value = '0'\r\n    }\r\n  })\r\n}\r\n\r\nfunction toAct (item) {\r\n    const code = Number(item?.choose_act_item || 0)\r\n    const p = item?.act_params || {}\r\n    const ap = {}\r\n    if (code === 1) {\r\n      const replies = Array.isArray(p.reply_content) ? p.reply_content : []\r\n      ap.replyList = replies.map((rc) => ({\r\n        type: rc?.type || rc?.reply_type || 'text',\r\n        description: rc?.description || '',\r\n        thumb_url: rc?.thumb_url || rc?.pic || '',\r\n        title: rc?.title || '',\r\n        url: rc?.url || '',\r\n        appid: rc?.appid || '',\r\n        page_path: rc?.page_path || '',\r\n        standbyUrl: rc?.standbyUrl || rc?.standby_url || '',\r\n        smart_menu_id: rc?.smart_menu_id || '',\r\n        smart_menu: rc?.smart_menu || {},\r\n      }))\r\n      ap.reply_num = Number(item.reply_num || p.reply_num || 0)\r\n    } else if (code === 2) { ap.linkUrl = String(p.linkUrl || '') }\r\n    else if (code === 3) { ap.appid = String(p.appid || ''); ap.page_path = String(p.pagepath || p.page_path || ''); ap.standbyUrl = String(p.standbyUrl || p.standby_url || '') }\r\n    else if (code === 5) { ap.key = String(p.key || '') }\r\n    return { choose_act_item: code, act_params: ap }\r\n}\r\n  \r\nasync function loadMenuList () {\r\n  try {\r\n    const res = await getCustomMenuList({ appid: selectedAppid.value })\r\n    const list = Array.isArray(res?.data?.list) ? res.data.list : []\r\n    const roots = list.filter((it) => Number(it.menu_level) === 1)\r\n    const subs = list.filter((it) => Number(it.menu_level) === 2)\r\n    menus.value = roots\r\n      .sort((a, b) => Number(a.seq_id || 0) - Number(b.seq_id || 0))\r\n      .map((r) => {\r\n        const inlineSubs = Array.isArray(r.sub_menu_list) ? r.sub_menu_list : []\r\n        const byParentSubs = subs.filter((s) => Number(s.parent_menu_id || 0) === Number(r.id || 0))\r\n        const children = (inlineSubs.length ? inlineSubs : byParentSubs).slice().sort((a, b) => Number(a.seq_id || 0) - Number(b.seq_id || 0))\r\n        return {\r\n          id: Number(r.id || 0),\r\n          admin_user_id: Number(r.admin_user_id || 0),\r\n          appid: String(r.appid || ''),\r\n          seq_id: Number(r.seq_id || 0),\r\n          menu_name: r.menu_name || 'ä¸»èœå•',\r\n          menu_level: 1,\r\n          parent_menu_id: 0,\r\n          act: toAct(r),\r\n          sub_menu_list: children.map((sm, si) => ({\r\n            id: Number(sm.id || 0),\r\n            admin_user_id: Number(sm.admin_user_id || 0),\r\n            appid: String(sm.appid || ''),\r\n            seq_id: Number(sm.seq_id || si),\r\n            menu_name: sm.menu_name || 'å­èœå•',\r\n            menu_level: 2,\r\n            parent_menu_id: Number(r.id || 0),\r\n            act: toAct(sm)\r\n          }))\r\n        }\r\n      })\r\n    nextTick(calcRootItemWidth)\r\n  } catch (_) {\r\n    // ä¿æŒé»˜è®¤\r\n  }\r\n}\r\n\r\nconst goBack = () => {\r\n  if (route.query.id && route.query.robot_key) {\r\n    router.push({ path: '/robot/config/function-center', query: { id: route.query.id, robot_key: route.query.robot_key } })\r\n  } else {\r\n    router.push({ path: '/explore/index' })\r\n  }\r\n}\r\n\r\n// ====== è‡ªå®šä¹‰èœå•ç¼–è¾‘åŒº ======\r\nconst activeRootIndex = ref(0)\r\nconst activeSubIndex = ref(-1)\r\nconst editing = reactive({ type: 'root' })\r\nconst actEditorRef = ref(null)\r\nconst rootNameInputRef = ref(null)\r\nconst showEmoji = ref(false)\r\nconst emojiIndex = new EmojiIndex(emojiDataJson)\r\nconst subNameInputRef = ref(null)\r\nconst showSubEmoji = ref(false)\r\nfunction getPopup () { return document.body }\r\nfunction onEmojiSelect (emoji) {\r\n  const char = emoji?.native || ''\r\n  if (!char) return\r\n  const el = rootNameInputRef.value?.$el?.querySelector('input')\r\n  const val = String(menus.value[activeRootIndex.value]?.menu_name || '')\r\n  if (el && typeof el.selectionStart === 'number') {\r\n    const start = el.selectionStart\r\n    const end = el.selectionEnd\r\n    const nextVal = val.slice(0, start) + char + val.slice(end)\r\n    const clamped = clampNameLen(nextVal, 5)\r\n    if (clamped !== nextVal) { message.warning('ä¸»èœå•åç§°æœ€å¤šæ”¯æŒ5ä¸ªå­—ç¬¦') }\r\n    menus.value[activeRootIndex.value].menu_name = clamped\r\n    nextTick(() => {\r\n      el.focus()\r\n      const pos = (menus.value[activeRootIndex.value].menu_name || '').length\r\n      el.setSelectionRange(pos, pos)\r\n    })\r\n  } else {\r\n    const nextVal = val + char\r\n    const clamped = clampNameLen(nextVal, 5)\r\n    if (clamped !== nextVal) { message.warning('ä¸»èœå•åç§°æœ€å¤šæ”¯æŒ5ä¸ªå­—ç¬¦') }\r\n    menus.value[activeRootIndex.value].menu_name = clamped\r\n  }\r\n  showEmoji.value = false\r\n}\r\n\r\nfunction onSubEmojiSelect (emoji) {\r\n  const char = emoji?.native || ''\r\n  if (!char) return\r\n  const el = subNameInputRef.value?.$el?.querySelector('input')\r\n  const val = String(menus.value[activeRootIndex.value]?.sub_menu_list?.[activeSubIndex.value]?.menu_name || '')\r\n  const max = 18\r\n  if (el && typeof el.selectionStart === 'number') {\r\n    const start = el.selectionStart\r\n    const end = el.selectionEnd\r\n    const nextVal = val.slice(0, start) + char + val.slice(end)\r\n    const clamped = clampNameLen(nextVal, max)\r\n    if (clamped !== nextVal) { message.warning('å­èœå•åç§°æœ€å¤šæ”¯æŒ18ä¸ªå­—ç¬¦') }\r\n    menus.value[activeRootIndex.value].sub_menu_list[activeSubIndex.value].menu_name = clamped\r\n    nextTick(() => {\r\n      el.focus()\r\n      const pos = (menus.value[activeRootIndex.value].sub_menu_list[activeSubIndex.value].menu_name || '').length\r\n      el.setSelectionRange(pos, pos)\r\n    })\r\n  } else {\r\n    const nextVal = val + char\r\n    const clamped = clampNameLen(nextVal, max)\r\n    if (clamped !== nextVal) { message.warning('å­èœå•åç§°æœ€å¤šæ”¯æŒ18ä¸ªå­—ç¬¦') }\r\n    menus.value[activeRootIndex.value].sub_menu_list[activeSubIndex.value].menu_name = clamped\r\n  }\r\n  showSubEmoji.value = false\r\n}\r\n\r\nfunction onSubNameInput () {\r\n  const v = String(menus.value[activeRootIndex.value]?.sub_menu_list?.[activeSubIndex.value]?.menu_name || '')\r\n  const cl = clampNameLen(v, 18)\r\n  if (cl !== v) {\r\n    menus.value[activeRootIndex.value].sub_menu_list[activeSubIndex.value].menu_name = cl\r\n    message.warning('å­èœå•åç§°æœ€å¤šæ”¯æŒ18ä¸ªå­—ç¬¦')\r\n  }\r\n}\r\n\r\nconst segmentGraphemes = (s) => {\r\n  try {\r\n    const seg = new Intl.Segmenter('zh', { granularity: 'grapheme' })\r\n    return Array.from(seg.segment(String(s))).map((it) => it.segment)\r\n  } catch (_) {\r\n    return Array.from(String(s))\r\n  }\r\n}\r\nconst clampNameLen = (s, n = 5) => {\r\n  const segs = segmentGraphemes(s)\r\n  return segs.slice(0, n).join('')\r\n}\r\nconst onRootNameInput = () => {\r\n  const v = String(menus.value[activeRootIndex.value]?.menu_name || '')\r\n  const cl = clampNameLen(v, 5)\r\n  if (cl !== v) {\r\n    menus.value[activeRootIndex.value].menu_name = cl\r\n    message.warning('ä¸»èœå•åç§°æœ€å¤šæ”¯æŒ5ä¸ªå­—ç¬¦')\r\n  }\r\n}\r\n\r\nfunction makeEmptyAct () {\r\n  return {\r\n    choose_act_item: 1,\r\n    act_params: {\r\n      replyList: [{\r\n        type: 'text',\r\n        description: ''\r\n      }],\r\n      reply_num: 0\r\n    }\r\n  }\r\n}\r\n\r\nconst menus = ref([\r\n  {\r\n    id: 0,\r\n    admin_user_id: 0,\r\n    appid: '',\r\n    seq_id: 0,\r\n    menu_name: 'ä¸»èœå•',\r\n    menu_level: 1,\r\n    parent_menu_id: 0,\r\n    choose_act_item: 0,\r\n    act_params: {},\r\n    act: makeEmptyAct(),\r\n    sub_menu_list: []\r\n  }\r\n])\r\n\r\nconst bottomMenuRef = ref(null)\r\nconst rootItemWidth = ref(64)\r\nfunction calcRootItemWidth () {\r\n  const wrap = bottomMenuRef.value\r\n  if (!wrap) return\r\n  const total = wrap.clientWidth || 0\r\n  const hasAdd = menus.value.length < 3\r\n  const addWidth = hasAdd ? 32 : 0\r\n  const gap = 8\r\n  const n = Math.max(menus.value.length, 1)\r\n  const avail = total - addWidth - gap * (n - 1)\r\n  const w = Math.max(Math.floor(avail / n), 48)\r\n  rootItemWidth.value = w\r\n}\r\n\r\nfunction addRootMenu () {\r\n  if (menus.value.length >= 3) return\r\n  menus.value.push({\r\n    id: 0,\r\n    admin_user_id: 0,\r\n    appid: selectedAppid.value,\r\n    seq_id: 0,\r\n    menu_name: 'ä¸»èœå•',\r\n    menu_level: 1,\r\n    parent_menu_id: 0,\r\n    choose_act_item: 0,\r\n    act_params: {},\r\n    act: makeEmptyAct(),\r\n    sub_menu_list: []\r\n  })\r\n  activeRootIndex.value = menus.value.length - 1\r\n  activeSubIndex.value = -1\r\n  editing.type = 'root'\r\n  nextTick(calcRootItemWidth)\r\n}\r\nfunction onSelectRoot (idx) {\r\n  activeRootIndex.value = idx;\r\n  activeSubIndex.value = -1;\r\n  editing.type = 'root'\r\n}\r\nfunction removeRootMenu (idx) {\r\n  if (menus.value.length <= 1) {\r\n    message.warning('è‡³å°‘ä¿ç•™ä¸€ä¸ªä¸»èœå•');\r\n    return\r\n  }\r\n  Modal.confirm({\r\n    title: 'æç¤º',\r\n    content: 'åˆ é™¤å,è¯¥ä¸»èœå•ä¸‹è®¾ç½®çš„å†…å®¹åŠå­èœå•å°†è¢«å…¨è¢«åˆ é™¤',\r\n    okText: 'ç¡®å®š',\r\n    cancelText: 'å–æ¶ˆ',\r\n    onOk() {\r\n      menus.value.splice(idx, 1)\r\n      if (activeRootIndex.value >= menus.value.length) {\r\n        activeRootIndex.value = menus.value.length - 1\r\n      } else if (activeRootIndex.value > idx) {\r\n        activeRootIndex.value = activeRootIndex.value - 1\r\n      }\r\n      activeSubIndex.value = -1\r\n      editing.type = 'root'\r\n      nextTick(calcRootItemWidth)\r\n    }\r\n  })\r\n}\r\nfunction addSubMenu (rootIdx) {\r\n  const root = menus.value[rootIdx]\r\n  if (!root) return\r\n  root.sub_menu_list = root.sub_menu_list || []\r\n  if (root.sub_menu_list.length >= 5) return\r\n  const doAdd = () => {\r\n    root.sub_menu_list.push({\r\n      id: 0,\r\n      admin_user_id: 0,\r\n      appid: selectedAppid.value,\r\n      seq_id: root.sub_menu_list.length,\r\n      menu_name: 'å­èœå•',\r\n      menu_level: 2,\r\n      parent_menu_id: root.id,\r\n      choose_act_item: 0,\r\n      act_params: {},\r\n      act: makeEmptyAct()\r\n    })\r\n    activeRootIndex.value = rootIdx\r\n    activeSubIndex.value = (root.sub_menu_list || []).length - 1\r\n    editing.type = 'sub'\r\n  }\r\n  if (root.sub_menu_list.length === 0) {\r\n    Modal.confirm({\r\n      title: 'æç¤º',\r\n      content: 'æ·»åŠ å­èœå•åï¼Œä¸€çº§èœå•çš„å†…å®¹å°†è¢«æ¸…é™¤ã€‚ç¡®å®šæ·»åŠ å­èœå•ï¼Ÿ',\r\n      okText: 'ç¡®å®š',\r\n      cancelText: 'å–æ¶ˆ',\r\n      onOk() {\r\n        root.act = makeEmptyAct()\r\n        doAdd()\r\n      }\r\n    })\r\n  } else {\r\n    doAdd()\r\n  }\r\n}\r\nfunction onSelectSub (rootIdx, subIdx) {\r\n  activeRootIndex.value = rootIdx;\r\n  activeSubIndex.value = subIdx;\r\n  editing.type = 'sub'\r\n}\r\nfunction removeSubMenu (rootIdx, subIdx) {\r\n  const root = menus.value[rootIdx]\r\n  if (!root) return\r\n  Modal.confirm({\r\n    title: 'æç¤º',\r\n    content: 'åˆ é™¤å,è¯¥å­èœå•ä¸‹è®¾ç½®çš„å†…å®¹å°†è¢«å…¨è¢«åˆ é™¤',\r\n    okText: 'ç¡®å®š',\r\n    cancelText: 'å–æ¶ˆ',\r\n    onOk() {\r\n      root.sub_menu_list.splice(subIdx, 1)\r\n      const len = (root.sub_menu_list || []).length\r\n      if (activeRootIndex.value === rootIdx) {\r\n        if (len === 0) {\r\n          activeSubIndex.value = -1\r\n          editing.type = 'root'\r\n        } else if (activeSubIndex.value >= len) {\r\n          activeSubIndex.value = len - 1\r\n          editing.type = 'sub'\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\nlet draggingRootSelected = null\r\nfunction onRootDragStart () {\r\n  draggingRootSelected = menus.value[activeRootIndex.value] || null\r\n}\r\nfunction onRootDragEnd () {\r\n  menus.value.forEach((m, i) => { m.seq_id = i })\r\n  if (draggingRootSelected) {\r\n    const newIdx = menus.value.findIndex((m) => m === draggingRootSelected)\r\n    if (newIdx >= 0) {\r\n      activeRootIndex.value = newIdx\r\n    }\r\n  }\r\n  draggingRootSelected = null\r\n}\r\nlet draggingSubSelected = null\r\nfunction onSubDragStart (rootIdx) {\r\n  const root = menus.value[rootIdx]\r\n  if (!root) { draggingSubSelected = null; return }\r\n  if (activeRootIndex.value === rootIdx && activeSubIndex.value >= 0) {\r\n    draggingSubSelected = (root.sub_menu_list || [])[activeSubIndex.value] || null\r\n  } else {\r\n    draggingSubSelected = null\r\n  }\r\n}\r\nfunction onSubDragEnd (rootIdx) {\r\n  const root = menus.value[rootIdx]\r\n  if (!root) return\r\n  (root.sub_menu_list || []).forEach((sm, i) => { sm.seq_id = i })\r\n  if (activeRootIndex.value === rootIdx && draggingSubSelected) {\r\n    const newIdx = (root.sub_menu_list || []).findIndex((sm) => sm === draggingSubSelected)\r\n    if (newIdx >= 0) {\r\n      activeSubIndex.value = newIdx\r\n    }\r\n    editing.type = (activeSubIndex.value >= 0) ? 'sub' : 'root'\r\n  }\r\n  draggingSubSelected = null\r\n}\r\n\r\nfunction serializeReplyContent (list) {\r\n  return (list || []).map((it) => ({\r\n    ...it,\r\n    status: '1'\r\n  }))\r\n}\r\nfunction serializeReplyTypeCodes (list) {\r\n  const map = {\r\n    text: '2',\r\n    image: '4',\r\n    card: '3',\r\n    imageText: '1',\r\n    url: '5',\r\n    smartMenu: '6'\r\n  }; return (list || []).map((it) => map[it.type] || '').filter(Boolean)\r\n}\r\n\r\nfunction buildActPayload (act) {\r\n  const item = Number(act?.choose_act_item || 0)\r\n  const p = act?.act_params || {}\r\n  if (item === 1) {\r\n    return {\r\n      item,\r\n      reply_content: serializeReplyContent(p.replyList || []),\r\n      reply_type: serializeReplyTypeCodes(p.replyList || []),\r\n      reply_num: Number(p.reply_num || 0)\r\n    }\r\n  }\r\n  if (item === 2) {\r\n    return {\r\n      item,\r\n      linkUrl: String(p.linkUrl || '')\r\n    }\r\n  }\r\n  if (item === 3) {\r\n    return {\r\n      item,\r\n      appid: String(p.appid || ''),\r\n      pagepath: String(p.page_path || ''),\r\n      standbyUrl: String(p.standbyUrl || '')\r\n    }\r\n  }\r\n  if (item === 5) {\r\n    return {\r\n      item,\r\n      key: String(p.key || '')\r\n    }\r\n  }\r\n  return {\r\n    item: 0\r\n  }\r\n}\r\n\r\nfunction httpOk (s) {\r\n  return /^https?:\\/\\//.test(String(s || ''))\r\n}\r\nfunction validateReplyList (list) {\r\n  const arr = Array.isArray(list) ? list : []\r\n  if (!arr.length) return false\r\n  for (const rc of arr) {\r\n    const t = rc?.type || rc?.reply_type\r\n    if (t === 'text') {\r\n      if (!String(rc?.description || '').trim()) return false\r\n    } else if (t === 'image') {\r\n      if (!String(rc?.thumb_url || '').trim()) return false\r\n    } else if (t === 'imageText') {\r\n      if (!httpOk(rc?.url) || !String(rc?.title || '').trim() || !String(rc?.description || '').trim() || !String(rc?.thumb_url || '').trim()) return false\r\n    } else if (t === 'url') {\r\n      if (!httpOk(rc?.url) || !String(rc?.title || '').trim()) return false\r\n    } else if (t === 'card') {\r\n      if (!String(rc?.title || '').trim() || !String(rc?.appid || '').trim() || !String(rc?.page_path || '').trim() || !String(rc?.thumb_url || '').trim()) return false\r\n    } else if (t === 'smartMenu') {\r\n      const sid = String(rc?.smart_menu_id || rc?.smart_menu?.id || '').trim();\r\n      if (!sid) return false\r\n    }\r\n  }\r\n  return true\r\n}\r\nfunction validateActDeep (act) {\r\n  const item = Number(act?.choose_act_item || 0)\r\n  const p = act?.act_params || {}\r\n  if (item === 0) return true\r\n  if (item === 1) return validateReplyList(p.replyList)\r\n  if (item === 2) return httpOk(p.linkUrl)\r\n  if (item === 3) return String(p.appid || '').trim().length > 0 && String(p.page_path || '').trim().length > 0 && httpOk(p.standbyUrl)\r\n  if (item === 5) return String(p.key || '').trim().length > 0\r\n  return true\r\n}\r\n\r\nfunction toMenuJson () {\r\n  return menus.value.map((root, ri) => {\r\n    const node = {\r\n      admin_user_id: 1,\r\n      appid: selectedAppid.value,\r\n      seq_id: ri,\r\n      menu_name: root.menu_name || 'ä¸»èœå•',\r\n      menu_level: 1,\r\n      parent_menu_id: 0,\r\n      choose_act_item: (root.sub_menu_list || []).length > 0 ? 0 : Number(root.act?.choose_act_item || 0),\r\n      act_params: (root.sub_menu_list || []).length > 0 ? { item: 0 } : buildActPayload(root.act),\r\n      oper_user_id: 1,\r\n      sub_menu_list: (root.sub_menu_list || []).map((sm, si) => {\r\n        const child = {\r\n          admin_user_id: 1,\r\n          appid: selectedAppid.value,\r\n          seq_id: si,\r\n          menu_name: sm.menu_name || 'å­èœå•',\r\n          menu_level: 2,\r\n          parent_menu_id: Number(root.id || 0),\r\n          choose_act_item: Number(sm.act?.choose_act_item || 0),\r\n          act_params: buildActPayload(sm.act),\r\n          oper_user_id: 1,\r\n          create_time: toolTime(),\r\n          update_time: toolTime()\r\n        }\r\n        const sid = Number(sm.id || 0)\r\n        if (sid > 0) child.id = sid\r\n        return child\r\n      }),\r\n      create_time: toolTime(),\r\n      update_time: toolTime()\r\n    }\r\n    const rid = Number(root.id || 0)\r\n    if (rid > 0) node.id = rid\r\n    return node\r\n  })\r\n}\r\n\r\nfunction toolTime () {\r\n  return Math.floor(Date.now() / 1000)\r\n}\r\n\r\nasync function onSave () {\r\n  if (saveLoading.value) {\r\n    return\r\n  }\r\n  if (!selectedAppid.value) {\r\n    message.error('è¯·é€‰æ‹©å…¬ä¼—å·');\r\n    return\r\n  }\r\n  if (actEditorRef.value && actEditorRef.value.getValue) {\r\n    const val = actEditorRef.value.getValue()\r\n    if (editing.type === 'root') {\r\n      menus.value[activeRootIndex.value].act = val\r\n    } else if (editing.type === 'sub') {\r\n      const root = menus.value[activeRootIndex.value]\r\n      if (root && root.sub_menu_list && root.sub_menu_list[activeSubIndex.value]) {\r\n        root.sub_menu_list[activeSubIndex.value].act = val\r\n      }\r\n    }\r\n  }\r\n  if (actEditorRef.value && actEditorRef.value.validate) {\r\n    const ok = await actEditorRef.value.validate()\r\n    if (!ok) { return }\r\n  }\r\n  // ç®€å•æ ¡éªŒ\r\n  for (let ri = 0; ri < menus.value.length; ri++) {\r\n    const root = menus.value[ri]\r\n    const rootName = String(root.menu_name || 'ä¸»èœå•')\r\n    if ((root.sub_menu_list || []).length === 0) {\r\n      if (!validateActDeep(root.act)) { message.error(`è¯·å®Œå–„ä¸»èœå•ã€Œ${rootName}ã€åŠŸèƒ½é…ç½®`); return }\r\n    }\r\n    for (let si = 0; si < (root.sub_menu_list || []).length; si++) {\r\n      const sm = root.sub_menu_list[si]\r\n      const subName = String(sm.menu_name || 'å­èœå•')\r\n      if (!validateActDeep(sm.act)) { message.error(`è¯·å®Œå–„ä¸»èœå•ã€Œ${rootName}ã€ä¸‹çš„å­èœå•ã€Œ${subName}ã€åŠŸèƒ½é…ç½®`); return }\r\n    }\r\n  }\r\n  const menu_json = toMenuJson()\r\n  Modal.confirm({\r\n    title: 'ç¡®è®¤ä¿å­˜å¹¶åº”ç”¨å—ï¼Ÿ',\r\n    okText: 'ç¡®è®¤',\r\n    cancelText: 'å–æ¶ˆ',\r\n    onOk: async () => {\r\n      saveLoading.value = true\r\n      try {\r\n        await saveCustomMenu({\r\n          appid: selectedAppid.value,\r\n          menu_json: JSON.stringify(menu_json)\r\n        })\r\n        message.success('ä¿å­˜æˆåŠŸ')\r\n      } finally {\r\n        saveLoading.value = false\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// åŠ¨æ€å®½åº¦ç›‘å¬\r\nwatch(() => menus.value.length, () => {\r\n  nextTick(calcRootItemWidth)\r\n})\r\nwatch(() => activeRootIndex.value, () => {\r\n  nextTick(calcRootItemWidth)\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.user-model-page {\r\n  width: 100%;\r\n\r\n  .page-title {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 24px;\r\n    padding-bottom: 16px;\r\n    background-color: #fff;\r\n    color: #000000;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    line-height: 24px;\r\n  }\r\n\r\n  .search-block {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 16px;\r\n    margin: 24px 0 12px;\r\n  }\r\n\r\n  .list-box {\r\n    margin-top: 8px;\r\n  }\r\n\r\n  ::v-deep(.ant-alert) {\r\n    align-items: baseline;\r\n  }\r\n}\r\n\r\n.flex {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.mp-list-block {\r\n  margin: 16px 0 8px 0;\r\n}\r\n\r\n.mp-list {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  flex-wrap: nowrap;\r\n}\r\n\r\n.mp-list.expanded {\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.mp-card {\r\n  cursor: pointer;\r\n  min-width: 160px;\r\n  padding: 8px 12px;\r\n  border-radius: 8px;\r\n  background: #fff;\r\n  border: 1px solid #edeff2;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n\r\n  &:hover {\r\n    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.08);\r\n  }\r\n}\r\n\r\n.selected {\r\n  border-color: #1890ff;\r\n  background-color: rgba(24, 144, 255, 0.04);\r\n}\r\n\r\n.mp-logo {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n}\r\n\r\n.mp-name {\r\n  color: #262626;\r\n  font-size: 14px;\r\n  line-height: 22px;\r\n}\r\n\r\n.more-btn {\r\n  flex: 0 0 auto;\r\n}\r\n\r\n.breadcrumb-wrap {\r\n  width: fit-content;\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.breadcrumb-title {\r\n  margin: 0 12px 0 2px;\r\n  color: #262626;\r\n  font-size: 16px;\r\n  font-style: normal;\r\n  font-weight: 600;\r\n  line-height: 24px;\r\n}\r\n\r\n.switch-tip {\r\n  margin-left: 4px;\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 22px;\r\n}\r\n\r\n.main {\r\n  display: flex;\r\n  gap: 80px;\r\n}\r\n\r\n.main-left {\r\n  flex: 0 0 auto;\r\n}\r\n\r\n.main-right {\r\n  max-width: 694px;\r\n  flex: 1;\r\n}\r\n\r\n.iphone-mock {\r\n  width: 264px;\r\n  height: 544px;\r\n  background-repeat: no-repeat;\r\n  background-size: contain;\r\n  position: relative;\r\n}\r\n\r\n.bottom-menu {\r\n  position: absolute;\r\n  height: 32px;\r\n  width: calc(100% - 60px);\r\n  bottom: 42px;\r\n  right: 16px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.root-menu-draggable {\r\n  display: flex;\r\n  flex: 1;\r\n}\r\n\r\n.root-menu-item {\r\n  box-sizing: border-box;\r\n  line-height: 32px;\r\n  height: 32px;\r\n  flex: 1;\r\n  text-align: center;\r\n  cursor: pointer;\r\n  position: relative;\r\n  border: 1px solid transparent;\r\n  font-size: 12px;\r\n  color: #262626;\r\n  border-right: 1px solid #D9D9D9;\r\n\r\n  .name {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n}\r\n\r\n.del-root {\r\n  position: absolute;\r\n  top: -2px;\r\n  right: -2px;\r\n  cursor: pointer;\r\n  opacity: 0;\r\n  transition: opacity .2s ease;\r\n}\r\n\r\n.root-menu-item:hover .del-root {\r\n  opacity: 1;\r\n}\r\n\r\n.root-menu-add {\r\n  width: 32px;\r\n  height: 32px;\r\n  border: 1px solid transparent;\r\n  color: #262626;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n}\r\n\r\n.submenu-panel {\r\n  position: absolute;\r\n  bottom: 42px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.submenu-card {\r\n  width: 64px;\r\n  background: #fff;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\r\n}\r\n\r\n.sub-menu-item {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 0px 2px;\r\n  border: 1px solid transparent;\r\n  cursor: pointer;\r\n  position: relative;\r\n  border-bottom: 1px solid #F0F0F0;\r\n\r\n  .text {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n\r\n  .del {\r\n    position: absolute;\r\n    top: -2px;\r\n    right: -2px;\r\n  }\r\n}\r\n\r\n.sub-menu-item .del {\r\n  color: #595959;\r\n  display: none;\r\n  font-size: 18px;\r\n  cursor: pointer;\r\n}\r\n\r\n.sub-menu-item:hover .del {\r\n  display: inline;\r\n}\r\n\r\n.root-menu-item.active,\r\n.sub-menu-item.active {\r\n  border-color: #2475FC;\r\n}\r\n\r\n.submenu-add {\r\n  height: 32px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 8px 0;\r\n  border-top: 1px solid #f0f0f0;\r\n  cursor: pointer;\r\n  color: #262626;\r\n  font-size: 14px;\r\n}\r\n\r\n.submenu-arrow {\r\n  width: 0;\r\n  height: 0;\r\n  border-left: 15px solid transparent;\r\n  border-right: 15px solid transparent;\r\n  border-top: 8px solid #fff;\r\n  filter: drop-shadow(0 2px 0 #edeff2);\r\n}\r\n\r\n.form-item {\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.form-item .label {\r\n  color: #262626;\r\n  font-weight: 400;\r\n  margin-bottom: 6px;\r\n}\r\n\r\n.form-item .tip {\r\n  color: #8c8c8c;\r\n  font-size: 12px;\r\n  margin-top: 4px;\r\n}\r\n\r\n.required {\r\n  color: #FB363F;\r\n  margin-right: 4px;\r\n}\r\n\r\n.emoji-row {\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: flex-end;\r\n  cursor: pointer;\r\n  gap: 8px;\r\n  margin-top: 4px;\r\n}\r\n\r\n.footer-save {\r\n  position: fixed;\r\n  bottom: 0;\r\n  right: 16px;\r\n  display: flex;\r\n  width: 100%;\r\n  padding: 16px 1055px 16px 406px;\r\n  align-items: center;\r\n  border-radius: 0 0 2px 2px;\r\n  background: #FFF;\r\n  box-shadow: 0 -8px 4px 0 #0000000a;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"auto-reply-home\">\r\n    <template v-if=\"hasApps\">\r\n      <CustomMenu />\r\n    </template>\r\n    <template v-else>\r\n      <div class=\"user-model-page\">\r\n        <div class=\"breadcrumb-wrap\">\r\n          <svg-icon @click=\"goBack\" name=\"back\" style=\"font-size: 20px;\" />\r\n          <div @click=\"goBack\" class=\"breadcrumb-title\">è‡ªå®šä¹‰èœå•</div>\r\n          <a-switch\r\n            :checked=\"abilitySwitchChecked\"\r\n            checked-children=\"å¼€\"\r\n            un-checked-children=\"å…³\"\r\n            @change=\"onAbilitySwitchChange\"\r\n          />\r\n          <span class=\"switch-tip\">å¼€å¯åï¼Œå…¬ä¼—å·æ˜¾ç¤ºè‡ªå®šä¹‰èœå•ï¼›å…³é—­åï¼Œç²‰ä¸å°†æ— æ³•çœ‹åˆ°èœå•ã€‚</span>\r\n        </div>\r\n        <a-alert show-icon>\r\n          <template #message>\r\n            å¼€å¯åï¼Œç”¨æˆ·å…³æ³¨å…¬ä¼—å·åï¼Œå›å¤æŒ‡å®šçš„å†…å®¹ï¼Œ<span style=\"color: #FF4D4F;\">è¯¥åŠŸèƒ½ä»…æ”¯æŒå…¬ä¼—å·å†…å›å¤</span>\r\n          </template>\r\n        </a-alert>\r\n        <div class=\"empty-wrap\">\r\n          <ListEmpty size=\"180\">\r\n            <div class=\"empty-default\">æš‚æœªç»‘å®šå…¬ä¼—å·</div>\r\n            <div class=\"empty-sub\">è¯·é€‰åˆ°ç³»ç»Ÿè®¾ç½®>å…¬ä¼—å·ç®¡ç†ç»‘å®šå…¬ä¼—å·</div>\r\n          </ListEmpty>\r\n          <div class=\"empty-actions\">\r\n            <a-button type=\"primary\" @click=\"goBind\">å»ç»‘å®šå…¬ä¼—å·</a-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </div>\r\n  \r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { useRoute,useRouter } from 'vue-router'\r\nimport { getWechatAppList } from '@/api/robot'\r\nimport CustomMenu from './custom-menu.vue'\r\nimport ListEmpty from '@/views/robot/robot-config/function-center/components/list-empty.vue'\r\nimport { getSpecifyAbilityConfig, saveUserAbility } from '@/api/explore'\r\nimport { message, Modal } from 'ant-design-vue'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst hasApps = ref(true)\r\nconst abilitySwitchChecked = ref(false)\r\n\r\nconst fetchApps = async () => {\r\n  try {\r\n    const res = await getWechatAppList({ app_type: 'official_account', app_name: '' })\r\n    // åªéœ€è¦account_is_verifyä¸ºtrueçš„å…¬ä¼—å·\r\n    const list = Array.isArray(res?.data) ? res.data.filter((it) => it.account_is_verify == 'true') : []\r\n    hasApps.value = list.length > 0\r\n  } catch (_e) {\r\n    hasApps.value = false\r\n  }\r\n}\r\n\r\nconst initAbilitySwitch = () => {\r\n  getSpecifyAbilityConfig({ ability_type: 'official_custom_menu' }).then((res) => {\r\n    const st = res?.data?.user_config?.switch_status\r\n    abilitySwitchChecked.value = String(st || '0') === '1'\r\n  })\r\n}\r\n\r\nconst onAbilitySwitchChange = (checked) => {\r\n  const newStatus = checked ? '1' : '0'\r\n  if (newStatus === '0') {\r\n    Modal.confirm({\r\n      title: 'æç¤º',\r\n      content: 'å…³é—­åï¼Œè¯¥åŠŸèƒ½é»˜è®¤å…³é—­ä¸å†æ”¯æŒä½¿ç”¨ï¼Œæ‰€æœ‰çš„å…¬ä¼—å·èœå•éƒ½ä¼šåœç”¨ï¼Œç¡®è®¤å…³é—­ï¼Ÿ',\r\n      onOk: () => {\r\n        saveUserAbility({ ability_type: 'official_custom_menu', switch_status: newStatus }).then((res) => {\r\n          if (res && res.res == 0) {\r\n            abilitySwitchChecked.value = false\r\n            message.success('æ“ä½œæˆåŠŸ')\r\n          }\r\n        })\r\n      }\r\n    })\r\n    return\r\n  }\r\n  saveUserAbility({ ability_type: 'official_custom_menu', switch_status: newStatus }).then((res) => {\r\n    if (res && res.res == 0) {\r\n      abilitySwitchChecked.value = true\r\n      message.success('æ“ä½œæˆåŠŸ')\r\n    }\r\n  })\r\n}\r\n\r\nconst goBind = () => {\r\n  const url = router.resolve({ path: '/user/official-account' })\r\n  window.open(url.href, '_blank')\r\n}\r\n\r\nconst goBack = () => {\r\n  if (route.query.id && route.query.robot_key) {\r\n    router.push({ path: '/robot/config/function-center', query: { id: route.query.id, robot_key: route.query.robot_key } })\r\n  } else {\r\n    router.push({ path: '/explore/index' })\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  initAbilitySwitch()\r\n  fetchApps()\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.auto-reply-home {\r\n  height: 100%;\r\n  width: 100%;\r\n  padding: 16px 48px;\r\n  overflow-y: auto;\r\n}\r\n.empty-wrap {\r\n  margin-top: 100px;\r\n  height: calc(100% - 32px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 12px;\r\n  .empty-default {\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n  }\r\n  .empty-sub {\r\n    font-size: 14px;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    line-height: 22px;\r\n  }\r\n}\r\n.empty-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.page-title {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 24px;\r\n  padding-bottom: 16px;\r\n  background-color: #fff;\r\n  color: #000000;\r\n  font-size: 16px;\r\n  font-style: normal;\r\n  font-weight: 600;\r\n  line-height: 24px;\r\n}\r\n.subManage-breadcrumb {\r\n  display: flex;\r\n  align-items: center;\r\n  color: #000000;\r\n  font-family: \"PingFang SC\";\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  line-height: 22px;\r\n  padding-bottom: 16px;\r\n}\r\n\r\n.breadcrumb-wrap {\r\n  width: fit-content;\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  margin-bottom: 16px;\r\n}\r\n.breadcrumb-title {\r\n  margin: 0 12px 0 2px;\r\n  color: #262626;\r\n  font-size: 16px;\r\n  font-style: normal;\r\n  font-weight: 600;\r\n  line-height: 24px;\r\n}\r\n\r\n.switch-tip {\r\n  margin-left: 4px;\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 22px;\r\n}\r\n</style>\r\n"],"names":["replyRefs","ref","props","__props","emit","__emit","state","reactive","_a","replyList","_b","_c","_d","reply_num","_e","linkModel","_f","eventKey","_g","miniCard","_h","_i","_j","cardForm","linkForm","cardLabelCol","cardWrapperCol","rules","watch","val","ap","emitChange","addReply","onContentChange","payload","reply_index","rest","onDelItem","index","getValue","act_params","validate","item","message","comp","__expose","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_a_radio_group","_cache","$event","_component_a_radio","_hoisted_3","_hoisted_4","_Fragment","_renderList","it","idx","_createBlock","MultiReply","_component_a_button","_unref","PlusOutlined","_createTextVNode","_toDisplayString","_hoisted_5","_component_a_form","_component_a_form_item","_component_a_input","_hoisted_6","_hoisted_7","_component_a_alert","_hoisted_8","iphoneBg","CARD_WIDTH","GAP","MORE_BTN_WIDTH","route","useRoute","router","useRouter","mpAccounts","selectedAppid","expanded","mpListRef","visibleCount","syncLoading","saveLoading","calcVisibleCount","el","w","per","count","calcRootItemWidth","syncMenu","syncWxMenuToShow","res","list","roots","subs","menus","b","r","inlineSubs","byParentSubs","s","children","a","toAct","sm","si","activeRootIndex","activeSubIndex","editing","nextTick","getWechatAppListFn","prev","getWechatAppList","hit","onMounted","initAbilitySwitch","initAppMenuSwitch","loadMenuList","onUnmounted","selectMp","mp","abilitySwitchChecked","getSpecifyAbilityConfig","st","onAbilitySwitchChange","checked","newStatus","Modal","saveUserAbility","appMenuSwitch","cur","onAppSwitchChange","switch_status","closeWxMenu","menu_json","toMenuJson","saveCustomMenu","code","p","replies","rc","getCustomMenuList","goBack","actEditorRef","rootNameInputRef","showEmoji","emojiIndex","EmojiIndex","emojiDataJson","subNameInputRef","showSubEmoji","getPopup","onEmojiSelect","emoji","char","start","end","nextVal","clamped","clampNameLen","pos","onSubEmojiSelect","max","onSubNameInput","v","cl","segmentGraphemes","seg","n","onRootNameInput","makeEmptyAct","bottomMenuRef","rootItemWidth","wrap","total","addWidth","gap","avail","addRootMenu","onSelectRoot","removeRootMenu","addSubMenu","rootIdx","root","doAdd","onSelectSub","subIdx","removeSubMenu","len","draggingRootSelected","onRootDragStart","onRootDragEnd","m","i","newIdx","draggingSubSelected","onSubDragStart","onSubDragEnd","serializeReplyContent","serializeReplyTypeCodes","map","buildActPayload","act","httpOk","validateReplyList","arr","t","validateActDeep","ri","node","child","toolTime","sid","rid","onSave","rootName","subName","_component_svg_icon","_component_a_switch","_normalizeClass","Tooltip","QuestionCircleOutlined","_hoisted_9","_hoisted_10","Draggable","_withCtx","element","_hoisted_12","_withModifiers","sub","_hoisted_14","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_component_a_popover","Picker","_component_a_tooltip","_hoisted_20","MenuActEditor","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","hasApps","fetchApps","goBind","url","CustomMenu","ListEmpty"],"mappings":"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"}