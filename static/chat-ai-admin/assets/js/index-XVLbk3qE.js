import{r as p,w as j,a as m,b as f,y as c,p as u,t as z,Y as B,F as N,l as P,u as g,h as V,v as q}from"./vue-chunks-BdaA73Wf.js";import{u as y}from"./index-B_UHbFfL.js";import{q as A}from"./other-LrIFyvU9.js";import{u as J}from"../../index-DSFcP5NQ.js";import{_ as R}from"./emoji-mart-BBMRoEa3.js";import{I as S,ab as $,b2 as Y,as as G,b as r}from"./ui-antd-Dl1wwwCD.js";const H={class:"upload-box"},K={class:"mask-box"},Q=["src"],k=3,T={__name:"index",props:{value:{type:[String,Array],default:""}},emits:["update:value"],setup(x,{emit:D}){const{t:l}=J("components.upload-img.index"),_=D,v=p([]),t=p([]),b=p(""),w=x;j(()=>w.value,e=>{t.value=e},{immediate:!0});const U=e=>{if(!(e.type==="image/jpeg"||e.type==="image/png"))return r.error(l("msg_invalid_format")),!1;const i=e.size/1024<1024*2;return t.value.length>=k?r.error(l("msg_max_limit")):i?(y({category:"library_image",file:e}).then(s=>{t.value.push(s.data.link),_("update:value",t.value)}),!1):(r.error(l("msg_size_limit")),!1)},C=e=>{A({images:[e]})},L=e=>{t.value.splice(e,1)};let n=!1;const M=async e=>{if(t.value.length>=k)return r.error(l("msg_max_limit"));if(!(e.clipboardData&&e.clipboardData.items)){r.error(l("msg_paste_not_supported"));return}if(!n)try{if(e.clipboardData||e.originalEvent||window.clipboardData){var o=e.clipboardData||e.originalEvent.clipboardData||window.clipboardData,i=o.items;let s=null;for(let a=0;a<i.length;a++)if(i[a].type.indexOf("image")!==-1){s=i[a].getAsFile();break}b.value="",s?(e.preventDefault(),n=!0,y({category:"library_image",file:s}).then(a=>{n=!1,t.value.push(a.data.link),_("update:value",t.value)})):(r.error(l("msg_paste_invalid_image")),n=!1,b.value="")}}catch{n=!1,r.error(l("msg_upload_failed"))}},d=p(null),E=()=>{d.value.focus()},I=()=>{d.value.blur()};function O(e){}return(e,o)=>{const i=S,s=G;return f(),m("div",H,[c(i,{class:"hidden-input",ref_key:"inputRef",ref:d,onPaste:M},null,512),u("div",{onMouseenter:E,onMouseleave:I},[c(s,{fileList:v.value,"onUpdate:fileList":o[1]||(o[1]=a=>v.value=a),name:"file",multiple:!1,"list-type":"picture","show-upload-list":!1,accept:".jpg,.png,.jpeg","before-upload":U,onDrop:O},{default:z(()=>[u("div",{class:"img-list-box",onClick:o[0]||(o[0]=B(()=>{},["stop"]))},[(f(!0),m(N,null,P(t.value,(a,h)=>(f(),m("div",{class:"img-item",key:h},[u("div",K,[c(g($),{onClick:F=>C(a)},null,8,["onClick"]),c(g(Y),{onClick:F=>L(h)},null,8,["onClick"])]),u("img",{src:a,alt:""},null,8,Q)]))),128))]),u("p",{class:V(["upload-text",{"center-content":t.value.length==0}])},q(g(l)("msg_upload_hint")),3)]),_:1},8,["fileList"])],32)])}}},le=R(T,[["__scopeId","data-v-2e5f9465"]]);export{le as U};
//# sourceMappingURL=index-XVLbk3qE.js.map
