import{b as Z,f as oe,m as pe}from"../../index-CPkdGIiL.js";import{e as we,a as Ce,g as Ie,d as Me,b as Ae,c as $e}from"./index-BxiNNyyE.js";import{f as E,Y as s,_ as l,F as w,a9 as F,ad as ie,a7 as p,u as M,a5 as t,k as o,ai as Te,a2 as n,G as f,ae as D,n as Ke,a1 as K,A as De,J as Y,r as le,a4 as Ee,aj as Se,ab as Be,e as se,w as Le}from"./vue-chunks-Ci-XTWEs.js";import{p as Re,B as ue,F as ve,e as Ne,q as Oe,R as Pe,u as ye,v as ge,I as Ue,M as ne,a as de,w as _e,x as qe,y as re,d as ke,k as he,z as ze,E as Ve,G as Fe,H as Ge}from"./ui-antd-Bw8cEW5z.js";import"./utils-ChQO-_r6.js";const Ye={class:"page-tabs"},Xe=["onClick"],He={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(v,{emit:h}){const{t:i}=oe(),r=h,R=v,c=E([{value:1,title:i("views.user.model.modelsHaveBeenAdded"),langKey:"views.user.model.modelsHaveBeenAdded"},{value:0,title:i("views.user.model.canAddAModel"),langKey:"views.user.model.canAddAModel"}]),A=a=>{r("update:value",a),r("change",a)};return(a,b)=>(l(),s("div",Ye,[(l(!0),s(w,null,F(c.value,C=>(l(),s("div",{class:ie(["tab-item",{active:R.value==C.value}]),onClick:y=>A(C.value),key:C.value},p(M(i)(C.langKey)),11,Xe))),128))]))}},Je=Z(He,[["__scopeId","data-v-cc65f89a"]]),je={class:"model-list"},We={class:"model-item-left"},Qe={class:"model-item-left-top"},Ze=["src"],et={class:"model-name"},tt={class:"model-tags"},lt={key:0,class:"tag"},ot={class:"model-item-left-bottom"},nt={class:"model-desc"},at={class:"model-item-right"},st={__name:"model-list",props:{type:{type:Number,default:()=>1},list:{type:Array,default:()=>[]}},emits:["edit","new","see","remove","add"],setup(v,{emit:h}){const{t:i}=oe(),r=h,R=["azure","ollama","xinference","openaiAgent"],c=v,A=$=>{r("see",Y($))},a=$=>{let g=Y($);r("edit",g,g.config_list[0])},b=$=>{r("new",Y($))},C=$=>{r("add",Y($))},y=$=>{let g=Y($);r("remove",g.config_list[0])};return($,g)=>{const H=Re,T=ue;return l(),s("div",je,[(l(!0),s(w,null,F(c.list,m=>(l(),s("div",{class:"model-item",key:m.model_define},[t("div",We,[t("div",Qe,[t("img",{class:"model-logo",src:m.model_icon_url,alt:""},null,8,Ze),t("div",et,p(m.model_name),1),g[3]||(g[3]=t("div",{class:"line"},null,-1)),t("div",tt,[(l(!0),s(w,null,F(m.support_list,(x,S)=>(l(),s("div",{key:S},[o(H,null,Te({default:n(()=>[x!="SPEECH2TEXT"&&x!="TTS"?(l(),s("span",lt,p(x),1)):D("",!0)]),_:2},[x=="LLM"?{name:"title",fn:n(()=>[g[0]||(g[0]=f("大语言模型，添加机器人时需要选择一个大语言模型。用户的提问将交由大语言模型，结合知识库给出答案。"))]),key:"0"}:x=="TEXT EMBEDDING"?{name:"title",fn:n(()=>[g[1]||(g[1]=f("嵌入模型，添加知识库时需要选择嵌入模型，用于将知识库分段向量化。用户提问时也会将问题生成向量，通过比对向量相似度的方式四配跟提问语义相近的知识库分段。向量检索具备很好的语义分析能力。"))]),key:"1"}:x=="RERANK"?{name:"title",fn:n(()=>[g[2]||(g[2]=f("重排序模型,通过重排序模型,将从知识库中检索出来的分段进行重新排序。再将重排序的结果前top-K传递个大语言模型生成答案。重排序有助于优化检索结果，提高大语言模型回答的准确性。"))]),key:"2"}:void 0]),1024)]))),128))])]),t("div",ot,[t("div",nt,p(m.introduce),1)])]),t("div",at,[Ke(o(T,{class:ie({"btn-red":m.listType==1&&c.type==1}),onClick:x=>y(m)},{default:n(()=>[f(p(m.listType==1&&c.type==1?"移除配置":"删除"),1)]),_:2},1032,["class","onClick"]),[[De,c.type==1]]),c.type==2&&m.model_define!="azure"?(l(),K(T,{key:0,class:"add-btn",onClick:x=>A(m)},{default:n(()=>g[4]||(g[4]=[f("查看模型")])),_:2,__:[4]},1032,["onClick"])):D("",!0),c.type==2?(l(),K(T,{key:1,disabled:m.listType==1,class:"add-btn",onClick:x=>C(m)},{default:n(()=>g[5]||(g[5]=[f("添加配置")])),_:2,__:[5]},1032,["disabled","onClick"])):D("",!0),m.listType==1&&c.type==1?(l(),s(w,{key:2},[R.indexOf(m.model_define)>-1?(l(),s(w,{key:0},[o(T,{class:"add-btn",onClick:x=>A(m)},{default:n(()=>[f(p(M(i)("views.user.model.modelConfigButton"))+"（"+p(m.config_list.length)+"）",1)]),_:2},1032,["onClick"]),o(T,{class:"add-btn",onClick:x=>b(m)},{default:n(()=>[f(p(M(i)("views.user.model.addModelButton")),1)]),_:2},1032,["onClick"])],64)):(l(),s(w,{key:1},[o(T,{class:"add-btn",onClick:x=>a(m)},{default:n(()=>[f(p(M(i)("views.user.model.editModelButton")),1)]),_:2},1032,["onClick"]),o(T,{class:"add-btn",onClick:x=>A(m)},{default:n(()=>[f(p(M(i)("views.user.model.viewModelButton")),1)]),_:2},1032,["onClick"])],64))],64)):D("",!0)])]))),128))])}}},dt=Z(st,[["__scopeId","data-v-a5bdea91"]]),U={componentType:"input",placeholder:"",defaultValue:""},it={componentType:"radio",defaultValue:void 0},ut={componentType:"select",defaultValue:void 0},fe={id:{hidden:!0},model_types:{...it,key:"model_types",label:"模型类型",optionsKey:"supported_type",options:[],disabled:!1,rules:[{required:!0,message:"请选择模型类型",trigger:"change"}]},thinking_type:{componentType:"radio2",defaultValue:"0",key:"thinking_type",label:"深度思考",optionsKey:"thinking_type",options:[{label:"支持（类似deepseek r1这种只支持思考模式的模型）",value:"1"},{label:"可选（比如doubao1.6,可以通过接口控制是否启用深度思考模式）",value:"2"},{label:"不支持（比如deepseek v3,模型本身不支持深度思考模式）",value:"0"}],disabled:!1,rules:[{required:!0,message:"请选择深度思考",trigger:"change"}]},deployment_name:{...U,label:"部署名称",placeholder:"请与Azure 部署名称保持一致",rules:[{required:!0,message:"请输入部署名称",trigger:"change"}]},model_name:{...U,label:"模型名称",placeholder:"模型名称请保持一致",rules:[{required:!0,message:"请输入模型名称",trigger:"change"}]},api_endpoint:{...U,label:"API 域名",placeholder:"请输入您的API 域名",rules:[{required:!0,message:"请输入API 域名",trigger:"change"}]},model_context_length:{...U,label:"模型上下文长度",placeholder:"请输入您的模型上下文长度",rules:[{required:!0,message:"请输入模型上下文长度",trigger:"change"}]},model_uid:{...U,label:"模型UID",placeholder:"请输入您的模型UID",rules:[{required:!0,message:"请输入模型UID",trigger:"change"}]},api_key:{...U,label:"API Key",placeholder:"请输入您的API Key",rules:[{required:!0,message:"请输入API Key",trigger:"change"}]},secret_key:{...U,label:"Secret Key",placeholder:"请输入您的Secret Key",rules:[{required:!0,message:"请输入Secret Key",trigger:"change"}]},api_version:{...ut,label:"API 版本",placeholder:"请输入您的API 版本",optionsKey:"api_versions",options:[],rules:[{required:!0,message:"请选择API 版本",trigger:"change"}]},app_id:{...U,label:"appid",placeholder:"请输入appid",rules:[{required:!0,message:"请输入appid",trigger:"change"}]},region:{...U,label:"region",placeholder:"请输入地区",rules:[{required:!0,message:"请输入地区",trigger:"change"}]}};function _t(v,h){if((h=="yiyan"||h=="doubao")&&v=="secret_key")return{...U,label:"Secret Key",placeholder:"请输入您的Secret Key"};if(fe[v])return fe[v];let i={...U};return i.placeholder="请输入您的"+v,i}const rt={columns:[{title:"模型名称",dataIndex:"model_name",key:"model_name",langKey:"views.user.model.model_name"},{title:"模型类型",dataIndex:"model_type",key:"model_type",langKey:"views.user.model.model_type"}],rows:[],showAddBtn:!1},ct={azure:{columns:[{title:"部署名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},ollama:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},openaiAgent:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"API Key",dataIndex:"api_key",key:"api_key",langKey:"views.user.model.api_key"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},xinference:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"服务器地址",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0}},mt=["azure","ollama","xinference","openaiAgent"];function pt(v){if(mt.indexOf(v.model_define)>-1)return v.config_list;{let h=[];return v.llm_model_list||(v.llm_model_list=[]),v.llm_model_list.forEach(i=>{h.push({model_name:i,model_type:"LLM"})}),v.vector_model_list||(v.vector_model_list=[]),v.vector_model_list.forEach(i=>{h.push({model_name:i,model_type:"TEXT EMBEDDING"})}),v.rerank_model_list.forEach(i=>{h.push({model_name:i,model_type:"RERANK"})}),h}}function be(v){let h=["model_define","model_icon_url"],i=ct[v.model_define];return i||(i=rt),h.forEach(r=>{i[r]=v[r]}),i.rows=pt(v),i}const vt={class:"form-wrapper"},ft={class:"model-logo-box"},yt=["src"],gt={key:0,href:"https://www.yuque.com/zhimaxiaoshiwangluo/pggco1/hmwl4gveq4xwa4uw?singleDoc# ",target:"_blank"},kt={class:"form-box"},ht={class:"form-item-label"},bt={key:0},xt={key:1},wt=["href"],Ct={__name:"set-model-alert",emits:["ok"],setup(v,{expose:h,emit:i}){const{t:r}=oe(),R=i,c=ve.useForm,A=E(""),a=le({model_icon_url:"",model_define:"",model_name:""}),b=E(!1),C=E({}),y=E({}),$=E([]),g=["ollama","xinference","openaiAgent"],H=(I,_)=>{C.value={},y.value={},$.value=[];const{model_icon_url:Q,model_define:X,model_name:J,history_config_params:q}=I;let z=I.config_params;A.value=_?r("common.edit")+" "+J:r("common.add")+" "+J,a.model_icon_url=Q,a.model_define=X,a.model_name=J;let O={},V={},u=[];z.unshift("id"),_&&q&&q.length>0&&(z=[...z,...q]),z.forEach(e=>{e=="model_type"&&(e="model_types"),g.indexOf(I.model_define)>-1&&e=="deployment_name"&&(e="model_name");let d=_t(e,X);d.key=e,d.help_links=I.help_links,d.disabled=!1,d.key=="model_types"&&_&&(d.disabled=!0);let L=d.options;_?(g.indexOf(_.model_define)>-1&&_.deployment_name&&(_.model_name=_.deployment_name),V[e]=_[e]||void 0):V[e]=d.defaultValue,d.optionsKey&&I[d.optionsKey]&&(L=I[d.optionsKey]),d.hidden||u.push({...d,options:L,key:e}),d.rules&&(O[e]=d.rules)}),I.model_define=="doubao"?(_||(V.region="cn-beijing"),u.forEach(e=>{e.key=="deployment_name"&&(e.placeholder="请输入接入点ID")}),O.deployment_name&&O.deployment_name.length&&(O.deployment_name[0].message="请输入接入点ID")):O.deployment_name&&O.deployment_name.length&&(O.deployment_name[0].message="请输入部署名称"),C.value=O,y.value=V,$.value=u,b.value=!0,setTimeout(()=>{m()},100)},{resetFields:T,clearValidate:m,validate:x,validateInfos:S}=c(y,C),G=()=>{x().then(()=>{y.value.id?W():B()}).catch(I=>{})},j=()=>{T(),m()},N=E(!1),B=()=>{let I=Y(y.value),_=JSON.parse(JSON.stringify(I));_.model_type=_.model_types,_.model_define=a.model_define,g.indexOf(_.model_define)>-1&&_.model_name&&(_.deployment_name=_.model_name,delete _.model_name),N.value=!0,Ce(_).then(()=>{N.value=!1,b.value=!1,de.success(r("common.saveSuccess")),R("ok")}).catch(()=>{N.value=!1})},W=()=>{let I=Y(y.value),_=JSON.parse(JSON.stringify(I));_.model_type=_.model_types,_.model_define=a.model_define,g.indexOf(_.model_define)>-1&&_.model_name&&(_.deployment_name=_.model_name,delete _.model_name),N.value=!0,we(_).then(()=>{N.value=!1,b.value=!1,de.success(r("common.saveSuccess")),R("ok")}).catch(()=>{N.value=!1})};return h({open:H}),(I,_)=>{const Q=Pe,X=Oe,J=ge,q=ye,z=Ue,O=Ne,V=ve,u=ne;return l(),K(u,{class:"add-model-alert",width:"650px",open:b.value,"onUpdate:open":_[0]||(_[0]=e=>b.value=e),title:A.value,confirmLoading:N.value,onOk:G,onCancel:j,maskClosable:!1},{default:n(()=>[t("div",vt,[t("div",ft,[t("img",{class:"model-logo",src:a.model_icon_url,alt:""},null,8,yt),a.model_define=="doubao"?(l(),s("a",gt,"查看使用说明>")):D("",!0)]),t("div",kt,[o(V,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:n(()=>[(l(!0),s(w,null,F($.value,e=>(l(),s(w,{key:e.key},[e.hidden?D("",!0):(l(),K(O,Ee({key:0,ref_for:!0},M(S)[e.key]),{label:n(()=>[t("div",ht,[a.model_define=="doubao"&&e.key=="deployment_name"?(l(),s("span",bt,"接入点ID")):(l(),s("span",xt,p(M(r)("views.user.model."+e.key)),1))])]),default:n(()=>[e.componentType=="radio"?(l(),K(X,{key:0,value:y.value[e.key],"onUpdate:value":d=>y.value[e.key]=d,disabled:e.disabled},{default:n(()=>[(l(!0),s(w,null,F(e.options,(d,L)=>(l(),K(Q,{value:d,key:L},{default:n(()=>[t("span",null,p(d),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):D("",!0),e.componentType=="radio2"?(l(),K(X,{key:1,value:y.value[e.key],"onUpdate:value":d=>y.value[e.key]=d,disabled:e.disabled},{default:n(()=>[(l(!0),s(w,null,F(e.options,(d,L)=>(l(),K(Q,{style:{"line-height":"32px"},value:d.value,key:d.value},{default:n(()=>[t("span",null,p(d.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):D("",!0),e.componentType=="select"?(l(),K(q,{key:2,value:y.value[e.key],"onUpdate:value":d=>y.value[e.key]=d,placeholder:e.placeholder},{default:n(()=>[(l(!0),s(w,null,F(e.options,(d,L)=>(l(),K(J,{value:d,key:L},{default:n(()=>[t("span",null,p(d),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):D("",!0),e.componentType=="input"?(l(),s(w,{key:3},[o(z,{value:y.value[e.key],"onUpdate:value":d=>y.value[e.key]=d,placeholder:e.placeholder},null,8,["value","onUpdate:value","placeholder"]),e.key=="api_key"?(l(),s("a",{key:0,href:e.help_links,target:"_blank"},p(M(r)("views.user.model.getApikeyText")),9,wt)):D("",!0)],64)):D("",!0)]),_:2},1040))],64))),128))]),_:1})])])]),_:1},8,["open","title","confirmLoading"])}}},It=Z(Ct,[["__scopeId","data-v-d7fcdeb0"]]),Mt={class:"form-wrapper"},At={class:"tools-wrapper"},$t=["src"],Tt={class:"tools-box"},Kt={class:"list-box"},Dt=["onClick"],Et=["onClick"],St={__name:"see-model-alert",emits:["new","edit","remove"],setup(v,{expose:h,emit:i}){const{t:r}=oe(),R=i,c=E(!1),A=["ollama","xinference","openaiAgent"],a=le({model_icon_url:"",model_define:"",columns:[],rows:[],showAddBtn:!1});let b=Se({});const C=T=>{b=T;let m=be(T);for(let x in m)a[x]=m[x];c.value=!0},y=()=>{c.value=!1,R("new",{...b})},$=T=>{c.value=!1,R("edit",{...b},Y(T))},g=T=>{c.value=!1,R("remove",Y(T))},H=()=>{};return h({open:C}),(T,m)=>{const x=ue,S=qe,G=_e,j=re,N=ne;return l(),K(N,{class:"add-model-alert",width:"800px",open:c.value,"onUpdate:open":m[0]||(m[0]=B=>c.value=B),title:M(r)("views.user.model.modelConfigButton"),footer:null,onOk:H},{default:n(()=>[t("div",Mt,[t("div",At,[t("img",{class:"model-logo",src:a.model_icon_url,alt:""},null,8,$t),t("div",Tt,[a.showAddBtn?(l(),K(x,{key:0,type:"primary",onClick:y},{default:n(()=>[f(p(M(r)("views.user.model.addModel")),1)]),_:1})):D("",!0)])]),t("div",Kt,[o(j,{"data-source":a.rows,scroll:{y:400},pagination:!1},{default:n(()=>[(l(!0),s(w,null,F(a.columns,B=>(l(),s(w,{key:B.key},[B.key=="action"?(l(),K(G,{key:0,title:M(r)("common.action"),"data-index":B.key,width:"140px"},{default:n(({record:W})=>[t("span",null,[t("a",{onClick:I=>$(W)},p(M(r)("common.edit")),9,Dt),o(S,{type:"vertical"}),t("a",{onClick:I=>g(W)},p(M(r)("common.remove")),9,Et)])]),_:2},1032,["title","data-index"])):(l(),K(G,{key:1,title:M(r)("views.user.model."+(A.indexOf(a.model_define)>-1&&B.key=="deployment_name"?"model_name":B.key)),"data-index":B.key},null,8,["title","data-index"]))],64))),128))]),_:1},8,["data-source"])])])]),_:1},8,["open","title"])}}},Bt=Z(St,[["__scopeId","data-v-cb6626b7"]]),Lt={__name:"buy-record",props:{list:{type:Array,default:()=>[]}},setup(v,{expose:h}){const i=E(!1),r=c=>c<=0?"--":ke(c*1e3).format("YYYY/MM/DD HH:mm:ss");return h({show:()=>{i.value=!0}}),(c,A)=>{const a=_e,b=re,C=ne;return l(),s("div",null,[o(C,{open:i.value,"onUpdate:open":A[0]||(A[0]=y=>i.value=y),title:"购买记录",footer:null,width:896},{default:n(()=>[o(b,{style:{"margin-top":"16px"},"data-source":v.list},{default:n(()=>[o(a,{key:"create_time",title:"购买时间","data-index":"create_time"},{default:n(({record:y})=>[f(p(r(y.create_time)),1)]),_:1}),o(a,{key:"buy_total",title:"购买积分数","data-index":"buy_total"}),o(a,{key:"use_total",title:"已消耗","data-index":"use_total"}),o(a,{key:"expire_total",title:"已过期","data-index":"expire_total"}),o(a,{key:"surplus_total",title:"剩余额度","data-index":"surplus_total"}),o(a,{key:"expire_time",title:"到期时间","data-index":"expire_time"},{default:n(({record:y})=>[f(p(r(y.expire_time)),1)]),_:1}),o(a,{key:"remark_outer",title:"备注","data-index":"remark_outer"})]),_:1},8,["data-source"])]),_:1},8,["open"])])}}},Rt={class:"modal-box"},Nt={__name:"kefu-modal",setup(v,{expose:h}){const i=E(!1);return h({show:()=>{i.value=!0}}),(R,c)=>{const A=he,a=ne;return l(),s("div",null,[o(a,{open:i.value,"onUpdate:open":c[0]||(c[0]=b=>i.value=b),title:"购买资源包",footer:null,width:546},{default:n(()=>[t("div",Rt,[o(A,{"show-icon":"",message:"暂不支持线上购买，请扫码联系客服购买"}),c[1]||(c[1]=t("div",{class:"img-box"},[t("img",{src:"https://xkf-upload-oss.xiaokefu.com.cn/static/kefu.png",alt:""})],-1))])]),_:1},8,["open"])])}}},Ot=Z(Nt,[["__scopeId","data-v-7c6c634f"]]),Pt={class:"user-model-page"},Ut={class:"list-wrapper"},qt={key:0,class:"alert-content-box"},zt={key:1,class:"content-body-box"},Vt={class:"model-group-box"},Ft=["onClick"],Gt=["src"],Yt={class:"model-name"},Xt={class:"model-content-box"},Ht={class:"statics-block"},Jt={class:"statics-item"},jt={class:"num"},Wt={class:"statics-item"},Qt={class:"num"},Zt={class:"statics-item"},el={class:"num"},tl={class:"btn-block"},ll={class:"search-block"},ol={class:"search-item"},nl={class:"search-item"},al={class:"list-box"},sl={class:"opration-block"},dl={class:"list-box"},il=["onClick"],ul=["onClick"],_l={class:"aleat-box"},rl={class:"alert-description"},cl={key:0,class:"text"},ml={class:"btn-box"},pl={class:"list-box"},vl={key:0},fl={key:1},yl={__name:"index",setup(v){const h=Be().query,{t:i}=oe(),r=E(+h.activeTab>=0?+h.activeTab:1),R=()=>{},c=E([]),A=E([]),a=E(""),b=le({all_surplus:0,all_use:0,min_expiretime:"",list:[]}),C=le({model_supplier:void 0,model_type:void 0}),y=()=>{$e().then(u=>{b.all_surplus=u.data.all_surplus,b.all_use=u.data.all_use,b.list=u.data.list||[],b.min_expiretime=u.data.min_expiretime>0?ke(u.data.min_expiretime*1e3).format("YYYY-MM-DD"):"--"})},$=E(null),g=E(null),H=()=>{y(),g.value.show()};let T={tongyi:"通义千问",deepseek:"DeepSeek",doubao:"豆包"},m={LLM:"大语言模型","TEXT EMBEDDING":"嵌入模型",RERANK:"重排序模型"};const x=()=>{Ae({...C}).then(u=>{if(!u.data){A.value=[];return}A.value=u.data.map(e=>({...e,model_supplier_desc:T[e.model_supplier],model_type_desc:m[e.model_type]}))})},S=se(()=>c.value.filter(u=>u.model_define==a.value)[0]||{}),G=le({columns:[],rows:[]}),j=u=>{a.value=u.model_define,setTimeout(()=>{N()},50)},N=()=>{let u=be(S.value);for(let e in u)G[e]=u[e]},B=se(()=>c.value.filter(u=>u.listType==1));Le(()=>B,()=>{B.value.filter(u=>u.model_define==a.value).length==0&&(a.value=B.value[0].model_define,j(B.value[0]))},{deep:!0});const W=se(()=>c.value),I=()=>{Ie().then(u=>{let e=u.data||[];e.forEach(d=>{d.listType=d.config_list.length>0?1:0}),e.sort((d,L)=>d.listType-L.listType),c.value=e})};I();const _=E(null),Q=u=>{_.value.open(u)},X=u=>{q.value.open(u)},J=u=>{q.value.open(u)},q=E(null),z=(u,e)=>{q.value.open(u,e)},O=()=>{I()},V=u=>{ne.confirm({title:i("views.user.model.deleteModel"),icon:o(Ge),content:i("views.user.model.deleteModelContent"),onOk(){Me({id:u.id}).then(()=>{de.success(i("common.deleteSuccessful")),I()})}})};return(u,e)=>{const d=he,L=ue,ee=ge,ce=ye,P=_e,ae=re,xe=Ve;return l(),s(w,null,[t("div",Pt,[o(Je,{value:r.value,"onUpdate:value":e[0]||(e[0]=k=>r.value=k),onChange:R},null,8,["value"]),t("div",Ut,[r.value==0?(l(),s("div",qt,[o(d,{"show-icon":""},{message:n(()=>e[7]||(e[7]=[t("div",{class:"title"},"使用说明",-1),t("div",null," 1、模型主要分为嵌入模型（TEXT EMBEDDING）和大模型（LLM），嵌入模型用于将上传知识库的文本内容进行向量化便于后续检索，大模型用于将检索到的相关知识进行理解后返回答案。 ",-1),t("div",null,"2、配置模型时尽量选择同时支持LLM和TEXT EMBEDDING的模型，否则要配置多个模型。",-1),t("div",null," 3、国内模型厂商一般都需要认证后才可使用，所以在配置模型前，确保在模型服务厂商那里已认证，否则配置模型时会提示配置参数错误。 ",-1)])),_:1})])):D("",!0),r.value==1?(l(),s("div",zt,[t("div",Vt,[(l(!0),s(w,null,F(B.value,k=>(l(),s("div",{class:ie(["model-list-item",{active:k.model_define==a.value}]),onClick:te=>j(k),key:k.model_define},[t("img",{class:"avatar",src:k.model_icon_url,alt:""},null,8,Gt),t("div",Yt,p(k.model_name),1)],10,Ft))),128))]),t("div",Xt,[a.value=="chatwiki"?(l(),s(w,{key:0},[t("div",Ht,[t("div",Jt,[e[8]||(e[8]=t("div",{class:"title"},"剩余积分",-1)),t("div",jt,p(M(pe)(b.all_surplus)),1)]),t("div",Wt,[e[9]||(e[9]=t("div",{class:"title"},"累计已使用",-1)),t("div",Qt,p(M(pe)(b.all_use)),1)]),t("div",Zt,[e[10]||(e[10]=t("div",{class:"title"},"最近过期时间",-1)),t("div",el,p(b.min_expiretime),1)]),t("div",tl,[o(L,{type:"primary",onClick:e[1]||(e[1]=k=>$.value.show()),block:""},{default:n(()=>e[11]||(e[11]=[f("购买资源包")])),_:1,__:[11]}),o(L,{onClick:H,block:""},{default:n(()=>e[12]||(e[12]=[f("购买记录")])),_:1,__:[12]})])]),t("div",ll,[t("div",ol,[e[16]||(e[16]=t("span",null,"模型供应商：",-1)),o(ce,{allowClear:"",onChange:x,value:C.model_supplier,"onUpdate:value":e[2]||(e[2]=k=>C.model_supplier=k),placeholder:"请选择模型供应商",style:{width:"172px"}},{default:n(()=>[o(ee,{value:"tongyi"},{default:n(()=>e[13]||(e[13]=[f("通义千问")])),_:1,__:[13]}),o(ee,{value:"deepseek"},{default:n(()=>e[14]||(e[14]=[f("DeepSeek")])),_:1,__:[14]}),o(ee,{value:"doubao"},{default:n(()=>e[15]||(e[15]=[f("豆包")])),_:1,__:[15]})]),_:1},8,["value"])]),t("div",nl,[e[19]||(e[19]=t("span",null,"模型类型：",-1)),o(ce,{allowClear:"",onChange:x,value:C.model_type,"onUpdate:value":e[3]||(e[3]=k=>C.model_type=k),placeholder:"请选择模型类型",style:{width:"172px"}},{default:n(()=>[o(ee,{value:"LLM"},{default:n(()=>e[17]||(e[17]=[f("大语言模型")])),_:1,__:[17]}),o(ee,{value:"TEXT EMBEDDING"},{default:n(()=>e[18]||(e[18]=[f("嵌入模型")])),_:1,__:[18]})]),_:1},8,["value"])])]),t("div",al,[o(ae,{"data-source":A.value},{default:n(()=>[o(P,{key:"uni_model_name",title:"模型","data-index":"uni_model_name"}),o(P,{key:"model_supplier_desc",title:"模型服务商","data-index":"model_supplier_desc"}),o(P,{key:"model_type_desc",title:"模型类型","data-index":"model_type_desc"}),o(P,{key:"price",title:"价格","data-index":"price"},{default:n(({record:k})=>[f(p(k.price)+"积分/千Token",1)]),_:1})]),_:1},8,["data-source"])])],64)):(l(),s(w,{key:1},[["xinference","azure","doubao","openaiAgent","ollama"].includes(a.value)?(l(),s(w,{key:0},[t("div",sl,[o(L,{type:"primary",onClick:e[4]||(e[4]=k=>X(S.value))},{default:n(()=>[o(M(ze)),e[20]||(e[20]=f("添加模型"))]),_:1,__:[20]})]),t("div",dl,[o(ae,{pagination:!1,"data-source":S.value.config_list},{default:n(()=>[o(P,{key:"deployment_name","data-index":"deployment_name"},{title:n(()=>[a.value=="doubao"?(l(),s(w,{key:0},[f("接入点ID")],64)):(l(),s(w,{key:1},[f("模型名称")],64))]),_:1}),a.value=="doubao"?(l(),K(P,{key:"show_model_name",title:"模型名称","data-index":"show_model_name"})):D("",!0),o(P,{key:"model_types",title:"模型类型","data-index":"model_types"},{default:n(({record:k,text:te})=>[f(p(M(m)[te]),1)]),_:1}),a.value=="azure"?(l(),K(P,{key:"api_version",title:"API版本","data-index":"api_version"})):D("",!0),["openaiAgent","ollama"].includes(a.value)?(l(),K(P,{key:"api_endpoint",title:"API 域名","data-index":"api_endpoint"})):D("",!0),o(P,{width:120,key:"action",title:"操作"},{default:n(({record:k})=>[o(xe,{gap:16},{default:n(()=>[t("a",{onClick:te=>z(S.value,k)},"编辑",8,il),t("a",{onClick:te=>V(k)},"移除",8,ul)]),_:2},1024)]),_:1})]),_:1},8,["data-source"])])],64)):(l(),s(w,{key:1},[t("div",_l,[o(d,null,{message:n(()=>[t("div",rl,[S.value.config_list&&S.value.config_list.length?(l(),s("div",cl,[o(M(Fe)),f(" API Key："+p(S.value.config_list[0].api_key.slice(0,10)+"..."),1)])):D("",!0),t("div",ml,[o(L,{onClick:e[5]||(e[5]=k=>z(S.value,S.value.config_list[0])),size:"small"},{default:n(()=>e[21]||(e[21]=[f("修改配置")])),_:1,__:[21]}),o(L,{size:"small",onClick:e[6]||(e[6]=k=>V(S.value.config_list[0]))},{default:n(()=>e[22]||(e[22]=[f("移除配置")])),_:1,__:[22]})])])]),_:1})]),t("div",{class:"message-total-tip",onClick:N}," 支持的模型（"+p(G.rows.length)+"） ",1),t("div",pl,[o(ae,{pagination:!1,"data-source":G.rows},{default:n(()=>[(l(!0),s(w,null,F(G.columns,k=>(l(),K(P,{key:k.key,title:k.title,"data-index":k.dataIndex},{default:n(({record:te,text:me})=>[k.key=="model_type"?(l(),s("div",vl,p(M(m)[me]),1)):(l(),s("div",fl,p(me),1))]),_:2},1032,["title","data-index"]))),128))]),_:1},8,["data-source"])])],64))],64))])])):D("",!0),r.value==0?(l(),K(dt,{list:W.value,type:2,key:"canAddModelList",onAdd:J,onSee:Q},null,8,["list"])):D("",!0)])]),o(Bt,{ref_key:"seeModelAlertRef",ref:_,onNew:X,onEdit:z,onRemove:V},null,512),o(It,{ref_key:"setModelAlertRef",ref:q,onOk:O},null,512),o(Lt,{list:b.list,ref_key:"buyRecordRef",ref:g},null,8,["list"]),o(Ot,{ref_key:"kefuModalRef",ref:$},null,512)],64)}}},wl=Z(yl,[["__scopeId","data-v-760e952e"]]);export{wl as default};
