{"version":3,"file":"index-4WxDiwxj.js","sources":["../../../../front-end/chat-ai-admin-vue/src/stores/modules/search-lirary.js","../../../../front-end/chat-ai-admin-vue/src/views/library-search/components/search-drawer.vue","../../../../front-end/chat-ai-admin-vue/src/views/library-search/components/list-empty.vue","../../../../front-end/chat-ai-admin-vue/src/views/library-search/components/search-box.vue","../../../../front-end/chat-ai-admin-vue/src/components/cu-tabs/contain-tabs.vue","../../../../front-end/chat-ai-admin-vue/src/views/library-search/index.vue"],"sourcesContent":["import { reactive, ref } from 'vue'\r\nimport { defineStore } from 'pinia'\r\nimport {\r\n  searchLirary,\r\n  getLibrarySearch\r\n} from '@/api/library'\r\nimport { getUuid, devLog } from '@/utils/index'\r\nimport { useEventBus } from '@/hooks/event/useEventBus'\r\n\r\nexport const useSearchStore = defineStore('searchStore', {\r\n  state: () => ({\r\n    indeterminate: false,  // 半选\r\n    checkAll: false,  // 是否全选\r\n    checkedList: [],  // 知识搜索选中的模型\r\n    activeKey: 'all', // 知识搜索选中的模型类型 all：全部 0：普通 2：问答\r\n  }),\r\n  getters: {\r\n    getIndeterminate () {\r\n      return this.indeterminate\r\n    },\r\n    getCheckAll () {\r\n      return this.checkAll\r\n    },\r\n    getCheckedList () {\r\n      return this.checkedList\r\n    },\r\n    getActiveKey () {\r\n      return this.activeKey\r\n    }\r\n  },\r\n  actions: {\r\n    setIndeterminate (val) {\r\n      this.indeterminate = val\r\n    },\r\n    setCheckAll (val) {\r\n      this.checkAll = val\r\n    },\r\n    setCheckedList (val) {\r\n      this.checkedList = val\r\n    },\r\n    setActiveKey (val) {\r\n      this.activeKey = val\r\n    }\r\n  },\r\n  persist: {\r\n    enabled: true,\r\n    strategies: [\r\n      {\r\n        key: 'searchStore', // 存储的键名\r\n        storage: localStorage, // 存储位置\r\n        paths: ['indeterminate', 'checkAll', 'checkedList', 'activeKey'] // 可以选择只持久化部分数据\r\n      }\r\n    ]\r\n  }\r\n})\r\n\r\nexport const useSearchLiraryStore = defineStore('search-lirary', () => {\r\n  const emitter = useEventBus()\r\n  const messageObj = reactive({\r\n    reasoning_content: '',\r\n    show_reasoning: false,\r\n    content: '',\r\n    quote_file: [],\r\n    id: '',\r\n    finish: false,\r\n    debug: [],\r\n    error: [],\r\n    recall_time: 0,\r\n    request_time: 0,\r\n    loading: false,\r\n  })\r\n\r\n  let mySSE = null\r\n\r\n  // 对话id\r\n  const dialogue_id = ref(0)\r\n\r\n  const openid = ref('')\r\n\r\n  // 搜索配置的信息\r\n  const searchFormState = reactive({\r\n    context_pair: \"\",\r\n    create_time: \"\",\r\n    id: \"\",\r\n    max_token: \"\",\r\n    model_config_id: \"\",\r\n    rerank_model_config_id: \"\",\r\n    rerank_status: \"\",\r\n    rerank_use_model: \"\",\r\n    search_type: \"\",\r\n    similarity: \"\",\r\n    size: \"\",\r\n    temperature: \"\",\r\n    update_time: \"\",\r\n    use_model: \"\",\r\n    user_id: \"\",\r\n    summary_switch: 0,\r\n  })\r\n\r\n  // 更新AI的消息到列表\r\n  const updateAiMessage = (type, content) => {\r\n    if (type == 'reasoning_content') {\r\n      let oldText = messageObj.reasoning_content || ''\r\n      messageObj.reasoning_content = oldText + content\r\n\r\n      // 推理开始\r\n      // messageObj.reasoning_status = true\r\n      messageObj.show_reasoning = true\r\n    }\r\n\r\n    if (type == 'sending') {\r\n      // 推理结束\r\n      // messageObj.reasoning_status = false\r\n\r\n      let oldText = messageObj.content || ''\r\n      // console.log('sending', content.length, content)\r\n      messageObj.content = oldText + content\r\n    }\r\n\r\n    if (type == 'quote_file') {\r\n      messageObj.quote_file = content.length > 0 ? content : []\r\n    }\r\n\r\n    if (type == 'ai_message') {\r\n      // 【ID1017779】【芝麻AI】机器人直连\r\n      // 在实时聊天的时候，也需要把 ai_message 中的菜单内容显示出来\r\n      if (content.menu_json && content.msg_type == 2) {\r\n        let menu_json_obj = JSON.parse(content.menu_json)\r\n        //messageObj.content = menu_json_obj.content\r\n        messageObj.question = menu_json_obj.question\r\n      }\r\n\r\n      messageObj.id = content.id\r\n\r\n      messageObj.content = content.content\r\n      if (content.quote_file && typeof content.quote_file === 'string') {\r\n        messageObj.quote_file = JSON.parse(content.quote_file)\r\n      }\r\n    }\r\n\r\n    // 回答完毕\r\n    if (type == 'finish') {\r\n      messageObj.finish = true\r\n    }\r\n\r\n    if (type == 'debug') {\r\n      messageObj.debug = content.length > 0 ? content : []\r\n    }\r\n\r\n    if (type == 'error') {\r\n      messageObj.error = content.length > 0 ? content : []\r\n    }\r\n    if (type == 'recall_time') {\r\n      messageObj.recall_time = content || 0\r\n    }\r\n\r\n    if (type == 'request_time') {\r\n      messageObj.request_time = content || 0\r\n    }\r\n\r\n    emitter.emit('updateAiMessage', messageObj)\r\n  }\r\n\r\n  // 关闭AI的消息加载状态\r\n  const closeAiMessageLoading = () => {\r\n    messageObj.loading = false\r\n  }\r\n\r\n  // 搜索\r\n  const searchMessage = (keyword, library_ids, searchConfigData) => {\r\n    let aiMsg = {\r\n      uid: getUuid(32)\r\n    }\r\n\r\n    // 清空之前的内容\r\n    messageObj.content = ''\r\n    messageObj.finish = false\r\n\r\n    let params = {\r\n      model_config_id: searchConfigData.model_config_id,\r\n      use_model: searchConfigData.use_model,\r\n      temperature: searchConfigData.temperature,\r\n      max_token: searchConfigData.max_token,\r\n      size: searchConfigData.size,\r\n      similarity: searchConfigData.similarity,\r\n      search_type: searchConfigData.search_type,\r\n      question: keyword,\r\n      id: library_ids.join(','),\r\n      recall_type: 1,\r\n      summary_switch: searchConfigData.summary_switch,\r\n    }\r\n\r\n    if (searchConfigData.rerank_status) {\r\n      params.rerank_status = searchConfigData.rerank_status\r\n    }\r\n    if (searchConfigData.rerank_use_model) {\r\n      params.rerank_use_model = searchConfigData.rerank_use_model\r\n    }\r\n    if (searchConfigData.prompt) {\r\n      params.prompt = searchConfigData.prompt\r\n    }\r\n\r\n    if (searchConfigData.rerank_status == 1) {\r\n      params.rerank_model_config_id = searchConfigData.rerank_model_config_id\r\n    }\r\n\r\n    // if (import.meta.env.DEV) {\r\n    //   params.debug = 0\r\n    // }\r\n\r\n    mySSE = searchLirary(params)\r\n\r\n    mySSE.onMessage = (res) => {\r\n      if (res.event !== 'sending') {\r\n        devLog(res)\r\n      }\r\n      // 更新对话id\r\n      if (res.event == 'dialogue_id') {\r\n        dialogue_id.value = res.data\r\n      }\r\n\r\n      // 更新机器人深度思考的内容\r\n      if (res.event == 'reasoning_content') {\r\n        updateAiMessage('reasoning_content', res.data, aiMsg.uid)\r\n      }\r\n\r\n      // 更新机器人的消息\r\n      if (res.event == 'sending') {\r\n        updateAiMessage('sending', res.data, aiMsg.uid)\r\n      }\r\n\r\n      // 更新机器人消息的消息id时间等\r\n      if (res.event == 'ai_message') {\r\n        let data = JSON.parse(res.data)\r\n\r\n        updateAiMessage('ai_message', data, aiMsg.uid)\r\n      }\r\n\r\n      // 更新引用文件\r\n      if (res.event == 'quote_file') {\r\n        let data = JSON.parse(res.data)\r\n\r\n        updateAiMessage('quote_file', data, aiMsg.uid)\r\n      }\r\n\r\n      // 更新机器人的消息\r\n      if (res.event == 'finish') {\r\n        updateAiMessage('finish', res.data, aiMsg.uid)\r\n      }\r\n\r\n      // 更新prompt日志\r\n      if (res.event == 'debug') {\r\n        let data = JSON.parse(res.data)\r\n\r\n        updateAiMessage('debug', data, aiMsg.uid)\r\n      }\r\n\r\n      // 更新prompt错误日志\r\n      if (res.event == 'error') {\r\n        let data = res.data\r\n\r\n        updateAiMessage('error', data, aiMsg.uid)\r\n      }\r\n      // 更新prompt recall_time\r\n      if (res.event == 'recall_time') {\r\n        let data = res.data\r\n\r\n        updateAiMessage('recall_time', data, aiMsg.uid)\r\n      }\r\n      // 更新prompt request_time\r\n      // if (res.event == 'request_time') {\r\n      //   let data = res.data\r\n\r\n      //   updateAiMessage('request_time', data, aiMsg.uid)\r\n      // }\r\n    }\r\n\r\n    mySSE.onClose = () => {\r\n      closeAiMessageLoading()\r\n\r\n      mySSE = null\r\n    }\r\n  }\r\n\r\n  // 获取搜索配置\r\n  const getLibrarySearchFn = async () => {\r\n    if (mySSE) {\r\n      mySSE.abort()\r\n      mySSE = null\r\n    }\r\n\r\n    const res = await getLibrarySearch()\r\n\r\n    // \"data\": {\r\n    //   \"context_pair\": \"6\",\r\n    //   \"create_time\": \"1744191057\",\r\n    //   \"id\": \"2\",\r\n    //   \"max_token\": \"2000\",\r\n    //   \"model_config_id\": \"11\",\r\n    //   \"rerank_model_config_id\": \"8\",\r\n    //   \"rerank_status\": \"1\",\r\n    //   \"rerank_use_model\": \"BAAI/bge-reranker-v2-m3\",\r\n    //   \"search_type\": \"1\",\r\n    //   \"similarity\": \"0.6\",\r\n    //   \"size\": \"10\",\r\n    //   \"temperature\": \"0.5\",\r\n    //   \"update_time\": \"1744616719\",\r\n    //   \"use_model\": \"qwen-max\",\r\n    //   \"user_id\": \"1\"\r\n    // }\r\n\r\n    try {\r\n      let _data = res.data\r\n      Object.assign(searchFormState, { ..._data });\r\n    } catch (e) {\r\n      Promise.reject(e)\r\n    }\r\n    return res\r\n  }\r\n\r\n  return {\r\n    searchFormState,\r\n    dialogue_id,\r\n    openid,\r\n    messageObj,\r\n    getLibrarySearchFn,\r\n    searchMessage\r\n  }\r\n})\r\n","<template>\r\n  <a-button v-if=\"searchSets\" @click=\"showDrawer\" :icon=\"h(SettingOutlined)\">{{ t('search_settings') }}</a-button>\r\n  <a-drawer\r\n    v-model:open=\"open\"\r\n    class=\"custom-class\"\r\n    root-class-name=\"root-class-name\"\r\n    :title=\"t('search_settings')\"\r\n    width=\"472\"\r\n    placement=\"right\"\r\n    @after-open-change=\"afterOpenChange\"\r\n  >\r\n    <div class=\"prompt-form\">\r\n      <div class=\"prompt-form-label\">{{ t('model_settings') }}</div>\r\n\r\n      <div class=\"form-item\">\r\n        <div class=\"form-item-label\">\r\n          <a-flex align=\"center\">\r\n            <span>{{ t('ai_intelligent_summary') }}</span>\r\n            <a-tooltip>\r\n              <template #title>{{ t('ai_summary_tooltip') }}</template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n            <a-switch\r\n              style=\"margin-left: 24px\"\r\n              @change=\"onSave\"\r\n              v-model:checked=\"formState.summary_switch\"\r\n              :checkedValue=\"1\"\r\n              :unCheckedValue=\"0\"\r\n              :checkedChildren=\"t('on')\"\r\n              :unCheckedChildren=\"t('off')\"\r\n            />\r\n          </a-flex>\r\n        </div>\r\n      </div>\r\n      <div v-show=\"formState.summary_switch == 1\">\r\n        <div class=\"prompt-form-item\">\r\n          <div class=\"prompt-form-item-label\">\r\n            <span style=\"color: red\">* </span><span>{{ t('model_selection') }}</span>\r\n          </div>\r\n          <ModelSelect\r\n            modelType=\"LLM\"\r\n            v-model:modeName=\"formState.use_model\"\r\n            v-model:modeId=\"formState.model_config_id\"\r\n            style=\"width: 100%\"\r\n            @loaded=\"onVectorModelLoaded\"\r\n            @change=\"handleChangeModel\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"prompt-form-item\">\r\n          <div class=\"prompt-form-item-label\">\r\n            <span style=\"color: red\">* </span><span>{{ t('prompt') }}</span>\r\n          </div>\r\n          <a-radio-group v-model:value=\"formState.prompt_type\" @change=\"handlePromptTypeChange\">\r\n            <a-radio value=\"0\">{{ t('default_prompt') }}</a-radio>\r\n            <a-radio value=\"1\">{{ t('custom_prompt') }}</a-radio>\r\n          </a-radio-group>\r\n          <div class=\"prompt-form-item-content\">\r\n            <div class=\"prompt-form-item-tip\" v-if=\"formState.prompt_type == '0'\">\r\n              {{ t('default_prompt_tip') }}\r\n            </div>\r\n            <a-textarea\r\n              v-else\r\n              @blur=\"onSave\"\r\n              :maxLength=\"500\"\r\n              style=\"height: 80px\"\r\n              v-model:value=\"formState.prompt\"\r\n              :placeholder=\"t('custom_prompt_placeholder')\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"prompt-form-item\">\r\n          <div class=\"prompt-form-item-label\">\r\n            <span>{{ t('temperature') }}</span>\r\n            <a-tooltip>\r\n              <template #title>{{ t('temperature_tooltip') }}</template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"number-box\">\r\n              <div class=\"number-slider-box\">\r\n                <a-slider\r\n                  @blur=\"onSave\"\r\n                  class=\"custom-slider\"\r\n                  v-model:value=\"formState.temperature\"\r\n                  :min=\"0\"\r\n                  :max=\"2\"\r\n                  :step=\"0.1\"\r\n                />\r\n              </div>\r\n              <div class=\"number-input-box\">\r\n                <a-input-number\r\n                  @blur=\"onSave\"\r\n                  v-model:value=\"formState.temperature\"\r\n                  :min=\"0\"\r\n                  :max=\"2\"\r\n                  :step=\"0.1\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"prompt-form-item\">\r\n          <div class=\"prompt-form-item-label\">\r\n            <span>{{ t('max_token') }}</span>\r\n            <a-tooltip>\r\n              <template #title>\r\n                <div>{{ t('max_token_tooltip') }}</div>\r\n              </template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"number-box\">\r\n              <div class=\"number-slider-box\">\r\n                <a-slider\r\n                  @blur=\"onSave\"\r\n                  class=\"custom-slider\"\r\n                  v-model:value=\"formState.max_token\"\r\n                  :min=\"0\"\r\n                  :max=\"100 * 1024\"\r\n                />\r\n              </div>\r\n              <div class=\"number-input-box\">\r\n                <a-input-number\r\n                  @blur=\"onSave\"\r\n                  v-model:value=\"formState.max_token\"\r\n                  :min=\"0\"\r\n                  :max=\"100 * 1024\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- <div class=\"prompt-form-item\">\r\n        <div class=\"prompt-form-item-label\">\r\n          <span>上下文数量</span>\r\n          <a-tooltip>\r\n            <template #title\r\n              >提示词中携带的历史聊天记录轮次。设置为0则不携带聊天记录。最多设置10轮。注意，携带的历史聊天记录越多，消耗的token相应也就越多。</template\r\n            >\r\n            <QuestionCircleOutlined class=\"question-icon\" />\r\n          </a-tooltip>\r\n        </div>\r\n        <div class=\"form-item-body\">\r\n          <div class=\"number-box\">\r\n            <div class=\"number-slider-box\">\r\n              <a-slider\r\n                class=\"custom-slider\"\r\n                v-model:value=\"formState.context_pair\"\r\n                :min=\"0\"\r\n                :max=\"10\"\r\n              />\r\n            </div>\r\n            <div class=\"number-input-box\">\r\n              <a-input-number v-model:value=\"formState.context_pair\" :min=\"0\" :max=\"10\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div> -->\r\n    </div>\r\n\r\n    <div class=\"recall-settings-box\">\r\n      <div class=\"form-box prompt-form\">\r\n        <div class=\"prompt-form-label\">{{ t('recall_settings') }}</div>\r\n\r\n        <div class=\"form-item is-required\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('retrieval_mode') }}</span>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"retrieval-mode-items\">\r\n              <div\r\n                class=\"retrieval-mode-item\"\r\n                :class=\"{ active: formState.search_type == item.value }\"\r\n                v-for=\"item in retrievalModeList\"\r\n                :key=\"item.value\"\r\n                @click=\"handleSelectRetrievalMode(item.value)\"\r\n              >\r\n                <svg-icon\r\n                  class=\"check-arrow\"\r\n                  name=\"check-arrow-filled\"\r\n                  v-if=\"formState.search_type == item.value\"\r\n                ></svg-icon>\r\n\r\n                <div class=\"retrieval-mode-title\">\r\n                  <svg-icon :name=\"item.iconName\" class=\"title-icon\"></svg-icon>\r\n                  <span class=\"title-text\">{{ item.title }}</span>\r\n                  <svg-icon\r\n                    class=\"recommendation-icon\"\r\n                    name=\"recommendation\"\r\n                    v-if=\"item.isRecommendation\"\r\n                  ></svg-icon>\r\n                </div>\r\n\r\n                <div class=\"retrieval-mode-desc\">\r\n                  {{ item.desc }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-item\" v-if=\"formState.search_type == 1\">\r\n          <WeightSelect @save=\"debouncedHandleWeightChange\" v-model:rrf_weight=\"formState.rrf_weight\" />\r\n        </div>\r\n\r\n        <div class=\"form-item\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('top_k') }}&nbsp;</span>\r\n            <a-tooltip>\r\n              <template #title>{{ t('top_k_tooltip') }}</template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"number-box\">\r\n              <div class=\"number-slider-box\">\r\n                <a-slider\r\n                  @blur=\"onSave\"\r\n                  class=\"custom-slider\"\r\n                  v-model:value=\"formState.top_k\"\r\n                  :min=\"1\"\r\n                  :max=\"500\"\r\n                />\r\n              </div>\r\n              <div class=\"number-input-box\">\r\n                <a-input-number @blur=\"onSave\" v-model:value=\"formState.top_k\" :min=\"1\" :max=\"500\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-item\" v-if=\"formState.search_type != 3 && formState.search_type != 4\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('similarity_threshold') }}&nbsp;</span>\r\n            <a-tooltip>\r\n              <template #title>{{ t('similarity_threshold_tooltip') }}</template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n          </div>\r\n          <div class=\"form-item-body\">\r\n            <div class=\"number-box\">\r\n              <div class=\"number-slider-box\">\r\n                <a-slider\r\n                  @blur=\"onSave\"\r\n                  class=\"custom-slider\"\r\n                  v-model:value=\"formState.similarity\"\r\n                  :min=\"0\"\r\n                  :max=\"1\"\r\n                  :step=\"0.01\"\r\n                />\r\n              </div>\r\n              <div class=\"number-input-box\">\r\n                <a-input-number\r\n                  @blur=\"onSave\"\r\n                  v-model:value=\"formState.similarity\"\r\n                  :min=\"0\"\r\n                  :max=\"1\"\r\n                  :step=\"0.01\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-item\">\r\n          <div class=\"form-item-label\">\r\n            <span>{{ t('rerank_model') }}&nbsp;</span>\r\n            <a-tooltip>\r\n              <template #title>{{ t('rerank_model_tooltip') }}</template>\r\n              <QuestionCircleOutlined class=\"question-icon\" />\r\n            </a-tooltip>\r\n\r\n            <a-switch\r\n              @change=\"onSave\"\r\n              style=\"float: right\"\r\n              :checkedValue=\"1\"\r\n              :unCheckedValue=\"0\"\r\n              v-model:checked=\"formState.rerank_status\"\r\n              :checkedChildren=\"t('on')\"\r\n              :unCheckedChildren=\"t('off')\"\r\n            />\r\n          </div>\r\n          <div class=\"form-item-body\" v-if=\"formState.rerank_status == 1\">\r\n            <ModelSelect\r\n              modelType=\"RERANK\"\r\n              v-model:modeName=\"formState.rerank_use_model\"\r\n              v-model:modeId=\"formState.rerank_model_config_id\"\r\n              style=\"width: 100%\"\r\n              :placeholder=\"t('select_rerank_model')\"\r\n              @change=\"onSave\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <a-modal\r\n      v-model:open=\"modalOpen\"\r\n      @cancel=\"handleClose\"\r\n      :title=\"t('custom_prompt_modal_title')\"\r\n      @ok=\"handleOk\"\r\n    >\r\n      <a-textarea\r\n        v-model:value=\"promptVal\"\r\n        :placeholder=\"t('please_input')\"\r\n        style=\"min-height: 300px\"\r\n        allow-clear\r\n      />\r\n    </a-modal>\r\n  </a-drawer>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { ref, h, reactive, onMounted, computed } from 'vue'\r\nimport { SettingOutlined } from '@ant-design/icons-vue'\r\nimport { QuestionCircleOutlined } from '@ant-design/icons-vue'\r\nimport { saveLibrarySearch } from '@/api/library'\r\nimport { message } from 'ant-design-vue'\r\nimport WeightSelect from '@/components/weight-select/index.vue'\r\nimport { useSearchLiraryStore } from '@/stores/modules/search-lirary'\r\nimport ModelSelect from '@/components/model-select/model-select.vue'\r\nimport { usePermissionStore } from '@/stores/modules/permission'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nlet { role_permission, role_type } = usePermissionStore()\r\nconst { t } = useI18n('views.library-search.components.search-drawer')\r\n\r\nconst searchSets = computed(() => role_type == 1 || role_permission.includes('SearchSets'))\r\n\r\nconst searchLiraryStore = useSearchLiraryStore()\r\n\r\nconst { getLibrarySearchFn } = searchLiraryStore\r\n\r\nconst retrievalModeList = ref([\r\n  {\r\n    iconName: 'mix-icon',\r\n    title: t('hybrid_retrieval'),\r\n    value: 1,\r\n    isRecommendation: true,\r\n    desc: t('hybrid_retrieval_desc')\r\n  },\r\n  {\r\n    iconName: 'vector-icon',\r\n    title: t('vector_retrieval'),\r\n    value: 2,\r\n    desc: t('vector_retrieval_desc')\r\n  },\r\n  {\r\n    iconName: 'graph-icon',\r\n    title: t('graph_retrieval'),\r\n    value: 4,\r\n    desc: t('graph_retrieval_desc')\r\n  },\r\n  {\r\n    iconName: 'search-check-icon',\r\n    title: t('full_text_retrieval'),\r\n    value: 3,\r\n    desc: t('full_text_retrieval_desc')\r\n  }\r\n])\r\n\r\nconst open = ref(false)\r\n\r\nconst formState = reactive({\r\n  use_model: '',\r\n  model_config_id: '',\r\n  prompt_type: '0', // 提示词类型 0:默认 1:自定义\r\n  prompt: '', // 提示词 500字符\r\n  temperature: 0.5,\r\n  max_token: 2000,\r\n  context_pair: 0,\r\n  search_type: 1,\r\n  top_k: 5,\r\n  size: 0,\r\n  similarity: 0.4,\r\n  rerank_status: 0,\r\n  rerank_use_model: void 0,\r\n  rerank_model_config_id: void 0,\r\n  summary_switch: 0,\r\n  rrf_weight: {}\r\n})\r\n\r\nconst handleChangeModel = () => {\r\n  onSave()\r\n}\r\n\r\nconst vectorModelList = ref([])\r\nconst onVectorModelLoaded = (list) => {\r\n  vectorModelList.value = list\r\n  if (!formState.model_config_id || !formState.use_model) {\r\n    if (vectorModelList.value.length > 0) {\r\n      let modelConfig = vectorModelList.value[0]\r\n      if (modelConfig) {\r\n        let model = modelConfig.children[0]\r\n        formState.use_model = model.name\r\n        formState.model_config_id = model.model_config_id\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst handleSelectRetrievalMode = (val) => {\r\n  formState.search_type = val\r\n  onSave()\r\n}\r\n\r\nconst updateLibraryInfo = (val) => {\r\n  let newState = { ...val }\r\n  newState.max_token = parseFloat(newState.max_token)\r\n  newState.temperature = parseFloat(newState.temperature)\r\n  newState.context_pair = parseFloat(newState.context_pair)\r\n  newState.search_type = parseFloat(newState.search_type)\r\n  newState.rerank_status = parseFloat(newState.rerank_status)\r\n  newState.similarity = parseFloat(newState.similarity)\r\n  newState.top_k = parseFloat(newState.size)\r\n  newState.summary_switch = +newState.summary_switch\r\n\r\n  if (newState.rerank_use_model === '') {\r\n    // 这里是因为服务端可能会返回个空字符串，我这里改成undefined才有placeholder\r\n    newState.rerank_use_model = void 0\r\n  }\r\n  newState.rrf_weight = newState.rrf_weight ? JSON.parse(newState.rrf_weight) : newState.rrf_weight\r\n  Object.keys(newState).forEach((key) => {\r\n    formState[key] = newState[key]\r\n  })\r\n}\r\n\r\n// 防抖函数实现\r\nconst debounce = (func, wait) => {\r\n  let timeout;\r\n  return function executedFunction(...args) {\r\n    const later = () => {\r\n      clearTimeout(timeout);\r\n      func(...args);\r\n    };\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, wait);\r\n  };\r\n};\r\n\r\nconst handleWeightChange = () => {\r\n  onSave();\r\n}\r\n\r\nconst debouncedHandleWeightChange = debounce(handleWeightChange, 500); // 500ms 延迟\r\n\r\nconst onSave = () => {\r\n  let params = { ...formState }\r\n\r\n  if (!params.prompt && formState.prompt_type == '1') {\r\n    return message.error(t('enter_custom_prompt'))\r\n  }\r\n  params.rrf_weight = JSON.stringify(formState.rrf_weight)\r\n\r\n  if (formState.search_type == 3 || formState.search_type == 4) {\r\n    // 当选择\"知识图谱检索\"和\"全文检索\"类型时，不显示\"相似度阈值\"设置项。\r\n    delete params.similarity\r\n  }\r\n\r\n  if (formState.prompt_type == '0') {\r\n    delete params.prompt\r\n  }\r\n\r\n  params.size = params.top_k\r\n  saveLibrarySearch(params).then((res) => {\r\n    message.success(t('save_success'))\r\n  })\r\n}\r\n\r\nconst modalOpen = ref(false)\r\nconst promptVal = ref('')\r\nconst handlePromptTypeChange = () => {\r\n  if (formState.prompt_type == '1') {\r\n    promptVal.value = formState.prompt\r\n    modalOpen.value = true\r\n  } else {\r\n    onSave()\r\n  }\r\n}\r\n\r\nconst handleOk = () => {\r\n  if (!promptVal.value) {\r\n    return message.error(t('enter_prompt'))\r\n  } else {\r\n    formState.prompt = promptVal.value\r\n    modalOpen.value = false\r\n    onSave()\r\n  }\r\n}\r\n\r\nconst handleClose = () => {\r\n  formState.prompt_type = '0'\r\n  modalOpen.value = false\r\n}\r\n\r\nconst afterOpenChange = (bool) => {\r\n  // console.log('open', bool);\r\n}\r\n\r\nconst showDrawer = async () => {\r\n  let res = await getLibrarySearchFn()\r\n  updateLibraryInfo(res.data)\r\n  open.value = true\r\n}\r\n\r\nonMounted(() => {})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.prompt-form {\r\n  .prompt-form-item {\r\n    margin: 24px 0;\r\n\r\n    .prompt-form-item-label {\r\n      font-size: 14px;\r\n      color: #262626;\r\n    }\r\n  }\r\n\r\n  .prompt-form-label {\r\n    color: #262626;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n    margin-bottom: 16px;\r\n  }\r\n\r\n  .prompt-form-item-tip {\r\n    line-height: 22px;\r\n    font-size: 14px;\r\n    color: #595959;\r\n  }\r\n\r\n  .prompt-form-item-content {\r\n    margin-top: 8px;\r\n  }\r\n\r\n  .question-icon {\r\n    color: #8c8c8c;\r\n    margin-left: 2px;\r\n  }\r\n\r\n  .number-box {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .number-slider-box {\r\n      flex: 1;\r\n    }\r\n\r\n    .number-input-box {\r\n      margin-left: 20px;\r\n    }\r\n  }\r\n}\r\n\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n\r\n.recall-settings-box {\r\n  margin-top: 24px;\r\n\r\n  .form-box {\r\n    .form-item {\r\n      margin-bottom: 24px;\r\n    }\r\n\r\n    .form-item-label {\r\n      line-height: 22px;\r\n      margin-bottom: 4px;\r\n      font-size: 14px;\r\n      color: #262626;\r\n\r\n      .question-icon {\r\n        color: #8c8c8c;\r\n        margin-left: 2px;\r\n      }\r\n    }\r\n\r\n    .is-required {\r\n      .form-item-label::before {\r\n        content: '*';\r\n        padding-right: 2px;\r\n        font-size: 14px;\r\n        color: #fb363f;\r\n      }\r\n    }\r\n\r\n    .number-box {\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      .number-slider-box {\r\n        flex: 1;\r\n      }\r\n\r\n      .number-input-box {\r\n        margin-left: 20px;\r\n      }\r\n    }\r\n\r\n    .retrieval-mode-items {\r\n      .retrieval-mode-item {\r\n        position: relative;\r\n        padding: 16px;\r\n        margin-top: 8px;\r\n        border-radius: 2px;\r\n        border: 1px solid #d9d9d9;\r\n        cursor: pointer;\r\n      }\r\n\r\n      .retrieval-mode-title {\r\n        display: flex;\r\n        align-items: center;\r\n        line-height: 22px;\r\n        margin-bottom: 4px;\r\n        color: #262626;\r\n\r\n        .title-icon {\r\n          margin-right: 4px;\r\n          font-size: 16px;\r\n        }\r\n\r\n        .title-text {\r\n          font-size: 14px;\r\n          font-weight: 600;\r\n        }\r\n\r\n        .recommendation-icon {\r\n          margin-left: 4px;\r\n          font-size: 36px;\r\n        }\r\n      }\r\n\r\n      .retrieval-mode-desc {\r\n        min-height: 44px;\r\n        line-height: 22px;\r\n        font-size: 14px;\r\n        color: #595959;\r\n      }\r\n\r\n      .check-arrow {\r\n        display: none;\r\n      }\r\n    }\r\n\r\n    .retrieval-mode-item.active {\r\n      border: 2px solid #2475fc;\r\n\r\n      .check-arrow {\r\n        position: absolute;\r\n        display: block;\r\n        right: -1px;\r\n        bottom: -1px;\r\n        width: 24px;\r\n        height: 24px;\r\n        font-size: 24px;\r\n        color: #fff;\r\n      }\r\n\r\n      .retrieval-mode-title {\r\n        color: #2475fc;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.model-icon {\r\n  height: 18px;\r\n}\r\n</style>","<template>\r\n  <div class=\"no-data\">\r\n    <svg-icon name=\"empty-document\" :style=\"{'font-size': `${props.size}px`, 'color': 'white'}\" />\r\n    <div class=\"no-data-text\">\r\n      <slot name=\"default\">{{ displayText }}</slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n';\r\nimport { computed } from 'vue';\r\n\r\nconst { t } = useI18n('views.library-search.components.list-empty');\r\n\r\nconst props = defineProps({\r\n  text: String,\r\n  size: {\r\n    type: [Number, String],\r\n    default: 100 \r\n  }\r\n});\r\n\r\nconst displayText = computed(() => props.text || t('no_data'));\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.no-data {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .no-data-text {\r\n    margin-top: 16px;\r\n    font-size: 14px;\r\n    color: #999;\r\n    text-align: center;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"search-box-warpper\">\r\n    <div class=\"search-box-content\">\r\n      <div class=\"search-set-box\">\r\n        <SearchDrawer />\r\n      </div>\r\n      <div class=\"search-content\" v-if=\"!isSearch\">\r\n        <div class=\"search-label\">{{ t('knowledge_search') }}</div>\r\n        <div class=\"search-tip\">{{ t('search_tip') }}</div>\r\n        <div class=\"search-input-box\">\r\n          <!-- <a-input-search\r\n            v-model:value=\"message\"\r\n            :placeholder=\"t('input_placeholder')\"\r\n            style=\"width: 800px\"\r\n            size=\"large\"\r\n            @search=\"onSearch\"\r\n          /> -->\r\n\r\n          <a-input class=\"search-input\" @pressEnter=\"onSearch\" v-model:value=\"message\" allow-clear :placeholder=\"t('input_placeholder')\">\r\n            <template #suffix>\r\n              <div class=\"search-icon-box\" @click=\"onSearch\">\r\n                <svg-icon class=\"search-icon\" name=\"search-right\"></svg-icon>\r\n              </div>\r\n            </template>\r\n          </a-input>\r\n        </div>\r\n      </div>\r\n      <div class=\"search-content search-main\" v-else>\r\n        <div class=\"search-input-box\">\r\n          <a-input class=\"search-input\" @pressEnter=\"onSearch\" v-model:value=\"message\" allow-clear :placeholder=\"t('input_placeholder')\">\r\n            <template #suffix>\r\n              <div class=\"search-icon-box\" @click=\"onSearch\">\r\n                <svg-icon class=\"search-icon\" name=\"search-right\"></svg-icon>\r\n              </div>\r\n            </template>\r\n          </a-input>\r\n        </div>\r\n        <list-empty style=\"margin-top: 100px;\" size=\"250\" v-if=\"!renderedMarkdown && messageObj.finish && !libraryRecall.length\">\r\n          <div>\r\n            <p style=\"color: #262626; font-size: 16px; font-weight: 600; line-height: 24px;\">{{ t('no_content') }}</p>\r\n          </div>\r\n        </list-empty>\r\n        <div class=\"search-content-box\" v-else>\r\n          <div class=\"search-tip-box\">\r\n            <svg-icon class=\"nav-icon\" name=\"search-tip\"></svg-icon>\r\n            <span class=\"tip\" v-if=\"!messageObj.finish\">{{ t('answer_generating') }}</span>\r\n            <span class=\"tip complete\" v-else>{{ t('answer_completed') }}</span>\r\n          </div>\r\n\r\n          <div class=\"container\" v-if=\"!messageObj.content && !messageObj.finish && !isError\">\r\n            <div class=\"rect-container rect1\">\r\n              <div class=\"rect\"></div>\r\n            </div>\r\n            <div class=\"rect-container rect2\">\r\n              <div class=\"rect\"></div>\r\n            </div>\r\n            <div class=\"rect-container rect3\">\r\n              <div class=\"rect\"></div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- 智能回答 -->\r\n          <div class=\"intelligent-answer\" v-else>\r\n            <div v-html=\"renderedMarkdown\" v-if=\"renderedMarkdown\"></div>\r\n            <div v-else>{{ t('no_content') }}</div>\r\n          </div>\r\n\r\n          <!-- 相关分段 (3) -->\r\n          <div class=\"section-box\">\r\n            <div class=\"tips\">\r\n              <div class=\"tips-text\">{{ t('generated_by_model') }}</div>\r\n              <div class=\"tips-line\"></div>\r\n            </div>\r\n            <div v-if=\"libraryRecall.length\" class=\"section-label\">{{ t('related_segments') }} <div>({{ libraryRecall.length }})</div>\r\n            </div>\r\n            <div class=\"section-item\" v-for=\"item in libraryRecall\" :key=\"item.id\">\r\n              <div class=\"section-item-nav\">\r\n                <div class=\"section-item-nav-left\">\r\n                  <svg-icon class=\"section-item-icon\" name=\"document\"></svg-icon>\r\n                  <div class=\"section-item-label\" @click=\"goToFile(item)\">\r\n                    {{ item.file_name }}<span v-if=\"!item.file_name\">{{ item.library_name }}-{{ t('selected') }}</span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"section-item-nav-right\">{{ t('similarity') }}{{ formatNumber(item.similarity) }}</div>\r\n              </div>\r\n              <a-tooltip overlayClassName=\"search-content-tip\" placement=\"top\">\r\n                <template #title>{{ item.content }}</template>\r\n                <div class=\"section-item-content\" v-html=\"highlightKeywords(item.content, message)\"></div>\r\n              </a-tooltip>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch, reactive, onMounted } from 'vue'\r\nimport SearchDrawer from './search-drawer.vue'\r\nimport { showErrorMsg } from '@/utils/index'\r\nimport { libraryRecallTest } from '@/api/library'\r\nimport ListEmpty from './list-empty.vue'\r\nimport MarkdownIt from 'markdown-it';\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.library-search.components.search-box')\r\n\r\nconst emit = defineEmits(['search', 'defaultParmas'])\r\n\r\nconst props = defineProps({\r\n  librarySearchData: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  messageObj: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  library_ids: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  isError: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nconst md = new MarkdownIt({\r\n  html: true,        // 启用 HTML 标签\r\n  linkify: true,     // 自动转换 URL 为链接\r\n  typographer: true // 启用一些排版替换\r\n});\r\nconst renderedMarkdown = ref('');\r\nconst message = ref('')\r\nconst isSearch = ref(false)\r\nconst loading = ref(false)\r\nconst libraryRecall = ref({})\r\n\r\nwatch(() => props.messageObj.content, () => {\r\n  renderedMarkdown.value = md.render(props.messageObj.content);\r\n})\r\n\r\n\r\nwatch(() => props.messageObj.error, (val) => {\r\n  if (val) {\r\n    showErrorMsg(val)\r\n  }\r\n})\r\n\r\nconst onSearch = async () => {\r\n\r\n  if (!props.library_ids.length) {\r\n    return showErrorMsg(t('select_library_error'))\r\n  }\r\n\r\n  if (!message.value) {\r\n    return showErrorMsg(t('input_message_error'))\r\n  }\r\n\r\n  emit('search', message.value)\r\n\r\n  isSearch.value = true\r\n}\r\n\r\nfunction formatNumber(numStr) {\r\n  return numStr.match(/^-?\\d+(?:\\.\\d{0,2})?/)[0];\r\n}\r\n\r\n// 高亮关键词函数\r\nconst highlightKeywords = (content, keyword) => {\r\n  if (!content || !keyword.trim()) return content\r\n  \r\n  // 转义正则特殊字符\r\n  const escapedKeyword = keyword.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\r\n  const regex = new RegExp(`(${escapedKeyword})`, 'gi')\r\n  \r\n  return content.replace(regex, '<span class=\"highlight\">$1</span>')\r\n}\r\n\r\n// 新窗口跳转到文档\r\nconst goToFile = (item) => {\r\n  if(!item.file_name){\r\n    window.open(`#/library/details/categary-manage?id=${item.library_id}`)\r\n    return\r\n  }\r\n  window.open(`#/library/preview?id=${item.file_id}`)\r\n}\r\n\r\nconst librarySearchDataRef = ref(props.librarySearchData)\r\n\r\nconst formState = reactive({\r\n  rerank_status: '',\r\n  rerank_use_model: '',\r\n  prompt: '',\r\n  model_config_id: '',\r\n  use_model: '',\r\n  temperature: 0.5,\r\n  max_token: 2000,\r\n  similarity: 0.4,\r\n  search_type: 1,\r\n  summary_switch: 0,\r\n})\r\n\r\nconst defaultParmas = ref({})\r\n\r\nconst handleRecallTest = (searchObj) => {\r\n  librarySearchDataRef.value = searchObj\r\n  let parmas = {\r\n    model_config_id: searchObj.model_config_id || formState.model_config_id,\r\n    use_model: searchObj.use_model || formState.use_model,\r\n    temperature: searchObj.temperature || formState.temperature,\r\n    max_token: searchObj.max_token || formState.max_token,\r\n    size: 200,  // 固定值\r\n    similarity: searchObj.similarity || formState.similarity,\r\n    search_type: searchObj.search_type || formState.search_type,\r\n    summary_switch: searchObj.summary_switch || formState.summary_switch,\r\n    question: message.value,\r\n    id: props.library_ids.join(','),\r\n    recall_type: 1,\r\n    rrf_weight: searchObj.rrf_weight,\r\n  }\r\n  if (searchObj.rerank_status) {\r\n    parmas.rerank_status = searchObj.rerank_status\r\n  }\r\n  if (searchObj.rerank_use_model) {\r\n    parmas.rerank_use_model = searchObj.rerank_use_model\r\n  }\r\n  if (searchObj.prompt) {\r\n    parmas.prompt = searchObj.prompt\r\n  }\r\n  if (searchObj.rerank_status == 1) {\r\n    parmas.rerank_model_config_id = searchObj.rerank_model_config_id\r\n  }\r\n  loading.value = true\r\n\r\n  defaultParmas.value = Object.assign(parmas)\r\n  emit('defaultParmas', defaultParmas.value)\r\n  libraryRecallTest(parmas)\r\n    .then((res) => {\r\n      libraryRecall.value = res.data\r\n    })\r\n    .catch(() => {\r\n    })\r\n    .finally(() => {\r\n      loading.value = false\r\n    })\r\n}\r\n\r\n\r\nonMounted(async () => {\r\n\r\n\r\n})\r\n\r\ndefineExpose({\r\n  handleRecallTest\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-box-warpper {\r\n  width: 100%;\r\n  height: 100vh;\r\n  overflow-y: auto;\r\n\r\n  .search-box-content {\r\n    position: relative;\r\n\r\n    .search-set-box {\r\n      position: absolute;\r\n      right: 16px;\r\n      top: 16px;\r\n    }\r\n\r\n    .search-content {\r\n      padding-top: 108px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n\r\n      .search-label {\r\n        color: #262626;\r\n        font-size: 36px;\r\n        font-style: normal;\r\n        font-weight: 600;\r\n        line-height: 44px;\r\n        margin-bottom: 16px;\r\n      }\r\n\r\n      .search-tip {\r\n        color: #595959;\r\n        text-align: center;\r\n        font-size: 16px;\r\n        font-style: normal;\r\n        font-weight: 400;\r\n        line-height: 24px;\r\n        margin-bottom: 32px;\r\n      }\r\n\r\n      .search-input-box {\r\n        width: 800px;\r\n\r\n        .search-input {\r\n          height: 58px;\r\n          border-radius: 12px;\r\n\r\n          .search-icon-box {\r\n            display: inline-flex;\r\n            padding: 4px;\r\n            align-items: center;\r\n            gap: 10px;\r\n            border-radius: 6px;\r\n\r\n            &:hover {\r\n              background: #E4E6EB;\r\n              cursor: pointer;\r\n            }\r\n\r\n            .search-icon {\r\n              font-size: 24px;\r\n            }\r\n          }\r\n        }\r\n\r\n        :deep(.ant-input-clear-icon) {\r\n          display: inline-flex;\r\n          padding: 4px;\r\n          align-items: center;\r\n          gap: 10px;\r\n          border-radius: 6px;\r\n\r\n          &:hover {\r\n            background: var(--07, #E4E6EB);\r\n          }\r\n        }\r\n\r\n        :deep(.anticon-close-circle) {\r\n          font-size: 20px;\r\n        }\r\n      }\r\n\r\n      .search-tip-box {\r\n        margin-top: 16px;\r\n        margin-bottom: 12px;\r\n        width: 800px;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 4px;\r\n\r\n        .search-tip {\r\n          font-size: 16px;\r\n        }\r\n\r\n        .tip {\r\n          color: #595959;\r\n          font-size: 14px;\r\n          font-style: normal;\r\n          font-weight: 400;\r\n          line-height: 22px;\r\n        }\r\n\r\n        .complete {\r\n          color: #6524fc;\r\n        }\r\n      }\r\n    }\r\n\r\n    .search-main {\r\n      padding-top: 16px;\r\n    }\r\n  }\r\n}\r\n\r\n.container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n}\r\n\r\n.rect-container {\r\n  overflow: hidden;\r\n  height: 20px;\r\n\r\n  &.rect1 {\r\n    width: 393px;\r\n  }\r\n\r\n  &.rect2,\r\n  &.rect3 {\r\n    width: 800px;\r\n  }\r\n}\r\n\r\n.intelligent-answer {\r\n  width: 800px;\r\n  color: #262626;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 30px;\r\n}\r\n\r\n.rect {\r\n  height: 100%;\r\n  width: 100%;\r\n  border-radius: 24px;\r\n  background: linear-gradient(94deg, #00BFFF 2.9%, #C1C4FF 63.43%, #FFF 98.28%);\r\n  transform-origin: left;\r\n  animation: slide 1s infinite;\r\n\r\n  .rect2 & {\r\n    animation-delay: 0.1s;\r\n  }\r\n\r\n  .rect3 & {\r\n    animation-delay: 0.2s;\r\n  }\r\n}\r\n\r\n@keyframes slide {\r\n  from {\r\n    transform: scaleX(0);\r\n  }\r\n\r\n  to {\r\n    transform: scaleX(1);\r\n  }\r\n}\r\n\r\n.section-box {\r\n  width: 800px;\r\n\r\n  .tips {\r\n    margin-top: 14px;\r\n    line-height: 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    color: #8c8c8c;\r\n    font-size: 12px;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n\r\n    .tips-text {\r\n      padding-right: 5px;\r\n    }\r\n\r\n    .tips-line {\r\n      flex: 1;\r\n      height: 1px;\r\n      border-radius: 1px;\r\n      background: #D9D9D9;\r\n    }\r\n  }\r\n\r\n  .section-label {\r\n    display: flex;\r\n    align-items: center;\r\n    align-self: stretch;\r\n    color: #000000;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n    padding: 24px 0;\r\n  }\r\n\r\n  .section-item {\r\n    cursor: pointer;\r\n    margin-bottom: 24px;\r\n    height: auto;\r\n    align-self: stretch;\r\n    border-radius: 6px;\r\n    border: 1px solid var(--07, #F0F0F0);\r\n    background: #FFF;\r\n    padding: 16px;\r\n\r\n    &:hover {\r\n      background: var(--09, #F2F4F7);\r\n    }\r\n\r\n    .section-item-nav {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      margin-bottom: 8px;\r\n\r\n      .section-item-nav-left {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 3px;\r\n      }\r\n\r\n      .section-item-icon {\r\n        font-size: 20px;\r\n      }\r\n\r\n      .section-item-label {\r\n        color: #262626;\r\n        font-size: 16px;\r\n        font-style: normal;\r\n        font-weight: 600;\r\n        line-height: 24px;\r\n      }\r\n\r\n      .section-item-nav-right {\r\n        color: #8c8c8c;\r\n        font-size: 14px;\r\n        font-style: normal;\r\n        font-weight: 400;\r\n        line-height: 22px;\r\n      }\r\n    }\r\n\r\n    .section-item-content {\r\n      display: -webkit-box;\r\n      -webkit-box-orient: vertical;\r\n      -webkit-line-clamp: 3;\r\n      overflow: hidden;\r\n      color: #595959;\r\n      text-overflow: ellipsis;\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 22px;\r\n    }\r\n  }\r\n}\r\n\r\n:deep(.highlight) {\r\n  color: red !important;\r\n  padding: 0 2px;\r\n}\r\n</style>\r\n\r\n<style lang=\"less\">\r\n.search-content-tip {\r\n  max-width: 800px !important;\r\n\r\n  .ant-tooltip-inner {\r\n    max-width: 800px !important;\r\n    width: max-content !important;\r\n    max-height: 300px !important;\r\n    min-height: 30px !important;\r\n    overflow: hidden !important;\r\n    overflow-y: auto !important;\r\n\r\n    /* 滚动条样式 */\r\n    &::-webkit-scrollbar {\r\n      width: 4px; /*  设置纵轴（y轴）轴滚动条 */\r\n      height: 4px; /*  设置横轴（x轴）轴滚动条 */\r\n    }\r\n    /* 滚动条滑块（里面小方块） */\r\n    &::-webkit-scrollbar-thumb {\r\n      border-radius: 0px;\r\n      background: transparent;\r\n    }\r\n    /* 滚动条轨道 */\r\n    &::-webkit-scrollbar-track {\r\n      border-radius: 0;\r\n      background: transparent;\r\n    }\r\n\r\n    /* hover时显色 */\r\n    &:hover::-webkit-scrollbar-thumb {\r\n      background: rgba(0, 0, 0, 0.2);\r\n    }\r\n    &:hover::-webkit-scrollbar-track {\r\n      background: rgba(0, 0, 0, 0.1);\r\n    }\r\n  }\r\n}\r\n</style>","<style lang=\"less\" scoped>\r\n.cu-tabs {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 2px;\r\n  font-size: 14px;\r\n  color: #262626;\r\n  border-radius: 6px;\r\n  background-color: #f0f2f6;\r\n\r\n  .tab-item {\r\n    position: relative;\r\n    line-height: 22px;\r\n    padding: 5px 28px;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n\r\n    &.active {\r\n      color: #2475fc;\r\n      background-color: #FFFFFF;\r\n    }\r\n\r\n    &:hover {\r\n      color: #2475fc;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"cu-tabs\">\r\n    <div\r\n      class=\"tab-item\"\r\n      :class=\"{ active: props.value === tab.value }\"\r\n      @click=\"handleClickTab(tab.value)\"\r\n      v-for=\"tab in tabs\"\r\n      :key=\"tab.value\"\r\n    >\r\n      {{ tab.title }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nconst emit = defineEmits(['update:value', 'change'])\r\n\r\nconst props = defineProps({\r\n  value: {\r\n    type: [Number, String],\r\n    required: true\r\n  },\r\n  tabs: {\r\n    type: Array,\r\n    required: true,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst handleClickTab = (val) => {\r\n  emit('update:value', val)\r\n  emit('change', val)\r\n}\r\n</script>","<style lang=\"less\" scoped>\r\n.chat-monitor-page {\r\n  display: flex;\r\n  overflow: hidden;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 6px;\r\n}\r\n\r\n.page-left {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  overflow-y: auto;\r\n  background-color: #fff;\r\n  border-right: 1px solid var(--07, #E4E6EB);\r\n\r\n  .toolbar-box {\r\n    margin: 16px 16px 0;\r\n  }\r\n\r\n  .app-list-box {\r\n    padding: 16px 16px 16px 24px;\r\n  }\r\n\r\n  .chat-list-wrapper {\r\n    flex: 1;\r\n    overflow: hidden;\r\n  }\r\n}\r\n\r\n.page-body {\r\n  display: flex;\r\n  flex: 1;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.library-checkbox-box {\r\n\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n\r\n  .list-box {\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: auto;\r\n    margin: 0 16px;\r\n\r\n    .list-item-wraapper {\r\n      display: flex;\r\n      width: 256px;\r\n      height: 40px;\r\n      padding: 9px 8px;\r\n      align-items: center;\r\n      gap: 8px;\r\n      border-radius: 6px;\r\n\r\n      &:hover {\r\n        background: #F2F4F7;\r\n      }\r\n    }\r\n\r\n    .list-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      width: 100%;\r\n\r\n      &:hover {\r\n        cursor: pointer;\r\n      }\r\n\r\n      .list-item-box {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 4px;\r\n\r\n        .library-icon {\r\n          display: flex;\r\n          width: 16px;\r\n          height: 16px;\r\n          line-height: 22px;\r\n          justify-content: center;\r\n          align-items: center;\r\n          border-radius: 3px;\r\n        }\r\n\r\n        .library-name {\r\n          height: 22px;\r\n          flex: 1 0 0;\r\n          overflow: hidden;\r\n          color: #262626;\r\n          text-overflow: ellipsis;\r\n          white-space: nowrap;\r\n          font-size: 14px;\r\n          font-style: normal;\r\n          font-weight: 400;\r\n          line-height: 22px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .list-item :deep(span:last-child) {\r\n      flex: 1;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"chat-monitor-page\">\r\n    <div class=\"page-left\">\r\n      <div class=\"toolbar-box\">\r\n        <ContainTabs :tabs=\"tabs\" v-model:value=\"activeKey\" @change=\"onChangeTab\" />\r\n      </div>\r\n      <div class=\"library-checkbox-box\">\r\n        <div class=\"app-list-box\">\r\n        <a-checkbox v-model:checked=\"state.checkAll\" :indeterminate=\"state.indeterminate\" @change=\"onCheckAllChange\">\r\n            {{ t('select_all') }}\r\n          </a-checkbox>\r\n        </div>\r\n        <a-checkbox-group v-model:value=\"state.checkedList\" @change=\"onCheckListChange\">\r\n          <div class=\"list-box\" ref=\"scrollContainer\">\r\n            <div class=\"list-item-wraapper\" v-for=\"item in plainOptions\" :key=\"item.id\">\r\n              <div class=\"list-item\">\r\n                <a-checkbox :value=\"item.id\"></a-checkbox>\r\n                <div class=\"list-item-box\">\r\n                  <div class=\"library-icon\">\r\n                    <a-image :preview=\"false\" :width=\"32\" :src=\"item.avatar\" />\r\n                  </div>\r\n                  <div class=\"library-name\" @click=\"onGoLibraryInfo(item.id)\">{{ item.library_name }}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </a-checkbox-group>\r\n      </div>\r\n    </div>\r\n    <div class=\"page-body\">\r\n      <SearchBox ref=\"searchBoxRef\" @defaultParmas=\"onDefaultParmas\" @search=\"onSearch\" :isError=\"isError\" :messageObj=\"messageObj\"\r\n        :librarySearchData=\"librarySearchData\" :library_ids=\"state.checkedList\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted, reactive, watch } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport SearchBox from './components/search-box.vue'\r\nimport ContainTabs from '@/components/cu-tabs/contain-tabs.vue'\r\nimport { useSearchLiraryStore } from '@/stores/modules/search-lirary'\r\nimport { getLibraryList } from '@/api/library'\r\nimport { formatFileSize } from '@/utils/index'\r\nimport { LIBRARY_NORMAL_AVATAR, LIBRARY_QA_AVATAR } from '@/constants/index'\r\nimport { useSearchStore } from '@/stores/modules/search-lirary'\r\nimport { showErrorMsg } from '@/utils/index'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.library-search.index')\r\n\r\nconst searchStore = useSearchStore()\r\n\r\nlet {\r\n  getIndeterminate,\r\n  getCheckAll,\r\n  getCheckedList,\r\n  getActiveKey\r\n} = storeToRefs(searchStore)\r\n\r\nconst searchLiraryStore = useSearchLiraryStore()\r\nconst {\r\n  getLibrarySearchFn,\r\n  searchMessage\r\n} = searchLiraryStore\r\n\r\nconst { messageObj } = storeToRefs(searchLiraryStore)\r\n\r\nconst searchBoxRef = ref(null)\r\nconst librarySearchData = ref(null)\r\nconst activeKey = ref('all')\r\nconst tabs = ref([\r\n  {\r\n    title: t('all'),\r\n    value: 'all'\r\n  }, {\r\n    title: t('normal'),\r\n    value: '0'\r\n  },\r\n  {\r\n    title: t('qa'),\r\n    value: '2'\r\n  }\r\n])\r\n\r\nconst defaultParmas = ref({})\r\nconst plainOptions = ref([]);\r\n\r\nconst state = reactive({\r\n  indeterminate: false,\r\n  checkAll: false,\r\n  checkedList: [],\r\n});\r\n\r\nconst onDefaultParmas = (obj) => {\r\n  defaultParmas.value = obj\r\n}\r\n\r\nconst isError = ref(false)\r\nconst onSearch = async (keyword) => {\r\n  // 搜索之前获取最新的配置数据\r\n  isError.value = false\r\n  let res = await getLibrarySearchFn()\r\n  librarySearchData.value = res.data\r\n\r\n  if (!librarySearchData.value.id) {\r\n    librarySearchData.value = Object.assign(defaultParmas.value)\r\n  }\r\n  console.log(librarySearchData.value,'---')\r\n\r\n  if (!librarySearchData.value.model_config_id || !librarySearchData.value.use_model) {\r\n    isError.value = true\r\n    return showErrorMsg(t('configure_before_use'))\r\n  }\r\n\r\n  searchBoxRef.value?.handleRecallTest(librarySearchData.value)\r\n  searchMessage(keyword, state.checkedList, librarySearchData.value)\r\n}\r\n\r\nconst onCheckAllChange = (e) => {\r\n  Object.assign(state, {\r\n    checkedList: e.target.checked ? plainOptions.value.map(item => item.id) : [],\r\n    indeterminate: !!state.checkedList.length && state.checkedList.length < plainOptions.value.length,\r\n  });\r\n\r\n  searchStore.setCheckedList(state.checkedList)\r\n  searchStore.setIndeterminate(state.indeterminate)\r\n};\r\n\r\nconst onCheckListChange = (checkeds) => {\r\n  searchStore.setCheckedList(checkeds)\r\n}\r\n\r\nconst onGoLibraryInfo = (id) => {\r\n  window.open(`#/library/details/knowledge-document?id=${id}`)\r\n}\r\n\r\nwatch(\r\n  () => state.checkedList,\r\n  val => {\r\n    state.indeterminate = !!val.length && val.length < plainOptions.value.length;\r\n    state.checkAll = val.length >= plainOptions.value.length;\r\n\r\n    searchStore.setIndeterminate(state.indeterminate)\r\n    searchStore.setCheckAll(state.checkAll)\r\n  },\r\n);\r\n\r\n\r\nconst updateTabNumber = () => {\r\n  // let all = 0\r\n  // let normal = 0\r\n  // let qa = 0\r\n\r\n  // plainOptions.value.forEach(item => {\r\n  //   if (item.type == 0) {\r\n  //     normal += 1\r\n  //   }\r\n  //   if (item.type == 2) {\r\n  //     qa += 1\r\n  //   }\r\n  //   all += 1\r\n  // })\r\n\r\n  tabs.value = [\r\n    {\r\n      title: t('all'),\r\n      value: 'all'\r\n    },\r\n    {\r\n      title: t('normal'),\r\n      value: '0'\r\n    },\r\n    {\r\n      title: t('qa'),\r\n      value: '2'\r\n    }\r\n  ]\r\n  // tabs.value = [\r\n  //   {\r\n  //     title: '全部 (' + all + ')',\r\n  //     value: 'all' \r\n  //   },\r\n  //   {\r\n  //     title: '普通知识库 (' + normal + ')',\r\n  //     value: '0' \r\n  //   },\r\n  //   {\r\n  //     title: '问答知识库 (' + qa + ')',\r\n  //     value: '2'\r\n  //   }\r\n  // ]\r\n}\r\n\r\n// 判断一个数组里面是否包含另外一个数组的所有数据\r\nconst containsAll = (main, sub) => {\r\n  if (sub.length === 0) return false; // 空子集不认为包含所有\r\n  const mainSet = new Set(main);\r\n  return sub.every(item => mainSet.has(item));\r\n};\r\n\r\n// 判断一个数组里面是否不包含另一个数组的任何值\r\nconst hasIntersection = (mainArray, subArray) => {\r\n  return !subArray.some(item => mainArray.includes(item));\r\n}\r\n\r\nconst getList = async () => {\r\n  let type = activeKey.value === 'all' ? '' : activeKey.value\r\n\r\n  await getLibraryList({ type }).then((res) => {\r\n    let data = res.data || []\r\n\r\n    data.forEach((item) => {\r\n      item.file_size_str = formatFileSize(item.file_size)\r\n\r\n      if (!item.avatar) {\r\n        item.avatar = item.type == 0 ? LIBRARY_NORMAL_AVATAR : LIBRARY_QA_AVATAR\r\n      }\r\n    })\r\n\r\n    plainOptions.value = data;\r\n\r\n    const plainOptionIds = plainOptions.value.map(item => item.id)\r\n\r\n    // 主逻辑优化\r\n    if (getCheckedList.value?.length && plainOptionIds?.length) {\r\n      const checked = getCheckedList.value;\r\n      const options = plainOptionIds;\r\n      \r\n      // 核心状态计算\r\n      const isAllIncluded = containsAll(checked, options);\r\n      const hasCommonItems = hasIntersection(checked, options);\r\n      const isLonger = checked.length >= options.length;\r\n\r\n      // 修正后的状态判断\r\n      const checkAll = isLonger && isAllIncluded;\r\n      const indeterminate = !checkAll && !hasCommonItems; // 关键修正点\r\n\r\n      // 统一状态更新\r\n      const stateUpdate = {\r\n        checkAll,\r\n        indeterminate\r\n      };\r\n      \r\n      searchStore.$patch(stateUpdate);\r\n      Object.assign(state, stateUpdate);\r\n    } else {\r\n      // 处理边界情况：无选中项或选项为空\r\n      const stateUpdate = {\r\n        checkAll: false,\r\n        indeterminate: false\r\n      };\r\n      searchStore.$patch(stateUpdate);\r\n      Object.assign(state, stateUpdate);\r\n    }\r\n\r\n    state.checkedList = getCheckedList.value\r\n    state.indeterminate = getIndeterminate.value\r\n\r\n    // 如果用户没有操作，第一次使用，默认全选\r\n    if (!getCheckAll.value && getCheckedList.value.length == 0 && !getIndeterminate.value && getActiveKey.value == 'all') {\r\n      searchStore.setCheckAll(true)\r\n      state.checkedList = plainOptionIds\r\n      searchStore.setCheckedList(plainOptionIds)\r\n    }\r\n\r\n    if (activeKey.value === 'all') {\r\n      updateTabNumber()\r\n    }\r\n  })\r\n}\r\n\r\nconst onChangeTab = (val) => {\r\n  searchStore.setActiveKey(val)\r\n  getList()\r\n}\r\n\r\nonMounted(async () => {\r\n  if (getActiveKey.value) {\r\n    activeKey.value = getActiveKey.value\r\n  }\r\n  await getList()\r\n  let res = await getLibrarySearchFn()\r\n  librarySearchData.value = res.data\r\n})\r\n\r\nonUnmounted(() => {\r\n\r\n})\r\n</script>\r\n"],"names":["useSearchStore","defineStore","val","useSearchLiraryStore","emitter","useEventBus","messageObj","reactive","mySSE","dialogue_id","ref","openid","searchFormState","updateAiMessage","type","content","oldText","menu_json_obj","closeAiMessageLoading","res","getLibrarySearch","_data","e","keyword","library_ids","searchConfigData","getUuid","params","searchLirary","devLog","data","role_permission","role_type","usePermissionStore","t","useI18n","searchSets","computed","searchLiraryStore","getLibrarySearchFn","retrievalModeList","open","formState","handleChangeModel","onSave","vectorModelList","onVectorModelLoaded","list","modelConfig","model","handleSelectRetrievalMode","updateLibraryInfo","newState","key","debouncedHandleWeightChange","func","wait","timeout","args","later","message","saveLibrarySearch","modalOpen","promptVal","handlePromptTypeChange","handleOk","handleClose","afterOpenChange","bool","showDrawer","onMounted","_createBlock","_component_a_button","h","_unref","SettingOutlined","_createVNode","_component_a_drawer","$event","_createElementVNode","_hoisted_1","_hoisted_2","_toDisplayString","_hoisted_3","_hoisted_4","_component_a_flex","_component_a_tooltip","QuestionCircleOutlined","_component_a_switch","_cache","_hoisted_5","_hoisted_6","ModelSelect","_hoisted_7","_hoisted_8","_component_a_radio_group","_component_a_radio","_hoisted_9","_createElementBlock","_hoisted_10","_component_a_textarea","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_component_a_slider","_hoisted_16","_component_a_input_number","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_vShow","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_Fragment","_renderList","item","_normalizeClass","_component_svg_icon","_hoisted_31","_hoisted_32","_hoisted_33","_openBlock","_hoisted_34","WeightSelect","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_component_a_modal","props","__props","displayText","_normalizeStyle","_renderSlot","_ctx","emit","__emit","md","MarkdownIt","renderedMarkdown","isSearch","loading","libraryRecall","watch","showErrorMsg","onSearch","formatNumber","numStr","highlightKeywords","escapedKeyword","regex","goToFile","librarySearchDataRef","defaultParmas","handleRecallTest","searchObj","parmas","libraryRecallTest","__expose","SearchDrawer","_component_a_input","ListEmpty","_createTextVNode","handleClickTab","tab","searchStore","getIndeterminate","getCheckAll","getCheckedList","getActiveKey","storeToRefs","searchMessage","searchBoxRef","librarySearchData","activeKey","tabs","plainOptions","state","onDefaultParmas","obj","isError","_a","onCheckAllChange","onCheckListChange","checkeds","onGoLibraryInfo","id","updateTabNumber","containsAll","main","sub","mainSet","hasIntersection","mainArray","subArray","getList","getLibraryList","formatFileSize","LIBRARY_NORMAL_AVATAR","LIBRARY_QA_AVATAR","plainOptionIds","checked","options","isAllIncluded","hasCommonItems","checkAll","stateUpdate","onChangeTab","onUnmounted","ContainTabs","_component_a_checkbox","_component_a_checkbox_group","_component_a_image","SearchBox"],"mappings":"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"}