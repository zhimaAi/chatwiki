import{u as st,_ as ut}from"../../index-DSFcP5NQ.js";import{ah as dt,r as L,c as ue,E as V,w as J,j as pt,a as P,y as s,p as v,t as m,u as o,ag as _t,b as D,v as k,_ as T,Y as $,F as Q,l as Z,h as de,z as pe,q as F,D as mt,B as ct,A as yt,e as _e,i as me}from"./vue-chunks-BdaA73Wf.js";import{M as ft}from"./multi-reply-Ck3cS9Gg.js";import{c as gt,e as ce,f as vt,h as ye,i as ht}from"./index-C67uUbSa.js";import{d as H}from"./utils-CvB22N-W.js";import{_ as kt,E as wt,e as bt,P as Mt}from"./emoji-mart-BBMRoEa3.js";import{u as St}from"./robot-CIzNpArp.js";import{b as S,j as Ct,F as Dt,M as xt,k as Lt,c as Yt,I as Pt,V as $t,i as At,f as Rt,g as It,q as Tt,a9 as Ut,aC as Nt,aI as Ot,B as qt,u as Bt,v as Ft,a1 as Et}from"./ui-antd-Dl1wwwCD.js";import"./neo4j-MWxXN7EM.js";import"./editor-cherry-CFIsbKoN.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./other-LrIFyvU9.js";import"./index-B_UHbFfL.js";import"./index-Cg7-0swo.js";const Ht="/assets/img/smart-menu-rule-XgK3l2pz.png",jt={class:"subManage-edit"},zt=["href"],Vt={class:"main"},Jt={class:"left-pane"},Kt={class:"menu-content-box"},Xt={class:"insert-row"},Wt={class:"insert-label"},Gt=["onClick"],Qt={class:"insert-btn"},Zt={class:"title-list"},en=["onDragstart","onDragenter","onDragleave","onDrop"],tn={class:"title-item"},nn={class:"drag-handle"},ln=["onClick"],an=["onUpdate:modelValue","onBlur","onKeyup"],on=["onClick"],rn=["onClick"],sn=["onMousedown"],un=["onMousedown"],dn=["onMousedown"],pn=["onMousedown"],_n={class:"row-icons"},mn={class:"btn-container"},cn={class:"right-pane"},yn=["src"],fn={class:"tip-box",style:{"margin-top":"4px"}},gn={class:"item-box"},vn={class:"tips-box"},hn={class:"tips-box"},kn=10,wn={__name:"add-rule",setup(bn){const{t:n}=st("views.robot.robot-config.smart-menu.add-rule"),fe={span:3},ge={span:21},Y=dt().query,E=L(+Y.rule_id||+Y["rule-id"]||0),ve=_t(),he=ue(()=>`/#/robot/ability/smart-menu?id=${Y.id}&robot_key=${Y.robot_key}`),ke=St(),we=ue(()=>ke.keywordReplySwitchStatus==="1"),ee=L(null),u=V({menu_title:"",menu_description:""}),be={},te=L([]),Me=new wt(bt),K=L(!1),ne=L(null),Se=["yyyy-MM-dd hh:mm:ss","MM-dd hh:mm:ss","yyyy-MM-dd hh:mm","MM-dd hh:mm","yyyy-MM-dd","MM月dd日"];function Ce(t){const e={"yyyy-MM-dd hh:mm:ss":"YYYY-MM-DD HH:mm:ss","MM-dd hh:mm:ss":"MM-DD HH:mm:ss","yyyy-MM-dd hh:mm":"YYYY-MM-DD HH:mm","MM-dd hh:mm":"MM-DD HH:mm","yyyy-MM-dd":"YYYY-MM-DD",MM月dd日:"MM月DD日"};return H().format(e[t]||"YYYY-MM-DD HH:mm:ss")}function le(t){var l,_;const e=(_=(l=ne.value)==null?void 0:l.$el)==null?void 0:_.querySelector("textarea");if(e&&typeof e.selectionStart=="number"){const p=e.selectionStart,y=e.selectionEnd,M=u.menu_description||"";u.menu_description=M.slice(0,p)+t+M.slice(y),me(()=>{e.focus();const r=Math.min(p+t.length,(u.menu_description||"").length);e.setSelectionRange(r,r)})}else u.menu_description=(u.menu_description||"")+t}function De(t){le(`{{${t}}}`)}function xe(t){const e=(t==null?void 0:t.native)||"";e&&(le(e),K.value=!1)}function Le(){return document.body}function Ye(t,e){return e?/^https?:\/\//.test(String(e))?Promise.resolve():Promise.reject(n("msg_link_http_error")):Promise.resolve()}function Pe(t,e){return e?/^wx/.test(String(e))?Promise.resolve():Promise.reject(n("msg_appid_error")):Promise.resolve()}function X(){const t=String(i.keyword||"").trim();t&&ye({id:i.rule_id||0,robot_id:Y.id,keyword:t}).then(e=>{var p,y;const l=(p=e==null?void 0:e.data)==null?void 0:p.is_repeat,_=((y=e==null?void 0:e.data)==null?void 0:y.rule_name)||"";l&&S.error(n("msg_keyword_repeat",{ruleName:_}))})}function $e(t){return(t||[]).map(e=>({...e,status:"1"}))}function Ae(t){const e={text:"2",image:"4",card:"3",imageText:"1",url:"5",smartMenu:"6"};return(t||[]).map(l=>e[l.type]||"").filter(Boolean)}function Re(t,e){return Array.isArray(g.value)&&g.value.length>0?Promise.resolve():Promise.reject(n("msg_add_menu_title"))}const g=L([{id:Date.now(),text:"",isPure:!1,orderDisplay:1,replyConfig:null,editingIndex:!1,orderDisplayStr:""}]),j=L(""),N=L(null),W=L(!1);let A=-1;const U=L(-1);function Ie(t){A=t}function Te(t){if(A===-1||A===t){U.value=t;return}const e=[...g.value],[l]=e.splice(A,1);e.splice(t,0,l),g.value=e,A=t,U.value=t}function Ue(t){U.value===t&&(U.value=-1)}function Ne(t){if(A===t||A<0)return;const e=[...g.value],[l]=e.splice(A,1);e.splice(t,0,l),g.value=e,A=-1,U.value=-1}function Oe(){A=-1,U.value=-1}function qe(t){const e=g.value[t];N.value=(e==null?void 0:e.id)??null}function Be(t){const e=g.value[t];setTimeout(()=>{if(W.value){W.value=!1;return}(N.value??null)===((e==null?void 0:e.id)??null)&&(N.value=null)},0)}function Fe(){W.value=!0}function Ee(t){const e=g.value[t];e.text=n("text_newline"),e.isPure=!0,e.isNewline=!0,e.replyConfig=null,N.value=null}function He(t){const e=g.value[t];e.isPure=!0,e.replyConfig=null}function je(t){const e=g.value.length;if(e>=kn){S.warning(n("msg_menu_title_max"));return}const l=e+1;g.value.splice(t+1,0,{id:Date.now()+Math.random(),text:"",isPure:!1,orderDisplay:l,replyConfig:null,editingIndex:!1,orderDisplayStr:""})}function ze(t){if(g.value.length<=1){S.warning(n("msg_menu_title_min"));return}g.value.splice(t,1)}function Ve(t){const e=g.value[t];e.orderDisplayStr=String(e.orderDisplay||""),e.editingIndex=!0,me(()=>{})}function ae(t){const e=g.value[t],l=parseInt(String(e.orderDisplayStr||"").replace(/\D+/g,""),10);e.orderDisplay=isNaN(l)?e.orderDisplay:Math.max(1,Math.min(10,l)),e.editingIndex=!1}J(g,t=>{try{const e=(t||[]).map(l=>({menu_type:l.isPure?"0":"1",content:String(l.text||"")}));j.value=JSON.stringify(e)}catch{j.value=String((t||[]).length||"")}},{deep:!0,immediate:!0});const O=L(!1),i=V({rule_name:"",match_type:"full",keyword:"",replyList:[{type:"text",description:""}]});let R=-1;function oe(t){var l,_,p,y,M;if(!g.value[t].text){S.error(n("msg_input_menu_title"));return}R=t;const e=g.value[t];i.rule_name=((l=e.replyConfig)==null?void 0:l.rule_name)||String(e.text||""),i.keyword=((_=e.replyConfig)==null?void 0:_.keyword)||String(e.text||""),i.match_type=((p=e.replyConfig)==null?void 0:p.match_type)||"full",i.replyList=Array.isArray((y=e.replyConfig)==null?void 0:y.replyList)?JSON.parse(JSON.stringify(e.replyConfig.replyList)):[{type:"text",description:""}],i.rule_id=((M=e.replyConfig)==null?void 0:M.rule_id)||e.rule_id||"",i.rule_id&&ce({id:i.rule_id}).then(r=>{const f=(r==null?void 0:r.data)||{};i.rule_name=(f==null?void 0:f.name)||i.rule_name;const h=Array.isArray(f==null?void 0:f.full_keyword)?f.full_keyword:[],C=Array.isArray(f==null?void 0:f.half_keyword)?f.half_keyword:[];h.length>0?(i.match_type="full",i.keyword=String(h[0]||"")):C.length>0&&(i.match_type="partial",i.keyword=String(C[0]||""));const d=Array.isArray(f==null?void 0:f.reply_content)?f.reply_content:[];i.replyList=d.map(c=>({type:(c==null?void 0:c.type)||(c==null?void 0:c.reply_type)||"text",description:(c==null?void 0:c.description)||"",thumb_url:(c==null?void 0:c.thumb_url)||(c==null?void 0:c.pic)||"",title:(c==null?void 0:c.title)||"",url:(c==null?void 0:c.url)||"",appid:(c==null?void 0:c.appid)||"",page_path:(c==null?void 0:c.page_path)||"",smart_menu_id:(c==null?void 0:c.smart_menu_id)||"",smart_menu:(c==null?void 0:c.smart_menu)||{}}))}).catch(()=>{}),O.value=!0}async function Je(){if(R<0){O.value=!1;return}const t=String(i.rule_name||"").trim(),e=String(i.keyword||"").trim();if(!t||!e){S.warning(n("msg_complete_rule_keyword"));return}if(!Array.isArray(i.replyList)||i.replyList.length===0){S.warning(n("msg_add_reply_item"));return}for(const l of te.value)if(l&&l.validate&&!await l.validate())return;ye({id:i.rule_id||0,robot_id:Y.id,keyword:e}).then(l=>{var M,r;const _=(M=l==null?void 0:l.data)==null?void 0:M.is_repeat,p=((r=l==null?void 0:l.data)==null?void 0:r.rule_name)||"";if(_)return S.error(n("msg_keyword_repeat",{ruleName:p})),Promise.reject("repeat");const y={robot_id:Y.id,name:t,full_keyword:i.match_type==="full"?[e]:[],half_keyword:i.match_type==="partial"?[e]:[],reply_content:JSON.stringify($e(i.replyList)),reply_type:Ae(i.replyList),reply_num:"0",forced_enable:1};return i.rule_id&&(y.id=i.rule_id),ht(y)}).then(l=>{var y;if(!(l&&l.res==0)){S.error(n("msg_save_failed"));return}const _=((y=l==null?void 0:l.data)==null?void 0:y.id)||"",p={rule_name:i.rule_name,keyword:i.keyword,match_type:i.match_type,replyList:JSON.parse(JSON.stringify(i.replyList)),rule_id:String(_||i.rule_id||"")};g.value[R].replyConfig=p,i.rule_id=p.rule_id,O.value=!1,S.success(n("msg_save_success"))}).catch(l=>{})}function Ke(){O.value=!1}function Xe(){i.replyList.length>=5||i.replyList.push({type:"text",description:""})}function We(t){i.replyList.splice(t,1)}function Ge({reply_index:t,...e}){t>=0&&t<i.replyList.length&&(i.replyList[t]=e)}const q=L(!1),x=V({title:"",appid:"",path:""}),B=L(!1),I=V({title:"",url:""});function ie(t){t==="appid"?window.open("https://www.kancloud.cn/wikizhima/wikixkf/1011121","_blank"):window.open("https://www.kancloud.cn/wikizhima/wikixkf/1010959","_blank")}function Qe(t){R=t;const e=g.value[t],l=String(e.text||"");let _=l,p="",y="";if(/<a[\s\S]*?<\/a>/i.test(l)){const M=l.match(/<a[\s\S]*?>([\s\S]*?)<\/a>/i),r=l.match(/data-miniprogram-appid=['"][\s\S]*?['"]/i),f=l.match(/data-miniprogram-path=['"][\s\S]*?['"]/i);if(M&&M[1]!=null&&(_=M[1]),r){const h=String(r[0]||"").match(/data-miniprogram-appid=['"]\s*([^'"]+)\s*['"]/i);h&&h[1]!=null&&(p=h[1])}if(f){const h=String(f[0]||"").match(/data-miniprogram-path=['"]\s*([^'"]+)\s*['"]/i);h&&h[1]!=null&&(y=h[1])}}x.title=String(_||""),x.appid=String(p||""),x.path=String(y||""),q.value=!0}function Ze(){const t=String(x.title||"").trim(),e=String(x.appid||"").trim(),l=String(x.path||"").trim();if(!t||!e||!l){S.warning(t("msg_complete_mini_card"));return}if(!/^wx/.test(e)){S.warning(t("msg_appid_error"));return}if(R<0){q.value=!1;return}const _=g.value[R];_.text=`<a  href='#' data-miniprogram-path='${l}' data-miniprogram-appid='${e}'  >${t}</a>`,_.linkType="mini",_.replyConfig=null,q.value=!1}function et(){q.value=!1}function tt(t){R=t;const e=g.value[t],l=String(e.text||"");let _=l,p="";if(/<a[\s\S]*?<\/a>/i.test(l)){const y=l.match(/<a[\s\S]*?>([\s\S]*?)<\/a>/i),M=l.match(/href\s*=\s*['"][\s\S]*?['"]/i);if(y&&y[1]!=null&&(_=y[1]),M){const r=String(M[0]||"").match(/href\s*=\s*['"]\s*([^'"]+)\s*['"]/i);r&&r[1]!=null&&(p=r[1])}p&&(p=p.replace(/`/g,"").trim())}I.title=String(_||""),I.url=String(p||""),B.value=!0}function nt(){const t=String(I.title||"").trim(),e=String(I.url||"").trim();if(!t||!e){S.warning(t("msg_complete_link"));return}if(!/^https?:\/\//.test(e)){S.warning(t("msg_link_http_error"));return}if(R<0){B.value=!1;return}const l=g.value[R];l.text=`<a href="${e}">${t}</a>`,l.linkType="url",l.replyConfig=null,B.value=!1}function lt(){B.value=!1}J(()=>u.duration_type,t=>{t==="week"?((!Array.isArray(u.week_day)||u.week_day.length===0)&&(u.week_day=["1"]),u.week_duration=Array.isArray(u.week_day)?u.week_day:[u.week_day]):t==="time_range"&&Array.isArray(u.date_range)&&u.date_range.length===2&&u.date_range[0]&&u.date_range[1]?(u.start_day=H(u.date_range[0]).format("YYYY-MM-DD"),u.end_day=H(u.date_range[1]).format("YYYY-MM-DD")):(u.start_day="",u.end_day="")}),J(()=>u.week_day,t=>{u.duration_type==="week"&&(u.week_duration=Array.isArray(t)?t:[t])}),J(()=>u.date_range,t=>{u.duration_type==="time_range"&&Array.isArray(t)&&t.length===2&&t[0]&&t[1]&&(u.start_day=H(t[0]).format("YYYY-MM-DD"),u.end_day=H(t[1]).format("YYYY-MM-DD"))});const at=()=>{var t;(t=ee.value)==null||t.validate().then(async()=>{if(!u.menu_title||!u.menu_description){S.warning(n("msg_complete_menu_content"));return}const e=g.value.map(_=>{var C,d;const p=!!_.linkType,y=!!_.isPure,M=_.isNewline===!0,r=String(_.text||"");if(M||r==="")return{menu_type:"0",serial_no:"",content:"",rule_id:""};if(p)return{menu_type:"0",serial_no:"",content:r,rule_id:""};if(y)return{menu_type:"0",serial_no:"",content:r,rule_id:""};const f=String(((C=_.replyConfig)==null?void 0:C.id)||((d=_.replyConfig)==null?void 0:d.rule_id)||"");return{menu_type:"1",serial_no:String(_.orderDisplay||""),content:r,rule_id:f}}),l={robot_id:Y.id,menu_title:u.menu_title,menu_description:u.menu_description,menu_content:JSON.stringify(e)};E.value&&(l.id=E.value);try{const _=await vt(l);_&&_.res==0&&(S.success(n("msg_save_success")),ve.push({path:"/robot/ability/smart-menu",query:{id:Y.id,robot_key:Y.robot_key}}))}catch{S.error(n("msg_save_failed"))}})};return pt(async()=>{const t=+(Y.copy_id||0),e=async l=>{const _=await gt({id:l,robot_id:Y.id}),p=(_==null?void 0:_.data)||{};if(u.menu_title=p.menu_title||"",u.menu_description=p.menu_description||p.menu_content||"",Array.isArray(p.menu_content)){const y=p.menu_content;g.value=y.map((r,f)=>{const h=String((r==null?void 0:r.menu_type)||""),C=String((r==null?void 0:r.content)||""),d=/<a[\s\S]*?<\/a>/.test(C),c=d&&/data-miniprogram-appid/i.test(C);return{id:Date.now()+f,text:h==="0"&&C===""?h("text_newline"):C,isPure:h==="0",isNewline:h==="0"&&C==="",orderDisplay:r&&r.serial_no!==void 0&&String(r.serial_no).trim()!==""?Number(r.serial_no):f+1,editingIndex:!1,orderDisplayStr:"",replyConfig:null,linkType:d?c?"mini":"url":"",rule_id:String((r==null?void 0:r.rule_id)||"")}});const M=g.value.map((r,f)=>({idx:f,rid:String(r.rule_id||"")})).filter(r=>!!r.rid);for(const r of M)try{const f=await ce({id:r.rid}),h=(f==null?void 0:f.data)||{},C=Array.isArray(h==null?void 0:h.reply_content)?h.reply_content:[];g.value[r.idx].replyConfig={rule_name:(h==null?void 0:h.name)||String(g.value[r.idx].text||""),keyword:String(g.value[r.idx].text||""),match_type:"full",replyList:C.map(d=>({type:(d==null?void 0:d.type)||(d==null?void 0:d.reply_type)||"text",description:(d==null?void 0:d.description)||"",thumb_url:(d==null?void 0:d.thumb_url)||(d==null?void 0:d.pic)||"",title:(d==null?void 0:d.title)||"",url:(d==null?void 0:d.url)||"",appid:(d==null?void 0:d.appid)||"",page_path:(d==null?void 0:d.page_path)||"",smart_menu_id:(d==null?void 0:d.smart_menu_id)||"",smart_menu:(d==null?void 0:d.smart_menu)||{}})),rule_id:r.rid}}catch{}}};try{if(!E.value&&t){await e(t);return}if(!E.value)return;await e(E.value)}catch{S.error(n("msg_load_failed"))}}),(t,e)=>{const l=Lt,_=Ct,p=Pt,y=Yt,M=$t,r=Tt,f=It,h=Rt,C=At,d=Ut,c=ut,ot=Nt,re=qt,z=Dt,se=Ft,it=Bt,G=xt;return D(),P("div",jt,[s(_,{class:"subManage-breadcrumb"},{default:m(()=>[s(l,null,{default:m(()=>[v("a",{href:he.value},k(o(n)("title_smart_menu")),9,zt)]),_:1}),s(l,null,{default:m(()=>[T(k(o(n)("title_add_rule")),1)]),_:1})]),_:1}),v("div",Vt,[v("div",Jt,[s(z,{ref_key:"formRef",ref:ee,model:u,rules:be,layout:"vertical"},{default:m(()=>[s(y,{name:"menu_title",label:o(n)("label_menu_name"),rules:[{required:!0,message:o(n)("msg_input_menu_name")}]},{default:m(()=>[s(p,{value:u.menu_title,"onUpdate:value":e[0]||(e[0]=a=>u.menu_title=a),placeholder:o(n)("ph_input")},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(y,{name:"menu_description",label:o(n)("label_menu_content"),rules:[{required:!0,message:o(n)("msg_input_menu_content")}]},{default:m(()=>[v("div",Kt,[s(M,{ref_key:"menuContentRef",ref:ne,value:u.menu_description,"onUpdate:value":e[1]||(e[1]=a=>u.menu_description=a),rows:6,placeholder:o(n)("ph_menu_content")},null,8,["value","placeholder"]),v("div",Xt,[v("span",Wt,k(o(n)("label_insert")),1),s(C,null,{overlay:m(()=>[s(h,null,{default:m(()=>[(D(),P(Q,null,Z(Se,a=>s(f,{key:a},{default:m(()=>[s(r,{title:Ce(a)},{default:m(()=>[v("a",{onClick:$(w=>De(a),["prevent"])},k(a),9,Gt)]),_:2},1032,["title"])]),_:2},1024)),64))]),_:1})]),default:m(()=>[v("a",{class:"insert-btn",onClick:e[2]||(e[2]=$(()=>{},["prevent"]))},k(o(n)("btn_time")),1)]),_:1}),s(d,{open:K.value,"onUpdate:open":e[3]||(e[3]=a=>K.value=a),placement:"bottomLeft",trigger:"click",getPopupContainer:Le},{content:m(()=>[s(o(Mt),{data:o(Me),emojiSize:18,showPreview:!1,set:"apple",onSelect:xe},null,8,["data"])]),default:m(()=>[v("a",Qt,k(o(n)("btn_emoji")),1)]),_:1},8,["open"])])])]),_:1},8,["label","rules"]),s(y,{name:"menu_content",label:o(n)("label_menu_title"),rules:[{validator:Re}]},{default:m(()=>[s(p,{value:j.value,"onUpdate:value":e[4]||(e[4]=a=>j.value=a),style:{display:"none"}},null,8,["value"]),s(ot,null,{default:m(()=>[v("div",Zt,[(D(!0),P(Q,null,Z(g.value,(a,w)=>(D(),P("div",{class:de(["title-row",{"drag-over":U.value===w}]),key:a.id,draggable:"true",onDragstart:b=>Ie(w),onDragover:e[6]||(e[6]=$(()=>{},["prevent"])),onDragenter:$(b=>Te(w),["prevent"]),onDragleave:b=>Ue(w),onDrop:$(b=>Ne(w),["prevent"]),onDragend:Oe},[v("div",tn,[v("div",nn,[s(o(Ot))]),!a.isPure&&!a.linkType?pe((D(),P("div",{key:0,class:"index-badge",onClick:b=>Ve(w)},k(a.orderDisplay),9,ln)),[[mt,!a.editingIndex]]):F("",!0),!a.isPure&&!a.linkType&&a.editingIndex?pe((D(),P("input",{key:1,class:"index-input-edit",type:"number",min:"1",max:"10",inputmode:"numeric",autofocus:"","onUpdate:modelValue":b=>a.orderDisplayStr=b,onBlur:b=>ae(w),onKeyup:ct(b=>ae(w),["enter"])},null,40,an)),[[yt,a.orderDisplayStr]]):F("",!0),v("div",{class:de(["input-box",{focused:N.value===a.id}])},[s(p,{value:a.text,"onUpdate:value":b=>a.text=b,disabled:a.isNewline===!0,placeholder:o(n)("ph_menu_title"),maxLength:"40",onFocus:b=>qe(w,b),onBlur:b=>Be(w)},{suffix:m(()=>{var b;return[!a.isPure&&!a.linkType&&((b=a.replyConfig)!=null&&b.rule_id||a.rule_id||a.replyConfig)?(D(),P("a",{key:0,class:"suffix-action",onClick:rt=>oe(w)},k(o(n)("btn_edit")),9,on)):!a.isPure&&!a.linkType&&!we.value?(D(),_e(r,{key:1},{title:m(()=>[T(k(o(n)("tip_need_auto_reply")),1)]),default:m(()=>[v("a",{class:"suffix-action disabled",onClick:e[5]||(e[5]=$(()=>{},["prevent"]))},k(o(n)("btn_add_reply")),1)]),_:1})):!a.isPure&&!a.linkType?(D(),P("a",{key:2,class:"suffix-action",onClick:rt=>oe(w)},k(o(n)("btn_add_reply")),9,rn)):F("",!0)]}),_:2},1032,["value","onUpdate:value","disabled","placeholder","onFocus","onBlur"]),N.value===a.id?(D(),P("div",{key:0,class:"float-toolbar",onMousedown:$(Fe,["stop"])},[v("a",{onMousedown:$(b=>Qe(w),["prevent","stop"])},k(o(n)("btn_insert_mini_link")),41,sn),v("a",{onMousedown:$(b=>tt(w),["prevent","stop"])},k(o(n)("btn_insert_url_link")),41,un),!a.isPure&&!a.linkType?(D(),P("a",{key:0,onMousedown:$(b=>He(w),["prevent","stop"])},k(o(n)("btn_to_plain_text")),41,dn)):F("",!0),!a.isPure&&!a.linkType?(D(),P("a",{key:1,onMousedown:$(b=>Ee(w),["prevent","stop"])},k(o(n)("btn_newline")),41,pn)):F("",!0)],32)):F("",!0)],2)]),v("div",_n,[s(c,{onClick:b=>je(w),name:"smart-add",size:"16",style:{color:"#8C8C8C",cursor:"pointer"}},null,8,["onClick"]),s(c,{onClick:b=>ze(w),name:"smart-delete",size:"16",style:{color:"#8C8C8C",cursor:"pointer"}},null,8,["onClick"])])],42,en))),128))])]),_:1})]),_:1},8,["label","rules"]),v("div",mn,[s(re,{type:"primary",onClick:at},{default:m(()=>[T(k(o(n)("btn_save")),1)]),_:1})])]),_:1},8,["model"])]),v("div",cn,[v("img",{src:o(Ht),alt:"smart-menu-preview",class:"preview-smart-img"},null,8,yn)])]),s(G,{open:O.value,"onUpdate:open":e[10]||(e[10]=a=>O.value=a),title:`${i.rule_id?o(n)("title_edit_menu_reply"):o(n)("title_add_menu_reply")}`,width:720,onOk:Je,onCancel:Ke},{default:m(()=>[s(z,{model:i,layout:"vertical",class:"reply-modal-form"},{default:m(()=>[s(y,{label:o(n)("label_rule_name"),name:"rule_name",rules:[{required:!0,message:o(n)("msg_input_rule_name")}]},{default:m(()=>[s(p,{value:i.rule_name,"onUpdate:value":e[7]||(e[7]=a=>i.rule_name=a)},null,8,["value"])]),_:1},8,["label","rules"]),s(y,{label:o(n)("label_keyword"),name:"keyword",rules:[{required:!0,message:o(n)("msg_input_keyword")}]},{default:m(()=>[s(p,{value:i.keyword,"onUpdate:value":e[9]||(e[9]=a=>i.keyword=a),maxlength:30,placeholder:o(n)("ph_keyword"),onFocus:X,onPressEnter:X,onBlur:X},{addonBefore:m(()=>[s(it,{value:i.match_type,"onUpdate:value":e[8]||(e[8]=a=>i.match_type=a),style:{width:"120px"}},{default:m(()=>[s(se,{value:"full"},{default:m(()=>[T(k(o(n)("select_full_match")),1)]),_:1}),s(se,{value:"partial"},{default:m(()=>[T(k(o(n)("select_partial_match")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["value","placeholder"]),v("div",fn,k(o(n)("tip_keyword_max_length")),1)]),_:1},8,["label","rules"]),s(y,{name:"replyList",label:o(n)("label_reply_content"),rules:[{required:!0,message:""}]},{default:m(()=>[v("div",gn,[(D(!0),P(Q,null,Z(i.replyList,(a,w)=>(D(),_e(ft,{key:w,ref_for:!0,ref_key:"replyRefs",ref:te,value:i.replyList[w],"onUpdate:value":b=>i.replyList[w]=b,reply_index:w,show_smart:!0,onChange:Ge,onDel:We},null,8,["value","onUpdate:value","reply_index"]))),128)),s(re,{type:"dashed",style:{width:"100%"},disabled:i.replyList.length>=5,onClick:Xe},{icon:m(()=>[s(o(Et))]),default:m(()=>[T(" "+k(o(n)("btn_add_reply_content"))+"("+k(i.replyList.length)+"/5) ",1)]),_:1},8,["disabled"])])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title"]),s(G,{open:q.value,"onUpdate:open":e[16]||(e[16]=a=>q.value=a),title:o(n)("title_edit_mini_card"),width:720,onOk:Ze,onCancel:et},{default:m(()=>[s(z,{model:x,layout:"vertical"},{default:m(()=>[s(y,{label:o(n)("label_card_title"),name:"title",rules:[{required:!0,message:o(n)("msg_input_card_title")}]},{default:m(()=>[s(p,{value:x.title,"onUpdate:value":e[11]||(e[11]=a=>x.title=a),placeholder:o(n)("ph_card_title")},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(y,{label:o(n)("label_appid"),name:"appid",rules:[{required:!0,message:o(n)("msg_input_appid")},{validator:Pe}]},{default:m(()=>[s(p,{value:x.appid,"onUpdate:value":e[12]||(e[12]=a=>x.appid=a),placeholder:o(n)("ph_appid")},null,8,["value","placeholder"]),v("div",vn,[v("div",null,[T(k(o(n)("tip_appid_1")),1),v("a",{onClick:e[13]||(e[13]=a=>ie("appid"))},k(o(n)("btn_find_appid")),1)]),v("div",null,[T(k(o(n)("tip_appid_2")),1),v("a",{onClick:e[14]||(e[14]=a=>ie("assoc"))},k(o(n)("btn_view_assoc")),1)])])]),_:1},8,["label","rules"]),s(y,{label:o(n)("label_mini_path"),name:"path",rules:[{required:!0,message:o(n)("msg_input_mini_path")}]},{default:m(()=>[s(p,{value:x.path,"onUpdate:value":e[15]||(e[15]=a=>x.path=a),placeholder:o(n)("ph_mini_path")},null,8,["value","placeholder"]),v("div",hn,[v("div",null,k(o(n)("tip_mini_path")),1)])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["open","title"]),s(G,{open:B.value,"onUpdate:open":e[19]||(e[19]=a=>B.value=a),title:o(n)("title_edit_link"),width:720,onOk:nt,onCancel:lt},{default:m(()=>[s(z,{model:I,labelCol:fe,wrapperCol:ge},{default:m(()=>[s(y,{label:o(n)("label_title"),name:"title",rules:[{required:!0,message:o(n)("msg_input_title")}]},{default:m(()=>[s(p,{value:I.title,"onUpdate:value":e[17]||(e[17]=a=>I.title=a),placeholder:o(n)("ph_title")},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(y,{label:o(n)("label_open_link"),name:"url",rules:[{required:!0,message:o(n)("msg_input_open_link")},{validator:Ye}]},{default:m(()=>[s(p,{value:I.url,"onUpdate:value":e[18]||(e[18]=a=>I.url=a),placeholder:o(n)("ph_open_link")},null,8,["value","placeholder"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["open","title"])])}}},On=kt(wn,[["__scopeId","data-v-a5b91573"]]);export{On as default};
//# sourceMappingURL=add-rule-O6WDTCAw.js.map
