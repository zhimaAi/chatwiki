import{_ as qe}from"./cu-scroll-RG6yxhtf.js";import{b as X,e as Le,d as ge,M as K,k as R,bS as Te,bB as ie,bC as re,bT as Fe,bU as Ne,bE as Ie,bV as Ee,l as Re,a5 as Ce,bA as Be,B as Ve,bW as De,bX as He,E as xe,bY as Pe,bZ as Ze}from"../../index-M_xDbIir.js";import{b as de,N as b,O as p,F as J,a1 as Me,X as o,_ as V,a6 as I,S as T,U as l,a5 as N,Z as m,a0 as E,j as a,d as k,u as g,z as _e,q as Je,H as ee,W as fe,I as te,x as Qe,a2 as Oe}from"./vue-chunks-BRsu9_To.js";import{M as ze,_ as Se,E as je}from"./index-B3CPYV6x.js";import"./index-D7wU2qJF.js";import{D as Ue}from"./dropdown-DCrM-GKY.js";import{_ as ye}from"./index-B0RyY99D.js";import{R as ke}from"./RightOutlined-og3IpneX.js";import{A as Ke}from"./avatar-input-DmRcFOZY.js";import{t as Xe}from"./validate-8MtiUsxW.js";import{M as ve}from"./model-select-Cwu3Of2q.js";import{O as Ye}from"./open-grapg-modal-MJ6u7Aov.js";import{F as we,_ as We}from"./index-V0sRhm34.js";import"./index-UA7y0weg.js";import{I as Ge}from"./Input-Bx6Hhp2b.js";import{C as et}from"./CaretRightOutlined-BIHz9IjD.js";import{C as tt}from"./CaretDownOutlined-C4FFiOW0.js";import{Q as Z}from"./QuestionCircleOutlined-B5SgdGK5.js";import{S as Ae,a as at}from"./index-khLftDou.js";import"./index-Dob-Z8xa.js";import{_ as ot,R as lt}from"./RadioButton-Bb2kU0Fd.js";import{_ as nt}from"./TextArea-C57yjED6.js";import{_ as st}from"./index-CSIZCO5e.js";import{_ as it}from"./index-tezmKtYb.js";import{_ as rt}from"./index-pt58wSpn.js";import{P as dt}from"./page-tabs-j9EvZYFL.js";import{_ as _t}from"./page-alert-CXP-BgUu.js";import{L as ut}from"./list-tabs-Y7yqIuDX.js";import{d as pt}from"./vuedraggable.umd-CIIT_a56.js";import{P as $e}from"./PlusOutlined-DQ91YM1E.js";import{L as ct}from"./LeftOutlined-DbHJ8blF.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-CkoSoTBd.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-DzpBPoRp.js";import"./index-CMIXnI2Z.js";import"./Dropdown-Dh4cjnmT.js";import"./move-DD64vPeJ.js";import"./colors-C56HAaAp.js";import"./index-BSroSjtu.js";import"./Password-5njtOUlo.js";import"./inputProps-DsSGhBt6.js";import"./DownloadOutlined-Cn7Sl8HY.js";import"./index-CsySi7_q.js";import"./CheckOutlined-DVulUWsT.js";import"./useRefs-CRRjy_qY.js";import"./useMergedState-C0iIHNGF.js";import"./FormItemContext-DRzYyKbC.js";import"./index-Bm5IPe57.js";import"./isPlainObject-A-SljaBF.js";import"./Col-CFWsj1wI.js";import"./responsiveObserve-CRSSr9-w.js";import"./hasIn-DEwqUvIo.js";import"./index-Btmz2D3B.js";import"./Search-w33R1D1l.js";import"./SearchOutlined-KUcJKUZw.js";import"./List-DKTpjnke.js";import"./DownOutlined-CI2wWtcJ.js";import"./Checkbox-pA5GUfu7.js";import"./UpOutlined-DzDRcb4z.js";const mt={class:"list-box"},ft=["onClick"],vt={class:"library-info"},ht=["src"],kt={class:"library-info-content"},gt={class:"library-title"},yt={class:"library-type"},bt={key:0,class:"type-tag"},Ct={key:1,class:"type-tag"},xt={key:2,class:"type-tag"},wt={class:"item-body"},$t={class:"library-desc"},Lt={class:"item-footer"},It={class:"library-size"},Mt={class:"text-item"},Ot={class:"text-item"},zt={class:"text-item"},St=["onClick"],Ut=["onClick"],Gt={__name:"index",props:{list:{type:Array,default:()=>[]}},emits:["add","edit","delete","openEditGroupModal"],setup(Q,{emit:q}){const M=q,C=Le(),y=de(()=>{var e;return((e=C.companyInfo)==null?void 0:e.neo4j_status)=="true"}),O=Q,f=e=>{M("edit",e)},z=e=>{M("delete",e)},$=e=>{M("openEditGroupModal",e)};return(e,d)=>{const x=ye,v=ge,A=Se,F=ze,L=Ue;return p(),b("div",mt,[(p(!0),b(J,null,Me(O.list,_=>(p(),b("div",{class:"list-item-wrapper",key:_.id},[o("div",{class:"list-item",onClick:E(D=>f(_),["stop"])},[o("div",vt,[o("img",{class:"library-icon",src:_.avatar,alt:""},null,8,ht),o("div",kt,[o("div",gt,V(_.library_name),1),o("div",yt,[_.type==0?(p(),b("span",bt,"普通知识库")):I("",!0),_.type==1?(p(),b("span",Ct,"对外知识库")):I("",!0),_.type==2?(p(),b("span",xt,"问答知识库")):I("",!0),y.value?(p(),T(x,{key:3},{title:l(()=>[m(V(_.graph_switch==0?"未":"已")+"开启知识图谱生成",1)]),default:l(()=>[o("span",{class:N(["type-tag graph-tag",{"gray-tag":_.graph_switch==0}])},"Graph",2)]),_:2},1024)):I("",!0)])])]),o("div",wt,[o("div",$t,V(_.library_intro),1)]),o("div",Lt,[o("div",It,[o("span",Mt,"文档："+V(_.file_total),1),o("span",Ot,"大小："+V(_.file_size_str),1),o("span",zt,"关联应用："+V(_.robot_nums||0),1)]),o("div",{class:"action-box",onClick:d[1]||(d[1]=E(()=>{},["stop"]))},[a(L,null,{overlay:l(()=>[a(F,null,{default:l(()=>[a(A,null,{default:l(()=>[o("a",{class:"delete-text-color",href:"javascript:;",onClick:E(D=>z(_),["stop"])},"删 除",8,St)]),_:2},1024),a(A,null,{default:l(()=>[o("div",{onClick:E(D=>$(_),["stop"])},"修改分组",8,Ut)]),_:2},1024)]),_:2},1024)]),default:l(()=>[o("div",{class:"action-item",onClick:d[0]||(d[0]=E(()=>{},["stop"]))},[a(v,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,ft)]))),128))])}}},At=X(Gt,[["__scopeId","data-v-e5d79f73"]]),qt="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M29.8066%2055.3034C14.0866%2051.3489%2011.0624%2045.5975%2015.5685%2027.6849C20.074%209.77234%2025.4347%206.23271%2041.1546%2010.1872C56.8746%2014.1417%2059.8378%2019.7747%2055.3323%2037.6873C50.8267%2055.5999%2045.5265%2059.2579%2029.8059%2055.3034H29.8066Z'%20fill='%232475FC'/%3e%3cpath%20d='M27.6401%2056.8699C9.97054%2056.8699%205.24487%2051.5938%205.24487%2031.46C5.24487%2011.3261%209.97054%206.15887%2027.6401%206.15887C45.3096%206.15887%2049.9398%2011.3261%2049.9398%2031.46C49.9398%2051.5938%2045.3096%2056.8699%2027.6401%2056.8699Z'%20fill='%232CAAFF'/%3e%3cpath%20d='M38.7639%2045.5143H36.8936C36.3373%2045.5143%2035.8577%2045.4677%2035.4549%2045.3743C35.052%2045.281%2034.7067%2045.1363%2034.419%2044.9403C34.1313%2044.7443%2033.8867%2044.497%2033.6853%2044.1983C33.4838%2043.8997%2033.2968%2043.5543%2033.1242%2043.1623C32.8364%2042.453%2032.5727%2041.809%2032.3329%2041.2303C32.0931%2040.6517%2031.8869%2040.1477%2031.7142%2039.7183C31.5032%2039.233%2031.3114%2038.785%2031.1388%2038.3743H23.974C23.8397%2038.8037%2023.6767%2039.2703%2023.4849%2039.7743C23.3314%2040.2037%2023.13%2040.7217%2022.8806%2041.3283C22.6312%2041.935%2022.3435%2042.593%2022.0174%2043.3023C21.6337%2044.1423%2021.1925%2044.721%2020.6938%2045.0383C20.195%2045.3557%2019.6291%2045.5143%2018.9961%2045.5143H17.0107C16.1667%2045.5143%2015.596%2045.3323%2015.2986%2044.9683C15.0013%2044.6043%2015.0253%2043.9837%2015.3706%2043.1063C15.7159%2042.2663%2016.1187%2041.277%2016.5791%2040.1383C17.0395%2038.9997%2017.5286%2037.791%2018.0466%2036.5123C18.5645%2035.2337%2019.1016%2033.9223%2019.6579%2032.5783C20.2142%2031.2343%2020.7513%2029.9183%2021.2693%2028.6303C22.497%2025.625%2023.7822%2022.4983%2025.125%2019.2503C25.2593%2018.933%2025.4319%2018.6437%2025.6429%2018.3823C25.8347%2018.177%2026.0889%2017.981%2026.4054%2017.7943C26.7219%2017.6077%2027.12%2017.5143%2027.5996%2017.5143C28.0983%2017.5143%2028.5059%2017.6123%2028.8224%2017.8083C29.139%2018.0043%2029.4027%2018.2237%2029.6137%2018.4663C29.8439%2018.7463%2030.0262%2019.0543%2030.1604%2019.3903C31.5224%2022.6757%2032.8172%2025.821%2034.0449%2028.8263C34.5629%2030.1143%2035.1%2031.4257%2035.6563%2032.7603C36.2126%2034.095%2036.7449%2035.3923%2037.2532%2036.6523C37.7616%2037.9123%2038.2412%2039.093%2038.6919%2040.1943C39.1427%2041.2957%2039.5312%2042.2477%2039.8573%2043.0503C40.1259%2043.685%2040.1642%2044.2543%2039.9724%2044.7583C39.7806%2045.2623%2039.3777%2045.5143%2038.7639%2045.5143ZM30.4194%2034.8743L27.6859%2025.3823H27.6571L24.607%2034.8743H30.4194Z'%20fill='white'/%3e%3c/svg%3e",Tt="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2062%2062'%20class='design-iconfont'%3e%3cpath%20d='M0%2014.5882C0%206.53137%206.53137%200%2014.5882%200H47.4118C55.4686%200%2062%206.53137%2062%2014.5882V47.4118C62%2055.4686%2055.4686%2062%2047.4118%2062H14.5882C6.53137%2062%200%2055.4686%200%2047.4118V14.5882Z'%20fill='%234876FF'/%3e%3cg%20filter='url(%23kd70btl3k__filter0_d_7802_38768)'%3e%3cpath%20d='M42.8433%2015.6719H27.4866C24.6533%2015.6719%2022.33%2017.9952%2022.33%2020.8852V32.6152C22.33%2035.5052%2024.6533%2037.8285%2027.4866%2037.8285H37.861L41.4876%2041.1719C42.5076%2042.1352%2044.2643%2041.4552%2044.2643%2040.0385V37.7719C47.041%2037.7719%2048%2035.4485%2048%2032.6152V20.8852C48%2017.9952%2045.6766%2015.6719%2042.8433%2015.6719Z'%20fill='%23D6E0FF'/%3e%3cpath%20d='M36.9952%2017.1719H19.7806C16.6044%2017.1719%2014%2019.7763%2014%2023.016V36.1652C14%2039.3413%2016.5409%2041.9458%2019.6535%2042.0093V44.5502C19.6535%2046.1383%2021.6227%2046.9005%2022.7661%2045.8206L26.8316%2042.0728H36.9952C40.1714%2042.0728%2042.7758%2039.4684%2042.7758%2036.2287V23.016C42.7758%2019.7763%2040.1714%2017.1719%2036.9952%2017.1719Z'%20fill='%23EBF0FF'/%3e%3cpath%20d='M35.8572%2028.9015C35.8572%2026.5396%2035.2018%2024.6658%2033.8911%2023.2801C32.5804%2021.8944%2030.8072%2021.1995%2028.5715%2021.1953C26.342%2021.1953%2024.5709%2021.8881%2023.2581%2023.2738C21.9453%2024.6595%2021.2878%2026.5259%2021.2858%2028.8732C21.2858%2031.1973%2021.9401%2033.0564%2023.2487%2034.4505C24.5574%2035.8446%2026.2974%2036.5427%2028.4688%2036.5447C29.0683%2036.5626%2029.6676%2036.5012%2030.2514%2036.3621C30.3074%2036.4093%2030.9638%2037.4265%2031.7726%2037.8863C32.3384%2038.2078%2033.0977%2038.2247%2033.6736%2038.1731C34.1554%2038.1299%2034.4572%2037.6737%2034.3836%2037.1957C34.3104%2036.7211%2033.8837%2036.3943%2033.42%2036.2696C33.3237%2036.2437%2033.2286%2036.2126%2033.1352%2036.1763C32.8819%2036.0309%2032.6781%2035.8113%2032.5503%2035.5464C34.757%2034.1965%2035.8593%2031.9815%2035.8572%2028.9015ZM31.278%2032.8475L31.1286%2033.0396C31.0602%2033.131%2030.6433%2032.1641%2029.6292%2031.8492C29.0996%2031.7142%2028.5513%2031.6807%2028.0124%2031.7487C27.6975%2031.7884%2027.4827%2032.0714%2027.4827%2032.3888C27.4827%2032.7549%2027.771%2033.0497%2028.1222%2033.153C28.3685%2033.2254%2028.6053%2033.33%2028.8266%2033.4648C29.2341%2033.7797%2029.5919%2034.186%2029.4176%2034.2332C29.113%2034.3135%2028.7992%2034.3527%2028.4844%2034.3497C27.9396%2034.3544%2027.403%2034.2154%2026.9274%2033.9465C26.4518%2033.6776%2026.0535%2033.288%2025.7717%2032.816C25.0935%2031.7873%2024.7534%2030.4394%2024.7513%2028.7724C24.7492%2027.1054%2025.0894%2025.7565%2025.7717%2024.7256C26.0684%2024.2609%2026.4754%2023.8788%2026.9555%2023.6142C27.4356%2023.3497%2027.9735%2023.2111%2028.5201%2023.2111C29.0668%2023.2111%2029.6047%2023.3497%2030.0848%2023.6142C30.5649%2023.8788%2030.9719%2024.2609%2031.2686%2024.7256C31.9592%2025.7313%2032.3046%2027.0739%2032.3046%2028.7535C32.3046%2030.4772%2031.9624%2031.8419%2031.278%2032.8475Z'%20fill='%234876FF'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='kd70btl3k__filter0_d_7802_38768'%20x='9.875'%20y='15.6719'%20width='42.25'%20height='38.9023'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='4.125'/%3e%3cfeGaussianBlur%20stdDeviation='2.0625'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20values='0%200%200%200%200.413084%200%200%200%200%200.250874%200%200%200%200%200.0886636%200%200%200%200.14%200'/%3e%3cfeBlend%20in2='BackgroundImageFix'%20result='effect1_dropShadow_7802_38768'/%3e%3cfeBlend%20in='SourceGraphic'%20in2='effect1_dropShadow_7802_38768'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",Ft={class:"add-libray-popup",ref:"modal"},Nt={class:"add-libray-popup-body"},Et={class:"libray-type-list"},Rt={class:"libray-action"},Bt={class:"libray-action"},Vt={__name:"add-libray-popup",emits:["ok"],setup(Q,{expose:q,emit:M}){const C=M,y=k(!1),O=()=>{y.value=!0},f=()=>{y.value=!1},z=e=>{y.value=!1,C("ok",e)},$=e=>{z(e)};return q({show:O,close:f}),(e,d)=>{const x=K;return p(),b("div",Ft,[a(x,{footer:null,getContainer:()=>e.$refs.modal,open:y.value,"onUpdate:open":d[2]||(d[2]=v=>y.value=v),title:"",width:520,onOk:z},{default:l(()=>[o("div",Nt,[d[7]||(d[7]=o("div",{class:"popup-title"},"新建知识库",-1)),o("div",Et,[o("div",{class:"libray-item",onClick:d[0]||(d[0]=v=>$(0))},[d[3]||(d[3]=o("div",{class:"libray-item-header"},[o("img",{class:"libray-icon",src:qt,alt:""}),o("div",{class:"libray-type-name"},"普通知识库")],-1)),d[4]||(d[4]=o("div",{class:"libray-desc"}," 导入文档或网页创建知识库，知识库可以与聊天机器人或工作流关联。用户和机器人聊天时，机器人可以引用知识库内知识回复用户 ",-1)),o("div",Rt,[a(g(ke))])]),o("div",{class:"libray-item",onClick:d[1]||(d[1]=v=>$(2))},[d[5]||(d[5]=o("div",{class:"libray-item-header"},[o("img",{class:"libray-icon",src:Tt,alt:""}),o("div",{class:"libray-type-name"},"问答知识库")],-1)),d[6]||(d[6]=o("div",{class:"libray-desc"}," 通过excel或者word导入FAQ问答对构建知识库，适合客服场景或者需要用FAQ问答数据精确回答的场景。用户提问时，如果系统检索到与用户问题匹配度很高的问答对，会直接回复对应的答案。 ",-1)),o("div",Bt,[a(g(ke))])])])])]),_:1},8,["getContainer","open"])],512)}}},Dt=X(Vt,[["__scopeId","data-v-0c724719"]]),Ht={class:"form-box"},Pt={class:"indexing-methods-box"},Zt={class:"list-title-block"},Jt={class:"list-title-block"},Qt={class:"select-card-box"},jt={class:"card-title"},Kt={class:"card-title"},Xt={class:"card-title"},Yt={class:"card-title"},Wt={class:"graph-switch-box"},ea={class:"lable-text"},ta={class:"graph-switch-box"},aa={class:"lable-text"},he="你是一位文章分段助手，根据文章内容的语义进行合理分段，确保每个分段表述一个完整的语义，每个分段字数控制在500字左右，最大不超过1000字。请严格按照文章内容进行分段，不要对文章内容进行加工，分段完成后输出分段后的内容。",oa={__name:"add-library-model",setup(Q,{expose:q}){const M=Le(),C=de(()=>{var n;return((n=M.companyInfo)==null?void 0:n.neo4j_status)=="true"});R.config({duration:2});const y=k(!0),O=Oe(),f=k(!1),z=we.useForm,$=k(!1),e=_e({type:"0",access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:"",avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:0,qa_index_type:1,doc_auto_renew_frequency:1,chunk_type:1,normal_chunk_default_separators_no:[12,11],normal_chunk_default_chunk_size:512,normal_chunk_default_chunk_overlap:50,semantic_chunk_default_chunk_size:512,semantic_chunk_default_chunk_overlap:50,semantic_chunk_default_threshold:90,normal_chunk_default_not_merged_text:"false",graph_switch:!1,graph_model_config_id:void 0,graph_use_model:"",ai_chunk_size:5e3,ai_chunk_model:"",ai_chunk_model_config_id:"",ai_chunk_prumpt:he,qa_index_type:1,group_id:0,father_chunk_paragraph_type:2,father_chunk_separators_no:[],father_chunk_chunk_size:1024,son_chunk_separators_no:[],son_chunk_chunk_size:512}),d=_e({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:x,validateInfos:v}=z(e,d),A=n=>{e.avatar=n.imageUrl,e.avatar_file=n.file},F=k([]);Te().then(n=>{F.value=n.data.map(t=>({label:t.name,value:t.no}))});const L=n=>{e.chunk_type=n},_=k([]),D=n=>{_.value=n,Qe(()=>{(!e.ai_chunk_model||!Number(e.ai_chunk_model_config_id))&&ae()})},ae=()=>{if(_.value.length>0){let n=null,t=null;for(let U of _.value)if(U.model_define==="tongyi"){n=U;for(let u of n.children)if(u.name==="qwen-max"){t=u;break}break}n||(n=_.value[0],t=n.children[0]),n&&t&&(e.ai_chunk_model=t.name,e.ai_chunk_model_config_id=t.model_config_id)}},oe=n=>{n.length&&(e.use_model=n[0].children[0].name,e.model_config_id=n[0].model_config_id)},Y=k(null),j=n=>{if(n){let t={graph_model_config_id:e.graph_model_config_id,graph_use_model:e.graph_use_model};if((!e.graph_model_config_id||!e.graph_use_model)&&_.value.length>0){let U=_.value[0];if(U){let u=U.children[0];t.graph_use_model=u.name,t.graph_model_config_id=u.model_config_id}}Y.value.show(t)}else e.graph_switch=!1},H=n=>{n.graph_model_config_id&&(e.graph_switch=!0,e.graph_model_config_id=n.graph_model_config_id,e.graph_use_model=n.graph_use_model)},W=()=>{f.value=!1},ue=()=>{x().then(()=>{pe()}).catch(n=>{})},pe=()=>{let n=new FormData,t=JSON.parse(JSON.stringify(e));n.append("type",e.type),n.append("access_rights",e.access_rights),n.append("library_name",e.library_name),n.append("qa_index_type",e.qa_index_type),n.append("library_intro",e.library_intro),n.append("use_model",t.use_model),n.append("model_config_id",e.model_config_id),n.append("avatar",e.avatar_file?e.avatar_file:""),n.append("is_offline",e.is_offline),n.append("urls",JSON.stringify(Xe(e.urls))),n.append("doc_type",e.doc_type),n.append("file_name",e.file_name),n.append("is_qa_doc",e.is_qa_doc),n.append("qa_index_type",e.qa_index_type),n.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),n.append("chunk_type",e.chunk_type),n.append("normal_chunk_default_separators_no",JSON.stringify(e.normal_chunk_default_separators_no)),n.append("normal_chunk_default_not_merged_text",e.normal_chunk_default_not_merged_text),n.append("normal_chunk_default_chunk_size",e.normal_chunk_default_chunk_size),n.append("normal_chunk_default_chunk_overlap",e.normal_chunk_default_chunk_overlap),n.append("semantic_chunk_default_chunk_size",e.semantic_chunk_default_chunk_size),n.append("semantic_chunk_default_chunk_overlap",e.semantic_chunk_default_chunk_overlap),n.append("semantic_chunk_default_threshold",e.semantic_chunk_default_threshold),n.append("graph_switch",e.graph_switch?1:0),n.append("graph_model_config_id",e.graph_model_config_id),n.append("graph_use_model",e.graph_use_model),n.append("ai_chunk_size",e.ai_chunk_size),n.append("ai_chunk_model",e.ai_chunk_model),n.append("ai_chunk_model_config_id",e.ai_chunk_model_config_id),n.append("ai_chunk_prumpt",e.ai_chunk_prumpt),n.append("father_chunk_paragraph_type",e.father_chunk_paragraph_type),n.append("father_chunk_separators_no",JSON.stringify(e.father_chunk_separators_no)),n.append("son_chunk_separators_no",JSON.stringify(e.son_chunk_separators_no)),n.append("father_chunk_chunk_size",e.father_chunk_chunk_size),n.append("son_chunk_chunk_size",e.son_chunk_chunk_size),n.append("group_id",e.group_id),$.value=!0,Fe(n).then(U=>{R.success("创建成功"),f.value=!1;let u="/library/details/knowledge-document",P={id:U.data.id};e.doc_type==3&&(u="/library/preview",P={id:U.data.file_ids[0]}),O.push({path:u,query:P}),$.value=!1,f.value=!1}).catch(()=>{$.value=!1})},ce=({type:n,group_id:t})=>{e.type=n,n==0?(e.avatar=ie,e.avatar_file=ie):(e.avatar=re,e.avatar_file=re),e.library_name="",e.library_intro="",e.qa_index_type=1,e.chunk_type=1,e.normal_chunk_default_separators_no=[12,11],e.normal_chunk_default_chunk_size=512,e.normal_chunk_default_chunk_overlap=50,e.normal_chunk_default_not_merged_text="false",e.semantic_chunk_default_chunk_size=512,e.semantic_chunk_default_chunk_overlap=50,e.semantic_chunk_default_threshold=50,e.graph_switch=!1,e.father_chunk_paragraph_type=2,e.father_chunk_separators_no=[12,11],e.father_chunk_chunk_size=1024,e.son_chunk_separators_no=[8,10],e.son_chunk_chunk_size=512,e.ai_chunk_size=5e3,e.ai_chunk_model="",e.ai_chunk_model_config_id="",e.ai_chunk_prumpt=he,e.group_id=t||0,f.value=!0},le=n=>{n!=e.qa_index_type&&(e.qa_index_type=n)};return q({show:ce}),Je(()=>{}),(n,t)=>{const U=Ge,u=We,P=nt,B=ye,S=ge,r=Ae,i=it,c=st,h=rt,G=lt,ne=ot,se=we,me=K;return p(),b(J,null,[a(me,{open:f.value,"onUpdate:open":t[30]||(t[30]=s=>f.value=s),title:"添加知识库",onOk:ue,confirmLoading:$.value,wrapClassName:"no-padding-modal",bodyStyle:{"padding-right":"24px","max-height":"540px","overflow-y":"auto"},onCancel:W,width:"620px"},{default:l(()=>[o("div",Ht,[a(se,{layout:"vertical"},{default:l(()=>[a(u,fe({ref:"name",label:"知识库名称"},g(v).library_name),{default:l(()=>[a(U,{value:e.library_name,"onUpdate:value":t[0]||(t[0]=s=>e.library_name=s),placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),a(u,fe({label:"知识库简介"},g(v).library_intro),{default:l(()=>[a(P,{maxlength:1e3,value:e.library_intro,"onUpdate:value":t[1]||(t[1]=s=>e.library_intro=s),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1},16),a(u,fe({ref:"name",label:"知识库封面"},g(v).avatar),{default:l(()=>[a(Ke,{value:e.avatar,"onUpdate:value":t[2]||(t[2]=s=>e.avatar=s),onChange:A},null,8,["value"]),t[31]||(t[31]=o("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[31]},16),o("div",{class:"hight-set-text",onClick:t[3]||(t[3]=s=>y.value=!y.value)},[y.value?(p(),T(g(et),{key:0})):(p(),T(g(tt),{key:1})),t[32]||(t[32]=m(" 高级设置 ")),t[33]||(t[33]=o("span",{style:{color:"#8c8c8c"}},"适用于高级用户",-1))]),ee(a(u,null,{label:l(()=>[t[35]||(t[35]=m("文档解析向量模型 ")),a(B,null,{title:l(()=>t[34]||(t[34]=[m("向量模型可以将分段数据转化为向量形式，存储到向量数据库中，便于后续根据用户问题查询匹配。")])),default:l(()=>[a(g(Z),{class:"ml4"})]),_:1})]),default:l(()=>[a(ve,{modelType:"TEXT EMBEDDING",modeName:e.use_model,"onUpdate:modeName":t[4]||(t[4]=s=>e.use_model=s),modeId:e.model_config_id,"onUpdate:modeId":t[5]||(t[5]=s=>e.model_config_id=s),onLoaded:oe,style:{width:"100%"}},null,8,["modeName","modeId"])]),_:1},512),[[te,!y.value]]),ee(a(u,{label:"索引方式"},{default:l(()=>[o("div",Pt,[o("div",{class:N(["list-item",{active:e.qa_index_type==1}]),onClick:t[6]||(t[6]=s=>le(1))},[a(S,{class:"check-icon",name:"check-arrow-filled"}),o("div",Zt,[a(S,{name:"file-search"}),t[36]||(t[36]=m(" 问题与答案一起生成索引 "))]),t[37]||(t[37]=o("div",{class:"list-content"}," 回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复 ",-1))],2),o("div",{class:N(["list-item",{active:e.qa_index_type==2}]),onClick:t[7]||(t[7]=s=>le(2))},[a(S,{class:"check-icon",name:"check-arrow-filled"}),o("div",Jt,[a(S,{name:"comment-search"}),t[38]||(t[38]=m(" 仅对问题生成索引 "))]),t[39]||(t[39]=o("div",{class:"list-content"}," 回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复 ",-1))],2)])]),_:1},512),[[te,!y.value&&e.type==2]]),ee(o("div",null,[a(u,{label:"分段方式",required:""},{default:l(()=>[t[48]||(t[48]=o("div",{class:"form-alert-tip"}," 提示：语义分段更适合没有排版过的文章，即没有明显换行符号的文本，否则更推荐使用普通分段 ",-1)),o("div",Qt,[o("div",{class:N(["select-card-item",{active:e.chunk_type==1}]),onClick:t[8]||(t[8]=s=>L(1))},[a(S,{class:"check-arrow",name:"check-arrow-filled"}),o("div",jt,[a(S,{name:"ordinary-segmentation",class:"title-icon"}),t[40]||(t[40]=m(" 普通分段 "))]),t[41]||(t[41]=o("div",{class:"card-desc"}," 基于文章中句号、空行，或者自定义符号进行分段，不会消耗模型token ",-1))],2),o("div",{class:N(["select-card-item",{active:e.chunk_type==2}]),onClick:t[9]||(t[9]=s=>L(2))},[a(S,{class:"check-arrow",name:"check-arrow-filled"}),o("div",Kt,[a(S,{name:"semantic-segmentation",class:"title-icon"}),t[42]||(t[42]=m(" 语义分段 "))]),t[43]||(t[43]=o("div",{class:"card-desc"}," 将文章拆分成句子后，通过语句向量相似度进行分段，会消耗模型token ",-1))],2),o("div",{class:N(["select-card-item",{active:e.chunk_type==4}]),onClick:t[10]||(t[10]=s=>L(4))},[a(S,{class:"check-arrow",name:"check-arrow-filled"}),o("div",Xt,[a(S,{name:"semantic-segmentation",class:"title-icon"}),t[44]||(t[44]=m(" 父子分段 "))]),t[45]||(t[45]=o("div",{class:"card-desc"}," 基于文章中句号等符号进行分段，不会消耗模型token。父分段会拆分为若干子分段，子块用于检索，父块用作上下文 ",-1))],2),o("div",{class:N(["select-card-item",{active:e.chunk_type==3}]),onClick:t[11]||(t[11]=s=>L(3))},[a(S,{class:"check-arrow",name:"check-arrow-filled"}),o("div",Yt,[a(S,{name:"semantic-segmentation",class:"title-icon"}),t[46]||(t[46]=m(" AI分段 "))]),t[47]||(t[47]=o("div",{class:"card-desc"}," 将文章提交给大模型，大模型基于设定的提示词进行分段，会消耗大量模型token ",-1))],2)])]),_:1,__:[48]}),e.chunk_type==1?(p(),b(J,{key:0},[a(u,{label:"分段标识符",required:""},{default:l(()=>[a(r,{value:e.normal_chunk_default_separators_no,"onUpdate:value":t[12]||(t[12]=s=>e.normal_chunk_default_separators_no=s),mode:"tags",style:{width:"100%"},placeholder:"请选择分段标识符",options:F.value},null,8,["value","options"])]),_:1}),a(c,null,{default:l(()=>[a(u,{label:"分段最大长度",required:""},{default:l(()=>[a(c,{gap:8,align:"center"},{default:l(()=>[a(i,{value:e.normal_chunk_default_chunk_size,"onUpdate:value":t[13]||(t[13]=s=>e.normal_chunk_default_chunk_size=s),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),t[49]||(t[49]=m(" 字符 "))]),_:1,__:[49]})]),_:1}),a(u,{label:"分段重叠长度"},{default:l(()=>[a(c,{gap:8,align:"center"},{default:l(()=>[a(i,{value:e.normal_chunk_default_chunk_overlap,"onUpdate:value":t[14]||(t[14]=s=>e.normal_chunk_default_chunk_overlap=s),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),t[50]||(t[50]=m(" 字符 "))]),_:1,__:[50]})]),_:1})]),_:1}),o("div",Wt,[o("div",ea,[t[51]||(t[51]=m(" 自动合并较小分段 ")),a(B,{title:"开启后，如果分段长度不足设置的最大分段长度，会尝试与下一分段合并，直至合并后的分段字符数大于分段最大长度"},{default:l(()=>[a(g(Z),{class:"ml4"})]),_:1})]),a(h,{checkedValue:"false",unCheckedValue:"true",checked:e.normal_chunk_default_not_merged_text,"onUpdate:checked":t[15]||(t[15]=s=>e.normal_chunk_default_not_merged_text=s),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])])],64)):I("",!0),e.chunk_type==2?(p(),b(J,{key:1},[e.chunk_type==2?(p(),T(u,{key:0,required:""},{label:l(()=>[t[53]||(t[53]=m(" 分段阈值 ")),a(B,null,{title:l(()=>t[52]||(t[52]=[m("用于控制分段拆分的标准，数值0~100,数值越大，分段越少，数值越小，分段越多。")])),default:l(()=>[a(g(Z),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:l(()=>[a(i,{value:e.semantic_chunk_default_threshold,"onUpdate:value":t[16]||(t[16]=s=>e.semantic_chunk_default_threshold=s),style:{width:"100%"},placeholder:"请输入分段阈值",precision:0,min:0,max:100},null,8,["value"])]),_:1})):I("",!0),a(c,null,{default:l(()=>[a(u,{label:"分段最大长度",required:""},{default:l(()=>[a(c,{gap:8,align:"center"},{default:l(()=>[a(i,{value:e.semantic_chunk_default_chunk_size,"onUpdate:value":t[17]||(t[17]=s=>e.semantic_chunk_default_chunk_size=s),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),t[54]||(t[54]=m(" 字符 "))]),_:1,__:[54]})]),_:1}),a(u,{label:"分段重叠长度"},{default:l(()=>[a(c,{gap:8,align:"center"},{default:l(()=>[a(i,{value:e.semantic_chunk_default_chunk_overlap,"onUpdate:value":t[18]||(t[18]=s=>e.semantic_chunk_default_chunk_overlap=s),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),t[55]||(t[55]=m(" 字符 "))]),_:1,__:[55]})]),_:1})]),_:1})],64)):I("",!0),e.chunk_type==3?(p(),b(J,{key:2},[e.chunk_type==3?(p(),T(u,{key:0,required:""},{label:l(()=>t[56]||(t[56]=[m(" AI大模型 ")])),default:l(()=>[a(ve,{modelType:"LLM",placeholder:"请选择AI大模型",modeName:e.ai_chunk_model,"onUpdate:modeName":t[19]||(t[19]=s=>e.ai_chunk_model=s),modeId:e.ai_chunk_model_config_id,"onUpdate:modeId":t[20]||(t[20]=s=>e.ai_chunk_model_config_id=s),style:{width:"100%"},onLoaded:D},null,8,["modeName","modeId"])]),_:1})):I("",!0),a(u,{label:"提示词设置",required:""},{default:l(()=>[a(c,{gap:8,align:"center"},{default:l(()=>[a(P,{maxLength:500,style:{height:"80px"},value:e.ai_chunk_prumpt,"onUpdate:value":t[21]||(t[21]=s=>e.ai_chunk_prumpt=s),placeholder:he},null,8,["value"])]),_:1})]),_:1}),a(u,null,{label:l(()=>[t[58]||(t[58]=m(" 单次最大字符数 ")),a(B,null,{title:l(()=>t[57]||(t[57]=[m("由于大模型支持的上下文数量有限制，如果上传的文档较大，会按照最大字符数先拆分成多个分段，再提交给大模型进行分段。")])),default:l(()=>[a(g(Z),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:l(()=>[a(i,{class:"form-item-inptu-numbner",value:e.ai_chunk_size,"onUpdate:value":t[22]||(t[22]=s=>e.ai_chunk_size=s),placeholder:"请输入单次最大字符数",precision:0,min:0,formatter:s=>parseInt(s),parser:s=>parseInt(s)},null,8,["value","formatter","parser"]),t[59]||(t[59]=m(" 字符 "))]),_:1,__:[59]})],64)):I("",!0),e.chunk_type==4?(p(),b(J,{key:3},[t[64]||(t[64]=o("div",{class:"main-title-block"},"父块（用作上下文）",-1)),a(u,{label:"分段类型"},{default:l(()=>[a(ne,{value:e.father_chunk_paragraph_type,"onUpdate:value":t[23]||(t[23]=s=>e.father_chunk_paragraph_type=s)},{default:l(()=>[a(G,{value:1},{default:l(()=>[t[60]||(t[60]=m("全文 ")),a(B,{title:"整个文档用作父块并直接检索。请注意，出于性能原因，超过 10000 个标记的文本将被自动截断。"},{default:l(()=>[a(g(Z))]),_:1})]),_:1,__:[60]}),a(G,{value:2},{default:l(()=>[t[61]||(t[61]=m("段落 ")),a(B,{title:"此模式根据分隔符和最大块长度将文本拆分为段落，使用拆分文本作为检索的父块"},{default:l(()=>[a(g(Z))]),_:1})]),_:1,__:[61]})]),_:1},8,["value"])]),_:1}),e.father_chunk_paragraph_type==2?(p(),T(u,{key:0,label:"分段标识符"},{default:l(()=>[a(r,{placeholder:"请选择",style:{width:"100%"},mode:"tags",options:F.value,value:e.father_chunk_separators_no,"onUpdate:value":t[24]||(t[24]=s=>e.father_chunk_separators_no=s)},null,8,["options","value"])]),_:1})):I("",!0),e.father_chunk_paragraph_type==2?(p(),T(u,{key:1,label:"分段最大长度"},{default:l(()=>[a(c,{align:"center",gap:8},{default:l(()=>[a(i,{style:{flex:"1"},value:e.father_chunk_chunk_size,"onUpdate:value":t[25]||(t[25]=s=>e.father_chunk_chunk_size=s),placeholder:"分段最大长度",min:200,max:1e4,precision:0,formatter:s=>parseInt(s),parser:s=>parseInt(s)},null,8,["value","formatter","parser"]),t[62]||(t[62]=o("span",{class:"unit-text"},"字符",-1))]),_:1,__:[62]})]),_:1})):I("",!0),t[65]||(t[65]=o("div",{class:"main-title-block"},"子块（用于检索）",-1)),a(u,{label:"分段标识符"},{default:l(()=>[a(r,{placeholder:"请选择",style:{width:"100%"},mode:"tags",options:F.value,value:e.son_chunk_separators_no,"onUpdate:value":t[26]||(t[26]=s=>e.son_chunk_separators_no=s)},null,8,["options","value"])]),_:1}),a(u,{label:"分段最大长度"},{default:l(()=>[a(c,{align:"center",gap:8},{default:l(()=>[a(i,{style:{flex:"1"},value:e.son_chunk_chunk_size,"onUpdate:value":t[27]||(t[27]=s=>e.son_chunk_chunk_size=s),placeholder:"分段最大长度",min:200,max:1e4,precision:0,formatter:s=>parseInt(s),parser:s=>parseInt(s)},null,8,["value","formatter","parser"]),t[63]||(t[63]=o("span",{class:"unit-text"},"字符",-1))]),_:1,__:[63]})]),_:1})],64)):I("",!0),ee(o("div",ta,[o("div",aa,[t[67]||(t[67]=m(" 生成知识图谱 ")),a(B,null,{title:l(()=>t[66]||(t[66]=[m("文件分块后，所有块将用于生成知识图谱，提高复杂问题推理能力。")])),default:l(()=>[a(g(Z),{class:"ml4"})]),_:1})]),a(h,{onChange:j,checked:e.graph_switch,"checked-children":"开","un-checked-children":"关"},null,8,["checked"])],512),[[te,C.value]]),ee(a(u,{label:"知识图谱模型"},{default:l(()=>[a(ve,{modelType:"LLM",modeName:e.graph_use_model,"onUpdate:modeName":t[28]||(t[28]=s=>e.graph_use_model=s),modeId:e.graph_model_config_id,"onUpdate:modeId":t[29]||(t[29]=s=>e.graph_model_config_id=s),style:{width:"300px"},onLoaded:D},null,8,["modeName","modeId"])]),_:1},512),[[te,e.graph_switch&&C.value]])],512),[[te,!y.value&&e.type==0]])]),_:1})])]),_:1},8,["open","confirmLoading"]),a(Ye,{onOk:H,ref_key:"openGrapgModalRef",ref:Y},null,512)],64)}}},la=X(oa,[["__scopeId","data-v-18422805"]]),na={class:"form-item"},sa={class:"form-content"},ia={__name:"add-group",emits:["ok"],setup(Q,{expose:q,emit:M}){const C=k(!1),y=M,O=k("新建分组"),f=_e({group_name:"",id:""}),z=e=>{f.group_name=e.group_name||"",f.id=e.id||"",O.value=e.id?"编辑分组":"新建分组",C.value=!0},$=()=>{if(!f.group_name)return R.error("请输入分组名称");Ne({...f}).then(e=>{R.success(`${O.value}成功`),C.value=!1,y("ok")})};return q({show:z}),(e,d)=>{const x=Ge,v=K;return p(),b("div",null,[a(v,{open:C.value,"onUpdate:open":d[1]||(d[1]=A=>C.value=A),title:O.value,onOk:$,zIndex:2e3},{default:l(()=>[o("div",na,[d[2]||(d[2]=o("div",{class:"form-label"},"分组名称：",-1)),o("div",sa,[a(x,{maxLength:15,value:f.group_name,"onUpdate:value":d[0]||(d[0]=A=>f.group_name=A),placeholder:"请输入分组名称"},null,8,["value"])])])]),_:1},8,["open","title"])])}}},ra=X(ia,[["__scopeId","data-v-4b52c8e8"]]),da={class:"form-item"},_a={class:"form-content"},ua={__name:"edit-group",emits:["ok"],setup(Q,{expose:q,emit:M}){const C=k(!1),y=M,O=k("修改分组"),f=_e({group_id:"",library_id:""}),z=k([]),$=x=>{f.group_id=x.group_id||"0",f.library_id=x.id||"",d(),C.value=!0},e=()=>{if(!f.group_id)return R.error("请选择分组");Ee({...f}).then(x=>{R.success(`${O.value}成功`),C.value=!1,y("ok")})},d=()=>{Ie().then(x=>{z.value=x.data||[]})};return q({show:$}),(x,v)=>{const A=at,F=Ae,L=K;return p(),b("div",null,[a(L,{open:C.value,"onUpdate:open":v[1]||(v[1]=_=>C.value=_),title:O.value,onOk:e},{default:l(()=>[o("div",da,[v[2]||(v[2]=o("div",{class:"form-label"},"分组名称：",-1)),o("div",_a,[a(F,{value:f.group_id,"onUpdate:value":v[0]||(v[0]=_=>f.group_id=_),style:{width:"100%"},placeholder:"请选择分组"},{default:l(()=>[(p(!0),b(J,null,Me(z.value,_=>(p(),T(A,{value:_.id},{default:l(()=>[m(V(_.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])]),_:1},8,["open","title"])])}}},pa=X(ua,[["__scopeId","data-v-62ebd416"]]),ca={"bg-color":"#f5f9ff",class:"library-page"},ma={class:"library-page-body"},fa={class:"list-toolbar"},va={class:"toolbar-box"},ha={class:"toolbar-box"},ka={class:"create-action"},ga=["src"],ya={class:"create-action"},ba=["src"],Ca={class:"list-group-box"},xa={class:"group-head-box"},wa={key:0,class:"head-title"},$a={class:"classify-box",style:{"margin-top":"16px"}},La=["onClick"],Ia={class:"classify-title"},Ma={key:0,class:"drag-btn"},Oa={key:1,style:{width:"20px",display:"inline-block"}},za={class:"right-content"},Sa={key:0,class:"btn-box"},Ua={class:"hover-btn-wrap"},Ga=["onClick"],Aa=["onClick"],qa={__name:"library-list",setup(Q){Oe();const q=k([{title:"知识库",path:"/library/list"},{title:"数据库",path:"/database/list"},{title:"文档提取FAQ",path:"/ai-extract-faq/list"},{title:"触发次数统计",path:"/trigger-statics/list"}]),M=k([{title:"全部 (0)",value:"all"},{title:"普通知识库 (0)",value:"0"},{title:"问答知识库 (0)",value:"2"}]),C=Re();let{role_permission:y,role_type:O}=C;const f=de(()=>O==1||y.includes("LibraryCreate")),z=k(null),$=k(null),e=k("all"),d=k("");let x="library-list-hide-group-key";const v=k(localStorage.getItem(x)==1),A=()=>{v.value=!v.value,localStorage.setItem(x,v.value?1:0)},F=k(""),L=k([]);de(()=>L.value.filter(r=>r.group_name.includes(F.value)));const _=()=>{let r=e.value==="all"?"":e.value;Ie({type:r}).then(i=>{let c=i.data||[],h=0;c.forEach(G=>{h+=+G.total}),L.value=[{group_name:"全部",total:h,id:""},...c]})};_();const D=r=>{ae(r)},ae=r=>{z.value.show({type:r,group_id:d.value})},oe=k([]),Y=r=>{let i=0,c=0,h=0;r.forEach(G=>{G.type==0&&(c+=1),G.type==2&&(h+=1),i+=1}),M.value=[{title:"全部 ("+i+")",value:"all"},{title:"普通知识库 ("+c+")",value:"0"},{title:"问答知识库 ("+h+")",value:"2"}]};let j=k([]);const H=()=>{let r=e.value==="all"?"":e.value;Ce({type:r}).then(i=>{let c=i.data||[];c.forEach(h=>{h.file_size_str=Be(h.file_size),h.avatar||(h.avatar=h.type==0?ie:re)}),d.value!=""&&(c=c.filter(h=>h.group_id==d.value)),oe.value=c,e.value==="all"?(j.value=i.data,Y(j.value)):Ce().then(h=>{j.value=h.data,Y(j.value)})})};H();const W=()=>{H(),_()},ue=r=>{r.type=="1"?window.open(`/#/public-library/config?library_id=${r.id}`,"_blank","noopener"):window.open(`/#/library/details?id=${r.id}`,"_blank","noopener")},pe=r=>{if(Pe(r.id)!=4)return R.error("您没有删除该知识库的权限");let c=3,h=K.confirm({title:`删除${r.library_name}`,icon:a(xe),content:"您确定要删除此知识库吗？",okText:c+" 确 定",okType:"danger",okButtonProps:{disabled:!0},cancelText:"取 消",onOk(){ce(r)},onCancel(){}}),G=setInterval(()=>{c==1?(h.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(G),G=void 0):(c-=1,h.update({okText:c+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},ce=({id:r})=>{Ze({id:r}).then(()=>{R.success("删除成功"),H(),_()})},le=r=>{d.value=r.id,H()},n=k(null),t=r=>{n.value.show({...r})},U=k(null),u=r=>{U.value.show({...r})},P=r=>{K.confirm({title:`确认删除分组${r.group_name}`,icon:a(xe),content:"",okText:"确认",okType:"danger",cancelText:"取消",onOk(){He({id:r.id}).then(()=>{R.success("删除成功"),_(),d.value==r.id&&(d.value=""),H()})}})};k(!1);const B=r=>r.draggedContext.element.id>0&&r.relatedContext.element.id>0,S=async()=>{try{const r=L.value.filter(i=>i.id>0).map((i,c)=>({id:i.id,sort:L.value.length-c}));await De({sort_group:JSON.stringify(r)}),R.success("排序已保存")}catch(r){console.error("排序保存失败:",r),getGroupLists()}};return(r,i)=>{const c=Ve,h=Se,G=ze,ne=Ue,se=ye,me=ge,s=qe;return p(),b("div",ca,[a(dt,{class:"mb-16",tabs:q.value,active:"/library/list"},null,8,["tabs"]),a(_t,{class:"mb-16 mr-16",title:"使用说明"},{default:l(()=>i[6]||(i[6]=[o("div",null,[o("p",null," 1、知识库可以关联到聊天机器人中使用，创建机器人之前请先创建知识库，然后去机器人设置中关联。 "),o("p",null," 2、知识库支持普通知识库和问答知识库。普通知识库适用于非结构化数据，支持text/doc/pdf/md/html等格式文件，上传后系统会自动分段处理，也支持自定义分段。问答知识库适用于一问一答形式结构化数据，支持通过excel/word批量上传或自定义添加问题和答案。 ")],-1)])),_:1,__:[6]}),o("div",ma,[o("div",fa,[o("div",va,[a(ut,{tabs:M.value,value:e.value,"onUpdate:value":i[0]||(i[0]=w=>e.value=w),onChange:W},null,8,["tabs","value"])]),o("div",ha,[f.value?(p(),T(ne,{key:0},{overlay:l(()=>[a(G,null,{default:l(()=>[a(h,{onClick:i[2]||(i[2]=E(w=>D(0),["prevent"]))},{default:l(()=>[o("span",ka,[o("img",{class:"icon",src:g(ie),alt:""},null,8,ga),i[8]||(i[8]=o("span",null,"普通知识库",-1))])]),_:1}),a(h,{onClick:i[3]||(i[3]=E(w=>D(2),["prevent"]))},{default:l(()=>[o("span",ya,[o("img",{class:"icon",src:g(re),alt:""},null,8,ba),i[9]||(i[9]=o("span",null,"问答知识库",-1))])]),_:1})]),_:1})]),default:l(()=>[a(c,{type:"primary",onClick:i[1]||(i[1]=E(()=>{},["prevent"]))},{icon:l(()=>[a(g($e))]),default:l(()=>[i[7]||(i[7]=m(" 新建知识库 "))]),_:1,__:[7]})]),_:1})):I("",!0)])]),o("div",Ca,[o("div",{class:N(["group-list-box",{"hide-group":v.value}])},[a(s,{style:{"padding-right":"16px"}},{default:l(()=>[o("div",xa,[v.value?I("",!0):(p(),b("div",wa,[i[10]||(i[10]=o("div",null,"知识库分组",-1)),a(se,{title:"新建分组"},{default:l(()=>[o("div",{class:"hover-btn-wrap",onClick:i[4]||(i[4]=w=>t({}))},[a(g($e))])]),_:1})]))]),o("div",$a,[a(g(pt),{modelValue:L.value,"onUpdate:modelValue":i[5]||(i[5]=w=>L.value=w),"item-key":"id",onEnd:S,move:B,handle:".drag-btn"},{item:l(({element:w})=>[o("div",{class:N(["classify-item",{active:w.id==d.value}]),onClick:be=>le(w)},[o("div",Ia,[w.id>0?(p(),b("span",Ma,[a(me,{name:"drag"})])):(p(),b("span",Oa)),m(" "+V(w.group_name),1)]),o("div",za,[o("div",{class:N(["num",{"num-block":w.id<=0}])},V(w.total),3),w.id>0?(p(),b("div",Sa,[a(ne,{placement:"bottomRight"},{overlay:l(()=>[a(G,null,{default:l(()=>[a(h,null,{default:l(()=>[o("div",{onClick:E(be=>t(w),["stop"])},"重命名",8,Ga)]),_:2},1024),a(h,null,{default:l(()=>[o("div",{onClick:E(be=>P(w),["stop"])},"删 除",8,Aa)]),_:2},1024)]),_:2},1024)]),default:l(()=>[o("div",Ua,[a(g(je))])]),_:2},1024)])):I("",!0)])],10,La)]),_:1},8,["modelValue"])])]),_:1}),a(se,{placement:"right",title:v.value?"展开分组":"收起分组"},{default:l(()=>[o("div",{class:"hide-group-box",onClick:A},[v.value?(p(),T(g(ke),{key:1})):(p(),T(g(ct),{key:0}))])]),_:1},8,["title"])],2),a(s,{style:{"padding-right":"16px",flex:"1"}},{default:l(()=>[a(At,{"show-create":f.value,list:oe.value,onEdit:ue,onDelete:pe,onOpenEditGroupModal:u},null,8,["show-create","list"])]),_:1})])]),a(Dt,{ref_key:"addLibrayPopup",ref:$,onOk:ae},null,512),a(la,{ref_key:"addLibraryModelRef",ref:z},null,512),a(ra,{ref_key:"addGroupRef",ref:n,onOk:W},null,512),a(pa,{ref_key:"editGroupRef",ref:U,onOk:W},null,512)])}}},Ko=X(qa,[["__scopeId","data-v-accbd942"]]);export{Ko as default};
