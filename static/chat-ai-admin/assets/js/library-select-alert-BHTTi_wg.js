import{_ as P}from"./cu-scroll-qHaWhCWu.js";import{_ as Q,A as X,ah as Y}from"../../index-DxV-PNCd.js";import{u as Z}from"./robot-CbQxxX9E.js";import{I as ee,a0 as te,o as se,B as oe,az as ae,al as ne,V as le,M as ie,b as ce}from"./ui-antd-AfNpv4wx.js";import{r as re,f as d,e as de,ae as ue,ad as n,ar as l,as as s,k as a,u as x,ac as r,F as S,ax as B,ai as L,at as h,G as v,az as g}from"./vue-chunks-CGLjTDrY.js";const _e={class:"library-checkbox-box"},pe={class:"list-group-box"},he={class:"group-list-box"},ve={style:{"margin-bottom":"16px"}},fe={class:"classify-box"},ye=["onClick"],be={class:"classify-title"},ge={class:"right-content"},ke={class:"list-item-box"},me={class:"alert-box"},xe={class:"btn-box"},Le=["onClick"],Ce={class:"avatar-box"},we=["src"],Se={class:"info-content-box"},Be={class:"title-info-block"},Ne={key:0,class:"type-tag"},Ge={key:1,class:"type-tag"},Ve={key:2,class:"type-tag"},ze={key:3,class:"type-tag"},Ae={class:"desc-info-block"},Ie={class:"check-block"},Oe={class:"footer-box"},Re={__name:"library-select-alert",props:{showWxType:{type:Boolean,default:!1}},emits:["change"],setup(N,{expose:G,emit:V}){const z=Z(),{robotInfo:C}=z,A=V,I=N,i=re({indeterminate:!1,checkAll:!1,checkedList:[]}),u=d(""),w=d([]),O=()=>{Y().then(o=>{let e=o.data||[],c=0;e.forEach(y=>{c+=+y.total}),w.value=[{group_name:"全部",total:c,id:""},...e]})},R=o=>{u.value=o.id,f()},_=d(!1),T=o=>{u.value="",f(),O(),i.checkedList=o,_.value=!0},$=()=>{_.value=!1,M()},k=d(""),E=()=>{f()},m=d([]),F=de(()=>I.showWxType?m.value:m.value.filter(o=>o.type!=3)),M=()=>{A("change",[...i.checkedList])},f=async()=>{p.value=!0;const o=await X({library_name:k.value,type:"",show_open_docs:1});if(p.value=!1,o){let e=o.data||[];u.value!=""&&(e=e.filter(c=>c.group_id==u.value)),m.value=e}},U=o=>{let e=o.id;C.default_library_id!=e&&(i.checkedList.includes(e)?i.checkedList=i.checkedList.filter(c=>c!=e):i.checkedList.push(e))},p=d(!1),W=async()=>{p.value=!0,await f(),p.value=!1,ce.success("刷新完成")},D=()=>{window.open("/#/library/list")};return G({open:T}),(o,e)=>{const c=ee,y=P,K=se,b=oe,j=le,q=ne,H=ie;return n(),ue(H,{width:916,open:_.value,"onUpdate:open":e[2]||(e[2]=t=>_.value=t),wrapClassName:"correlation-library-modal",title:null,footer:null},{default:l(()=>[s("div",_e,[s("div",pe,[s("div",he,[e[3]||(e[3]=s("div",{class:"main-title-block"},"关联知识库",-1)),s("div",ve,[a(c,{style:{width:"216px"},value:k.value,"onUpdate:value":e[0]||(e[0]=t=>k.value=t),placeholder:"请输入知识库名称搜索",onChange:E},{suffix:l(()=>[a(x(te),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),a(y,{style:{"padding-right":"16px",height:"480px"}},{default:l(()=>[s("div",fe,[(n(!0),r(S,null,B(w.value,t=>(n(),r("div",{class:L(["classify-item",{active:t.id==u.value}]),onClick:J=>R(t),key:t.id},[s("div",be,h(t.group_name),1),s("div",ge,[s("div",{class:L(["num",{"num-block":t.id<=0}])},h(t.total),3)])],10,ye))),128))])]),_:1})]),s("div",ke,[s("div",me,[a(K,{class:"zm-alert-info",message:"请选择关联知识库，机器人会根据知识库内上传的文档回复用户的提问。每个机器人最多关联5个知识库",type:"info"})]),s("div",xe,[a(b,{onClick:W},{default:l(()=>[a(x(ae)),e[4]||(e[4]=v(" 刷新 ",-1))]),_:1}),a(b,{type:"primary",ghost:"",onClick:D},{default:l(()=>[...e[5]||(e[5]=[v("新建知识库",-1)])]),_:1})]),a(q,{spinning:p.value,delay:100},{default:l(()=>[a(y,{style:{padding:"0 16px",height:"414px"}},{default:l(()=>[(n(!0),r(S,null,B(F.value,t=>(n(),r("div",{class:"library-list-item",onClick:J=>U(t),key:t.id},[s("div",Ce,[s("img",{src:t.avatar,alt:""},null,8,we)]),s("div",Se,[s("div",Be,[v(h(t.library_name)+" ",1),s("span",{class:L(["type-tag",{"gray-tag":t.graph_switch==0}])},"Graph",2),t.type==0?(n(),r("span",Ne,"普通知识库")):g("",!0),t.type==1?(n(),r("span",Ge,"对外知识库")):g("",!0),t.type==2?(n(),r("span",Ve,"问答知识库")):g("",!0),t.type==3?(n(),r("span",ze,"公众号知识库")):g("",!0)]),s("div",Ae,h(t.library_intro),1)]),s("div",Ie,[a(j,{disabled:x(C).default_library_id==t.id,checked:i.checkedList.includes(t.id)},null,8,["disabled","checked"])])],8,Le))),128))]),_:1})]),_:1},8,["spinning"]),s("div",Oe,[a(b,{onClick:e[1]||(e[1]=t=>_.value=!1)},{default:l(()=>[...e[6]||(e[6]=[v("取消",-1)])]),_:1}),a(b,{type:"primary",onClick:$},{default:l(()=>[v(" ("+h(i.checkedList.length)+") 确定",1)]),_:1})])])])])]),_:1},8,["open"])}}},Ue=Q(Re,[["__scopeId","data-v-d140cbb5"]]);export{Ue as L};
