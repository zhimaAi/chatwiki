import{_ as H}from"./cu-scroll-bISEQWPA.js";import{Q as P,K as W}from"./knowledge-document-BjgwB9bR.js";import{bv as X,b as K,e as Z,B as J,d as tt,a1 as ot,bw as it,bx as rt,by as et,M as at,k as st,bz as lt,n as T}from"../../index-Bo1NSLpy.js";import{u as V}from"./robot-ppsw7ttj.js";import{b as R,d as w,q as D,N as l,O as e,S as b,a6 as m,F as E,a3 as N,a8 as nt,z as ct,h as _t,X as o,j as _,U as c,Z as A,a1 as pt,a0 as k,u as Y,_ as y,a5 as dt,G as mt,a2 as ut}from"./vue-chunks-BRsu9_To.js";import{G as yt}from"./index-L62dqcZj.js";import{L as bt}from"./library-select-alert-DOD3bHe4.js";import{M as ft,_ as vt}from"./index-Dxy-C30T.js";import"./index-BZOjzqJ2.js";import{D as ht}from"./dropdown-DAy60lp8.js";import{_ as gt}from"./index-B4MPC5xv.js";import{T as kt,_ as wt}from"./index-DkO_ejiW.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./edit-subsection-CYWKZwTV.js";import"./index-CyCFeYRk.js";import"./index-BjF4Ni-g.js";import"./index-Caod9rOO.js";import"./Input-CCKFAS4o.js";import"./FormItemContext-Cv3f2sEj.js";import"./index-CuPJUS8f.js";import"./inputProps--_pnbyjO.js";import"./Search-BF8URtRh.js";import"./SearchOutlined-CFTHZIcT.js";import"./isPlainObject-CHj0iPA3.js";import"./TextArea--DLJ7VtX.js";import"./index-BwedndIp.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./Password-CJww1n-s.js";import"./index-C19UYW2Z.js";import"./Trigger-DtRTHvld.js";import"./index-COWZrpvC.js";import"./Col-QoogualX.js";import"./responsiveObserve-D3ho5cFZ.js";import"./hasIn-BtXuxCTT.js";import"./collapseMotion-Brd6xpAT.js";import"./QuestionCircleOutlined-VG1FNUnl.js";import"./DownloadOutlined-BfFY8ehf.js";import"./index-OqAdRPIm.js";import"./CheckOutlined-C6m5maw6.js";import"./useRefs-CRRjy_qY.js";import"./useMergedState-C0iIHNGF.js";import"./util-BwuffJOK.js";import"./index-CEq6_GyH.js";import"./index-BPmrcBow.js";import"./index-BMSQkwth.js";import"./index-Bs02Ec-o.js";import"./slide-CVAZ5BEM.js";import"./List-qVz67bUg.js";import"./DownOutlined-CrhRpWT5.js";import"./move-DztQgbGg.js";import"./LeftOutlined-6ERu0fUO.js";import"./index-QWfBu8FK.js";import"./index-DrD42LNC.js";import"./UpOutlined-DWTDMQqv.js";import"./EditOutlined-fieznxtM.js";import"./index-Ct9MFKxB.js";import"./index-C_M0mW4F.js";import"./CaretDownFilled-DQ5FyPd3.js";import"./index-BeCYXilq.js";import"./index-eahgXICC.js";import"./RightOutlined-zEOifMPB.js";import"./index-kP7DVVOS.js";import"./Checkbox-B_uQPvVs.js";import"./index-Bb6fuwF7.js";import"./RadioButton-CWIeNl_M.js";import"./CaretDownOutlined-C8EH_hS-.js";import"./index-pj8Mdu_P.js";import"./colors-4myZb9T8.js";import"./PlusOutlined-vSxn8uyP.js";import"./index-thzOhi6-.js";import"./index-Bbrx8UDU.js";import"./upload-input-CAOE_TyJ.js";import"./InboxOutlined-CtX7CdvH.js";import"./validate-8MtiUsxW.js";import"./model-select-BSeLg_eN.js";import"./open-grapg-modal-DWemoT0e.js";import"./index-Dc6vrBX7.js";import"./rename-modal-CYziNvqI.js";import"./page-alert-RWJRrkK6.js";import"./index-6kOkS7uh.js";import"./index-D-M8_C_F.js";import"./ClockCircleOutlined-mLHYPvMf.js";import"./shallowequal-C0xnIuy8.js";import"./vuedraggable.umd-CIIT_a56.js";import"./CopyOutlined-DJAqUihB.js";import"./ClockCircleFilled-CqIMCeuB.js";import"./index-BDD9MbSg.js";import"./SyncOutlined-BFvMifVP.js";import"./MoreOutlined-BVPLZ6JB.js";import"./index-Dlji98bI.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Dropdown-hEIgqeS3.js";import"./pick-CHoP6n6n.js";const xt={__name:"default-library",setup(M){const f=V(),p=R(()=>f.robotInfo.default_library_id),n=w(null);return D(()=>{X({id:p.value}).then(u=>{n.value=+u.data.type||0})}),(u,v)=>(e(),l(E,null,[n.value==2?(e(),b(P,{key:0,library_id:p.value},null,8,["library_id"])):m("",!0),n.value==0?(e(),b(W,{key:1,library_id:p.value},null,8,["library_id"])):m("",!0)],64))}},Lt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1749612065457'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5081'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='256'%20height='256'%3e%3cpath%20d='M0%200v1024L1024%200H0z%20m294.4%20172.8h12.8c22.4%200%2048-3.2%2060.8%200v32c-19.2-3.2-51.2%200-76.8%200l3.2-32z%20m-128%20422.4l44.8-48-19.2-16-38.4%2038.4-19.2-19.2L172.8%20512l-12.8-12.8-38.4%2038.4L28.8%20448%20128%20348.8l92.8%2092.8L179.2%20480l16%2016%2038.4-38.4%2019.2%2019.2L214.4%20512l16%2016%2038.4-44.8%2019.2%2019.2c-35.2%2041.6-73.6%2083.2-99.2%20112l-22.4-19.2z%20m60.8%2073.6c-6.4-19.2-16-44.8-25.6-64l22.4-6.4c9.6%2019.2%2022.4%2044.8%2025.6%2064l-22.4%206.4z%20m48-38.4c-9.6-12.8-28.8-28.8-44.8-41.6l9.6-12.8c16%209.6%2035.2%2025.6%2048%2038.4l-12.8%2016z%20m22.4-32c-9.6-9.6-28.8-22.4-44.8-32l9.6-16c16%209.6%2035.2%2019.2%2048%2028.8l-12.8%2019.2z%20m16-35.2c-9.6-6.4-25.6-16-41.6-19.2l9.6-19.2c16%203.2%2032%2012.8%2041.6%2019.2l-9.6%2019.2z%20m48-9.6c-9.6%200-22.4%200-32%203.2-3.2-70.4-38.4-128-73.6-169.6l-38.4%2038.4-22.4-22.4%2038.4-38.4-9.6-9.6-57.6-57.6%2019.2-19.2%2019.2%2019.2%206.4-22.4c22.4%203.2%2051.2%206.4%2067.2%2012.8l-6.4%2022.4c-16-6.4-44.8-9.6-67.2-12.8l48%2048%2048-48%2022.4%2022.4-48%2048c60.8%2041.6%20121.6%2070.4%20172.8%2064%200%209.6%200%2022.4%203.2%2032-41.6%203.2-86.4-16-134.4-44.8%2022.4%2041.6%2041.6%2083.2%2044.8%20134.4z%20m150.4-163.2c-6.4-3.2-22.4-3.2-28.8-3.2%200-9.6%200-25.6-12.8-38.4l-80-80L352%20307.2l-22.4-22.4%2064-60.8%2099.2%2099.2%209.6-44.8%2025.6%2012.8c-16%2076.8-16%2089.6-16%2099.2z%20m67.2-51.2c-9.6-3.2-25.6-3.2-35.2%200%2016-102.4-64-182.4-144-262.4l-9.6-9.6%2025.6-22.4c25.6%2025.6%2048%2051.2%2070.4%2076.8%2028.8%2022.4%20112%2086.4%20201.6%2070.4-3.2%209.6%200%2025.6%200%2035.2-54.4%209.6-108.8-12.8-150.4-35.2%2032%2044.8%2048%2096%2041.6%20147.2z'%20p-id='5082'%20fill='%232475fc'%3e%3c/path%3e%3cpath%20d='M124.8%20384l-25.6%2025.6L160%20467.2l25.6-25.6L124.8%20384z%20m25.6%2067.2c-6.4-12.8-19.2-35.2-28.8-48l16-6.4c9.6%2016%2019.2%2038.4%2022.4%2051.2l-9.6%203.2zM64%20444.8l60.8%2060.8%2022.4-25.6-60.8-60.8-22.4%2025.6z%20m57.6%2041.6c-9.6-9.6-28.8-22.4-44.8-28.8l6.4-12.8c16%206.4%2035.2%2019.2%2044.8%2028.8l-6.4%2012.8z'%20p-id='5083'%20fill='%232475fc'%3e%3c/path%3e%3c/svg%3e",Ct={class:"main-content-block"},St={class:"btn-block"},zt={class:"list-box"},Rt=["onClick"],At={key:0,class:"default-icon",src:Lt,alt:""},Dt={class:"library-info"},Mt=["src"],It={class:"library-info-content"},$t={class:"library-title"},Tt={class:"library-type"},Yt={key:0,class:"type-tag"},Bt={key:1,class:"type-tag"},Kt={key:2,class:"type-tag"},Vt={class:"item-body"},Et={class:"library-desc"},Nt={class:"item-footer"},qt={class:"library-size"},Gt={class:"text-item"},Ot={class:"text-item"},jt={class:"text-item"},Ft=["onClick"],Qt=["onClick"],Ut={__name:"related-library",setup(M){const f=Z(),p=R(()=>{var t;return((t=f.companyInfo)==null?void 0:t.neo4j_status)=="true"}),n=N().query,u=V(),{getRobot:v}=u,{robotInfo:d}=nt(u),a=ct({library_ids:[],default_library_id:""}),h=w([]),g=w(null),x=R(()=>{let t=h.value.filter(i=>a.library_ids.includes(i.id));if(d.value.default_library_id){let i=t.find(s=>s.id==d.value.default_library_id);i&&(t=t.filter(s=>s.id!=d.value.default_library_id),t.unshift(i))}return t}),L=t=>{let i=a.library_ids.indexOf(t.id);a.library_ids.splice(i,1),z()},C=t=>{at.confirm({title:`确定将${t.library_name}设为默认知识库吗？`,icon:null,content:_("div",{style:"color:red;"},"一个机器人只能有一个默认知识库"),onOk(){a.default_library_id=t.id,z(a.default_library_id)},onCancel(){}})},S=()=>{g.value.open([...a.library_ids])},q=t=>{a.library_ids=[...t],z()},z=t=>{let i={...mt(a)};i.library_ids=i.library_ids.join(","),yt({library_ids:i.library_ids,default_library_id:t||null,id:n.id}).then(s=>{st.success("操作成功"),v(n.id)})};_t(()=>{a.library_ids=d.value.library_ids.split(","),a.default_library_id=d.value.default_library_id||""});const G=t=>{t.type=="1"?window.open(`/#/public-library/config?library_id=${t.id}`,"_blank","noopener"):window.open(`/#/library/details?id=${t.id}`,"_blank","noopener")},O=async()=>{const t=await ot({type:"",show_open_docs:1});if(t){let i=t.data||[];i.forEach(s=>{s.file_size_str=it(s.file_size),s.avatar||(s.avatar=s.type==0?rt:et)}),h.value=i}};return D(()=>{O()}),(t,i)=>{const s=J,j=gt,F=tt,I=vt,Q=ft,U=ht;return e(),l("div",Ct,[o("div",St,[_(s,{type:"primary",onClick:S},{default:c(()=>i[2]||(i[2]=[A("关联知识库")])),_:1,__:[2]})]),o("div",zt,[(e(!0),l(E,null,pt(x.value,r=>(e(),l("div",{class:"list-item-wrapper",key:r.id},[o("div",{class:"list-item",onClick:k($=>G(r),["stop"])},[r.id==Y(d).default_library_id?(e(),l("img",At)):m("",!0),o("div",Dt,[o("img",{class:"library-icon",src:r.avatar,alt:""},null,8,Mt),o("div",It,[o("div",$t,y(r.library_name),1),o("div",Tt,[r.type==0?(e(),l("span",Yt,"普通知识库")):m("",!0),r.type==1?(e(),l("span",Bt,"对外知识库")):m("",!0),r.type==2?(e(),l("span",Kt,"问答知识库")):m("",!0),p.value?(e(),b(j,{key:3},{title:c(()=>[A(y(r.graph_switch==0?"未":"已")+"开启知识图谱生成",1)]),default:c(()=>[o("span",{class:dt(["type-tag graph-tag",{"gray-tag":r.graph_switch==0}])},"Graph",2)]),_:2},1024)):m("",!0)])])]),o("div",Vt,[o("div",Et,y(r.library_intro),1)]),o("div",Nt,[o("div",qt,[o("span",Gt,"文档："+y(r.file_total),1),o("span",Ot,"大小："+y(r.file_size_str),1),o("span",jt,"关联应用："+y(r.robot_nums||0),1)]),r.id!=Y(d).default_library_id?(e(),l("div",{key:0,class:"action-box",onClick:i[1]||(i[1]=k(()=>{},["stop"]))},[_(U,null,{overlay:c(()=>[_(Q,null,{default:c(()=>[r.type!=1?(e(),b(I,{key:0},{default:c(()=>[o("a",{onClick:k($=>C(r),["stop"])},"设为默认",8,Ft)]),_:2},1024)):m("",!0),_(I,null,{default:c(()=>[o("a",{class:"delete-text-color",onClick:k($=>L(r),["stop"])},"取消关联",8,Qt)]),_:2},1024)]),_:2},1024)]),default:c(()=>[o("div",{class:"action-item",onClick:i[0]||(i[0]=k(()=>{},["stop"]))},[_(F,{class:"action-icon",name:"point-h"})])]),_:2},1024)])):m("",!0)])],8,Rt)]))),128))]),_(bt,{ref_key:"librarySelectAlertRef",ref:g,onChange:q},null,512)])}}},Ht=K(Ut,[["__scopeId","data-v-e875e068"]]),Pt={class:"main-content-block"},Wt={class:"tab-right-extra"},Xt={key:0,class:"body-content-box",style:{"padding-right":"16px"}},Zt={key:1,class:"body-content-box"},B="/robot/config/library-config/activeKey",Jt={__name:"index",setup(M){const f=ut(),p=N().query,n=w(+localStorage.getItem(B)||1),u=()=>{localStorage.setItem(B,n.value)},v=w(0),d=async()=>{lt({robot_id:p.id,start_date:T().subtract(6,"day").format("YYYY-MM-DD"),end_date:T().format("YYYY-MM-DD")}).then(h=>{v.value=h.data.header.library_hit_rate})},a=()=>{localStorage.setItem("/robot/config/statistical_analysis/activeKey",3),f.push({path:"/robot/config/statistical_analysis",query:{id:p.id,robot_key:p.robot_key}})};return D(()=>{d()}),(h,g)=>{const x=wt,L=kt,C=H;return e(),l("div",Pt,[_(L,{class:"tab-wrapper",activeKey:n.value,"onUpdate:activeKey":g[0]||(g[0]=S=>n.value=S),onChange:u},{rightExtra:c(()=>[o("div",Wt,[A(" 近7天客户消息知识库命中率："+y(v.value)+"% ",1),o("a",{onClick:a},"查看")])]),default:c(()=>[(e(),b(x,{key:1,tab:"默认知识库"})),(e(),b(x,{key:2,tab:"关联知识库"}))]),_:1},8,["activeKey"]),n.value==1?(e(),l("div",Xt,[_(xt)])):(e(),l("div",Zt,[_(C,null,{default:c(()=>[_(Ht)]),_:1})]))])}}},jo=K(Jt,[["__scopeId","data-v-b0e673b1"]]);export{jo as default};
