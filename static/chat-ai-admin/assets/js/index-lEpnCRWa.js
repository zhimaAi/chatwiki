import{_ as A,b as B,bV as J,bs as W,d as X,bX as Y}from"../../index-WMhSApoa.js";import{C as H}from"./config-page-menu-DZBa7NgR.js";import{e as C,f as w,r as x,w as K,o as F,ac as N,as as i,k as r,at as h,u as l,ar as c,af as S,B as Q,G as Z,ad as O,J as U}from"./vue-chunks-CGLjTDrY.js";import{A as ee}from"./avatar-input--OeMFrt_.js";import{b as V,F as I,e as ae,I as te,$ as oe,B as re}from"./ui-antd-BDReVt-O.js";import"./neo4j-CK9lNpyi.js";import"./utils-DXEytJvC.js";import"./other-BrZCAsTs.js";const le={class:"form-box"},ne={class:"form-box-header"},se={class:"form-box-label"},ie={class:"form-box-label-text"},_e={class:"form-item-tip"},ce={__name:"library-form",props:{value:{type:Object,default:()=>({})},saveLoading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(f,{emit:p}){const{t}=B("views.public-library.config.components.library-form"),n=J(),_=C(()=>n.getCurrentLocale.lang==="zh-CN"?6:24),b=C(()=>n.getCurrentLocale.lang==="zh-CN"?6:0);V.config({duration:2});const v=p,g=f,o=w(1),u=I.useForm,y=w(!1),k=W,a=x({type:o.value,library_name:"",library_intro:"",use_model:"",avatar:k,avatar_file:"",is_offline:!1,model_config_id:""}),$=x({library_name:[{required:!0,message:t("library_name_required"),trigger:"change"}],library_intro:[{required:!0,message:t("library_intro_required"),trigger:"change"}]}),q=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},{validate:P,validateInfos:L}=u(a,$),R=()=>{P().then(()=>{j()}).catch(e=>{})},j=()=>{let e=U(a);v("submit",e)},z=e=>{y.value=+e.type,a.library_name=e.library_name,a.library_intro=e.library_intro,a.use_model=e.use_model,a.model_config_id=e.model_config_id,a.avatar=e.avatar?e.avatar:k,a.avatar_file=e.avatar_file?e.avatar_file:"",a.is_offline=e.is_offline};return K(g.value,e=>{z({...e})}),F(()=>{}),(e,s)=>{const E=X,M=te,m=ae,D=oe,T=re,G=I;return O(),N("div",le,[i("div",ne,[i("div",se,[r(E,{class:"form-box-label-icon",name:"book",style:{"font-size":"16px",color:"#333"}}),i("span",ie,h(l(t)("knowledge_base_info")),1)]),s[3]||(s[3]=i("div",null,null,-1))]),r(G,{"label-col":{span:_.value},style:{width:"600px"}},{default:c(()=>[r(m,S({ref:"name",label:l(t)("knowledge_base_name_label")},l(L).library_name),{default:c(()=>[r(M,{value:a.library_name,"onUpdate:value":s[0]||(s[0]=d=>a.library_name=d),placeholder:l(t)("knowledge_base_name_placeholder"),"show-count":"",maxlength:20},null,8,["value","placeholder"])]),_:1},16,["label"]),r(m,{label:l(t)("knowledge_base_intro_label")},{default:c(()=>[r(D,{value:a.library_intro,"onUpdate:value":s[1]||(s[1]=d=>a.library_intro=d),placeholder:l(t)("knowledge_base_intro_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),r(m,S({ref:"name",label:l(t)("knowledge_base_cover_label")},l(L).avatar),{default:c(()=>[r(ee,{value:a.avatar,"onUpdate:value":s[2]||(s[2]=d=>a.avatar=d),onChange:q},null,8,["value"]),i("div",_e,h(l(t)("knowledge_base_cover_tip")),1)]),_:1},16,["label"]),r(m,{"wrapper-col":{offset:b.value,span:8}},{default:c(()=>[r(T,{type:"primary",style:{"margin-left":"8px"},loading:f.saveLoading,onClick:Q(R,["prevent"])},{default:c(()=>[Z(h(l(t)("save_btn")),1)]),_:1},8,["loading"])]),_:1},8,["wrapper-col"])]),_:1},8,["label-col"])])}}},de=A(ce,[["__scopeId","data-v-926526cd"]]),ue={class:"add-library-page"},me={class:"page-container"},fe={class:"form-box-wrapper"},pe={__name:"index",setup(f){const{t:p}=B("views.public-library.config.index"),t=Y(),n=x({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),_=w(!1),b=o=>{Object.assign(n,o),_.value=!0,v().then(()=>{_.value=!1}).catch(()=>{_.value=!1})},v=async()=>{let o={...U(n)};delete o.library_key,o.avatar_file?(o.avatar=o.avatar_file,delete o.avatar_file):(delete o.avatar,delete o.avatar_file),await t.saveEditLibrary(o),V.success(p("modify_success"))},g=()=>{Object.assign(n,{...t.libraryInfo})};return F(()=>{g()}),(o,u)=>(O(),N("div",ue,[r(H),i("div",me,[i("div",fe,[r(de,{value:n,"onUpdate:value":u[0]||(u[0]=y=>n=y),saveLoading:_.value,onSubmit:b},null,8,["value","saveLoading"])])])]))}},Le=A(pe,[["__scopeId","data-v-690d7065"]]);export{Le as default};
