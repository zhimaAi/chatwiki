import{c as L,r as S,E as m,j as V,a as C,p as f,y as r,t as o,ag as O,b as U,m as c,u as y,_ as v,Y as D}from"./vue-chunks-BdaA73Wf.js";import{ay as E,bt as J,bm as M,aw as T}from"../../index-DSFcP5NQ.js";import{A as Y}from"./avatar-input-C3IZiYPk.js";import{t as P}from"./validate-8MtiUsxW.js";import{_ as j}from"./emoji-mart-BBMRoEa3.js";import{b,F as g,c as H,I as z,V as G,B as K}from"./ui-antd-Dl1wwwCD.js";import"./editor-cherry-CFIsbKoN.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";const Q={class:"add-library-page"},W={class:"form-box"},X={__name:"index",setup(Z){b.config({duration:2});const p=O(),i=L(()=>1),x=g.useForm,n=S(!1),A=i.value==0?E:J,a=m({type:i.value,access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:A,avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:i.value==2?1:0,qa_index_type:1,doc_auto_renew_frequency:1}),q=m({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}]}),{validate:h,validateInfos:d}=x(a,q),w=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},k=()=>{p.back()},F=()=>{h().then(()=>{I()}).catch(e=>{})},I=()=>{let e=new FormData,t=JSON.parse(JSON.stringify(a));e.append("type",a.type),e.append("access_rights",a.access_rights),e.append("library_name",a.library_name),e.append("library_intro",a.library_intro),e.append("use_model",t.use_model),e.append("model_config_id",a.model_config_id),e.append("avatar",a.avatar_file?a.avatar_file:""),e.append("is_offline",a.is_offline),e.append("urls",JSON.stringify(P(a.urls))),e.append("doc_type",a.doc_type),e.append("file_name",a.file_name),e.append("is_qa_doc",a.is_qa_doc),e.append("qa_index_type",a.qa_index_type),e.append("doc_auto_renew_frequency",a.doc_auto_renew_frequency),e.append("is_default",2),n.value=!0,M(e).then(_=>{b.success("创建成功"),N(_.data.id)}).catch(()=>{n.value=!1})},N=e=>{T({id:e}).then(t=>{n.value=!1,p.replace({path:"/public-library/config",query:{library_id:t.data.id,library_key:t.data.library_key}})}).catch(()=>{n.value=!1})};return V(()=>{}),(e,t)=>{const _=z,s=H,R=G,u=K,B=g;return U(),C("div",Q,[f("div",W,[r(B,{"label-col":{span:5}},{default:o(()=>[r(s,c({ref:"name",label:"知识库名称"},y(d).library_name),{default:o(()=>[r(_,{value:a.library_name,"onUpdate:value":t[0]||(t[0]=l=>a.library_name=l),type:"text",placeholder:"请输入知识库名称，最多20个字",maxlength:20},null,8,["value"])]),_:1},16),r(s,{label:"知识库简介"},{default:o(()=>[r(R,{value:a.library_intro,"onUpdate:value":t[1]||(t[1]=l=>a.library_intro=l),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),r(s,c({ref:"name",label:"知识库封面"},y(d).avatar),{default:o(()=>[r(Y,{value:a.avatar,"onUpdate:value":t[2]||(t[2]=l=>a.avatar=l),onChange:w},null,8,["value"]),t[3]||(t[3]=f("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1},16),r(s,{"wrapper-col":{span:14,offset:4}},{default:o(()=>[r(u,{onClick:k},{default:o(()=>[...t[4]||(t[4]=[v("取 消",-1)])]),_:1}),r(u,{type:"primary",style:{"margin-left":"16px"},loading:n.value,onClick:D(F,["prevent"])},{default:o(()=>[...t[5]||(t[5]=[v("下一步",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})])])}}},da=j(X,[["__scopeId","data-v-daaf0454"]]);export{da as default};
//# sourceMappingURL=index-zy52srhk.js.map
