import{_ as E}from"./cu-scroll-4Aau5PhQ.js";import{aa as T,Y as f,_ as h,F as S,a9 as $,a5 as n,k as i,a7 as C,G as y,f as x,o as M,w as U,a2 as m}from"./vue-chunks-Ci-XTWEs.js";import{g as A}from"./index-C-wOrj-7.js";import{t as F,v as D}from"./index-BWYmMYOg.js";import{b as B,d as O}from"../../index-CuuB1UbP.js";import{X as V,M as L,ag as z,B as Y,a as R}from"./ui-antd-DhoCz7ZP.js";import{_ as q}from"./main-tab-rgBCXMFa.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./utils-ChQO-_r6.js";import"./list-tabs-9JfQ5j74.js";import"./index-Dmsgh_44.js";const G={class:"list-box"},K=["onClick"],W={class:"explore-info"},X={class:"explore-info-content"},j={class:"explore-title"},H={class:"item-body"},J={class:"explore-desc"},P={class:"support-box"},Q={class:"item-footer"},Z={__name:"index",props:{list:{type:Array,default:()=>[]}},emits:["switchChange","clickItem"],setup(I,{emit:v}){const l=v,p=T(),u=I,k=(r,a)=>l("switchChange",r,a),w=async(r,a)=>{try{const c=r==null?void 0:r.target;if(c&&typeof c.closest=="function"&&c.closest(".no-bubble"))return;if(a.ability_type=="robot_subscribe_reply"){p.push({path:"/explore/index/subscribe-reply"});return}}catch{}l("clickItem",a)};return(r,a)=>{const c=O,b=V;return h(),f("div",G,[(h(!0),f(S,null,$(u.list,t=>{var o,e;return h(),f("div",{class:"list-item-wrapper",key:t.id},[n("div",{class:"list-item",onClick:s=>w(s,t)},[n("div",W,[i(c,{class:"explore-icon",name:t.ability_type,style:{"font-size":"62px",color:"white"}},null,8,["name"]),n("div",X,[n("div",j,C(t.explore_name||t.name),1),a[0]||(a[0]=n("div",{class:"explore-type"},"ChatWiki",-1))])]),n("div",H,[n("div",J,C(t.explore_intro||t.introduction),1),n("span",P,[(h(!0),f(S,null,$(t.support_channels_list,s=>(h(),f("span",{key:s,class:"support-item"},[i(c,{name:"support",class:"icon"}),y(" "+C(s),1)]))),128))])]),n("div",Q,[i(b,{checked:((o=t.user_config)==null?void 0:o.switch_status)=="1"||((e=t.robot_config)==null?void 0:e.switch_status)=="1","checked-children":"开","un-checked-children":"关",class:"no-bubble",onChange:s=>k(t,s)},null,8,["checked","onChange"])])],8,K)])}),128))])}}},tt=B(Z,[["__scopeId","data-v-87948b16"]]),ot={"bg-color":"#f5f9ff",class:"explore-page"},et={class:"explore-page-body"},st={class:"list-toolbar"},nt={class:"toolbar-box"},at={class:"list-group-box"},it={class:"enable-tip-footer"},lt={class:"footer-actions"},N="explore_enable_tip_suppress_until",ct={__name:"explore-index",setup(I){new URL("@/assets/svg/default-explore.svg",import.meta.url).href;const v=x([]),l=x(!1),p=x(!1),u=T();M(()=>{localStorage.getItem("zm:explore:active")>1?u.push({path:"/plugins/index"}):w()});let k=x([]);const w=()=>{F().then(t=>{const o=((t==null?void 0:t.data)||[]).map(e=>({...e,explore_name:e.name,explore_intro:e.introduction}));v.value=o,k.value=(t==null?void 0:t.data)||[]})},r=(t,o)=>{const e=o?"1":"0";if(e==="0"){L.confirm({title:"提示",content:"关闭后，功能中心将不再显示该功能，并无法使用，其他调用的位子也将失效，确认关闭么？",onOk:()=>{D({ability_type:t.ability_type,switch_status:e}).then(s=>{s&&s.res==0&&(R.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e))})}});return}D({ability_type:t.ability_type,switch_status:e}).then(s=>{if(s&&s.res==0){R.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e);const d=Number(localStorage.getItem(N)||0),g=Date.now();d<=g&&(p.value=!1,t.ability_type!=="robot_subscribe_reply"&&(l.value=!0))}})},a=()=>{if(p.value){const t=Date.now()+2592e5;localStorage.setItem(N,String(t))}},c=()=>{a(),l.value=!1},b=async()=>{a(),l.value=!1;const t=localStorage.getItem("last_local_robot_id");try{const{data:o=[]}=await A();if(!o.length){const _=u.resolve({path:"/robot/list"});window.open(_.href,"_blank");return}let e;t&&(e=o.find(_=>_.id==t)),e=e||o[0];const{id:s,robot_key:d}=e,g=u.resolve({path:"/robot/config/function-center",query:{id:s,robot_key:d}});window.open(g.href,"_blank")}catch{const e=u.resolve({path:"/robot/list"});window.open(e.href,"_blank")}};return U(l,(t,o)=>{o&&!t&&a()}),(t,o)=>{const e=E,s=z,d=Y,g=L;return h(),f("div",ot,[n("div",et,[n("div",st,[n("div",nt,[i(q)])]),n("div",at,[i(e,{style:{"padding-right":"16px",flex:"1"}},{default:m(()=>[i(tt,{list:v.value,onSwitchChange:r,onClickItem:b},null,8,["list"])]),_:1})])]),i(g,{open:l.value,"onUpdate:open":o[1]||(o[1]=_=>l.value=_),title:"提示",footer:null},{default:m(()=>[o[5]||(o[5]=n("div",null,"开启该功能后请到机器人>功能中心，配置并使用该功能",-1)),n("div",it,[i(s,{checked:p.value,"onUpdate:checked":o[0]||(o[0]=_=>p.value=_)},{default:m(()=>o[2]||(o[2]=[y("3天内不再提醒")])),_:1,__:[2]},8,["checked"]),n("div",lt,[i(d,{onClick:c},{default:m(()=>o[3]||(o[3]=[y("取消")])),_:1,__:[3]}),i(d,{type:"primary",onClick:b},{default:m(()=>o[4]||(o[4]=[y("去使用")])),_:1,__:[4]})])])]),_:1,__:[5]},8,["open"])])}}},yt=B(ct,[["__scopeId","data-v-b63f73ca"]]);export{yt as default};
