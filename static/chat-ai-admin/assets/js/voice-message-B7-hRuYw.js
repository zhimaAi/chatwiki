import{C as S}from"./editor-cherry-CFIsbKoN.js";import{c as T,a as c,b as i,r as _,w as C,p as s,q as L,h as P,v,u as m,z as B,A as V,F as E,l as N,y as $}from"./vue-chunks-BdaA73Wf.js";import{u as I}from"../../index-DSFcP5NQ.js";import{_ as h}from"./emoji-mart-BBMRoEa3.js";function H(e){return e=e.replace(/```markdown([\s\S]*)```/g,(o,l)=>l.trim()),e=e.replace(/```markdown/g,""),e}function J(e){return e=H(e),e}const U=["innerHTML"],le={__name:"index",props:{content:{type:String,default:""}},setup(e){const o=e,l=new S({engine:{global:{classicBr:!0,flowSessionContext:!0},syntax:{codeBlock:{theme:"dark",wrap:!0,lineNumber:!1,copyCode:!0,editCode:!1,changeLang:!0},link:{target:"_blank"},autoLink:{target:"_blank",enableShortLink:!1},header:{anchorStyle:"none"},mathBlock:{plugins:!0,engine:"MathJax",src:"./libs/MathJax/es5/tex-svg.js"},inlineMath:{engine:"MathJax"}}}}),n=T(()=>{let t=J(o.content);return l.makeHtml(t)});return(t,d)=>(i(),c("div",{class:"vue-markdown cherry-markdown",innerHTML:n.value},null,8,U))}},z={class:"voice-play-container"},A={class:"voice-controls"},D=["disabled"],F={key:0,class:"play-content"},R={class:"text1"},j={class:"text2"},q={key:1,class:"play-content"},G={class:"text1"},K={class:"text2"},O={key:0,class:"progress-container"},Q=["max"],W={class:"time-info"},X=["src"],Y={__name:"voice-player",props:{url:{type:String,default:""},showProgress:{type:Boolean,default:!1}},setup(e){const{t:o}=I("views.robot.robot-test.components.voice-player"),l=e,n=_(null),t=_(!1),d=_(0),u=_(0),p=_(!1),k=()=>{if(!l.url)return;const r=n.value;t.value?(r.pause(),t.value=!1):(p.value=!0,r.play().then(()=>{t.value=!0,p.value=!1}).catch(a=>{console.error(o("msg_play_failed"),a),p.value=!1}))},y=()=>{d.value=n.value.duration},x=()=>{u.value=n.value.currentTime},b=()=>{t.value=!1,u.value=0},w=()=>{console.error(o("msg_audio_error")),t.value=!1,p.value=!1},M=()=>{n.value&&(n.value.currentTime=u.value)},g=r=>{if(isNaN(r))return"00:00";const a=Math.floor(r/60),f=Math.floor(r%60);return`${a.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`};return C(()=>l.url,r=>{n.value&&(t.value=!1,u.value=0,n.value.load())}),(r,a)=>(i(),c("div",z,[s("div",A,[s("button",{class:P(["play-btn",{playing:t.value}]),onClick:k,disabled:!e.url||p.value},[t.value?(i(),c("div",F,[a[1]||(a[1]=s("img",{class:"icon1",src:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/voice/play-active.gif",alt:""},null,-1)),s("span",R,v(p.value?m(o)("label_loading"):m(o)("label_playing"))+"...",1),s("span",j,v(m(o)("label_click_to_pause")),1),a[2]||(a[2]=s("img",{class:"icon2",src:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/voice/open.svg",alt:""},null,-1))])):(i(),c("div",q,[a[3]||(a[3]=s("img",{class:"icon1",src:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/voice/play-static.svg",alt:""},null,-1)),s("span",G,v(m(o)("label_voice_message")),1),s("span",K,v(m(o)("label_click_to_play")),1),a[4]||(a[4]=s("img",{class:"icon2",src:"https://xkf-upload-oss.xiaokefu.com.cn/static/chat-wiki/voice/stop.svg",alt:""},null,-1))]))],10,D),e.showProgress?(i(),c("div",O,[B(s("input",{type:"range",class:"progress-bar","onUpdate:modelValue":a[0]||(a[0]=f=>u.value=f),max:d.value,onInput:M},null,40,Q),[[V,u.value]]),s("div",W,v(g(u.value))+" / "+v(g(d.value)),1)])):L("",!0)]),s("audio",{ref_key:"audioRef",ref:n,src:e.url,onLoadedmetadata:y,onTimeupdate:x,onEnded:b,onError:w},null,40,X)]))}},Z=h(Y,[["__scopeId","data-v-db06de1c"]]),ee={class:"voice-list-box"},ae={__name:"voice-message",props:{voice_content:{type:Array,default:()=>[]}},setup(e){const o=e;return(l,n)=>(i(),c("div",ee,[(i(!0),c(E,null,N(o.voice_content,(t,d)=>(i(),c("div",{class:"voice-item",key:d},[$(Z,{url:t.voice},null,8,["url"])]))),128))]))}},re=h(ae,[["__scopeId","data-v-4c14dd92"]]);export{re as V,le as _};
//# sourceMappingURL=voice-message-B7-hRuYw.js.map
