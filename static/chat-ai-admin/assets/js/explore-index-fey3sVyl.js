import{_ as A}from"./cu-scroll-BD8CyTy-.js";import{Y as g,_ as v,F as $,a9 as N,a5 as s,k as i,a7 as T,G as S,B as F,f as b,w as O,a2 as w,aa as V}from"./vue-chunks-Ci-XTWEs.js";import{g as K}from"./index-BOvAmdHY.js";import{w as Y,x as B}from"./index-DzgHDarz.js";import{b as U,d as q}from"../../index-BZRrEp3V.js";import{X as z,M as R,ag as G,B as W,a as E}from"./ui-antd-BWf8LxGy.js";import{L as X}from"./list-tabs-fGP6M5AY.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./utils-ChQO-_r6.js";const j={class:"list-box"},H=["onClick"],J={class:"explore-info"},P={class:"explore-info-content"},Q={class:"explore-title"},Z={class:"item-body"},tt={class:"explore-desc"},ot={class:"support-box"},et={class:"item-footer"},st={__name:"index",props:{list:{type:Array,default:()=>[]}},emits:["switchChange","clickItem"],setup(D,{emit:y}){const m=y,C=D,p=(a,l)=>m("switchChange",a,l),d=(a,l)=>{try{const c=a==null?void 0:a.target;if(c&&typeof c.closest=="function"&&c.closest(".no-bubble"))return}catch{}m("clickItem",l)};return(a,l)=>{const c=q,x=z;return v(),g("div",j,[(v(!0),g($,null,N(C.list,n=>{var I,f;return v(),g("div",{class:"list-item-wrapper",key:n.id},[s("div",{class:"list-item",onClick:u=>d(u,n)},[s("div",J,[i(c,{class:"explore-icon",name:n.ability_type,style:{"font-size":"62px",color:"white"}},null,8,["name"]),s("div",P,[s("div",Q,T(n.explore_name||n.name),1),l[1]||(l[1]=s("div",{class:"explore-type"},"ChatWiki",-1))])]),s("div",Z,[s("div",tt,T(n.explore_intro||n.introduction),1),s("span",ot,[(v(!0),g($,null,N(n.support_channels_list,u=>(v(),g("span",{key:u,class:"support-item"},[i(c,{name:"support",class:"icon"}),S(" "+T(u),1)]))),128))])]),s("div",et,[i(x,{checked:((I=n.user_config)==null?void 0:I.switch_status)=="1"||((f=n.robot_config)==null?void 0:f.switch_status)=="1","checked-children":"开","un-checked-children":"关",class:"no-bubble",onClick:l[0]||(l[0]=F(()=>{},["stop"])),onChange:u=>p(n,u)},null,8,["checked","onChange"])])],8,H)])}),128))])}}},nt=U(st,[["__scopeId","data-v-c5ae3a8c"]]),at={"bg-color":"#f5f9ff",class:"explore-page"},lt={class:"explore-page-body"},it={class:"list-toolbar"},ct={class:"toolbar-box"},rt={class:"list-group-box"},_t={class:"enable-tip-footer"},pt={class:"footer-actions"},M="explore_enable_tip_suppress_until",ut={__name:"explore-index",setup(D){const y=b([{title:"功能",value:"1"}]),m=b("1"),C=b([]),p=b(!1),d=b(!1),a=V(),l=()=>{y.value=[{title:"功能",value:"1"}]};let c=b([]);const x=()=>{Y().then(t=>{const o=((t==null?void 0:t.data)||[]).map(e=>({...e,explore_name:e.name,explore_intro:e.introduction}));C.value=o,c.value=(t==null?void 0:t.data)||[],l()})};x();const n=()=>{x()},I=(t,o)=>{const e=o?"1":"0";if(e==="0"){R.confirm({title:"提示",content:"关闭后，该功能默认关闭不再支持使用，确认关闭？",onOk:()=>{B({ability_type:t.ability_type,switch_status:e}).then(r=>{r&&r.res==0&&(E.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e))})}});return}B({ability_type:t.ability_type,switch_status:e}).then(r=>{if(r&&r.res==0){E.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e);const h=Number(localStorage.getItem(M)||0),k=Date.now();h<=k&&(d.value=!1,p.value=!0)}})},f=()=>{if(d.value){const t=Date.now()+2592e5;localStorage.setItem(M,String(t))}},u=()=>{f(),p.value=!1},L=async()=>{f(),p.value=!1;const t=localStorage.getItem("last_local_robot_id");try{const{data:o=[]}=await K();if(!o.length){const _=a.resolve({path:"/robot/list"});window.open(_.href,"_blank");return}let e;t&&(e=o.find(_=>_.id==t)),e=e||o[0];const{id:r,robot_key:h}=e,k=a.resolve({path:"/robot/config/function-center",query:{id:r,robot_key:h}});window.open(k.href,"_blank")}catch{const e=a.resolve({path:"/robot/list"});window.open(e.href,"_blank")}};return O(p,(t,o)=>{o&&!t&&f()}),(t,o)=>{const e=A,r=G,h=W,k=R;return v(),g("div",at,[s("div",lt,[s("div",it,[s("div",ct,[i(X,{tabs:y.value,value:m.value,"onUpdate:value":o[0]||(o[0]=_=>m.value=_),onChange:n},null,8,["tabs","value"])])]),s("div",rt,[i(e,{style:{"padding-right":"16px",flex:"1"}},{default:w(()=>[i(nt,{list:C.value,onSwitchChange:I,onClickItem:L},null,8,["list"])]),_:1})])]),i(k,{open:p.value,"onUpdate:open":o[2]||(o[2]=_=>p.value=_),title:"提示",footer:null},{default:w(()=>[o[6]||(o[6]=s("div",null,"开启该功能后请到机器人>功能中心，配置并使用该功能",-1)),s("div",_t,[i(r,{checked:d.value,"onUpdate:checked":o[1]||(o[1]=_=>d.value=_)},{default:w(()=>o[3]||(o[3]=[S("3天内不再提醒")])),_:1,__:[3]},8,["checked"]),s("div",pt,[i(h,{onClick:u},{default:w(()=>o[4]||(o[4]=[S("取消")])),_:1,__:[4]}),i(h,{type:"primary",onClick:L},{default:w(()=>o[5]||(o[5]=[S("去使用")])),_:1,__:[5]})])])]),_:1,__:[6]},8,["open"])])}}},yt=U(ut,[["__scopeId","data-v-0c9a0595"]]);export{yt as default};
