import{C as q}from"./config-page-menu-BDMRK-XO.js";import{b as L,k as A,dx as E,d as M,B as z,e5 as T}from"../../index-M_xDbIir.js";import{d as b,z as g,w as D,q as I,N as k,X as s,j as r,U as l,W as x,u as h,a0 as G,Z as W,O as B,G as F}from"./vue-chunks-BRsu9_To.js";import{A as X}from"./avatar-input-DmRcFOZY.js";import{F as w,_ as Y}from"./index-V0sRhm34.js";import"./index-UA7y0weg.js";import{I as Z}from"./Input-Bx6Hhp2b.js";import{_ as H}from"./TextArea-C57yjED6.js";import"./index-B3CPYV6x.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-CkoSoTBd.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-DzpBPoRp.js";import"./index-CMIXnI2Z.js";import"./index-B0RyY99D.js";import"./colors-C56HAaAp.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./PlusOutlined-DQ91YM1E.js";import"./index-BSroSjtu.js";import"./Password-5njtOUlo.js";import"./inputProps-DsSGhBt6.js";import"./DownloadOutlined-Cn7Sl8HY.js";import"./index-CsySi7_q.js";import"./CheckOutlined-DVulUWsT.js";import"./useRefs-CRRjy_qY.js";import"./useMergedState-C0iIHNGF.js";import"./FormItemContext-DRzYyKbC.js";import"./isPlainObject-A-SljaBF.js";import"./Col-CFWsj1wI.js";import"./responsiveObserve-CRSSr9-w.js";import"./hasIn-DEwqUvIo.js";import"./QuestionCircleOutlined-B5SgdGK5.js";import"./index-Btmz2D3B.js";import"./Search-w33R1D1l.js";import"./SearchOutlined-KUcJKUZw.js";const J={class:"form-box"},K={class:"form-box-header"},Q={class:"form-box-label"},aa={__name:"library-form",props:{value:{type:Object,default:()=>({})},saveLoading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(u,{emit:_}){A.config({duration:2});const i=_,n=u,d=b(1),f=w.useForm,c=b(!1),t=E,a=g({type:d.value,library_name:"",library_intro:"",use_model:"",avatar:t,avatar_file:"",is_offline:!1,model_config_id:""}),v=g({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}],library_intro:[{required:!0,message:"请输入库简介",trigger:"change"}]}),S=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},{validate:C,validateInfos:y}=f(a,v),U=()=>{C().then(()=>{N()}).catch(e=>{})},N=()=>{let e=F(a);i("submit",e)},O=e=>{c.value=+e.type,a.library_name=e.library_name,a.library_intro=e.library_intro,a.use_model=e.use_model,a.model_config_id=e.model_config_id,a.avatar=e.avatar?e.avatar:t,a.avatar_file=e.avatar_file?e.avatar_file:"",a.is_offline=e.is_offline};return D(n.value,e=>{O({...e})}),I(()=>{}),(e,o)=>{const j=M,P=Z,p=Y,R=H,V=z,$=w;return B(),k("div",J,[s("div",K,[s("div",Q,[r(j,{class:"form-box-label-icon",name:"book",style:{"font-size":"16px",color:"#333"}}),o[3]||(o[3]=s("span",{class:"form-box-label-text"},"知识库信息",-1))]),o[4]||(o[4]=s("div",null,null,-1))]),r($,{"label-col":{span:6},style:{width:"600px"}},{default:l(()=>[r(p,x({ref:"name",label:"知识库名称"},h(y).library_name),{default:l(()=>[r(P,{value:a.library_name,"onUpdate:value":o[0]||(o[0]=m=>a.library_name=m),placeholder:"请输入知识库名称，最多20个字","show-count":"",maxlength:20},null,8,["value"])]),_:1},16),r(p,{label:"知识库简介"},{default:l(()=>[r(R,{value:a.library_intro,"onUpdate:value":o[1]||(o[1]=m=>a.library_intro=m),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),r(p,x({ref:"name",label:"知识库封面"},h(y).avatar),{default:l(()=>[r(X,{value:a.avatar,"onUpdate:value":o[2]||(o[2]=m=>a.avatar=m),onChange:S},null,8,["value"]),o[5]||(o[5]=s("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[5]},16),r(p,{"wrapper-col":{offset:6,span:8}},{default:l(()=>[r(V,{type:"primary",style:{"margin-left":"8px"},loading:u.saveLoading,onClick:G(U,["prevent"])},{default:l(()=>o[6]||(o[6]=[W("保存")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1})])}}},ea=L(aa,[["__scopeId","data-v-186fe7ef"]]),ta={class:"add-library-page"},oa={class:"page-container"},ra={class:"form-box-wrapper"},ia={__name:"index",setup(u){const _=T(),i=g({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),n=b(!1),d=t=>{Object.assign(i,t),n.value=!0,f().then(()=>{n.value=!1}).catch(()=>{n.value=!1})},f=async()=>{let t={...F(i)};delete t.library_key,t.avatar_file?(t.avatar=t.avatar_file,delete t.avatar_file):(delete t.avatar,delete t.avatar_file),await _.saveEditLibrary(t),A.success("修改成功")},c=()=>{Object.assign(i,{..._.libraryInfo})};return I(()=>{c()}),(t,a)=>(B(),k("div",ta,[r(q),s("div",oa,[s("div",ra,[r(ea,{value:i,"onUpdate:value":a[0]||(a[0]=v=>i=v),saveLoading:n.value,onSubmit:d},null,8,["value","saveLoading"])])])]))}},Ga=L(ia,[["__scopeId","data-v-f47ae502"]]);export{Ga as default};
