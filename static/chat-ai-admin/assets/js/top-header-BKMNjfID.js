import{f,e as m,Y as b,_ as i,a5 as o,k as e,a2 as a,u,B as x,F as P,a9 as W,ad as $,a7 as C,ae as E,a1 as B,ab as Z,ag as oo,o as to,G as z,aa as eo}from"./vue-chunks-Ci-XTWEs.js";import{b as so,a as no}from"./add-group-DBCwDjxp.js";import{b as j,k as ao,w as lo,x as ro}from"../../index-OnalErht.js";import{u as Y}from"./robot-DHvU2P3E.js";import{l as io}from"./index-DGyn5jM5.js";import{z as uo,p as q,T as co,I as _o,an as po,b as J,c as Q,D as X,ax as vo,ay as bo,aj as fo,M as mo,a as go,H as ho,bf as ko,g as Ro,a8 as yo,a9 as Co,aH as xo}from"./ui-antd-BgeWxFcI.js";const Go={class:"robot-group-box"},Lo={class:"popover-scroll-box"},$o={class:"group-head-box"},wo={class:"head-title"},Ao={class:"search-box"},Oo={class:"classify-box"},Io=["onClick"],So={class:"classify-title"},To={class:"right-content"},Eo={key:0,class:"btn-box"},Bo={class:"hover-btn-wrap"},Do=["onClick"],No=["onClick"],Ho={class:"list-box popover-scroll-box"},Mo={key:0,class:"empty-box"},Vo=["onClick"],Fo={class:"robot-info"},Uo=["src"],Ko={class:"robot-info-content"},Po={class:"robot-name"},Wo={class:"robot-type-tag"},zo={class:"robot-desc"},jo={__name:"robot-group",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(K,{expose:D,emit:w}){const c=Y(),N=K,g=w;let G="robot-list-hide-group-key";const d=f(localStorage.getItem(G)==1),h=()=>{d.value=!d.value,localStorage.setItem(G,d.value?1:0)},_=f(""),H=m(()=>c.robotList||[]),A=m(()=>{let s=H.value;return _.value!=""&&(s=s.filter(l=>l.group_id==_.value)),s}),O=m(()=>{let s=c.robotGroupList||[],l=0;return s.forEach(r=>{l+=+r.total}),[{group_name:"全部",total:l,id:""},...s]}),p=f(""),M=m(()=>O.value.filter(s=>s.group_name.includes(p.value))),L=()=>{c.getRobotLists(),c.getGroupList()},I=s=>{_.value=s.id},S=f(null),T=s=>{S.value.show({...s})},V=s=>{mo.confirm({title:`确认删除分组${s.group_name}`,icon:e(ho),content:"",okText:"确认",okType:"danger",cancelText:"取消",onOk(){io({id:s.id}).then(()=>{go.success("删除成功"),c.getGroupList(),_.value==s.id&&(_.value="",c.getRobotLists())})}})},F=s=>{g("update:value",s.id),g("change",s.id)};return D({group_id:_}),(s,l)=>{const r=q,t=_o,k=Q,R=J,y=X,U=fo;return i(),b("div",Go,[o("div",{class:$(["left-group-box",{"hide-group":d.value}])},[o("div",Lo,[o("div",$o,[o("div",wo,[l[3]||(l[3]=o("div",null,"机器人分组",-1)),e(r,{title:"新建分组"},{default:a(()=>[o("div",{class:"hover-btn-wrap",onClick:l[0]||(l[0]=n=>T({}))},[e(u(uo))])]),_:1})]),o("div",Ao,[e(t,{value:p.value,"onUpdate:value":l[2]||(l[2]=n=>p.value=n),allowClear:"",placeholder:"搜索分组",style:{width:"100%"}},{suffix:a(()=>[e(u(co),{onClick:l[1]||(l[1]=x(()=>{},["stop"]))})]),_:1},8,["value"])])]),o("div",Oo,[(i(!0),b(P,null,W(M.value,n=>(i(),b("div",{class:$(["classify-item",{active:n.id==_.value}]),onClick:v=>I(n),key:n.id},[o("div",So,C(n.group_name),1),o("div",To,[o("div",{class:$(["num",{"num-block":n.id<=0}])},C(n.total),3),n.id>0?(i(),b("div",Eo,[e(y,{placement:"bottomRight"},{overlay:a(()=>[e(R,null,{default:a(()=>[e(k,null,{default:a(()=>[o("div",{onClick:x(v=>T(n),["stop"])},"重命名",8,Do)]),_:2},1024),e(k,null,{default:a(()=>[o("div",{onClick:x(v=>V(n),["stop"])},"删 除",8,No)]),_:2},1024)]),_:2},1024)]),default:a(()=>[o("div",Bo,[e(u(po))])]),_:2},1024)])):E("",!0)])],10,Io))),128))])]),e(r,{placement:"right",title:d.value?"展开分组":"收起分组"},{default:a(()=>[o("div",{class:"hide-group-box",onClick:h},[d.value?(i(),B(u(bo),{key:1})):(i(),B(u(vo),{key:0}))])]),_:1},8,["title"])],2),o("div",Ho,[A.value.length==0?(i(),b("div",Mo,[e(U)])):E("",!0),(i(!0),b(P,null,W(A.value,n=>(i(),b("div",{class:$(["list-item-wrapper",{"show-more":d.value}]),key:n.id,onClick:v=>F(n)},[o("div",{class:$(["list-item",{active:n.id==N.value}])},[o("div",Fo,[o("img",{class:"robot-avatar",src:n.robot_avatar,alt:""},null,8,Uo),o("div",Ko,[o("div",Po,C(n.robot_name),1),o("div",Wo,C(n.application_type==0?"聊天机器人":"工作流"),1)])]),o("div",zo,C(n.robot_intro),1)],2)],10,Vo))),128))]),e(so,{ref_key:"addGroupRef",ref:S,onOk:L},null,512)])}}},Yo=j(jo,[["__scopeId","data-v-162ddcd3"]]),qo={class:"select-robot-block"},Jo={class:"robot-option-block show-block-item"},Qo=["src"],Xo={class:"robot-name"},Zo={class:"create-action"},ot=["src"],tt={class:"create-action"},et=["src"],st={__name:"top-header",setup(K){const D=eo(),w=Z(),c=f(null),N=m(()=>w.name),g=Y(),{robotInfo:G}=oo(g),d=()=>{D.push("/robot/list")},h=f(null),_=ao();let{role_permission:H}=_;const A=m(()=>H.includes("RobotCreate")),O=m(()=>g.robotList||[]),p=f(G.value.id),M=f(null),L=m(()=>O.value.find(r=>r.id==p.value)||{}),I=r=>{h.value.open(r);let t=c.value?c.value.group_id:"0";h.value.setGroupId(t)},S=()=>{var t;let r=+G.value.application_type;h.value.open(r,!0),h.value.setGroupId((t=L.value)==null?void 0:t.group_id)},T=()=>{s(),l()},V=()=>{s(),l()},F=()=>{let r=w.path,t=O.value.find(y=>y.id==p.value),{id:k,robot_key:R}=t;localStorage.setItem("last_local_robot_id",k),window.location.href=`/#${r}?id=${k}&robot_key=${R}`,window.location.reload()};function s(){g.getRobotLists()}function l(){g.getGroupList()}return to(()=>{}),(r,t)=>{const k=yo,R=q,y=Q,U=J,n=X;return i(),b("div",{class:"robot-name-box",ref_key:"robotNameBoxRef",ref:M},[e(no,{onAddRobot:T,onEditRobot:V,ref_key:"addRobotAlertRef",ref:h},null,512),o("div",{class:"left-icon hover-block",onClick:d},[e(u(ko))]),o("div",qo,[e(k,{placement:"bottomLeft",trigger:"click",overlayInnerStyle:{"padding-right":0}},{content:a(()=>[e(Yo,{ref_key:"robotGroupRef",ref:c,value:p.value,"onUpdate:value":t[0]||(t[0]=v=>p.value=v),onChange:F},null,8,["value"])]),default:a(()=>[o("div",Jo,[o("img",{class:"robot-avatar",src:L.value.robot_avatar,alt:""},null,8,Qo),o("div",Xo,C(L.value.robot_name),1),e(u(Ro),{class:"down-icon"})])]),_:1})]),N.value=="robotWorkflow"?(i(),B(R,{key:0},{title:a(()=>t[5]||(t[5]=[z("编辑机器人")])),default:a(()=>[o("div",{class:"hover-block",onClick:t[1]||(t[1]=v=>S())},[e(u(Co))])]),_:1})):E("",!0),A.value?(i(),B(n,{key:1},{overlay:a(()=>[e(U,null,{default:a(()=>[e(y,{onClick:t[3]||(t[3]=x(v=>I(0),["prevent"]))},{default:a(()=>[o("span",Zo,[o("img",{class:"icon",src:u(lo),alt:""},null,8,ot),t[7]||(t[7]=o("span",null,"聊天机器人",-1))])]),_:1}),e(y,{onClick:t[4]||(t[4]=x(v=>I(1),["prevent"]))},{default:a(()=>[o("span",tt,[o("img",{class:"icon",src:u(ro),alt:""},null,8,et),t[8]||(t[8]=o("span",null,"工作流",-1))])]),_:1})]),_:1})]),default:a(()=>[e(R,null,{title:a(()=>t[6]||(t[6]=[z("新建机器人")])),default:a(()=>[o("div",{class:"hover-block",onClick:t[2]||(t[2]=x(()=>{},["prevent"]))},[e(u(xo))])]),_:1})]),_:1})):E("",!0)],512)}}},ct=j(st,[["__scopeId","data-v-acf5b678"]]);export{ct as T};
