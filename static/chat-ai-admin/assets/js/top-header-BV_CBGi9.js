import{r as g,c as h,a as f,b as d,p as o,y as e,v as u,u as t,t as a,Y as G,F as P,l as j,h as O,q as D,e as B,ah as to,aj as eo,j as so,_ as q,ag as no}from"./vue-chunks-BdaA73Wf.js";import{b as lo,a as ao}from"./add-group-BYEOdPBe.js";import{u as z,f as ro,o as io,p as co}from"../../index-DSFcP5NQ.js";import{u as Y}from"./robot-CIzNpArp.js";import{o as uo}from"./index-Cg7-0swo.js";import{_ as J}from"./emoji-mart-BBMRoEa3.js";import{a1 as _o,q as Q,W as po,I as vo,am as bo,f as X,g as Z,i as oo,e as mo,R as fo,ai as go,M as ho,b as ko,O as Ro,aT as yo,D as Co,a9 as xo,aa as wo,ax as Go}from"./ui-antd-Dl1wwwCD.js";const Lo={class:"robot-group-box"},$o={class:"popover-scroll-box"},Oo={class:"group-head-box"},Ao={class:"head-title"},Io={class:"search-box"},So={class:"classify-box"},To=["onClick"],Eo={class:"classify-title"},Do={class:"right-content"},Bo={key:0,class:"btn-box"},No={class:"hover-btn-wrap"},Mo=["onClick"],Vo=["onClick"],Fo={class:"list-box popover-scroll-box"},Ho={key:0,class:"empty-box"},Uo=["onClick"],Wo={class:"robot-info"},Ko=["src"],Po={class:"robot-info-content"},jo={class:"robot-name"},qo={class:"robot-type-tag"},zo={class:"robot-desc"},Yo={__name:"robot-group",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(K,{expose:C,emit:N}){const{t:r}=z("views.robot.robot-config.components.robot-group"),_=Y(),M=K,k=N;let L="robot-list-hide-group-key";const p=g(localStorage.getItem(L)==1),R=()=>{p.value=!p.value,localStorage.setItem(L,p.value?1:0)},v=g(""),V=h(()=>_.robotList||[]),A=h(()=>{let s=V.value;return v.value!=""&&(s=s.filter(i=>i.group_id==v.value)),s}),I=h(()=>{let s=_.robotGroupList||[],i=0;return s.forEach(c=>{i+=+c.total}),[{group_name:r("label_all"),total:i,id:""},...s]}),b=g(""),F=h(()=>I.value.filter(s=>s.group_name.includes(b.value))),$=()=>{_.getRobotLists(),_.getGroupList()},S=s=>{v.value=s.id},T=g(null),E=s=>{T.value.show({...s})},H=s=>{ho.confirm({title:r("msg_confirm_delete_group",{name:s.group_name}),icon:e(Ro),content:"",okText:r("btn_confirm"),okType:"danger",cancelText:r("btn_cancel"),onOk(){uo({id:s.id}).then(()=>{ko.success(r("msg_delete_success")),_.getGroupList(),v.value==s.id&&(v.value="",_.getRobotLists())})}})},U=s=>{k("update:value",s.id),k("change",s.id)};return C({group_id:v}),(s,i)=>{const c=Q,l=vo,y=Z,x=X,w=oo,W=go;return d(),f("div",Lo,[o("div",{class:O(["left-group-box",{"hide-group":p.value}])},[o("div",$o,[o("div",Oo,[o("div",Ao,[o("div",null,u(t(r)("title_robot_groups")),1),e(c,{title:t(r)("title_create_group")},{default:a(()=>[o("div",{class:"hover-btn-wrap",onClick:i[0]||(i[0]=n=>E({}))},[e(t(_o))])]),_:1},8,["title"])]),o("div",Io,[e(l,{value:b.value,"onUpdate:value":i[2]||(i[2]=n=>b.value=n),allowClear:"",placeholder:t(r)("ph_search_groups"),style:{width:"100%"}},{suffix:a(()=>[e(t(po),{onClick:i[1]||(i[1]=G(()=>{},["stop"]))})]),_:1},8,["value","placeholder"])])]),o("div",So,[(d(!0),f(P,null,j(F.value,n=>(d(),f("div",{class:O(["classify-item",{active:n.id==v.value}]),onClick:m=>S(n),key:n.id},[o("div",Eo,u(n.group_name),1),o("div",Do,[o("div",{class:O(["num",{"num-block":n.id<=0}])},u(n.total),3),n.id>0?(d(),f("div",Bo,[e(w,{placement:"bottomRight"},{overlay:a(()=>[e(x,null,{default:a(()=>[e(y,null,{default:a(()=>[o("div",{onClick:G(m=>E(n),["stop"])},u(t(r)("btn_rename")),9,Mo)]),_:2},1024),e(y,null,{default:a(()=>[o("div",{onClick:G(m=>H(n),["stop"])},u(t(r)("btn_delete")),9,Vo)]),_:2},1024)]),_:2},1024)]),default:a(()=>[o("div",No,[e(t(bo))])]),_:2},1024)])):D("",!0)])],10,To))),128))])]),e(c,{placement:"right",title:p.value?t(r)("title_expand_groups"):t(r)("title_collapse_groups")},{default:a(()=>[o("div",{class:"hide-group-box",onClick:R},[p.value?(d(),B(t(fo),{key:1})):(d(),B(t(mo),{key:0}))])]),_:1},8,["title"])],2),o("div",Fo,[A.value.length==0?(d(),f("div",Ho,[e(W)])):D("",!0),(d(!0),f(P,null,j(A.value,n=>(d(),f("div",{class:O(["list-item-wrapper",{"show-more":p.value}]),key:n.id,onClick:m=>U(n)},[o("div",{class:O(["list-item",{active:n.id==M.value}])},[o("div",Wo,[o("img",{class:"robot-avatar",src:n.robot_avatar,alt:""},null,8,Ko),o("div",Po,[o("div",jo,u(n.robot_name),1),o("div",qo,u(n.application_type==0?t(r)("label_chat_robot"):t(r)("label_workflow")),1)])]),o("div",zo,u(n.robot_intro),1)],2)],10,Uo))),128))]),e(lo,{ref_key:"addGroupRef",ref:T,onOk:$},null,512)])}}},Jo=J(Yo,[["__scopeId","data-v-01bf5148"]]),Qo={class:"select-robot-block"},Xo={class:"robot-option-block show-block-item"},Zo=["src"],ot={class:"robot-name"},tt={class:"create-action"},et=["src"],st={class:"create-action"},nt=["src"],lt={__name:"top-header",setup(K){const{t:C}=z("views.robot.robot-config.components.top-header"),N=no(),r=to(),_=g(null),M=h(()=>r.name),k=Y(),{robotInfo:L}=eo(k),p=()=>{N.push("/robot/list")},R=g(null),v=ro();let{role_permission:V}=v;const A=h(()=>V.includes("RobotCreate")),I=h(()=>k.robotList||[]),b=g(L.value.id),F=g(null),$=h(()=>I.value.find(c=>c.id==b.value)||{}),S=c=>{R.value.open(c);let l=_.value?_.value.group_id:"0";R.value.setGroupId(l)},T=()=>{var l;let c=+L.value.application_type;R.value.open(c,!0),R.value.setGroupId((l=$.value)==null?void 0:l.group_id)},E=()=>{s(),i()},H=()=>{s(),i()},U=()=>{let c=r.path,l=I.value.find(w=>w.id==b.value),{id:y,robot_key:x}=l;localStorage.setItem("last_local_robot_id",y),window.location.href=`/#${c}?id=${y}&robot_key=${x}`,window.location.reload()};function s(){k.getRobotLists()}function i(){k.getGroupList()}return so(()=>{}),(c,l)=>{const y=xo,x=Q,w=Z,W=X,n=oo;return d(),f("div",{class:"robot-name-box",ref_key:"robotNameBoxRef",ref:F},[e(ao,{onAddRobot:E,onEditRobot:H,ref_key:"addRobotAlertRef",ref:R},null,512),o("div",{class:"left-icon hover-block",onClick:p},[e(t(yo))]),o("div",Qo,[e(y,{placement:"bottomLeft",trigger:"click",overlayInnerStyle:{"padding-right":0}},{content:a(()=>[e(Jo,{ref_key:"robotGroupRef",ref:_,value:b.value,"onUpdate:value":l[0]||(l[0]=m=>b.value=m),onChange:U},null,8,["value"])]),default:a(()=>[o("div",Xo,[o("img",{class:"robot-avatar",src:$.value.robot_avatar,alt:""},null,8,Zo),o("div",ot,u($.value.robot_name),1),e(t(Co),{class:"down-icon"})])]),_:1})]),M.value=="robotWorkflow"?(d(),B(x,{key:0},{title:a(()=>[q(u(t(C)("title_edit_robot")),1)]),default:a(()=>[o("div",{class:"hover-block",onClick:l[1]||(l[1]=m=>T())},[e(t(wo))])]),_:1})):D("",!0),A.value?(d(),B(n,{key:1},{overlay:a(()=>[e(W,null,{default:a(()=>[e(w,{onClick:l[3]||(l[3]=G(m=>S(0),["prevent"]))},{default:a(()=>[o("span",tt,[o("img",{class:"icon",src:t(io),alt:""},null,8,et),o("span",null,u(t(C)("label_chat_robot")),1)])]),_:1}),e(w,{onClick:l[4]||(l[4]=G(m=>S(1),["prevent"]))},{default:a(()=>[o("span",st,[o("img",{class:"icon",src:t(co),alt:""},null,8,nt),o("span",null,u(t(C)("label_workflow")),1)])]),_:1})]),_:1})]),default:a(()=>[e(x,null,{title:a(()=>[q(u(t(C)("title_create_robot")),1)]),default:a(()=>[o("div",{class:"hover-block",onClick:l[2]||(l[2]=G(()=>{},["prevent"]))},[e(t(Go))])]),_:1})]),_:1})):D("",!0)],512)}}},pt=J(lt,[["__scopeId","data-v-b0fab224"]]);export{pt as T};
//# sourceMappingURL=top-header-BV_CBGi9.js.map
