import{_ as A}from"./cu-scroll-5W3_kglT.js";import{aa as M,Y as y,_ as g,F as D,a9 as R,a5 as s,k as l,a7 as S,G as C,f as x,o as F,w as O,a2 as k}from"./vue-chunks-Ci-XTWEs.js";import{g as U}from"./index-Bu5ae_-0.js";import{w as V,x as L}from"./index-CPuy80m4.js";import{b as E,d as q}from"../../index-CPkdGIiL.js";import{X as z,M as N,ag as Y,B as G,a as T}from"./ui-antd-Bw8cEW5z.js";import{_ as K}from"./main-tab-CrJi-O-9.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./utils-ChQO-_r6.js";import"./list-tabs-Bu_nGTVN.js";import"./index-DNepwrz3.js";const W={class:"list-box"},X=["onClick"],j={class:"explore-info"},H={class:"explore-info-content"},J={class:"explore-title"},P={class:"item-body"},Q={class:"explore-desc"},Z={class:"support-box"},tt={class:"item-footer"},ot={__name:"index",props:{list:{type:Array,default:()=>[]}},emits:["switchChange","clickItem"],setup($,{emit:w}){const m=w,i=M(),d=$,f=(_,n)=>m("switchChange",_,n),I=async(_,n)=>{try{const c=_==null?void 0:_.target;if(c&&typeof c.closest=="function"&&c.closest(".no-bubble"))return;if(n.robot_only_show==1){i.push({path:n.menu.path});return}if(n.ability_type=="robot_subscribe_reply"){i.push({path:"/explore/index/subscribe-reply"});return}if(n.ability_type=="official_account_batch_send"){i.push({path:"/explore/index/article-group-send"});return}if(n.ability_type=="official_account_ai_comment"){i.push({path:"/explore/index/ai-comment-management"});return}}catch{}m("clickItem",n)};return(_,n)=>{const c=q,b=z;return g(),y("div",W,[(g(!0),y(D,null,R(d.list,a=>{var h,t;return g(),y("div",{class:"list-item-wrapper",key:a.id},[s("div",{class:"list-item",onClick:o=>I(o,a)},[s("div",j,[l(c,{class:"explore-icon",name:a.ability_type,style:{"font-size":"62px",color:"white"}},null,8,["name"]),s("div",H,[s("div",J,S(a.explore_name||a.name),1),n[0]||(n[0]=s("div",{class:"explore-type"},"ChatWiki",-1))])]),s("div",P,[s("div",Q,S(a.explore_intro||a.introduction),1),s("span",Z,[(g(!0),y(D,null,R(a.support_channels_list,o=>(g(),y("span",{key:o,class:"support-item"},[l(c,{name:"support",class:"icon"}),C(" "+S(o),1)]))),128))])]),s("div",tt,[l(b,{checked:((h=a.user_config)==null?void 0:h.switch_status)=="1"||((t=a.robot_config)==null?void 0:t.switch_status)=="1","checked-children":"开","un-checked-children":"关",class:"no-bubble",onChange:o=>f(a,o)},null,8,["checked","onChange"])])],8,X)])}),128))])}}},et=E(ot,[["__scopeId","data-v-c2b02b33"]]),st={"bg-color":"#f5f9ff",class:"explore-page"},nt={class:"explore-page-body"},at={class:"list-toolbar"},it={class:"toolbar-box"},lt={class:"list-group-box"},ct={class:"enable-tip-footer"},rt={class:"footer-actions"},B="explore_enable_tip_suppress_until",_t={__name:"explore-index",setup($){const w=x(null),m=x([]),i=x(!1),d=x(!1),f=M();F(()=>{let t=localStorage.getItem("zm:explore:active");t>1?w.value.change(t):_()});let I=x([]);const _=()=>{V().then(t=>{const o=((t==null?void 0:t.data)||[]).map(e=>({...e,explore_name:e.name,explore_intro:e.introduction}));m.value=o,I.value=(t==null?void 0:t.data)||[]})},n=(t,o)=>{const e=o?"1":"0";if(e==="0"){const p={robot_auto_reply:"关闭后，该功能默认关闭不再支持使用，所有的公众号菜单都会停用，确认关闭？",library_ability_official_account:"关闭后，知识库模块将不再显示公众号知识库模块，历史已导入的文章将无法引用，确认关闭？"};N.confirm({title:"提示",content:p[t.ability_type]||"关闭后，该功能默认关闭不再支持使用，所有的公众号菜单都会停用，确认关闭？",onOk:()=>{L({ability_type:t.ability_type,switch_status:e}).then(r=>{r&&r.res==0&&(T.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e))})}});return}L({ability_type:t.ability_type,switch_status:e}).then(p=>{if(p&&p.res==0){if(T.success("操作成功"),t.user_config?t.user_config.switch_status=e:t.robot_config&&(t.robot_config.switch_status=e),t.ability_type==="library_ability_official_account")return;const r=Number(localStorage.getItem(B)||0),v=Date.now();r<=v&&(d.value=!1,t.robot_only_show!=1&&(i.value=!0))}})},c=t=>{switch(t.ability_type){case"library_ability_official_account":const o=f.resolve({path:"/library/list",query:{active:3}});window.open(o.href,"_blank");break;case"robot_auto_reply":h();break;default:t.module_type==="robot"&&t.robot_only_show==0&&h();break}},b=()=>{if(d.value){const t=Date.now()+2592e5;localStorage.setItem(B,String(t))}},a=()=>{b(),i.value=!1},h=async()=>{b(),i.value=!1;const t=localStorage.getItem("last_local_robot_id");try{const{data:o=[]}=await U();if(!o.length){const u=f.resolve({path:"/robot/list"});window.open(u.href,"_blank");return}let e;t&&(e=o.find(u=>u.id==t)),e=e||o[0];const{id:p,robot_key:r}=e,v=f.resolve({path:"/robot/config/function-center",query:{id:p,robot_key:r}});window.open(v.href,"_blank")}catch{const e=f.resolve({path:"/robot/list"});window.open(e.href,"_blank")}};return O(i,(t,o)=>{o&&!t&&b()}),(t,o)=>{const e=A,p=Y,r=G,v=N;return g(),y("div",st,[s("div",nt,[s("div",at,[s("div",it,[l(K,{ref_key:"tabRef",ref:w},null,512)])]),s("div",lt,[l(e,{style:{"padding-right":"16px",flex:"1"}},{default:k(()=>[l(et,{list:m.value,onSwitchChange:n,onClickItem:c},null,8,["list"])]),_:1})])]),l(v,{open:i.value,"onUpdate:open":o[1]||(o[1]=u=>i.value=u),title:"提示",footer:null},{default:k(()=>[o[5]||(o[5]=s("div",null,"开启该功能后请到机器人>功能中心，配置并使用该功能",-1)),s("div",ct,[l(p,{checked:d.value,"onUpdate:checked":o[0]||(o[0]=u=>d.value=u)},{default:k(()=>o[2]||(o[2]=[C("3天内不再提醒")])),_:1,__:[2]},8,["checked"]),s("div",rt,[l(r,{onClick:a},{default:k(()=>o[3]||(o[3]=[C("取消")])),_:1,__:[3]}),l(r,{type:"primary",onClick:h},{default:k(()=>o[4]||(o[4]=[C("去使用")])),_:1,__:[4]})])])]),_:1,__:[5]},8,["open"])])}}},wt=E(_t,[["__scopeId","data-v-c7eb159b"]]);export{wt as default};
