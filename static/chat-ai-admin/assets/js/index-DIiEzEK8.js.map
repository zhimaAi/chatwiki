{"version":3,"file":"index-DIiEzEK8.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/robot/api-key-manage/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"page-container\">\r\n    <div class=\"page-title\">{{ t('page_title') }}</div>\r\n    <a-alert class=\"mt8\" type=\"info\" show-icon>\r\n      <template #icon>\r\n        <div>\r\n          <ExclamationCircleFilled />\r\n        </div>\r\n      </template>\r\n      <template #message>\r\n        <div class=\"alert-content\">\r\n          <div>\r\n            {{ t('alert_message') }}\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </a-alert>\r\n    <div class=\"opration-box\">\r\n      <a-button type=\"primary\" @click=\"handleOpenAddModal\">{{ t('add_api_key_btn') }}</a-button>\r\n      <a-input v-model:value=\"end_point\" style=\"width: 500px\" readonly>\r\n        <template #addonBefore>\r\n          <span @click=\"copyText(end_point)\" style=\"cursor: pointer\">{{ t('copy_api_endpoint') }}</span>\r\n        </template>\r\n      </a-input>\r\n\r\n      <a\r\n        style=\"margin-left: auto\"\r\n        href=\"https://www.yuque.com/zhimaxiaoshiwangluo/pggco1/bg1ol40fo68pgdae\"\r\n        target=\"_blank\"\r\n      >\r\n        <a-button>{{ t('api_documentation') }}</a-button>\r\n      </a>\r\n    </div>\r\n    <div class=\"list-box\">\r\n      <div class=\"list-item\" v-for=\"item in lists\" :key=\"item.id\">\r\n        <a-flex justify=\"space-between\" align=\"center\">\r\n          <div class=\"key-content\">\r\n            <span>{{ t('api_key_label') }}</span>\r\n            <span>{{ item.key }}</span>\r\n          </div>\r\n          <div class=\"right-box\">\r\n            <a-switch\r\n              @change=\"handleChangeStatus(item)\"\r\n              :checked=\"item.status == 1\"\r\n              :checked-children=\"t('switch_on')\"\r\n              :un-checked-children=\"t('switch_off')\"\r\n            />\r\n\r\n            <a-button @click=\"copyText(item.key)\">{{ t('copy_btn') }}</a-button>\r\n            <a-button danger @click=\"handleDelApiKey(item)\">{{ t('delete_btn') }}</a-button>\r\n          </div>\r\n        </a-flex>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport {\r\n  ExclamationCircleFilled,\r\n  CopyOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons-vue'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport { ref, h, createVNode } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport {\r\n  listRobotApikey,\r\n  updateRobotApikey,\r\n  addRobotApikey,\r\n  deleteRobotApikey\r\n} from '@/api/robot/index'\r\nimport useClipboard from 'vue-clipboard3'\r\nconst { t } = useI18n('views.robot.api-key-manage.index')\r\nconst { toClipboard } = useClipboard()\r\nconst robotStore = useRobotStore()\r\nconst { robotInfo } = storeToRefs(robotStore)\r\nconst end_point = ref('')\r\nconst lists = ref([])\r\nconst getApiKeyList = () => {\r\n  listRobotApikey({\r\n    robot_key: robotInfo.value.robot_key\r\n  }).then((res) => {\r\n    end_point.value = res.data.end_point\r\n    lists.value = res.data.list\r\n  })\r\n}\r\ngetApiKeyList()\r\nconst handleChangeStatus = (item) => {\r\n  updateRobotApikey({\r\n    robot_key: robotInfo.value.robot_key,\r\n    id: item.id\r\n  }).then((res) => {\r\n    message.success(t('update_success'))\r\n    getApiKeyList()\r\n  })\r\n}\r\n\r\nconst handleOpenAddModal = () => {\r\n  Modal.confirm({\r\n    title: h('div', { style: 'color:#262626; font-weight: 600;' }, t('add_api_key_title')),\r\n    icon: null,\r\n    content: h(\r\n      'div',\r\n      { style: ' color: #f10; line-height: 22px;' },\r\n      t('add_api_key_warning')\r\n    ),\r\n    bodyStyle: {\r\n      padding: '12px 8px 4px 12px'\r\n    },\r\n    okText: t('create_btn'),\r\n    width: 480,\r\n    onOk: () => {\r\n      handleCrrate()\r\n    },\r\n    onCancel: () => {}\r\n  })\r\n}\r\n\r\nconst handleCrrate = () => {\r\n  addRobotApikey({\r\n    robot_key: robotInfo.value.robot_key\r\n  }).then((res) => {\r\n    message.success(t('create_success'))\r\n    getApiKeyList()\r\n  })\r\n}\r\n\r\nconst handleDelApiKey = (item) => {\r\n  let secondsToGo = 5\r\n  let key = formatString(item.key)\r\n  let modal = Modal.confirm({\r\n    title: t('confirm_delete_title', { key }),\r\n    icon: createVNode(ExclamationCircleOutlined),\r\n    content: h('div', { style: { color: '#FB363F' } }, t('delete_warning')),\r\n    okText: secondsToGo + ' ' + t('confirm_btn'),\r\n    okType: 'danger',\r\n    cancelText: t('cancel_btn'),\r\n    okButtonProps: {\r\n      disabled: true\r\n    },\r\n    onOk() {\r\n      deleteRobotApikey({\r\n        robot_key: robotInfo.value.robot_key,\r\n        id: item.id\r\n      }).then((res) => {\r\n        message.success(t('delete_success'))\r\n        getApiKeyList()\r\n      })\r\n    },\r\n    onCancel() {}\r\n  })\r\n\r\n  let interval = setInterval(() => {\r\n    if (secondsToGo == 1) {\r\n      modal.update({\r\n        okText: t('confirm_btn'),\r\n        okButtonProps: {\r\n          disabled: false\r\n        }\r\n      })\r\n\r\n      clearInterval(interval)\r\n      interval = undefined\r\n    } else {\r\n      secondsToGo -= 1\r\n\r\n      modal.update({\r\n        okText: secondsToGo + ' ' + t('confirm_btn'),\r\n        okButtonProps: {\r\n          disabled: true\r\n        }\r\n      })\r\n    }\r\n  }, 1000)\r\n}\r\nfunction formatString(str) {\r\n  let start = str.slice(0, 4)\r\n  let end = str.slice(-4)\r\n\r\n  if (str.length <= 4) {\r\n    return str\r\n  } else if (str.length <= 8) {\r\n    return start + '...'\r\n  } else {\r\n    return start + '...' + end\r\n  }\r\n}\r\nconst copyText = async (text) => {\r\n  try {\r\n    await toClipboard(text)\r\n    message.success(t('copy_success'))\r\n  } catch (e) {\r\n    message.error(t('copy_fail'))\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.page-container {\r\n  padding: 16px 24px;\r\n  .page-title {\r\n    line-height: 24px;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n  }\r\n  &::v-deep(.ant-alert-info) {\r\n    margin-top: 16px;\r\n    padding: 9px 16px;\r\n    border-radius: 6px;\r\n    background: #e9f1fe;\r\n    border: 1px solid #99bffd;\r\n    font-size: 14px;\r\n    line-height: 22px;\r\n    align-items: baseline;\r\n    & > .anticon {\r\n      color: #2475fc;\r\n    }\r\n    .alert-content {\r\n      color: #3a4559;\r\n      font-weight: 400;\r\n    }\r\n  }\r\n\r\n  .opration-box {\r\n    margin-top: 16px;\r\n    display: flex;\r\n    gap: 16px;\r\n  }\r\n\r\n  .list-box {\r\n    margin-top: 16px;\r\n    .list-item {\r\n      padding: 14px 16px;\r\n      border: 1px solid #d9d9d9;\r\n      margin-bottom: 16px;\r\n      border-radius: 4px;\r\n      .key-content {\r\n        flex: 1;\r\n        word-break: break-all;\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        span {\r\n          color: #262626;\r\n          font-weight: 500;\r\n          line-height: 22px;\r\n          font-size: 14px;\r\n        }\r\n      }\r\n      .right-box {\r\n        margin-left: 78px;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 12px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"names":["t","useI18n","toClipboard","useClipboard","robotStore","useRobotStore","robotInfo","storeToRefs","end_point","ref","lists","getApiKeyList","listRobotApikey","res","handleChangeStatus","item","updateRobotApikey","message","handleOpenAddModal","Modal","h","handleCrrate","addRobotApikey","handleDelApiKey","secondsToGo","key","formatString","modal","createVNode","ExclamationCircleOutlined","deleteRobotApikey","interval","str","start","end","copyText","text","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","_unref","_createVNode","_component_a_alert","ExclamationCircleFilled","_hoisted_3","_hoisted_4","_component_a_button","_component_a_input","$event","_cache","_hoisted_5","_hoisted_6","_Fragment","_renderList","_component_a_flex","_hoisted_7","_hoisted_8","_component_a_switch"],"mappings":"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"}