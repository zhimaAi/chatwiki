import{M as X,ev as Z,ew as G,b as H,ex as K,n as B,a1 as W,ey as tt,ez as et,eA as at}from"../../index-Bo1NSLpy.js";import{P as it}from"./page-tabs-BX6y8B32.js";import{d as p,N as f,O as u,j as i,U as s,Z as v,_ as n,X as o,z as N,q as ot,u as S,S as z,a6 as L,F as lt,a1 as st}from"./vue-chunks-BRsu9_To.js";import{a as O,_ as P}from"./index-Ct9MFKxB.js";import{_ as U}from"./index-Bbrx8UDU.js";import{S as nt,a as rt}from"./index-Bs02Ec-o.js";import{R}from"./RightOutlined-zEOifMPB.js";import{R as dt}from"./dayjs-CU3n21qy.js";import{_ as _t}from"./index-QWfBu8FK.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./index-C_M0mW4F.js";import"./List-qVz67bUg.js";import"./index-BwedndIp.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./CaretDownFilled-DQ5FyPd3.js";import"./index-BeCYXilq.js";import"./responsiveObserve-D3ho5cFZ.js";import"./index-CuPJUS8f.js";import"./index-eahgXICC.js";import"./LeftOutlined-6ERu0fUO.js";import"./Trigger-DtRTHvld.js";import"./index-B4MPC5xv.js";import"./colors-4myZb9T8.js";import"./DownOutlined-CrhRpWT5.js";import"./useMergedState-C0iIHNGF.js";import"./index-kP7DVVOS.js";import"./Checkbox-B_uQPvVs.js";import"./FormItemContext-Cv3f2sEj.js";import"./index-BZOjzqJ2.js";import"./dropdown-DAy60lp8.js";import"./Dropdown-hEIgqeS3.js";import"./move-DztQgbGg.js";import"./slide-CVAZ5BEM.js";import"./index-Dxy-C30T.js";import"./shallowequal-C0xnIuy8.js";import"./index-Bb6fuwF7.js";import"./RadioButton-CWIeNl_M.js";import"./CaretDownOutlined-C8EH_hS-.js";import"./SearchOutlined-CFTHZIcT.js";import"./index-Caod9rOO.js";import"./Input-CCKFAS4o.js";import"./inputProps--_pnbyjO.js";import"./Search-BF8URtRh.js";import"./isPlainObject-CHj0iPA3.js";import"./TextArea--DLJ7VtX.js";import"./Password-CJww1n-s.js";import"./CheckOutlined-C6m5maw6.js";import"./index-6kOkS7uh.js";import"./index-D-M8_C_F.js";import"./ClockCircleOutlined-mLHYPvMf.js";const pt={__name:"detail-modal",setup(q,{expose:M}){const h=p(!1),y=p(!1),r=p([]),_=(t,m)=>{h.value=!0,y.value=!0,m==1?w(t):d(t)},w=t=>{Z({begin_date_ymd:t.begin_date_ymd,end_date_ymd:t.end_date_ymd,library_id:t.library_id,data_id:t.data_id}).then(m=>{r.value=m.data||[]}).finally(()=>{y.value=!1})},d=t=>{G({begin_date_ymd:t.begin_date_ymd,end_date_ymd:t.end_date_ymd,library_id:t.library_id}).then(m=>{r.value=m.data||[]}).finally(()=>{y.value=!1})};return M({show:_}),(t,m)=>{const g=P,b=U,D=O,C=X;return u(),f("div",null,[i(C,{open:h.value,"onUpdate:open":m[0]||(m[0]=c=>h.value=c),title:"机器人分布详情",width:624,footer:null},{default:s(()=>[i(D,{"data-source":r.value,loading:y.value,pagination:!1,scroll:{y:500}},{default:s(()=>[i(g,{key:"index","data-index":"index",title:"排名",width:100},{default:s(({index:c})=>[v(n(c+1),1)]),_:1}),i(g,{key:"robot_name",title:"机器人",width:140},{default:s(({record:c})=>[v(n(c.robot_name),1)]),_:1}),i(g,{key:"tip",title:"触发次数",width:120},{default:s(({record:c})=>[i(b,{gap:12},{default:s(()=>[o("span",null,n(c.tip),1)]),_:2},1024)]),_:1})]),_:1},8,["data-source","loading"])]),_:1},8,["open"])])}}},mt={class:"library-page"},ut={class:"statics-block"},ct={class:"statics-item"},vt={class:"num"},yt={class:"search-box"},gt={class:"tab-box"},bt={class:"library-page-body"},ft={class:"list-box"},ht={key:0},xt={key:1,class:"qa-list-box"},kt={class:"list-item"},wt={class:"list-content"},Dt={class:"list-item",style:{color:"#8c8c8c"}},Ct={class:"list-content"},Yt={key:0},St={key:0},Lt=["onClick"],Mt={__name:"index",setup(q){const M=K(),h=p([{title:"知识库",path:"/library/list"},{title:"数据库",path:"/database/list"},{title:"文档提取FAQ",path:"/ai-extract-faq/list"},{title:"触发次数统计",path:"/trigger-statics/list"}]),y=p(0),r=p([B().startOf("month"),B()]),_=p(1),w=p([]),d=N({begin_date_ymd:r.value[0].format("YYYYMMDD"),end_date_ymd:r.value[1].format("YYYYMMDD"),library_id:void 0}),t=N({page:1,size:100,total:0}),m=[{label:"按内容",value:1},{label:"按知识库",value:2}],g=p([]),b=p(!1),D=()=>{b.value=!0,et({...d,...t}).then(l=>{let a=l.data.list||[];a=a.map(x=>({...x})),g.value=a,t.total=+l.data.total}).finally(()=>{b.value=!1})},C=()=>{b.value=!0,at({...d,...t}).then(l=>{let a=l.data.list||[];a=a.map(x=>({...x})),g.value=a,t.total=+l.data.total}).finally(()=>{b.value=!1})},c=()=>{t.total=0,_.value==1?t.size=100:t.size=20,Y()},V=l=>{t.page=l.current,t.size=l.pageSize,_.value==1?D():C()},Y=()=>{t.page=1,_.value==1?D():C()},F=()=>{d.begin_date_ymd="",d.end_date_ymd="",r.value&&r.value.length>0&&(d.begin_date_ymd=r.value[0].format("YYYYMMDD"),d.end_date_ymd=r.value[1].format("YYYYMMDD")),Y()},T=p(null),j=l=>{T.value.show({begin_date_ymd:d.begin_date_ymd,end_date_ymd:d.end_date_ymd,library_id:l.library_id,data_id:l.data_id},_.value)},A=()=>{tt().then(l=>{y.value=l.data.tip_total})};return ot(()=>{Y(),A(),W().then(l=>{w.value=l.data})}),(l,a)=>{const x=dt,Q=_t,$=rt,E=nt,k=P,I=U,J=O;return u(),f("div",mt,[i(it,{class:"mb-16",tabs:h.value,active:"/trigger-statics/list"},null,8,["tabs"]),o("div",ut,[o("div",ct,[a[3]||(a[3]=o("div",{class:"title"},"合计触发次数",-1)),o("div",vt,n(y.value),1)])]),o("div",yt,[i(x,{value:r.value,"onUpdate:value":a[0]||(a[0]=e=>r.value=e),allowClear:!1,onChange:F,style:{width:"256px"},presets:S(M)},null,8,["value","presets"])]),o("div",gt,[a[4]||(a[4]=o("div",{class:"main-title"},"触发次数排行榜",-1)),i(Q,{onChange:c,value:_.value,"onUpdate:value":a[1]||(a[1]=e=>_.value=e),options:m},null,8,["value"]),_.value==1?(u(),z(E,{key:0,placeholder:"全部知识库",allowClear:"",onChange:Y,value:d.library_id,"onUpdate:value":a[2]||(a[2]=e=>d.library_id=e),style:{width:"220px"}},{default:s(()=>[(u(!0),f(lt,null,st(w.value,e=>(u(),z($,{value:e.id},{default:s(()=>[v(n(e.library_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])):L("",!0)]),o("div",bt,[o("div",ft,[i(J,{"data-source":g.value,sticky:"",loading:b.value,pagination:{current:t.page,total:t.total,pageSize:t.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:V,scroll:{x:800}},{default:s(()=>[i(k,{key:"index","data-index":"index",title:"排名",width:100},{default:s(({index:e})=>[v(n(e+(t.page-1)*t.size+1),1)]),_:1}),_.value==1?(u(),z(k,{key:"content","data-index":"content",title:"知识内容",width:380},{default:s(({record:e})=>[e.content?(u(),f("div",ht,n(e.content),1)):(u(),f("div",xt,[o("div",kt,[a[5]||(a[5]=o("div",{class:"list-label"},"问题",-1)),o("div",wt,n(e.question),1)]),o("div",Dt,[a[6]||(a[6]=o("div",{class:"list-label"},"答案",-1)),o("div",Ct,n(e.answer),1)])]))]),_:1})):L("",!0),i(k,{key:"library_name",title:"所属知识库",width:140},{default:s(({record:e})=>[v(n(e.library_name)+" ",1),_.value==1?(u(),f("span",Yt,[i(S(R)),v(" "+n(e.group_name||"未分组")+" ",1),e.library_file_name?(u(),f("span",St,[i(S(R)),v(" "+n(e.library_file_name),1)])):L("",!0)])):L("",!0)]),_:1}),i(k,{key:"tip",title:"触发次数",width:100},{default:s(({record:e})=>[i(I,{gap:12},{default:s(()=>[o("span",null,n(e.tip),1),o("a",{onClick:zt=>j(e)},[a[7]||(a[7]=v("详情")),i(S(R))],8,Lt)]),_:2},1024)]),_:1}),i(k,{key:"percentage",title:"占比",width:100},{default:s(({record:e})=>[v(n(e.percentage)+"% ",1)]),_:1})]),_:1},8,["data-source","loading","pagination"])])]),i(pt,{ref_key:"detailModalRef",ref:T},null,512)])}}},Re=H(Mt,[["__scopeId","data-v-b2d53b87"]]);export{Re as default};
