import{d as O}from"./utils-CvB22N-W.js";import{u as T,cq as nt,cr as ot,cs as lt,j as st,A as it,ct as _t,cu as dt,cv as ut,cw as rt,cx as ct}from"../../index-DSFcP5NQ.js";import{P as pt}from"./page-tabs-D0DH-kej.js";import{x as Q,w as B,J as P,M as j,R as $,P as mt,y as gt,u as vt,v as yt}from"./ui-antd-Dl1wwwCD.js";import{r as m,a as M,b,y as o,t as d,u as e,_ as v,v as l,p as i,ag as bt,E as U,e as R,j as ft,q as L,F as ht,l as kt}from"./vue-chunks-BdaA73Wf.js";import{a0 as wt}from"./index-Cg7-0swo.js";import{_ as E}from"./emoji-mart-BBMRoEa3.js";import"./editor-cherry-CFIsbKoN.js";import"./elkjs-BN8GIjVH.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./other-LrIFyvU9.js";const xt={__name:"detail-modal",setup(V,{expose:s}){const{t:g}=T("views.trigger-statics.list.components.detail-modal"),k=m(!1),f=m(!1),w=m([]),x=(_,t)=>{k.value=!0,f.value=!0,t==1?y(_):c(_)},y=_=>{nt({begin_date_ymd:_.begin_date_ymd,end_date_ymd:_.end_date_ymd,library_id:_.library_id,data_id:_.data_id}).then(t=>{w.value=t.data||[]}).finally(()=>{f.value=!1})},c=_=>{ot({begin_date_ymd:_.begin_date_ymd,end_date_ymd:_.end_date_ymd,library_id:_.library_id,group_id:_.group_id}).then(t=>{w.value=t.data||[]}).finally(()=>{f.value=!1})};return s({show:x}),(_,t)=>{const a=B,Y=P,D=Q,h=j;return b(),M("div",null,[o(h,{open:k.value,"onUpdate:open":t[0]||(t[0]=r=>k.value=r),title:e(g)("modal_title"),width:624,footer:null},{default:d(()=>[o(D,{"data-source":w.value,loading:f.value,pagination:!1,scroll:{y:500}},{default:d(()=>[o(a,{key:"index","data-index":"index",title:e(g)("table.rank"),width:100},{default:d(({index:r})=>[v(l(r+1),1)]),_:1},8,["title"]),o(a,{key:"robot_name",title:e(g)("table.robot"),width:140},{default:d(({record:r})=>[v(l(r.robot_name),1)]),_:1},8,["title"]),o(a,{key:"tip",title:e(g)("table.trigger_count"),width:120},{default:d(({record:r})=>[o(Y,{gap:12},{default:d(()=>[i("span",null,l(r.tip),1)]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["data-source","loading"])]),_:1},8,["open","title"])])}}},Dt={class:"unknow-list-box"},Ct=["onClick"],Mt={__name:"unknow-question-modal",setup(V,{expose:s}){const{t:g}=T("views.trigger-statics.list.components.unknow-question-modal");bt();const k=m(!1),f=m(!1),w=m([]),x=U({begin_date_ymd:"",end_date_ymd:""}),y=_=>{k.value=!0,f.value=!0,x.begin_date_ymd=_.begin_date_ymd,x.end_date_ymd=_.end_date_ymd,lt(_).then(t=>{w.value=t.data||[]}).finally(()=>{f.value=!1})},c=_=>{wt({id:_.robot_id}).then(t=>{let a=`id=${_.robot_id}&robot_key=${t.data.robot_key}&start_date=${x.begin_date_ymd}&end_date=${x.end_date_ymd}`;window.open(`/#/robot/config/unknown_issue?${a}`)})};return s({show:y}),(_,t)=>{const a=B,Y=P,D=Q,h=j;return b(),R(h,{open:k.value,"onUpdate:open":t[0]||(t[0]=r=>k.value=r),title:e(g)("title_unknown_question_robot_distribution"),width:700,footer:null},{default:d(()=>[i("div",Dt,[o(D,{"data-source":w.value,loading:f.value,pagination:!1,scroll:{y:500}},{default:d(()=>[o(a,{key:"index","data-index":"index",title:e(g)("label_rank"),width:100},{default:d(({index:r})=>[v(l(r+1),1)]),_:1},8,["title"]),o(a,{key:"robot_name",title:e(g)("label_robot"),width:200},{default:d(({record:r})=>[v(l(r.robot_name),1)]),_:1},8,["title"]),o(a,{key:"unknow_count",title:e(g)("label_unknown_question_count"),width:150},{default:d(({record:r})=>[o(Y,{gap:12},{default:d(()=>[i("span",null,l(r.unknow_question_total),1)]),_:2},1024)]),_:1},8,["title"]),o(a,{key:"action",title:e(g)("label_action"),width:120},{default:d(({record:r})=>[i("a",{onClick:z=>c(r)},l(e(g)("btn_view_details")),9,Ct)]),_:1},8,["title"])]),_:1},8,["data-source","loading"])])]),_:1},8,["open","title"])}}},qt=E(Mt,[["__scopeId","data-v-746104e1"]]),Yt={class:"library-page"},Lt={class:"statics-block"},Rt={class:"statics-item"},St={class:"title"},$t={class:"num"},zt={class:"title"},Ut={class:"num"},Tt={class:"search-box"},Qt={class:"tab-box"},Bt={class:"main-title"},Pt={class:"library-page-body"},Vt={class:"list-box"},It={key:0},Nt={key:1,class:"qa-list-box"},Ot={class:"list-item"},jt={class:"list-label"},Et={class:"list-content"},Ft={class:"list-item",style:{color:"#8c8c8c"}},Gt={class:"list-label"},Jt={class:"list-content"},At={key:0},Ht={key:0},Kt=["onClick"],Wt={__name:"index",setup(V){const{t:s}=T("views.trigger-statics.list.index"),g=st(),k=m([{title:s("knowledge_base"),path:"/library/list"},{title:s("database"),path:"/database/list"},{title:s("document_extraction_faq"),path:"/ai-extract-faq/list"},{title:s("trigger_count_statistics"),path:"/trigger-statics/list"}]),f=m(0),w=m(0),x=m(null),y=m([O().startOf("month"),O()]),c=m(1),_=m([]),t=U({begin_date_ymd:y.value[0].format("YYYYMMDD"),end_date_ymd:y.value[1].format("YYYYMMDD"),library_id:void 0}),a=U({page:1,size:100,total:0}),Y=[{label:s("by_content"),value:1},{label:s("by_knowledge_base_group"),value:3},{label:s("by_knowledge_base"),value:2}],D=m([]),h=m(!1),r=()=>{h.value=!0,ut({...t,...a}).then(u=>{let p=u.data.list||[];p=p.map(C=>({...C})),D.value=p,a.total=+u.data.total}).finally(()=>{h.value=!1})},z=()=>{h.value=!0,rt({...t,...a}).then(u=>{let p=u.data.list||[];p=p.map(C=>({...C})),D.value=p,a.total=+u.data.total}).finally(()=>{h.value=!1})},I=()=>{h.value=!0,ct({...t,...a}).then(u=>{let p=u.data.list||[];p=p.map(C=>({...C})),D.value=p,a.total=+u.data.total}).finally(()=>{h.value=!1})},F=()=>{a.total=0,c.value==1?a.size=100:a.size=20,S()},G=u=>{a.page=u.current,a.size=u.pageSize,c.value==1&&r(),c.value==2&&z(),c.value==3&&I()},S=()=>{a.page=1,c.value==1&&r(),c.value==2&&z(),c.value==3&&I()},J=()=>{t.begin_date_ymd="",t.end_date_ymd="",y.value&&y.value.length>0&&(t.begin_date_ymd=y.value[0].format("YYYYMMDD"),t.end_date_ymd=y.value[1].format("YYYYMMDD")),S()},N=m(null),A=u=>{N.value.show({begin_date_ymd:t.begin_date_ymd,end_date_ymd:t.end_date_ymd,library_id:u.library_id,data_id:u.data_id,group_id:u.group_id},c.value)},H=()=>{_t().then(u=>{f.value=u.data.tip_total})},K=()=>{dt({begin_date_ymd:t.begin_date_ymd,end_date_ymd:t.end_date_ymd}).then(u=>{w.value=u.data.unknow_question_total})},W=()=>{x.value.show({begin_date_ymd:t.begin_date_ymd,end_date_ymd:t.end_date_ymd})};return ft(()=>{S(),H(),K(),it().then(u=>{_.value=u.data})}),(u,p)=>{const C=mt,X=gt,Z=yt,tt=vt,q=B,et=P,at=Q;return b(),M("div",Yt,[o(pt,{class:"mb-16",tabs:k.value,active:"/trigger-statics/list"},null,8,["tabs"]),i("div",Lt,[i("div",Rt,[i("div",St,l(e(s)("title_total_triggers")),1),i("div",$t,l(f.value),1)]),i("div",{class:"statics-item unknown-item cursor-pointer",onClick:W},[i("a",zt,[v(l(e(s)("unknown_questions_total"))+" ",1),o(e($))]),i("div",Ut,l(w.value),1)])]),i("div",Tt,[o(C,{value:y.value,"onUpdate:value":p[0]||(p[0]=n=>y.value=n),allowClear:!1,onChange:J,style:{width:"256px"},presets:e(g)},null,8,["value","presets"])]),i("div",Qt,[i("div",Bt,l(e(s)("trigger_ranking")),1),o(X,{onChange:F,value:c.value,"onUpdate:value":p[1]||(p[1]=n=>c.value=n),options:Y},null,8,["value"]),c.value==1||c.value==3?(b(),R(tt,{key:0,placeholder:e(s)("all_knowledge_base"),allowClear:"",onChange:S,value:t.library_id,"onUpdate:value":p[2]||(p[2]=n=>t.library_id=n),style:{width:"220px"}},{default:d(()=>[(b(!0),M(ht,null,kt(_.value,n=>(b(),R(Z,{value:n.id},{default:d(()=>[v(l(n.library_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["placeholder","value"])):L("",!0)]),i("div",Pt,[i("div",Vt,[o(at,{"data-source":D.value,sticky:"",loading:h.value,pagination:{current:a.page,total:a.total,pageSize:a.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:G,scroll:{x:800}},{default:d(()=>[o(q,{key:"index","data-index":"index",title:e(s)("ranking"),width:100},{default:d(({index:n})=>[v(l(n+(a.page-1)*a.size+1),1)]),_:1},8,["title"]),c.value==1?(b(),R(q,{key:"content","data-index":"content",title:e(s)("knowledge_content"),width:380},{default:d(({record:n})=>[n.content?(b(),M("div",It,l(n.content),1)):(b(),M("div",Nt,[i("div",Ot,[i("div",jt,l(e(s)("question")),1),i("div",Et,l(n.question),1)]),i("div",Ft,[i("div",Gt,l(e(s)("answer")),1),i("div",Jt,l(n.answer),1)])]))]),_:1},8,["title"])):L("",!0),c.value==3?(b(),R(q,{key:"group_name",title:e(s)("knowledge_base_group"),width:120},{default:d(({record:n})=>[v(l(n.group_name),1)]),_:1},8,["title"])):L("",!0),o(q,{key:"library_name",title:e(s)("owned_knowledge_base"),width:140},{default:d(({record:n})=>[i("span",null,[v(l(n.library_name)+" ",1),c.value==1?(b(),M("span",At,[o(e($)),v(" "+l(n.group_name||e(s)("unassigned"))+" ",1),n.library_file_name?(b(),M("span",Ht,[o(e($)),v(" "+l(n.library_file_name),1)])):L("",!0)])):L("",!0)])]),_:1},8,["title"]),o(q,{key:"tip",title:e(s)("trigger_count"),width:100},{default:d(({record:n})=>[o(et,{gap:12},{default:d(()=>[i("span",null,l(n.tip),1),i("a",{onClick:Xt=>A(n)},[v(l(e(s)("details")),1),o(e($))],8,Kt)]),_:2},1024)]),_:1},8,["title"]),o(q,{key:"percentage",title:e(s)("proportion"),width:100},{default:d(({record:n})=>[v(l(n.percentage)+"% ",1)]),_:1},8,["title"])]),_:1},8,["data-source","loading","pagination"])])]),o(xt,{ref_key:"detailModalRef",ref:N},null,512),o(qt,{ref_key:"unknowQuestionModalRef",ref:x},null,512)])}}},re=E(Wt,[["__scopeId","data-v-a0086bb2"]]);export{re as default};
//# sourceMappingURL=index-CjVIL2KA.js.map
