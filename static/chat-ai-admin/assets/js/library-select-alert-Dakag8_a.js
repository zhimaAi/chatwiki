import{_ as Q}from"./cu-scroll-BiKEilFP.js";import{b as W,F as X,ar as Z}from"../../index-0SFcfYGN.js";import{u as ee}from"./robot-DwqmFfQP.js";import{k as te,I as se,T as ae,B as oe,av as le,p as ne,ax as ie,ay as ce,ah as re,ad as de,ag as ue,M as _e,a as pe}from"./ui-antd-BIopZvX3.js";import{r as ve,f as d,a1 as b,_ as i,a2 as l,a5 as t,k as o,u as _,G as S,ad as k,Y as p,ae as he,F as G,a9 as B,a7 as g}from"./vue-chunks-BSjLwu6d.js";const ge={class:"library-checkbox-box"},fe={class:"list-tools"},me={class:"list-group-box"},ye={key:0,class:"group-head-box"},be={class:"classify-box"},ke=["onClick"],xe={class:"classify-title"},Le={class:"right-content"},Ce={style:{flex:"1",overflow:"hidden"}},we={class:"list-box",ref:"scrollContainer"},Se={class:"library-name"},Ge={class:"library-desc"},Be={__name:"library-select-alert",emits:["change"],setup(Ie,{expose:I,emit:N}){const O=ee(),{robotInfo:R}=O,V=N,c=ve({indeterminate:!1,checkAll:!1,checkedList:[]}),u=d("");let x="library-list-hide-group-key";const r=d(localStorage.getItem(x)==1),A=()=>{r.value=!r.value,localStorage.setItem(x,r.value?1:0)},L=d([]),F=()=>{Z().then(a=>{let e=a.data||[],n=0;e.forEach(y=>{n+=+y.total}),L.value=[{group_name:"全部",total:n,id:""},...e]})},E=a=>{u.value=a.id,h()},v=d(!1),H=a=>{u.value="",h(),F(),c.checkedList=a,v.value=!0},K=()=>{v.value=!1,T()},f=d(""),M=()=>{h()},C=d([]),T=()=>{V("change",[...c.checkedList])},h=async()=>{const a=await X({library_name:f.value,type:"",show_open_docs:1});if(a){let e=a.data||[];u.value!=""&&(e=e.filter(n=>n.group_id==u.value)),C.value=e}},U=a=>{let e=a.target.value;c.checkedList.includes(e)?c.checkedList=c.checkedList.filter(n=>n!=e):c.checkedList.push(e)},m=d(!1),$=async()=>{m.value=!0,await h(),m.value=!1,pe.success("刷新完成")},z=()=>{window.open("/#/library/list")};return I({open:H}),(a,e)=>{const n=te,y=se,w=oe,D=Q,Y=ne,j=ue,q=de,J=re,P=_e;return i(),b(P,{width:"946px",open:v.value,"onUpdate:open":e[1]||(e[1]=s=>v.value=s),title:"关联知识库",onOk:K},{default:l(()=>[t("div",ge,[o(n,{message:"请选择关联知识库，机器人会根据知识库内上传的文档回复用户的提问。每个机器人最多关联5个知识库",type:"info"}),t("div",fe,[t("div",null,[o(y,{style:{width:"282px"},value:f.value,"onUpdate:value":e[0]||(e[0]=s=>f.value=s),placeholder:"请输入知识库名称搜索",onChange:M},{suffix:l(()=>[o(_(ae),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),t("div",null,[o(w,{style:{"margin-right":"8px"},onClick:$},{default:l(()=>[o(_(le)),e[2]||(e[2]=S(" 刷新 "))]),_:1,__:[2]}),o(w,{type:"primary",ghost:"",onClick:z},{default:l(()=>e[3]||(e[3]=[S("新建知识库")])),_:1,__:[3]})])]),t("div",me,[t("div",{class:k(["group-list-box",{"hide-group":r.value}])},[o(D,{style:{"padding-right":"16px"}},{default:l(()=>[r.value?he("",!0):(i(),p("div",ye,e[4]||(e[4]=[t("div",{class:"head-title"},[t("div",null,"知识库分组")],-1)]))),t("div",be,[(i(!0),p(G,null,B(L.value,s=>(i(),p("div",{class:k(["classify-item",{active:s.id==u.value}]),onClick:Ne=>E(s),key:s.id},[t("div",xe,g(s.group_name),1),t("div",Le,[t("div",{class:k(["num",{"num-block":s.id<=0}])},g(s.total),3)])],10,ke))),128))])]),_:1}),o(Y,{placement:"right",title:r.value?"展开分组":"收起分组"},{default:l(()=>[t("div",{class:"hide-group-box",onClick:A},[r.value?(i(),b(_(ce),{key:1})):(i(),b(_(ie),{key:0}))])]),_:1},8,["title"])],2),t("div",Ce,[o(J,{spinning:m.value,delay:100},{default:l(()=>[o(q,{value:c.checkedList,style:{width:"100%"}},{default:l(()=>[t("div",we,[(i(!0),p(G,null,B(C.value,s=>(i(),p("div",{class:"list-item-wraapper",key:s.id},[o(j,{class:"list-item",value:s.id,onChange:U,disabled:_(R).default_library_id==s.id},{default:l(()=>[t("div",Se,g(s.library_name),1),t("div",Ge,g(s.library_intro),1)]),_:2},1032,["value","disabled"])]))),128))],512)]),_:1},8,["value"])]),_:1},8,["spinning"])])])])]),_:1},8,["open"])}}},Ee=W(Be,[["__scopeId","data-v-e2debb4a"]]);export{Ee as L};
