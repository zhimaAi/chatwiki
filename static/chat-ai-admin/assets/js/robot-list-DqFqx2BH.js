import{_ as le,c as Rt,a5 as he,a6 as Le,a7 as Ge,a8 as xe,a9 as je,aa as Xe,d as st,ab as nt,ac as it,f as Pt,ad as et,o as Ut,p as Mt,ae as It,af as Lt}from"../../index-CB2DywzJ.js";import{_ as Et}from"./cu-scroll-D9utH_KS.js";import{f as _,ae as z,ad as s,ar as l,as as e,k as t,G as S,u as I,r as we,ac as p,F as q,ax as Q,at as M,az as V,ai as be,o as Pe,l as se,B as K,av as ut,aw as dt,w as Nt,y as rt,e as Ee,n as tt,A as ot}from"./vue-chunks-CGLjTDrY.js";import{d as Dt}from"./vuedraggable.umd-B2hsG2dX.js";import{i as Bt,j as ct,k as Ht,g as pt,l as lt,m as Jt,n as Ft,o as Gt,p as jt,q as zt,t as qt}from"./index-CoChppVN.js";import{A as vt,a as Kt,b as Vt}from"./add-group-C_PffL7b.js";import{o as Ne,aw as Wt,ax as Yt,M as W,b as H,u as _t,y as ze,z as qe,F as Ue,e as De,I as ge,$ as Be,V as ft,a9 as mt,al as Me,ai as Qt,Q as Zt,a6 as re,B as ve,ar as fe,h as Ce,i as Te,k as Se,J as yt,a2 as kt,as as Ke,ae as bt,ay as Xt,az as eo,aA as to,O as ht,at as $e,a5 as oo,G as lo,aB as ao,aC as so,w as no,x as io,v as He,ah as uo,aD as ro,d as co,W as Ie,an as po,a0 as vo,aE as _o,R as fo}from"./ui-antd-BHaxN-GS.js";import{_ as mo}from"./page-alert-DcOtfX2y.js";import{L as yo}from"./list-tabs-CTUWZo1P.js";import{_ as Re}from"./empty-BFmzY9bl.js";import{_ as ko}from"./no-permission-DtJ3NYHG.js";import{_ as bo}from"./tool-icon-IWVrYlVb.js";import{a as Fe,g as ho,s as go,b as $o,d as xo}from"./thirdMcp-9tndvGRi.js";import{s as wo,S as Co,P as To,d as gt,a as at,g as So,b as Ao}from"./subs-key-DRQN5duh.js";import{u as Oo}from"./index-DxgALpad.js";import"./neo4j-CSfpjqgw.js";import"./utils-pAinW4BS.js";import"./other-BrZCAsTs.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./vue-pdf-embed-Bj6uRJ-9.js";import"./index-BcMVDew1.js";import"./robot-BQqgDPGj.js";const Ro={class:"form-box"},Po={class:"tip-box"},Uo={class:"ant-upload-drag-icon"},Mo={__name:"import-csl-alert",emits:["ok"],setup(D,{expose:F,emit:B}){const R=B,g=_(!1),d=_(!1),m=_([]),r=()=>{g.value=!0},x=()=>{g.value=!1,m.value=[]},O=()=>{if(m.value.length===0){H.error("请上传csl文件");return}d.value=!0,Bt({file:m.value[0].originFileObj}).then(f=>{d.value=!1,g.value=!1,H.success("导入成功"),m.value=[],R("ok",f.data)}).catch(()=>{d.value=!1})},n=f=>f.name.endsWith(".csl")?!1:(H.error("只能上传csl格式的文件"),_t.LIST_IGNORE),o=f=>{const{status:y}=f.file;y!=="uploading"&&(f.file,f.fileList)};return F({open:r}),(f,y)=>{const k=Ne,i=Yt,$=W;return s(),z($,{width:"600px",open:g.value,"onUpdate:open":y[1]||(y[1]=u=>g.value=u),confirmLoading:d.value,title:"导入csl文件创建机器人",onOk:O,onCancel:x},{default:l(()=>[e("div",Ro,[e("div",Po,[t(k,{type:"info"},{description:l(()=>[...y[2]||(y[2]=[S(" 您可以将您编排好的机器人导出为csl文件,共享给他人使用。也可以从他人处获取导出的csl文件,通过导入形式创建机器人。 ",-1)])]),_:1})]),t(i,{fileList:m.value,"onUpdate:fileList":y[0]||(y[0]=u=>m.value=u),name:"file",multiple:!1,maxCount:1,accept:".csl","before-upload":n,onChange:o},{default:l(()=>[e("p",Uo,[t(I(Wt),{class:"upload-icon"})]),y[3]||(y[3]=e("p",{class:"upload-text"},"点击或将文件拖拽到这里上传",-1)),y[4]||(y[4]=e("p",{class:"upload-hint"},"仅支持从chatwiki导出生成的csl文件",-1))]),_:1},8,["fileList"])])]),_:1},8,["open","confirmLoading"])}}},Io=le(Mo,[["__scopeId","data-v-ae06ccf0"]]),Lo={class:"form-item"},Eo={class:"form-content"},No={__name:"edit-group",emits:["ok"],setup(D,{expose:F,emit:B}){const R=_(!1),g=B,d=_("修改分组"),m=we({group_id:"",robot_id:""}),r=_([]),x=o=>{m.group_id=o.group_id||"0",m.robot_id=o.id||"",n(),R.value=!0},O=()=>{if(!m.group_id)return H.error("请选择分组");Ht({...m}).then(o=>{H.success(`${d.value}成功`),R.value=!1,g("ok")})},n=()=>{ct().then(o=>{r.value=o.data||[]})};return F({show:x}),(o,f)=>{const y=qe,k=ze,i=W;return s(),p("div",null,[t(i,{open:R.value,"onUpdate:open":f[1]||(f[1]=$=>R.value=$),title:d.value,onOk:O},{default:l(()=>[e("div",Lo,[f[2]||(f[2]=e("div",{class:"form-label"},"分组名称：",-1)),e("div",Eo,[t(k,{value:m.group_id,"onUpdate:value":f[0]||(f[0]=$=>m.group_id=$),style:{width:"100%"},placeholder:"请选择分组"},{default:l(()=>[(s(!0),p(q,null,Q(r.value,$=>(s(),z(y,{value:$.id},{default:l(()=>[S(M($.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])]),_:1},8,["open","title"])])}}},Do=le(No,[["__scopeId","data-v-5680d53a"]]),Bo=()=>{const D=Rt();return{openUrlWithToken:B=>{const R=D.getToken;if(!R){console.warn("Token is missing");return}if(!B){console.warn("URL is missing");return}const g=B.includes("?")?"&":"?",d=`${B}${g}token=${R}`;window.open(d,"_blank")}}};function Ho(D={}){return he.get({url:"/manage/getMcpServerList",params:D})}function Jo(D={}){return he.post({headers:{"Content-Type":"multipart/form-data"},url:"/manage/saveMcpServer",data:D})}function Fo(D={}){return he.post({url:"/manage/deleteMcpServer",data:D})}function Go(D={}){return he.post({url:"/manage/updateMcpServerPublishStatus",data:D})}function jo(D={}){return he.post({url:"/manage/saveMcpTool",data:D})}function zo(D={}){return he.post({url:"/manage/editMcpTool",data:D})}function qo(D={}){return he.post({url:"/manage/deleteMcpTool",data:D})}const Ko={class:"avatar-box"},Vo={__name:"mcp-store",emits:["ok"],setup(D,{expose:F,emit:B}){const R=B,g=_(!1),d=_(!1),m=_(null),r={avatar:Le,name:"",description:"",server_id:""},x=we({});function O(f=null){Object.assign(x,f||r),m.value=null,g.value=!0}function n(f){m.value=f}function o(){var f;try{if(d.value=!0,x.name=x.name.trim(),x.description=x.description.trim(),!x.name)throw"请输入MCP插件名称";if(!x.description)throw"请输入MCP插件描述";let y={...x};m.value&&(y.avatar=(f=m.value)==null?void 0:f.file),Jo(y).then(k=>{R("ok",x),H.success("已保存"),g.value=!1}).finally(()=>{d.value=!1})}catch(y){d.value=!1,H.error(y)}}return F({show:O}),(f,y)=>{const k=ge,i=De,$=Be,u=Ue,b=W;return s(),z(b,{open:g.value,"onUpdate:open":y[3]||(y[3]=c=>g.value=c),title:x.server_id?"编辑MCP":"添加MCP",width:"472px","confirm-loading":d.value,onOk:o},{default:l(()=>[e("div",Ko,[t(vt,{value:x.avatar,"onUpdate:value":y[0]||(y[0]=c=>x.avatar=c),onChange:n},null,8,["value"]),y[4]||(y[4]=e("div",{class:"tip-info"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1))]),t(u,{class:"form-box",labelAlign:"left"},{default:l(()=>[t(i,{label:"MCP插件名称",required:"",colon:!1},{default:l(()=>[t(k,{value:x.name,"onUpdate:value":y[1]||(y[1]=c=>x.name=c),placeholder:"请输入MCP插件名称，最多20个字",maxlength:20},null,8,["value"])]),_:1}),t(i,{label:"描述",colon:!1},{default:l(()=>[t($,{value:x.description,"onUpdate:value":y[2]||(y[2]=c=>x.description=c),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入描述",maxlength:20},null,8,["value"])]),_:1}),x.server_id?V("",!0):(s(),p(q,{key:0},[y[5]||(y[5]=e("div",{class:"tit-box"},[S("配置信息 "),e("span",{class:"desc"},"以下配置创建完成后自动生成")],-1)),t(i,{label:"插件URL",colon:!1},{default:l(()=>[t(k,{disabled:"",placeholder:"创建完成后默认生成"})]),_:1}),t(i,{label:"授权方式",colon:!1},{default:l(()=>[t(k,{disabled:"",placeholder:"Service token / API key"})]),_:1}),t(i,{label:"请求头",colon:!1},{default:l(()=>[t(k,{disabled:"",placeholder:"Authorization"})]),_:1}),t(i,{label:"API KEY",colon:!1},{default:l(()=>[t(k,{disabled:"",placeholder:"创建完成后默认生成"})]),_:1})],64))]),_:1})]),_:1},8,["open","title","confirm-loading"])}}},Wo=le(Vo,[["__scopeId","data-v-2693434d"]]),Yo={class:"data-list"},Qo=["onClick"],Zo=["src"],Xo={class:"info"},el={class:"tit"},tl={class:"desc"},ol={key:1,class:"status-tag waiting"},ll={__name:"select-workflow-modal",emits:["ok"],setup(D,{expose:F,emit:B}){const R=B,g=_(!1),d=_([]),m=_([]);function r(n=[]){m.value=n,g.value=!0,x()}function x(){pt({application_type:1}).then(n=>{d.value=n.data||[],d.value.forEach(o=>{o.checked=m.value.includes(o.id)})})}function O(){g.value=!1,R("ok",d.value.filter(n=>n.checked).map(n=>n.id),d)}return F({show:r}),(n,o)=>{const f=Ne,y=ft,k=W;return s(),z(k,{open:g.value,"onUpdate:open":o[0]||(o[0]=i=>g.value=i),title:"关联工作流",width:"669px",onOk:O},{default:l(()=>[t(f,{class:"zm-alert-info mt24",type:"info",message:"选择工作流后，会自动生成唯一标识符，可修改","show-icon":""}),e("div",Yo,[(s(!0),p(q,null,Q(d.value,(i,$)=>(s(),p("div",{key:$,class:be(["data-item",{disabled:i.has_published!=1}]),onClick:u=>i.checked=!i.checked},[e("img",{class:"avatar",src:i.robot_avatar},null,8,Zo),e("div",Xo,[e("div",null,[e("div",el,M(i.robot_name),1),e("div",tl,M(i.robot_intro),1)]),i.has_published==1?(s(),z(y,{key:0,checked:i.checked,"onUpdate:checked":u=>i.checked=u},null,8,["checked","onUpdate:checked"])):(s(),p("span",ol,[t(I(mt)),o[1]||(o[1]=S(" 未发布",-1))]))])],10,Qo))),128))])]),_:1},8,["open"])}}},al=le(ll,[["__scopeId","data-v-214b9222"]]),sl={class:"_mcp-box"},nl={key:0,class:"loading-box"},il={class:"base-info-box"},ul={class:"app-info"},dl=["src"],rl={class:"info-box"},cl={class:"left-box"},pl={class:"name"},vl={key:0,class:"status-tag finished"},_l={key:1,class:"status-tag waiting"},fl={class:"desc"},ml={class:"right-box"},yl={class:"app-data"},kl={class:"data-item"},bl={class:"title"},hl={class:"value"},gl={class:"tools-box"},$l={class:"head-box"},xl={key:0,class:"tools-list"},wl={class:"left"},Cl={class:"tit"},Tl={class:"key"},Sl={class:"desc"},Al={class:"params"},Ol={class:"params-box"},Rl={class:"field"},Pl={class:"name"},Ul={class:"type"},Ml={key:0,class:"required"},Il={class:"desc"},Ll={key:1,class:"empty-box"},El={key:2,class:"empty-box"},Nl={class:"mt4"},Dl={__name:"mcp-box",setup(D){const F=_(null),B=_(null),R=_(!0),g=_(!1),d=_(null),m=_([]),r=_([]),x=_(!1),O=_(!1),n=_(""),o=_(null);Pe(()=>{f()});function f(){R.value=!0,y()}function y(){Ho().then(U=>{var w,A,a;d.value=((w=U==null?void 0:U.data)==null?void 0:w.info)||{},r.value=((A=U==null?void 0:U.data)==null?void 0:A.tool_list)||{},d.value.status_bool=((a=d.value)==null?void 0:a.publish_status)==1,r.value.forEach(N=>{N.params=Ge(N.params,[])}),i()}).finally(()=>{R.value=!1})}function k(){const U=()=>{d.value.status_bool=!d.value.status_bool},w=()=>{g.value=!0,Go({server_id:d.value.id,publish_status:Number(d.value.status_bool)}).then(A=>{H.success("操作完成")}).finally(()=>{g.value=!1}).catch(()=>{U()})};d.value.status_bool?w():W.confirm({title:"确认关闭MCP服务？",content:"关闭后，其他应用的位置都不可使用！确认关闭？",okText:"确定",cancelText:"取消",onOk:()=>w(),onCancel:()=>U()})}function i(){var U;m.value=[{title:"URL",value:`${window.location.origin}/mcp`},{title:"请求方式",value:"POST"},{title:"授权方式",value:"Service token / API key"},{title:"请求参数名",value:"Authorization"},{title:"API key",value:`Bearer ${(U=d.value)==null?void 0:U.api_key}`}]}function $(){var w;let U=null;((w=d.value)==null?void 0:w.id)>0&&(U={avatar:d.value.avatar,name:d.value.name,description:d.value.description,server_id:d.value.id}),F.value.show(U)}function u(){W.confirm({title:"确认删除MCP服务？",content:"删除后，其他应用的位置都不可使用！确认删除？",okText:"确定",cancelText:"取消",onOk:()=>{Fo({server_id:d.value.id}).then(()=>{H.success("已删除"),y()})}})}function b(){B.value.show(r.value.map(U=>U.robot_id))}function c(U){o.value=U,n.value=U.name,x.value=!0}const v=U=>{U.target.value=U.target.value.replace(/[^a-zA-Z0-9_]/g,""),n.value=U.target.value};function E(){if(!n.value)return H.warning("请输入标识符");O.value=!0,zo({tool_id:o.value.id,name:n.value}).then(U=>{o.value.name=n.value,x.value=!1,H.success("已保存")}).finally(()=>{O.value=!1})}function G(U){W.confirm({title:"确认删除该工具？",okText:"确定",cancelText:"取消",onOk:()=>{qo({tool_id:U.id}).then(()=>{H.success("已删除"),y()})}})}function Z(U){jo({server_id:d.value.id,robot_id:U.toString()}).then(w=>{y(),H.success("已保存")})}return(U,w)=>{const A=Me,a=Zt,N=ve,h=Te,L=Ce,X=Se,ie=yt,ue=Ke,ae=bt,ce=ge,ne=W;return s(),p("div",sl,[R.value?(s(),p("div",nl,[t(A)])):d.value.id>0?(s(),p(q,{key:1},[e("div",il,[e("div",ul,[e("img",{class:"avatar",src:d.value.avatar},null,8,dl),e("div",rl,[e("div",cl,[e("div",pl,[S(M(d.value.name)+" ",1),d.value.status_bool?(s(),p("span",vl,[t(I(Qt)),w[3]||(w[3]=S(" 已发布",-1))])):(s(),p("span",_l,[t(I(mt)),w[4]||(w[4]=S(" 未发布",-1))]))]),e("div",fl,M(d.value.description),1)]),e("div",ml,[t(a,{checked:d.value.status_bool,"onUpdate:checked":w[0]||(w[0]=ee=>d.value.status_bool=ee),onChange:k,loading:g.value,"checked-children":"开","un-checked-children":"关"},null,8,["checked","loading"]),t(N,{onClick:b,type:"primary",ghost:"",icon:se(I(re))},{default:l(()=>[...w[5]||(w[5]=[S("添加工作流",-1)])]),_:1},8,["icon"]),t(X,null,{overlay:l(()=>[t(L,null,{default:l(()=>[t(h,{onClick:$},{default:l(()=>[...w[6]||(w[6]=[S("编辑",-1)])]),_:1}),t(h,{onClick:u},{default:l(()=>[...w[7]||(w[7]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1})]),_:1})]),default:l(()=>[t(N,{icon:se(I(fe))},null,8,["icon"])]),_:1})])])]),e("div",yl,[(s(!0),p(q,null,Q(m.value,(ee,me)=>(s(),p(q,{key:me},[e("div",kl,[e("div",bl,M(ee.title),1),e("div",hl,M(ee.value),1)]),t(ie,{type:"vertical",style:{height:"24px"}})],64))),128))])]),e("div",gl,[e("div",$l,[t(I(kt),{class:"icon"}),S(" 工具列表（"+M(r.value.length||0)+"） ",1)]),r.value.length?(s(),p("div",xl,[(s(!0),p(q,null,Q(r.value,(ee,me)=>(s(),p("div",{key:me,class:"tools-item"},[e("div",wl,[e("div",Cl,M(ee.robot_name),1),e("div",Tl,"唯一标识符号："+M(ee.name),1),e("div",Sl,M(ee.robot_intro),1),e("div",Al,[(s(!0),p(q,null,Q(ee.params.slice(0,5),(de,ye)=>(s(),z(ue,{key:ye,bordered:!1},{default:l(()=>[S(M(de.key),1)]),_:2},1024))),128)),t(ae,{placement:"right"},{content:l(()=>[e("div",Ol,[(s(!0),p(q,null,Q(ee.params,(de,ye)=>(s(),p("div",{key:ye,class:"param-item"},[e("div",Rl,[e("span",Pl,M(de.key),1),e("span",Ul,M(de.typ),1),de.required?(s(),p("span",Ml,"必填")):V("",!0)]),e("div",Il,M(de.desc),1)]))),128))])]),default:l(()=>[w[8]||(w[8]=e("a",null,"参数",-1))]),_:2},1024)])]),t(X,null,{overlay:l(()=>[t(L,null,{default:l(()=>[t(h,{onClick:de=>c(ee)},{default:l(()=>[...w[9]||(w[9]=[S("编辑标识符",-1)])]),_:1},8,["onClick"]),t(h,{onClick:de=>G(ee)},{default:l(()=>[...w[10]||(w[10]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[t(N,{size:"small",icon:se(I(fe))},null,8,["icon"])]),_:2},1024)]))),128))])):(s(),p("div",Ll,[w[12]||(w[12]=e("img",{src:Re},null,-1)),w[13]||(w[13]=e("div",{class:"title"},"暂未绑定工作流",-1)),t(N,{onClick:b,class:"btn",type:"primary"},{default:l(()=>[...w[11]||(w[11]=[S("立即绑定",-1)])]),_:1})]))])],64)):(s(),p("div",El,[w[15]||(w[15]=e("img",{src:Re},null,-1)),w[16]||(w[16]=e("div",{class:"title"},"暂未添加工作流MCP插件",-1)),t(N,{onClick:$,class:"btn",type:"primary"},{default:l(()=>[...w[14]||(w[14]=[S("立即添加",-1)])]),_:1})])),t(Wo,{ref_key:"mcpRef",ref:F,onOk:y},null,512),t(al,{ref_key:"workflowRef",ref:B,onOk:Z},null,512),t(ne,{open:x.value,"onUpdate:open":w[2]||(w[2]=ee=>x.value=ee),"confirm-loading":O.value,title:"编辑标识符",onOk:E},{default:l(()=>[w[17]||(w[17]=e("div",null,"标识符",-1)),e("div",Nl,[t(ce,{value:n.value,"onUpdate:value":w[1]||(w[1]=ee=>n.value=ee),onInput:v,placeholder:"请输入标识符",maxlength:32},null,8,["value"])])]),_:1},8,["open","confirm-loading"])])}}},Bl=le(Dl,[["__scopeId","data-v-19e13f20"]]),Hl={key:0,class:"checking-box"},Jl={class:"cont"},Fl={class:"head-box"},Gl={class:"base-info-box"},jl=["src"],zl={class:"info-box"},ql={class:"left"},Kl={class:"name zm-line1"},Vl={key:0,class:"auth-tag"},Wl={key:1,class:"auth-tag fail"},Yl={class:"right"},Ql={class:"link"},Zl={class:"link"},Xl={class:"body-box"},ea={key:0,class:"no-auth-box"},ta={class:"main-tit"},oa={class:"extra-box"},la={class:"update-time"},aa={class:"tools-box"},sa={class:"info"},na={class:"tit"},ia={class:"desc"},ua={__name:"third-mcp-detail",emits:["del","edit","auth"],setup(D,{expose:F,emit:B}){const R=B,g=_(!1),d=_(!1),m=_(!1),r=_({});function x(k){r.value=k,g.value=!0}function O(){g.value=!1}function n(k){const i=()=>{d.value=!0,xe(!1),Fe({provider_id:r.value.id}).then($=>{setTimeout(()=>{d.value=!1,r.value.has_auth=1,y(),H.success("已验证，授权完成")},2e3)}).catch($=>{r.value.has_auth=0,H.warning("授权失败："+$.message),d.value=!1}).finally(()=>{R("auth",r.value.has_auth),setTimeout(()=>{xe(!0)},500)})};k==2?W.confirm({title:"提示",content:"授权或者刷新应用列表都可能会影响已有工具的调用，确认继续操作吗？",onOk:()=>{i()}}):i()}function o(){R("edit",r.value)}function f(){R("del",r.value)}function y(k=!1){const i=()=>{ho({provider_id:r.value.id}).then($=>{let u=($==null?void 0:$.data)||{};u.tools=Ge(u.tools,[]),u.up_time_text=je(u.update_time),r.value=u,k&&H.success("刷新完成")}).finally(()=>{m.value=!1})};if(k){if(m.value)return;W.confirm({title:"提示",content:"刷新应用列表或者授权都可能会影响已有工具的调用，确认继续操作吗？",onOk:()=>{m.value=!0,xe(!1),Fe({provider_id:r.value.id}).then($=>{r.value.has_auth=1,i()}).catch($=>{r.value.has_auth=0,H.warning("验证授权失败："+$.message),m.value=!1}).finally(()=>{R("auth",r.value.has_auth),xe(!0)})}})}else i()}return F({show:x,hide:O,refresh:y}),(k,i)=>{const $=Me,u=Te,b=Ce,c=Se,v=ve,E=to;return s(),z(E,{open:g.value,"onUpdate:open":i[5]||(i[5]=G=>g.value=G),placement:"right",width:"400px",headerStyle:{display:"none"},bodyStyle:{padding:0}},{default:l(()=>[d.value?(s(),p("div",Hl,[e("div",Jl,[t($),i[6]||(i[6]=S(" 正在验证... ",-1))])])):V("",!0),e("div",Fl,[e("div",Gl,[e("img",{class:"avatar",src:r.value.avatar},null,8,jl),e("div",zl,[e("div",ql,[e("div",Kl,M(r.value.name),1),e("div",null,[r.value.has_auth==1?(s(),p("div",Vl,"已授权")):(s(),p("div",Wl,"未授权"))])]),e("div",Yl,[t(c,null,{overlay:l(()=>[t(b,null,{default:l(()=>[t(u,{onClick:K(o,["stop"])},{default:l(()=>[...i[7]||(i[7]=[S("编辑",-1)])]),_:1}),t(u,{onClick:K(f,["stop"])},{default:l(()=>[...i[8]||(i[8]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1})]),_:1})]),default:l(()=>[t(I(fe),{class:"icon"})]),_:1}),t(I(Xt),{onClick:i[0]||(i[0]=G=>g.value=!1),class:"icon"})])])]),e("div",Ql,M(r.value.description),1),e("div",Zl,M(r.value.url),1),r.value.has_auth==1?(s(),z(v,{key:0,class:"auth-btn",onClick:i[1]||(i[1]=G=>n(2))},{default:l(()=>[...i[9]||(i[9]=[S("重新授权",-1)])]),_:1})):(s(),z(v,{key:1,type:"primary",class:"auth-btn",onClick:i[2]||(i[2]=G=>n(1))},{default:l(()=>[...i[10]||(i[10]=[S("授 权",-1)])]),_:1}))]),e("div",Xl,[r.value.has_auth!=1?(s(),p("div",ea,[i[11]||(i[11]=e("img",{src:ko},null,-1)),i[12]||(i[12]=e("div",{class:"tit"},"需要授权",-1)),i[13]||(i[13]=e("div",{class:"desc"},"授权后，MCP工具将显示在这里",-1)),e("a",{class:"link",onClick:i[3]||(i[3]=G=>n(1))},"立即授权")])):(s(),p(q,{key:1},[e("div",ta,[e("span",null,M(r.value.tools.length)+"个可用工具",1),e("div",oa,[e("div",la,M(r.value.up_time_text)+"更新",1),e("a",{class:"refresh-btn",onClick:i[4]||(i[4]=G=>y(!0))},[t(I(eo),{spin:m.value},null,8,["spin"]),i[14]||(i[14]=S(" 刷新 ",-1))])])]),e("div",aa,[(s(!0),p(q,null,Q(r.value.tools,(G,Z)=>(s(),p("div",{key:Z,class:"tool-item"},[i[15]||(i[15]=e("img",{class:"cover",src:bo},null,-1)),e("div",sa,[e("div",na,M(G.name),1),e("div",ia,M(G.description),1)])]))),128))])],64))])]),_:1},8,["open"])}}},da=le(ua,[["__scopeId","data-v-1870cc48"]]),ra={key:0,class:"checking-box"},ca={class:"cont"},pa={class:"avatar-box"},va={key:0,class:"cFB363F"},_a={class:"req-head-box"},fa={__name:"third-mcp-store",emits:["ok"],setup(D,{expose:F,emit:B}){const R=B,g=_(0),d=_(!1),m=_(!1),r=_(!1),x=_(null),O=_(""),n={avatar:Le,name:"",description:"",provider_id:"",url:"",request_timeout:"30",headers:[]},o=we({});function f(c=null){if(Object.assign(o,c||n),x.value=null,o.headers=[],c){g.value=c.id,o.provider_id=c.id;let v=JSON.parse(c.headers);for(let E in v)o.headers.push({key:E,value:v[E]})}O.value=JSON.stringify({headers:o.headers,url:o.url}),d.value=!0}function y(c){x.value=c}function k(){o.headers.push({key:"",value:""})}function i(c){o.headers.splice(c,1)}function $(){return O.value!=JSON.stringify({headers:o.headers,url:o.url})}function u(){const c=H.loading("保存完成，正在进行授权验证...",0);m.value=!0,setTimeout(()=>{xe(!1),Fe({provider_id:g.value}).then(v=>{H.success("授权完成！")}).catch(v=>{H.warning("授权失败："+v.message)}).finally(()=>{c(),m.value=!1,d.value=!1,R("ok",o),setTimeout(()=>{xe(!0)},500)})},1800)}function b(){var c;try{if(r.value=!0,o.name=o.name.trim(),o.description=o.description.trim(),!o.name)throw"请输入MCP插件名称";if(!o.description)throw"请输入MCP插件描述";if(!o.url)throw"请输入服务端点的URL";if(!o.request_timeout)throw"请输入超时时间";let v={...o};x.value&&(v.avatar=(c=x.value)==null?void 0:c.file),v.headers={};for(let E of o.headers)E.key=E.key.trim(),E.value=E.value.trim(),E.key&&E.value&&(v.headers[E.key]=E.value);v.headers=JSON.stringify(v.headers),delete v.toools,go(v).then(E=>{let{provider_id:G}=(E==null?void 0:E.data)||{};g.value=G,$()?u():(R("ok",o),H.success("已保存"),d.value=!1)}).finally(()=>{r.value=!1})}catch(v){r.value=!1,H.error(v)}}return F({show:f}),(c,v)=>{const E=Me,G=ge,Z=De,U=Be,w=ht,A=ve,a=Ue,N=W;return s(),z(N,{open:d.value,"onUpdate:open":v[5]||(v[5]=h=>d.value=h),zIndex:1002,title:o.provider_id?"编辑MCP":"添加MCP",width:"472px","confirm-loading":r.value,onOk:b},{default:l(()=>[m.value?(s(),p("div",ra,[e("div",ca,[t(E),v[6]||(v[6]=S(" 正在验证... ",-1))])])):V("",!0),e("div",pa,[t(vt,{value:o.avatar,"onUpdate:value":v[0]||(v[0]=h=>o.avatar=h),onChange:y},null,8,["value"]),v[7]||(v[7]=e("div",{class:"tip-info"},"点击替换，建议尺寸为100*100px，大小不超过100kb",-1))]),t(a,{class:"form-box",labelAlign:"left"},{default:l(()=>[t(Z,{label:"MCP插件名称",required:"",colon:!1},{default:l(()=>[t(G,{value:o.name,"onUpdate:value":v[1]||(v[1]=h=>o.name=h),placeholder:"请输入MCP插件名称，最多20个字",maxlength:20},null,8,["value"])]),_:1}),t(Z,{label:"描述",colon:!1},{default:l(()=>[t(U,{value:o.description,"onUpdate:value":v[2]||(v[2]=h=>o.description=h),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入描述",maxlength:120},null,8,["value"])]),_:1}),v[11]||(v[11]=e("div",{class:"tit-box"},"配置信息",-1)),t(Z,{label:"插件URL",colon:!1},{default:l(()=>[t(G,{value:o.url,"onUpdate:value":v[3]||(v[3]=h=>o.url=h),placeholder:"服务端点的URL"},null,8,["value"]),o.provider_id?(s(),p("div",va,"修改服务端点 URL 可能会影响使用当前 MCP的应用")):V("",!0)]),_:1}),t(Z,{label:"超时时间",colon:!1},{default:l(()=>[t(w,{value:o.request_timeout,"onUpdate:value":v[4]||(v[4]=h=>o.request_timeout=h),precision:0,style:{width:"100%"},placeholder:"请输入超时时间"},null,8,["value"])]),_:1}),t(Z,{label:"请求头",colon:!1},{default:l(()=>[v[10]||(v[10]=e("div",{class:"tip-info"},"发送到 MCP 服务器的额外 HTTP 请求头",-1)),e("div",_a,[v[9]||(v[9]=e("div",{class:"req-head-item"},[e("div",{class:"tit"},"请求头名称"),e("div",{class:"tit"},"请求头值")],-1)),(s(!0),p(q,null,Q(o.headers,(h,L)=>(s(),p("div",{key:L,class:"req-head-item"},[t(G,{value:h.key,"onUpdate:value":X=>h.key=X,placeholder:"请输入"},null,8,["value","onUpdate:value"]),t(G,{value:h.value,"onUpdate:value":X=>h.value=X,placeholder:"请输入"},null,8,["value","onUpdate:value"]),t(I($e),{onClick:X=>i(L)},null,8,["onClick"])]))),128)),t(A,{class:"add-btn",type:"dashed",icon:se(I(re)),onClick:k},{default:l(()=>[...v[8]||(v[8]=[S("添加请求头",-1)])]),_:1},8,["icon"])])]),_:1})]),_:1})]),_:1},8,["open","title","confirm-loading"])}}},$t=le(fa,[["__scopeId","data-v-7ab5a130"]]),ma={class:"_mcp-box"},ya={key:0,class:"loading-box"},ka={key:1,class:"list-box"},ba=["onClick"],ha={class:"base-info-box"},ga=["src"],$a={class:"info-box"},xa={class:"name zm-line1"},wa={key:0,class:"auth-tag"},Ca={key:1,class:"auth-tag fail"},Ta={class:"zm-line1"},Sa={class:"bottom"},Aa={class:"extra-box"},Oa={class:"extra-item"},Ra={class:"extra-item"},Pa={key:2,class:"empty-box"},Ua={__name:"third-mcp-box",emits:["listLoaded"],setup(D,{expose:F,emit:B}){const R=ut(),g=_(null),d=_(null),m=_(!0),r=_([]),x=B;Pe(()=>{O()});function O(){m.value=!0,o()}function n(){o(),g.value&&g.value.refresh()}function o(){$o().then(u=>{let b=(u==null?void 0:u.data)||[];b.forEach(c=>{c.tools=Ge(c.tools,[]),c.up_time_text=je(c.update_time)}),r.value=b,x("listLoaded",r.value.length)}).finally(()=>{m.value=!1})}function f(u){g.value.show(u)}function y(){d.value.show()}function k(u){d.value.show(u)}function i(){const u=R.resolve({path:"/mcp/index"}).href;window.open(u,"_blank")}function $(u){W.confirm({title:"确认删除该MCP插件？",content:"删除后，其他应用的位置都不可使用！确认删除？",okText:"确定",cancelText:"取消",onOk:()=>{xo({provider_id:u.id}).then(()=>{H.success("已删除"),o(),g.value&&g.value.hide()})}})}return F({update:n}),(u,b)=>{const c=Me,v=ve,E=Te,G=Ce,Z=Se;return s(),p("div",ma,[m.value?(s(),p("div",ya,[t(c)])):r.value.length?(s(),p("div",ka,[(s(!0),p(q,null,Q(r.value,(U,w)=>(s(),p("div",{onClick:A=>f(U),key:w,class:"app-item"},[e("div",ha,[e("img",{class:"avatar",src:U.avatar},null,8,ga),e("div",$a,[e("div",xa,M(U.name),1),e("div",null,[U.has_auth==1?(s(),p("div",wa,"已授权")):(s(),p("div",Ca,"未授权"))])])]),e("div",Ta,M(U.url),1),e("div",Sa,[e("div",Aa,[e("div",Oa,"可用工具："+M(U.tools.length),1),e("div",Ra,M(U.up_time_text)+"更新",1)]),t(Z,null,{overlay:l(()=>[t(G,null,{default:l(()=>[t(E,{onClick:K(A=>k(U),["stop"])},{default:l(()=>[...b[1]||(b[1]=[S("编辑",-1)])]),_:1},8,["onClick"]),t(E,{onClick:K(A=>$(U),["stop"])},{default:l(()=>[...b[2]||(b[2]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[t(v,{onClick:b[0]||(b[0]=K(()=>{},["stop"])),size:"small",icon:se(I(fe))},null,8,["icon"])]),_:2},1024)])],8,ba))),128))])):(s(),p("div",Pa,[b[4]||(b[4]=e("img",{src:Re},null,-1)),b[5]||(b[5]=e("div",{class:"title"},"暂未添加外部MCP插件",-1)),e("div",{class:"desc-box"},[e("div",{class:"link",onClick:i},"更多MCP？去MCP广场")]),t(v,{onClick:y,class:"btn",type:"primary"},{default:l(()=>[...b[3]||(b[3]=[S("立即添加",-1)])]),_:1})])),t(da,{ref_key:"mcpDetailRef",ref:g,onDel:$,onEdit:k,onAuth:o},null,512),t($t,{ref_key:"mcpStoreRef",ref:d,onOk:n},null,512)])}}},Ma=le(Ua,[["__scopeId","data-v-8236a2d9"]]),Ia={class:"_mcp_container"},La={class:"tabs-box"},Ea={__name:"mcp-panel",emits:["thirdMcpListEmpty"],setup(D,{expose:F,emit:B}){const R=dt(),g=_(null),d=_(Number(localStorage.getItem("zm:chatwiki:mcp:active")||1)),m=B;Pe(()=>{R.query.mcp>0&&r(Number(R.query.mcp))});function r(n){d.value=n,localStorage.setItem("zm:chatwiki:mcp:active",n)}function x(){d.value==2&&g.value.update()}function O(n){m("thirdMcpListEmpty",n===0)}return F({update:x}),(n,o)=>(s(),p("div",Ia,[e("div",La,[e("div",{class:be(["tab-item",{active:d.value==1}]),onClick:o[0]||(o[0]=f=>r(1))},"工作流MCP",2),e("div",{class:be(["tab-item",{active:d.value==2}]),onClick:o[1]||(o[1]=f=>r(2))},"外部MCP",2)]),d.value==1?(s(),z(Bl,{key:0,ref_key:"mcpRef",ref:g},null,512)):(s(),z(Ma,{key:1,ref_key:"mcpRef",ref:g,onListLoaded:O},null,512))]))}},Na=le(Ea,[["__scopeId","data-v-f8b38e8b"]]),Da={class:"avatar-uploader"},Ba=["src"],Ha=["src"],Ja={__name:"http-tool-avatar-input",props:{value:{type:String,default:""}},emits:["update:value"],setup(D,{emit:F}){const B=F,R=D,g=_([]),d=_(!1),m=_("");Nt(()=>R.value,i=>{m.value=i||""},{immediate:!0});const r=Ue.useInjectFormItemContext(),x=i=>{m.value=i,B("update:value",m.value),r.onFieldChange()},O=i=>i.type==="image/jpeg"||i.type==="image/png"?i.size/1024<1024*2?(g.value=[i],d.value=!0,Oo({file:i,category:"http_tool_avatar"}).then(b=>{var v;const c=((v=b==null?void 0:b.data)==null?void 0:v.link)||"";if(!c){H.error("上传失败"),d.value=!1;return}d.value=!1,x(c)}).catch(()=>{d.value=!1,H.error("上传失败")}),!1):(H.error("图片大小不能超过2M"),!1):(H.error("只支持JPG、PNG格式的图片"),!1),n=_(!1),o=_(""),f=_(""),y=()=>{n.value=!1,f.value=""},k=async i=>{o.value=i.url||m.value,n.value=!0,f.value=i.name||(o.value?o.value.substring(o.value.lastIndexOf("/")+1):"")};return(i,$)=>{const u=_t,b=W;return s(),p("div",Da,[m.value?(s(),p("img",{key:0,class:"avatar",src:m.value,alt:"avatar"},null,8,Ba)):V("",!0),t(u,{"file-list":g.value,"onUpdate:fileList":$[0]||($[0]=c=>g.value=c),"list-type":"picture-card","show-upload-list":!1,"before-upload":O,accept:".jpg,.png,.jpeg",onPreview:k},{default:l(()=>[e("div",null,[d.value?(s(),z(I(oo),{key:0})):(s(),z(I(re),{key:1})),$[1]||($[1]=e("div",{class:"ant-upload-text"},"上传照片",-1))])]),_:1},8,["file-list"]),t(b,{open:n.value,title:f.value,footer:null,onCancel:y},{default:l(()=>[e("img",{alt:"example",style:{width:"100%"},src:o.value},null,8,Ha)]),_:1},8,["open","title"])])}}},Fa=le(Ja,[["__scopeId","data-v-aca69679"]]),Ga={__name:"http-tool-store",emits:["ok"],setup(D,{expose:F,emit:B}){const R=B,g=_(!1),d=_(!1),m={id:"",avatar:"/upload/default/http-node.png",name:"",description:""},r=we({});function x(n=null){const o=JSON.parse(JSON.stringify(m)),f=n||{};o.id=f.id||"",o.name=f.name||"",o.description=f.description||"",f.avatar&&(o.avatar=f.avatar),Object.assign(r,o),g.value=!0}function O(){try{if(d.value=!0,r.name=String(r.name||"").trim(),r.description=String(r.description||"").trim(),!r.name)throw"请输入名称";let n={...r};const o=String(r.avatar||"");o&&(n.avatar=o),wo(n).then(()=>{R("ok",r),H.success("已保存"),g.value=!1}).finally(()=>{d.value=!1})}catch(n){d.value=!1,H.error(n)}}return F({show:x}),(n,o)=>{const f=De,y=Ue,k=ge,i=Be,$=W;return s(),z($,{open:g.value,"onUpdate:open":o[3]||(o[3]=u=>g.value=u),title:r.id?"编辑HTTP工具":"添加HTTP工具",width:"472px","confirm-loading":d.value,onOk:O},{default:l(()=>[t(y,{class:"form-box",labelAlign:"left"},{default:l(()=>[t(f,{label:"工具封面",colon:!1},{default:l(()=>[t(Fa,{value:r.avatar,"onUpdate:value":o[0]||(o[0]=u=>r.avatar=u)},null,8,["value"]),o[4]||(o[4]=e("div",{class:"form-item-tip"},"建议尺寸为100*100px，大小不超过2M",-1))]),_:1})]),_:1}),t(y,{class:"form-box",labelAlign:"left"},{default:l(()=>[t(f,{label:"名称",required:"",colon:!1},{default:l(()=>[t(k,{value:r.name,"onUpdate:value":o[1]||(o[1]=u=>r.name=u),placeholder:"请输入HTTP工具名称，最多20个字",maxlength:20},null,8,["value"])]),_:1}),t(f,{label:"描述",colon:!1},{default:l(()=>[t(i,{value:r.description,"onUpdate:value":o[2]||(o[2]=u=>r.description=u),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入描述",maxlength:60},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open","title","confirm-loading"])}}},ja=le(Ga,[["__scopeId","data-v-4afbba33"]]),za={class:"mt24"},qa={class:"add-btn-block"},Ka={class:"list-box"},Va={__name:"add-authentication-modal",emits:["ok"],setup(D,{expose:F,emit:B}){const R=_(!1),g=_([]),d=_([]),m=B,r=[{title:"Key",dataIndex:"auth_key"},{title:"Value",dataIndex:"auth_value"},{title:"Add To",dataIndex:"auth_value_addto"},{title:"备注",dataIndex:"auth_remark"},{title:"操作",dataIndex:"action",width:80}],x=we({selectedRowKeys:[]}),O=u=>{x.selectedRowKeys=u},n=(u=[])=>{R.value=!0,g.value=Array.isArray(u)?u:[],x.selectedRowKeys=[],y()},o=()=>{if(d.value.length>=100)return H.error("最多添加100条");d.value.push({auth_key:"",auth_value:"",auth_value_addto:"HEADERS",auth_remark:"",uni_key:Xe(16)})},f=u=>{d.value=d.value.filter(b=>b.uni_key!==u.uni_key)},y=()=>{Jt().then(u=>{let b=u.data||[];d.value=b.map(v=>({...v,uni_key:Xe(16)}));const c=new Set(g.value.map(v=>`${String(v.key)}::${String(v.add_to||v.addTo||v.auth_value_addto||"")}`));x.selectedRowKeys=d.value.filter(v=>c.has(`${String(v.auth_key)}::${String(v.auth_value_addto)}`)).map(v=>v.uni_key)})};function k(){let u=[],b=[];return d.value.forEach((c,v)=>{b.push({auth_key:c.auth_key,auth_value:c.auth_value,auth_value_addto:c.auth_value_addto,auth_remark:c.auth_remark}),(c.auth_key==""||c.auth_value=="")&&u.push(v+1)}),u.length>0?(H.error(`请填写第${u.join(",")}行参数`),!1):b.length==0?(H.error("请添加参数"),!1):b}const i=()=>{let u=k();if(u==!1)return;let b=[];x.selectedRowKeys.forEach(c=>{b.push(d.value.find(v=>v.uni_key==c))}),m("ok",b),lt({http_auth_config_list:JSON.stringify(u)}).then(()=>{H.success("保存成功")}).finally(()=>{x.selectedRowKeys=[],R.value=!1})},$=()=>{let u=k();u!=!1&&lt({http_auth_config_list:JSON.stringify(u)}).then(()=>{H.success("保存成功")})};return F({show:n}),(u,b)=>{const c=Ne,v=ve,E=ge,G=qe,Z=ze,U=ao,w=lo,A=W;return s(),p("div",null,[t(A,{open:R.value,"onUpdate:open":b[1]||(b[1]=a=>R.value=a),title:"鉴权参数",width:700},{footer:l(()=>[t(v,{onClick:b[0]||(b[0]=a=>R.value=!1)},{default:l(()=>[...b[7]||(b[7]=[S("取消",-1)])]),_:1}),t(v,{onClick:$},{default:l(()=>[...b[8]||(b[8]=[S("仅保存参数",-1)])]),_:1}),t(v,{type:"primary",onClick:i},{default:l(()=>[...b[9]||(b[9]=[S("保存并添加",-1)])]),_:1})]),default:l(()=>[e("div",za,[t(c,{class:"zm-alert-info",message:"选择的参数会自动填充到工具配置，鉴权参数在导出或上架模板时会自动清空",type:"info"})]),e("div",qa,[t(v,{type:"primary",icon:se(I(re)),ghost:"",onClick:o},{default:l(()=>[...b[2]||(b[2]=[S("添加参数",-1)])]),_:1},8,["icon"])]),e("div",Ka,[t(w,{"row-selection":{selectedRowKeys:x.selectedRowKeys,onChange:O},columns:r,pagination:!1,"data-source":d.value,"row-key":"uni_key",scroll:{y:550}},{bodyCell:l(({column:a,record:N})=>[a.dataIndex==="auth_key"?(s(),z(E,{key:0,value:N.auth_key,"onUpdate:value":h=>N.auth_key=h,placeholder:"请输入"},null,8,["value","onUpdate:value"])):V("",!0),a.dataIndex==="auth_value"?(s(),z(E,{key:1,value:N.auth_value,"onUpdate:value":h=>N.auth_value=h,placeholder:"请输入"},null,8,["value","onUpdate:value"])):V("",!0),a.dataIndex==="auth_value_addto"?(s(),z(Z,{key:2,value:N.auth_value_addto,"onUpdate:value":h=>N.auth_value_addto=h,style:{width:"100%"}},{default:l(()=>[t(G,{value:"HEADERS"},{default:l(()=>[...b[3]||(b[3]=[S("HEADERS",-1)])]),_:1}),t(G,{value:"PARAMS"},{default:l(()=>[...b[4]||(b[4]=[S("PARAMS",-1)])]),_:1}),t(G,{value:"BODY"},{default:l(()=>[...b[5]||(b[5]=[S("BODY",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"])):V("",!0),a.dataIndex==="auth_remark"?(s(),z(E,{key:3,maxLength:10,value:N.auth_remark,"onUpdate:value":h=>N.auth_remark=h,placeholder:"请输入"},null,8,["value","onUpdate:value"])):V("",!0),a.dataIndex==="action"?(s(),z(U,{key:4,title:"确认删除该字段?","ok-text":"确定","cancel-text":"取消",onConfirm:h=>f(N)},{default:l(()=>[...b[6]||(b[6]=[e("a",null,"删除",-1)])]),_:1},8,["onConfirm"])):V("",!0)]),_:1},8,["row-selection","data-source"])])]),_:1},8,["open"])])}}},Wa=le(Va,[["__scopeId","data-v-f396010f"]]),Ya={class:"gray-block",style:{background:"#FFF"}},Qa={class:"gray-block-title-left",style:{"margin-bottom":"16px"}},Za={class:"form-tips"},Xa={class:"gray-block"},es={class:"gray-block-title"},ts={class:"gray-block-title-left"},os={class:"flex-block-item"},ls={class:"array-form-box"},as={class:"flex-block-item"},ss=["onClick"],ns={class:"array-form-box"},is={class:"flex-block-item"},us=["onClick"],ds={key:0,class:"array-form-box mt12"},rs={key:0},cs={class:"flex-block-item"},ps=["onClick"],vs={class:"array-form-box timeout-form-item"},_s={class:"gray-block"},fs={class:"gray-block-title"},ms={class:"gray-block-title-left"},ys={class:"output-box"},ks={class:"flex-block-item",style:{gap:"12px"}},bs=["onClick"],hs={class:"gray-block"},gs={class:"gray-block-title"},$s={class:"gray-block-title-left"},xs={class:"output-box"},ws={class:"array-form-box"},Cs={class:"flex-block-item",style:{gap:"12px"}},Ts=["onClick"],Ss=["onClick"],As={key:0,class:"sub-field-box"},Os={__name:"add-http-tool-modal",props:{toolId:{type:Number,default:0}},emits:["ok"],setup(D,{expose:F,emit:B}){const R=B,g=D,d=_(!1),m=_(!1),r=_(null),x=_(null),O=_(null),n=_(null),o=we({title:"",description:"",node_name_en:"",method:"GET",url:"",auth:[],headers:[],params:[],body_type:0,body:[],body_raw:"",output:[{key:"",typ:"string",subs:[]}],timeout:30}),f=_(0),y=[{lable:"string",value:"string"},{lable:"number",value:"number"},{lable:"boole",value:"boole"},{lable:"float",value:"float"},{lable:"object",value:"object"},{lable:"array<string>",value:"array<string>"},{lable:"array<number>",value:"array<number>"},{lable:"array<boole>",value:"array<boole>"},{lable:"array<float>",value:"array<float>"},{lable:"array<object>",value:"array<object>"}],k={node_name_en:[{required:!0,message:"请输入名称"},{validator:(A,a)=>/^[a-zA-Z0-9_.-]+$/.test(a)?Promise.resolve():Promise.reject('只能输入英文数字和字符"_"、"."、"-"')}],title:[{required:!0,message:"请输入备注名"}],description:[{required:!0,message:"请输入描述"}]},i={auth:[{validator:(A,a)=>{const N=Array.isArray(a)?a:[];return N.length?N.every(L=>String(L.key||"").trim().length>0)?Promise.resolve():Promise.reject("请填写鉴权参数Key"):Promise.reject("请添加鉴权参数")}}]};function $(A=null){var a,N;if(A&&A.id)if(f.value=A.id,(a=A.node_params)!=null&&a.curl||A.data_raw){const h=A.http_tool_info||{};o.node_name_en=h.http_tool_node_name_en||A.node_name_en||"",o.title=h.http_tool_node_name||A.node_name||"",o.description=A.node_description||h.http_tool_node_description||"";let L=(N=A.node_params)==null?void 0:N.curl;if(!L&&A.data_raw)try{L=JSON.parse(A.data_raw||"{}").curl||{}}catch{L={}}o.method=L.method||"GET",o.url=String(L.rawurl||"").replace(/[`"]/g,"").trim(),o.headers=Array.isArray(L.headers)?JSON.parse(JSON.stringify(L.headers)):[],o.params=Array.isArray(L.params)?JSON.parse(JSON.stringify(L.params)):[],o.body_type=L.type??0,o.body=Array.isArray(L.body)?JSON.parse(JSON.stringify(L.body)):[],o.body_raw=L.body_raw||"",o.output=Array.isArray(L.output)?JSON.parse(JSON.stringify(L.output)):[{key:"",typ:"string",subs:[]}];const X=L.http_auth||[];o.auth=Array.isArray(X)?X.map(ie=>({key:ie.key,value:ie.value,add_to:ie.add_to||"HEADERS"})):[],o.timeout=Number(L.timeout??30)}else{o.node_name_en=A.node_name_en||"",o.title=A.robot_name||A.name||"",o.description=A.robot_intro||"";const h=A.raw||{};o.method=h.method||"GET",o.url=h.url||"",o.headers=Array.isArray(h.headers)?JSON.parse(JSON.stringify(h.headers)):[],o.params=Array.isArray(h.params)?JSON.parse(JSON.stringify(h.params)):[],o.body_type=h.body_type??0,o.body=Array.isArray(h.body)?JSON.parse(JSON.stringify(h.body)):[],o.body_raw=h.body_raw||"",o.output=Array.isArray(h.output)?JSON.parse(JSON.stringify(h.output)):[{key:"",typ:"string",subs:[]}],o.timeout=30}else f.value=0,Object.assign(o,{node_name_en:"",title:"",description:"",method:"GET",url:"",headers:[],params:[],body_type:0,body:[],body_raw:"",output:[{key:"",typ:"string",subs:[]}],timeout:30});d.value=!0}function u(A){const a=h=>typeof h=="string"?h:JSON.stringify(h);let N=!1;if(o.method=A.method||o.method,o.url=A.url||o.url,A.header&&typeof A.header=="object"){const h=Object.keys(A.header).map(L=>{const X=A.header[L];return String(L).toLowerCase()==="content-type"&&String(X).toLowerCase().includes("application/json")&&(N=!0),{key:L,value:a(X)}}).filter(L=>String(L.key).toLowerCase()!=="content-type");o.headers=h}if(A.params&&typeof A.params=="object"){const h=Object.keys(A.params).map(L=>({key:L,value:a(A.params[L])}));o.params=h}if(A.data&&typeof A.data=="object"){const h=Object.keys(A.data).map(L=>({key:L,value:a(A.data[L])}));o.body=h,o.body_raw=JSON.stringify(A.data)}else o.body=[],o.body_raw="";["POST","PUT","PATCH"].includes(o.method)?o.body_type=N?2:1:o.body_type=0,r.value&&r.value.hide()}function b(){r.value&&r.value.show()}function c(){x.value&&x.value.show(o.auth)}function v(A){const a=(A||[]).map(N=>({key:N.auth_key,value:N.auth_value,add_to:N.auth_value_addto}));o.auth=a,rt(()=>{var N;(N=n.value)==null||N.validate()})}function E(A){o.auth.splice(A,1)}function G(A){A.subs=[]}function Z(A){const a=o.output[A];Array.isArray(a.subs)||(a.subs=[]),a.subs.push({key:"",value:"",subs:[]})}async function U(){var ae,ce;try{await((ae=O.value)==null?void 0:ae.validate()),await((ce=n.value)==null?void 0:ce.validate())}catch{return}const A=Array.isArray(o.headers)?JSON.parse(JSON.stringify(o.headers)):[],a=Array.isArray(o.params)?JSON.parse(JSON.stringify(o.params)):[],N=Array.isArray(o.body)?JSON.parse(JSON.stringify(o.body)):[],h=String(o.body_raw||""),L=(Array.isArray(o.auth)?o.auth:[]).filter(ne=>String(ne.key||"").trim()).map(ne=>({key:String(ne.key||""),value:String(ne.value||""),add_to:String(ne.add_to||"HEADERS")})),X={curl:{method:o.method||"GET",rawurl:String(o.url||"").replace(/[`"]/g,"").trim(),headers:A,params:a,type:o.body_type??0,body:N,body_raw:h,output:Array.isArray(o.output)?JSON.parse(JSON.stringify(o.output)):[],http_auth:L,timeout:Number(o.timeout||30)}},ie={http_tool_id:g.toolId,node_name_en:o.node_name_en||"",node_name:o.title||"",node_description:o.description||"",node_remark:"",data_raw:JSON.stringify(X)},ue=()=>(m.value=!0,(f.value?at({id:f.value,...ie}):at(ie)).then(()=>{H.success("操作成功"),R("ok"),d.value=!1}).finally(()=>{m.value=!1}));f.value?W.confirm({title:"确认保存",content:"修改工具后使用到该工具的工作流可能无法正常运行。确认保存编辑么？",okText:"确认",cancelText:"取消",onOk(){return ue()}}):ue()}function w(A){gt(A.id).then(()=>{H.success("操作成功"),R("ok"),d.value=!1}).finally(()=>m.value=!1)}return F({show:$,del:w}),(A,a)=>{const N=st,h=ge,L=De,X=Be,ie=Ue,ue=ve,ae=qe,ce=ze,ne=io,ee=no,me=ht,de=He,ye=W;return s(),z(ye,{open:d.value,"onUpdate:open":a[13]||(a[13]=P=>d.value=P),width:"720px","confirm-loading":m.value,title:f.value?"编辑工具":"添加工具",onOk:U},{default:l(()=>[e("div",Ya,[e("div",Qa,[t(N,{name:"jibenpeizhi",size:"16"}),a[14]||(a[14]=S()),a[15]||(a[15]=e("span",null,"基本信息",-1))]),t(ie,{ref_key:"formRef",ref:O,model:o,rules:k,layout:"vertical"},{default:l(()=>[t(L,{name:"node_name_en",label:"名称",required:""},{default:l(()=>[t(h,{value:o.node_name_en,"onUpdate:value":a[0]||(a[0]=P=>o.node_name_en=P),placeholder:"请输入名称",maxlength:50},null,8,["value"]),a[16]||(a[16]=e("div",{class:"form-tips"},'只能输入英文数字和字符"_"、"."、"-"，最多不超过50个字符',-1))]),_:1}),t(L,{name:"title",label:"备注名",required:""},{default:l(()=>[t(h,{value:o.title,"onUpdate:value":a[1]||(a[1]=P=>o.title=P),placeholder:"请输入备注名",maxlength:20},null,8,["value"]),a[17]||(a[17]=e("div",{class:"form-tips"},"用于显示，不超过20个字",-1))]),_:1}),t(L,{name:"description",label:"描述",required:""},{default:l(()=>[t(X,{value:o.description,"onUpdate:value":a[2]||(a[2]=P=>o.description=P),"auto-size":{minRows:2,maxRows:4},placeholder:"请输入描述",maxlength:500},null,8,["value"]),e("div",Za,"还可以输入 "+M(500-(o.description?o.description.length:0))+" 个字",1)]),_:1})]),_:1},8,["model"])]),e("div",Xa,[e("div",es,[e("div",ts,[t(N,{name:"input",size:"16"}),a[18]||(a[18]=S()),a[19]||(a[19]=e("span",null,"输入",-1))]),t(ue,{ghost:"",type:"primary",size:"small",onClick:b},{default:l(()=>[t(I(so)),a[20]||(a[20]=S(" 导入cURL ",-1))]),_:1})]),t(ie,{class:"form-box",ref_key:"inputFormRef",ref:n,model:o,rules:i,layout:"vertical"},{default:l(()=>[t(L,{label:"请求地址",required:""},{default:l(()=>[e("div",os,[t(ce,{value:o.method,"onUpdate:value":a[3]||(a[3]=P=>o.method=P),style:{width:"120px"}},{default:l(()=>[t(ae,{value:"GET"},{default:l(()=>[...a[21]||(a[21]=[S("GET",-1)])]),_:1}),t(ae,{value:"POST"},{default:l(()=>[...a[22]||(a[22]=[S("POST",-1)])]),_:1}),t(ae,{value:"PUT"},{default:l(()=>[...a[23]||(a[23]=[S("PUT",-1)])]),_:1}),t(ae,{value:"DELETE"},{default:l(()=>[...a[24]||(a[24]=[S("DELETE",-1)])]),_:1}),t(ae,{value:"PATCH"},{default:l(()=>[...a[25]||(a[25]=[S("PATCH",-1)])]),_:1})]),_:1},8,["value"]),t(h,{class:"flex1",value:o.url,"onUpdate:value":a[4]||(a[4]=P=>o.url=P),placeholder:"请输入请求地址"},null,8,["value"])])]),_:1}),e("div",ls,[a[27]||(a[27]=e("div",{class:"form-item-label"},"HEADERS",-1)),(s(!0),p(q,null,Q(o.headers,(P,oe)=>(s(),p("div",{class:"form-item-list",key:oe},[e("div",as,[t(h,{style:{width:"120px"},value:P.key,"onUpdate:value":j=>P.key=j,placeholder:"Key"},null,8,["value","onUpdate:value"]),t(h,{class:"flex1",value:P.value,"onUpdate:value":j=>P.value=j,placeholder:"value"},null,8,["value","onUpdate:value"]),e("div",{class:"btn-hover-wrap",onClick:j=>o.headers.splice(oe,1)},[t(I($e))],8,ss)])]))),128)),t(ue,{block:"",type:"dashed",icon:se(I(re)),onClick:a[5]||(a[5]=P=>o.headers.push({key:"",value:""}))},{default:l(()=>[...a[26]||(a[26]=[S("添加参数",-1)])]),_:1},8,["icon"])]),e("div",ns,[a[29]||(a[29]=e("div",{class:"form-item-label"},"PARAMS",-1)),(s(!0),p(q,null,Q(o.params,(P,oe)=>(s(),p("div",{class:"form-item-list",key:oe},[e("div",is,[t(h,{style:{width:"120px"},value:P.key,"onUpdate:value":j=>P.key=j,placeholder:"Key"},null,8,["value","onUpdate:value"]),t(h,{class:"flex1",value:P.value,"onUpdate:value":j=>P.value=j,placeholder:"value"},null,8,["value","onUpdate:value"]),e("div",{class:"btn-hover-wrap",onClick:j=>o.params.splice(oe,1)},[t(I($e))],8,us)])]))),128)),t(ue,{block:"",type:"dashed",icon:se(I(re)),onClick:a[6]||(a[6]=P=>o.params.push({key:"",value:""}))},{default:l(()=>[...a[28]||(a[28]=[S("添加参数",-1)])]),_:1},8,["icon"])]),["POST","PUT","PATCH"].includes(o.method)?(s(),p("div",ds,[t(L,{label:"BODY",class:"body-form-item"},{default:l(()=>[t(ee,{value:o.body_type,"onUpdate:value":a[7]||(a[7]=P=>o.body_type=P)},{default:l(()=>[t(ne,{value:0},{default:l(()=>[...a[30]||(a[30]=[S("none",-1)])]),_:1}),t(ne,{value:1},{default:l(()=>[...a[31]||(a[31]=[S("x-www-form-urlencoded",-1)])]),_:1}),t(ne,{value:2},{default:l(()=>[...a[32]||(a[32]=[S("JSON",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o.body_type==1?(s(),p("div",rs,[(s(!0),p(q,null,Q(o.body,(P,oe)=>(s(),p("div",{class:"form-item-list",key:oe},[e("div",cs,[t(h,{style:{width:"120px"},value:P.key,"onUpdate:value":j=>P.key=j,placeholder:"Key"},null,8,["value","onUpdate:value"]),t(h,{class:"flex1",value:P.value,"onUpdate:value":j=>P.value=j,placeholder:"value"},null,8,["value","onUpdate:value"]),e("div",{class:"btn-hover-wrap",onClick:j=>o.body.splice(oe,1)},[t(I($e))],8,ps)])]))),128)),t(ue,{block:"",type:"dashed",icon:se(I(re)),onClick:a[8]||(a[8]=P=>o.body.push({key:"",value:""}))},{default:l(()=>[...a[33]||(a[33]=[S("添加参数",-1)])]),_:1},8,["icon"])])):V("",!0),o.body_type==2?(s(),z(L,{key:1},{default:l(()=>[t(X,{value:o.body_raw,"onUpdate:value":a[9]||(a[9]=P=>o.body_raw=P),"auto-size":{minRows:4,maxRows:10},placeholder:'{ "foo": "bar" }'},null,8,["value"])]),_:1})):V("",!0)])):V("",!0),e("div",vs,[t(L,{label:"超时时间(秒)"},{default:l(()=>[t(me,{value:o.timeout,"onUpdate:value":a[10]||(a[10]=P=>o.timeout=P),min:1,max:600,style:{width:"160px"}},null,8,["value"])]),_:1})])]),_:1},8,["model"])]),e("div",_s,[e("div",fs,[e("div",ms,[a[35]||(a[35]=e("span",null,"鉴权",-1)),t(de,null,{title:l(()=>[...a[34]||(a[34]=[S("鉴权参数：导出模板CSL文件，或者上架模板时，自动清空参数值",-1)])]),default:l(()=>[t(I(uo))]),_:1})])]),e("div",ys,[a[40]||(a[40]=e("div",{class:"output-block"},[e("div",{class:"output-item",style:{width:"33%"}},"Key"),e("div",{class:"output-item",style:{width:"33%"}},"Value"),e("div",{class:"output-item",style:{width:"33%"}},"Add To")],-1)),e("div",{class:"array-form-box",onMousedown:a[11]||(a[11]=K(()=>{},["stop"]))},[(s(!0),p(q,null,Q(o.auth,(P,oe)=>(s(),p("div",{class:"form-item-list",key:oe},[e("div",ks,[t(h,{style:{width:"33%"},value:P.key,"onUpdate:value":j=>P.key=j,placeholder:"请输入"},null,8,["value","onUpdate:value"]),t(h,{style:{width:"33%"},value:P.value,"onUpdate:value":j=>P.value=j,placeholder:"请输入"},null,8,["value","onUpdate:value"]),t(ce,{value:P.add_to,"onUpdate:value":j=>P.add_to=j,style:{width:"33%"}},{default:l(()=>[t(ae,{value:"HEADERS"},{default:l(()=>[...a[36]||(a[36]=[S("HEADERS",-1)])]),_:1}),t(ae,{value:"PARAMS"},{default:l(()=>[...a[37]||(a[37]=[S("PARAMS",-1)])]),_:1}),t(ae,{value:"BODY"},{default:l(()=>[...a[38]||(a[38]=[S("BODY",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"]),e("div",{class:"btn-hover-wrap",onClick:j=>E(oe)},[t(I($e))],8,bs)])]))),128)),t(ue,{onClick:c,icon:se(I(re)),block:"",type:"dashed"},{default:l(()=>[...a[39]||(a[39]=[S("添加参数",-1)])]),_:1},8,["icon"])],32)])]),e("div",hs,[e("div",gs,[e("div",$s,[t(N,{name:"output",size:"16"}),a[41]||(a[41]=S()),a[42]||(a[42]=e("span",null,"输出",-1))])]),e("div",xs,[a[44]||(a[44]=e("div",{class:"output-block"},[e("div",{class:"output-item",style:{width:"33%"}},"参数Key"),e("div",{class:"output-item",style:{width:"33%"}},"类型")],-1)),e("div",ws,[(s(!0),p(q,null,Q(o.output,(P,oe)=>(s(),p("div",{class:"form-item-list",key:oe},[e("div",Cs,[t(h,{style:{width:"214px"},value:P.key,"onUpdate:value":j=>P.key=j,placeholder:"请输入"},null,8,["value","onUpdate:value"]),t(ce,{onChange:j=>G(P),value:P.typ,"onUpdate:value":j=>P.typ=j,style:{width:"214px"},placeholder:"请选择"},{default:l(()=>[(s(),p(q,null,Q(y,j=>t(ae,{key:j.value,value:j.value},{default:l(()=>[S(M(j.value),1)]),_:2},1032,["value"])),64))]),_:1},8,["onChange","value","onUpdate:value"]),P.typ=="object"?(s(),p("div",{key:0,class:"btn-hover-wrap",onClick:j=>Z(oe)},[t(I(ro))],8,Ts)):V("",!0),e("div",{class:"btn-hover-wrap",onClick:j=>o.output.splice(oe,1)},[t(I($e))],8,Ss)]),P.subs&&P.subs.length>0?(s(),p("div",As,[t(Co,{data:P.subs,level:2,typOptions:y},null,8,["data"])])):V("",!0)]))),128)),t(ue,{block:"",type:"dashed",icon:se(I(re)),onClick:a[12]||(a[12]=P=>o.output.push({key:"",typ:"string",subs:[]}))},{default:l(()=>[...a[43]||(a[43]=[S("添加参数",-1)])]),_:1},8,["icon"])])])]),t(To,{ref_key:"parseCurlModalRef",ref:r,onParse:u},null,512),t(Wa,{ref_key:"addAuthModalRef",ref:x,onOk:v},null,512)]),_:1},8,["open","confirm-loading","title"])}}},Rs=le(Os,[["__scopeId","data-v-14d02ca5"]]),Ps={class:"_http_detail_box"},Us={class:"base-info-box"},Ms={class:"app-info"},Is=["src"],Ls={class:"info-box"},Es={class:"left-box"},Ns={class:"name"},Ds={class:"desc"},Bs={class:"right-box"},Hs={class:"app-data"},Js={class:"data-item"},Fs={class:"value"},Gs={class:"data-item"},js={class:"value"},zs={class:"tools-box"},qs={class:"head-box"},Ks={key:0,class:"tools-list"},Vs={class:"left"},Ws={class:"tit"},Ys={class:"key"},Qs={class:"params"},Zs={class:"params-box"},Xs={class:"field"},en={class:"name"},tn={class:"type"},on={key:0,class:"required"},ln={class:"desc"},an={key:1,class:"empty-box"},sn={__name:"http-tool-detail",props:{tool:{type:Object,default:()=>({})}},emits:["addTool","editTool","ok","editBase","deleteBase"],setup(D,{emit:F}){const B=D,R=F;function g(O){W.confirm({title:"删除确认",icon:se(Ie),content:"确定删除该工具吗？删除后不可恢复",okText:"删 除",cancelText:"取 消",onOk(){return gt({id:O.id}).then(()=>{R("ok")})}})}const d=Ee(()=>{var n;return String(((n=B.tool)==null?void 0:n.avatar)||"").trim().replace(/[`"']/g,"")||"/src/assets/img/workflow/node-service.svg"});function m(O){const n=Number(O||0);if(!n)return"—";const o=n>1e12?n:n*1e3;return co(o).format("YYYY-MM-DD HH:mm")}const r=Ee(()=>{var n;return(Array.isArray((n=B.tool)==null?void 0:n.nodes)?B.tool.nodes:[]).map(o=>{const f=o.http_tool_info||{},k=(o.node_params||{}).curl||{},i=Array.isArray(k.params)?k.params:[],$=Array.isArray(k.body)?k.body:[],b=[...i,...$].filter(c=>String((c==null?void 0:c.key)||"").trim().length>0).map(c=>({key:c.key,typ:c.value}));return{id:Number(o.id||0),displayTitle:f.http_tool_node_name||o.node_name||"",displayIdent:o.node_key||f.http_tool_node_key||"",displayDesc:o.node_description||f.http_tool_node_description||"",rawurl:k.rawurl||"",displayParams:b,originNode:o}})});function x(O,n){if(!O)return null;const f=document.createElement("canvas").getContext("2d");f.font='14px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif';const y=f.measureText(O).width,k=document.querySelector(`.titleRef_${n.create_time}`);k&&(n.title_width=k.offsetWidth);const i=(n==null?void 0:n.title_width)||1250;return y>i?O:null}return(O,n)=>{const o=ve,f=Te,y=Ce,k=Se,i=yt,$=He,u=Ke,b=bt;return s(),p("div",Ps,[e("div",Us,[e("div",Ms,[e("img",{class:"avatar",src:d.value},null,8,Is),e("div",Ls,[e("div",Es,[e("div",Ns,M(D.tool.name),1),e("div",Ds,M(D.tool.description),1)]),e("div",Bs,[t(o,{onClick:n[0]||(n[0]=c=>O.$emit("addTool",D.tool)),type:"primary",ghost:"",icon:se(I(re))},{default:l(()=>[...n[4]||(n[4]=[S("添加工具",-1)])]),_:1},8,["icon"]),t(k,null,{overlay:l(()=>[t(y,null,{default:l(()=>[t(f,{onClick:n[1]||(n[1]=c=>O.$emit("editBase",D.tool))},{default:l(()=>[...n[5]||(n[5]=[S("编辑",-1)])]),_:1}),t(f,{onClick:n[2]||(n[2]=c=>O.$emit("deleteBase",D.tool))},{default:l(()=>[...n[6]||(n[6]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1})]),_:1})]),default:l(()=>[t(o,{icon:se(I(fe))},null,8,["icon"])]),_:1})])])]),e("div",Hs,[e("div",Js,[n[7]||(n[7]=e("div",{class:"title"},"创建时间",-1)),e("div",Fs,M(m(D.tool.create_time)),1)]),t(i,{type:"vertical",style:{height:"24px"}}),e("div",Gs,[n[8]||(n[8]=e("div",{class:"title"},"更新时间",-1)),e("div",js,M(m(D.tool.update_time)),1)])])]),e("div",zs,[e("div",qs,[t(I(kt),{class:"icon"}),S(" 工具列表（"+M(r.value.length||0)+"） ",1)]),r.value.length?(s(),p("div",Ks,[(s(!0),p(q,null,Q(r.value,(c,v)=>(s(),p("div",{key:v,class:"tools-item"},[e("div",Vs,[e("div",Ws,M(c.displayTitle),1),e("div",Ys,"请求地址："+M(c.rawurl),1),t($,{title:x(c.displayDesc,c),placement:"top"},{default:l(()=>[e("div",{class:be(["desc",`titleRef_${c.id}`])},M(c.displayDesc),3)]),_:2},1032,["title"]),e("div",Qs,[(s(!0),p(q,null,Q((c.displayParams||[]).slice(0,5),E=>(s(),z(u,{key:E.key,bordered:!1},{default:l(()=>[S(M(E.key),1)]),_:2},1024))),128)),t(b,{placement:"right"},{content:l(()=>[e("div",Zs,[(s(!0),p(q,null,Q(c.displayParams||[],E=>(s(),p("div",{key:E.key,class:"param-item"},[e("div",Xs,[e("span",en,M(E.key),1),e("span",tn,M(E.typ),1),E.required?(s(),p("span",on,"必填")):V("",!0)]),e("div",ln,M(E.desc),1)]))),128))])]),default:l(()=>[n[9]||(n[9]=e("a",null,"参数",-1))]),_:2},1024)])]),t(k,null,{overlay:l(()=>[t(y,null,{default:l(()=>[t(f,{onClick:E=>O.$emit("editTool",c.originNode)},{default:l(()=>[...n[10]||(n[10]=[S("编辑",-1)])]),_:1},8,["onClick"]),t(f,{onClick:E=>g(c.originNode)},{default:l(()=>[...n[11]||(n[11]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[t(o,{size:"small",icon:se(I(fe))},null,8,["icon"])]),_:2},1024)]))),128))])):(s(),p("div",an,[n[13]||(n[13]=e("img",{src:Re},null,-1)),n[14]||(n[14]=e("div",{class:"title"},"暂未添加工具",-1)),t(o,{onClick:n[3]||(n[3]=c=>O.$emit("addTool",D.tool)),class:"btn",type:"primary"},{default:l(()=>[...n[12]||(n[12]=[S("立即添加",-1)])]),_:1})]))])])}}},nn=le(sn,[["__scopeId","data-v-31bf45db"]]),un={class:"_http_tool_box"},dn={key:0,class:"loading-box"},rn={key:0,class:"list-box"},cn=["onClick"],pn={class:"base-info-box"},vn=["src"],_n={class:"info-box"},fn={class:"name zm-line1"},mn={class:"bottom"},yn={class:"extra-box"},kn={key:0,class:"extra-item"},bn={key:1,class:"extra-item"},hn={class:"bottom-right"},gn={class:"update-time"},$n={key:1,class:"empty-box"},xn={class:"breadcrumb"},wn={class:"cur"},Cn={__name:"http-tool-box",setup(D,{expose:F}){const B=_(null),R=_(null),g=_(!0),d=_([]),m=_(null);Pe(()=>{r()});function r(){g.value=!0,So({page:1,size:9999,with_nodes:1}).then(u=>{var c;const b=(((c=u==null?void 0:u.data)==null?void 0:c.list)||[]).map(v=>({...v,up_time_text:je(v.update_time),avatar:i(v.avatar)}));if(d.value=b,m.value){const v=b.find(E=>E.id===m.value.id);v&&(m.value=v)}}).finally(()=>{g.value=!1})}function x(){B.value.show()}function O($){m.value=$}function n(){m.value=null}function o($){B.value.show({id:$.id,name:$.name,description:$.description,avatar:$.avatar})}function f($){R.value&&R.value.show()}function y($){R.value&&R.value.show($)}function k($){W.confirm({title:"删除确认",content:"确认删除该HTTP工具么？删除工具后使用到该工具的工作流可能无法正常运行。确认删除么？",okText:"确定",cancelText:"取消",onOk:()=>{Ao({id:$.id}).then(()=>{H.success("已删除"),m.value&&m.value.id===$.id&&(m.value=null),r()})}})}function i($){return String($||"").trim().replace(/[`"']/g,"")||"/src/assets/img/workflow/node-service.svg"}return F({showStore:x}),($,u)=>{var U;const b=Me,c=He,v=ve,E=Te,G=Ce,Z=Se;return s(),p("div",un,[g.value?(s(),p("div",dn,[t(b)])):(s(),p(q,{key:1},[m.value?(s(),p(q,{key:1},[e("div",xn,[e("a",{onClick:n},"HTTP工具"),u[7]||(u[7]=S()),u[8]||(u[8]=e("span",null,"/",-1)),u[9]||(u[9]=S()),e("span",wn,M(m.value.name),1)]),t(nn,{tool:m.value,onBack:n,onEditTool:y,onOk:r,onAddTool:f,onEditBase:o,onDeleteBase:k},null,8,["tool"])],64)):(s(),p(q,{key:0},[u[6]||(u[6]=e("div",{class:"list-head"},[e("div",{class:"title"},"HTTP工具")],-1)),d.value.length?(s(),p("div",rn,[(s(!0),p(q,null,Q(d.value,(w,A)=>(s(),p("div",{key:A,onClick:a=>O(w),class:"app-item"},[e("div",pn,[e("img",{class:"avatar",src:i(w.avatar)},null,8,vn),e("div",_n,[e("div",fn,M(w.name),1),t(c,{title:I(it)(w.description,w,14,2,10),placement:"top"},{default:l(()=>[e("div",{class:"description",ref_for:!0,ref:a=>I(nt)(a,w)},M(w.description),513)]),_:2},1032,["title"])])]),e("div",mn,[e("div",yn,[w.node_count>0?(s(),p("div",kn,M(w.node_count)+"个可用工具",1)):(s(),p("div",bn,"暂无可用的工具"))]),e("div",hn,[e("div",gn,M(w.up_time_text)+"更新",1),t(Z,null,{overlay:l(()=>[t(G,null,{default:l(()=>[t(E,{onClick:K(a=>o(w),["stop"])},{default:l(()=>[...u[1]||(u[1]=[S("编辑",-1)])]),_:1},8,["onClick"]),t(E,{onClick:K(a=>k(w),["stop"])},{default:l(()=>[...u[2]||(u[2]=[e("span",{class:"cFB363F"},"删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[t(v,{onClick:u[0]||(u[0]=K(()=>{},["stop"])),size:"small",icon:se(I(fe))},null,8,["icon"])]),_:2},1024)])])],8,cn))),128))])):(s(),p("div",$n,[u[4]||(u[4]=e("img",{src:Re},null,-1)),u[5]||(u[5]=e("div",{class:"title"},"暂未添加HTTP工具",-1)),t(v,{onClick:x,class:"btn",type:"primary"},{default:l(()=>[...u[3]||(u[3]=[S("立即添加",-1)])]),_:1})]))],64)),t(ja,{ref_key:"storeRef",ref:B,onOk:r},null,512),t(Rs,{toolId:((U=m.value)==null?void 0:U.id)||0,ref_key:"addToolRef",ref:R,onOk:r},null,8,["toolId"])],64))])}}},Tn=le(Cn,[["__scopeId","data-v-bd55db19"]]),Sn={class:"main"},An={key:0,class:"item"},On={class:"list"},Rn={class:"warning"},Pn={key:1,class:"item"},Un={class:"list"},Mn={class:"warning"},In={__name:"workflow-export-modal",emits:["ok"],setup(D,{expose:F,emit:B}){const R=B,g=_(!1),d=_({}),m=_(!1),r=_(!1),x=_([]),O=_([]);function n(y={}){o(),d.value=y,Ft({id:y==null?void 0:y.id}).then(k=>{let i=(k==null?void 0:k.data)||{};x.value=(i==null?void 0:i.databaseList)||[],O.value=(i==null?void 0:i.library)||[],!O.value.length&&!x.value.length?R("ok",d.value):g.value=!0})}function o(){O.value=[],x.value=[],m.value=!1,r.value=!1}function f(){let y={};m.value&&O.value.length&&(y.library_id=O.value.map(k=>k.id).toString()),r.value&&x.value.length&&(y.form_id=x.value.map(k=>k.form_id).toString()),g.value=!1,R("ok",d.value,y)}return F({handle:n}),(y,k)=>{const i=Ne,$=ft,u=Ke,b=W;return s(),z(b,{open:g.value,"onUpdate:open":k[2]||(k[2]=c=>g.value=c),title:"导出知识库和数据库确认",width:"746px",onOk:f},{default:l(()=>[t(i,{class:"zm-alert-info mt24",type:"info",message:"导出的工作流导入使用后，会自动创建引用的知识库和数据库，请确认是否同步导出知识库内容和数据库内容"}),e("div",Sn,[O.value.length?(s(),p("div",An,[t($,{checked:m.value,"onUpdate:checked":k[0]||(k[0]=c=>m.value=c)},{default:l(()=>[...k[3]||(k[3]=[S("知识库内容",-1)])]),_:1},8,["checked"]),e("div",On,[(s(!0),p(q,null,Q(O.value,c=>(s(),z(u,{key:c.id},{default:l(()=>[S(M(c.library_name),1)]),_:2},1024))),128))]),tt(e("div",Rn,"导出的工作流时会导出引用的知识库，勾选后会同时导出知识库内容，请注意企业内容使用，保证数据安全",512),[[ot,m.value]])])):V("",!0),x.value.length?(s(),p("div",Pn,[t($,{checked:r.value,"onUpdate:checked":k[1]||(k[1]=c=>r.value=c)},{default:l(()=>[...k[4]||(k[4]=[S("数据库内容",-1)])]),_:1},8,["checked"]),e("div",Un,[(s(!0),p(q,null,Q(x.value,c=>(s(),z(u,{key:c.form_id},{default:l(()=>[S(M(c.form_name),1)]),_:2},1024))),128))]),tt(e("div",Mn,"导出的工作流时会导出引用的数据库，勾选后会同时导出数据库内容，请注意企业内容使用，保证数据安全",512),[[ot,r.value]])])):V("",!0)])]),_:1},8,["open"])}}},Ln=le(In,[["__scopeId","data-v-d875ebee"]]),En={class:"robot-page"},Nn={class:"list-toolbar mt16"},Dn={class:"toolbar-box"},Bn={class:"toolbar-box",style:{"text-align":"right"}},Hn={class:"create-action"},Jn=["src"],Fn={class:"create-action"},Gn=["src"],jn={class:"create-action"},zn=["src"],qn={class:"create-action"},Kn=["src"],Vn={class:"create-action"},Wn=["src"],Yn={key:1,class:"desc-box"},Qn={key:2,class:"list-group-box"},Zn={key:0,class:"group-head-box"},Xn={class:"head-title"},ei={class:"search-box"},ti={class:"classify-box"},oi=["onClick"],li={class:"classify-title"},ai={class:"right-content"},si={key:0,class:"btn-box"},ni={class:"hover-btn-wrap"},ii=["onClick"],ui=["onClick"],di={class:"robot-scroll-box"},ri={key:0,class:"empty-box"},ci=["onClick"],pi={class:"list-item"},vi={class:"robot-info"},_i=["src"],fi={class:"robot-info-content"},mi={class:"robot-name"},yi={class:"robot-type-tag"},ki=["onClick"],bi=["onClick"],hi=["onClick"],gi=["onClick"],$i=["onClick"],xi=["onClick"],wi={__name:"robot-list",setup(D){const F=ut(),B=dt(),R=_([{title:"全部 (0)",value:"2"},{title:"聊天机器人 (0)",value:"0"},{title:"工作流 (0)",value:"1"},{title:"MCP插件",value:"3"},{title:"HTTP工具",value:"6"}]),g=Pt();let{role_permission:d,role_type:m}=g;const r=Ee(()=>m==1||d.includes("RobotCreate")),x=_(null),O=_(null),n=_("2"),o=_(null),f=_(""),y=_([]),k=_([]),i=_(!1);let $="robot-list-hide-group-key";const u=_(localStorage.getItem($)==1),b=()=>{u.value=!u.value,localStorage.setItem($,u.value?1:0)},c=()=>{G(),Ve()},v=()=>{let T=y.value;f.value!=""&&(T=T.filter(C=>C.group_id==f.value)),n.value!=2&&(T=T.filter(C=>C.application_type==n.value)),k.value=T};function E(){const T=F.resolve({path:"/mcp/index"}).href;window.open(T,"_blank")}const G=()=>{pt().then(T=>{let C=0,te=0,Y=0;T.data.forEach(_e=>{_e.application_type==0?te++:Y++,C++}),R.value=[{title:"全部 ("+C+")",value:"2"},{title:"聊天机器人 ("+te+")",value:"0"},{title:"工作流 ("+Y+")",value:"1"},{title:"MCP插件",value:"3"},{title:"HTTP工具",value:"6"}],y.value=T.data,v()}).catch(()=>{})},Z=_(null),U=_(null),w=_(null),A=T=>{Z.value.open(T),Z.value.setGroupId(f.value)},a=()=>{w.value.show()},N=()=>{U.value.open()},h=T=>{G(),L(T)},L=({id:T,robot_key:C,application_type:te})=>{localStorage.setItem("last_local_robot_id",T),te==0?window.open(`/#/robot/config/basic-config?id=${T}&robot_key=${C}`,"_blank","noopener"):window.open(`/#/robot/config/workflow?id=${T}&robot_key=${C}`,"_blank","noopener")},X=()=>{n.value="6",rt(()=>{const T=typeof o.value<"u"?o.value:null;T&&T.showStore&&T.showStore()})},ie=T=>{if(Lt(T.id)!=4)return H.error("您没有删除机器人的权限");let te=3,Y=W.confirm({title:`删除机器人${T.robot_name}`,icon:t(Ie),content:"您确定要删除此机器人吗？",okText:te+" 确 定",okType:"danger",cancelText:"取 消",okButtonProps:{disabled:!0},onOk(){ue(T)},onCancel(){}}),_e=setInterval(()=>{te==1?(Y.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(_e),_e=void 0):(te-=1,Y.update({okText:te+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},ue=({id:T})=>{zt({id:T}).then(()=>{H.success("删除成功"),G()})},ae=T=>{let C=3,te=W.confirm({title:`复制机器人${T.robot_name}`,icon:t(Ie),content:"您确定要复制此机器人吗？",okText:C+" 确 定",okType:"danger",cancelText:"取 消",okButtonProps:{disabled:!0},onOk(){ce(T)},onCancel(){}}),Y=setInterval(()=>{C==1?(te.update({okText:"确 定",okButtonProps:{disabled:!1}}),clearInterval(Y),Y=void 0):(C-=1,te.update({okText:C+" 确 定",okButtonProps:{disabled:!0}}))},1e3)},ce=({id:T})=>{qt({id:T}).then(()=>{H.success("复制成功"),G()})},ne=T=>{x.value.handle(T)},ee=(T,C=null)=>{const{openUrlWithToken:te}=Bo();C=C||{},C.id=T.id,`${et(C)}`,te(`/manage/robotExport?${et(C)}`)},me=T=>{window.open(`#/robot/test?robot_key=${T.robot_key}&id=${T.id}`)},de=T=>{window.open(`#/robot/config/session-record?robot_key=${T.robot_key}&id=${T.id}`)},ye=T=>{window.open(`#/robot/config/statistical_analysis?robot_key=${T.robot_key}&id=${T.id}`)},P=_(""),oe=_([]),j=Ee(()=>oe.value.filter(T=>T.group_name.includes(P.value))),Ve=()=>{ct({application_type:n.value==2?null:n.value}).then(T=>{let C=T.data||[],te=0;C.forEach(Y=>{te+=+Y.total}),oe.value=[{group_name:"全部",total:te,id:""},...C]})},xt=T=>{f.value=T.id,G()},We=_(null),Ye=T=>{We.value.show({...T})},Qe=_(null),wt=T=>{Qe.value.show({...T})},Ct=T=>{W.confirm({title:`确认删除分组${T.group_name}`,icon:t(Ie),content:"",okText:"确认",okType:"danger",cancelText:"取消",onOk(){Gt({id:T.id}).then(()=>{H.success("删除成功"),Ve(),f.value==T.id&&(f.value="",G())})}})},Tt=()=>{O.value&&O.value.update()},St=T=>{if(T.newIndex===T.oldIndex)return;i.value=!0;let C={move_robot_id:k.value[T.newIndex].id,to_robot_id:0};T.newIndex>0&&(C.to_robot_id=k.value[T.newIndex-1].id),jt(C).then(te=>{H.success("操作完成")}).finally(()=>{i.value=!1})};return Pe(()=>{n.value=B.query.active||"2",c()}),(T,C)=>{const te=ve,Y=Te,_e=Ce,Je=Se,ke=He,At=ge,Ze=Et,Ot=po,Ae=st;return s(),p("div",En,[t(mo,{class:"mt16",title:"使用说明"},{default:l(()=>[...C[12]||(C[12]=[e("div",null,[e("p",null," 1、应用包括两种类型：聊天机器人、工作流。聊天机器人适合新手用户，关联知识库后只需简单配置，即可创建一个基于私有知识库的问答机器人。工作流适合高级用户，利用系统预制节点自定义任务流程，适合解决复杂任务。 "),e("p",null,"2、发现模块也提供了丰富模版，可以根据需要选择适合模版快速创建应用。")],-1)])]),_:1}),e("div",Nn,[e("div",Dn,[t(yo,{tabs:R.value,onChange:c,value:n.value,"onUpdate:value":C[0]||(C[0]=J=>n.value=J)},null,8,["tabs","value"])]),e("div",Bn,[r.value?(s(),z(Je,{key:0},{overlay:l(()=>[t(_e,null,{default:l(()=>[t(Y,{onClick:C[2]||(C[2]=K(J=>A(0),["prevent"]))},{default:l(()=>[e("span",Hn,[e("img",{class:"icon",src:I(Ut),alt:""},null,8,Jn),C[14]||(C[14]=e("span",null,"聊天机器人",-1))])]),_:1}),t(Y,{onClick:C[3]||(C[3]=K(J=>A(1),["prevent"]))},{default:l(()=>[e("span",Fn,[e("img",{class:"icon",src:I(Mt),alt:""},null,8,Gn),C[15]||(C[15]=e("span",null,"工作流",-1))])]),_:1}),t(Y,{onClick:K(a,["prevent"])},{default:l(()=>[e("span",jn,[e("img",{class:"icon",src:I(Le),alt:""},null,8,zn),C[16]||(C[16]=e("span",null,"外部MCP",-1))])]),_:1}),t(Y,{onClick:K(X,["prevent"])},{default:l(()=>[e("span",qn,[e("img",{class:"icon",src:I(Le),alt:""},null,8,Kn),C[17]||(C[17]=e("span",null,"HTTP工具",-1))])]),_:1}),t(Y,{onClick:N},{default:l(()=>[e("span",Vn,[e("img",{class:"icon",src:I(It),alt:""},null,8,Wn),C[18]||(C[18]=e("span",null,"导入csl创建",-1))])]),_:1})]),_:1})]),default:l(()=>[t(te,{type:"primary",onClick:C[1]||(C[1]=K(()=>{},["prevent"]))},{icon:l(()=>[t(I(re))]),default:l(()=>[C[13]||(C[13]=S(" 创建应用 ",-1))]),_:1})]),_:1})):V("",!0),r.value&&n.value=="3"?(s(),p("div",Yn,[e("div",{class:"link",onClick:E},"更多MCP？去MCP广场")])):V("",!0)])]),n.value==3?(s(),z(Na,{key:0,ref_key:"mcpPanelRef",ref:O},null,512)):n.value==6?(s(),z(Tn,{key:1,ref_key:"httpToolBoxRef",ref:o},null,512)):(s(),p("div",Qn,[e("div",{class:be(["group-list-box",{"hide-group":u.value}])},[t(Ze,{style:{"padding-right":"16px"}},{default:l(()=>[u.value?V("",!0):(s(),p("div",Zn,[e("div",Xn,[C[19]||(C[19]=e("div",null,"机器人分组",-1)),t(ke,{title:"新建分组"},{default:l(()=>[e("div",{class:"hover-btn-wrap",onClick:C[4]||(C[4]=J=>Ye({}))},[t(I(re))])]),_:1})]),e("div",ei,[t(At,{value:P.value,"onUpdate:value":C[6]||(C[6]=J=>P.value=J),allowClear:"",placeholder:"搜索分组",style:{width:"100%"}},{suffix:l(()=>[t(I(vo),{onClick:C[5]||(C[5]=K(()=>{},["stop"]))})]),_:1},8,["value"])])])),e("div",ti,[(s(!0),p(q,null,Q(j.value,J=>(s(),p("div",{class:be(["classify-item",{active:J.id==f.value}]),onClick:Oe=>xt(J),key:J.id},[e("div",li,M(J.group_name),1),e("div",ai,[e("div",{class:be(["num",{"num-block":J.id<=0}])},M(J.total),3),J.id>0?(s(),p("div",si,[t(Je,{placement:"bottomRight"},{overlay:l(()=>[t(_e,null,{default:l(()=>[t(Y,null,{default:l(()=>[e("div",{onClick:K(Oe=>Ye(J),["stop"])},"重命名",8,ii)]),_:2},1024),t(Y,null,{default:l(()=>[e("div",{onClick:K(Oe=>Ct(J),["stop"])},"删 除",8,ui)]),_:2},1024)]),_:2},1024)]),default:l(()=>[e("div",ni,[t(I(fe))])]),_:2},1024)])):V("",!0)])],10,oi))),128))])]),_:1}),t(ke,{placement:"right",title:u.value?"展开分组":"收起分组"},{default:l(()=>[e("div",{class:"hide-group-box",onClick:b},[u.value?(s(),z(I(fo),{key:1})):(s(),z(I(_o),{key:0}))])]),_:1},8,["title"])],2),e("div",di,[k.value.length==0?(s(),p("div",ri,[t(Ot)])):V("",!0),t(Ze,{style:{"padding-right":"16px"}},{default:l(()=>[t(I(Dt),{modelValue:k.value,"onUpdate:modelValue":C[10]||(C[10]=J=>k.value=J),handle:".drag-btn","item-key":"id",disabled:i.value,class:"list-box",onEnd:St},{item:l(({element:J,index:Oe})=>[(s(),p("div",{class:"list-item-wrapper",key:J.id,onClick:pe=>L(J)},[e("div",pi,[e("div",vi,[e("img",{class:"robot-avatar",src:J.robot_avatar,alt:""},null,8,_i),e("div",fi,[e("div",mi,M(J.robot_name),1),e("div",yi,M(J.application_type==0?"聊天机器人":"工作流"),1)])]),t(ke,{title:I(it)(J.robot_intro,J,14,2,10),placement:"top"},{default:l(()=>[e("div",{class:"robot-desc",ref:pe=>I(nt)(pe,J)},M(J.robot_intro),513)]),_:2},1032,["title"]),e("div",{class:"robot-action",onClick:C[9]||(C[9]=K(()=>{},["stop"]))},[t(ke,{title:"长按拖动排序"},{default:l(()=>[e("div",{class:"robot-action-item drag-btn",onClick:C[7]||(C[7]=K(()=>{},["stop"]))},[t(Ae,{class:"action-icon",name:"dragv2"})])]),_:1}),t(ke,{title:"聊天测试"},{default:l(()=>[e("div",{class:"robot-action-item",onClick:K(pe=>me(J),["stop"])},[t(Ae,{class:"action-icon",name:"chat"})],8,ki)]),_:2},1024),t(ke,{title:"会话记录"},{default:l(()=>[e("div",{class:"robot-action-item",onClick:K(pe=>de(J),["stop"])},[t(Ae,{class:"action-icon",name:"session"})],8,bi)]),_:2},1024),t(ke,{title:"统计分析"},{default:l(()=>[e("div",{class:"robot-action-item",onClick:K(pe=>ye(J),["stop"])},[t(Ae,{class:"action-icon",name:"analysis"})],8,hi)]),_:2},1024),t(Je,null,{overlay:l(()=>[t(_e,null,{default:l(()=>[t(Y,null,{default:l(()=>[e("a",{class:"delete-text-color",href:"javascript:;",onClick:pe=>ie(J)},"删 除",8,gi)]),_:2},1024),t(Y,null,{default:l(()=>[e("div",{onClick:K(pe=>wt(J),["stop"])},"修改分组",8,$i)]),_:2},1024),t(Y,null,{default:l(()=>[e("a",{class:"copy-text-color",href:"javascript:;",onClick:pe=>ae(J)},"复 制",8,xi)]),_:2},1024),t(Y,{onClick:pe=>ne(J)},{default:l(()=>[...C[20]||(C[20]=[e("span",null,"导出为csl",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[e("div",{class:"robot-action-item",onClick:C[8]||(C[8]=K(()=>{},["stop"]))},[t(Ae,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,ci))]),_:1},8,["modelValue","disabled"])]),_:1})])])),t(Kt,{ref_key:"addRobotAlertRef",ref:Z,onOk:c},null,512),t(Vt,{ref_key:"addGroupRef",ref:We,onOk:c},null,512),t(Do,{ref_key:"editGroupRef",ref:Qe,onOk:c},null,512),t(Io,{ref_key:"importCslAlertRef",ref:U,onOk:h},null,512),t($t,{ref_key:"thirdMcpRef",ref:w,onOk:Tt},null,512),t(Ln,{ref_key:"exportRef",ref:x,onOk:C[11]||(C[11]=(J,Oe)=>ee(J,Oe))},null,512)])}}},Vi=le(wi,[["__scopeId","data-v-0f8c5a81"]]);export{Vi as default};
