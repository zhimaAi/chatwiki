import{d as u,w as N,N as d,O as f,j as p,X as i,U as P,a0 as F,F as I,a1 as B,u as b,a5 as J}from"./vue-chunks-BRsu9_To.js";import{u as h}from"./index-CRufPZma.js";import{b as V,dd as z,k as s}from"../../index-CRscgXfx.js";import"./index-CuQqX42V.js";import{I as A}from"./Input-tyEnRv5y.js";import{E as G}from"./Password-Bmz-BBqy.js";import{D as R,U as $}from"./index-DlRXMuhZ.js";const q={class:"upload-box"},S={class:"mask-box"},X=["src"],y=3,H={__name:"index",props:{value:{type:[String,Array],default:""}},emits:["update:value"],setup(k,{emit:D}){const m=D,g=u([]),t=u([]),v=u(""),U=k;N(()=>U.value,e=>{t.value=e},{immediate:!0});const w=e=>{if(!(e.type==="image/jpeg"||e.type==="image/png"))return s.error("只支持JPG、PNG格式的图片"),!1;const o=e.size/1024<1024*2;return t.value.length>=y?s.error("最多上传三张图片"):o?(h({category:"library_image",file:e}).then(l=>{t.value.push(l.data.link),m("update:value",t.value)}),!1):(s.error("图片大小不能超过2M"),!1)},x=e=>{z({images:[e]})},M=e=>{t.value.splice(e,1)};let n=!1;const C=async e=>{if(t.value.length>=y)return s.error("最多上传三张图片");if(!(e.clipboardData&&e.clipboardData.items)){s.error("当前浏览器不支持粘贴上传操作！");return}if(!n)try{if(e.clipboardData||e.originalEvent||window.clipboardData){var r=e.clipboardData||e.originalEvent.clipboardData||window.clipboardData,o=r.items;let l=null;for(let a=0;a<o.length;a++)if(o[a].type.indexOf("image")!==-1){l=o[a].getAsFile();break}v.value="",l?(e.preventDefault(),n=!0,h({category:"library_image",file:l}).then(a=>{n=!1,t.value.push(a.data.link),m("update:value",t.value)})):(error("请粘贴正确图片"),n=!1,v.value="")}}catch{n=!1,s.error("上传失败")}},c=u(null),L=()=>{c.value.focus()},j=()=>{c.value.blur()};function E(e){}return(e,r)=>{const o=A,l=$;return f(),d("div",q,[p(o,{class:"hidden-input",ref_key:"inputRef",ref:c,onPaste:C},null,512),i("div",{onMouseenter:L,onMouseleave:j},[p(l,{fileList:g.value,"onUpdate:fileList":r[1]||(r[1]=a=>g.value=a),name:"file",multiple:!1,"list-type":"picture","show-upload-list":!1,accept:".jpg,.png,.jpeg","before-upload":w,onDrop:E},{default:P(()=>[i("div",{class:"img-list-box",onClick:r[0]||(r[0]=F(()=>{},["stop"]))},[(f(!0),d(I,null,B(t.value,(a,_)=>(f(),d("div",{class:"img-item",key:_},[i("div",S,[p(b(G),{onClick:O=>x(a)},null,8,["onClick"]),p(b(R),{onClick:O=>M(_)},null,8,["onClick"])]),i("img",{src:a,alt:""},null,8,X)]))),128))]),i("p",{class:J(["upload-text",{"center-content":t.value.length==0}])}," 支持点击空白处、拖拽、粘贴图片，上传图片不得超过2M，仅支持png、jpg、jpeg格式 ",2)]),_:1},8,["fileList"])],32)])}}},ae=V(H,[["__scopeId","data-v-61b33e35"]]);export{ae as U};
