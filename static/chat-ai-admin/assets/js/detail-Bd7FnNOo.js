import{b as V,d as N}from"../../index-OnalErht.js";import{f as d,a1 as p,_ as n,a2 as b,k as i,o as O,ab as T,Y as x,a5 as t,u as g,aa as U,a7 as o,F,G as l,ae as $}from"./vue-chunks-Ci-XTWEs.js";import{y as j,M as q,d as D,ax as z,B as E,x as G,ay as K}from"./ui-antd-BgeWxFcI.js";import{U as P}from"./update-modal-Cf1DDPo7.js";import{L as S}from"./loading-box-DcpHkn5J.js";import{g as A}from"./index-ekVIF3nC.js";import"./utils-ChQO-_r6.js";const J={__name:"version-modal",setup(L,{expose:w}){const u=d(!1),r=d([]),c=[{title:"版本",dataIndex:"version",width:100},{title:"更新时间",dataIndex:"update_time_text",width:160},{title:"发布者",dataIndex:"author",width:100}];function f(v=[]){r.value=v,u.value=!0}return w({show:f}),(v,s)=>{const h=j,M=q;return n(),p(M,{title:"版本历史",open:u.value,"onUpdate:open":s[0]||(s[0]=y=>u.value=y),width:"500px",footer:null},{default:b(()=>[i(h,{columns:c,"data-source":r.value},null,8,["data-source"])]),_:1},8,["open"])}}},Q={class:"_container _plugin-detail-cont"},W={class:"header"},X={key:1,class:"content"},Z={class:"base-info"},tt={class:"top"},et=["src"],st={class:"info"},ot={class:"left"},at={class:"name zm-line1"},nt={class:"source"},lt={class:"right"},it={class:"desc"},dt={class:"action-box"},_t={class:"left"},ut={class:"detail-info"},rt={class:"left"},ct={key:0,class:"main-block"},vt={class:"text-cont"},mt={class:"main-block"},pt=["innerHTML"],ft={class:"right"},ht={class:"main-block"},yt={class:"version-info"},kt={class:"text-cont"},xt={class:"main-block"},gt={class:"text-cont"},bt={__name:"detail",setup(L){const w=U(),u=T(),r=d(!0),c=d(!0),f=d(null),v=d(null),s=d({});O(()=>{var a;f.value=(a=u.query)==null?void 0:a.name,h()});function h(){c.value=!0,A({name:f.value}).then(a=>{var _,k;let e=(a==null?void 0:a.data)||{};s.value=e.remote,s.value.local=e.local,s.value.has_update=((_=e.local)==null?void 0:_.version)!=((k=e.remote)==null?void 0:k.latest_version),s.value.latest_version_history.map(m=>{m.update_time_text=D.unix(m.update_time).format("YYYY-MM-DD HH:mm"),m.author=s.value.author})}).finally(()=>{c.value=!1})}function M(){v.value.show(s.value.latest_version_history||[])}function y(){let{latest_version_detail:a,local:e}=s.value;r.value.show(s.value,a,e)}return(a,e)=>{var Y,B,H,R,C,I;const _=E,k=N,m=G;return n(),x("div",Q,[t("div",W,[i(g(z),{onClick:e[0]||(e[0]=wt=>g(w).back()),class:"back-icon"}),e[1]||(e[1]=t("span",{class:"title"},"插件详情",-1))]),c.value?(n(),p(S,{key:0})):(n(),x("div",X,[t("div",Z,[t("div",tt,[t("img",{class:"avatar",src:s.value.icon},null,8,et),t("div",st,[t("div",ot,[t("div",at,o(s.value.title)+" v"+o(s.value.latest_version),1),t("div",nt,o(s.value.author),1)]),t("div",lt,[s.value.local?(n(),x(F,{key:0},[s.value.has_update?(n(),p(_,{key:0,type:"primary",onClick:y},{default:b(()=>e[2]||(e[2]=[l("更 新")])),_:1,__:[2]})):(n(),p(_,{key:1},{default:b(()=>e[3]||(e[3]=[l("已安装")])),_:1,__:[3]}))],64)):(n(),p(_,{key:1,type:"primary",onClick:y},{default:b(()=>e[4]||(e[4]=[l("安 装")])),_:1,__:[4]}))])])]),t("div",it,o(s.value.description),1),t("div",dt,[t("div",_t,[i(k,{name:"download"}),l(" "+o(s.value.installed_count||0),1)]),e[5]||(e[5]=t("div",{class:"right"},null,-1))])]),t("div",ut,[t("div",rt,[s.value.overview?(n(),x("div",ct,[e[6]||(e[6]=t("div",{class:"main-tit"},"插件概叙",-1)),t("pre",vt,o(s.value.overview),1)])):$("",!0),t("div",mt,[e[7]||(e[7]=t("div",{class:"main-tit"},"使用说明",-1)),t("pre",{class:"text-cont",innerHTML:s.value.introduction},null,8,pt)])]),t("div",ft,[t("div",ht,[e[9]||(e[9]=t("div",{class:"main-tit"},"版本",-1)),t("div",yt,[l(" v"+o(s.value.latest_version)+" ",1),i(m,{type:"vertical"}),l(" "+o(s.value.author)+" "+o(g(D).unix((B=(Y=s.value)==null?void 0:Y.latest_version_detail)==null?void 0:B.update_time).format("YYYY-MM-DD HH:mm")),1)]),t("div",kt,o((R=(H=s.value)==null?void 0:H.latest_version_detail)==null?void 0:R.upgrade_description),1),t("div",null,[t("a",{onClick:M},[e[8]||(e[8]=l("版本历史 ")),i(g(K))])])]),t("div",xt,[e[10]||(e[10]=t("div",{class:"main-tit"},"权限列表",-1)),t("div",gt,"最大内存 "+o((I=(C=s.value)==null?void 0:C.latest_version_detail)==null?void 0:I.memory)+"MB",1)])])])])),i(J,{ref_key:"versionRef",ref:v},null,512),i(P,{ref_key:"updateRef",ref:r,onOk:h},null,512)])}}},Dt=V(bt,[["__scopeId","data-v-723f17e4"]]);export{Dt as default};
