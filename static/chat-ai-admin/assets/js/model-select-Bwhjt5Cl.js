import{g as x,j as E}from"./index-DXUrEY-q.js";import{X as B,f as M,w as b,e as L,o as A,a1 as y,_ as u,a2 as m,Y as I,a9 as N,F as C,G,a7 as g,k as O,a5 as p,ae as V}from"./vue-chunks-yZ4gwLzA.js";import{b as D}from"../../index-CuFGOJXl.js";import{bq as q,v as F,J as R,u as X}from"./ui-antd-BKjlZQNA.js";const k=B("model",()=>{const l=M([]);return{allModelList:l,getAllmodelList:async()=>{try{if(l.value.length==0){const a=await x();l.value=a.data}return l.value}catch(a){}}}});function $(l){let s=l||[],a={};return s.forEach(e=>{e.key=e.config_info.id,e.id=e.config_info.id,e.config_name=e.config_info.config_name,e.model_config_id=e.config_info.id,e.children=e.use_model_configs.map(o=>(o.thinking_type==2&&(a[e.config_info.id+"#"+o.use_model_name]=!0),{...o,key:e.config_info.id+"_"+o.use_model_name,value:e.config_info.id+"_"+o.use_model_name,model_config_id:e.config_info.id,name:o.use_model_name,label:o.show_model_name}))}),{newList:s,choosableThinking:a}}function W(l,s,a="LLM"){if(!l||!s)return"";let e=k();if(e.allModelList.length==0)return"";let o=e.allModelList;o=o.map(t=>({...t,use_model_configs:t.use_model_configs.filter(_=>_.model_type==a)}));let d=o.find(t=>t.config_info.id==l),n=null;return d&&(n=d.use_model_configs.find(t=>t.use_model_name==s)),n?`${d.config_info.config_name||d.config_info.show_model_name||d.model_name}  ${n.show_model_name||n.use_model_name}`:""}function Z(l,s,a="LLM"){if(!l||!s)return null;let e=k();if(e.allModelList.length==0)return null;let o=e.allModelList;o=o.map(t=>({...t,use_model_configs:t.use_model_configs.filter(_=>_.model_type==a)}));let d=o.find(t=>t.config_info.id==l),n=null;return d&&(n=d.use_model_configs.find(t=>t.use_model_name==s)),n||null}const j={key:0,class:"model-show-block"},J=["src"],K={class:"name-text"},Y=["src"],z={__name:"model-select",props:{modelType:{type:String,validator:l=>["TEXT EMBEDDING","RERANK","LLM","IMAGE","TTS"].includes(l),required:!0},modeName:{type:[String,Number],default:""},modeId:{type:[String,Number],default:""},useConfigId:{type:[String,Number],default:""},placeholder:{type:String,default:"请选择嵌入模型"}},emits:["change","update:modeName","update:modeId","update:useConfigId","loaded"],setup(l,{emit:s}){const a=s,e=l,o=M();b([()=>e.modeId,()=>e.modeName],([i,r])=>{!i||!r?o.value=void 0:o.value=i+"-"+r},{immediate:!0});const d=M([]),n=L(()=>e.modeId?d.value.find(i=>i.key==e.modeId):{}),t=L(()=>n.value.children&&n.value.children.length?n.value.children.find(i=>i.use_model_name==e.modeName):{}),_=(i,r)=>{r&&(a("update:modeName",r.modelName),a("update:modeId",r.modelId),a("update:useConfigId",r.useConfigId),a("change",i,r))},S=()=>{E({model_type:e.modelType}).then(i=>{let r=i.data||[],{newList:h,choosableThinking:v}=$(r,e.modeIdType);d.value=h,a("loaded",d.value,v)})};return A(()=>{S(),e.modeId&&e.modeName&&(o.value=e.modeId+"-"+e.modeName)}),(i,r)=>{const h=R,v=F,w=q,T=X;return u(),y(T,{value:o.value,placeholder:l.placeholder,onChange:_,style:{width:"100%"},allowClear:!0,class:"modal-seclet-new"},{clearIcon:m(()=>[n.value?(u(),I("div",j,[p("img",{class:"icon",src:n.value.model_icon_url,alt:""},null,8,J),p("div",K,g(n.value.config_name||n.value.model_name)+" "+g(t.value.show_model_name||t.value.use_model_name),1)])):V("",!0)]),default:m(()=>[(u(!0),I(C,null,N(d.value,f=>(u(),y(w,{key:f.key},{label:m(()=>[O(h,{align:"center",gap:6},{default:m(()=>[p("img",{class:"model-icon",src:f.model_icon_url,alt:""},null,8,Y),p("span",null,g(f.config_name||f.model_name),1)]),_:2},1024)]),default:m(()=>[(u(!0),I(C,null,N(f.children,c=>(u(),y(v,{value:c.value,modelId:c.model_config_id,modelName:c.name,useConfigId:c.id,key:c.key,attrs:c},{default:m(()=>[G(g(c.show_model_name||c.name),1)]),_:2},1032,["value","modelId","modelName","useConfigId","attrs"]))),128))]),_:2},1024))),128))]),_:1},8,["value","placeholder"])}}},ee=D(z,[["__scopeId","data-v-59f3f84a"]]);export{ee as M,Z as a,$ as b,W as g,k as u};
