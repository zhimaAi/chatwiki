import{bt as ye,aC as Se,aZ as we,aX as E,av as ae,aJ as O,J as Ce,aM as L,a$ as ze,aA as ie,at as I,ay as P,aG as Ae,aI as Ie}from"../../index-BokOG9ZU.js";import{F as re,u as Re}from"./FormItemContext-Ch_K4tn1.js";import{a as ue,g as de,b as $e,u as Ee}from"./index-Co375E0k.js";import{e as Q,j as R,r as T,o as ne,h as ce,b as N,w as q,f as fe,E as Te,s as B,y as le}from"./vue-chunks-XoCroLmQ.js";import{R as _e}from"./index-CnyiohbP.js";import{d as ve,f as Fe,t as Ve,r as X}from"./inputProps-CWzf5mAp.js";const oe=e=>e!=null&&(Array.isArray(e)?ye(e).length:!0);function Be(e){return oe(e.addonBefore)||oe(e.addonAfter)}const Pe=["text","input"],je=Q({compatConfig:{MODE:3},name:"ClearableLabeledInput",inheritAttrs:!1,props:{prefixCls:String,inputType:Se.oneOf(we("text","input")),value:E(),defaultValue:E(),allowClear:{type:Boolean,default:void 0},element:E(),handleReset:Function,disabled:{type:Boolean,default:void 0},direction:{type:String},size:{type:String},suffix:E(),prefix:E(),addonBefore:E(),addonAfter:E(),readonly:{type:Boolean,default:void 0},focused:{type:Boolean,default:void 0},bordered:{type:Boolean,default:!0},triggerFocus:{type:Function},hidden:Boolean,status:String,hashId:String},setup(e,v){let{slots:o,attrs:r}=v;const u=re.useInject(),b=l=>{const{value:i,disabled:a,readonly:c,handleReset:n,suffix:g=o.suffix}=e,m=!a&&!c&&i,S=`${l}-clear-icon`;return R(Ce,{onClick:n,onMousedown:C=>C.preventDefault(),class:O({[`${S}-hidden`]:!m,[`${S}-has-suffix`]:!!g},S),role:"button"},null)},f=(l,i)=>{const{value:a,allowClear:c,direction:n,bordered:g,hidden:m,status:S,addonAfter:C=o.addonAfter,addonBefore:_=o.addonBefore,hashId:w}=e,{status:z,hasFeedback:A}=u;if(!c)return ae(i,{value:a,disabled:e.disabled});const F=O(`${l}-affix-wrapper`,`${l}-affix-wrapper-textarea-with-clear-btn`,ue(`${l}-affix-wrapper`,de(z,S),A),{[`${l}-affix-wrapper-rtl`]:n==="rtl",[`${l}-affix-wrapper-borderless`]:!g,[`${r.class}`]:!Be({addonAfter:C,addonBefore:_})&&r.class},w);return R("span",{class:F,style:r.style,hidden:m},[ae(i,{style:null,value:a,disabled:e.disabled}),b(l)])};return()=>{var l;const{prefixCls:i,inputType:a,element:c=(l=o.element)===null||l===void 0?void 0:l.call(o)}=e;return a===Pe[0]?f(i,c):null}}}),Me=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,De=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],J={};let y;function ke(e){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const o=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(v&&J[o])return J[o];const r=window.getComputedStyle(e),u=r.getPropertyValue("box-sizing")||r.getPropertyValue("-moz-box-sizing")||r.getPropertyValue("-webkit-box-sizing"),b=parseFloat(r.getPropertyValue("padding-bottom"))+parseFloat(r.getPropertyValue("padding-top")),f=parseFloat(r.getPropertyValue("border-bottom-width"))+parseFloat(r.getPropertyValue("border-top-width")),i={sizingStyle:De.map(a=>`${a}:${r.getPropertyValue(a)}`).join(";"),paddingSize:b,borderSize:f,boxSizing:u};return v&&o&&(J[o]=i),i}function He(e){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;y||(y=document.createElement("textarea"),y.setAttribute("tab-index","-1"),y.setAttribute("aria-hidden","true"),document.body.appendChild(y)),e.getAttribute("wrap")?y.setAttribute("wrap",e.getAttribute("wrap")):y.removeAttribute("wrap");const{paddingSize:u,borderSize:b,boxSizing:f,sizingStyle:l}=ke(e,v);y.setAttribute("style",`${l};${Me}`),y.value=e.value||e.placeholder||"";let i,a,c,n=y.scrollHeight;if(f==="border-box"?n+=b:f==="content-box"&&(n-=u),o!==null||r!==null){y.value=" ";const m=y.scrollHeight-u;o!==null&&(i=m*o,f==="border-box"&&(i=i+u+b),n=Math.max(i,n)),r!==null&&(a=m*r,f==="border-box"&&(a=a+u+b),c=n>a?"":"hidden",n=Math.min(a,n))}const g={height:`${n}px`,overflowY:c,resize:"none"};return i&&(g.minHeight=`${i}px`),a&&(g.maxHeight=`${a}px`),g}const K=0,U=1,W=2,Le=Q({compatConfig:{MODE:3},name:"ResizableTextArea",inheritAttrs:!1,props:ve(),setup(e,v){let{attrs:o,emit:r,expose:u}=v,b,f;const l=T(),i=T({}),a=T(W);ne(()=>{L.cancel(b),L.cancel(f)});const c=()=>{try{if(document.activeElement===l.value){const h=l.value.selectionStart,M=l.value.selectionEnd,D=l.value.scrollTop;l.value.setSelectionRange(h,M),l.value.scrollTop=D}}catch{}},n=T(),g=T();ce(()=>{const h=e.autoSize||e.autosize;h?(n.value=h.minRows,g.value=h.maxRows):(n.value=void 0,g.value=void 0)});const m=N(()=>!!(e.autoSize||e.autosize)),S=()=>{a.value=K};q([()=>e.value,n,g,m],()=>{m.value&&S()},{immediate:!0,flush:"post"});const C=T();q([a,l],()=>{if(l.value)if(a.value===K)a.value=U;else if(a.value===U){const h=He(l.value,!1,n.value,g.value);a.value=W,C.value=h}else c()},{immediate:!0,flush:"post"});const _=fe(),w=T(),z=()=>{L.cancel(w.value)},A=h=>{a.value===W&&(r("resize",h),m.value&&(z(),w.value=L(()=>{S()})))};ne(()=>{z()}),u({resizeTextarea:()=>{S()},textArea:l,instance:_}),ze(e.autosize===void 0);const j=()=>{const{prefixCls:h,disabled:M}=e,D=ie(e,["prefixCls","onPressEnter","autoSize","autosize","defaultValue","allowClear","type","lazy","maxlength","valueModifiers"]),k=O(h,o.class,{[`${h}-disabled`]:M}),Z=m.value?C.value:null,V=[o.style,i.value,Z],$=I(I(I({},D),o),{style:V,class:k});return(a.value===K||a.value===U)&&V.push({overflowX:"hidden",overflowY:"hidden"}),$.autofocus||delete $.autofocus,$.rows===0&&delete $.rows,R(_e,{onResize:A,disabled:!m.value},{default:()=>[Te(R("textarea",P(P({},$),{},{ref:l}),null),[[$e]])]})};return()=>j()}}),Ne=Le;function ge(e,v){return[...e||""].slice(0,v).join("")}function se(e,v,o,r){let u=o;return e?u=ge(o,r):[...v||""].length<o.length&&[...o||""].length>r&&(u=v),u}const Ke=Q({compatConfig:{MODE:3},name:"ATextarea",inheritAttrs:!1,props:ve(),setup(e,v){let{attrs:o,expose:r,emit:u}=v;const b=Re(),f=re.useInject(),l=N(()=>de(f.status,e.status)),i=B(e.value===void 0?e.defaultValue:e.value),a=B(),c=B(""),{prefixCls:n,size:g,direction:m}=Ae("input",e),[S,C]=Ee(n),_=Ie(),w=N(()=>e.showCount===""||e.showCount||!1),z=N(()=>Number(e.maxlength)>0),A=B(!1),F=B(),j=B(0),h=t=>{A.value=!0,F.value=c.value,j.value=t.currentTarget.selectionStart,u("compositionstart",t)},M=t=>{var s;A.value=!1;let d=t.currentTarget.value;if(z.value){const p=j.value>=e.maxlength+1||j.value===((s=F.value)===null||s===void 0?void 0:s.length);d=se(p,F.value,d,e.maxlength)}d!==c.value&&(V(d),X(t.currentTarget,t,Y,d)),u("compositionend",t)},D=fe();q(()=>e.value,()=>{var t;"value"in D.vnode.props,i.value=(t=e.value)!==null&&t!==void 0?t:""});const k=t=>{var s;Ve((s=a.value)===null||s===void 0?void 0:s.textArea,t)},Z=()=>{var t,s;(s=(t=a.value)===null||t===void 0?void 0:t.textArea)===null||s===void 0||s.blur()},V=(t,s)=>{i.value!==t&&(e.value===void 0?i.value=t:le(()=>{var d,p,x;a.value.textArea.value!==c.value&&((x=(d=a.value)===null||d===void 0?void 0:(p=d.instance).update)===null||x===void 0||x.call(p))}),le(()=>{s&&s()}))},$=t=>{t.keyCode===13&&u("pressEnter",t),u("keydown",t)},me=t=>{const{onBlur:s}=e;s==null||s(t),b.onFieldBlur()},Y=t=>{u("update:value",t.target.value),u("change",t),u("input",t),b.onFieldChange()},he=t=>{X(a.value.textArea,t,Y),V("",()=>{k()})},ee=t=>{const{composing:s}=t.target;let d=t.target.value;if(A.value=!!(t.isComposing||s),!(A.value&&e.lazy||i.value===d)){if(z.value){const p=t.target,x=p.selectionStart>=e.maxlength+1||p.selectionStart===d.length||!p.selectionStart;d=se(x,c.value,d,e.maxlength)}X(t.currentTarget,t,Y,d),V(d)}},xe=()=>{var t,s;const{class:d}=o,{bordered:p=!0}=e,x=I(I(I({},ie(e,["allowClear"])),o),{class:[{[`${n.value}-borderless`]:!p,[`${d}`]:d&&!w.value,[`${n.value}-sm`]:g.value==="small",[`${n.value}-lg`]:g.value==="large"},ue(n.value,l.value),C.value],disabled:_.value,showCount:null,prefixCls:n.value,onInput:ee,onChange:ee,onBlur:me,onKeydown:$,onCompositionstart:h,onCompositionend:M});return!((t=e.valueModifiers)===null||t===void 0)&&t.lazy&&delete x.onInput,R(Ne,P(P({},x),{},{id:(s=x==null?void 0:x.id)!==null&&s!==void 0?s:b.id.value,ref:a,maxlength:e.maxlength}),null)};return r({focus:k,blur:Z,resizableTextArea:a}),ce(()=>{let t=Fe(i.value);!A.value&&z.value&&(e.value===null||e.value===void 0)&&(t=ge(t,e.maxlength)),c.value=t}),()=>{var t;const{maxlength:s,bordered:d=!0,hidden:p}=e,{style:x,class:be}=o,pe=I(I(I({},e),o),{prefixCls:n.value,inputType:"text",handleReset:he,direction:m.value,bordered:d,style:w.value?void 0:x,hashId:C.value,disabled:(t=e.disabled)!==null&&t!==void 0?t:_.value});let G=R(je,P(P({},pe),{},{value:c.value,status:e.status}),{element:xe});if(w.value||f.hasFeedback){const te=[...c.value].length;let H="";typeof w.value=="object"?H=w.value.formatter({value:c.value,count:te,maxlength:s}):H=`${te}${z.value?` / ${s}`:""}`,G=R("div",{hidden:p,class:O(`${n.value}-textarea`,{[`${n.value}-textarea-rtl`]:m.value==="rtl",[`${n.value}-textarea-show-count`]:w.value,[`${n.value}-textarea-in-form-item`]:f.isFormItemInput},`${n.value}-textarea-show-count`,be,C.value),style:x,"data-count":typeof H!="object"?H:void 0},[G,f.hasFeedback&&R("span",{class:`${n.value}-textarea-suffix`},[f.feedbackIcon])])}return S(G)}}});export{Ke as _};
