import{r as C,ah as U,E as P,a as f,b as h,y as l,t as e,an as S,ao as z,u as t,_ as s,v as n,F as V,l as X,p as u}from"./vue-chunks-BdaA73Wf.js";import{u as L}from"../../index-DSFcP5NQ.js";import{f as Y,a as Z,u as ee,h as te}from"./index-p9HhDhmV.js";import{_ as D}from"./emoji-mart-BBMRoEa3.js";import{F as T,c as le,I as ne,q as E,ac as p,u as ae,v as oe,H as A,M as J,b as B,a1 as ie,B as de,w as se,z as _e,x as ce,O as ue}from"./ui-antd-Dl1wwwCD.js";import"./editor-cherry-CFIsbKoN.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";const re={class:"add-data-sheet"},pe={__name:"add-field-modal",emits:["ok"],setup(j,{expose:d,emit:M}){const{t:i}=L("views.database.database-detail.field-manage.components.add-field-modal"),k=C(i("modal_title_add")),O=U().query,v=C(!1),q=M,w=[{label:"string",value:"string"},{label:"integer",value:"integer"},{label:"number",value:"number"},{label:"boolean",value:"boolean"}],a=P({name:"",description:"",type:void 0,required:"false",form_id:O.form_id,id:""}),y=o=>{v.value=!0,m(),a.name=o.name||"",a.description=o.description||"",a.type=o.type,a.required=o.required,a.id=o.id||"",k.value=o.id?i("modal_title_edit"):i("modal_title_add")},$=P({name:[{required:!0,validator:async(o,_)=>/^[a-z][a-z0-9_]*$/.test(_)?Promise.resolve():Promise.reject(i("validator_name_pattern"))}],description:[{required:!0,message:i("validator_description_required")}],type:[{required:!0,message:i("validator_type_required")}]}),r=T.useForm,{resetFields:m,validate:R,validateInfos:b}=r(a,$),I=()=>{R().then(()=>{Y(a).then(o=>{let _=a.id?i("msg_edit_success"):i("msg_add_success");B.success(_),v.value=!1,q("ok")})})};return d({show:y}),(o,_)=>{const x=E,N=ne,F=le,H=oe,Q=ae,G=A,K=T,W=J;return h(),f("div",re,[l(W,{open:v.value,"onUpdate:open":_[4]||(_[4]=c=>v.value=c),title:k.value,onOk:I,width:540},{default:e(()=>[l(K,{layout:"vertical"},{default:e(()=>[l(F,S(z(t(b).name)),{label:e(()=>[s(n(t(i)("label_name"))+"  ",1),l(x,null,{title:e(()=>[s(n(t(i)("label_name_tooltip")),1)]),default:e(()=>[l(t(p))]),_:1})]),default:e(()=>[l(N,{maxLength:64,value:a.name,"onUpdate:value":_[0]||(_[0]=c=>a.name=c),placeholder:t(i)("ph_name")},null,8,["value","placeholder"])]),_:1},16),l(F,S(z(t(b).description)),{label:e(()=>[s(n(t(i)("label_description"))+"  ",1),l(x,null,{title:e(()=>[s(n(t(i)("label_description_tooltip")),1)]),default:e(()=>[l(t(p))]),_:1})]),default:e(()=>[l(N,{maxLength:64,value:a.description,"onUpdate:value":_[1]||(_[1]=c=>a.description=c),placeholder:t(i)("ph_description")},null,8,["value","placeholder"])]),_:1},16),l(F,S(z(t(b).type)),{label:e(()=>[s(n(t(i)("label_type"))+"  ",1),l(x,null,{title:e(()=>[s(n(t(i)("label_type_tooltip")),1)]),default:e(()=>[l(t(p))]),_:1})]),default:e(()=>[l(Q,{value:a.type,"onUpdate:value":_[2]||(_[2]=c=>a.type=c),style:{width:"100%"},placeholder:t(i)("ph_type")},{default:e(()=>[(h(),f(V,null,X(w,c=>l(H,{value:c.value,key:c.value},{default:e(()=>[s(n(c.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value","placeholder"])]),_:1},16),l(F,null,{label:e(()=>[s(n(t(i)("label_required"))+"  ",1),l(x,null,{title:e(()=>[u("div",null,n(t(i)("label_required_tooltip_required")),1),u("div",null,n(t(i)("label_required_tooltip_optional")),1)]),default:e(()=>[l(t(p))]),_:1})]),default:e(()=>[l(G,{checked:a.required,"onUpdate:checked":_[3]||(_[3]=c=>a.required=c),"checked-children":t(i)("switch_on"),"un-checked-children":t(i)("switch_off"),checkedValue:"true",unCheckedValue:"false"},null,8,["checked","checked-children","un-checked-children"])]),_:1})]),_:1})]),_:1},8,["open","title"])])}}},me=D(pe,[["__scopeId","data-v-73e98f1b"]]),fe={class:"field-manage-page"},he={class:"page-title"},ve={class:"table-wrapper customize-scroll-style"},ye={key:0},ke={key:1},ge={key:0},be={key:1},qe=["onClick"],we=["onClick"],xe={__name:"index",setup(j){const{t:d}=L("views.database.database-detail.field-manage.index"),i=U().query,k=C([]),g=()=>{Z({form_id:i.form_id}).then(a=>{k.value=a.data||[]})};g();const O=a=>{ee({id:a.id,form_id:i.form_id,required:a.required=="true"?"false":"true"}).then(y=>{B.success(d("msg_modify_success")),g()})},v=a=>{J.confirm({title:d("modal_delete_title"),icon:l(ue),content:d("modal_delete_content",{name:a.name}),okText:d("modal_delete_ok"),okType:"danger",cancelText:d("modal_delete_cancel"),onOk(){te({id:a.id}).then(y=>{B.success(d("msg_delete_success")),g()})},onCancel(){}})},q=C(null),w=(a={})=>{q.value.show(JSON.parse(JSON.stringify(a)))};return(a,y)=>{const $=de,r=E,m=se,R=A,b=_e,I=ce;return h(),f(V,null,[u("div",fe,[u("div",he,[s(n(t(d)("title"))+" ",1),l($,{type:"primary",onClick:y[0]||(y[0]=o=>w())},{icon:e(()=>[l(t(ie))]),default:e(()=>[s(" "+n(t(d)("btn_add_field")),1)]),_:1})]),u("div",ve,[l(I,{pagination:!1,"data-source":k.value},{default:e(()=>[l(m,{key:"name","data-index":"name",width:150},{title:e(()=>[s(n(t(d)("column_name_title"))+" ",1),l(r,null,{title:e(()=>[s(n(t(d)("column_name_tooltip")),1)]),default:e(()=>[l(t(p))]),_:1})]),default:e(({record:o})=>[o.name.length>50?(h(),f("span",ye,[l(r,null,{title:e(()=>[s(n(o.name),1)]),default:e(()=>[s(" "+n(o.name.slice(0,50)+"..."),1)]),_:2},1024)])):(h(),f("span",ke,n(o.name),1))]),_:1}),l(m,{key:"description","data-index":"description",width:150},{title:e(()=>[s(n(t(d)("column_description_title"))+" ",1),l(r,null,{title:e(()=>[s(n(t(d)("column_description_tooltip")),1)]),default:e(()=>[l(t(p))]),_:1})]),default:e(({record:o})=>[o.description.length>50?(h(),f("span",ge,[l(r,null,{title:e(()=>[s(n(o.description),1)]),default:e(()=>[s(" "+n(o.description.slice(0,50)+"..."),1)]),_:2},1024)])):(h(),f("span",be,n(o.description),1))]),_:1}),l(m,{key:"type","data-index":"type",width:120},{title:e(()=>[s(n(t(d)("column_type_title"))+" ",1),l(r,null,{title:e(()=>[s(n(t(d)("column_type_tooltip")),1)]),default:e(()=>[l(t(p))]),_:1})]),_:1}),l(m,{key:"required","data-index":"required",width:120},{title:e(()=>[s(n(t(d)("column_required_title"))+" ",1),l(r,null,{title:e(()=>[u("div",null,n(t(d)("column_required_tooltip_required")),1),u("div",null,n(t(d)("column_required_tooltip_optional")),1)]),default:e(()=>[l(t(p))]),_:1})]),default:e(({record:o})=>[l(R,{onChange:_=>O(o),checked:o.required=="true","checked-children":t(d)("switch_on"),"un-checked-children":t(d)("switch_off")},null,8,["onChange","checked","checked-children","un-checked-children"])]),_:1}),l(m,{key:"action",title:t(d)("column_action_title"),width:90},{default:e(({record:o})=>[u("span",null,[u("a",{onClick:_=>w(o)},n(t(d)("action_edit")),9,qe),l(b,{type:"vertical"}),u("a",{onClick:_=>v(o)},n(t(d)("action_delete")),9,we)])]),_:1},8,["title"])]),_:1},8,["data-source"])])]),l(me,{onOk:g,ref_key:"addFieldModalRef",ref:q},null,512)],64)}}},Pe=D(xe,[["__scopeId","data-v-31800da6"]]);export{Pe as default};
//# sourceMappingURL=index-C1IpsXqs.js.map
