import{_ as J}from"./cu-scroll-CpIj948h.js";import{Q as X,K as tt}from"./knowledge-document-Co_blTqf.js";import{aw as at,c as et,u as q,_ as ot,A as st,ax as it,ay as lt,az as rt,aA as nt}from"../../index-DSFcP5NQ.js";import{u as E}from"./robot-CIzNpArp.js";import{c as D,r as h,j as M,a as c,b as l,e as g,q as u,F as V,ah as j,aj as ct,E as _t,Q as dt,p as o,y as p,t as d,_ as I,v as i,u as r,l as pt,Y as L,h as yt,a1 as ut,ag as bt}from"./vue-chunks-BdaA73Wf.js";import{a2 as ft}from"./index-Cg7-0swo.js";import{L as mt}from"./library-select-alert-BCR3m1P9.js";import{a as vt}from"./index-C67uUbSa.js";import{_ as N}from"./emoji-mart-BBMRoEa3.js";import{B as ht,q as gt,f as wt,g as kt,i as xt,M as Lt,b as Ct,Z as St,$ as zt}from"./ui-antd-Dl1wwwCD.js";import{d as B}from"./utils-CvB22N-W.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./edit-subsection-BwSyKVRx.js";import"./index-XVLbk3qE.js";import"./index-B_UHbFfL.js";import"./other-LrIFyvU9.js";import"./model-select-CMPvMrAQ.js";import"./index-MT9fcN3v.js";import"./editor-code-DlsHKXTn.js";import"./editor-cherry-CFIsbKoN.js";import"./rename-modal-WfG-X_fj.js";import"./upload-input-C5mRP3pq.js";import"./validate-8MtiUsxW.js";import"./open-grapg-modal-wgsaRjH8.js";import"./page-alert-DLppgA58.js";import"./default-cover-Bm8pZ2KF.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";const At={__name:"default-library",setup(T){const m=E(),e=D(()=>m.robotInfo.default_library_id),b=h(null);return M(()=>{at({id:e.value}).then(y=>{b.value=+y.data.type||0})}),(y,w)=>(l(),c(V,null,[b.value==2?(l(),g(X,{key:0,library_id:e.value},null,8,["library_id"])):u("",!0),b.value==0?(l(),g(tt,{key:1,library_id:e.value},null,8,["library_id"])):u("",!0)],64))}},Rt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1749612065457'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5081'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='256'%20height='256'%3e%3cpath%20d='M0%200v1024L1024%200H0z%20m294.4%20172.8h12.8c22.4%200%2048-3.2%2060.8%200v32c-19.2-3.2-51.2%200-76.8%200l3.2-32z%20m-128%20422.4l44.8-48-19.2-16-38.4%2038.4-19.2-19.2L172.8%20512l-12.8-12.8-38.4%2038.4L28.8%20448%20128%20348.8l92.8%2092.8L179.2%20480l16%2016%2038.4-38.4%2019.2%2019.2L214.4%20512l16%2016%2038.4-44.8%2019.2%2019.2c-35.2%2041.6-73.6%2083.2-99.2%20112l-22.4-19.2z%20m60.8%2073.6c-6.4-19.2-16-44.8-25.6-64l22.4-6.4c9.6%2019.2%2022.4%2044.8%2025.6%2064l-22.4%206.4z%20m48-38.4c-9.6-12.8-28.8-28.8-44.8-41.6l9.6-12.8c16%209.6%2035.2%2025.6%2048%2038.4l-12.8%2016z%20m22.4-32c-9.6-9.6-28.8-22.4-44.8-32l9.6-16c16%209.6%2035.2%2019.2%2048%2028.8l-12.8%2019.2z%20m16-35.2c-9.6-6.4-25.6-16-41.6-19.2l9.6-19.2c16%203.2%2032%2012.8%2041.6%2019.2l-9.6%2019.2z%20m48-9.6c-9.6%200-22.4%200-32%203.2-3.2-70.4-38.4-128-73.6-169.6l-38.4%2038.4-22.4-22.4%2038.4-38.4-9.6-9.6-57.6-57.6%2019.2-19.2%2019.2%2019.2%206.4-22.4c22.4%203.2%2051.2%206.4%2067.2%2012.8l-6.4%2022.4c-16-6.4-44.8-9.6-67.2-12.8l48%2048%2048-48%2022.4%2022.4-48%2048c60.8%2041.6%20121.6%2070.4%20172.8%2064%200%209.6%200%2022.4%203.2%2032-41.6%203.2-86.4-16-134.4-44.8%2022.4%2041.6%2041.6%2083.2%2044.8%20134.4z%20m150.4-163.2c-6.4-3.2-22.4-3.2-28.8-3.2%200-9.6%200-25.6-12.8-38.4l-80-80L352%20307.2l-22.4-22.4%2064-60.8%2099.2%2099.2%209.6-44.8%2025.6%2012.8c-16%2076.8-16%2089.6-16%2099.2z%20m67.2-51.2c-9.6-3.2-25.6-3.2-35.2%200%2016-102.4-64-182.4-144-262.4l-9.6-9.6%2025.6-22.4c25.6%2025.6%2048%2051.2%2070.4%2076.8%2028.8%2022.4%20112%2086.4%20201.6%2070.4-3.2%209.6%200%2025.6%200%2035.2-54.4%209.6-108.8-12.8-150.4-35.2%2032%2044.8%2048%2096%2041.6%20147.2z'%20p-id='5082'%20fill='%232475fc'%3e%3c/path%3e%3cpath%20d='M124.8%20384l-25.6%2025.6L160%20467.2l25.6-25.6L124.8%20384z%20m25.6%2067.2c-6.4-12.8-19.2-35.2-28.8-48l16-6.4c9.6%2016%2019.2%2038.4%2022.4%2051.2l-9.6%203.2zM64%20444.8l60.8%2060.8%2022.4-25.6-60.8-60.8-22.4%2025.6z%20m57.6%2041.6c-9.6-9.6-28.8-22.4-44.8-28.8l6.4-12.8c16%206.4%2035.2%2019.2%2044.8%2028.8l-6.4%2012.8z'%20p-id='5083'%20fill='%232475fc'%3e%3c/path%3e%3c/svg%3e",Dt={class:"main-content-block"},It={class:"btn-block"},Mt={class:"list-box"},Tt=["onClick"],Yt={key:0,class:"default-icon",src:Rt,alt:""},$t={class:"library-info"},Bt=["src"],Kt={class:"library-info-content"},qt={class:"library-title"},Et={class:"library-type"},Vt={key:0,class:"type-tag"},jt={key:1,class:"type-tag"},Nt={key:2,class:"type-tag"},Ot={key:3,class:"type-tag"},Gt={class:"item-body"},Qt={class:"library-desc"},Wt={class:"item-footer"},Ft={class:"library-size"},Ht={class:"text-item"},Pt={class:"text-item"},Ut={class:"text-item"},Zt=["onClick"],Jt=["onClick"],Xt={__name:"related-library",setup(T){const m=et(),{t:e}=q("views.robot.robot-config.library-config.related-library"),b=D(()=>{var t;return((t=m.companyInfo)==null?void 0:t.neo4j_status)=="true"}),y=j().query,w=E(),{getRobot:C}=w,{robotInfo:f}=ct(w),_=_t({library_ids:[],default_library_id:""}),k=h([]),v=h(null),x=h(null),S=D(()=>{let t=k.value.filter(a=>_.library_ids.includes(a.id));if(f.value.default_library_id){let a=t.find(n=>n.id==f.value.default_library_id);a&&(t=t.filter(n=>n.id!=f.value.default_library_id),t.unshift(a))}return v.value||(t=t.filter(a=>a.type!=3)),t}),z=t=>{let a=_.library_ids.indexOf(t.id);_.library_ids.splice(a,1),R()},A=t=>{Lt.confirm({title:e("msg_confirm_set_default",{library_name:t.library_name}),icon:null,content:p("div",{style:"color:red;"},e("msg_one_default_library")),onOk(){_.default_library_id=t.id,R(_.default_library_id)},onCancel(){}})},O=()=>{x.value.open([..._.library_ids])},G=t=>{_.library_ids=[...t],R()},R=t=>{let a={...ut(_)};a.library_ids=a.library_ids.join(","),ft({library_ids:a.library_ids,default_library_id:t||null,id:y.id}).then(n=>{Ct.success(e("msg_operation_success")),C(y.id)})};dt(()=>{_.library_ids=f.value.library_ids.split(","),_.default_library_id=f.value.default_library_id||""});const Q=t=>{t.type=="1"?window.open(`/#/public-library/config?library_id=${t.id}`,"_blank","noopener"):window.open(`/#/library/details?id=${t.id}`,"_blank","noopener")},W=async()=>{const t=await st({type:"",show_open_docs:1});if(t){let a=t.data||[];a.forEach(n=>{n.file_size_str=it(n.file_size),n.avatar||(n.avatar=n.type==0?lt:rt)}),k.value=a}},F=async()=>{await vt({ability_type:"library_ability_official_account"}).then(t=>{var n;let a=(t==null?void 0:t.data)||{};((n=a==null?void 0:a.user_config)==null?void 0:n.switch_status)==1&&(v.value=a)})};return M(()=>{F(),W()}),(t,a)=>{const n=ht,H=gt,P=ot,Y=kt,U=wt,Z=xt;return l(),c("div",Dt,[o("div",It,[p(n,{type:"primary",onClick:O},{default:d(()=>[I(i(r(e)("btn_relate_library")),1)]),_:1})]),o("div",Mt,[(l(!0),c(V,null,pt(S.value,s=>(l(),c("div",{class:"list-item-wrapper",key:s.id},[o("div",{class:"list-item",onClick:L($=>Q(s),["stop"])},[s.id==r(f).default_library_id?(l(),c("img",Yt)):u("",!0),o("div",$t,[o("img",{class:"library-icon",src:s.avatar,alt:""},null,8,Bt),o("div",Kt,[o("div",qt,i(s.library_name),1),o("div",Et,[s.type==0?(l(),c("span",Vt,i(r(e)("label_normal_library")),1)):u("",!0),s.type==1?(l(),c("span",jt,i(r(e)("label_external_library")),1)):u("",!0),s.type==2?(l(),c("span",Nt,i(r(e)("label_qa_library")),1)):u("",!0),s.type==3?(l(),c("span",Ot,i(r(e)("label_official_account_library")),1)):u("",!0),b.value?(l(),g(H,{key:4},{title:d(()=>[I(i(s.graph_switch==0?r(e)("msg_graph_disabled"):r(e)("msg_graph_enabled")),1)]),default:d(()=>[o("span",{class:yt(["type-tag graph-tag",{"gray-tag":s.graph_switch==0}])},"Graph",2)]),_:2},1024)):u("",!0)])])]),o("div",Gt,[o("div",Qt,i(s.library_intro),1)]),o("div",Wt,[o("div",Ft,[o("span",Ht,i(r(e)("label_docs"))+"："+i(s.file_total),1),o("span",Pt,i(r(e)("label_size"))+"："+i(s.file_size_str),1),o("span",Ut,i(r(e)("label_related_apps"))+"："+i(s.robot_nums||0),1)]),s.id!=r(f).default_library_id?(l(),c("div",{key:0,class:"action-box",onClick:a[1]||(a[1]=L(()=>{},["stop"]))},[p(Z,null,{overlay:d(()=>[p(U,null,{default:d(()=>[s.type!=1?(l(),g(Y,{key:0},{default:d(()=>[o("a",{onClick:L($=>A(s),["stop"])},i(r(e)("btn_set_default")),9,Zt)]),_:2},1024)):u("",!0),p(Y,null,{default:d(()=>[o("a",{class:"delete-text-color",onClick:L($=>z(s),["stop"])},i(r(e)("btn_cancel_relation")),9,Jt)]),_:2},1024)]),_:2},1024)]),default:d(()=>[o("div",{class:"action-item",onClick:a[0]||(a[0]=L(()=>{},["stop"]))},[p(P,{class:"action-icon",name:"point-h"})])]),_:2},1024)])):u("",!0)])],8,Tt)]))),128))]),p(mt,{ref_key:"librarySelectAlertRef",ref:x,showWxType:!!v.value,onChange:G},null,8,["showWxType"])])}}},ta=N(Xt,[["__scopeId","data-v-6ae7f06e"]]),aa={class:"main-content-block"},ea={class:"tab-right-extra"},oa={key:0,class:"body-content-box",style:{"padding-right":"16px"}},sa={key:1,class:"body-content-box"},K="/robot/config/library-config/activeKey",ia={__name:"index",setup(T){const{t:m}=q("views.robot.robot-config.library-config.index"),e=bt(),b=j().query,y=h(+localStorage.getItem(K)||1),w=()=>{localStorage.setItem(K,y.value)},C=h(0),f=async()=>{nt({robot_id:b.id,start_date:B().subtract(6,"day").format("YYYY-MM-DD"),end_date:B().format("YYYY-MM-DD")}).then(k=>{C.value=k.data.header.library_hit_rate})},_=()=>{localStorage.setItem("/robot/config/statistical_analysis/activeKey",3),e.push({path:"/robot/config/statistical_analysis",query:{id:b.id,robot_key:b.robot_key}})};return M(()=>{f()}),(k,v)=>{const x=zt,S=St,z=J;return l(),c("div",aa,[p(S,{class:"tab-wrapper",activeKey:y.value,"onUpdate:activeKey":v[0]||(v[0]=A=>y.value=A),onChange:w},{rightExtra:d(()=>[o("div",ea,[I(i(r(m)("text_hit_rate_label"))+"："+i(C.value)+"% ",1),o("a",{onClick:_},i(r(m)("link_view")),1)])]),default:d(()=>[(l(),g(x,{key:1,tab:r(m)("tab_default_library")},null,8,["tab"])),(l(),g(x,{key:2,tab:r(m)("tab_related_library")},null,8,["tab"]))]),_:1},8,["activeKey"]),y.value==1?(l(),c("div",oa,[p(At)])):(l(),c("div",sa,[p(z,null,{default:d(()=>[p(ta)]),_:1})]))])}}},Ba=N(ia,[["__scopeId","data-v-8e878d26"]]);export{Ba as default};
//# sourceMappingURL=index-sIkVLmV3.js.map
