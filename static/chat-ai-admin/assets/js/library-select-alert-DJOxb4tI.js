import{_ as P}from"./cu-scroll-RG6yxhtf.js";import{b as Q,B as W,M as Y,k as ee,a5 as te,bE as oe}from"../../index-M_xDbIir.js";import{u as se}from"./robot-DM4IWDeQ.js";import"./index-UA7y0weg.js";import{I as ae}from"./Input-Bx6Hhp2b.js";import{S as le}from"./SearchOutlined-KUcJKUZw.js";import{S as ne}from"./SyncOutlined-Ddoh8W5Z.js";import{L as ie}from"./LeftOutlined-DbHJ8blF.js";import{R as re}from"./RightOutlined-og3IpneX.js";import{S as ce}from"./index-D_6sH2t0.js";import{_ as de,C as ue}from"./index-Bn-th77D.js";import{z as _e,d,S as b,O as i,U as l,X as t,j as a,u as _,Z as w,a5 as k,N as p,a6 as pe,F as B,a1 as G,_ as h}from"./vue-chunks-BRsu9_To.js";import{_ as ve}from"./index-BF4PinvW.js";import{_ as me}from"./index-B0RyY99D.js";const he={class:"library-checkbox-box"},fe={class:"list-tools"},ge={class:"list-group-box"},ye={key:0,class:"group-head-box"},be={class:"classify-box"},ke=["onClick"],xe={class:"classify-title"},Le={class:"right-content"},Ce={style:{flex:"1",overflow:"hidden"}},Se={class:"list-box",ref:"scrollContainer"},we={class:"library-name"},Be={class:"library-desc"},Ge={__name:"library-select-alert",emits:["change"],setup(Ie,{expose:I,emit:N}){const O=se(),{robotInfo:R}=O,V=N,r=_e({indeterminate:!1,checkAll:!1,checkedList:[]}),u=d("");let x="library-list-hide-group-key";const c=d(localStorage.getItem(x)==1),A=()=>{c.value=!c.value,localStorage.setItem(x,c.value?1:0)},L=d([]),E=()=>{oe().then(s=>{let e=s.data||[],n=0;e.forEach(y=>{n+=+y.total}),L.value=[{group_name:"全部",total:n,id:""},...e]})},U=s=>{u.value=s.id,m()},v=d(!1),z=s=>{u.value="",m(),E(),r.checkedList=s,v.value=!0},F=()=>{v.value=!1,K()},f=d(""),H=()=>{m()},C=d([]),K=()=>{V("change",[...r.checkedList])},m=async()=>{const s=await te({library_name:f.value,type:"",show_open_docs:1});if(s){let e=s.data||[];u.value!=""&&(e=e.filter(n=>n.group_id==u.value)),C.value=e}},M=s=>{let e=s.target.value;r.checkedList.includes(e)?r.checkedList=r.checkedList.filter(n=>n!=e):r.checkedList.push(e)},g=d(!1),$=async()=>{g.value=!0,await m(),g.value=!1,ee.success("刷新完成")},j=()=>{window.open("/#/library/list")};return I({open:z}),(s,e)=>{const n=ve,y=ae,S=W,D=P,T=me,X=ue,Z=de,q=ce,J=Y;return i(),b(J,{width:"946px",open:v.value,"onUpdate:open":e[1]||(e[1]=o=>v.value=o),title:"关联知识库",onOk:F},{default:l(()=>[t("div",he,[a(n,{message:"请选择关联知识库，机器人会根据知识库内上传的文档回复用户的提问。每个机器人最多关联5个知识库",type:"info"}),t("div",fe,[t("div",null,[a(y,{style:{width:"282px"},value:f.value,"onUpdate:value":e[0]||(e[0]=o=>f.value=o),placeholder:"请输入知识库名称搜索",onChange:H},{suffix:l(()=>[a(_(le),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),t("div",null,[a(S,{style:{"margin-right":"8px"},onClick:$},{default:l(()=>[a(_(ne)),e[2]||(e[2]=w(" 刷新 "))]),_:1,__:[2]}),a(S,{type:"primary",ghost:"",onClick:j},{default:l(()=>e[3]||(e[3]=[w("新建知识库")])),_:1,__:[3]})])]),t("div",ge,[t("div",{class:k(["group-list-box",{"hide-group":c.value}])},[a(D,{style:{"padding-right":"16px"}},{default:l(()=>[c.value?pe("",!0):(i(),p("div",ye,e[4]||(e[4]=[t("div",{class:"head-title"},[t("div",null,"知识库分组")],-1)]))),t("div",be,[(i(!0),p(B,null,G(L.value,o=>(i(),p("div",{class:k(["classify-item",{active:o.id==u.value}]),onClick:Ne=>U(o),key:o.id},[t("div",xe,h(o.group_name),1),t("div",Le,[t("div",{class:k(["num",{"num-block":o.id<=0}])},h(o.total),3)])],10,ke))),128))])]),_:1}),a(T,{placement:"right",title:c.value?"展开分组":"收起分组"},{default:l(()=>[t("div",{class:"hide-group-box",onClick:A},[c.value?(i(),b(_(re),{key:1})):(i(),b(_(ie),{key:0}))])]),_:1},8,["title"])],2),t("div",Ce,[a(q,{spinning:g.value,delay:100},{default:l(()=>[a(Z,{value:r.checkedList,style:{width:"100%"}},{default:l(()=>[t("div",Se,[(i(!0),p(B,null,G(C.value,o=>(i(),p("div",{class:"list-item-wraapper",key:o.id},[a(X,{class:"list-item",value:o.id,onChange:M,disabled:_(R).default_library_id==o.id},{default:l(()=>[t("div",we,h(o.library_name),1),t("div",Be,h(o.library_intro),1)]),_:2},1032,["value","disabled"])]))),128))],512)]),_:1},8,["value"])]),_:1},8,["spinning"])])])])]),_:1},8,["open"])}}},Te=Q(Ge,[["__scopeId","data-v-e2debb4a"]]);export{Te as L};
