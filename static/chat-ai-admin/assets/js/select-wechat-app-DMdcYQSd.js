import{f as d,e as W,a1 as k,_ as o,a2 as n,a3 as $,Y as r,k as i,G as u,a5 as l,F as w,ab as J,ac as K,a7 as g,u as A,B as P,a9 as Y,y as j,J as B}from"./vue-chunks-DCKTEHpB.js";import{L as q}from"./loading-box-CyUSXD2F.js";import{E as H}from"./empty-box-vvdJX5k0.js";import{e as Q}from"./index-DLEjqKv8.js";import{_ as X,f as Z}from"../../index-C1Xsov4S.js";import{k as ee,O as ae,af as se,a6 as te,G as le,B as oe,M as ne}from"./ui-antd-D64OvTpt.js";const ie={style:{"margin-bottom":"12px"}},de={class:"wechat-app-list"},pe=["onClick"],ue={class:"item-body"},ce=["src"],re={class:"app-info"},fe={class:"app-name"},ve={class:"app-desc"},_e={class:"ext-info-list"},me={key:0,class:"status-block status-success"},ke={key:1,class:"status-block status-warning"},ge={__name:"select-wechat-app",props:{title:{type:String,default:"选择公众号"},okText:{type:String,default:"确 定"},disabledAppIds:{type:Array,default:()=>[]}},emits:["ok"],setup(c,{expose:I,emit:S}){const E=S,_=c,F=Y();Z();const f=d(!1),m=d(!1),L=d(!1),v=d(!1),T=d({}),p=d([]),t=d([]),h=W(()=>p.value.filter(a=>!_.disabledAppIds.includes(a.app_id)));function M(a,e){T.value=a,t.value=Array.isArray(e)?e:[],O(),f.value=!0}function N(){f.value=!1}function O(){m.value=!0,Q({app_type:"official_account",app_name:""}).then(a=>{p.value=a.data||[]}).finally(()=>{m.value=!1})}function R(){let a=p.value.filter(e=>t.value.includes(e.app_id));E("ok",B(t.value),B(a))}function y(){const a=F.resolve({path:"/user/official-account"});window.open(a.href,"_blank")}function U(a){if(_.disabledAppIds.includes(a.app_id))return;let e=t.value.indexOf(a.app_id);e>-1?t.value.splice(e,1):t.value.push(a.app_id),b()}function b(){j(()=>{v.value=t.value.length===h.value.length})}function V(){v.value?(t.value=[],p.value.map(a=>{_.disabledAppIds.includes(a.app_id)||t.value.push(a.app_id)})):t.value=[]}return I({open:M,close:N}),(a,e)=>{const z=ee,x=ae,D=le,C=oe,G=ne;return o(),k(G,{open:f.value,"onUpdate:open":e[3]||(e[3]=s=>f.value=s),title:c.title,"confirm-loading":L.value,width:"626px"},{footer:n(()=>[i(C,{type:"primary",disabled:!t.value.length,onClick:R},{default:n(()=>[u(g(c.okText),1)]),_:1},8,["disabled"])]),default:n(()=>[$(a.$slots,"alert",{},()=>[i(z,{type:"info",class:"zm-alert-info mt12"},{message:n(()=>[e[4]||(e[4]=u(" 公众号列表数据来源：系统管理>公众号管理。",-1)),l("a",{onClick:y},"前往编辑公众号、添加公众号")]),_:1})],!0),m.value?(o(),k(q,{key:0,style:{margin:"10vh 0"}})):p.value.length?(o(),r(w,{key:1},[l("div",ie,[i(x,{checked:v.value,"onUpdate:checked":e[0]||(e[0]=s=>v.value=s),disabled:!h.value.length,onChange:V},{default:n(()=>[...e[5]||(e[5]=[u("全选 ",-1)])]),_:1},8,["checked","disabled"])]),i(D,{value:t.value,"onUpdate:value":e[2]||(e[2]=s=>t.value=s)},{default:n(()=>[l("div",de,[(o(!0),r(w,null,J(p.value,s=>(o(),r("div",{key:s.id,class:K(["wechat-app-item",{disabled:c.disabledAppIds.includes(s.app_id)}]),onClick:he=>U(s)},[l("div",ue,[l("img",{class:"app-avatar",src:s.app_avatar,alt:""},null,8,ce),l("div",re,[l("div",fe,g(s.app_name),1),l("div",ve,"Appid："+g(s.app_id),1)])]),l("div",_e,[s.account_is_verify=="true"?(o(),r("div",me,[i(A(se)),e[6]||(e[6]=u(" 已认证 ",-1))])):(o(),r("div",ke,[i(A(te)),e[7]||(e[7]=u(" 未认证 ",-1))])),l("span",{onClick:e[1]||(e[1]=P(()=>{},["stop"]))},[i(x,{value:s.app_id,disabled:c.disabledAppIds.includes(s.app_id),onChange:b},null,8,["value","disabled"])])])],10,pe))),128))])]),_:1},8,["value"])],64)):(o(),k(H,{key:2,title:"暂未绑定公众号"},{desc:n(()=>[i(C,{type:"primary",onClick:y},{default:n(()=>[...e[8]||(e[8]=[u("绑定公众号",-1)])]),_:1})]),_:1}))]),_:3},8,["open","title","confirm-loading"])}}},Be=X(ge,[["__scopeId","data-v-9050b303"]]);export{Be as S};
