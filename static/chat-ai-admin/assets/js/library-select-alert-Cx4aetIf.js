import{_ as J}from"./cu-scroll-BmJNJRCz.js";import{_ as P,B as Q,ah as X}from"../../index-C1Xsov4S.js";import{u as Z}from"./robot-4RO1uura.js";import{I as ee,Y as te,k as se,B as oe,aw as ae,ai as ne,O as le,M as ie,a as ce}from"./ui-antd-D64OvTpt.js";import{r as re,f as d,e as de,a1 as _e,_ as n,a2 as l,a5 as s,k as a,u as x,Y as r,F as B,ab as S,ac as L,a7 as h,G as v,ae as g}from"./vue-chunks-DCKTEHpB.js";const ue={class:"library-checkbox-box"},pe={class:"list-group-box"},he={class:"group-list-box"},ve={style:{"margin-bottom":"16px"}},fe={class:"classify-box"},ye=["onClick"],be={class:"classify-title"},ge={class:"right-content"},ke={class:"list-item-box"},me={class:"alert-box"},xe={class:"btn-box"},Le=["onClick"],Ce={class:"avatar-box"},we=["src"],Be={class:"info-content-box"},Se={class:"title-info-block"},Ne={key:0,class:"type-tag"},Ge={key:1,class:"type-tag"},Ie={key:2,class:"type-tag"},Oe={key:3,class:"type-tag"},Ve={class:"desc-info-block"},Ae={class:"check-block"},Re={class:"footer-box"},Te={__name:"library-select-alert",props:{showWxType:{type:Boolean,default:!1}},emits:["change"],setup(N,{expose:G,emit:I}){const O=Z(),{robotInfo:C}=O,V=I,A=N,i=re({indeterminate:!1,checkAll:!1,checkedList:[]}),_=d(""),w=d([]),R=()=>{X().then(o=>{let e=o.data||[],c=0;e.forEach(y=>{c+=+y.total}),w.value=[{group_name:"全部",total:c,id:""},...e]})},T=o=>{_.value=o.id,f()},u=d(!1),$=o=>{_.value="",f(),R(),i.checkedList=o,u.value=!0},z=()=>{u.value=!1,M()},k=d(""),E=()=>{f()},m=d([]),F=de(()=>A.showWxType?m.value:m.value.filter(o=>o.type!=3)),M=()=>{V("change",[...i.checkedList])},f=async()=>{p.value=!0;const o=await Q({library_name:k.value,type:"",show_open_docs:1});if(p.value=!1,o){let e=o.data||[];_.value!=""&&(e=e.filter(c=>c.group_id==_.value)),m.value=e}},U=o=>{let e=o.id;C.default_library_id!=e&&(i.checkedList.includes(e)?i.checkedList=i.checkedList.filter(c=>c!=e):i.checkedList.push(e))},p=d(!1),W=async()=>{p.value=!0,await f(),p.value=!1,ce.success("刷新完成")},Y=()=>{window.open("/#/library/list")};return G({open:$}),(o,e)=>{const c=ee,y=J,D=se,b=oe,K=le,j=ne,q=ie;return n(),_e(q,{width:916,open:u.value,"onUpdate:open":e[2]||(e[2]=t=>u.value=t),wrapClassName:"correlation-library-modal",title:null,footer:null},{default:l(()=>[s("div",ue,[s("div",pe,[s("div",he,[e[3]||(e[3]=s("div",{class:"main-title-block"},"关联知识库",-1)),s("div",ve,[a(c,{style:{width:"216px"},value:k.value,"onUpdate:value":e[0]||(e[0]=t=>k.value=t),placeholder:"请输入知识库名称搜索",onChange:E},{suffix:l(()=>[a(x(te),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),a(y,{style:{"padding-right":"16px",height:"480px"}},{default:l(()=>[s("div",fe,[(n(!0),r(B,null,S(w.value,t=>(n(),r("div",{class:L(["classify-item",{active:t.id==_.value}]),onClick:H=>T(t),key:t.id},[s("div",be,h(t.group_name),1),s("div",ge,[s("div",{class:L(["num",{"num-block":t.id<=0}])},h(t.total),3)])],10,ye))),128))])]),_:1})]),s("div",ke,[s("div",me,[a(D,{class:"zm-alert-info",message:"请选择关联知识库，机器人会根据知识库内上传的文档回复用户的提问。每个机器人最多关联5个知识库",type:"info"})]),s("div",xe,[a(b,{onClick:W},{default:l(()=>[a(x(ae)),e[4]||(e[4]=v(" 刷新 ",-1))]),_:1}),a(b,{type:"primary",ghost:"",onClick:Y},{default:l(()=>[...e[5]||(e[5]=[v("新建知识库",-1)])]),_:1})]),a(j,{spinning:p.value,delay:100},{default:l(()=>[a(y,{style:{padding:"0 16px",height:"414px"}},{default:l(()=>[(n(!0),r(B,null,S(F.value,t=>(n(),r("div",{class:"library-list-item",onClick:H=>U(t),key:t.id},[s("div",Ce,[s("img",{src:t.avatar,alt:""},null,8,we)]),s("div",Be,[s("div",Se,[v(h(t.library_name)+" ",1),s("span",{class:L(["type-tag",{"gray-tag":t.graph_switch==0}])},"Graph",2),t.type==0?(n(),r("span",Ne,"普通知识库")):g("",!0),t.type==1?(n(),r("span",Ge,"对外知识库")):g("",!0),t.type==2?(n(),r("span",Ie,"问答知识库")):g("",!0),t.type==3?(n(),r("span",Oe,"公众号知识库")):g("",!0)]),s("div",Ve,h(t.library_intro),1)]),s("div",Ae,[a(K,{disabled:x(C).default_library_id==t.id,checked:i.checkedList.includes(t.id)},null,8,["disabled","checked"])])],8,Le))),128))]),_:1})]),_:1},8,["spinning"]),s("div",Re,[a(b,{onClick:e[1]||(e[1]=t=>u.value=!1)},{default:l(()=>[...e[6]||(e[6]=[v("取消",-1)])]),_:1}),a(b,{type:"primary",onClick:z},{default:l(()=>[v(" ("+h(i.checkedList.length)+") 确定",1)]),_:1})])])])])]),_:1},8,["open"])}}},Ue=P(Te,[["__scopeId","data-v-d140cbb5"]]);export{Ue as L};
