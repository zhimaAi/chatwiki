import{b as le,d as ie}from"../../index-ZzVqUZIR.js";import{f as l,w as ce,o as re,ab as ue,aa as pe,b as de,y as _e,Y as u,ae as N,a5 as n,k as i,F as g,a2 as c,ad as z,a1 as O,a9 as ve,af as me,_ as r,G as d,a7 as U,ah as fe,u as ye}from"./vue-chunks-yZ4gwLzA.js";import{a as V,x as G}from"./index-CT0SjT0W.js";import{e as be}from"./index-BT8AeJHF.js";import{L as ge}from"./list-empty-CgSZ-k0P.js";import{H as ke,ah as he,B as xe,y as we,k as Ce,M as W,N as Ae,a5 as Se,a as F}from"./ui-antd-BJtyvQX6.js";import"./utils-smNh_pj2.js";const Ie={key:0,class:"ability-banner"},Be={class:"user-model-page"},De={class:"breadcrumb-wrap"},Te={key:0,class:"loading-box"},Ee={key:0,class:"empty-wrap"},Me={class:"empty-actions"},Re={class:"mp-list-block"},Le=["onClick"],Ne=["src"],ze={class:"mp-name"},Oe={class:"tabs-box"},Ue={class:"list-wrapper"},Ve={class:"content-wrapper"},Ge={class:"enable-tip-footer"},We={class:"footer-actions"},Fe=160,He=8,Ke=96,H="article_group_send_ai_comment_tip_until",$e={__name:"index",setup(Ye){const k=ue(),p=pe(),K=[{label:"群发管理",value:"group-send"},{label:"草稿箱",value:"draft-box"}],D=()=>k.name==="exploreArticleGroupSendDraftBox"?"draft-box":"group-send",T=()=>{p.options.history.state.back?p.back():p.push({path:"/explore/index"})},h=l(D()),f=l(!1),$=()=>{V({ability_type:"official_account_batch_send"}).then(t=>{var a;const e=t.data,s=(a=e==null?void 0:e.user_config)==null?void 0:a.switch_status;f.value=String(s||"0")==="1"})},x=l(!0),Y=()=>{V({ability_type:"official_account_ai_comment"}).then(t=>{var s,a;const e=(a=(s=t==null?void 0:t.data)==null?void 0:s.user_config)==null?void 0:a.switch_status;x.value=String(e||"0")==="1",X()})},E=()=>{L();const t=p.resolve({path:"/explore/index"});window.open(t.href,"_blank")},j=t=>{const e=t?"1":"0";if(e==="0"){W.confirm({title:"提示",content:"关闭后，该功能默认关闭不再支持使用，确认关闭？",onOk:()=>{G({ability_type:"official_account_batch_send",switch_status:e}).then(s=>{s&&s.res==0&&(f.value=!1,F.success("操作成功"))})}});return}G({ability_type:"official_account_batch_send",switch_status:e}).then(s=>{s&&s.res==0&&(f.value=!0,F.success("操作成功"))})};ce(()=>k.name,()=>{h.value=D()});const q=t=>{const e={"group-send":"/explore/index/article-group-send/group-send","draft-box":"/explore/index/article-group-send/draft-box"};p.replace(e[t])};re(()=>{k.name==="exploreArticleGroupSend"&&p.replace("/explore/index/article-group-send/group-send"),P(),$(),Y()}),de(()=>{window.removeEventListener("resize",I)});const w=l(!0),M=l([]),C=l(""),A=l(""),_=l([]),S=l(""),v=l(!1),R=l(null),m=l(0);function I(){const t=R.value;if(!t){m.value=0;return}const e=t.clientWidth||0,s=Fe+He,a=Math.floor((e-Ke)/s);m.value=Math.max(a,0)}const P=()=>{w.value=!0,be({app_type:"official_account"}).then(t=>{const e=t.data||[];M.value=e,_.value=e.map(a=>({id:a.id,appid:a.app_id,name:a.app_name,logo:a.app_avatar,access_key:a.access_key}));const s=_.value[0];s&&(S.value=s.appid,C.value=s.appid,A.value=s.access_key)}).finally(()=>{w.value=!1,_e(I),window.addEventListener("resize",I)})};function J(t){S.value=t.appid,v.value=!0,C.value=t.appid,A.value=t.access_key}const Q=()=>{const t=p.resolve({path:"/user/official-account"});window.open(t.href,"_blank")},y=l(!1),B=l(!1),X=()=>{const t=Number(localStorage.getItem(H)||0),e=Date.now();!x.value&&t<=e&&(y.value=!0)},L=()=>{if(B.value){const t=Date.now()+2592e5;localStorage.setItem(H,String(t))}},Z=()=>{L(),y.value=!1};return(t,e)=>{const s=ie,a=ke,ee=he,b=xe,te=we,ne=Ce,se=me("router-view"),ae=Ae,oe=W;return r(),u(g,null,[x.value?N("",!0):(r(),u("div",Ie,[i(s,{name:"tip-icon",style:{"font-size":"16px",color:"white"}}),e[4]||(e[4]=n("span",null,"AI评论精选功能暂未开启，您可到探索 > 功能 > AI评论精选开启",-1)),n("a",{class:"go-enable",href:"javascript:void(0);",onClick:E},"去开启")])),n("div",Be,[n("div",De,[i(s,{onClick:T,name:"back",style:{"font-size":"20px"}}),n("span",{onClick:T,class:"breadcrumb-title"},"文章群发"),i(a,{checked:f.value,"checked-children":"开","un-checked-children":"关",onChange:j},null,8,["checked"]),e[5]||(e[5]=n("span",{class:"switch-tip"},"开启后，用户可以在文章管理中群发文章给公众号用户，该群发支持使用AI评论精选功能自动删评，回复，精选评论。",-1))]),w.value?(r(),u("div",Te,[i(ee)])):(r(),u(g,{key:1},[M.value.length===0?(r(),u("div",Ee,[i(ge,{size:"180"},{default:c(()=>[...e[6]||(e[6]=[n("div",{class:"empty-default"},"暂未绑定公众号",-1),n("div",{class:"empty-sub"},"请选到系统设置>公众号管理绑定公众号",-1)])]),_:1}),n("div",Me,[i(b,{type:"primary",onClick:Q},{default:c(()=>[...e[7]||(e[7]=[d("去绑定公众号",-1)])]),_:1})])])):(r(),u(g,{key:1},[n("div",Re,[n("div",{class:z(["mp-list",{expanded:v.value}]),ref_key:"mpListRef",ref:R},[(r(!0),u(g,null,ve(v.value?_.value:_.value.slice(0,m.value),o=>(r(),u("div",{class:z(["mp-card",{selected:o.appid===S.value}]),key:o.id,onClick:je=>J(o)},[n("img",{src:o.logo,class:"mp-logo"},null,8,Ne),n("span",ze,U(o.name),1)],10,Le))),128)),!v.value&&_.value.length>m.value?(r(),O(b,{key:0,type:"dashed",class:"more-btn",onClick:e[0]||(e[0]=o=>v.value=!0)},{default:c(()=>[d(" 更多 +"+U(_.value.length-m.value),1)]),_:1})):N("",!0)],2)]),n("div",Oe,[i(te,{value:h.value,"onUpdate:value":e[1]||(e[1]=o=>h.value=o),options:K,onChange:q},null,8,["value"])]),i(ne,{class:"alert-box",style:{margin:"16px 48px 0"}},{message:c(()=>[...e[8]||(e[8]=[n("div",null,"1. 本功能仅限认证的公众号。支持同步微信公众后台未发布的草稿箱。",-1),n("div",null,"2. 群发的内容不会显示在文章管理内。请注意群发和已发布的区别。",-1)])]),_:1}),n("div",Ue,[n("div",Ve,[i(se,null,{default:c(({Component:o})=>[(r(),O(fe(o),{"app-id":C.value,"access-key":A.value},null,8,["app-id","access-key"]))]),_:1})])])],64))],64))]),i(oe,{open:y.value,"onUpdate:open":e[3]||(e[3]=o=>y.value=o),footer:null},{title:c(()=>[n("span",null,[i(ye(Se),{style:{color:"#faad14","margin-right":"8px"}}),e[9]||(e[9]=d("未开启AI评论精选",-1))])]),default:c(()=>[e[13]||(e[13]=n("div",null,[n("span",{style:{color:"red"}},"AI评论精选功能暂未开启"),d("，您可到探索 > 功能 > AI评论精选开启")],-1)),n("div",Ge,[i(ae,{checked:B.value,"onUpdate:checked":e[2]||(e[2]=o=>B.value=o)},{default:c(()=>[...e[10]||(e[10]=[d("3天内不在提示",-1)])]),_:1},8,["checked"]),n("div",We,[i(b,{onClick:Z},{default:c(()=>[...e[11]||(e[11]=[d("取消",-1)])]),_:1}),i(b,{type:"primary",onClick:E},{default:c(()=>[...e[12]||(e[12]=[d("去开启",-1)])]),_:1})])])]),_:1},8,["open"])],64)}}},tt=le($e,[["__scopeId","data-v-005e3f90"]]);export{tt as default};
