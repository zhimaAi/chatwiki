import{_ as T}from"./cu-scroll-ufyFyI_5.js";import{_ as F}from"./empty-DkpCLaix.js";import{d as p,S as k,O as i,U as _,N as d,a6 as C,X as e,j as m,_ as v,F as w,a1 as $,u as N,a3 as O,q as P,z as V,Z as q}from"./vue-chunks-BRsu9_To.js";import{b as B,ac as E,f as D,M as j,h as G,dF as z,B as K,dG as X,k as Z}from"../../index-CzPebXix.js";import{C as H,_ as J}from"./index-DLRiQ5Ho.js";import{g as Q}from"./index-jmRHMddk.js";import{P as W}from"./PlusOutlined-BlmIiILr.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Checkbox-oqMTsvET.js";import"./FormItemContext-B2RmG14m.js";import"./index-BhHQj-ne.js";const Y={key:0,class:"form-wrapper"},tt={class:"select"},et={class:"tools-wrapper"},ot=["src"],st={class:"item-name"},at={key:1,class:"form-wrapper"},lt={class:"select"},nt={class:"tools-wrapper"},it={class:"item-name"},rt={key:2,class:"form-wrapper"},ct={class:"select"},dt={class:"tools-wrapper"},ut={class:"item-name"},_t={key:3,class:"empty-box"},vt={__name:"see-model-alert",props:{robotList:{type:Array,default:null},libraryList:{type:Array,default:null},formList:{type:Array,default:null},currentTitle:{type:String,default:"关联机器人"}},emits:["save"],setup(L,{expose:x,emit:y}){const g=E.PRESENTED_IMAGE_SIMPLE,I=y,f=L,o=p([]),c=p(""),{t:S}=D(),b=p(!1),u=p([]),h=a=>{const t=[];return a.map(n=>{t.push(n.id)}),t},R=(a,t,n)=>{o.value=[],c.value=a,c.value==="robot"?(u.value=f.robotList,t&&t==="edit"&&n&&(o.value=h(n.managed_robot_list))):c.value==="library"?(u.value=f.libraryList,t&&t==="edit"&&n&&(o.value=h(n.managed_library_list))):c.value==="form"&&(u.value=f.formList,t&&t==="edit"&&n&&(o.value=h(n.managed_form_list))),b.value=!0},A=()=>{b.value=!1,u.value.length&&I("save",o.value)},r=()=>{};return x({open:R}),(a,t)=>{const n=H,l=J,M=E,U=j;return i(),k(U,{class:"add-model-alert",width:"800px",open:b.value,"onUpdate:open":t[3]||(t[3]=s=>b.value=s),title:L.currentTitle,onOk:A,onCancel:r},{default:_(()=>[c.value==="robot"?(i(),d("div",Y,[e("div",tt," 已选择("+v(o.value.length)+") ",1),m(l,{class:"list-box",value:o.value,"onUpdate:value":t[0]||(t[0]=s=>o.value=s)},{default:_(()=>[(i(!0),d(w,null,$(u.value,s=>(i(),k(n,{class:"list-item",key:s.id,value:s.id},{default:_(()=>[e("div",et,[e("img",{class:"model-logo",src:s.robot_avatar,alt:""},null,8,ot),e("div",st,v(s.robot_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="library"?(i(),d("div",at,[e("div",lt," 已选择("+v(o.value.length)+") ",1),m(l,{class:"list-box",value:o.value,"onUpdate:value":t[1]||(t[1]=s=>o.value=s)},{default:_(()=>[(i(!0),d(w,null,$(u.value,s=>(i(),k(n,{class:"list-item",key:s.id,value:s.id},{default:_(()=>[e("div",nt,[e("div",it,v(s.library_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="form"?(i(),d("div",rt,[e("div",ct," 已选择("+v(o.value.length)+") ",1),m(l,{class:"list-box",value:o.value,"onUpdate:value":t[2]||(t[2]=s=>o.value=s)},{default:_(()=>[(i(!0),d(w,null,$(u.value,s=>(i(),k(n,{class:"list-item",key:s.id,value:s.id},{default:_(()=>[e("div",dt,[e("div",ut,v(s.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):C("",!0),u.value.length?C("",!0):(i(),d("div",_t,[m(M,{image:N(g)},null,8,["image"])]))]),_:1},8,["open","title"])}}},pt=B(vt,[["__scopeId","data-v-a5d4de58"]]),mt={class:"robot-page"},ft={class:"associated-robot"},bt={class:"associated-robot-title"},ht={class:"list-box"},yt=["onClick"],gt={class:"list-item"},kt={class:"robot-info"},wt=["src"],$t={class:"robot-info-content"},Lt={class:"robot-name"},xt={class:"robot-type-tag"},St={class:"robot-desc"},Rt={key:0,class:"empty-box"},At={__name:"related-robots",setup(L){const x=G(),y=p(null),g=p([]),f=O().query,o=p([]),c=p(!1),S=()=>{c.value=!0,z({id:f.id}).then(r=>{o.value=r.data||[],x.setRobotNums(o.value.length)}).finally(()=>{c.value=!1})};P(()=>{S()}),V({managed_robot_list:[]});const b=async()=>{await h(),y.value.open("robot")},u=(r,a)=>{const t=new Set(a.map(l=>l.id));return r.filter(l=>l.application_type==="0").filter(l=>!t.has(l.id))},h=async()=>{await Q().then(r=>{g.value=u(r.data,o.value)}).catch(()=>{})},R=r=>{let a={library_id:f.id,robot_ids:r.join(",")};X(a).then(t=>{Z.success("操作成功"),S()}).catch(()=>{})},A=({id:r,robot_key:a,application_type:t})=>{t==0?window.open(`#/robot/config/basic-config?id=${r}&robot_key=${a}`):window.open(`#/robot/config/workflow?id=${r}&robot_key=${a}`)};return(r,a)=>{const t=K,n=T;return i(),d("div",mt,[m(n,null,{default:_(()=>[e("div",ft,[e("div",bt,"已关联机器人 ("+v(o.value.length)+")",1),m(t,{type:"primary",onClick:b},{icon:_(()=>[m(N(W))]),default:_(()=>[a[0]||(a[0]=q(" 关联机器人 "))]),_:1,__:[0]})]),e("div",ht,[(i(!0),d(w,null,$(o.value,l=>(i(),d("div",{class:"list-item-wrapper",key:l.id,onClick:M=>A(l)},[e("div",gt,[e("div",kt,[e("img",{class:"robot-avatar",src:l.robot_avatar,alt:""},null,8,wt),e("div",$t,[e("div",Lt,v(l.robot_name),1),e("div",xt,v(l.application_type==0?"聊天机器人":"工作流"),1)])]),e("div",St,v(l.robot_intro),1)])],8,yt))),128))]),o.value.length==0&&!c.value?(i(),d("div",Rt,a[1]||(a[1]=[e("img",{src:F,alt:""},null,-1),e("div",{class:"title"},"暂无数据",-1)]))):C("",!0)]),_:1}),m(pt,{ref_key:"seeModelAlertRef",ref:y,currentTitle:"关联机器人",robotList:g.value,onSave:R},null,8,["robotList"])])}}},zt=B(At,[["__scopeId","data-v-bd91d8b6"]]);export{zt as default};
