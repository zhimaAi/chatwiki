import{_ as T}from"./cu-scroll-CeyRYmkN.js";import{ab as Y,f as x,r as v,o as O,b as U,Y as i,k as d,a2 as p,J as q,aa as E,_ as n,a5 as c,u as J,ae as u,a1 as N,a7 as y,F as b}from"./vue-chunks-yZ4gwLzA.js";import{d as V,k as H,I as j,X as K,x as P,J as Q,M as w,a as z}from"./ui-antd-BJtyvQX6.js";import{b as X,h as A,bv as G,au as W,bw as Z,bx as ee}from"../../index-ZzVqUZIR.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./utils-smNh_pj2.js";const te={class:"details-library-page"},ae={class:"list-tools"},se={class:"tools-items"},ne={class:"list-content"},oe={key:0,class:"doc-name-td"},ie=["onClick"],le={key:0},ce={key:1},_e={key:0},re={key:1},de=["onClick"],pe=["onClick"],ue={__name:"recycle-bin-record",setup(me){const C=A(),S=Y();E();const m=S.query,f=x(!1);v({selectedRowKeys:[]});const h=x([]),t=v({library_id:m.id,file_name:void 0,page:1,size:10,total:0}),I=[{title:"文档名称",dataIndex:"file_name",key:"file_name",width:300},{title:"文档格式",dataIndex:"file_ext",key:"file_ext",width:100},{title:"文档大小",dataIndex:"file_size_str",key:"file_size",width:100},{title:"分段",dataIndex:"paragraph_count",key:"paragraph_count",width:120},{title:"删除时间",dataIndex:"delete_time",key:"delete_time",width:150},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:100}],R=e=>{t.page=e.current,t.size=e.pageSize,r()},g=()=>{t.page=1,r()},r=()=>{let e=q(t);f.value=!0,G(e).then(a=>{let o=a.data.list||[];o.forEach(l=>{l.file_size_str=W(l.file_size),l.delete_time=l.delete_time>0?V(l.delete_time*1e3).format("YYYY-MM-DD HH:mm"):"--"}),h.value=o,t.total=+a.data.total||0}).finally(()=>{f.value=!1})},F=e=>{let a=`/manage/downloadLibraryFile?id=${e.id}&token=${C.getToken}`;var o=document.createElement("a");o.href=a,o.style.display="none",o.click()},L=e=>{w.confirm({title:"恢复确认？",content:`确认恢复该文档【${e.file_name}】`,okText:"确定",onOk(){Z({id:e.id}).then(a=>{z.success("恢复成功"),r()})}})},D=e=>{w.confirm({title:"彻底删除确认？",content:"文件删除后无法恢复，请确认是否删除?",okText:"确定",onOk(){ee({id:e.id}).then(a=>{z.success("删除成功"),r()})}})};return O(()=>{m.page&&(t.page=+m.page),r()}),U(()=>{}),(e,a)=>{const o=H,l=j,$=Q,B=P,M=T;return n(),i("div",te,[d(M,{scrollbar:!1},{default:p(()=>[d(o,{"show-icon":"",message:"回收站内的文档依然占用账户资源，请及时清理无用数据"}),c("div",ae,[c("div",se,[d(l,{style:{width:"282px"},value:t.file_name,"onUpdate:value":a[0]||(a[0]=_=>t.file_name=_),placeholder:"请输入文档名称搜索",onChange:g},{suffix:p(()=>[d(J(K),{onClick:g,style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])]),c("div",ne,[d(B,{columns:I,"data-source":h.value,scroll:{x:1e3},loading:f.value,"row-key":"id",pagination:{current:t.page,total:t.total,pageSize:t.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:R},{bodyCell:p(({column:_,record:s})=>[_.key==="file_name"?(n(),i("div",oe,[c("span",null,y(s.file_name),1),c("a",{style:{"margin-left":"2px"},onClick:k=>F(s)},"下载",8,ie)])):u("",!0),_.key==="file_size"?(n(),i(b,{key:1},[s.doc_type==3?(n(),i("span",le,"-")):(n(),i("span",ce,y(s.file_size_str),1))],64)):u("",!0),_.key==="paragraph_count"?(n(),i(b,{key:2},[s.status==0||s.status==1?(n(),i("span",_e,"-")):(n(),i("span",re,y(s.paragraph_count),1))],64)):u("",!0),_.key==="action"?(n(),N($,{key:3,gap:12},{default:p(()=>[c("a",{onClick:k=>L(s)},"恢复",8,de),c("a",{onClick:k=>D(s)},"删除",8,pe)]),_:2},1024)):u("",!0)]),_:1},8,["data-source","loading","pagination"])])]),_:1})])}}},be=X(ue,[["__scopeId","data-v-5305e81e"]]);export{be as default};
