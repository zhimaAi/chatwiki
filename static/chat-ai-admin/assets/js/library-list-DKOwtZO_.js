import{_ as Ee}from"./cu-scroll-D9utH_KS.js";import{_ as le,b as _e,a as qe,ab as He,ac as De,d as we,bj as Ze,aw as he,ax as fe,bk as Pe,bl as je,bm as Je,ah as Ie,aN as Ke,f as Qe,A as Ae,av as We,bn as Ye,aR as Xe,bo as et,bp as tt,bq as at}from"../../index-CB2DywzJ.js";import{e as me,ac as k,ad as u,ae as R,F as P,ax as Ue,as as n,az as O,at as r,u as a,k as t,ar as s,G as p,B as E,f as g,r as $e,o as lt,n as se,A as ie,ai as J,y as nt,av as Ge,aw as ot}from"./vue-chunks-CGLjTDrY.js";import{E as st}from"./empty-box-B-T70UNv.js";import{v as Le,h as Te,i as Re,k as Be,R as xe,M as ae,b as H,F as it,e as _t,I as Ne,$ as rt,y as Fe,z as Ve,Q as dt,aK as ct,ac as ut,ah as ee,T as pt,O as ht,w as ft,x as mt,B as vt,a6 as Oe,ar as gt,aE as yt,W as Se}from"./ui-antd-BHaxN-GS.js";import{A as kt}from"./avatar-input-h7rB0CZi.js";import{t as bt}from"./validate-8MtiUsxW.js";import{M as be}from"./model-select-h2ELC74y.js";import{O as Ct}from"./open-grapg-modal-CQIAWCLM.js";import{P as xt}from"./page-tabs-B6pKMLdc.js";import{_ as wt}from"./page-alert-DcOtfX2y.js";import{L as $t}from"./list-tabs-CTUWZo1P.js";import{d as Lt}from"./vuedraggable.umd-B2hsG2dX.js";import{a as Mt}from"./index-CtAQivSJ.js";import{S as zt}from"./select-wechat-app-C2zWoXl9.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./neo4j-CSfpjqgw.js";import"./utils-pAinW4BS.js";import"./other-BrZCAsTs.js";import"./empty-BFmzY9bl.js";import"./index-BcMVDew1.js";import"./vue-pdf-embed-Bj6uRJ-9.js";import"./loading-box-CNnW6NDo.js";import"./index-CoChppVN.js";const At="data:image/svg+xml,%3csvg%20width='62'%20height='62'%20viewBox='0%200%2062%2062'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0%2016C0%207.16344%207.16344%200%2016%200H46C54.8366%200%2062%207.16344%2062%2016V46C62%2054.8366%2054.8366%2062%2046%2062H16C7.16344%2062%200%2054.8366%200%2046V16Z'%20fill='%2321A665'/%3e%3cg%20filter='url(%23filter0_d_11589_11828)'%3e%3cpath%20d='M17.5418%2041.2916C17.5418%2035.1931%2017.5418%2020.7083%2017.5418%2020.7083C17.5418%2018.0849%2019.6685%2015.9583%2022.2918%2015.9583H39.7085V36.5416C39.7085%2036.5416%2026.4343%2036.5416%2022.2918%2036.5416C19.6793%2036.5416%2017.5418%2038.6666%2017.5418%2041.2916Z'%20fill='white'%20stroke='white'%20stroke-width='3.16667'%20stroke-linejoin='round'/%3e%3cpath%20d='M39.7085%2036.5417C39.7085%2036.5417%2023.2052%2036.5417%2022.2918%2036.5417C19.6685%2036.5417%2017.5418%2038.6684%2017.5418%2041.2917C17.5418%2043.9151%2019.6685%2046.0417%2022.2918%2046.0417C24.0407%2046.0417%2032.4852%2046.0417%2044.4585%2046.0417V17.5417'%20stroke='white'%20stroke-width='3.16667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M23.0832%2041.2917H38.9165'%20stroke='white'%20stroke-width='3.16667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M34.1961%2020.5428C33.3496%2018.8498%2031.2939%2017.2778%2028.7545%2017.2778C27.5453%2017.2778%2025.6105%2017.7615%2024.1595%2019.5754C23.0712%2020.6637%2022.8293%2022.1148%2022.9502%2023.4449C23.0712%2024.4123%2023.6758%2025.6215%2024.4013%2026.468C24.6432%2024.4123%2025.7315%2022.8403%2027.1825%2021.752C29.601%2019.8172%2032.2613%2019.9381%2034.1961%2020.5428Z'%20fill='%2321A665'/%3e%3cpath%20d='M36.2518%2023.5658C34.6798%2021.631%2032.1404%2021.0264%2029.722%2021.8729C29.8429%2021.8729%2029.8429%2021.8729%2029.9638%2021.9938C33.4706%2023.2031%2035.4054%2027.0726%2034.1961%2030.5794C33.8334%2031.5467%2033.3497%2032.3932%2032.7451%2032.9978C33.4706%2032.756%2034.3171%2032.5141%2034.9217%2032.0304C37.582%2029.8538%2038.0657%2026.1052%2036.2518%2023.5658Z'%20fill='%2321A665'/%3e%3cpath%20d='M28.7546%2029.8538C28.2709%2029.8538%2027.6663%2029.7329%2027.1826%2029.7329H26.9407C26.8198%2029.7329%2026.6989%2029.7329%2026.578%2029.8538L24.885%2030.9422H24.7641C24.6432%2030.9422%2024.5223%2030.8212%2024.5223%2030.7003V30.4585C24.5223%2030.4585%2024.7641%2029.612%2024.7641%2029.1283V29.0074C24.7641%2028.8865%2024.6432%2028.6446%2024.5223%2028.6446C22.8293%2027.4354%2021.6201%2025.6215%2021.3783%2023.6868C21.0155%2024.4123%2020.8946%2024.896%2020.6527%2025.7425C19.8063%2028.7655%2021.6201%2032.2723%2024.6432%2033.2397C28.15%2034.328%2031.4149%2033.1188%2032.6241%2030.0957C32.745%2029.7329%2032.866%2029.1283%2032.9869%2028.6446C31.7776%2029.4911%2030.4475%2029.8538%2028.7546%2029.8538Z'%20fill='%2321A665'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_11589_11828'%20x='8'%20y='12'%20width='46'%20height='46'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='4'/%3e%3cfeGaussianBlur%20stdDeviation='2'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.0886636%200%200%200%200%200.202211%200%200%200%200%200.413084%200%200%200%200.14%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_11589_11828'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_11589_11828'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",Ot={class:"list-box"},St=["onClick"],qt={class:"library-type"},It={key:0,class:"type-box"},Ut={key:1,class:"type-box"},Gt={key:2,class:"type-box"},Tt={key:3,class:"type-box"},Rt={class:"library-info"},Bt={class:"library-icon"},Nt=["src"],Ft={key:0,class:"sync-tag run"},Vt={key:1,class:"sync-tag fail"},Et={class:"library-info-content"},Ht={class:"library-title"},Dt={class:"item-body"},Zt={class:"item-footer"},Pt={class:"library-size"},jt={class:"text-item"},Jt={class:"text-item"},Kt={class:"text-item"},Qt=["onClick"],Wt=["onClick"],Yt={__name:"index",props:{list:{type:Array,default:()=>[]}},emits:["add","edit","delete","openEditGroupModal"],setup(te,{emit:d}){const o=d,{t:m}=_e("views.library.library-list.components.library-list.index"),S=qe();me(()=>{var b;return((b=S.companyInfo)==null?void 0:b.neo4j_status)=="true"});const z=te,x=b=>{o("edit",b)},q=b=>{o("delete",b)},A=b=>{o("openEditGroupModal",b)};return(b,e)=>{const h=Le,C=we,$=Re,w=Te,U=Be;return u(),k("div",Ot,[z.list.length?(u(!0),k(P,{key:0},Ue(z.list,f=>(u(),k("div",{class:"list-item-wrapper",key:f.id},[n("div",{class:"list-item",onClick:E(T=>x(f),["stop"])},[n("div",qt,[f.type==0?(u(),k("span",It,r(a(m)("normal_knowledge_base")),1)):O("",!0),f.type==1?(u(),k("span",Ut,r(a(m)("external_knowledge_base")),1)):O("",!0),f.type==2?(u(),k("span",Gt,r(a(m)("qa_knowledge_base")),1)):O("",!0),f.type==3?(u(),k("span",Tt,r(a(m)("official_account_knowledge_base")),1)):O("",!0)]),n("div",Rt,[n("div",Bt,[n("img",{src:f.avatar},null,8,Nt),f.type==3?(u(),k(P,{key:0},[f.sync_official_content_status==2?(u(),k("span",Ft,r(a(m)("syncing")),1)):f.sync_official_content_status==3?(u(),k("span",Vt,r(a(m)("sync_failed")),1)):O("",!0)],64)):O("",!0)]),n("div",Et,[n("div",Ht,r(f.library_name),1)])]),n("div",Dt,[t(h,{title:a(De)(f.library_intro,f,14,2,0),placement:"top"},{default:s(()=>[n("div",{class:"library-desc",ref_for:!0,ref:T=>a(He)(T,f)},r(f.library_intro),513)]),_:2},1032,["title"])]),n("div",Zt,[n("div",Pt,[t(h,{title:"文档数量"},{default:s(()=>[n("span",jt,[t(C,{class:"icon",name:"document-icon"}),p(" "+r(f.file_total),1)])]),_:2},1024),t(h,{title:"存储大小"},{default:s(()=>[n("span",Jt,[t(C,{class:"icon",name:"storage-icon"}),p(" "+r(f.file_size_str),1)])]),_:2},1024),t(h,{title:"关联应用"},{default:s(()=>[n("span",Kt,[t(C,{class:"icon",name:"relevance-icon"}),p(" "+r(f.robot_nums||0),1)])]),_:2},1024)]),n("div",{class:"action-box",onClick:e[1]||(e[1]=E(()=>{},["stop"]))},[t(U,null,{overlay:s(()=>[t(w,null,{default:s(()=>[t($,null,{default:s(()=>[n("a",{class:"delete-text-color",href:"javascript:;",onClick:E(T=>q(f),["stop"])},r(a(m)("delete")),9,Qt)]),_:2},1024),t($,null,{default:s(()=>[n("div",{onClick:E(T=>A(f),["stop"])},r(a(m)("modify_group")),9,Wt)]),_:2},1024)]),_:2},1024)]),default:s(()=>[n("div",{class:"action-item",onClick:e[0]||(e[0]=E(()=>{},["stop"]))},[t(C,{class:"action-icon",name:"point-h"})])]),_:2},1024)])])],8,St)]))),128)):(u(),R(st,{key:1,style:{"margin-top":"80px"}}))])}}},Xt=le(Yt,[["__scopeId","data-v-cf967f70"]]),ea="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M29.8066%2055.3034C14.0866%2051.3489%2011.0624%2045.5975%2015.5685%2027.6849C20.074%209.77234%2025.4347%206.23271%2041.1546%2010.1872C56.8746%2014.1417%2059.8378%2019.7747%2055.3323%2037.6873C50.8267%2055.5999%2045.5265%2059.2579%2029.8059%2055.3034H29.8066Z'%20fill='%232475FC'/%3e%3cpath%20d='M27.6401%2056.8699C9.97054%2056.8699%205.24487%2051.5938%205.24487%2031.46C5.24487%2011.3261%209.97054%206.15887%2027.6401%206.15887C45.3096%206.15887%2049.9398%2011.3261%2049.9398%2031.46C49.9398%2051.5938%2045.3096%2056.8699%2027.6401%2056.8699Z'%20fill='%232CAAFF'/%3e%3cpath%20d='M38.7639%2045.5143H36.8936C36.3373%2045.5143%2035.8577%2045.4677%2035.4549%2045.3743C35.052%2045.281%2034.7067%2045.1363%2034.419%2044.9403C34.1313%2044.7443%2033.8867%2044.497%2033.6853%2044.1983C33.4838%2043.8997%2033.2968%2043.5543%2033.1242%2043.1623C32.8364%2042.453%2032.5727%2041.809%2032.3329%2041.2303C32.0931%2040.6517%2031.8869%2040.1477%2031.7142%2039.7183C31.5032%2039.233%2031.3114%2038.785%2031.1388%2038.3743H23.974C23.8397%2038.8037%2023.6767%2039.2703%2023.4849%2039.7743C23.3314%2040.2037%2023.13%2040.7217%2022.8806%2041.3283C22.6312%2041.935%2022.3435%2042.593%2022.0174%2043.3023C21.6337%2044.1423%2021.1925%2044.721%2020.6938%2045.0383C20.195%2045.3557%2019.6291%2045.5143%2018.9961%2045.5143H17.0107C16.1667%2045.5143%2015.596%2045.3323%2015.2986%2044.9683C15.0013%2044.6043%2015.0253%2043.9837%2015.3706%2043.1063C15.7159%2042.2663%2016.1187%2041.277%2016.5791%2040.1383C17.0395%2038.9997%2017.5286%2037.791%2018.0466%2036.5123C18.5645%2035.2337%2019.1016%2033.9223%2019.6579%2032.5783C20.2142%2031.2343%2020.7513%2029.9183%2021.2693%2028.6303C22.497%2025.625%2023.7822%2022.4983%2025.125%2019.2503C25.2593%2018.933%2025.4319%2018.6437%2025.6429%2018.3823C25.8347%2018.177%2026.0889%2017.981%2026.4054%2017.7943C26.7219%2017.6077%2027.12%2017.5143%2027.5996%2017.5143C28.0983%2017.5143%2028.5059%2017.6123%2028.8224%2017.8083C29.139%2018.0043%2029.4027%2018.2237%2029.6137%2018.4663C29.8439%2018.7463%2030.0262%2019.0543%2030.1604%2019.3903C31.5224%2022.6757%2032.8172%2025.821%2034.0449%2028.8263C34.5629%2030.1143%2035.1%2031.4257%2035.6563%2032.7603C36.2126%2034.095%2036.7449%2035.3923%2037.2532%2036.6523C37.7616%2037.9123%2038.2412%2039.093%2038.6919%2040.1943C39.1427%2041.2957%2039.5312%2042.2477%2039.8573%2043.0503C40.1259%2043.685%2040.1642%2044.2543%2039.9724%2044.7583C39.7806%2045.2623%2039.3777%2045.5143%2038.7639%2045.5143ZM30.4194%2034.8743L27.6859%2025.3823H27.6571L24.607%2034.8743H30.4194Z'%20fill='white'/%3e%3c/svg%3e",ta="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2062%2062'%20class='design-iconfont'%3e%3cpath%20d='M0%2014.5882C0%206.53137%206.53137%200%2014.5882%200H47.4118C55.4686%200%2062%206.53137%2062%2014.5882V47.4118C62%2055.4686%2055.4686%2062%2047.4118%2062H14.5882C6.53137%2062%200%2055.4686%200%2047.4118V14.5882Z'%20fill='%234876FF'/%3e%3cg%20filter='url(%23kd70btl3k__filter0_d_7802_38768)'%3e%3cpath%20d='M42.8433%2015.6719H27.4866C24.6533%2015.6719%2022.33%2017.9952%2022.33%2020.8852V32.6152C22.33%2035.5052%2024.6533%2037.8285%2027.4866%2037.8285H37.861L41.4876%2041.1719C42.5076%2042.1352%2044.2643%2041.4552%2044.2643%2040.0385V37.7719C47.041%2037.7719%2048%2035.4485%2048%2032.6152V20.8852C48%2017.9952%2045.6766%2015.6719%2042.8433%2015.6719Z'%20fill='%23D6E0FF'/%3e%3cpath%20d='M36.9952%2017.1719H19.7806C16.6044%2017.1719%2014%2019.7763%2014%2023.016V36.1652C14%2039.3413%2016.5409%2041.9458%2019.6535%2042.0093V44.5502C19.6535%2046.1383%2021.6227%2046.9005%2022.7661%2045.8206L26.8316%2042.0728H36.9952C40.1714%2042.0728%2042.7758%2039.4684%2042.7758%2036.2287V23.016C42.7758%2019.7763%2040.1714%2017.1719%2036.9952%2017.1719Z'%20fill='%23EBF0FF'/%3e%3cpath%20d='M35.8572%2028.9015C35.8572%2026.5396%2035.2018%2024.6658%2033.8911%2023.2801C32.5804%2021.8944%2030.8072%2021.1995%2028.5715%2021.1953C26.342%2021.1953%2024.5709%2021.8881%2023.2581%2023.2738C21.9453%2024.6595%2021.2878%2026.5259%2021.2858%2028.8732C21.2858%2031.1973%2021.9401%2033.0564%2023.2487%2034.4505C24.5574%2035.8446%2026.2974%2036.5427%2028.4688%2036.5447C29.0683%2036.5626%2029.6676%2036.5012%2030.2514%2036.3621C30.3074%2036.4093%2030.9638%2037.4265%2031.7726%2037.8863C32.3384%2038.2078%2033.0977%2038.2247%2033.6736%2038.1731C34.1554%2038.1299%2034.4572%2037.6737%2034.3836%2037.1957C34.3104%2036.7211%2033.8837%2036.3943%2033.42%2036.2696C33.3237%2036.2437%2033.2286%2036.2126%2033.1352%2036.1763C32.8819%2036.0309%2032.6781%2035.8113%2032.5503%2035.5464C34.757%2034.1965%2035.8593%2031.9815%2035.8572%2028.9015ZM31.278%2032.8475L31.1286%2033.0396C31.0602%2033.131%2030.6433%2032.1641%2029.6292%2031.8492C29.0996%2031.7142%2028.5513%2031.6807%2028.0124%2031.7487C27.6975%2031.7884%2027.4827%2032.0714%2027.4827%2032.3888C27.4827%2032.7549%2027.771%2033.0497%2028.1222%2033.153C28.3685%2033.2254%2028.6053%2033.33%2028.8266%2033.4648C29.2341%2033.7797%2029.5919%2034.186%2029.4176%2034.2332C29.113%2034.3135%2028.7992%2034.3527%2028.4844%2034.3497C27.9396%2034.3544%2027.403%2034.2154%2026.9274%2033.9465C26.4518%2033.6776%2026.0535%2033.288%2025.7717%2032.816C25.0935%2031.7873%2024.7534%2030.4394%2024.7513%2028.7724C24.7492%2027.1054%2025.0894%2025.7565%2025.7717%2024.7256C26.0684%2024.2609%2026.4754%2023.8788%2026.9555%2023.6142C27.4356%2023.3497%2027.9735%2023.2111%2028.5201%2023.2111C29.0668%2023.2111%2029.6047%2023.3497%2030.0848%2023.6142C30.5649%2023.8788%2030.9719%2024.2609%2031.2686%2024.7256C31.9592%2025.7313%2032.3046%2027.0739%2032.3046%2028.7535C32.3046%2030.4772%2031.9624%2031.8419%2031.278%2032.8475Z'%20fill='%234876FF'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='kd70btl3k__filter0_d_7802_38768'%20x='9.875'%20y='15.6719'%20width='42.25'%20height='38.9023'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='4.125'/%3e%3cfeGaussianBlur%20stdDeviation='2.0625'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20values='0%200%200%200%200.413084%200%200%200%200%200.250874%200%200%200%200%200.0886636%200%200%200%200.14%200'/%3e%3cfeBlend%20in2='BackgroundImageFix'%20result='effect1_dropShadow_7802_38768'/%3e%3cfeBlend%20in='SourceGraphic'%20in2='effect1_dropShadow_7802_38768'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",aa={class:"add-libray-popup",ref:"modal"},la={class:"add-libray-popup-body"},na={class:"popup-title"},oa={class:"libray-type-list"},sa={class:"libray-item-header"},ia={class:"libray-type-name"},_a={class:"libray-desc"},ra={class:"libray-action"},da={class:"libray-item-header"},ca={class:"libray-type-name"},ua={class:"libray-desc"},pa={class:"libray-action"},ha={__name:"add-libray-popup",emits:["ok"],setup(te,{expose:d,emit:o}){const{t:m}=_e("views.library.library-list.components.add-libray-popup"),S=o,z=g(!1),x=()=>{z.value=!0},q=()=>{z.value=!1},A=e=>{z.value=!1,S("ok",e)},b=e=>{A(e)};return d({show:x,close:q}),(e,h)=>{const C=ae;return u(),k("div",aa,[t(C,{footer:null,getContainer:()=>e.$refs.modal,open:z.value,"onUpdate:open":h[2]||(h[2]=$=>z.value=$),title:"",width:520,onOk:A},{default:s(()=>[n("div",la,[n("div",na,r(a(m)("new_library_title")),1),n("div",oa,[n("div",{class:"libray-item",onClick:h[0]||(h[0]=$=>b(0))},[n("div",sa,[h[3]||(h[3]=n("img",{class:"libray-icon",src:ea,alt:""},null,-1)),n("div",ia,r(a(m)("normal_library_type")),1)]),n("div",_a,r(a(m)("normal_library_desc")),1),n("div",ra,[t(a(xe))])]),n("div",{class:"libray-item",onClick:h[1]||(h[1]=$=>b(2))},[n("div",da,[h[4]||(h[4]=n("img",{class:"libray-icon",src:ta,alt:""},null,-1)),n("div",ca,r(a(m)("qa_library_type")),1)]),n("div",ua,r(a(m)("qa_library_desc")),1),n("div",pa,[t(a(xe))])])])])]),_:1},8,["getContainer","open"])],512)}}},fa=le(ha,[["__scopeId","data-v-bcc303d5"]]),ma={class:"form-box"},va={class:"form-item-tip"},ga={style:{color:"#8c8c8c"}},ya={class:"indexing-methods-box"},ka={class:"list-title-block"},ba={class:"list-content"},Ca={class:"list-title-block"},xa={class:"list-content"},wa={class:"form-alert-tip"},$a={class:"select-card-box"},La={class:"card-title"},Ma={class:"card-desc"},za={class:"card-title"},Aa={class:"card-desc"},Oa={class:"card-title"},Sa={class:"card-desc"},qa={class:"card-title"},Ia={class:"card-desc"},Ua={class:"graph-switch-box"},Ga={class:"lable-text"},Ta={class:"main-title-block"},Ra={class:"unit-text"},Ba={class:"main-title-block"},Na={class:"unit-text"},Fa={class:"graph-switch-box"},Va={class:"lable-text"},Ce="你是一位文章分段助手，根据文章内容的语义进行合理分段，确保每个分段表述一个完整的语义，每个分段字数控制在500字左右，最大不超过1000字。请严格按照文章内容进行分段，不要对文章内容进行加工，分段完成后输出分段后的内容。",Ea={__name:"add-library-model",setup(te,{expose:d}){const{t:o}=_e("views.library.add-library.add-library-model"),m=qe(),S=me(()=>{var _;return((_=m.companyInfo)==null?void 0:_.neo4j_status)=="true"});H.config({duration:2});const z=g(null),x=g(!0),q=Ge(),A=g(!1),b=g(!1),e=$e({type:"0",access_rights:0,library_name:"",library_intro:"",use_model:"",model_config_id:"",library_files:void 0,avatar:"",avatar_file:void 0,is_offline:!1,urls:"",doc_type:1,file_name:"",is_qa_doc:0,qa_index_type:1,doc_auto_renew_frequency:1,chunk_type:1,normal_chunk_default_separators_no:[12,11],normal_chunk_default_chunk_size:512,normal_chunk_default_chunk_overlap:50,semantic_chunk_default_chunk_size:512,semantic_chunk_default_chunk_overlap:50,semantic_chunk_default_threshold:90,normal_chunk_default_not_merged_text:"false",graph_switch:!1,graph_model_config_id:void 0,graph_use_model:"",ai_chunk_size:5e3,ai_chunk_model:"",ai_chunk_model_config_id:"",ai_chunk_prumpt:Ce,group_id:0,father_chunk_paragraph_type:2,father_chunk_separators_no:[],father_chunk_chunk_size:1024,son_chunk_separators_no:[],son_chunk_chunk_size:512,sync_official_history_type:2,enable_cron_sync_official_content:!0,app_id_list:""}),h=_=>{e.avatar=_.imageUrl,e.avatar_file=_.file},C=g([]);Ze().then(_=>{C.value=_.data.map(i=>({label:i.name,value:i.no}))});const $=_=>{e.chunk_type=_},w=g([]),U=_=>{w.value=_,nt(()=>{(!e.ai_chunk_model||!Number(e.ai_chunk_model_config_id))&&f()})},f=()=>{if(w.value.length>0){let _=null,i=null;for(let L of w.value)if(L.model_define==="tongyi"){_=L;for(let c of _.children)if(c.name==="qwen-max"){i=c;break}break}_||(_=w.value[0],i=_.children[0]),_&&i&&(e.ai_chunk_model=i.name,e.ai_chunk_model_config_id=i.model_config_id)}},T=_=>{_.length&&(e.use_model=_[0].children[0].name,e.model_config_id=_[0].model_config_id)},re=g(null),ve=_=>{if(_){let i={graph_model_config_id:e.graph_model_config_id,graph_use_model:e.graph_use_model};if((!e.graph_model_config_id||!e.graph_use_model)&&w.value.length>0){let L=w.value[0];if(L){let c=L.children[0];i.graph_use_model=c.name,i.graph_model_config_id=c.model_config_id}}re.value.show(i)}else e.graph_switch=!1},K=_=>{_.graph_model_config_id&&(e.graph_switch=!0,e.graph_model_config_id=_.graph_model_config_id,e.graph_use_model=_.graph_use_model)},W=()=>{A.value=!1},ne=()=>{z.value.validate().then(()=>{de()}).catch(_=>{})},de=()=>{let _=new FormData,i=JSON.parse(JSON.stringify(e));_.append("type",e.type),_.append("access_rights",e.access_rights),_.append("library_name",e.library_name),_.append("qa_index_type",e.qa_index_type),_.append("library_intro",e.library_intro),_.append("use_model",i.use_model),_.append("model_config_id",e.model_config_id),_.append("avatar",e.avatar_file?e.avatar_file:""),_.append("is_offline",e.is_offline),_.append("urls",JSON.stringify(bt(e.urls))),_.append("doc_type",e.doc_type),_.append("file_name",e.file_name),_.append("is_qa_doc",e.is_qa_doc),_.append("qa_index_type",e.qa_index_type),_.append("doc_auto_renew_frequency",e.doc_auto_renew_frequency),_.append("chunk_type",e.chunk_type),_.append("normal_chunk_default_separators_no",JSON.stringify(e.normal_chunk_default_separators_no)),_.append("normal_chunk_default_not_merged_text",e.normal_chunk_default_not_merged_text),_.append("normal_chunk_default_chunk_size",e.normal_chunk_default_chunk_size),_.append("normal_chunk_default_chunk_overlap",e.normal_chunk_default_chunk_overlap),_.append("semantic_chunk_default_chunk_size",e.semantic_chunk_default_chunk_size),_.append("semantic_chunk_default_chunk_overlap",e.semantic_chunk_default_chunk_overlap),_.append("semantic_chunk_default_threshold",e.semantic_chunk_default_threshold),_.append("graph_switch",e.graph_switch?1:0),_.append("graph_model_config_id",e.graph_model_config_id),_.append("graph_use_model",e.graph_use_model),_.append("ai_chunk_size",e.ai_chunk_size),_.append("ai_chunk_model",e.ai_chunk_model),_.append("ai_chunk_model_config_id",e.ai_chunk_model_config_id),_.append("ai_chunk_prumpt",e.ai_chunk_prumpt),_.append("father_chunk_paragraph_type",e.father_chunk_paragraph_type),_.append("father_chunk_separators_no",JSON.stringify(e.father_chunk_separators_no)),_.append("son_chunk_separators_no",JSON.stringify(e.son_chunk_separators_no)),_.append("father_chunk_chunk_size",e.father_chunk_chunk_size),_.append("son_chunk_chunk_size",e.son_chunk_chunk_size),_.append("group_id",e.group_id),_.append("is_default",2);let L=Pe;e.type==3&&(L=je,_.append("app_id_list",e.app_id_list),_.append("sync_official_history_type",e.sync_official_history_type),_.append("enable_cron_sync_official_content",Number(e.enable_cron_sync_official_content))),b.value=!0,L(_).then(c=>{var j,Q;H.success(o("create_success")),A.value=!1;let Y="/library/details/knowledge-document",B;e.type==3?B={id:(j=c==null?void 0:c.data)==null?void 0:j[0]}:(B={id:(Q=c==null?void 0:c.data)==null?void 0:Q.id},e.doc_type==3&&(Y="/library/preview",B={id:c.data.file_ids[0]})),q.push({path:Y,query:B}),b.value=!1,A.value=!1}).catch(()=>{b.value=!1})},ge=({type:_,group_id:i,wx_app_ids:L})=>{e.type=_,_==3?e.app_id_list=L:_==0?(e.avatar=he,e.avatar_file=he):(e.avatar=fe,e.avatar_file=fe),e.library_name="",e.library_intro="",e.qa_index_type=1,e.chunk_type=1,e.normal_chunk_default_separators_no=[12,11],e.normal_chunk_default_chunk_size=512,e.normal_chunk_default_chunk_overlap=50,e.normal_chunk_default_not_merged_text="false",e.semantic_chunk_default_chunk_size=512,e.semantic_chunk_default_chunk_overlap=50,e.semantic_chunk_default_threshold=50,e.graph_switch=!1,e.father_chunk_paragraph_type=2,e.father_chunk_separators_no=[12,11],e.father_chunk_chunk_size=1024,e.son_chunk_separators_no=[8,10],e.son_chunk_chunk_size=512,e.ai_chunk_size=5e3,e.ai_chunk_model="",e.ai_chunk_model_config_id="",e.ai_chunk_prumpt=Ce,e.group_id=i||0,A.value=!0},oe=_=>{_!=e.qa_index_type&&(e.qa_index_type=_)};return d({show:ge}),lt(()=>{}),(_,i)=>{const L=Ne,c=_t,Y=rt,B=Ve,j=Fe,Q=dt,D=Le,G=we,N=ht,F=pt,ce=mt,ye=ft,ke=it,ue=ae;return u(),k(P,null,[t(ue,{open:A.value,"onUpdate:open":i[32]||(i[32]=l=>A.value=l),title:a(o)("add_library"),onOk:ne,confirmLoading:b.value,wrapClassName:"no-padding-modal",bodyStyle:{"padding-right":"24px","max-height":"540px","overflow-y":"auto"},onCancel:W,width:"620px"},{default:s(()=>[n("div",ma,[t(ke,{layout:"vertical",ref_key:"formRef",ref:z,model:e},{default:s(()=>[e.type!=3?(u(),k(P,{key:0},[t(c,{ref:"name",name:"library_name",label:a(o)("library_name"),rules:[{required:!0,message:a(o)("please_enter_library_name"),trigger:"change"}]},{default:s(()=>[t(L,{value:e.library_name,"onUpdate:value":i[0]||(i[0]=l=>e.library_name=l),placeholder:a(o)("library_name_placeholder"),maxlength:20},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),t(c,{label:a(o)("library_intro")},{default:s(()=>[t(Y,{maxlength:1e3,value:e.library_intro,"onUpdate:value":i[1]||(i[1]=l=>e.library_intro=l),placeholder:a(o)("library_intro_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(c,{ref:"name",label:a(o)("library_cover")},{default:s(()=>[t(kt,{value:e.avatar,"onUpdate:value":i[2]||(i[2]=l=>e.avatar=l),onChange:h},null,8,["value"]),n("div",va,r(a(o)("upload_cover_tip")),1)]),_:1},8,["label"])],64)):(u(),k(P,{key:1},[t(c,{label:a(o)("history_content_period")},{default:s(()=>[t(j,{value:e.sync_official_history_type,"onUpdate:value":i[3]||(i[3]=l=>e.sync_official_history_type=l)},{default:s(()=>[t(B,{value:10},{default:s(()=>[p(r(a(o)("all")),1)]),_:1}),t(B,{value:1},{default:s(()=>[p(r(a(o)("within_half_year")),1)]),_:1}),t(B,{value:2},{default:s(()=>[p(r(a(o)("within_one_year")),1)]),_:1}),t(B,{value:3},{default:s(()=>[p(r(a(o)("within_three_years")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),t(c,{label:a(o)("daily_fetch_latest")},{default:s(()=>[t(Q,{checked:e.enable_cron_sync_official_content,"onUpdate:checked":i[4]||(i[4]=l=>e.enable_cron_sync_official_content=l),"checked-children":a(o)("on"),"un-checked-children":a(o)("off")},null,8,["checked","checked-children","un-checked-children"])]),_:1},8,["label"])],64)),n("div",{class:"hight-set-text",onClick:i[5]||(i[5]=l=>x.value=!x.value)},[x.value?(u(),R(a(ct),{key:0})):(u(),R(a(ut),{key:1})),p(" "+r(a(o)("advanced_settings"))+" ",1),n("span",ga,r(a(o)("for_advanced_users")),1)]),se(t(c,null,{label:s(()=>[p(r(a(o)("vector_model"))+" ",1),t(D,null,{title:s(()=>[p(r(a(o)("vector_model_tooltip")),1)]),default:s(()=>[t(a(ee),{class:"ml4"})]),_:1})]),default:s(()=>[t(be,{modelType:"TEXT EMBEDDING",modeName:e.use_model,"onUpdate:modeName":i[6]||(i[6]=l=>e.use_model=l),modeId:e.model_config_id,"onUpdate:modeId":i[7]||(i[7]=l=>e.model_config_id=l),onLoaded:T,style:{width:"100%"}},null,8,["modeName","modeId"])]),_:1},512),[[ie,!x.value]]),se(t(c,{label:a(o)("indexing_method")},{default:s(()=>[n("div",ya,[n("div",{class:J(["list-item",{active:e.qa_index_type==1}]),onClick:i[8]||(i[8]=l=>oe(1))},[t(G,{class:"check-icon",name:"check-arrow-filled"}),n("div",ka,[t(G,{name:"file-search"}),p(" "+r(a(o)("qa_indexing")),1)]),n("div",ba,r(a(o)("qa_indexing_desc")),1)],2),n("div",{class:J(["list-item",{active:e.qa_index_type==2}]),onClick:i[9]||(i[9]=l=>oe(2))},[t(G,{class:"check-icon",name:"check-arrow-filled"}),n("div",Ca,[t(G,{name:"comment-search"}),p(" "+r(a(o)("question_only_indexing")),1)]),n("div",xa,r(a(o)("question_only_indexing_desc")),1)],2)])]),_:1},8,["label"]),[[ie,!x.value&&e.type==2]]),se(n("div",null,[t(c,{label:a(o)("segmentation_method"),required:""},{default:s(()=>[n("div",wa,r(a(o)("segmentation_tip")),1),n("div",$a,[n("div",{class:J(["select-card-item",{active:e.chunk_type==1}]),onClick:i[10]||(i[10]=l=>$(1))},[t(G,{class:"check-arrow",name:"check-arrow-filled"}),n("div",La,[t(G,{name:"ordinary-segmentation",class:"title-icon"}),p(" "+r(a(o)("ordinary_segmentation")),1)]),n("div",Ma,r(a(o)("ordinary_segmentation_desc")),1)],2),n("div",{class:J(["select-card-item",{active:e.chunk_type==2}]),onClick:i[11]||(i[11]=l=>$(2))},[t(G,{class:"check-arrow",name:"check-arrow-filled"}),n("div",za,[t(G,{name:"semantic-segmentation",class:"title-icon"}),p(" "+r(a(o)("semantic_segmentation")),1)]),n("div",Aa,r(a(o)("semantic_segmentation_desc")),1)],2),n("div",{class:J(["select-card-item",{active:e.chunk_type==4}]),onClick:i[12]||(i[12]=l=>$(4))},[t(G,{class:"check-arrow",name:"check-arrow-filled"}),n("div",Oa,[t(G,{name:"semantic-segmentation",class:"title-icon"}),p(" "+r(a(o)("parent_child_segmentation")),1)]),n("div",Sa,r(a(o)("parent_child_segmentation_desc")),1)],2),n("div",{class:J(["select-card-item",{active:e.chunk_type==3}]),onClick:i[13]||(i[13]=l=>$(3))},[t(G,{class:"check-arrow",name:"check-arrow-filled"}),n("div",qa,[t(G,{name:"semantic-segmentation",class:"title-icon"}),p(" "+r(a(o)("ai_segmentation")),1)]),n("div",Ia,r(a(o)("ai_segmentation_desc")),1)],2)])]),_:1},8,["label"]),e.chunk_type==1?(u(),k(P,{key:0},[t(c,{label:a(o)("segmentation_separator"),required:""},{default:s(()=>[t(j,{value:e.normal_chunk_default_separators_no,"onUpdate:value":i[14]||(i[14]=l=>e.normal_chunk_default_separators_no=l),mode:"tags",style:{width:"100%"},placeholder:a(o)("select_segmentation_separator"),options:C.value},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(F,null,{default:s(()=>[t(c,{label:a(o)("max_chunk_size"),required:""},{default:s(()=>[t(F,{gap:8,align:"center"},{default:s(()=>[t(N,{value:e.normal_chunk_default_chunk_size,"onUpdate:value":i[15]||(i[15]=l=>e.normal_chunk_default_chunk_size=l),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),p(" "+r(a(o)("characters")),1)]),_:1})]),_:1},8,["label"]),t(c,{label:a(o)("chunk_overlap")},{default:s(()=>[t(F,{gap:8,align:"center"},{default:s(()=>[t(N,{value:e.normal_chunk_default_chunk_overlap,"onUpdate:value":i[16]||(i[16]=l=>e.normal_chunk_default_chunk_overlap=l),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),p(" "+r(a(o)("characters")),1)]),_:1})]),_:1},8,["label"])]),_:1}),n("div",Ua,[n("div",Ga,[p(r(a(o)("auto_merge_small_chunks"))+" ",1),t(D,{title:a(o)("auto_merge_tooltip")},{default:s(()=>[t(a(ee),{class:"ml4"})]),_:1},8,["title"])]),t(Q,{checkedValue:"false",unCheckedValue:"true",checked:e.normal_chunk_default_not_merged_text,"onUpdate:checked":i[17]||(i[17]=l=>e.normal_chunk_default_not_merged_text=l),"checked-children":a(o)("on"),"un-checked-children":a(o)("off")},null,8,["checked","checked-children","un-checked-children"])])],64)):O("",!0),e.chunk_type==2?(u(),k(P,{key:1},[e.chunk_type==2?(u(),R(c,{key:0,required:""},{label:s(()=>[p(r(a(o)("segmentation_threshold"))+" ",1),t(D,null,{title:s(()=>[p(r(a(o)("segmentation_threshold_tooltip")),1)]),default:s(()=>[t(a(ee),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:s(()=>[t(N,{value:e.semantic_chunk_default_threshold,"onUpdate:value":i[18]||(i[18]=l=>e.semantic_chunk_default_threshold=l),style:{width:"100%"},placeholder:a(o)("please_enter_segmentation_threshold"),precision:0,min:0,max:100},null,8,["value","placeholder"])]),_:1})):O("",!0),t(F,null,{default:s(()=>[t(c,{label:a(o)("max_chunk_size"),required:""},{default:s(()=>[t(F,{gap:8,align:"center"},{default:s(()=>[t(N,{value:e.semantic_chunk_default_chunk_size,"onUpdate:value":i[19]||(i[19]=l=>e.semantic_chunk_default_chunk_size=l),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),p(" "+r(a(o)("characters")),1)]),_:1})]),_:1},8,["label"]),t(c,{label:a(o)("chunk_overlap")},{default:s(()=>[t(F,{gap:8,align:"center"},{default:s(()=>[t(N,{value:e.semantic_chunk_default_chunk_overlap,"onUpdate:value":i[20]||(i[20]=l=>e.semantic_chunk_default_chunk_overlap=l),style:{width:"230px"},precision:0,min:1,max:1e5},null,8,["value"]),p(" "+r(a(o)("characters")),1)]),_:1})]),_:1},8,["label"])]),_:1})],64)):O("",!0),e.chunk_type==3?(u(),k(P,{key:2},[e.chunk_type==3?(u(),R(c,{key:0,required:""},{label:s(()=>[p(r(a(o)("ai_llm_model")),1)]),default:s(()=>[t(be,{modelType:"LLM",placeholder:a(o)("please_select_ai_model"),modeName:e.ai_chunk_model,"onUpdate:modeName":i[21]||(i[21]=l=>e.ai_chunk_model=l),modeId:e.ai_chunk_model_config_id,"onUpdate:modeId":i[22]||(i[22]=l=>e.ai_chunk_model_config_id=l),style:{width:"100%"},onLoaded:U},null,8,["placeholder","modeName","modeId"])]),_:1})):O("",!0),t(c,{label:a(o)("prompt_setting"),required:""},{default:s(()=>[t(F,{gap:8,align:"center"},{default:s(()=>[t(Y,{maxLength:500,style:{height:"80px"},value:e.ai_chunk_prumpt,"onUpdate:value":i[23]||(i[23]=l=>e.ai_chunk_prumpt=l),placeholder:Ce},null,8,["value"])]),_:1})]),_:1},8,["label"]),t(c,null,{label:s(()=>[p(r(a(o)("max_single_characters"))+" ",1),t(D,null,{title:s(()=>[p(r(a(o)("max_single_characters_tooltip")),1)]),default:s(()=>[t(a(ee),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:s(()=>[t(N,{class:"form-item-inptu-numbner",value:e.ai_chunk_size,"onUpdate:value":i[24]||(i[24]=l=>e.ai_chunk_size=l),placeholder:a(o)("please_enter_max_characters"),precision:0,min:0,formatter:l=>parseInt(l),parser:l=>parseInt(l)},null,8,["value","placeholder","formatter","parser"]),p(" "+r(a(o)("characters")),1)]),_:1})],64)):O("",!0),e.chunk_type==4?(u(),k(P,{key:3},[n("div",Ta,r(a(o)("parent_block_context")),1),t(c,{label:a(o)("chunk_type")},{default:s(()=>[t(ye,{value:e.father_chunk_paragraph_type,"onUpdate:value":i[25]||(i[25]=l=>e.father_chunk_paragraph_type=l)},{default:s(()=>[t(ce,{value:1},{default:s(()=>[p(r(a(o)("full_text"))+" ",1),t(D,{title:a(o)("full_text_tooltip")},{default:s(()=>[t(a(ee))]),_:1},8,["title"])]),_:1}),t(ce,{value:2},{default:s(()=>[p(r(a(o)("paragraph"))+" ",1),t(D,{title:a(o)("paragraph_tooltip")},{default:s(()=>[t(a(ee))]),_:1},8,["title"])]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),e.father_chunk_paragraph_type==2?(u(),R(c,{key:0,label:a(o)("segmentation_separator")},{default:s(()=>[t(j,{placeholder:a(o)("please_select"),style:{width:"100%"},mode:"tags",options:C.value,value:e.father_chunk_separators_no,"onUpdate:value":i[26]||(i[26]=l=>e.father_chunk_separators_no=l)},null,8,["placeholder","options","value"])]),_:1},8,["label"])):O("",!0),e.father_chunk_paragraph_type==2?(u(),R(c,{key:1,label:a(o)("max_chunk_size")},{default:s(()=>[t(F,{align:"center",gap:8},{default:s(()=>[t(N,{style:{flex:"1"},value:e.father_chunk_chunk_size,"onUpdate:value":i[27]||(i[27]=l=>e.father_chunk_chunk_size=l),placeholder:a(o)("max_chunk_size"),min:200,max:1e4,precision:0,formatter:l=>parseInt(l),parser:l=>parseInt(l)},null,8,["value","placeholder","formatter","parser"]),n("span",Ra,r(a(o)("characters")),1)]),_:1})]),_:1},8,["label"])):O("",!0),n("div",Ba,r(a(o)("child_block_retrieval")),1),t(c,{label:a(o)("segmentation_separator")},{default:s(()=>[t(j,{placeholder:a(o)("please_select"),style:{width:"100%"},mode:"tags",options:C.value,value:e.son_chunk_separators_no,"onUpdate:value":i[28]||(i[28]=l=>e.son_chunk_separators_no=l)},null,8,["placeholder","options","value"])]),_:1},8,["label"]),t(c,{label:a(o)("max_chunk_size")},{default:s(()=>[t(F,{align:"center",gap:8},{default:s(()=>[t(N,{style:{flex:"1"},value:e.son_chunk_chunk_size,"onUpdate:value":i[29]||(i[29]=l=>e.son_chunk_chunk_size=l),placeholder:a(o)("max_chunk_size"),min:200,max:1e4,precision:0,formatter:l=>parseInt(l),parser:l=>parseInt(l)},null,8,["value","placeholder","formatter","parser"]),n("span",Na,r(a(o)("characters")),1)]),_:1})]),_:1},8,["label"])],64)):O("",!0),se(n("div",Fa,[n("div",Va,[p(r(a(o)("generate_knowledge_graph"))+" ",1),t(D,null,{title:s(()=>[p(r(a(o)("generate_knowledge_graph_tooltip")),1)]),default:s(()=>[t(a(ee),{class:"ml4"})]),_:1})]),t(Q,{onChange:ve,checked:e.graph_switch,"checked-children":a(o)("on"),"un-checked-children":a(o)("off")},null,8,["checked","checked-children","un-checked-children"])],512),[[ie,S.value]]),se(t(c,{label:a(o)("knowledge_graph_model")},{default:s(()=>[t(be,{modelType:"LLM",modeName:e.graph_use_model,"onUpdate:modeName":i[30]||(i[30]=l=>e.graph_use_model=l),modeId:e.graph_model_config_id,"onUpdate:modeId":i[31]||(i[31]=l=>e.graph_model_config_id=l),style:{width:"300px"},onLoaded:U},null,8,["modeName","modeId"])]),_:1},8,["label"]),[[ie,e.graph_switch&&S.value]])],512),[[ie,!x.value&&(e.type==0||e.type==3)]])]),_:1},8,["model"])])]),_:1},8,["open","title","confirmLoading"]),t(Ct,{onOk:K,ref_key:"openGrapgModalRef",ref:re},null,512)],64)}}},Ha=le(Ea,[["__scopeId","data-v-18263e36"]]),Da={class:"form-item"},Za={class:"form-label"},Pa={class:"form-content"},ja={__name:"add-group",emits:["ok"],setup(te,{expose:d,emit:o}){const{t:m}=_e("views.library.library-list.components.add-group"),S=g(!1),z=o,x=g(m("create_group_title")),q=$e({group_name:"",id:""}),A=e=>{q.group_name=e.group_name||"",q.id=e.id||"",x.value=e.id?m("edit_group_title"):m("create_group_title"),S.value=!0},b=()=>{if(!q.group_name)return H.error(m("group_name_required"));Je({...q}).then(e=>{H.success(m("operation_success",{title:x.value})),S.value=!1,z("ok")})};return d({show:A}),(e,h)=>{const C=Ne,$=ae;return u(),k("div",null,[t($,{open:S.value,"onUpdate:open":h[1]||(h[1]=w=>S.value=w),title:x.value,onOk:b,zIndex:2e3},{default:s(()=>[n("div",Da,[n("div",Za,r(a(m)("group_name_label")),1),n("div",Pa,[t(C,{maxLength:15,value:q.group_name,"onUpdate:value":h[0]||(h[0]=w=>q.group_name=w),placeholder:a(m)("group_name_placeholder")},null,8,["value","placeholder"])])])]),_:1},8,["open","title"])])}}},Ja=le(ja,[["__scopeId","data-v-c1b7152f"]]),Ka={class:"form-item"},Qa={class:"form-content"},Wa={__name:"edit-group",emits:["ok"],setup(te,{expose:d,emit:o}){const m=g(!1),S=o,z=g("修改分组"),x=$e({group_id:"",library_id:""}),q=g([]),A=h=>{x.group_id=h.group_id||"0",x.library_id=h.id||"",e(),m.value=!0},b=()=>{if(!x.group_id)return H.error("请选择分组");Ke({...x}).then(h=>{H.success(`${z.value}成功`),m.value=!1,S("ok")})},e=()=>{Ie().then(h=>{q.value=h.data||[]})};return d({show:A}),(h,C)=>{const $=Ve,w=Fe,U=ae;return u(),k("div",null,[t(U,{open:m.value,"onUpdate:open":C[1]||(C[1]=f=>m.value=f),title:z.value,onOk:b},{default:s(()=>[n("div",Ka,[C[2]||(C[2]=n("div",{class:"form-label"},"分组名称：",-1)),n("div",Qa,[t(w,{value:x.group_id,"onUpdate:value":C[0]||(C[0]=f=>x.group_id=f),style:{width:"100%"},placeholder:"请选择分组"},{default:s(()=>[(u(!0),k(P,null,Ue(q.value,f=>(u(),R($,{value:f.id},{default:s(()=>[p(r(f.group_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])]),_:1},8,["open","title"])])}}},Ya=le(Wa,[["__scopeId","data-v-62ebd416"]]),Xa={"bg-color":"#f5f9ff",class:"library-page"},e2={class:"library-page-body"},t2={class:"list-toolbar"},a2={class:"toolbar-box"},l2={class:"toolbar-box"},n2={class:"create-action"},o2=["src"],s2={class:"create-action"},i2=["src"],_2={class:"create-action"},r2={class:"list-group-box"},d2={class:"group-head-box"},c2={key:0,class:"head-title"},u2={class:"classify-box",style:{"margin-top":"16px"}},p2=["onClick"],h2={class:"classify-title"},f2={key:0,class:"drag-btn"},m2={key:1,style:{width:"20px",display:"inline-block"}},v2={class:"right-content"},g2={key:0,class:"btn-box"},y2={class:"hover-btn-wrap"},k2=["onClick"],b2=["onClick"],C2={__name:"library-list",setup(te){var ue;const{t:d}=_e("views.library.library-list.library-list");Ge();const o=ot(),m=g([{title:d("library_tab"),path:"/library/list"},{title:d("database_tab"),path:"/database/list"},{title:d("faq_extraction_tab"),path:"/ai-extract-faq/list"},{title:d("trigger_statistics_tab"),path:"/trigger-statics/list"}]),S=g([{title:d("all_count",{count:0}),value:"all"},{title:d("normal_count",{count:0}),value:"0"},{title:d("qa_count",{count:0}),value:"2"}]),z=Qe();let{role_permission:x,role_type:q}=z;const A=me(()=>q==1||x.includes("LibraryCreate")),b=g(null),e=g(null),h=g(null),C=g(null),$=g([]),w=g(String(((ue=o.query)==null?void 0:ue.active)||"all")),U=g("");let f="library-list-hide-group-key";const T=g(localStorage.getItem(f)==1),re=()=>{T.value=!T.value,localStorage.setItem(f,T.value?1:0)},ve=g(""),K=g([]);me(()=>K.value.filter(l=>l.group_name.includes(ve.value)));const W=()=>{let l=w.value==="all"?"":w.value;Ie({type:l}).then(v=>{let M=v.data||[],y=0;M.forEach(Z=>{y+=+Z.total}),K.value=[{group_name:d("all_tab"),total:y,id:""},...M]})};W();const ne=l=>{l==3?h.value.open():de(l)},de=l=>{b.value.show({type:l,group_id:U.value})},ge=(l,v)=>{if(!v.length)return H.warning(d("select_official_account"));h.value.close(),b.value.show({type:3,group_id:U.value,wx_app_ids:l})},oe=g([]),_=async l=>{await Mt({ability_type:"library_ability_official_account"}).then(V=>{var pe;let X=(V==null?void 0:V.data)||{};((pe=X==null?void 0:X.user_config)==null?void 0:pe.switch_status)==1&&(C.value=X)});let v=0,M=0,y=0,Z=0;$.value=[],l.forEach(V=>{V.type==0&&(M+=1),V.type==2&&(y+=1),V.type==3&&(Z+=1,$.value.push(V.official_app_id)),v+=1}),S.value=[{title:d("all_count",{count:v}),value:"all"},{title:d("normal_count",{count:M}),value:"0"},{title:d("qa_count",{count:y}),value:"2"}],C.value&&S.value.push({title:d("official_account_count",{count:Z}),value:"3"})};let i=g([]);const L=()=>{let l=w.value==="all"?"":w.value;Ae({type:l}).then(v=>{let M=v.data||[];M.forEach(y=>{y.file_size_str=We(y.file_size),y.avatar||(y.type==0?y.avatar=he:y.type==2?y.avatar=fe:y.type==3&&(y.avatar=Ye))}),U.value!=""&&(M=M.filter(y=>y.group_id==U.value)),oe.value=M,w.value==="all"?(i.value=v.data,_(i.value)):Ae().then(y=>{i.value=y.data,_(i.value)})})};L();const c=()=>{L(),W()},Y=l=>{l.type=="1"?window.open(`/#/public-library/config?library_id=${l.id}`,"_blank","noopener"):window.open(`/#/library/details?id=${l.id}`,"_blank","noopener")},B=l=>{if(tt(l.id)!=4)return H.error(d("no_permission_delete"));let M=3,y=ae.confirm({title:d("confirm_delete_library_title",{library_name:l.library_name}),icon:t(Se),content:d("confirm_delete_content"),okText:M+" "+d("confirm_btn"),okType:"danger",okButtonProps:{disabled:!0},cancelText:d("cancel_btn"),onOk(){j(l)},onCancel(){}}),Z=setInterval(()=>{M==1?(y.update({okText:d("confirm_btn"),okButtonProps:{disabled:!1}}),clearInterval(Z),Z=void 0):(M-=1,y.update({okText:M+" "+d("confirm_btn"),okButtonProps:{disabled:!0}}))},1e3)},j=({id:l})=>{at({id:l}).then(()=>{H.success(d("delete_success")),L(),W()})},Q=l=>{U.value=l.id,L()},D=g(null),G=l=>{D.value.show({...l})},N=g(null),F=l=>{N.value.show({...l})},ce=l=>{ae.confirm({title:d("confirm_delete_group_title",{group_name:l.group_name}),icon:t(Se),content:"",okText:d("confirm_btn"),okType:"danger",cancelText:d("cancel_btn"),onOk(){et({id:l.id}).then(()=>{H.success(d("delete_success")),W(),U.value==l.id&&(U.value=""),L()})}})};g(!1);const ye=l=>l.draggedContext.element.id>0&&l.relatedContext.element.id>0,ke=async()=>{try{const l=K.value.filter(v=>v.id>0).map((v,M)=>({id:v.id,sort:K.value.length-M}));await Xe({sort_group:JSON.stringify(l)}),H.success(d("sort_saved"))}catch(l){console.error(d("sort_failed"),l),W()}};return(l,v)=>{const M=vt,y=Re,Z=Te,V=Be,X=Le,pe=we,Me=Ee;return u(),k("div",Xa,[t(xt,{class:"mb-16",tabs:m.value,active:"/library/list"},null,8,["tabs"]),t(wt,{class:"mb-16 mr-16",title:a(d)("instruction_title")},{default:s(()=>[n("div",null,[n("p",null,r(a(d)("instruction_content_1")),1),n("p",null,r(a(d)("instruction_content_2")),1)])]),_:1},8,["title"]),n("div",e2,[n("div",t2,[n("div",a2,[t($t,{tabs:S.value,value:w.value,"onUpdate:value":v[0]||(v[0]=I=>w.value=I),onChange:c},null,8,["tabs","value"])]),n("div",l2,[A.value?(u(),R(V,{key:0},{overlay:s(()=>[t(Z,null,{default:s(()=>[t(y,{onClick:v[2]||(v[2]=E(I=>ne(0),["prevent"]))},{default:s(()=>[n("span",n2,[n("img",{class:"icon",src:a(he),alt:""},null,8,o2),n("span",null,r(a(d)("normal_library")),1)])]),_:1}),t(y,{onClick:v[3]||(v[3]=E(I=>ne(2),["prevent"]))},{default:s(()=>[n("span",s2,[n("img",{class:"icon",src:a(fe),alt:""},null,8,i2),n("span",null,r(a(d)("qa_library")),1)])]),_:1}),C.value?(u(),R(y,{key:0,onClick:v[4]||(v[4]=E(I=>ne(3),["prevent"]))},{default:s(()=>[n("span",_2,[v[7]||(v[7]=n("img",{class:"icon",src:At,alt:""},null,-1)),n("span",null,r(a(d)("official_account_library")),1)])]),_:1})):O("",!0)]),_:1})]),default:s(()=>[t(M,{type:"primary",onClick:v[1]||(v[1]=E(()=>{},["prevent"]))},{icon:s(()=>[t(a(Oe))]),default:s(()=>[p(" "+r(a(d)("create_library_btn")),1)]),_:1})]),_:1})):O("",!0)])]),n("div",r2,[n("div",{class:J(["group-list-box",{"hide-group":T.value}])},[t(Me,{style:{"padding-right":"16px"}},{default:s(()=>[n("div",d2,[T.value?O("",!0):(u(),k("div",c2,[n("div",null,r(a(d)("library_groups")),1),t(X,{title:a(d)("create_group")},{default:s(()=>[n("div",{class:"hover-btn-wrap",onClick:v[5]||(v[5]=I=>G({}))},[t(a(Oe))])]),_:1},8,["title"])]))]),n("div",u2,[t(a(Lt),{modelValue:K.value,"onUpdate:modelValue":v[6]||(v[6]=I=>K.value=I),"item-key":"id",onEnd:ke,move:ye,handle:".drag-btn"},{item:s(({element:I})=>[n("div",{class:J(["classify-item",{active:I.id==U.value}]),onClick:ze=>Q(I)},[n("div",h2,[I.id>0?(u(),k("span",f2,[t(pe,{name:"drag"})])):(u(),k("span",m2)),p(" "+r(I.group_name),1)]),n("div",v2,[n("div",{class:J(["num",{"num-block":I.id<=0}])},r(I.total),3),I.id>0?(u(),k("div",g2,[t(V,{placement:"bottomRight"},{overlay:s(()=>[t(Z,null,{default:s(()=>[t(y,null,{default:s(()=>[n("div",{onClick:E(ze=>G(I),["stop"])},r(a(d)("rename")),9,k2)]),_:2},1024),t(y,null,{default:s(()=>[n("div",{onClick:E(ze=>ce(I),["stop"])},r(a(d)("delete")),9,b2)]),_:2},1024)]),_:2},1024)]),default:s(()=>[n("div",y2,[t(a(gt))])]),_:2},1024)])):O("",!0)])],10,p2)]),_:1},8,["modelValue"])])]),_:1}),t(X,{placement:"right",title:T.value?a(d)("expand_groups"):a(d)("collapse_groups")},{default:s(()=>[n("div",{class:"hide-group-box",onClick:re},[T.value?(u(),R(a(xe),{key:1})):(u(),R(a(yt),{key:0}))])]),_:1},8,["title"])],2),t(Me,{style:{"padding-right":"16px",flex:"1"}},{default:s(()=>[t(Xt,{"show-create":A.value,list:oe.value,onEdit:Y,onDelete:B,onOpenEditGroupModal:F},null,8,["show-create","list"])]),_:1})])]),t(fa,{ref_key:"addLibrayPopup",ref:e,onOk:de},null,512),t(Ha,{ref_key:"addLibraryModelRef",ref:b},null,512),t(Ja,{ref_key:"addGroupRef",ref:D,onOk:c},null,512),t(Ya,{ref_key:"editGroupRef",ref:N,onOk:c},null,512),t(zt,{ref_key:"wxAppRef",ref:h,title:a(d)("create_library_btn"),okText:a(d)("next_step"),"disabled-app-ids":$.value,onOk:ge},null,8,["title","okText","disabled-app-ids"])])}}},J2=le(C2,[["__scopeId","data-v-ff1929fa"]]);export{J2 as default};
