{"version":3,"file":"index-DZpR1tM9.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/user/aliocr/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"aliocr-main\">\r\n    <div class=\"aliocr-title\">{{ t('title') }}</div>\r\n    <div class=\"aliocr-switch-box\">\r\n      <div class=\"aliocr-switch-nav-box\">\r\n        <svg-icon name=\"ali-ocr\" style=\"font-size: 24px; color: #FF5915\"></svg-icon>\r\n        <div class=\"aliocr-switch-nav-title\">{{ t('switch_title') }}</div>\r\n      </div>\r\n      <div class=\"aliocr-info\">{{ t('switch_info') }}</div>\r\n      <div class=\"aliocr-switch-btn-box\">\r\n        <a-switch\r\n          @change=\"onChangeSwitch\"\r\n          v-model:checked=\"aliocrSwitch\"\r\n          :checked-children=\"t('switch_on')\"\r\n          :un-checked-children=\"t('switch_off')\"\r\n          :checkedValue=\"true\"\r\n          :unCheckedValue=\"false\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <a-spin :tip=\"t('loading')\" :spinning=\"spinning\">\r\n      <div class=\"aliocr-config-box\">\r\n        <div class=\"aliocr-config-nav\">\r\n          <SettingOutlined style=\"font-size: 16px;\" />\r\n          <div class=\"aliocr-config-nav-title\">{{ t('config_title') }}</div>\r\n          <div class=\"aliocr-config-nav-line\"></div>\r\n          <div class=\"alicor-config-nav-url\" @click=\"onGoUrl('https://www.aliyun.com/product/ai/docmind?spm=5176.28536895.J_kUfM_yzYYqU72woCZLHoY.6.28bd586cZUeowZ')\">{{ t('config_help_link') }}</div>\r\n        </div>\r\n        <div class=\"aliocr-config-form\">\r\n          <div class=\"aliocr-config-form-item\">\r\n            <div class=\"aliocr-config-form-label\">{{ t('accesskey_id_label') }}</div>\r\n            <a-input v-model:value=\"formState.ali_ocr_key\" :placeholder=\"t('accesskey_id_placeholder')\" />\r\n          </div>\r\n          <div class=\"aliocr-config-form-item\">\r\n            <div class=\"aliocr-config-form-label\">{{ t('accesskey_secret_label') }}</div>\r\n            <a-input v-model:value=\"formState.ali_ocr_secret\" :placeholder=\"t('accesskey_secret_placeholder')\" />\r\n          </div>\r\n          <div class=\"aliocr-config-form-item\">\r\n            <div class=\"aliocr-config-form-label\">{{ t('after_config') }} <div class=\"alicor-config-nav-url\" @click=\"handleTest\">{{ t('test_btn') }}</div> </div>\r\n            <a-button type=\"primary\" @click=\"handleSave\">{{ t('save_btn') }}</a-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </a-spin>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, createVNode } from 'vue'\r\nimport { useCompanyStore } from '@/stores/modules/company'\r\nimport { checkAliOcr, saveAliOcr } from '@/api/user/index.js'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport { SettingOutlined, ExclamationCircleOutlined } from '@ant-design/icons-vue'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst { t } = useI18n('views.user.aliocr.index')\r\n\r\nconst aliocrSwitch = ref(false)\r\nconst formState = reactive({\r\n  ali_ocr_key: '',\r\n  ali_ocr_secret: ''\r\n})\r\nconst spinning = ref(false)\r\nconst companyStore = useCompanyStore()\r\n\r\nconst handleGetCompany = async() => {\r\n  await companyStore.getCompanyInfo()\r\n}\r\n\r\nfunction checkFormState() {\r\n  if (!formState.ali_ocr_key) {\r\n    return t('accesskey_id_required')\r\n  }\r\n  if (!formState.ali_ocr_secret) {\r\n    return t('accesskey_secret_required')\r\n  }\r\n}\r\n\r\nconst onChangeSwitch = (check) => {\r\n  if (check) {\r\n    const errMsg = checkFormState()\r\n    if (errMsg) {\r\n      aliocrSwitch.value = !aliocrSwitch.value\r\n      Modal.confirm({\r\n        title: t('modal_title'),\r\n        icon: createVNode(ExclamationCircleOutlined),\r\n        content: t('modal_content'),\r\n        okText: t('modal_ok'),\r\n        cancelText: null,\r\n        okCancel: false,\r\n        onOk() {\r\n        },\r\n        onCancel() {}\r\n      })\r\n    } else {\r\n      handleSave()\r\n    }\r\n  } else {\r\n    handleSave()\r\n  }\r\n}\r\n\r\nconst handleTest = () => {\r\n  const errMsg = checkFormState()\r\n  if (errMsg) {\r\n    return message.error(errMsg)\r\n  }\r\n  spinning.value = true\r\n  checkAliOcr({\r\n    ...formState\r\n  }).then((res) => {\r\n    message.success(t('test_success'))\r\n  }).finally(() => {\r\n    spinning.value = false\r\n  })\r\n}\r\n\r\nconst handleSave = () => {\r\n  const errMsg = checkFormState()\r\n  if (errMsg) {\r\n    return message.error(errMsg)\r\n  }\r\n  spinning.value = true\r\n  saveAliOcr({\r\n    ali_ocr_switch: aliocrSwitch.value ? 1 : 2,\r\n    ...formState\r\n  }).then((res) => {\r\n    message.success(t('save_success'))\r\n    handleGetCompany()\r\n  }).finally(() => {\r\n    spinning.value = false\r\n  })\r\n}\r\n\r\nconst onGoUrl = (url) => {\r\n  window.open(url)\r\n}\r\n\r\nonMounted(async() => {\r\n  await handleGetCompany()\r\n  if (companyStore.ali_ocr_key) {\r\n    formState.ali_ocr_key = companyStore.ali_ocr_key\r\n  }\r\n  if (companyStore.ali_ocr_secret) {\r\n    formState.ali_ocr_secret = companyStore.ali_ocr_secret\r\n  }\r\n  if (companyStore.ali_ocr_switch) {\r\n    aliocrSwitch.value = companyStore.ali_ocr_switch == 1 ? true : false\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.aliocr-main {\r\n  .aliocr-title {\r\n    display: flex;\r\n    width: 100%;\r\n    padding: 12px 24px;\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    border-radius: 2px 2px 0 0;\r\n    border-bottom: 1px solid #F0F0F0;\r\n    background: #FFF;\r\n    color: #262626;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n  }\r\n\r\n  .aliocr-switch-box {\r\n    display: flex;\r\n    flex-direction: column;\r\n    width: 552px;\r\n    height: 144px;\r\n    flex-shrink: 0;\r\n    border-radius: 6px;\r\n    background: #FFF0EB;\r\n    padding: 24px;\r\n    margin: 16px 24px;\r\n    background-image: url('@/assets/img/database/ali-ocr.png');\r\n    background-size: 297px auto;\r\n    background-repeat: no-repeat;\r\n    background-position: right;\r\n\r\n    .aliocr-switch-nav-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n\r\n      .aliocr-switch-nav-title {\r\n        color: #262626;\r\n        font-size: 20px;\r\n        font-style: normal;\r\n        font-weight: 600;\r\n        line-height: 28px;\r\n      }\r\n    }\r\n\r\n    .aliocr-info {\r\n      color: #3a4559;\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 22px;\r\n      margin: 8px 0 16px;\r\n    }\r\n  }\r\n\r\n  .aliocr-config-box {\r\n    width: calc(100% - 48px);\r\n    height: 130px;\r\n    flex-shrink: 0;\r\n    border-radius: 6px;\r\n    background: #F2F4F7;\r\n    margin-left: 24px;\r\n\r\n    .aliocr-config-nav {\r\n      display: flex;\r\n      width: 100%;\r\n      padding: 16px;\r\n      align-items: center;\r\n      gap: 8px;\r\n      border-radius: 4px;\r\n\r\n      .aliocr-config-nav-title {\r\n        color: #262626;\r\n        font-size: 16px;\r\n        font-style: normal;\r\n        font-weight: 600;\r\n        line-height: 24px;\r\n      }\r\n\r\n      .aliocr-config-nav-line {\r\n        width: 1px;\r\n        height: 16px;\r\n        border-radius: 1px;\r\n        background: #D9D9D9;\r\n      }\r\n    }\r\n\r\n    .aliocr-config-form {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 16px;\r\n      margin: 0 16px;\r\n\r\n      .aliocr-config-form-item {\r\n        display: flex;\r\n        width: 360px;\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        gap: 4px;\r\n\r\n        .aliocr-config-form-label {\r\n          color: #262626;\r\n          text-align: right;\r\n          font-size: 14px;\r\n          font-style: normal;\r\n          font-weight: 400;\r\n          line-height: 22px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .alicor-config-nav-url {\r\n      display: inline-block ;\r\n      color: #2475fc;\r\n      font-size: 14px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      line-height: 22px;\r\n      cursor: pointer;\r\n\r\n      &:hover {\r\n        opacity: 0.8;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"],"names":["t","useI18n","aliocrSwitch","ref","formState","reactive","spinning","companyStore","useCompanyStore","handleGetCompany","checkFormState","onChangeSwitch","check","Modal","createVNode","ExclamationCircleOutlined","handleSave","handleTest","errMsg","message","checkAliOcr","res","saveAliOcr","onGoUrl","url","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","_unref","_hoisted_3","_hoisted_4","_createVNode","_component_svg_icon","_hoisted_5","_hoisted_6","_hoisted_7","_component_a_switch","$event","_component_a_spin","_hoisted_8","_hoisted_9","SettingOutlined","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_component_a_input","_cache","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_createTextVNode","_component_a_button"],"mappings":"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"}