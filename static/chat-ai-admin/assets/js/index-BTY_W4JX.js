import{C as j}from"./config-page-menu-m5rCHduL.js";import{b as L,bi as E,d as q,bM as T}from"../../index-CPkdGIiL.js";import{f as b,r as g,w as Y,o as A,Y as I,a5 as n,k as r,a2 as i,a4 as x,u as h,B as z,G as D,_ as k,J as B}from"./vue-chunks-Ci-XTWEs.js";import{A as G}from"./avatar-input-DUNM9Pzu.js";import{a as F,F as w,e as J,I as Q,Q as H,B as K}from"./ui-antd-Bw8cEW5z.js";import"./utils-ChQO-_r6.js";const W={class:"form-box"},X={class:"form-box-header"},Z={class:"form-box-label"},aa={__name:"library-form",props:{value:{type:Object,default:()=>({})},saveLoading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(m,{emit:u}){F.config({duration:2});const s=u,l=m,f=b(1),c=w.useForm,p=b(!1),t=E,a=g({type:f.value,library_name:"",library_intro:"",use_model:"",avatar:t,avatar_file:"",is_offline:!1,model_config_id:""}),v=g({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}],library_intro:[{required:!0,message:"请输入库简介",trigger:"change"}]}),S=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},{validate:C,validateInfos:y}=c(a,v),U=()=>{C().then(()=>{M()}).catch(e=>{})},M=()=>{let e=B(a);s("submit",e)},N=e=>{p.value=+e.type,a.library_name=e.library_name,a.library_intro=e.library_intro,a.use_model=e.use_model,a.model_config_id=e.model_config_id,a.avatar=e.avatar?e.avatar:t,a.avatar_file=e.avatar_file?e.avatar_file:"",a.is_offline=e.is_offline};return Y(l.value,e=>{N({...e})}),A(()=>{}),(e,o)=>{const O=q,P=Q,d=J,R=H,V=K,$=w;return k(),I("div",W,[n("div",X,[n("div",Z,[r(O,{class:"form-box-label-icon",name:"book",style:{"font-size":"16px",color:"#333"}}),o[3]||(o[3]=n("span",{class:"form-box-label-text"},"知识库信息",-1))]),o[4]||(o[4]=n("div",null,null,-1))]),r($,{"label-col":{span:6},style:{width:"600px"}},{default:i(()=>[r(d,x({ref:"name",label:"知识库名称"},h(y).library_name),{default:i(()=>[r(P,{value:a.library_name,"onUpdate:value":o[0]||(o[0]=_=>a.library_name=_),placeholder:"请输入知识库名称，最多20个字","show-count":"",maxlength:20},null,8,["value"])]),_:1},16),r(d,{label:"知识库简介"},{default:i(()=>[r(R,{value:a.library_intro,"onUpdate:value":o[1]||(o[1]=_=>a.library_intro=_),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),r(d,x({ref:"name",label:"知识库封面"},h(y).avatar),{default:i(()=>[r(G,{value:a.avatar,"onUpdate:value":o[2]||(o[2]=_=>a.avatar=_),onChange:S},null,8,["value"]),o[5]||(o[5]=n("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[5]},16),r(d,{"wrapper-col":{offset:6,span:8}},{default:i(()=>[r(V,{type:"primary",style:{"margin-left":"8px"},loading:m.saveLoading,onClick:z(U,["prevent"])},{default:i(()=>o[6]||(o[6]=[D("保存")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1})])}}},ea=L(aa,[["__scopeId","data-v-447abbf7"]]),ta={class:"add-library-page"},oa={class:"page-container"},ra={class:"form-box-wrapper"},sa={__name:"index",setup(m){const u=T(),s=g({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),l=b(!1),f=t=>{Object.assign(s,t),l.value=!0,c().then(()=>{l.value=!1}).catch(()=>{l.value=!1})},c=async()=>{let t={...B(s)};delete t.library_key,t.avatar_file?(t.avatar=t.avatar_file,delete t.avatar_file):(delete t.avatar,delete t.avatar_file),await u.saveEditLibrary(t),F.success("修改成功")},p=()=>{Object.assign(s,{...u.libraryInfo})};return A(()=>{p()}),(t,a)=>(k(),I("div",ta,[r(j),n("div",oa,[n("div",ra,[r(ea,{value:s,"onUpdate:value":a[0]||(a[0]=v=>s=v),saveLoading:l.value,onSubmit:f},null,8,["value","saveLoading"])])])]))}},ma=L(sa,[["__scopeId","data-v-8c2014a2"]]);export{ma as default};
