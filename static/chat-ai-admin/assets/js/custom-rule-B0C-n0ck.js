import{r as v,E as K,j as P,a as m,p,y as k,t as h,u as d,ag as U,b as o,_ as Y,v as i,e as g,q as b,F as N}from"./vue-chunks-BdaA73Wf.js";import{am as A,aw as R,ax as G}from"./index-Cg7-0swo.js";import{u as J}from"../../index-DSFcP5NQ.js";import{_ as Q}from"./emoji-mart-BBMRoEa3.js";import{B as W,a5 as X,x as Z,H as ee,a9 as te,b9 as ne,M as $,b as S,O as B}from"./ui-antd-Dl1wwwCD.js";import"./editor-cherry-CFIsbKoN.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";const ae={class:"custom-rule-page"},se={class:"toolbar"},oe={class:"table-box"},ce={key:0},ie={key:0},_e={style:{"max-width":"360px","white-space":"normal"}},le={style:{"margin-left":"4px"}},me={key:5},ue=["onClick"],pe={key:0,class:"actions-disabled"},re=["onClick"],he=["onClick"],de={__name:"custom-rule",setup(ge){const f=U(),{t:e}=J("views.explore.ai-comment-management.custom-rule"),x=v(""),I=v([]),C=v(!1),_=K({page:1,size:10,total:0}),M=[{title:e("column_rule_name"),dataIndex:"rule_name",key:"rule_name"},{title:e("column_delete_comment"),dataIndex:"delete_comment_switch",key:"delete_comment_switch"},{title:e("column_reply_comment"),dataIndex:"reply_comment_switch",key:"reply_comment_switch"},{title:e("column_elect_comment"),dataIndex:"elect_comment_switch",key:"elect_comment_switch"},{title:e("column_task_info"),dataIndex:"task_info",key:"task_info"},{title:e("column_switch"),dataIndex:"switch",key:"switch"},{title:e("column_create_time"),dataIndex:"create_time",key:"create_time"},{title:e("column_actions"),dataIndex:"actions",key:"actions"}],y=()=>{C.value=!0,A({page:_.page,size:_.size,rule_name:x.value,is_default:0}).then(t=>{const a=(t==null?void 0:t.data)||{list:[],total:0};I.value=a.list||[],_.total=+a.total||0}).finally(()=>{C.value=!1})},z=()=>{_.page=1,y()},O=t=>{_.page=t.current,_.size=t.pageSize,y()},D={delete_comment_switch:e("switch_delete_comment"),reply_comment_switch:e("switch_reply_comment"),elect_comment_switch:e("switch_elect_comment"),switch:e("switch_rule_enable")},w=async(t,a,u)=>{if(!u){$.confirm({title:e("confirm_modal_title"),content:e("confirm_close_switch",{rule_name:t.rule_name,switch_name:D[a]}),icon:k(B),onOk:async()=>{const l=u?1:0;await R({id:t.id,change_fields:a,switch_status:l}),t[a]=String(l),S.success(e("message_operation_success"))}});return}const r=u?1:0;await R({id:t.id,change_fields:a,switch_status:r}),t[a]=String(r),S.success(e("message_operation_success"))},E=t=>{f.push({path:"/explore/index/ai-comment-management/create-custom-rule",query:{id:t.id}})},V=t=>{f.push({path:"/explore/index/ai-comment-management/create-custom-rule",query:{id:t.id,copy:1}})},j=t=>{$.confirm({title:e("confirm_delete_rule_title"),icon:k(B),onOk:async()=>{await G({id:t.id}),S.success(e("message_delete_success")),y()},content:e("confirm_delete_rule_content")})},q=()=>{f.push({path:"/explore/index/ai-comment-management/create-custom-rule"})},F=t=>{try{const a=new Date(Number(t)*1e3),u=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0");return`${u}-${r}-${l}`}catch{return""}};return P(()=>{y()}),(t,a)=>{const u=W,r=X,l=ee,L=te,T=ne,H=Z;return o(),m("div",ae,[p("div",se,[k(u,{type:"primary",onClick:q},{default:h(()=>[Y(i(d(e)("btn_add_rule")),1)]),_:1}),k(r,{value:x.value,"onUpdate:value":a[0]||(a[0]=c=>x.value=c),allowClear:"",placeholder:d(e)("search_rule_name_placeholder"),style:{width:"300px"},onSearch:z,onPressEnter:z},null,8,["value","placeholder"])]),p("div",oe,[k(H,{columns:M,"data-source":I.value,loading:C.value,"row-key":"id",pagination:{current:_.page,pageSize:_.size,total:_.total,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:O},{headerCell:h(({column:c})=>[typeof c.title=="string"?(o(),m("span",ce,i(c.title),1)):b("",!0)]),bodyCell:h(({column:c,record:n})=>[c.key==="delete_comment_switch"?(o(),g(l,{key:0,checked:Number(n.delete_comment_switch)===1,onChange:s=>w(n,"delete_comment_switch",s)},null,8,["checked","onChange"])):c.key==="reply_comment_switch"?(o(),g(l,{key:1,checked:Number(n.reply_comment_switch)===1,onChange:s=>w(n,"reply_comment_switch",s)},null,8,["checked","onChange"])):c.key==="elect_comment_switch"?(o(),g(l,{key:2,checked:Number(n.elect_comment_switch)===1,onChange:s=>w(n,"elect_comment_switch",s)},null,8,["checked","onChange"])):c.key==="switch"?(o(),g(l,{key:3,checked:Number(n.switch)===1,onChange:s=>w(n,"switch",s)},null,8,["checked","onChange"])):c.key==="task_info"?(o(),m(N,{key:4},[(n.task_info||[]).length===0?(o(),m("span",ie,"-")):(o(),m(N,{key:1},[p("span",null,i((n.task_info||[]).slice(0,2).map(s=>s.task_name).join(", ")),1),(n.task_info||[]).length>2?(o(),g(L,{key:0,trigger:"hover",placement:"top"},{content:h(()=>[p("div",_e,i((n.task_info||[]).map(s=>s.task_name).join(", ")),1)]),default:h(()=>[p("a",le,"+"+i((n.task_info||[]).length-2),1)]),_:2},1024)):b("",!0)],64))],64)):c.key==="create_time"?(o(),m("span",me,i(F(n.create_time)),1)):c.key==="actions"?(o(),g(T,{key:6},{default:h(()=>[p("a",{onClick:s=>E(n)},i(d(e)("action_edit")),9,ue),n.is_default=="1"?(o(),m("span",pe,i(d(e)("action_delete")),1)):(o(),m("a",{key:1,onClick:s=>j(n)},i(d(e)("action_delete")),9,re)),p("a",{onClick:s=>V(n)},i(d(e)("action_copy")),9,he)]),_:2},1024)):b("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},Ne=Q(de,[["__scopeId","data-v-4120190d"]]);export{Ne as default};
//# sourceMappingURL=custom-rule-B0C-n0ck.js.map
