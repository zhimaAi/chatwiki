import{u as mt,_ as ct,o as ft}from"../../index-DSFcP5NQ.js";import{ah as qe,r as k,c as Fe,E as P,w as U,j as gt,V as ht,a as f,b as c,y as i,e as ee,q as A,t as u,p as _,u as o,_ as x,v as p,z as pe,Y as te,F as Y,l as ae,h as vt,i as I}from"./vue-chunks-BdaA73Wf.js";import{_ as yt,E as bt,e as kt,P as xt}from"./emoji-mart-BBMRoEa3.js";import{u as wt}from"./index-B_UHbFfL.js";import{a as Ct,v as St,b as Mt,d as jt}from"./index-C67uUbSa.js";import{g as At}from"./index-Cg7-0swo.js";import{d as Tt}from"./utils-CvB22N-W.js";import{$ as qt,F as Ft,c as Dt,I as Ut,V as Ot,aC as Lt,p as Pt,B as $t,a$ as zt,at as me,a9 as Rt,q as Et,m as Vt,a1 as De,X as Yt,ao as It,Z as Nt,u as Bt,v as Ht,ai as Kt,i as Jt,am as Wt,f as Xt,g as Zt,M as Gt,b}from"./ui-antd-Dl1wwwCD.js";const Qt={class:"multi-reply-card"},ea={class:"tab-with-icon"},ta={class:"form-grid"},aa={class:"upload-row"},sa={key:0,class:"preview-wrap"},na=["src"],ia={class:"tab-with-icon"},la={class:"text-area"},oa={class:"emoji-row"},ra={class:"tab-with-icon"},ua={class:"form-grid"},_a={class:"upload-actions"},da={key:0,class:"preview-wrap"},pa=["src"],ma={class:"hint"},ca={class:"tab-with-icon"},fa={class:"form-grid"},ga={class:"tab-with-icon"},ha={class:"form-grid"},va={style:{"margin-top":"2px",color:"#FB363F"}},ya={style:{"margin-top":"2px",color:"#8C8C8C"}},ba={class:"upload-row"},ka={key:0,class:"preview-wrap"},xa=["src"],wa={class:"tab-with-icon"},Ca={class:"smart-tab-box"},Sa={key:0,class:"smart-preview"},Ma={class:"smart-list-card"},ja={class:"smart-card-header"},Aa={class:"smart-card-content"},Ta={class:"smart-card-title"},qa={class:"smart-card-text"},Fa={key:0,class:"smart-line-text"},Da={key:1,class:"empty-line"},Ua=["innerHTML"],Oa={key:3,href:"javascript:;",class:"link"},La={key:0},Pa={class:"smart-card-footer"},$a={class:"smart-footer-left"},za={class:"smart-menu-name"},Ra={class:"smart-update-time"},Ea={class:"smart-modal"},Va={class:"smart-modal-header"},Ya={class:"ml8"},Ia={key:0,class:"smart-empty"},Na={key:1,class:"smart-grid"},Ba=["onClick"],Ha={class:"smart-list-card"},Ka={class:"smart-card-header"},Ja={class:"smart-card-content"},Wa={class:"smart-card-title"},Xa={class:"smart-card-text"},Za={key:0,class:"smart-line-text"},Ga={key:1,class:"empty-line"},Qa=["innerHTML"],es={key:3,href:"javascript:;",class:"link"},ts={key:0},as={class:"smart-card-footer"},ss={class:"smart-footer-left"},ns={class:"smart-menu-name"},is={class:"smart-update-time"},ls={key:0,class:"smart-radio-inline"},os=["onClick"],rs={__name:"multi-reply",props:{value:{type:Object,default:()=>({type:"text",description:""})},reply_index:{type:Number,default:0}},emits:["update:value","change","del"],setup(Ue,{expose:Oe,emit:Le}){const{t:n}=mt("components.replay-card.multi-reply"),N=qe(),se=k(["exploreSubscribeReply","exploreCustomMenu"]),ce=k(!1),B=k(!1),$=Fe(()=>se.value.includes(N.name)?ce.value:B.value),H=Ue,ne=Le,w=k(H.value.type||"text"),g=P({url:"",title:"",description:"",thumb_url:""}),S=P({description:""}),F=P({thumb_url:""}),D=P({title:"",url:""}),h=P({title:"",appid:"",page_path:"",thumb_url:""}),d=P({id:"",title:"",update_time:0,avatar_url:"",lines:[]}),z=k(!1),R=k([]),j=k(""),K=k([]),J=k(""),fe=ft,O=qe().query,ge=Fe(()=>!B.value&&se.value.includes(N.name)),W=k(null),he=k(!0);function Pe(e){const t=String(e||"");return t?St({ability_type:"robot_smart_menu",robot_id:t}).then(a=>{var r,m;const s=(m=(r=a==null?void 0:a.data)==null?void 0:r.robot_config)==null?void 0:m.switch_status;B.value=String(s||"0")=="1"}):(B.value=!1,Promise.resolve())}function $e(){Ct({ability_type:"robot_smart_menu"}).then(e=>{var a,s;const t=(s=(a=e==null?void 0:e.data)==null?void 0:a.user_config)==null?void 0:s.switch_status;ce.value=String(t||"0")=="1"})}let X=!1;const ze=new bt(kt),ve={span:5},ye={span:19},Re={span:4},Ee={span:20},Z=k(null),be=k(null),G=k(null);U(()=>S.description,e=>{const t=String(e||"");t.length>300&&(b.warning(n("msg_max_chars")),S.description=t.slice(0,300))}),U(()=>g.description,e=>{const t=String(e||"");t.length>300&&(b.warning(n("msg_max_chars")),g.description=t.slice(0,300))});const ie={imageText:{url:[{required:!0,message:n("msg_input_http_https")},{validator:ke}],title:[{required:!0,message:n("msg_input_title")}],description:[{required:!0,message:n("msg_input_desc")}],thumb_url:[{required:!0,message:n("msg_upload_link_image")}]},url:{title:[{required:!0,message:n("msg_input_title_2")}],url:[{required:!0,message:n("msg_input_http_https_2")},{validator:ke}]},card:{title:[{required:!0,message:n("msg_input_mini_title")}],appid:[{required:!0,message:n("msg_input_mini_appid")}],page_path:[{required:!0,message:n("msg_input_mini_path")}],thumb_url:[{required:!0,message:n("msg_upload_mini_cover")}]},smartMenu:{id:[{required:!0,message:n("msg_select_smart")}]}};function ke(e,t){return t?/^https?:\/\//.test(t)?Promise.resolve():Promise.reject(n("msg_link_protocol")):Promise.resolve()}const le=k(!1),xe=k(null);function Ve(e){var s,r;const t=(e==null?void 0:e.native)||"";if(!t)return;let a=(r=(s=xe.value)==null?void 0:s.$el)==null?void 0:r.querySelector("textarea");if(a&&typeof a.selectionStart=="number"){const m=a.selectionStart,v=a.selectionEnd,q=S.description||"";let y=q.slice(0,m)+t+q.slice(v);(y||"").length>300&&(b.warning(n("msg_max_chars_2")),y=(y||"").slice(0,300)),S.description=y,I(()=>{a.focus();const M=Math.min(m+t.length,(S.description||"").length);a.setSelectionRange(M,M)})}else{let m=(S.description||"")+t;(m||"").length>300&&(b.warning(n("msg_max_chars_2")),m=(m||"").slice(0,300)),S.description=m}le.value=!1,T()}function Ye(){T()}function Ie(){ne("del",H.reply_index)}function E(e){return e.type==="image/jpeg"||e.type==="image/png"?e.size/1024<1024*2?!0:(b.error(n("msg_image_size")),!1):(b.error(n("msg_image_format")),!1)}async function V({file:e,onError:t,onSuccess:a},s){var r,m;try{const v=await wt({category:s,file:e}),q=((r=v==null?void 0:v.data)==null?void 0:r.link)||((m=v==null?void 0:v.data)==null?void 0:m.url)||"";w.value==="imageText"?(g.thumb_url=q,I(()=>{var y,M;(M=(y=Z.value)==null?void 0:y.validateFields)==null||M.call(y,["thumb_url"])})):w.value==="image"?F.thumb_url=q:w.value==="card"&&(h.thumb_url=q,I(()=>{var y,M;(M=(y=G.value)==null?void 0:y.validateFields)==null||M.call(y,["thumb_url"])})),a&&a(v),T()}catch(v){b.error(n("msg_upload_failed")),t&&t(v)}}function T(){const e=Ne();ne("update:value",e),ne("change",{...e,reply_index:H.reply_index})}function oe(){w.value==="imageText"?(g.thumb_url="",I(()=>{var e,t;(t=(e=Z.value)==null?void 0:e.validateFields)==null||t.call(e,["thumb_url"])})):w.value==="image"?F.thumb_url="":w.value==="card"&&(h.thumb_url="",I(()=>{var e,t;(t=(e=G.value)==null?void 0:e.validateFields)==null||t.call(e,["thumb_url"])})),T()}function Ne(){const e=w.value;return e==="imageText"?{reply_type:e,thumb_url:g.thumb_url||"",title:g.title||"",description:g.description||"",url:g.url||"",page_path:"",appid:"",status:"1",smart_menu_id:"",more_img_text_json:"",media_id:"",pic:g.thumb_url||"",type:e}:e==="text"?{reply_type:e,thumb_url:"",title:"",description:S.description||"",url:"",page_path:"",appid:"",status:"1",smart_menu_id:"",more_img_text_json:"",media_id:"",pic:"",type:e}:e==="image"?{reply_type:e,thumb_url:F.thumb_url||"",title:"",description:"",url:"",page_path:"",appid:"",status:"1",smart_menu_id:"",more_img_text_json:"",media_id:"",pic:F.thumb_url||"",type:e}:e==="url"?{reply_type:e,thumb_url:"",title:D.title||"",description:"",url:D.url||"",page_path:"",appid:"",status:"1",smart_menu_id:"",more_img_text_json:"",media_id:"",pic:"",type:e}:e==="card"?{reply_type:e,thumb_url:h.thumb_url||"",title:h.title||"",description:"",url:"",page_path:h.page_path||"",appid:h.appid||"",status:"1",smart_menu_id:"",more_img_text_json:"",media_id:"",pic:h.thumb_url||"",type:e}:e==="smartMenu"?{reply_type:e,thumb_url:"",title:d.title||"",description:"",url:"",page_path:"",appid:"",status:"1",smart_menu_id:d.id||"",more_img_text_json:"",media_id:"",pic:"",type:e}:{reply_type:"text",thumb_url:"",title:"",description:"",url:"",page_path:"",appid:"",status:"1",smart_menu_id:"",more_img_text_json:"",media_id:"",pic:"",type:"text"}}function Be(){return document.body}function we(){b.info(n("msg_paste_image"))}function re(e){var a;if(X)return;const t=((a=e.clipboardData)==null?void 0:a.items)||[];for(const s of t)if(s.type.indexOf("image")!==-1){const r=s.getAsFile();if(!r)continue;if(!E(r))return;X=!0,V({file:r,onError:()=>{X=!1},onSuccess:()=>{X=!1}},"received_message_images");break}}function He(e){var a,s;const t=(s=(a=e.dataTransfer)==null?void 0:a.files)==null?void 0:s[0];t&&E(t)&&V({file:t,onError:()=>{},onSuccess:()=>{}},"received_message_images")}U(()=>H.value,e=>{var a;const t=(e==null?void 0:e.type)||"text";if(t==="smartMenu"?$.value&&!he.value?w.value="smartMenu":w.value="text":w.value=t,t==="imageText")Object.assign(g,e);else if(t==="text")Object.assign(S,{description:(e==null?void 0:e.description)||""});else if(t==="image")Object.assign(F,{thumb_url:(e==null?void 0:e.thumb_url)||""});else if(t==="url")Object.assign(D,{title:(e==null?void 0:e.title)||"",url:(e==null?void 0:e.url)||""});else if(t==="card")Object.assign(h,e);else if(t==="smartMenu")if($.value){if(d.id=String((e==null?void 0:e.smart_menu_id)||""),d.id&&((a=e==null?void 0:e.smart_menu)!=null&&a.id)){const s=e.smart_menu||{};d.title=s.menu_title||s.menu_name||"",d.update_time=Number(s.update_time||s.create_time||0),d.avatar_url=s.avatar_url||"",d.menu_description=s.menu_description||"",d.lines=ue(Array.isArray(s.menu_content)?s.menu_content:[])}j.value=String(d.id||"")}else W.value=e},{immediate:!0}),U(g,()=>{T()},{deep:!0}),U(S,()=>{T()},{deep:!0}),U(F,()=>{T()},{deep:!0}),U(D,()=>{T()},{deep:!0}),U(h,()=>{T()},{deep:!0});function Ce(e,t="YYYY-MM-DD"){return e?Tt(Number(e)*1e3).format(t):""}function ue(e){const t=[];return(Array.isArray(e)?e:[]).forEach(a=>{const s=String((a==null?void 0:a.menu_type)||""),r=String((a==null?void 0:a.content)||"");if(s==="0")if(r==="")t.push({kind:"newline"});else if(/<a[\s\S]*?<\/a>/.test(r)){const m=/href\s*=\s*['"]\s*#\s*['"]/i.test(r)?r.replace(/href\s*=\s*['"]\s*#\s*['"]/ig,'href="javascript:;"'):r.replace(/href=/ig,'target="_blank" href=');t.push({kind:"html",html:m})}else t.push({kind:"text",text:r});else s==="1"&&t.push({kind:"keyword",text:r,serial_no:(a==null?void 0:a.serial_no)||""})}),t.slice(0,8)}function Ke(e){const t=[];return(Array.isArray(e)?e:[]).forEach(a=>{const s=(a==null?void 0:a.type)||(a==null?void 0:a.reply_type);if(s==="text")a!=null&&a.description&&t.push({kind:"text",text:a.description});else if(s==="imageText"){const r=(a==null?void 0:a.title)||(a==null?void 0:a.description)||s("label_image_text");t.push({kind:"keyword",text:r})}else if(s==="url"){const r=(a==null?void 0:a.title)||s("label_link");t.push({kind:"keyword",text:r})}else if(s==="image")t.push({kind:"text",text:s("label_image")});else if(s==="card"){const r=(a==null?void 0:a.title)||s("label_mini_card");t.push({kind:"text",text:r})}else if(s==="smartMenu"){const r=(a==null?void 0:a.title)||s("label_smart_menu");t.push({kind:"text",text:r})}}),t.slice(0,8)}function Se(e){return Array.isArray(e==null?void 0:e.menu_content)&&e.menu_content.length?ue(e.menu_content):Ke((e==null?void 0:e.reply_content)||[])}function Je(){z.value=!0,j.value=String(d.id||""),ge.value?Xe().then(()=>{var t;const e=J.value||((t=K.value[0])==null?void 0:t.id)||"";J.value=String(e),e&&Q(e)}):Q()}function We(){const e=`/#/robot/ability/smart-menu?id=${O.id}&robot_key=${O.robot_key}`;window.open(e,"_blank")}function Q(e){const t=String(e||O.id||"");Mt({robot_id:t}).then(a=>{var r;const s=Array.isArray((r=a==null?void 0:a.data)==null?void 0:r.list)?a.data.list:[];R.value=s.map(m=>({id:String(m.id||""),menu_title:m.menu_title||m.menu_name||n("smart_menu_3"),update_time:Number(m.update_time||m.create_time||0),avatar_url:m.avatar_url||"",menu_description:m.menu_description||"",menu_content:Array.isArray(m.menu_content)?m.menu_content:[],reply_content:Array.isArray(m.reply_content)?m.reply_content:[]}))}).catch(()=>{R.value=[]})}async function Xe(){try{const e=await At(),t=Array.isArray(e==null?void 0:e.data)?e.data:[];K.value=t.map(a=>({id:String(a.id||""),name:a.robot_name||a.name||a.app_name||a.id}))}catch{K.value=[]}}function Ze(){if(!j.value){b.warning(n("msg_select_one_smart"));return}const e=R.value.find(t=>String(t.id)===String(j.value));if(!e){b.error(n("msg_smart_not_found"));return}d.id=String(e.id||j.value),d.title=e.menu_title||e.menu_name||"",d.update_time=Number(e.update_time||e.create_time||0),d.avatar_url=e.avatar_url||"",d.menu_description=e.menu_description||"",d.lines=Se(e),w.value="smartMenu",T(),z.value=!1}function Ge(){z.value=!1}function Me(e){const t=String(e||"");j.value=String(j.value||"")===t?"":t}function Qe(e){const t=`/#/robot/ability/smart-menu/add-rule?id=${O.id}&robot_key=${O.robot_key}&rule_id=${e.id}`;window.open(t,"_blank")}function et(e){jt({id:e.id,robot_id:O.id}).then(t=>{t&&t.res==0&&(b.success(n("msg_delete_success")),Q())})}function je(e){var s,r;const t=(r=(s=e.target)==null?void 0:s.closest)==null?void 0:r.call(s,"a");if(!t)return;const a=String(t.getAttribute("href")||"");(a==="#"||a==="javascript:;")&&(e.preventDefault(),e.stopPropagation())}async function tt(){var t,a,s;const e=w.value;try{if(e==="imageText")try{return await((t=Z.value)==null?void 0:t.validate()),!0}catch{return b.warning(e("msg_complete_image_text")),!1}if(e==="text")return String(S.description||"").trim()?!0:(b.warning(e("msg_input_text")),!1);if(e==="image")return String(F.thumb_url||"").trim()?!0:(b.warning(e("msg_upload_image_2")),!1);if(e==="url")try{return await((a=be.value)==null?void 0:a.validate()),!0}catch{return b.warning(e("msg_complete_url")),!1}if(e==="card")try{return await((s=G.value)==null?void 0:s.validate()),!0}catch{return b.warning(e("msg_complete_mini_card")),!1}if(e==="smartMenu")return String(j.value||d.id||"")?!0:(b.warning(e("msg_select_smart_2")),!1)}catch{return!1}return!0}return gt(async()=>{try{se.value.includes(N.name)?await $e():await Pe(N.query.id)}finally{he.value=!1}}),U(()=>$.value,e=>{var t;if(e&&W.value){const a=W.value;if(w.value="smartMenu",d.id=String((a==null?void 0:a.smart_menu_id)||""),d.id&&((t=a==null?void 0:a.smart_menu)!=null&&t.id)){const s=a.smart_menu||{};d.title=s.menu_title||s.menu_name||"",d.update_time=Number(s.update_time||s.create_time||0),d.avatar_url=s.avatar_url||"",d.menu_description=s.menu_description||"",d.lines=ue(Array.isArray(s.menu_content)?s.menu_content:[])}j.value=String(d.id||""),W.value=null}}),Oe({validate:tt}),(e,t)=>{const a=ct,s=Ut,r=Dt,m=Ot,v=$t,q=Pt,y=Lt,M=Ft,L=qt,at=Et,st=Rt,nt=Vt,Ae=Yt,it=Nt,lt=Ht,ot=Bt,rt=Kt,Te=Zt,ut=Xt,_t=Jt,dt=Gt,_e=ht("viewer");return c(),f("div",Qt,[i(it,{activeKey:w.value,"onUpdate:activeKey":t[14]||(t[14]=l=>w.value=l),onChange:Ye},{rightExtra:u(()=>[i(v,{type:"text",onClick:Ie},{default:u(()=>[i(o(It),{style:{"font-size":"16px"}})]),_:1})]),default:u(()=>[i(L,{key:"imageText"},{tab:u(()=>[_("span",ea,[i(a,{name:"reply-content-image-text",size:"14"}),x(" "+p(o(n)("tab_image_text")),1)])]),default:u(()=>[_("div",ta,[i(M,{model:g,rules:ie.imageText,ref_key:"imageTextForm",ref:Z,layout:"vertical",labelCol:ve,wrapperCol:ye},{default:u(()=>[i(r,{label:o(n)("label_link_url"),name:"url"},{default:u(()=>[i(s,{value:g.url,"onUpdate:value":t[0]||(t[0]=l=>g.url=l),placeholder:o(n)("ph_link_url")},null,8,["value","placeholder"])]),_:1},8,["label"]),i(r,{label:o(n)("label_link_title"),name:"title"},{default:u(()=>[i(s,{value:g.title,"onUpdate:value":t[1]||(t[1]=l=>g.title=l),placeholder:o(n)("ph_link_title")},null,8,["value","placeholder"])]),_:1},8,["label"]),i(r,{label:o(n)("label_link_desc"),name:"description"},{default:u(()=>[i(m,{value:g.description,"onUpdate:value":t[2]||(t[2]=l=>g.description=l),"auto-size":"",placeholder:o(n)("ph_link_desc"),maxlength:300,showCount:!0},null,8,["value","placeholder"])]),_:1},8,["label"]),i(r,{label:o(n)("label_link_image"),name:"thumb_url"},{default:u(()=>[i(s,{value:g.thumb_url,"onUpdate:value":t[3]||(t[3]=l=>g.thumb_url=l),style:{display:"none"}},null,8,["value"]),i(y,null,{default:u(()=>[_("div",aa,[i(q,{"show-upload-list":!1,"before-upload":E,"custom-request":l=>V(l,"received_message_images"),accept:".png,.jpg,.jpeg"},{default:u(()=>[i(v,{type:"default"},{default:u(()=>[i(o(zt)),x(p(o(n)("btn_upload_image")),1)]),_:1})]),_:1},8,["custom-request"]),i(s,{onPaste:re,onClick:we,placeholder:o(n)("ph_paste_upload")},null,8,["placeholder"])]),g.thumb_url?(c(),f("div",sa,[pe(_("img",{src:g.thumb_url,class:"preview"},null,8,na),[[_e]]),_("span",{class:"del-icon",onClick:oe},[i(o(me))])])):A("",!0)]),_:1})]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1}),i(L,{key:"text"},{tab:u(()=>[_("span",ia,[i(a,{name:"reply-content-text",size:"14"}),x(" "+p(o(n)("tab_text")),1)])]),default:u(()=>[_("div",la,[i(m,{ref_key:"textAreaRef",ref:xe,value:S.description,"onUpdate:value":t[4]||(t[4]=l=>S.description=l),rows:6,placeholder:o(n)("ph_input"),maxlength:300,showCount:!0},null,8,["value","placeholder"]),_("div",oa,[i(st,{open:le.value,"onUpdate:open":t[5]||(t[5]=l=>le.value=l),placement:"bottomLeft",trigger:"click",getPopupContainer:Be},{content:u(()=>[i(o(xt),{data:o(ze),emojiSize:18,showPreview:!1,set:"apple",onSelect:Ve},null,8,["data"])]),default:u(()=>[i(at,{title:o(n)("tip_insert_emoji")},{default:u(()=>[...t[21]||(t[21]=[x("ðŸ˜Š",-1)])]),_:1},8,["title"])]),_:1},8,["open"])])])]),_:1}),i(L,{key:"image"},{tab:u(()=>[_("span",ra,[i(a,{name:"reply-content-image",size:"14"}),x(" "+p(o(n)("tab_image")),1)])]),default:u(()=>[_("div",ua,[_("div",{class:"upload-drop",onPaste:re,onDrop:te(He,["prevent"]),onDragover:t[6]||(t[6]=te(()=>{},["prevent"]))},[_("div",_a,[F.thumb_url?(c(),f("div",da,[pe(_("img",{src:F.thumb_url,class:"preview"},null,8,pa),[[_e]]),_("span",{class:"del-icon",onClick:oe},[i(o(me))])])):A("",!0),i(q,{"show-upload-list":!1,"before-upload":E,"custom-request":l=>V(l,"received_message_images"),accept:".png,.jpg,.jpeg"},{default:u(()=>[_("div",ma,p(o(n)("tip_image_upload")),1)]),_:1},8,["custom-request"])])],32)])]),_:1}),i(L,{key:"url"},{tab:u(()=>[_("span",ca,[i(a,{name:"reply-content-link",size:"14"}),x(" "+p(o(n)("tab_url")),1)])]),default:u(()=>[_("div",fa,[i(M,{model:D,rules:ie.url,ref_key:"urlForm",ref:be,layout:"vertical",labelCol:ve,wrapperCol:ye},{default:u(()=>[i(r,{label:o(n)("label_link_title"),name:"title"},{default:u(()=>[i(s,{value:D.title,"onUpdate:value":t[7]||(t[7]=l=>D.title=l),placeholder:o(n)("ph_input")},null,8,["value","placeholder"])]),_:1},8,["label"]),i(r,{label:o(n)("label_link_url"),name:"url"},{default:u(()=>[i(s,{value:D.url,"onUpdate:value":t[8]||(t[8]=l=>D.url=l),placeholder:o(n)("ph_link_url_2")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1}),i(L,{key:"card"},{tab:u(()=>[_("span",ga,[i(a,{name:"applet",size:"14"}),x(" "+p(o(n)("tab_mini_card")),1)])]),default:u(()=>[_("div",ha,[i(M,{model:h,rules:ie.card,ref_key:"cardForm",ref:G,layout:"vertical",labelCol:Re,wrapperCol:Ee},{default:u(()=>[i(nt,{type:"info",style:{"margin-bottom":"16px"},message:o(n)("tip_mini_card")},null,8,["message"]),i(r,{label:o(n)("label_mini_title"),name:"title"},{default:u(()=>[i(s,{value:h.title,"onUpdate:value":t[9]||(t[9]=l=>h.title=l),placeholder:o(n)("ph_mini_title")},null,8,["value","placeholder"])]),_:1},8,["label"]),i(r,{label:o(n)("label_mini_appid"),name:"appid"},{default:u(()=>[i(s,{value:h.appid,"onUpdate:value":t[10]||(t[10]=l=>h.appid=l),placeholder:o(n)("ph_mini_appid")},null,8,["value","placeholder"]),_("div",va,p(o(n)("tip_mini_appid")),1)]),_:1},8,["label"]),i(r,{label:o(n)("label_mini_path"),name:"page_path"},{default:u(()=>[i(s,{value:h.page_path,"onUpdate:value":t[11]||(t[11]=l=>h.page_path=l),placeholder:o(n)("ph_mini_path")},null,8,["value","placeholder"]),_("div",ya,p(o(n)("tip_mini_path")),1)]),_:1},8,["label"]),i(r,{label:o(n)("label_mini_cover"),name:"thumb_url"},{default:u(()=>[i(s,{value:h.thumb_url,"onUpdate:value":t[12]||(t[12]=l=>h.thumb_url=l),style:{display:"none"}},null,8,["value"]),i(y,null,{default:u(()=>[_("div",ba,[i(q,{"show-upload-list":!1,"before-upload":E,"custom-request":l=>V(l,"received_message_images"),accept:".png,.jpg,.jpeg"},{default:u(()=>[i(v,{type:"default"},{default:u(()=>[x(p(o(n)("btn_upload_image_2")),1)]),_:1})]),_:1},8,["custom-request"]),i(s,{onPaste:re,onClick:we,placeholder:o(n)("ph_paste_upload_2")},null,8,["placeholder"])]),h.thumb_url?(c(),f("div",ka,[pe(_("img",{src:h.thumb_url,class:"preview"},null,8,xa),[[_e]]),_("span",{class:"del-icon",onClick:oe},[i(o(me))])])):A("",!0)]),_:1})]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1}),$.value?(c(),ee(L,{key:"smartMenu"},{tab:u(()=>[_("span",wa,[i(a,{name:"reply-content-smart",size:"14"}),x(" "+p(o(n)("tab_smart_menu")),1)])]),default:u(()=>[_("div",Ca,[i(v,{type:"dashed",class:"choose-smart-btn",onClick:Je},{icon:u(()=>[i(o(De))]),default:u(()=>[x(" "+p(o(n)("btn_choose_smart")),1)]),_:1}),d.id?(c(),f("div",Sa,[_("div",Ma,[_("div",ja,[i(Ae,{src:d.avatar_url||o(fe),size:40,shape:"square",class:"smart-avatar"},null,8,["src"]),_("div",Aa,[_("div",Ta,p(d.menu_description),1),_("div",qa,[(c(!0),f(Y,null,ae(d.lines,(l,C)=>(c(),f("div",{key:C,class:"smart-reply-line",onClick:t[13]||(t[13]=de=>je(de))},[l.kind==="text"?(c(),f("span",Fa,p(l.text),1)):l.kind==="newline"?(c(),f("div",Da)):l.kind==="html"?(c(),f("span",{key:2,innerHTML:l.html},null,8,Ua)):l.kind==="keyword"?(c(),f("a",Oa,[l.serial_no?(c(),f("div",La,p(l.serial_no),1)):A("",!0),x(" "+p(l.text),1)])):A("",!0)]))),128))])])]),_("div",Pa,[_("div",$a,[_("div",za,p(d.title||o(n)("smart_menu")),1),_("div",Ra,p(o(n)("updated_at"))+p(Ce(d.update_time,"YYYY-MM-DD")),1)])])])])):A("",!0)])]),_:1})):A("",!0)]),_:1},8,["activeKey"]),$.value?(c(),ee(dt,{key:0,open:z.value,"onUpdate:open":t[20]||(t[20]=l=>z.value=l),title:o(n)("btn_choose_smart"),width:860,onOk:Ze,onCancel:Ge},{default:u(()=>[_("div",Ea,[_("div",Va,[i(v,{type:"dashed",onClick:We},{icon:u(()=>[i(o(De))]),default:u(()=>[x(" "+p(o(n)("btn_add_smart")),1)]),_:1}),ge.value?(c(),f(Y,{key:0},[_("span",Ya,p(o(n)("label_select_robot")),1),i(ot,{value:J.value,"onUpdate:value":t[15]||(t[15]=l=>J.value=l),style:{width:"220px"},onChange:t[16]||(t[16]=l=>Q(l))},{default:u(()=>[(c(!0),f(Y,null,ae(K.value,l=>(c(),ee(lt,{value:l.id,key:l.id},{default:u(()=>[x(p(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])],64)):A("",!0)]),R.value.length===0?(c(),f("div",Ia,[i(rt,{description:o(n)("empty_smart_menu")},null,8,["description"])])):(c(),f("div",Na,[(c(!0),f(Y,null,ae(R.value,l=>(c(),f("div",{class:vt(["smart-card",{selected:j.value===l.id}]),key:l.id,onClick:C=>Me(l.id)},[_("div",Ha,[_("div",Ka,[i(Ae,{src:l.avatar_url||o(fe),size:40,shape:"square",class:"smart-avatar"},null,8,["src"]),_("div",Ja,[_("div",Wa,p(l.menu_description),1),_("div",Xa,[(c(!0),f(Y,null,ae(Se(l),(C,de)=>(c(),f("div",{key:de,class:"smart-reply-line",onClick:t[17]||(t[17]=pt=>je(pt))},[C.kind==="text"?(c(),f("span",Za,p(C.text),1)):C.kind==="newline"?(c(),f("div",Ga)):C.kind==="html"?(c(),f("span",{key:2,innerHTML:C.html},null,8,Qa)):C.kind==="keyword"?(c(),f("a",es,[C.serial_no?(c(),f("div",ts,p(C.serial_no),1)):A("",!0),x(" "+p(C.text),1)])):A("",!0)]))),128))])])]),_("div",as,[_("div",ss,[_("div",ns,p(l.menu_title||l.menu_name||o(n)("smart_menu_2")),1),_("div",is,p(o(n)("updated_at_2"))+p(Ce(l.update_time,"YYYY-MM-DD")),1)]),_("div",{class:"smart-footer-right",onClick:t[19]||(t[19]=te(()=>{},["stop"]))},[j.value===l.id?(c(),f("span",ls,[_("div",{class:"picked",onClick:C=>Me(l.id)},null,8,os)])):(c(),ee(_t,{key:1,placement:"bottomRight"},{overlay:u(()=>[i(ut,null,{default:u(()=>[i(Te,{key:"edit",onClick:C=>Qe(l)},{default:u(()=>[x(p(o(n)("btn_edit")),1)]),_:1},8,["onClick"]),i(Te,{key:"del",class:"del",onClick:C=>et(l),style:{color:"#FF4D4F"}},{default:u(()=>[x(p(o(n)("btn_delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:u(()=>[_("a",{class:"more-btn",onClick:t[18]||(t[18]=te(()=>{},["prevent"]))},[i(o(Wt))])]),_:2},1024))])])])],10,Ba))),128))]))])]),_:1},8,["open","title"])):A("",!0)])}}},hs=yt(rs,[["__scopeId","data-v-e3229732"]]);export{hs as M};
//# sourceMappingURL=multi-reply-Ck3cS9Gg.js.map
