import{e as g,f as u,ae as y,ad as c,ar as d,ak as P,ac as v,k as p,G as _,as as o,at as n,u as i,F as I,ax as j,ai as q,B as H,av as Q,y as X,J as S}from"./vue-chunks-CGLjTDrY.js";import{L as Y}from"./loading-box-BFrpPJwN.js";import{E as Z}from"./empty-box-C6xHnjvN.js";import{e as ee}from"./index-BNO9ztvM.js";import{_ as ae,b as te,f as se}from"../../index-DxV-PNCd.js";import{o as le,V as oe,ai as ne,a9 as ie,N as ce,B as de,M as pe}from"./ui-antd-AfNpv4wx.js";const ue={style:{"margin-bottom":"12px"}},re={class:"wechat-app-list"},_e=["onClick"],fe={class:"item-body"},ve=["src"],me={class:"app-info"},he={class:"app-name"},ke={class:"app-desc"},be={class:"ext-info-list"},ge={key:0,class:"status-block status-success"},ye={key:1,class:"status-block status-warning"},xe={__name:"select-wechat-app",props:{title:{type:String,default:""},okText:{type:String,default:""},disabledAppIds:{type:Array,default:()=>[]}},emits:["ok"],setup(k,{expose:T,emit:E}){const{t:l}=te("components.common.select-wechat-app"),F=E,f=k,L=g(()=>f.title||l("select_official_account")),N=g(()=>f.okText||l("confirm_button")),V=Q();se();const m=u(!1),b=u(!1),M=u(!1),h=u(!1),R=u({}),r=u([]),s=u([]),x=g(()=>r.value.filter(e=>!f.disabledAppIds.includes(e.app_id)));function U(e,a){R.value=e,s.value=Array.isArray(a)?a:[],D(),m.value=!0}function z(){m.value=!1}function D(){b.value=!0,ee({app_type:"official_account",app_name:""}).then(e=>{r.value=e.data||[]}).finally(()=>{b.value=!1})}function O(){let e=r.value.filter(a=>s.value.includes(a.app_id));F("ok",S(s.value),S(e))}function C(){const e=V.resolve({path:"/user/official-account"});window.open(e.href,"_blank")}function W(e){if(f.disabledAppIds.includes(e.app_id))return;let a=s.value.indexOf(e.app_id);a>-1?s.value.splice(a,1):s.value.push(e.app_id),w()}function w(){X(()=>{h.value=s.value.length===x.value.length})}function $(){h.value?(s.value=[],r.value.map(e=>{f.disabledAppIds.includes(e.app_id)||s.value.push(e.app_id)})):s.value=[]}return T({open:U,close:z}),(e,a)=>{const G=le,A=oe,J=ce,B=de,K=pe;return c(),y(K,{open:m.value,"onUpdate:open":a[3]||(a[3]=t=>m.value=t),title:L.value,"confirm-loading":M.value,width:"626px"},{footer:d(()=>[p(B,{type:"primary",disabled:!s.value.length,onClick:O},{default:d(()=>[_(n(N.value),1)]),_:1},8,["disabled"])]),default:d(()=>[P(e.$slots,"alert",{},()=>[p(G,{type:"info",class:"zm-alert-info mt12"},{message:d(()=>[_(n(i(l)("official_account_list_source")),1),o("a",{onClick:C},n(i(l)("link_edit_add_official_account")),1)]),_:1})],!0),b.value?(c(),y(Y,{key:0,style:{margin:"10vh 0"}})):r.value.length?(c(),v(I,{key:1},[o("div",ue,[p(A,{checked:h.value,"onUpdate:checked":a[0]||(a[0]=t=>h.value=t),disabled:!x.value.length,onChange:$},{default:d(()=>[_(n(i(l)("select_all")),1)]),_:1},8,["checked","disabled"])]),p(J,{value:s.value,"onUpdate:value":a[2]||(a[2]=t=>s.value=t)},{default:d(()=>[o("div",re,[(c(!0),v(I,null,j(r.value,t=>(c(),v("div",{key:t.id,class:q(["wechat-app-item",{disabled:k.disabledAppIds.includes(t.app_id)}]),onClick:Ce=>W(t)},[o("div",fe,[o("img",{class:"app-avatar",src:t.app_avatar,alt:""},null,8,ve),o("div",me,[o("div",he,n(t.app_name),1),o("div",ke,n(i(l)("appid_label"))+n(t.app_id),1)])]),o("div",be,[t.account_is_verify=="true"?(c(),v("div",ge,[p(i(ne)),_(" "+n(i(l)("verified")),1)])):(c(),v("div",ye,[p(i(ie)),_(" "+n(i(l)("unverified")),1)])),o("span",{onClick:a[1]||(a[1]=H(()=>{},["stop"]))},[p(A,{value:t.app_id,disabled:k.disabledAppIds.includes(t.app_id),onChange:w},null,8,["value","disabled"])])])],10,_e))),128))])]),_:1},8,["value"])],64)):(c(),y(Z,{key:2,title:i(l)("no_official_account_bound")},{desc:d(()=>[p(B,{type:"primary",onClick:C},{default:d(()=>[_(n(i(l)("bind_official_account")),1)]),_:1})]),_:1},8,["title"]))]),_:3},8,["open","title","confirm-loading"])}}},Ee=ae(xe,[["__scopeId","data-v-0e3ffbe1"]]);export{Ee as S};
