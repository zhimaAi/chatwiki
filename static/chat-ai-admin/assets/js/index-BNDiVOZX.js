import{_ as fe}from"./cu-scroll-bISEQWPA.js";import{b as ee,e as $e,dt as qe,bO as Ie,d as Be,bv as ze,k as P,dk as Le,M as Y,a2 as Ue,h as Me,bU as Ae,B as Ne,E as se}from"../../index-Bo1NSLpy.js";import{b as he,a3 as te,a2 as ke,z as Z,d as k,S as y,O as _,U as i,X as l,j as n,H as re,a6 as s,N as m,W as X,u as h,F as B,a5 as D,_ as de,I as ue,Z as p,x as Oe,k as ve}from"./vue-chunks-BRsu9_To.js";import{A as Se}from"./avatar-input-CdkAHjsR.js";import{M as me}from"./model-select-BSeLg_eN.js";import{O as De}from"./open-grapg-modal-DWemoT0e.js";import{C as Te}from"./index-CEq6_GyH.js";import{F as ce,_ as je}from"./index-COWZrpvC.js";import"./index-Caod9rOO.js";import{I as Ve}from"./Input-CCKFAS4o.js";import{S as Ee}from"./index-Bs02Ec-o.js";import{Q as H}from"./QuestionCircleOutlined-VG1FNUnl.js";import{_ as Pe}from"./TextArea--DLJ7VtX.js";import{_ as Re}from"./index-Dlji98bI.js";import{_ as Fe}from"./index-Bbrx8UDU.js";import{_ as Ke}from"./index-DrD42LNC.js";import{_ as Ge}from"./index-B4MPC5xv.js";import{i as Qe,e as Xe,f as He}from"./index-CR-G-FTm.js";import{A as Je}from"./add-collaborator-Bj_Z_jev.js";import{P as We}from"./PlusOutlined-vSxn8uyP.js";import{A as Ye}from"./index-D86PgJML.js";import{U as pe}from"./UserOutlined-CiB_WlAm.js";import{D as Ze}from"./DownOutlined-CrhRpWT5.js";import{C as J}from"./CheckOutlined-C6m5maw6.js";import{E as et}from"./EditOutlined-fieznxtM.js";import{E as tt}from"./Password-CJww1n-s.js";import{a as at}from"./index-Ct9MFKxB.js";import{_ as nt}from"./index-pj8Mdu_P.js";import{T as ot,_ as lt}from"./index-DkO_ejiW.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./index-C19UYW2Z.js";import"./Trigger-DtRTHvld.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./DownloadOutlined-BfFY8ehf.js";import"./index-OqAdRPIm.js";import"./useRefs-CRRjy_qY.js";import"./collapseMotion-Brd6xpAT.js";import"./useMergedState-C0iIHNGF.js";import"./FormItemContext-Cv3f2sEj.js";import"./index-BPmrcBow.js";import"./isPlainObject-CHj0iPA3.js";import"./Col-QoogualX.js";import"./responsiveObserve-D3ho5cFZ.js";import"./hasIn-BtXuxCTT.js";import"./index-CuPJUS8f.js";import"./Search-BF8URtRh.js";import"./SearchOutlined-CFTHZIcT.js";import"./inputProps--_pnbyjO.js";import"./slide-CVAZ5BEM.js";import"./index-BwedndIp.js";import"./List-qVz67bUg.js";import"./move-DztQgbGg.js";import"./UpOutlined-DWTDMQqv.js";import"./colors-4myZb9T8.js";import"./index-Bb6fuwF7.js";import"./RadioButton-CWIeNl_M.js";import"./Checkbox-B_uQPvVs.js";import"./index-kP7DVVOS.js";import"./index-BeCYXilq.js";import"./index-C_M0mW4F.js";import"./CaretDownFilled-DQ5FyPd3.js";import"./index-eahgXICC.js";import"./LeftOutlined-6ERu0fUO.js";import"./RightOutlined-zEOifMPB.js";import"./index-BZOjzqJ2.js";import"./dropdown-DAy60lp8.js";import"./Dropdown-hEIgqeS3.js";import"./index-Dxy-C30T.js";import"./shallowequal-C0xnIuy8.js";import"./CaretDownOutlined-C8EH_hS-.js";import"./pick-CHoP6n6n.js";const it={class:"add-library-page"},_t={class:"form-box"};const st={class:"indexing-methods-box"},rt={class:"list-title-block"},dt={class:"list-title-block"},ut={class:"select-card-box"},mt={class:"card-title"},ct={class:"card-title"},pt={class:"card-title"},W="你是一位文章分段助手，根据文章内容的语义进行合理分段，确保每个分段表述一个完整的语义，每个分段字数控制在500字左右，最大不超过1000字。请严格按照文章内容进行分段，不要对文章内容进行加工，分段完成后输出分段后的内容。",ft={__name:"knowledge-config",setup(ae){const q=$e(),z=he(()=>{var a;return((a=q.companyInfo)==null?void 0:a.neo4j_status)=="true"}),x=te(),v=ke(),C=x.query,b=qe,e=Z({library_name:"",library_intro:"",use_model:"",use_model_icon:"",use_model_name:"",is_offline:"",model_config_id:"",avatar:b,avatar_file:"",graph_switch:!1,graph_model_config_id:void 0,graph_use_model:"",chunk_type:1,normal_chunk_default_separators_no:[10,12],normal_chunk_default_chunk_size:512,normal_chunk_default_chunk_overlap:50,semantic_chunk_default_chunk_size:512,semantic_chunk_default_chunk_overlap:50,semantic_chunk_default_threshold:90,normal_chunk_default_not_merged_text:"false",ai_chunk_size:5e3,ai_chunk_model:"",ai_chunk_model_config_id:"",ai_chunk_prumpt:W,qa_index_type:1,group_id:0}),I=k(""),M=k(0),w=k({}),R=a=>{e.use_model=r.includes(a.rawData.model_define)&&a.rawData.deployment_name?a.rawData.deployment_name:a.rawData.name,e.use_model_icon=a.icon,e.use_model_name=a.use_model_name,e.model_config_id=a.rawData.id,I.value=a.rawData.model_define,c()},T=k([]);Ie().then(a=>{T.value=a.data.map(t=>({label:t.name,value:t.no}))});const f=k(!0);(()=>{ze({id:C.id}).then(a=>{w.value=a.data,M.value=w.value.is_offline?2:1,e.library_name=a.data.library_name,e.qa_index_type=a.data.qa_index_type,e.library_intro=a.data.library_intro,e.use_model=a.data.use_model,e.is_offline=a.data.is_offline,e.group_id=a.data.group_id,e.model_config_id=a.data.model_config_id,e.avatar=a.data.avatar?a.data.avatar:b,e.avatar_file=a.data.avatar_file?a.data.avatar_file:"",e.graph_switch=a.data.graph_switch!="0",e.graph_model_config_id=a.data.graph_model_config_id>0?a.data.graph_model_config_id:void 0,e.graph_use_model=a.data.graph_use_model,e.chunk_type=+a.data.chunk_type,e.normal_chunk_default_separators_no=a.data.normal_chunk_default_separators_no?a.data.normal_chunk_default_separators_no.split(",").map(t=>+t):[],e.normal_chunk_default_chunk_size=a.data.normal_chunk_default_chunk_size,e.normal_chunk_default_not_merged_text=a.data.normal_chunk_default_not_merged_text,e.normal_chunk_default_chunk_overlap=a.data.normal_chunk_default_chunk_overlap,e.semantic_chunk_default_chunk_size=a.data.semantic_chunk_default_chunk_size,e.semantic_chunk_default_chunk_overlap=a.data.semantic_chunk_default_chunk_overlap,e.semantic_chunk_default_threshold=a.data.semantic_chunk_default_threshold,e.ai_chunk_size=a.data.ai_chunk_size||5e3,e.ai_chunk_model=a.data.ai_chunk_model,e.ai_chunk_model_config_id=a.data.ai_chunk_model_config_id,e.ai_chunk_prumpt=a.data.ai_chunk_prumpt||W,f.value=a.data.type==2})})();const j=k([{iconName:"high-active",title:"高质量",value:1,is_offline:!1,desc:"使用在线的嵌入模型，在召回时具有更高的准确度，但需要花费token"}]),A=ce.useForm,V=Z({library_name:[{required:!0,message:"请输入库名称",trigger:"blur"}],use_model:[{required:!0,message:"请选择嵌入模型",trigger:"change"}]}),{validateInfos:N}=A(e,V),F=a=>{e.avatar=a.imageUrl,e.avatar_file=a.file,c()},E=()=>!1,r=["azure","ollama","xinference","openaiAgent"],O=["azure"],ne=()=>{c()},L=k([]),K=a=>{L.value=a,Oe(()=>{(!e.ai_chunk_model||!Number(e.ai_chunk_model_config_id))&&ge()})},ge=()=>{if(L.value.length>0){let a=null,t=null;for(let $ of L.value)if($.model_define==="tongyi"){a=$;for(let d of a.children)if(d.name==="qwen-max"){t=d;break}break}a||(a=L.value[0],t=a.children[0]),a&&t&&(e.ai_chunk_model=t.name,e.ai_chunk_model_config_id=t.model_config_id)}},oe=k(null),ye=a=>{if(a){e.graph_switch=!1;let t={graph_model_config_id:e.graph_model_config_id,graph_use_model:e.graph_use_model};if((!e.graph_model_config_id||!e.graph_use_model)&&L.value.length>0){let $=L.value[0];if($){let d=$.children[0];t.graph_use_model=d.name,t.graph_model_config_id=d.model_config_id}}oe.value.show(t)}else e.graph_switch=!1,c()},G=a=>{e.chunk_type=a,c()},be=a=>{a.graph_model_config_id&&(e.graph_switch=!0,e.graph_model_config_id=a.graph_model_config_id,e.graph_use_model=a.graph_use_model,c(()=>{Y.confirm({title:"已开启知识图谱",content:"您可以在文档列表中点击知识图谱学习，系統将在您手动操作后开始抽取知识图谱",cancelText:"知道了",okText:"去学习",icon:ve(Ue,{style:{color:"#52c41a"}}),onOk:()=>v.push({path:"/library/details/knowledge-document",query:{id:C.id}})})}))},c=(a=null)=>{if(!e.library_name)return P.error("请输入知识库名称");let t={library_name:e.library_name,qa_index_type:e.qa_index_type,library_intro:e.library_intro,use_model:e.use_model,model_config_id:e.model_config_id,is_offline:e.is_offline,graph_switch:e.graph_switch?1:0,graph_model_config_id:e.graph_model_config_id,graph_use_model:e.graph_use_model,chunk_type:e.chunk_type,normal_chunk_default_separators_no:e.normal_chunk_default_separators_no.join(","),normal_chunk_default_chunk_size:e.normal_chunk_default_chunk_size,normal_chunk_default_chunk_overlap:e.normal_chunk_default_chunk_overlap,normal_chunk_default_not_merged_text:e.normal_chunk_default_not_merged_text,semantic_chunk_default_chunk_size:e.semantic_chunk_default_chunk_size,semantic_chunk_default_chunk_overlap:e.semantic_chunk_default_chunk_overlap,semantic_chunk_default_threshold:e.semantic_chunk_default_threshold,ai_chunk_size:e.ai_chunk_size,ai_chunk_model:e.ai_chunk_model,ai_chunk_model_config_id:e.ai_chunk_model_config_id,ai_chunk_prumpt:e.ai_chunk_prumpt,group_id:e.group_id,id:x.query.id};O.indexOf(I.value)>-1&&(t.use_model="默认"),e.avatar_file&&(t.avatar=e.avatar_file),Le(t).then($=>{typeof a=="function"?a():P.success("修改成功")})},le=a=>{a!=e.qa_index_type&&(e.qa_index_type=a,c())};return(a,t)=>{const $=Ve,d=je,ie=Pe,g=Be,_e=Re,xe=Ee,U=Ke,S=Fe,Q=Ge,Ce=ce,we=fe;return _(),y(we,null,{default:i(()=>[l("div",it,[l("div",_t,[n(Ce,{"label-col":{span:6}},{default:i(()=>[n(d,X({ref:"name",label:"知识库名称"},h(N).library_name),{default:i(()=>[n($,{onBlur:c,value:e.library_name,"onUpdate:value":t[0]||(t[0]=o=>e.library_name=o),placeholder:"请输入知识库名称，最多20个字"},null,8,["value"])]),_:1},16),n(d,{label:"知识库简介"},{default:i(()=>[n(ie,{onBlur:c,value:e.library_intro,"onUpdate:value":t[1]||(t[1]=o=>e.library_intro=o),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),n(d,X({ref:"name",label:"知识库封面"},h(N).avatar),{default:i(()=>[n(Se,{value:e.avatar,"onUpdate:value":t[2]||(t[2]=o=>e.avatar=o),onChange:F},null,8,["value"]),t[22]||(t[22]=l("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[22]},16),n(d,X({label:"嵌入模型"},h(N).use_model),{default:i(()=>[s("",!0),n(Te,{modelValue:e.use_model,"onUpdate:modelValue":t[3]||(t[3]=o=>e.use_model=o),"label-key":"use_model_name","value-key":"value",modelType:"TEXT EMBEDDING","model-config-id":e.model_config_id,onChange:R,onLoaded:K},null,8,["modelValue","model-config-id"])]),_:1},16),re(n(d,{label:"生成知识图谱"},{default:i(()=>[n(_e,{onChange:ye,checked:e.graph_switch,"checked-children":"开","un-checked-children":"关"},null,8,["checked"]),t[23]||(t[23]=l("div",{class:"form-item-tip"},"开启后，可以文档列表手动点击知识图谱学习生成知识图谱",-1))]),_:1,__:[23]},512),[[ue,z.value]]),re(n(d,{label:"知识图谱模型"},{default:i(()=>[n(me,{modelType:"LLM",modeName:e.graph_use_model,"onUpdate:modeName":t[4]||(t[4]=o=>e.graph_use_model=o),modeId:e.graph_model_config_id,"onUpdate:modeId":t[5]||(t[5]=o=>e.graph_model_config_id=o),style:{width:"300px"},onChange:ne,onLoaded:K},null,8,["modeName","modeId"])]),_:1},512),[[ue,e.graph_switch&&z.value]]),f.value?(_(),y(d,{key:0,label:"索引方式"},{default:i(()=>[l("div",st,[l("div",{class:D(["list-item",{active:e.qa_index_type==1}]),onClick:t[6]||(t[6]=o=>le(1))},[n(g,{class:"check-icon",name:"check-arrow-filled"}),l("div",rt,[n(g,{name:"file-search"}),t[24]||(t[24]=p(" 问题与答案一起生成索引 "))]),t[25]||(t[25]=l("div",{class:"list-content"}," 回答用户提问时，将用户提问与导入的问题和答案一起对比相似度，根据相似度高的问题和答案回复 ",-1))],2),l("div",{class:D(["list-item",{active:e.qa_index_type==2}]),onClick:t[7]||(t[7]=o=>le(2))},[n(g,{class:"check-icon",name:"check-arrow-filled"}),l("div",dt,[n(g,{name:"comment-search"}),t[26]||(t[26]=p(" 仅对问题生成索引 "))]),t[27]||(t[27]=l("div",{class:"list-content"}," 回答用户提问时，将用户提问与导入的问题一起对比相似度，再根据相似度高的问题和对应的答案来回复 ",-1))],2)])]),_:1})):s("",!0),f.value?s("",!0):(_(),m(B,{key:1},[n(d,{label:"分段方式",required:""},{default:i(()=>[t[34]||(t[34]=l("div",{class:"form-alert-tip"},"提示：语义分段更适合没有排版过的文章，即没有明显换行符号的文本，否则更推荐使用普通分段",-1)),l("div",ut,[l("div",{class:D(["select-card-item",{active:e.chunk_type==1}]),onClick:t[8]||(t[8]=o=>G(1))},[n(g,{class:"check-arrow",name:"check-arrow-filled"}),l("div",mt,[n(g,{name:"ordinary-segmentation",class:"title-icon"}),t[28]||(t[28]=p(" 普通分段 "))]),t[29]||(t[29]=l("div",{class:"card-desc"}," 基于文章中句号、空行，或者自定义符号进行分段，不会消耗模型token ",-1))],2),l("div",{class:D(["select-card-item",{active:e.chunk_type==2}]),onClick:t[9]||(t[9]=o=>G(2))},[n(g,{class:"check-arrow",name:"check-arrow-filled"}),l("div",ct,[n(g,{name:"semantic-segmentation",class:"title-icon"}),t[30]||(t[30]=p(" 语义分段 "))]),t[31]||(t[31]=l("div",{class:"card-desc"}," 将文章拆分成句子后，通过语句向量相似度进行分段，会消耗模型token ",-1))],2),l("div",{class:D(["select-card-item",{active:e.chunk_type==3}]),onClick:t[10]||(t[10]=o=>G(3))},[n(g,{class:"check-arrow",name:"check-arrow-filled"}),l("div",pt,[n(g,{name:"semantic-segmentation",class:"title-icon"}),t[32]||(t[32]=p(" AI分段 "))]),t[33]||(t[33]=l("div",{class:"card-desc"}," 将文章提交给大模型，大模型基于设定的提示词进行分段，会消耗大量模型token ",-1))],2)])]),_:1,__:[34]}),e.chunk_type==1?(_(),m(B,{key:0},[n(d,{label:"分段标识符",required:""},{default:i(()=>[n(xe,{onChange:c,value:e.normal_chunk_default_separators_no,"onUpdate:value":t[11]||(t[11]=o=>e.normal_chunk_default_separators_no=o),mode:"multiple",style:{width:"100%"},placeholder:"请选择分段标识符",options:T.value},null,8,["value","options"])]),_:1}),n(d,{label:"分段最大长度",required:""},{default:i(()=>[n(S,{gap:8,align:"center"},{default:i(()=>[n(U,{onBlur:c,value:e.normal_chunk_default_chunk_size,"onUpdate:value":t[12]||(t[12]=o=>e.normal_chunk_default_chunk_size=o),style:{width:"220px"},precision:0,min:1,max:1e5},null,8,["value"]),t[35]||(t[35]=p(" 字符 "))]),_:1,__:[35]})]),_:1}),n(d,{label:"分段重叠长度"},{default:i(()=>[n(S,{gap:8,align:"center"},{default:i(()=>[n(U,{onBlur:c,value:e.normal_chunk_default_chunk_overlap,"onUpdate:value":t[13]||(t[13]=o=>e.normal_chunk_default_chunk_overlap=o),style:{width:"220px"},precision:0,min:1,max:1e5},null,8,["value"]),t[36]||(t[36]=p(" 字符 "))]),_:1,__:[36]})]),_:1}),n(d,null,{label:i(()=>[t[37]||(t[37]=p(" 自动合并较小分段 ")),n(Q,{title:"开启后，如果分段长度不足设置的最大分段长度，会尝试与下一分段合并，直至合并后的分段字符数大于分段最大长度"},{default:i(()=>[n(h(H))]),_:1})]),default:i(()=>[n(_e,{onChange:c,checkedValue:"false",unCheckedValue:"true",checked:e.normal_chunk_default_not_merged_text,"onUpdate:checked":t[14]||(t[14]=o=>e.normal_chunk_default_not_merged_text=o),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})],64)):s("",!0),e.chunk_type==2?(_(),m(B,{key:1},[e.chunk_type==2?(_(),y(d,{key:0,required:""},{label:i(()=>[t[39]||(t[39]=p(" 分段阈值 ")),n(Q,null,{title:i(()=>t[38]||(t[38]=[p("用于控制分段拆分的标准，数值0~100,数值越大，分段越少，数值越小，分段越多。")])),default:i(()=>[n(h(H),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:i(()=>[n(U,{onBlur:c,value:e.semantic_chunk_default_threshold,"onUpdate:value":t[15]||(t[15]=o=>e.semantic_chunk_default_threshold=o),style:{width:"100%"},placeholder:"请输入分段阈值",precision:0,min:0,max:100},null,8,["value"])]),_:1})):s("",!0),n(d,{label:"分段最大长度",required:""},{default:i(()=>[n(S,{gap:8,align:"center"},{default:i(()=>[n(U,{onBlur:c,value:e.semantic_chunk_default_chunk_size,"onUpdate:value":t[16]||(t[16]=o=>e.semantic_chunk_default_chunk_size=o),style:{width:"220px"},precision:0,min:1,max:1e5},null,8,["value"]),t[40]||(t[40]=p(" 字符 "))]),_:1,__:[40]})]),_:1}),n(d,{label:"分段重叠长度"},{default:i(()=>[n(S,{gap:8,align:"center"},{default:i(()=>[n(U,{onBlur:c,value:e.semantic_chunk_default_chunk_overlap,"onUpdate:value":t[17]||(t[17]=o=>e.semantic_chunk_default_chunk_overlap=o),style:{width:"220px"},precision:0,min:1,max:1e5},null,8,["value"]),t[41]||(t[41]=p(" 字符 "))]),_:1,__:[41]})]),_:1})],64)):s("",!0),e.chunk_type==3?(_(),m(B,{key:2},[e.chunk_type==3?(_(),y(d,{key:0,required:""},{label:i(()=>t[42]||(t[42]=[p(" AI大模型 ")])),default:i(()=>[n(me,{modelType:"LLM",placeholder:"请选择AI大模型",modeName:e.ai_chunk_model,"onUpdate:modeName":t[18]||(t[18]=o=>e.ai_chunk_model=o),modeId:e.ai_chunk_model_config_id,"onUpdate:modeId":t[19]||(t[19]=o=>e.ai_chunk_model_config_id=o),style:{width:"300px"},onChange:ne,onLoaded:K},null,8,["modeName","modeId"])]),_:1})):s("",!0),n(d,{label:"提示词设置",required:""},{default:i(()=>[n(S,{gap:8,align:"center"},{default:i(()=>[n(ie,{onBlur:c,maxLength:500,style:{height:"80px"},value:e.ai_chunk_prumpt,"onUpdate:value":t[20]||(t[20]=o=>e.ai_chunk_prumpt=o),placeholder:W},null,8,["value"])]),_:1})]),_:1}),n(d,null,{label:i(()=>[t[44]||(t[44]=p(" 单次最大字符数 ")),n(Q,null,{title:i(()=>t[43]||(t[43]=[p("由于大模型支持的上下文数量有限制，如果上传的文档较大，会按照最大字符数先拆分成多个分段，再提交给大模型进行分段。")])),default:i(()=>[n(h(H),{style:{cursor:"pointer","margin-left":"2px"}})]),_:1})]),default:i(()=>[n(U,{onBlur:c,class:"form-item-inptu-numbner",value:e.ai_chunk_size,"onUpdate:value":t[21]||(t[21]=o=>e.ai_chunk_size=o),placeholder:"请输入单次最大字符数",precision:0,min:0,formatter:o=>parseInt(o),parser:o=>parseInt(o)},null,8,["value","formatter","parser"]),t[45]||(t[45]=p(" 字符 "))]),_:1,__:[45]})],64)):s("",!0)],64))]),_:1})]),n(De,{onOk:be,ref_key:"openGrapgModalRef",ref:oe},null,512)])]),_:1})}}},ht=ee(ft,[["__scopeId","data-v-8f94cf1d"]]),kt={class:"content-box"},vt={key:0,class:"add-btn-block"},gt={class:"list-content"},yt={key:0,class:"user-block"},bt={class:"name-box"},xt={class:"name"},Ct={class:"remark-text"},wt={key:0,class:"hover-btn-box"},$t={key:0},qt={key:1},It={key:2},Bt={key:1,class:"hover-btn-box"},zt={class:"role-menu-box"},Lt=["onClick"],Ut={class:"menu-header"},Mt={key:0,class:"check-box"},At=["onClick"],Nt={class:"menu-header"},Ot={key:0,class:"check-box"},St=["onClick"],Dt={class:"menu-header"},Tt={key:0,class:"check-box"},jt={class:"hover-btn-box"},Vt={key:0},Et={key:1},Pt={key:2},Rt=["onClick"],Ft={__name:"role-permission",setup(ae){const q=te().query,z=Me(),x=he(()=>z.user_name),v=k(Ae(q.id)),C=k([]),b=Z({object_id:q.id,object_type:2}),e=()=>{Qe({...b}).then(f=>{let u=f.data||[];C.value=u})};e();const I=k(null),M=()=>{I.value.show(C.value,[{object_id:+q.id,object_type:2,operate_rights:4}])},w=(f,u)=>{let j=u==4?"管理":u==2?"编辑":"查看";Y.confirm({title:"提示?",icon:n(se),content:"确认修改该协作者权限为【"+j+"】",okText:"确认",cancelText:"取消",onOk:()=>{let A=[{object_id:+f.object_id,object_type:+f.object_type,operate_rights:+u}];Xe({identity_ids:f.identity_id,identity_type:f.identity_type,object_array:JSON.stringify(A)}).then(V=>{P.success("修改成功"),e()})},onCancel(){}})},R=f=>{Y.confirm({title:"提示?",icon:n(se),content:"确认删除该条数据",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{He({identity_id:f.identity_id,identity_type:f.identity_type,object_id:f.object_id,object_type:f.object_type}).then(u=>{P.success("删除成功"),e()})},onCancel(){}})},T=k([{title:"姓名",dataIndex:"name",key:"name"},{title:"权限",dataIndex:"operate_rights",key:"operate_rights"},{title:"操作",dataIndex:"action",key:"action",width:80}]);return(f,u)=>{const j=Ne,A=Ye,V=nt,N=at,F=fe;return _(),y(F,null,{default:i(()=>[l("div",kt,[v.value==4?(_(),m("div",vt,[n(j,{type:"primary",onClick:M,icon:ve(h(We))},{default:i(()=>u[0]||(u[0]=[p("添加协助者")])),_:1,__:[0]},8,["icon"])])):s("",!0),l("div",gt,[n(N,{columns:T.value,"data-source":C.value,pagination:!1},{bodyCell:i(({column:E,record:r})=>[E.key==="name"?(_(),m("div",yt,[n(A,{shape:"square",src:r.avatar,size:40},{icon:i(()=>[r.avatar?s("",!0):(_(),y(h(pe),{key:0}))]),_:2},1032,["src"]),l("div",bt,[l("div",xt,de(r.user_name),1),l("div",Ct,de(r.name),1)])])):s("",!0),E.key==="operate_rights"?(_(),m(B,{key:1},[v.value==2||r.user_name==x.value?(_(),m("div",wt,[r.operate_rights==4?(_(),m("span",$t,"管理")):s("",!0),r.operate_rights==2?(_(),m("span",qt,"编辑")):s("",!0),r.operate_rights==1?(_(),m("span",It,"查看")):s("",!0)])):r.role_type==1||r.is_creator==1?(_(),m("div",Bt,"管理")):(_(),y(V,{key:2,placement:"bottomRight",title:null,overlayInnerStyle:{padding:"2px"}},{content:i(()=>[l("div",zt,[l("div",{class:"role-menu",onClick:O=>w(r,4)},[l("div",Ut,[n(h(pe)),u[1]||(u[1]=l("span",{class:"title"},"管理",-1))]),u[2]||(u[2]=l("div",{class:"desc"},"可编辑，可删除，可查看",-1)),r.operate_rights==4?(_(),m("div",Mt,[n(h(J))])):s("",!0)],8,Lt),l("div",{class:"role-menu",onClick:O=>w(r,2)},[l("div",Nt,[n(h(et)),u[3]||(u[3]=l("span",{class:"title"},"编辑",-1))]),u[4]||(u[4]=l("div",{class:"desc"},"可编辑，可查看",-1)),r.operate_rights==2?(_(),m("div",Ot,[n(h(J))])):s("",!0)],8,At),l("div",{class:"role-menu",onClick:O=>w(r,1)},[l("div",Dt,[n(h(tt)),u[5]||(u[5]=l("span",{class:"title"},"查看",-1))]),u[6]||(u[6]=l("div",{class:"desc"},"仅查看",-1)),r.operate_rights==1?(_(),m("div",Tt,[n(h(J))])):s("",!0)],8,St)])]),default:i(()=>[l("div",jt,[r.operate_rights==4?(_(),m("span",Vt,"管理")):s("",!0),r.operate_rights==2?(_(),m("span",Et,"编辑")):s("",!0),r.operate_rights==1?(_(),m("span",Pt,"查看")):s("",!0),n(h(Ze))])]),_:2},1024))],64)):s("",!0),E.key==="action"?(_(),m(B,{key:2},[v.value==4&&r.user_name!=x.value?(_(),m(B,{key:0},[r.role_type!=1&&r.is_creator!=1?(_(),m("a",{key:0,onClick:O=>R(r)},"移除",8,Rt)):s("",!0)],64)):s("",!0)],64)):s("",!0)]),_:1},8,["columns","data-source"])])]),n(Je,{onOk:e,ref_key:"addCollaboratorRef",ref:I},null,512)]),_:1})}}},Kt=ee(Ft,[["__scopeId","data-v-d7771fae"]]),Gt={class:"page-container-box"},Qt={class:"content-box"},Xt={__name:"index",setup(ae){const q=te(),z=ke(),x=q.query,v=k(+x.activeKey||1),C=()=>{let b={...x};v.value>1?b.activeKey=v.value:delete b.activeKey,z.push({query:{...b}})};return(b,e)=>{const I=lt,M=ot;return _(),m("div",Gt,[n(M,{activeKey:v.value,"onUpdate:activeKey":e[0]||(e[0]=w=>v.value=w),onChange:C},{default:i(()=>[(_(),y(I,{key:1,tab:"知识库配置"})),s("",!0)]),_:1},8,["activeKey"]),l("div",Qt,[v.value==1?(_(),y(ht,{key:0})):s("",!0),v.value==2?(_(),y(Kt,{key:1})):s("",!0)])])}}},yn=ee(Xt,[["__scopeId","data-v-53212b01"]]);export{yn as default};
