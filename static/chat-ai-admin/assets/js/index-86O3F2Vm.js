import{_ as U}from"./cu-scroll-ufyFyI_5.js";import{Q as Y,K as P}from"./knowledge-document-BhWrFY22.js";import{bv as H,b as I,e as W,B as X,d as Z,a1 as J,bw as tt,bx as ot,by as it,M as rt,k as et}from"../../index-CzPebXix.js";import{u as $}from"./robot-CF9aQwVH.js";import{b as L,d as k,q as B,N as l,O as e,S as f,a6 as p,F as M,a3 as at,a8 as st,z as lt,h as nt,X as i,j as n,U as c,Z as R,a1 as ct,a0 as h,u as A,_ as b,a5 as _t,G as pt}from"./vue-chunks-BRsu9_To.js";import{G as dt}from"./index-jmRHMddk.js";import{L as mt}from"./library-select-alert-DTzpsc35.js";import{M as ut,_ as yt}from"./index-DlQVT6K6.js";import"./index-BSz5XTfh.js";import{D as bt}from"./dropdown-DTOAy9tU.js";import{_ as ft}from"./index-BwqnaIPU.js";import{T as vt,_ as ht}from"./index-YQhVm4Ni.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./edit-subsection-D5oXZYZw.js";import"./index-CO6rvZOl.js";import"./index-CYUphznb.js";import"./index-BFhVTGQQ.js";import"./Input-DFtZp9vk.js";import"./FormItemContext-B2RmG14m.js";import"./index-Bxqtz4sn.js";import"./inputProps-jdR54afw.js";import"./Search-Cf7bcOZJ.js";import"./SearchOutlined-a_gTycfl.js";import"./isPlainObject-OEy0Jz8l.js";import"./TextArea-DrgXbuSS.js";import"./index-Bhf8G0AA.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./Password-fnCqxsm2.js";import"./index-7Ecr060x.js";import"./Trigger-Bvakuge0.js";import"./index-BgVvqN-n.js";import"./Col-CFxRRwN8.js";import"./responsiveObserve-DqAe0rZk.js";import"./collapseMotion-Brd6xpAT.js";import"./QuestionCircleOutlined-DTfTQPH4.js";import"./DownloadOutlined-CeWsYko2.js";import"./index-hvcgcTJ4.js";import"./CheckOutlined-Mk6nTpyE.js";import"./useRefs-CRRjy_qY.js";import"./useMergedState-C0iIHNGF.js";import"./util-BwuffJOK.js";import"./index-DGkdJwWs.js";import"./index-BfxXXGE8.js";import"./index-BMSQkwth.js";import"./index-6HDf6TPN.js";import"./slide-CsbPJG8I.js";import"./List-D7uk7Chm.js";import"./DownOutlined-DXKkgIsm.js";import"./move-CkiYyFmr.js";import"./LeftOutlined-BKUTcRtP.js";import"./index-w2fyHr10.js";import"./index-B_XKw_Lk.js";import"./UpOutlined-B_3G2J2r.js";import"./EditOutlined-D08WQbiX.js";import"./index-Bh3NMpRp.js";import"./index-BYVEo4R0.js";import"./CaretDownFilled-DSht_iiA.js";import"./index-BhHQj-ne.js";import"./index-0UwCX3b0.js";import"./RightOutlined-DH_YROnp.js";import"./index-DLRiQ5Ho.js";import"./Checkbox-oqMTsvET.js";import"./index-Di5l0R3t.js";import"./RadioButton-h1wW1k6O.js";import"./CaretDownOutlined-Byn8iz8T.js";import"./index-Dhmpqx9n.js";import"./colors-DfoziJR7.js";import"./PlusOutlined-BlmIiILr.js";import"./index-xXMO8r4G.js";import"./index-BhUXTHsq.js";import"./upload-input-BmT6L6Xv.js";import"./InboxOutlined-BcJOXEMG.js";import"./validate-8MtiUsxW.js";import"./model-select-BRz1sNBY.js";import"./open-grapg-modal-BqYwUJsb.js";import"./index-CBmR-lHY.js";import"./rename-modal-9bdafyUq.js";import"./page-alert-hUfedjgw.js";import"./index-D17QejXF.js";import"./index-BukWVUqX.js";import"./ClockCircleOutlined-bBTx_Knl.js";import"./shallowequal-C0xnIuy8.js";import"./vuedraggable.umd-CIIT_a56.js";import"./CopyOutlined-Bzd2h6dn.js";import"./ClockCircleFilled-fXuerISb.js";import"./index-DJdJAZVd.js";import"./SyncOutlined-BnnoShgX.js";import"./MoreOutlined-DHg0Dtfc.js";import"./index-Bpi-EtQQ.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./pick-Sm8BXOZJ.js";const gt={__name:"default-library",setup(x){const d=$(),u=L(()=>d.robotInfo.default_library_id),y=k(null);return B(()=>{H({id:u.value}).then(m=>{y.value=+m.data.type||0})}),(m,v)=>(e(),l(M,null,[y.value==2?(e(),f(Y,{key:0,library_id:u.value},null,8,["library_id"])):p("",!0),y.value==0?(e(),f(P,{key:1,library_id:u.value},null,8,["library_id"])):p("",!0)],64))}},kt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1749612065457'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5081'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='256'%20height='256'%3e%3cpath%20d='M0%200v1024L1024%200H0z%20m294.4%20172.8h12.8c22.4%200%2048-3.2%2060.8%200v32c-19.2-3.2-51.2%200-76.8%200l3.2-32z%20m-128%20422.4l44.8-48-19.2-16-38.4%2038.4-19.2-19.2L172.8%20512l-12.8-12.8-38.4%2038.4L28.8%20448%20128%20348.8l92.8%2092.8L179.2%20480l16%2016%2038.4-38.4%2019.2%2019.2L214.4%20512l16%2016%2038.4-44.8%2019.2%2019.2c-35.2%2041.6-73.6%2083.2-99.2%20112l-22.4-19.2z%20m60.8%2073.6c-6.4-19.2-16-44.8-25.6-64l22.4-6.4c9.6%2019.2%2022.4%2044.8%2025.6%2064l-22.4%206.4z%20m48-38.4c-9.6-12.8-28.8-28.8-44.8-41.6l9.6-12.8c16%209.6%2035.2%2025.6%2048%2038.4l-12.8%2016z%20m22.4-32c-9.6-9.6-28.8-22.4-44.8-32l9.6-16c16%209.6%2035.2%2019.2%2048%2028.8l-12.8%2019.2z%20m16-35.2c-9.6-6.4-25.6-16-41.6-19.2l9.6-19.2c16%203.2%2032%2012.8%2041.6%2019.2l-9.6%2019.2z%20m48-9.6c-9.6%200-22.4%200-32%203.2-3.2-70.4-38.4-128-73.6-169.6l-38.4%2038.4-22.4-22.4%2038.4-38.4-9.6-9.6-57.6-57.6%2019.2-19.2%2019.2%2019.2%206.4-22.4c22.4%203.2%2051.2%206.4%2067.2%2012.8l-6.4%2022.4c-16-6.4-44.8-9.6-67.2-12.8l48%2048%2048-48%2022.4%2022.4-48%2048c60.8%2041.6%20121.6%2070.4%20172.8%2064%200%209.6%200%2022.4%203.2%2032-41.6%203.2-86.4-16-134.4-44.8%2022.4%2041.6%2041.6%2083.2%2044.8%20134.4z%20m150.4-163.2c-6.4-3.2-22.4-3.2-28.8-3.2%200-9.6%200-25.6-12.8-38.4l-80-80L352%20307.2l-22.4-22.4%2064-60.8%2099.2%2099.2%209.6-44.8%2025.6%2012.8c-16%2076.8-16%2089.6-16%2099.2z%20m67.2-51.2c-9.6-3.2-25.6-3.2-35.2%200%2016-102.4-64-182.4-144-262.4l-9.6-9.6%2025.6-22.4c25.6%2025.6%2048%2051.2%2070.4%2076.8%2028.8%2022.4%20112%2086.4%20201.6%2070.4-3.2%209.6%200%2025.6%200%2035.2-54.4%209.6-108.8-12.8-150.4-35.2%2032%2044.8%2048%2096%2041.6%20147.2z'%20p-id='5082'%20fill='%232475fc'%3e%3c/path%3e%3cpath%20d='M124.8%20384l-25.6%2025.6L160%20467.2l25.6-25.6L124.8%20384z%20m25.6%2067.2c-6.4-12.8-19.2-35.2-28.8-48l16-6.4c9.6%2016%2019.2%2038.4%2022.4%2051.2l-9.6%203.2zM64%20444.8l60.8%2060.8%2022.4-25.6-60.8-60.8-22.4%2025.6z%20m57.6%2041.6c-9.6-9.6-28.8-22.4-44.8-28.8l6.4-12.8c16%206.4%2035.2%2019.2%2044.8%2028.8l-6.4%2012.8z'%20p-id='5083'%20fill='%232475fc'%3e%3c/path%3e%3c/svg%3e",wt={class:"main-content-block"},Lt={class:"btn-block"},xt={class:"list-box"},Ct=["onClick"],zt={key:0,class:"default-icon",src:kt,alt:""},St={class:"library-info"},Rt=["src"],At={class:"library-info-content"},Dt={class:"library-title"},It={class:"library-type"},$t={key:0,class:"type-tag"},Bt={key:1,class:"type-tag"},Mt={key:2,class:"type-tag"},Tt={class:"item-body"},Kt={class:"library-desc"},Vt={class:"item-footer"},Nt={class:"library-size"},Et={class:"text-item"},Gt={class:"text-item"},Ot={class:"text-item"},jt=["onClick"],qt=["onClick"],Ft={__name:"related-library",setup(x){const d=W(),u=L(()=>{var t;return((t=d.companyInfo)==null?void 0:t.neo4j_status)=="true"}),y=at().query,m=$(),{getRobot:v}=m,{robotInfo:_}=st(m),a=lt({library_ids:[],default_library_id:""}),g=k([]),C=k(null),T=L(()=>{let t=g.value.filter(o=>a.library_ids.includes(o.id));if(_.value.default_library_id){let o=t.find(s=>s.id==_.value.default_library_id);o&&(t=t.filter(s=>s.id!=_.value.default_library_id),t.unshift(o))}return t}),K=t=>{let o=a.library_ids.indexOf(t.id);a.library_ids.splice(o,1),w()},V=t=>{rt.confirm({title:`确定将${t.library_name}设为默认知识库吗？`,icon:null,content:n("div",{style:"color:red;"},"一个机器人只能有一个默认知识库"),onOk(){a.default_library_id=t.id,w(a.default_library_id)},onCancel(){}})},N=()=>{C.value.open([...a.library_ids])},E=t=>{a.library_ids=[...t],w()},w=t=>{let o={...pt(a)};o.library_ids=o.library_ids.join(","),dt({library_ids:o.library_ids,default_library_id:t||null,id:y.id}).then(s=>{et.success("操作成功"),v(y.id)})};nt(()=>{a.library_ids=_.value.library_ids.split(","),a.default_library_id=_.value.default_library_id||""});const G=t=>{t.type=="1"?window.open(`/#/public-library/config?library_id=${t.id}`,"_blank","noopener"):window.open(`/#/library/details?id=${t.id}`,"_blank","noopener")},O=async()=>{const t=await J({type:"",show_open_docs:1});if(t){let o=t.data||[];o.forEach(s=>{s.file_size_str=tt(s.file_size),s.avatar||(s.avatar=s.type==0?ot:it)}),g.value=o}};return B(()=>{O()}),(t,o)=>{const s=X,j=ft,q=Z,z=yt,F=ut,Q=bt;return e(),l("div",wt,[i("div",Lt,[n(s,{type:"primary",onClick:N},{default:c(()=>o[2]||(o[2]=[R("关联知识库")])),_:1,__:[2]})]),i("div",xt,[(e(!0),l(M,null,ct(T.value,r=>(e(),l("div",{class:"list-item-wrapper",key:r.id},[i("div",{class:"list-item",onClick:h(S=>G(r),["stop"])},[r.id==A(_).default_library_id?(e(),l("img",zt)):p("",!0),i("div",St,[i("img",{class:"library-icon",src:r.avatar,alt:""},null,8,Rt),i("div",At,[i("div",Dt,b(r.library_name),1),i("div",It,[r.type==0?(e(),l("span",$t,"普通知识库")):p("",!0),r.type==1?(e(),l("span",Bt,"对外知识库")):p("",!0),r.type==2?(e(),l("span",Mt,"问答知识库")):p("",!0),u.value?(e(),f(j,{key:3},{title:c(()=>[R(b(r.graph_switch==0?"未":"已")+"开启知识图谱生成",1)]),default:c(()=>[i("span",{class:_t(["type-tag graph-tag",{"gray-tag":r.graph_switch==0}])},"Graph",2)]),_:2},1024)):p("",!0)])])]),i("div",Tt,[i("div",Kt,b(r.library_intro),1)]),i("div",Vt,[i("div",Nt,[i("span",Et,"文档："+b(r.file_total),1),i("span",Gt,"大小："+b(r.file_size_str),1),i("span",Ot,"关联应用："+b(r.robot_nums||0),1)]),r.id!=A(_).default_library_id?(e(),l("div",{key:0,class:"action-box",onClick:o[1]||(o[1]=h(()=>{},["stop"]))},[n(Q,null,{overlay:c(()=>[n(F,null,{default:c(()=>[r.type!=1?(e(),f(z,{key:0},{default:c(()=>[i("a",{onClick:h(S=>V(r),["stop"])},"设为默认",8,jt)]),_:2},1024)):p("",!0),n(z,null,{default:c(()=>[i("a",{class:"delete-text-color",onClick:h(S=>K(r),["stop"])},"取消关联",8,qt)]),_:2},1024)]),_:2},1024)]),default:c(()=>[i("div",{class:"action-item",onClick:o[0]||(o[0]=h(()=>{},["stop"]))},[n(q,{class:"action-icon",name:"point-h"})])]),_:2},1024)])):p("",!0)])],8,Ct)]))),128))]),n(mt,{ref_key:"librarySelectAlertRef",ref:C,onChange:E},null,512)])}}},Qt=I(Ft,[["__scopeId","data-v-dcd202b6"]]),Ut={class:"main-content-block"},Yt={key:0,class:"body-content-box",style:{"padding-right":"16px"}},Pt={key:1,class:"body-content-box"},D="/robot/config/library-config/activeKey",Ht={__name:"index",setup(x){const d=k(+localStorage.getItem(D)||1),u=()=>{localStorage.setItem(D,d.value)};return(y,m)=>{const v=ht,_=vt,a=U;return e(),l("div",Ut,[n(_,{class:"tab-wrapper",activeKey:d.value,"onUpdate:activeKey":m[0]||(m[0]=g=>d.value=g),onChange:u},{default:c(()=>[(e(),f(v,{key:1,tab:"默认知识库"})),(e(),f(v,{key:2,tab:"关联知识库"}))]),_:1},8,["activeKey"]),d.value==1?(e(),l("div",Yt,[n(gt)])):(e(),l("div",Pt,[n(a,null,{default:c(()=>[n(Qt)]),_:1})]))])}}},No=I(Ht,[["__scopeId","data-v-1ea8c957"]]);export{No as default};
