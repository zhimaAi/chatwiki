import{C as E}from"./config-page-menu-CGN1dwA8.js";import{b as L,bi as M,d as T,bO as q}from"../../index-0TFHdij1.js";import{f as b,r as g,w as Y,o as A,Y as I,a5 as n,k as r,a2 as i,a4 as x,u as h,B as z,G as D,_ as k,J as B}from"./vue-chunks-CXJTX1FC.js";import{A as G}from"./avatar-input-DDtkfTJv.js";import{a as F,F as w,e as J,I as H,T as K,B as Q}from"./ui-antd-D3ZAJ1Vq.js";import"./utils-yZpnICoG.js";const W={class:"form-box"},X={class:"form-box-header"},Z={class:"form-box-label"},aa={__name:"library-form",props:{value:{type:Object,default:()=>({})},saveLoading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(f,{emit:u}){F.config({duration:2});const s=u,l=f,m=b(1),c=w.useForm,p=b(!1),t=M,a=g({type:m.value,library_name:"",library_intro:"",use_model:"",avatar:t,avatar_file:"",is_offline:!1,model_config_id:""}),v=g({library_name:[{required:!0,message:"请输入库名称",trigger:"change"}],library_intro:[{required:!0,message:"请输入库简介",trigger:"change"}]}),S=e=>{a.avatar=e.imageUrl,a.avatar_file=e.file},{validate:C,validateInfos:y}=c(a,v),O=()=>{C().then(()=>{U()}).catch(e=>{})},U=()=>{let e=B(a);s("submit",e)},N=e=>{p.value=+e.type,a.library_name=e.library_name,a.library_intro=e.library_intro,a.use_model=e.use_model,a.model_config_id=e.model_config_id,a.avatar=e.avatar?e.avatar:t,a.avatar_file=e.avatar_file?e.avatar_file:"",a.is_offline=e.is_offline};return Y(l.value,e=>{N({...e})}),A(()=>{}),(e,o)=>{const P=T,R=H,d=J,V=K,$=Q,j=w;return k(),I("div",W,[n("div",X,[n("div",Z,[r(P,{class:"form-box-label-icon",name:"book",style:{"font-size":"16px",color:"#333"}}),o[3]||(o[3]=n("span",{class:"form-box-label-text"},"知识库信息",-1))]),o[4]||(o[4]=n("div",null,null,-1))]),r(j,{"label-col":{span:6},style:{width:"600px"}},{default:i(()=>[r(d,x({ref:"name",label:"知识库名称"},h(y).library_name),{default:i(()=>[r(R,{value:a.library_name,"onUpdate:value":o[0]||(o[0]=_=>a.library_name=_),placeholder:"请输入知识库名称，最多20个字","show-count":"",maxlength:20},null,8,["value"])]),_:1},16),r(d,{label:"知识库简介"},{default:i(()=>[r(V,{value:a.library_intro,"onUpdate:value":o[1]||(o[1]=_=>a.library_intro=_),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),r(d,x({ref:"name",label:"知识库封面"},h(y).avatar),{default:i(()=>[r(G,{value:a.avatar,"onUpdate:value":o[2]||(o[2]=_=>a.avatar=_),onChange:S},null,8,["value"]),o[5]||(o[5]=n("div",{class:"form-item-tip"},"请上传知识库封面，建议尺寸为100*100px.大小不超过100kb",-1))]),_:1,__:[5]},16),r(d,{"wrapper-col":{offset:6,span:8}},{default:i(()=>[r($,{type:"primary",style:{"margin-left":"8px"},loading:f.saveLoading,onClick:z(O,["prevent"])},{default:i(()=>o[6]||(o[6]=[D("保存")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1})])}}},ea=L(aa,[["__scopeId","data-v-186fe7ef"]]),ta={class:"add-library-page"},oa={class:"page-container"},ra={class:"form-box-wrapper"},sa={__name:"index",setup(f){const u=q(),s=g({type:1,library_intro:"",library_name:"",model_config_id:"",model_define:"",use_model:"",is_offline:!1,access_rights:"0",share_url:"",library_key:"",avatar:"",avatar_file:""}),l=b(!1),m=t=>{Object.assign(s,t),l.value=!0,c().then(()=>{l.value=!1}).catch(()=>{l.value=!1})},c=async()=>{let t={...B(s)};delete t.library_key,t.avatar_file?(t.avatar=t.avatar_file,delete t.avatar_file):(delete t.avatar,delete t.avatar_file),await u.saveEditLibrary(t),F.success("修改成功")},p=()=>{Object.assign(s,{...u.libraryInfo})};return A(()=>{p()}),(t,a)=>(k(),I("div",ta,[r(E),n("div",oa,[n("div",ra,[r(ea,{value:s,"onUpdate:value":a[0]||(a[0]=v=>s=v),saveLoading:l.value,onSubmit:m},null,8,["value","saveLoading"])])])]))}},fa=L(sa,[["__scopeId","data-v-f47ae502"]]);export{fa as default};
