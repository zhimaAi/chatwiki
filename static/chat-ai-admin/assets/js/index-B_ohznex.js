import{f as u,w as P,Y as d,_ as f,k as p,a5 as i,a2 as B,B as F,F as I,a9 as N,u as b,ad as J}from"./vue-chunks-Ci-XTWEs.js";import{u as h}from"./index-BNGD8tAN.js";import{b as V,aX as z}from"../../index-BLRnoXQj.js";import{I as A,aa as G,bm as R,at as $,a as o}from"./ui-antd-BKz8sshA.js";const q={class:"upload-box"},S={class:"mask-box"},X=["src"],y=3,Y={__name:"index",props:{value:{type:[String,Array],default:""}},emits:["update:value"],setup(k,{emit:D}){const g=D,m=u([]),t=u([]),v=u(""),w=k;P(()=>w.value,e=>{t.value=e},{immediate:!0});const x=e=>{if(!(e.type==="image/jpeg"||e.type==="image/png"))return o.error("只支持JPG、PNG格式的图片"),!1;const s=e.size/1024<1024*2;return t.value.length>=y?o.error("最多上传三张图片"):s?(h({category:"library_image",file:e}).then(l=>{t.value.push(l.data.link),g("update:value",t.value)}),!1):(o.error("图片大小不能超过2M"),!1)},U=e=>{z({images:[e]})},M=e=>{t.value.splice(e,1)};let n=!1;const C=async e=>{if(t.value.length>=y)return o.error("最多上传三张图片");if(!(e.clipboardData&&e.clipboardData.items)){o.error("当前浏览器不支持粘贴上传操作！");return}if(!n)try{if(e.clipboardData||e.originalEvent||window.clipboardData){var r=e.clipboardData||e.originalEvent.clipboardData||window.clipboardData,s=r.items;let l=null;for(let a=0;a<s.length;a++)if(s[a].type.indexOf("image")!==-1){l=s[a].getAsFile();break}v.value="",l?(e.preventDefault(),n=!0,h({category:"library_image",file:l}).then(a=>{n=!1,t.value.push(a.data.link),g("update:value",t.value)})):(error("请粘贴正确图片"),n=!1,v.value="")}}catch{n=!1,o.error("上传失败")}},c=u(null),L=()=>{c.value.focus()},j=()=>{c.value.blur()};function E(e){}return(e,r)=>{const s=A,l=$;return f(),d("div",q,[p(s,{class:"hidden-input",ref_key:"inputRef",ref:c,onPaste:C},null,512),i("div",{onMouseenter:L,onMouseleave:j},[p(l,{fileList:m.value,"onUpdate:fileList":r[1]||(r[1]=a=>m.value=a),name:"file",multiple:!1,"list-type":"picture","show-upload-list":!1,accept:".jpg,.png,.jpeg","before-upload":x,onDrop:E},{default:B(()=>[i("div",{class:"img-list-box",onClick:r[0]||(r[0]=F(()=>{},["stop"]))},[(f(!0),d(I,null,N(t.value,(a,_)=>(f(),d("div",{class:"img-item",key:_},[i("div",S,[p(b(G),{onClick:O=>U(a)},null,8,["onClick"]),p(b(R),{onClick:O=>M(_)},null,8,["onClick"])]),i("img",{src:a,alt:""},null,8,X)]))),128))]),i("p",{class:J(["upload-text",{"center-content":t.value.length==0}])}," 支持点击空白处、拖拽、粘贴图片，上传图片不得超过2M，仅支持png、jpg、jpeg格式 ",2)]),_:1},8,["fileList"])],32)])}}},W=V(Y,[["__scopeId","data-v-61b33e35"]]);export{W as U};
