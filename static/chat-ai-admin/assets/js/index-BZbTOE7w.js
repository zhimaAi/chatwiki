import{I as Ce,b as Q,f as le,B as de,M as oe,k as se,n as ge,o as pe,E as Me}from"../../index-cxyImiCC.js";import{e as Ie,a as Ae,g as $e,d as Te,b as De,c as Ke}from"./index-B-6n0NRu.js";import{j as o,d as S,N as d,O as l,F as C,a1 as q,a5 as ie,_ as g,u as $,X as t,aa as Ee,U as n,Z as h,a6 as E,H as Se,S as K,I as Oe,G,z as te,W as Be,ab as ze,b as ae,w as Le}from"./vue-chunks-BRsu9_To.js";import{_ as Re}from"./index-BOWsK1hB.js";import{F as fe,_ as Pe}from"./index-CCDGpMly.js";import{_ as Ne,R as Ue}from"./RadioButton--sba9w9Z.js";import"./index-BSe19Kds.js";import{S as ke,a as he}from"./index-CMui0cQS.js";import"./index-CAqTjfbp.js";import{I as Ve}from"./Input-QJtsuZ9z.js";import{_ as re,a as ue}from"./index-BQf5NiGr.js";import{_ as qe}from"./index-C8mHt-4J.js";import{_ as be}from"./index-DRynd4K-.js";import{P as He}from"./PlusOutlined-BDVmv0Jd.js";import{_ as Ge}from"./index-C4vkzxfk.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Trigger-D4VoL-rm.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./colors-Bqf3aqGo.js";import"./isPlainObject-DrXJvb2e.js";import"./responsiveObserve-B6KSku6j.js";import"./collapseMotion-Brd6xpAT.js";import"./QuestionCircleOutlined-D8I4E84A.js";import"./FormItemContext-DxcOuH88.js";import"./Checkbox-IGl1kIcw.js";import"./index-RaQogq10.js";import"./slide-BIg0O54V.js";import"./index-C1v761o8.js";import"./CheckOutlined-BrEoPWP_.js";import"./DownOutlined-C777h06g.js";import"./SearchOutlined-CgcM1Nba.js";import"./move-C9aWeHI-.js";import"./Search-DAvLSsyP.js";import"./inputProps-CagQqpwA.js";import"./TextArea-BJCvjKgG.js";import"./Password-ChWVeqFJ.js";import"./index-BpHXL30M.js";import"./useMaxLevel-CNojUY5B.js";import"./CaretDownFilled-B6haTCwX.js";import"./index-BnQLFQzr.js";import"./fromPairs-Dx9PT-t0.js";import"./index-7tt6fV--.js";import"./LeftOutlined-R6fbEaCX.js";import"./RightOutlined-Cudbm4ZU.js";import"./index-D5ivw7D4.js";import"./index-omUNiUlG.js";import"./dropdown-S8fFQIx3.js";import"./index-a5CRcGn1.js";import"./shallowequal-C0xnIuy8.js";import"./CaretDownOutlined-BPrDaxV3.js";var Fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.4 800.9c.2-.3.5-.6.7-.9C920.6 722.1 960 621.7 960 512s-39.4-210.1-104.8-288c-.2-.3-.5-.5-.7-.8-1.1-1.3-2.1-2.5-3.2-3.7-.4-.5-.8-.9-1.2-1.4l-4.1-4.7-.1-.1c-1.5-1.7-3.1-3.4-4.6-5.1l-.1-.1c-3.2-3.4-6.4-6.8-9.7-10.1l-.1-.1-4.8-4.8-.3-.3c-1.5-1.5-3-2.9-4.5-4.3-.5-.5-1-1-1.6-1.5-1-1-2-1.9-3-2.8-.3-.3-.7-.6-1-1C736.4 109.2 629.5 64 512 64s-224.4 45.2-304.3 119.2c-.3.3-.7.6-1 1-1 .9-2 1.9-3 2.9-.5.5-1 1-1.6 1.5-1.5 1.4-3 2.9-4.5 4.3l-.3.3-4.8 4.8-.1.1c-3.3 3.3-6.5 6.7-9.7 10.1l-.1.1c-1.6 1.7-3.1 3.4-4.6 5.1l-.1.1c-1.4 1.5-2.8 3.1-4.1 4.7-.4.5-.8.9-1.2 1.4-1.1 1.2-2.1 2.5-3.2 3.7-.2.3-.5.5-.7.8C103.4 301.9 64 402.3 64 512s39.4 210.1 104.8 288c.2.3.5.6.7.9l3.1 3.7c.4.5.8.9 1.2 1.4l4.1 4.7c0 .1.1.1.1.2 1.5 1.7 3 3.4 4.6 5l.1.1c3.2 3.4 6.4 6.8 9.6 10.1l.1.1c1.6 1.6 3.1 3.2 4.7 4.7l.3.3c3.3 3.3 6.7 6.5 10.1 9.6 80.1 74 187 119.2 304.5 119.2s224.4-45.2 304.3-119.2a300 300 0 0010-9.6l.3-.3c1.6-1.6 3.2-3.1 4.7-4.7l.1-.1c3.3-3.3 6.5-6.7 9.6-10.1l.1-.1c1.5-1.7 3.1-3.3 4.6-5 0-.1.1-.1.1-.2 1.4-1.5 2.8-3.1 4.1-4.7.4-.5.8-.9 1.2-1.4a99 99 0 003.3-3.7zm4.1-142.6c-13.8 32.6-32 62.8-54.2 90.2a444.07 444.07 0 00-81.5-55.9c11.6-46.9 18.8-98.4 20.7-152.6H887c-3 40.9-12.6 80.6-28.5 118.3zM887 484H743.5c-1.9-54.2-9.1-105.7-20.7-152.6 29.3-15.6 56.6-34.4 81.5-55.9A373.86 373.86 0 01887 484zM658.3 165.5c39.7 16.8 75.8 40 107.6 69.2a394.72 394.72 0 01-59.4 41.8c-15.7-45-35.8-84.1-59.2-115.4 3.7 1.4 7.4 2.9 11 4.4zm-90.6 700.6c-9.2 7.2-18.4 12.7-27.7 16.4V697a389.1 389.1 0 01115.7 26.2c-8.3 24.6-17.9 47.3-29 67.8-17.4 32.4-37.8 58.3-59 75.1zm59-633.1c11 20.6 20.7 43.3 29 67.8A389.1 389.1 0 01540 327V141.6c9.2 3.7 18.5 9.1 27.7 16.4 21.2 16.7 41.6 42.6 59 75zM540 640.9V540h147.5c-1.6 44.2-7.1 87.1-16.3 127.8l-.3 1.2A445.02 445.02 0 00540 640.9zm0-156.9V383.1c45.8-2.8 89.8-12.5 130.9-28.1l.3 1.2c9.2 40.7 14.7 83.5 16.3 127.8H540zm-56 56v100.9c-45.8 2.8-89.8 12.5-130.9 28.1l-.3-1.2c-9.2-40.7-14.7-83.5-16.3-127.8H484zm-147.5-56c1.6-44.2 7.1-87.1 16.3-127.8l.3-1.2c41.1 15.6 85 25.3 130.9 28.1V484H336.5zM484 697v185.4c-9.2-3.7-18.5-9.1-27.7-16.4-21.2-16.7-41.7-42.7-59.1-75.1-11-20.6-20.7-43.3-29-67.8 37.2-14.6 75.9-23.3 115.8-26.1zm0-370a389.1 389.1 0 01-115.7-26.2c8.3-24.6 17.9-47.3 29-67.8 17.4-32.4 37.8-58.4 59.1-75.1 9.2-7.2 18.4-12.7 27.7-16.4V327zM365.7 165.5c3.7-1.5 7.3-3 11-4.4-23.4 31.3-43.5 70.4-59.2 115.4-21-12-40.9-26-59.4-41.8 31.8-29.2 67.9-52.4 107.6-69.2zM165.5 365.7c13.8-32.6 32-62.8 54.2-90.2 24.9 21.5 52.2 40.3 81.5 55.9-11.6 46.9-18.8 98.4-20.7 152.6H137c3-40.9 12.6-80.6 28.5-118.3zM137 540h143.5c1.9 54.2 9.1 105.7 20.7 152.6a444.07 444.07 0 00-81.5 55.9A373.86 373.86 0 01137 540zm228.7 318.5c-39.7-16.8-75.8-40-107.6-69.2 18.5-15.8 38.4-29.7 59.4-41.8 15.7 45 35.8 84.1 59.2 115.4-3.7-1.4-7.4-2.9-11-4.4zm292.6 0c-3.7 1.5-7.3 3-11 4.4 23.4-31.3 43.5-70.4 59.2-115.4 21 12 40.9 26 59.4 41.8a373.81 373.81 0 01-107.6 69.2z"}}]},name:"global",theme:"outlined"};function ve(_){for(var c=1;c<arguments.length;c++){var a=arguments[c]!=null?Object(arguments[c]):{},m=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(m=m.concat(Object.getOwnPropertySymbols(a).filter(function(M){return Object.getOwnPropertyDescriptor(a,M).enumerable}))),m.forEach(function(M){Xe(_,M,a[M])})}return _}function Xe(_,c,a){return c in _?Object.defineProperty(_,c,{value:a,enumerable:!0,configurable:!0,writable:!0}):_[c]=a,_}var _e=function(c,a){var m=ve({},c,a.attrs);return o(Ce,ve({},m,{icon:Fe}),null)};_e.displayName="GlobalOutlined";_e.inheritAttrs=!1;const Ye={class:"page-tabs"},je=["onClick"],Je={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(_,{emit:c}){const{t:a}=le(),m=c,M=_,f=S([{value:1,title:a("views.user.model.modelsHaveBeenAdded"),langKey:"views.user.model.modelsHaveBeenAdded"},{value:0,title:a("views.user.model.canAddAModel"),langKey:"views.user.model.canAddAModel"}]),b=i=>{m("update:value",i),m("change",i)};return(i,I)=>(l(),d("div",Ye,[(l(!0),d(C,null,q(f.value,O=>(l(),d("div",{class:ie(["tab-item",{active:M.value==O.value}]),onClick:k=>b(O.value),key:O.value},g($(a)(O.langKey)),11,je))),128))]))}},We=Q(Je,[["__scopeId","data-v-5999ba44"]]),Ze={class:"model-list"},Qe={class:"model-item-left"},et={class:"model-item-left-top"},tt=["src"],lt={class:"model-name"},ot={class:"model-tags"},nt={key:0,class:"tag"},at={class:"model-item-left-bottom"},st={class:"model-desc"},dt={class:"model-item-right"},it={__name:"model-list",props:{type:{type:Number,default:()=>1},list:{type:Array,default:()=>[]}},emits:["edit","new","see","remove","add"],setup(_,{emit:c}){const{t:a}=le(),m=c,M=["azure","ollama","xinference","openaiAgent"],f=_,b=T=>{m("see",G(T))},i=T=>{let x=G(T);m("edit",x,x.config_list[0])},I=T=>{m("new",G(T))},O=T=>{m("add",G(T))},k=T=>{let x=G(T);m("remove",x.config_list[0])};return(T,x)=>{const Y=Re,A=de;return l(),d("div",Ze,[(l(!0),d(C,null,q(f.list,v=>(l(),d("div",{class:"model-item",key:v.model_define},[t("div",Qe,[t("div",et,[t("img",{class:"model-logo",src:v.model_icon_url,alt:""},null,8,tt),t("div",lt,g(v.model_name),1),x[3]||(x[3]=t("div",{class:"line"},null,-1)),t("div",ot,[(l(!0),d(C,null,q(v.support_list,(y,U)=>(l(),d("div",{key:U},[o(Y,null,Ee({default:n(()=>[y!="SPEECH2TEXT"&&y!="TTS"?(l(),d("span",nt,g(y),1)):E("",!0)]),_:2},[y=="LLM"?{name:"title",fn:n(()=>[x[0]||(x[0]=h("大语言模型，添加机器人时需要选择一个大语言模型。用户的提问将交由大语言模型，结合知识库给出答案。"))]),key:"0"}:y=="TEXT EMBEDDING"?{name:"title",fn:n(()=>[x[1]||(x[1]=h("嵌入模型，添加知识库时需要选择嵌入模型，用于将知识库分段向量化。用户提问时也会将问题生成向量，通过比对向量相似度的方式四配跟提问语义相近的知识库分段。向量检索具备很好的语义分析能力。"))]),key:"1"}:y=="RERANK"?{name:"title",fn:n(()=>[x[2]||(x[2]=h("重排序模型,通过重排序模型,将从知识库中检索出来的分段进行重新排序。再将重排序的结果前top-K传递个大语言模型生成答案。重排序有助于优化检索结果，提高大语言模型回答的准确性。"))]),key:"2"}:void 0]),1024)]))),128))])]),t("div",at,[t("div",st,g(v.introduce),1)])]),t("div",dt,[Se(o(A,{class:ie({"btn-red":v.listType==1&&f.type==1}),onClick:y=>k(v)},{default:n(()=>[h(g(v.listType==1&&f.type==1?"移除配置":"删除"),1)]),_:2},1032,["class","onClick"]),[[Oe,f.type==1]]),f.type==2&&v.model_define!="azure"?(l(),K(A,{key:0,class:"add-btn",onClick:y=>b(v)},{default:n(()=>x[4]||(x[4]=[h("查看模型")])),_:2,__:[4]},1032,["onClick"])):E("",!0),f.type==2?(l(),K(A,{key:1,disabled:v.listType==1,class:"add-btn",onClick:y=>O(v)},{default:n(()=>x[5]||(x[5]=[h("添加配置")])),_:2,__:[5]},1032,["disabled","onClick"])):E("",!0),v.listType==1&&f.type==1?(l(),d(C,{key:2},[M.indexOf(v.model_define)>-1?(l(),d(C,{key:0},[o(A,{class:"add-btn",onClick:y=>b(v)},{default:n(()=>[h(g($(a)("views.user.model.modelConfigButton"))+"（"+g(v.config_list.length)+"）",1)]),_:2},1032,["onClick"]),o(A,{class:"add-btn",onClick:y=>I(v)},{default:n(()=>[h(g($(a)("views.user.model.addModelButton")),1)]),_:2},1032,["onClick"])],64)):(l(),d(C,{key:1},[o(A,{class:"add-btn",onClick:y=>i(v)},{default:n(()=>[h(g($(a)("views.user.model.editModelButton")),1)]),_:2},1032,["onClick"]),o(A,{class:"add-btn",onClick:y=>b(v)},{default:n(()=>[h(g($(a)("views.user.model.viewModelButton")),1)]),_:2},1032,["onClick"])],64))],64)):E("",!0)])]))),128))])}}},rt=Q(it,[["__scopeId","data-v-72110a96"]]),N={componentType:"input",placeholder:"",defaultValue:""},ut={componentType:"radio",defaultValue:void 0},_t={componentType:"select",defaultValue:void 0},ye={id:{hidden:!0},model_types:{...ut,key:"model_types",label:"模型类型",optionsKey:"supported_type",options:[],disabled:!1,rules:[{required:!0,message:"请选择模型类型",trigger:"change"}]},thinking_type:{componentType:"radio2",defaultValue:"0",key:"thinking_type",label:"深度思考",optionsKey:"thinking_type",options:[{label:"支持（类似deepseek r1这种只支持思考模式的模型）",value:"1"},{label:"可选（比如doubao1.6,可以通过接口控制是否启用深度思考模式）",value:"2"},{label:"不支持（比如deepseek v3,模型本身不支持深度思考模式）",value:"0"}],disabled:!1,rules:[{required:!0,message:"请选择深度思考",trigger:"change"}]},deployment_name:{...N,label:"部署名称",placeholder:"请与Azure 部署名称保持一致",rules:[{required:!0,message:"请输入部署名称",trigger:"change"}]},model_name:{...N,label:"模型名称",placeholder:"模型名称请保持一致",rules:[{required:!0,message:"请输入模型名称",trigger:"change"}]},api_endpoint:{...N,label:"API 域名",placeholder:"请输入您的API 域名",rules:[{required:!0,message:"请输入API 域名",trigger:"change"}]},model_context_length:{...N,label:"模型上下文长度",placeholder:"请输入您的模型上下文长度",rules:[{required:!0,message:"请输入模型上下文长度",trigger:"change"}]},model_uid:{...N,label:"模型UID",placeholder:"请输入您的模型UID",rules:[{required:!0,message:"请输入模型UID",trigger:"change"}]},api_key:{...N,label:"API Key",placeholder:"请输入您的API Key",rules:[{required:!0,message:"请输入API Key",trigger:"change"}]},secret_key:{...N,label:"Secret Key",placeholder:"请输入您的Secret Key",rules:[{required:!0,message:"请输入Secret Key",trigger:"change"}]},api_version:{..._t,label:"API 版本",placeholder:"请输入您的API 版本",optionsKey:"api_versions",options:[],rules:[{required:!0,message:"请选择API 版本",trigger:"change"}]},app_id:{...N,label:"appid",placeholder:"请输入appid",rules:[{required:!0,message:"请输入appid",trigger:"change"}]},region:{...N,label:"region",placeholder:"请输入地区",rules:[{required:!0,message:"请输入地区",trigger:"change"}]}};function mt(_,c){if((c=="yiyan"||c=="doubao")&&_=="secret_key")return{...N,label:"Secret Key",placeholder:"请输入您的Secret Key"};if(ye[_])return ye[_];let a={...N};return a.placeholder="请输入您的"+_,a}const ct={columns:[{title:"模型名称",dataIndex:"model_name",key:"model_name",langKey:"views.user.model.model_name"},{title:"模型类型",dataIndex:"model_type",key:"model_type",langKey:"views.user.model.model_type"}],rows:[],showAddBtn:!1},pt={azure:{columns:[{title:"部署名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},ollama:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},openaiAgent:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"API Key",dataIndex:"api_key",key:"api_key",langKey:"views.user.model.api_key"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},xinference:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"服务器地址",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0}},ft=["azure","ollama","xinference","openaiAgent"];function vt(_){if(ft.indexOf(_.model_define)>-1)return _.config_list;{let c=[];return _.llm_model_list||(_.llm_model_list=[]),_.llm_model_list.forEach(a=>{c.push({model_name:a,model_type:"LLM"})}),_.vector_model_list||(_.vector_model_list=[]),_.vector_model_list.forEach(a=>{c.push({model_name:a,model_type:"TEXT EMBEDDING"})}),_.rerank_model_list.forEach(a=>{c.push({model_name:a,model_type:"RERANK"})}),c}}function xe(_){let c=["model_define","model_icon_url"],a=pt[_.model_define];return a||(a=ct),c.forEach(m=>{a[m]=_[m]}),a.rows=vt(_),a}const yt={class:"form-wrapper"},gt={class:"model-logo-box"},kt=["src"],ht={key:0,href:"https://www.yuque.com/zhimaxiaoshiwangluo/pggco1/hmwl4gveq4xwa4uw?singleDoc# ",target:"_blank"},bt={class:"form-box"},xt={class:"form-item-label"},wt={key:0},Ct={key:1},Mt=["href"],It={__name:"set-model-alert",emits:["ok"],setup(_,{expose:c,emit:a}){const{t:m}=le(),M=a,f=fe.useForm,b=S(""),i=te({model_icon_url:"",model_define:"",model_name:""}),I=S(!1),O=S({}),k=S({}),T=S([]),x=["ollama","xinference","openaiAgent"],Y=(D,p)=>{O.value={},k.value={},T.value=[];const{model_icon_url:J,model_define:W,model_name:V,history_config_params:H}=D;let X=D.config_params;b.value=p?m("common.edit")+" "+V:m("common.add")+" "+V,i.model_icon_url=J,i.model_define=W,i.model_name=V;let z={},u={},e=[];X.unshift("id"),p&&H&&H.length>0&&(X=[...X,...H]),X.forEach(s=>{s=="model_type"&&(s="model_types"),x.indexOf(D.model_define)>-1&&s=="deployment_name"&&(s="model_name");let r=mt(s,W);r.key=s,r.help_links=D.help_links,r.disabled=!1,r.key=="model_types"&&p&&(r.disabled=!0);let L=r.options;p?(x.indexOf(p.model_define)>-1&&p.deployment_name&&(p.model_name=p.deployment_name),u[s]=p[s]||void 0):u[s]=r.defaultValue,r.optionsKey&&D[r.optionsKey]&&(L=D[r.optionsKey]),r.hidden||e.push({...r,options:L,key:s}),r.rules&&(z[s]=r.rules)}),D.model_define=="doubao"?(p||(u.region="cn-beijing"),e.forEach(s=>{s.key=="deployment_name"&&(s.placeholder="请输入接入点ID")}),z.deployment_name&&z.deployment_name.length&&(z.deployment_name[0].message="请输入接入点ID")):z.deployment_name&&z.deployment_name.length&&(z.deployment_name[0].message="请输入部署名称"),O.value=z,k.value=u,T.value=e,I.value=!0,setTimeout(()=>{v()},100)},{resetFields:A,clearValidate:v,validate:y,validateInfos:U}=f(k,O),j=()=>{y().then(()=>{k.value.id?F():R()}).catch(D=>{})},Z=()=>{A(),v()},B=S(!1),R=()=>{let D=G(k.value),p=JSON.parse(JSON.stringify(D));p.model_type=p.model_types,p.model_define=i.model_define,x.indexOf(p.model_define)>-1&&p.model_name&&(p.deployment_name=p.model_name,delete p.model_name),B.value=!0,Ae(p).then(()=>{B.value=!1,I.value=!1,se.success(m("common.saveSuccess")),M("ok")}).catch(()=>{B.value=!1})},F=()=>{let D=G(k.value),p=JSON.parse(JSON.stringify(D));p.model_type=p.model_types,p.model_define=i.model_define,x.indexOf(p.model_define)>-1&&p.model_name&&(p.deployment_name=p.model_name,delete p.model_name),B.value=!0,Ie(p).then(()=>{B.value=!1,I.value=!1,se.success(m("common.saveSuccess")),M("ok")}).catch(()=>{B.value=!1})};return c({open:Y}),(D,p)=>{const J=Ue,W=Ne,V=he,H=ke,X=Ve,z=Pe,u=fe,e=oe;return l(),K(e,{class:"add-model-alert",width:"650px",open:I.value,"onUpdate:open":p[0]||(p[0]=s=>I.value=s),title:b.value,confirmLoading:B.value,onOk:j,onCancel:Z,maskClosable:!1},{default:n(()=>[t("div",yt,[t("div",gt,[t("img",{class:"model-logo",src:i.model_icon_url,alt:""},null,8,kt),i.model_define=="doubao"?(l(),d("a",ht,"查看使用说明>")):E("",!0)]),t("div",bt,[o(u,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:n(()=>[(l(!0),d(C,null,q(T.value,s=>(l(),d(C,{key:s.key},[s.hidden?E("",!0):(l(),K(z,Be({key:0,ref_for:!0},$(U)[s.key]),{label:n(()=>[t("div",xt,[i.model_define=="doubao"&&s.key=="deployment_name"?(l(),d("span",wt,"接入点ID")):(l(),d("span",Ct,g($(m)("views.user.model."+s.key)),1))])]),default:n(()=>[s.componentType=="radio"?(l(),K(W,{key:0,value:k.value[s.key],"onUpdate:value":r=>k.value[s.key]=r,disabled:s.disabled},{default:n(()=>[(l(!0),d(C,null,q(s.options,(r,L)=>(l(),K(J,{value:r,key:L},{default:n(()=>[t("span",null,g(r),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):E("",!0),s.componentType=="radio2"?(l(),K(W,{key:1,value:k.value[s.key],"onUpdate:value":r=>k.value[s.key]=r,disabled:s.disabled},{default:n(()=>[(l(!0),d(C,null,q(s.options,(r,L)=>(l(),K(J,{value:r.value,key:r.value},{default:n(()=>[t("span",null,g(r.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):E("",!0),s.componentType=="select"?(l(),K(H,{key:2,value:k.value[s.key],"onUpdate:value":r=>k.value[s.key]=r,placeholder:s.placeholder},{default:n(()=>[(l(!0),d(C,null,q(s.options,(r,L)=>(l(),K(V,{value:r,key:L},{default:n(()=>[t("span",null,g(r),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):E("",!0),s.componentType=="input"?(l(),d(C,{key:3},[o(X,{value:k.value[s.key],"onUpdate:value":r=>k.value[s.key]=r,placeholder:s.placeholder},null,8,["value","onUpdate:value","placeholder"]),s.key=="api_key"?(l(),d("a",{key:0,href:s.help_links,target:"_blank"},g($(m)("views.user.model.getApikeyText")),9,Mt)):E("",!0)],64)):E("",!0)]),_:2},1040))],64))),128))]),_:1})])])]),_:1},8,["open","title","confirmLoading"])}}},At=Q(It,[["__scopeId","data-v-648e6112"]]),$t={class:"form-wrapper"},Tt={class:"tools-wrapper"},Dt=["src"],Kt={class:"tools-box"},Et={class:"list-box"},St=["onClick"],Ot=["onClick"],Bt={__name:"see-model-alert",emits:["new","edit","remove"],setup(_,{expose:c,emit:a}){const{t:m}=le(),M=a,f=S(!1),b=["ollama","xinference","openaiAgent"],i=te({model_icon_url:"",model_define:"",columns:[],rows:[],showAddBtn:!1});let I=ze({});const O=A=>{I=A;let v=xe(A);for(let y in v)i[y]=v[y];f.value=!0},k=()=>{f.value=!1,M("new",{...I})},T=A=>{f.value=!1,M("edit",{...I},G(A))},x=A=>{f.value=!1,M("remove",G(A))},Y=()=>{};return c({open:O}),(A,v)=>{const y=de,U=qe,j=re,Z=ue,B=oe;return l(),K(B,{class:"add-model-alert",width:"800px",open:f.value,"onUpdate:open":v[0]||(v[0]=R=>f.value=R),title:$(m)("views.user.model.modelConfigButton"),footer:null,onOk:Y},{default:n(()=>[t("div",$t,[t("div",Tt,[t("img",{class:"model-logo",src:i.model_icon_url,alt:""},null,8,Dt),t("div",Kt,[i.showAddBtn?(l(),K(y,{key:0,type:"primary",onClick:k},{default:n(()=>[h(g($(m)("views.user.model.addModel")),1)]),_:1})):E("",!0)])]),t("div",Et,[o(Z,{"data-source":i.rows,scroll:{y:400},pagination:!1},{default:n(()=>[(l(!0),d(C,null,q(i.columns,R=>(l(),d(C,{key:R.key},[R.key=="action"?(l(),K(j,{key:0,title:$(m)("common.action"),"data-index":R.key,width:"140px"},{default:n(({record:F})=>[t("span",null,[t("a",{onClick:D=>T(F)},g($(m)("common.edit")),9,St),o(U,{type:"vertical"}),t("a",{onClick:D=>x(F)},g($(m)("common.remove")),9,Ot)])]),_:2},1032,["title","data-index"])):(l(),K(j,{key:1,title:$(m)("views.user.model."+(b.indexOf(i.model_define)>-1&&R.key=="deployment_name"?"model_name":R.key)),"data-index":R.key},null,8,["title","data-index"]))],64))),128))]),_:1},8,["data-source"])])])]),_:1},8,["open","title"])}}},zt=Q(Bt,[["__scopeId","data-v-905dacec"]]),Lt={__name:"buy-record",props:{list:{type:Array,default:()=>[]}},setup(_,{expose:c}){const a=S(!1),m=f=>f<=0?"--":ge(f*1e3).format("YYYY/MM/DD HH:mm:ss");return c({show:()=>{a.value=!0}}),(f,b)=>{const i=re,I=ue,O=oe;return l(),d("div",null,[o(O,{open:a.value,"onUpdate:open":b[0]||(b[0]=k=>a.value=k),title:"购买记录",footer:null,width:896},{default:n(()=>[o(I,{style:{"margin-top":"16px"},"data-source":_.list},{default:n(()=>[o(i,{key:"create_time",title:"购买时间","data-index":"create_time"},{default:n(({record:k})=>[h(g(m(k.create_time)),1)]),_:1}),o(i,{key:"buy_total",title:"购买积分数","data-index":"buy_total"}),o(i,{key:"use_total",title:"已消耗","data-index":"use_total"}),o(i,{key:"expire_total",title:"已过期","data-index":"expire_total"}),o(i,{key:"surplus_total",title:"剩余额度","data-index":"surplus_total"}),o(i,{key:"expire_time",title:"到期时间","data-index":"expire_time"},{default:n(({record:k})=>[h(g(m(k.expire_time)),1)]),_:1}),o(i,{key:"remark_outer",title:"备注","data-index":"remark_outer"})]),_:1},8,["data-source"])]),_:1},8,["open"])])}}},Rt={class:"modal-box"},Pt={__name:"kefu-modal",setup(_,{expose:c}){const a=S(!1);return c({show:()=>{a.value=!0}}),(M,f)=>{const b=be,i=oe;return l(),d("div",null,[o(i,{open:a.value,"onUpdate:open":f[0]||(f[0]=I=>a.value=I),title:"购买资源包",footer:null,width:546},{default:n(()=>[t("div",Rt,[o(b,{"show-icon":"",message:"暂不支持线上购买，请扫码联系客服购买"}),f[1]||(f[1]=t("div",{class:"img-box"},[t("img",{src:"https://xkf-upload-oss.xiaokefu.com.cn/static/kefu.png",alt:""})],-1))])]),_:1},8,["open"])])}}},Nt=Q(Pt,[["__scopeId","data-v-64d91ba9"]]),Ut={class:"user-model-page"},Vt={class:"list-wrapper"},qt={key:0,class:"alert-content-box"},Ht={key:1,class:"content-body-box"},Gt={class:"model-group-box"},Ft=["onClick"],Xt=["src"],Yt={class:"model-name"},jt={class:"model-content-box"},Jt={class:"statics-block"},Wt={class:"statics-item"},Zt={class:"num"},Qt={class:"statics-item"},el={class:"num"},tl={class:"statics-item"},ll={class:"num"},ol={class:"btn-block"},nl={class:"search-block"},al={class:"search-item"},sl={class:"search-item"},dl={class:"list-box"},il={class:"opration-block"},rl={class:"list-box"},ul=["onClick"],_l=["onClick"],ml={class:"aleat-box"},cl={class:"alert-description"},pl={key:0,class:"text"},fl={class:"btn-box"},vl={class:"list-box"},yl={key:0},gl={key:1},kl={__name:"index",setup(_){const{t:c}=le(),a=S(1),m=()=>{},M=S([]),f=S([]),b=S(""),i=te({all_surplus:0,all_use:0,min_expiretime:"",list:[]}),I=te({model_supplier:void 0,model_type:void 0}),O=()=>{Ke().then(u=>{i.all_surplus=u.data.all_surplus,i.all_use=u.data.all_use,i.list=u.data.list||[],i.min_expiretime=u.data.min_expiretime>0?ge(u.data.min_expiretime*1e3).format("YYYY-MM-DD"):"--"})},k=S(null),T=S(null),x=()=>{O(),T.value.show()};let Y={tongyi:"通义千问",deepseek:"DeepSeek",doubao:"豆包"},A={LLM:"大语言模型","TEXT EMBEDDING":"嵌入模型",RERANK:"重排序模型"};const v=()=>{De({...I}).then(u=>{if(!u.data){f.value=[];return}f.value=u.data.map(e=>({...e,model_supplier_desc:Y[e.model_supplier],model_type_desc:A[e.model_type]}))})},y=ae(()=>M.value.filter(u=>u.model_define==b.value)[0]||{}),U=te({columns:[],rows:[]}),j=u=>{b.value=u.model_define,setTimeout(()=>{Z()},50)},Z=()=>{let u=xe(y.value);for(let e in u)U[e]=u[e]},B=ae(()=>M.value.filter(u=>u.listType==1));Le(()=>B,()=>{B.value.filter(u=>u.model_define==b.value).length==0&&(b.value=B.value[0].model_define,j(B.value[0]))},{deep:!0});const R=ae(()=>M.value),F=()=>{$e().then(u=>{let e=u.data||[];e.forEach(s=>{s.listType=s.config_list.length>0?1:0}),e.sort((s,r)=>s.listType-r.listType),M.value=e})};F();const D=S(null),p=u=>{D.value.open(u)},J=u=>{V.value.open(u)},W=u=>{V.value.open(u)},V=S(null),H=(u,e)=>{V.value.open(u,e)},X=()=>{F()},z=u=>{oe.confirm({title:c("views.user.model.deleteModel"),icon:o(Me),content:c("views.user.model.deleteModelContent"),onOk(){Te({id:u.id}).then(()=>{se.success(c("common.deleteSuccessful")),F()})}})};return(u,e)=>{const s=be,r=de,L=he,me=ke,P=re,ne=ue,we=Ge;return l(),d(C,null,[t("div",Ut,[o(We,{value:a.value,"onUpdate:value":e[0]||(e[0]=w=>a.value=w),onChange:m},null,8,["value"]),t("div",Vt,[a.value==0?(l(),d("div",qt,[o(s,{"show-icon":""},{message:n(()=>e[7]||(e[7]=[t("div",{class:"title"},"使用说明",-1),t("div",null," 1、模型主要分为嵌入模型（TEXT EMBEDDING）和大模型（LLM），嵌入模型用于将上传知识库的文本内容进行向量化便于后续检索，大模型用于将检索到的相关知识进行理解后返回答案。 ",-1),t("div",null,"2、配置模型时尽量选择同时支持LLM和TEXT EMBEDDING的模型，否则要配置多个模型。",-1),t("div",null," 3、国内模型厂商一般都需要认证后才可使用，所以在配置模型前，确保在模型服务厂商那里已认证，否则配置模型时会提示配置参数错误。 ",-1)])),_:1})])):E("",!0),a.value==1?(l(),d("div",Ht,[t("div",Gt,[(l(!0),d(C,null,q(B.value,w=>(l(),d("div",{class:ie(["model-list-item",{active:w.model_define==b.value}]),onClick:ee=>j(w),key:w.model_define},[t("img",{class:"avatar",src:w.model_icon_url,alt:""},null,8,Xt),t("div",Yt,g(w.model_name),1)],10,Ft))),128))]),t("div",jt,[b.value=="chatwiki"?(l(),d(C,{key:0},[t("div",Jt,[t("div",Wt,[e[8]||(e[8]=t("div",{class:"title"},"剩余积分",-1)),t("div",Zt,g($(pe)(i.all_surplus)),1)]),t("div",Qt,[e[9]||(e[9]=t("div",{class:"title"},"累计已使用",-1)),t("div",el,g($(pe)(i.all_use)),1)]),t("div",tl,[e[10]||(e[10]=t("div",{class:"title"},"最近过期时间",-1)),t("div",ll,g(i.min_expiretime),1)]),t("div",ol,[o(r,{type:"primary",onClick:e[1]||(e[1]=w=>k.value.show()),block:""},{default:n(()=>e[11]||(e[11]=[h("购买资源包")])),_:1,__:[11]}),o(r,{onClick:x,block:""},{default:n(()=>e[12]||(e[12]=[h("购买记录")])),_:1,__:[12]})])]),t("div",nl,[t("div",al,[e[16]||(e[16]=t("span",null,"模型供应商：",-1)),o(me,{allowClear:"",onChange:v,value:I.model_supplier,"onUpdate:value":e[2]||(e[2]=w=>I.model_supplier=w),placeholder:"请选择模型供应商",style:{width:"172px"}},{default:n(()=>[o(L,{value:"tongyi"},{default:n(()=>e[13]||(e[13]=[h("通义千问")])),_:1,__:[13]}),o(L,{value:"deepseek"},{default:n(()=>e[14]||(e[14]=[h("DeepSeek")])),_:1,__:[14]}),o(L,{value:"doubao"},{default:n(()=>e[15]||(e[15]=[h("豆包")])),_:1,__:[15]})]),_:1},8,["value"])]),t("div",sl,[e[19]||(e[19]=t("span",null,"模型类型：",-1)),o(me,{allowClear:"",onChange:v,value:I.model_type,"onUpdate:value":e[3]||(e[3]=w=>I.model_type=w),placeholder:"请选择模型类型",style:{width:"172px"}},{default:n(()=>[o(L,{value:"LLM"},{default:n(()=>e[17]||(e[17]=[h("大语言模型")])),_:1,__:[17]}),o(L,{value:"TEXT EMBEDDING"},{default:n(()=>e[18]||(e[18]=[h("嵌入模型")])),_:1,__:[18]})]),_:1},8,["value"])])]),t("div",dl,[o(ne,{"data-source":f.value},{default:n(()=>[o(P,{key:"uni_model_name",title:"模型","data-index":"uni_model_name"}),o(P,{key:"model_supplier_desc",title:"模型服务商","data-index":"model_supplier_desc"}),o(P,{key:"model_type_desc",title:"模型类型","data-index":"model_type_desc"}),o(P,{key:"price",title:"价格","data-index":"price"},{default:n(({record:w})=>[h(g(w.price)+"积分/千Token",1)]),_:1})]),_:1},8,["data-source"])])],64)):(l(),d(C,{key:1},[["xinference","azure","doubao","openaiAgent","ollama"].includes(b.value)?(l(),d(C,{key:0},[t("div",il,[o(r,{type:"primary",onClick:e[4]||(e[4]=w=>J(y.value))},{default:n(()=>[o($(He)),e[20]||(e[20]=h("添加模型"))]),_:1,__:[20]})]),t("div",rl,[o(ne,{pagination:!1,"data-source":y.value.config_list},{default:n(()=>[o(P,{key:"deployment_name","data-index":"deployment_name"},{title:n(()=>[b.value=="doubao"?(l(),d(C,{key:0},[h("接入点ID")],64)):(l(),d(C,{key:1},[h("模型名称")],64))]),_:1}),b.value=="doubao"?(l(),K(P,{key:"show_model_name",title:"模型名称","data-index":"show_model_name"})):E("",!0),o(P,{key:"model_types",title:"模型类型","data-index":"model_types"},{default:n(({record:w,text:ee})=>[h(g($(A)[ee]),1)]),_:1}),b.value=="azure"?(l(),K(P,{key:"api_version",title:"API版本","data-index":"api_version"})):E("",!0),["openaiAgent","ollama"].includes(b.value)?(l(),K(P,{key:"api_endpoint",title:"API 域名","data-index":"api_endpoint"})):E("",!0),o(P,{width:120,key:"action",title:"操作"},{default:n(({record:w})=>[o(we,{gap:16},{default:n(()=>[t("a",{onClick:ee=>H(y.value,w)},"编辑",8,ul),t("a",{onClick:ee=>z(w)},"移除",8,_l)]),_:2},1024)]),_:1})]),_:1},8,["data-source"])])],64)):(l(),d(C,{key:1},[t("div",ml,[o(s,null,{message:n(()=>[t("div",cl,[y.value.config_list&&y.value.config_list.length?(l(),d("div",pl,[o($(_e)),h(" API Key："+g(y.value.config_list[0].api_key.slice(0,10)+"..."),1)])):E("",!0),t("div",fl,[o(r,{onClick:e[5]||(e[5]=w=>H(y.value,y.value.config_list[0])),size:"small"},{default:n(()=>e[21]||(e[21]=[h("修改配置")])),_:1,__:[21]}),o(r,{size:"small",onClick:e[6]||(e[6]=w=>z(y.value.config_list[0]))},{default:n(()=>e[22]||(e[22]=[h("移除配置")])),_:1,__:[22]})])])]),_:1})]),t("div",{class:"message-total-tip",onClick:Z}," 支持的模型（"+g(U.rows.length)+"） ",1),t("div",vl,[o(ne,{pagination:!1,"data-source":U.rows},{default:n(()=>[(l(!0),d(C,null,q(U.columns,w=>(l(),K(P,{key:w.key,title:w.title,"data-index":w.dataIndex},{default:n(({record:ee,text:ce})=>[w.key=="model_type"?(l(),d("div",yl,g($(A)[ce]),1)):(l(),d("div",gl,g(ce),1))]),_:2},1032,["title","data-index"]))),128))]),_:1},8,["data-source"])])],64))],64))])])):E("",!0),a.value==0?(l(),K(rt,{list:R.value,type:2,key:"canAddModelList",onAdd:W,onSee:p},null,8,["list"])):E("",!0)])]),o(zt,{ref_key:"seeModelAlertRef",ref:D,onNew:J,onEdit:H,onRemove:z},null,512),o(At,{ref_key:"setModelAlertRef",ref:V,onOk:X},null,512),o(Lt,{list:i.list,ref_key:"buyRecordRef",ref:T},null,8,["list"]),o(Nt,{ref_key:"kefuModalRef",ref:k},null,512)],64)}}},ho=Q(kl,[["__scopeId","data-v-b1f77522"]]);export{ho as default};
