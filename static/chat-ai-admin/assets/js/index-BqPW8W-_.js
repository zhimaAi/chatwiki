import{n as k,k as V,b as S,d as j,bA as E,B as J,bB as H,bC as P,bD as X}from"../../index-CzPebXix.js";import{d as g,z as I,q as L,w as Z,N as m,O as r,X as t,j as i,U as y,F as z,a1 as F,u as T,S as N,Z as h,_,a2 as G,a6 as O,a3 as Q}from"./vue-chunks-BRsu9_To.js";import{a as K,_ as W}from"./RadioButton-h1wW1k6O.js";import{R as tt}from"./dayjs-DSnEW89Q.js";import{_ as et}from"./index-B6poN8MH.js";import{S as st,a as at}from"./index-6HDf6TPN.js";import{_ as ot}from"./index-BhUXTHsq.js";import{_ as nt,a as lt}from"./index-Bh3NMpRp.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./FormItemContext-B2RmG14m.js";import"./Checkbox-oqMTsvET.js";import"./index-D17QejXF.js";import"./index-BukWVUqX.js";import"./colors-DfoziJR7.js";import"./ClockCircleOutlined-bBTx_Knl.js";import"./useMergedState-C0iIHNGF.js";import"./Trigger-Bvakuge0.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./shallowequal-C0xnIuy8.js";import"./index-Bxqtz4sn.js";import"./move-CkiYyFmr.js";import"./slide-CsbPJG8I.js";import"./index-Bhf8G0AA.js";import"./List-D7uk7Chm.js";import"./DownOutlined-DXKkgIsm.js";import"./CheckOutlined-Mk6nTpyE.js";import"./SearchOutlined-a_gTycfl.js";import"./index-BYVEo4R0.js";import"./collapseMotion-Brd6xpAT.js";import"./CaretDownFilled-DSht_iiA.js";import"./index-BhHQj-ne.js";import"./responsiveObserve-DqAe0rZk.js";import"./index-0UwCX3b0.js";import"./LeftOutlined-BKUTcRtP.js";import"./RightOutlined-DH_YROnp.js";import"./index-BwqnaIPU.js";import"./index-DLRiQ5Ho.js";import"./index-BSz5XTfh.js";import"./dropdown-DTOAy9tU.js";import"./index-DlQVT6K6.js";import"./index-Di5l0R3t.js";import"./CaretDownOutlined-Byn8iz8T.js";import"./index-BFhVTGQQ.js";import"./Input-DFtZp9vk.js";import"./inputProps-jdR54afw.js";import"./Search-Cf7bcOZJ.js";import"./isPlainObject-OEy0Jz8l.js";import"./TextArea-DrgXbuSS.js";import"./Password-fnCqxsm2.js";const it={class:"zm-date"},dt={class:"date-btn"},rt={class:"date-content"},ct={__name:"date",props:{datekey:{type:String,default:"1"}},emits:["dateChange"],setup(M,{emit:$}){const x=M,v=g(1),o=$;let C=I([{label:"今日",value:!0,key:2,start_time:k().startOf("day"),end_time:k().endOf("day")},{label:"昨日",value:!1,key:3,start_time:k().subtract(1,"day").startOf("day"),end_time:k().startOf("day").subtract(1,"millisecond")},{label:"近7日",value:!1,key:4,start_time:k().subtract(6,"day").startOf("day"),end_time:k().endOf("day").subtract(1,"millisecond")}]);const e=g(null),a=g(null),u=g([]),d=n=>n>=k().subtract(0,"day"),s=()=>{let n=v.value,p=null;C.forEach(c=>{c.key==n&&(p=c)}),p?(u.value=[p.start_time,p.end_time],e.value=p.start_time.format("YYYY-MM-DD"),a.value=p.end_time.format("YYYY-MM-DD")):(u.value=[],e.value=null,a.value=null),w()},D=n=>{const p=k(n[0]).startOf("day");if(k(n[1]).endOf("day").diff(p,"days")>29)u.value[0]=n[0].startOf("day"),u.value[1]=p.add(29,"days").endOf("day"),e.value=u.value[0].format("YYYY-MM-DD"),a.value=u.value[1].format("YYYY-MM-DD"),V.error("最多只能选择30天");else{const l=k(n[0]).startOf("day").format("YYYY-MM-DD"),Y=k(n[1]).endOf("day").format("YYYY-MM-DD");u.value=n,e.value=l,a.value=Y}v.value=1,w()},w=()=>{o("dateChange",{start_date:e.value,end_date:a.value})};return L(()=>{v.value=parseInt(x.datekey),s()}),Z(()=>x.datekey,(n,p)=>{v.value=parseInt(x.datekey.split("-")[0]),s()}),(n,p)=>{const c=K,l=W,Y=tt;return r(),m("div",it,[t("div",dt,[i(l,{value:v.value,"onUpdate:value":p[0]||(p[0]=b=>v.value=b),onChange:s},{default:y(()=>[(r(!0),m(z,null,F(T(C),b=>(r(),N(c,{class:"date-btn-button",value:b.key,key:b.key},{default:y(()=>[h(_(b.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),t("div",rt,[i(Y,{value:u.value,"onUpdate:value":p[1]||(p[1]=b=>u.value=b),onChange:D,format:"YYYY-MM-DD",disabledDate:d,allowClear:!1},null,8,["value"])])])}}},_t={class:"feedbacks-log-content"},ut={class:"feedbacks-log-items"},pt={class:"feedbacks-log-item"},mt={class:"feedbacks-log-items"},vt={class:"feedbacks-log-item"},ft={class:"feedbacks-log-items"},bt={class:"feedbacks-log-item"},yt={key:0,class:"item-type"},kt={key:1,class:"item-type"},gt={class:"feedbacks-log-label"},ht={class:"feedbacks-log-item"},xt={class:"quotes-box"},Ct={key:0,class:"document-content"},Dt={key:1},Yt={class:"document-content"},$t={class:"document-content"},wt=["onClick"],Ot={class:"feedbacks-log-items"},qt={class:"feedbacks-log-item"},Mt={key:0},zt={key:1},Ft={key:2},St={class:"feedbacks-log-items"},jt={class:"feedbacks-log-item"},It={__name:"feedbacks-log-alert",setup(M,{expose:$}){const x=G(),v=g(!1),o=I({question:"",library:[],context_qa:[],cur_question:"",cur_answer:"",error:""}),C=()=>{v.value=!1},e=()=>{o.question="",o.library=[],o.context_qa=[],o.cur_question="",o.cur_answer="",o.error=""},a=d=>{e();for(const s in d)o[s]=d[s],s=="robot"&&(o[s]=JSON.parse(d[s])),s=="quotes"&&(o[s]=JSON.parse(d[s]));v.value=!0},u=d=>{x.push("/library/preview?id="+d.FileId)};return $({open:a}),(d,s)=>{const D=j,w=et;return r(),N(w,{class:"feedbacks-log-alert",open:v.value,"onUpdate:open":s[0]||(s[0]=n=>v.value=n),title:"反馈详情",placement:"right",width:"746px",closable:!1},{extra:y(()=>[t("span",{class:"close-btn",onClick:C},[i(T(E))])]),default:y(()=>[t("div",_t,[t("div",ut,[s[1]||(s[1]=t("div",{class:"feedbacks-log-label"},[t("span",null,"问题 ")],-1)),t("div",pt,[t("p",null,_(o.question),1)])]),t("div",mt,[s[2]||(s[2]=t("div",{class:"feedbacks-log-label"},[t("span",null,"回答 ")],-1)),t("div",vt,[t("p",null,_(o.answer),1)])]),t("div",ft,[s[5]||(s[5]=t("div",{class:"feedbacks-log-label"},[t("span",null,"反馈 ")],-1)),t("div",bt,[o.type=="1"?(r(),m("div",yt,[i(D,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"like-active"}),s[3]||(s[3]=h("点赞"))])):O("",!0),o.type=="2"?(r(),m("div",kt,[i(D,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"dislike-active"}),s[4]||(s[4]=h("点踩"))])):O("",!0),t("p",null,_(o.content),1)])]),(r(!0),m(z,null,F(o.quotes,(n,p)=>(r(),m("div",{class:"feedbacks-log-items",key:n.FileId},[t("div",gt,[t("span",null,"参考内容"+_(p+1),1)]),t("div",ht,[t("div",xt,[n.Type==1?(r(),m("div",Ct,_(n.Content),1)):n.Type==2?(r(),m("div",Dt,[t("div",Yt,"Q："+_(n.Question),1),t("div",$t,"A："+_(n.Answer),1)])):O("",!0),t("div",{class:"quotes-title",onClick:c=>u(n)},[i(D,{style:{"font-size":"16px",color:"#2475FC","margin-right":"4px"},name:"quotes"}),h(_(n.FileName),1)],8,wt)])])]))),128)),t("div",Ot,[s[6]||(s[6]=t("div",{class:"feedbacks-log-label"},[t("span",null,"聊天模式 ")],-1)),t("div",qt,[o.robot.chat_type=="1"?(r(),m("p",Mt,"仅知识库")):o.robot.chat_type=="2"?(r(),m("p",zt,"直连")):o.robot.chat_type=="3"?(r(),m("p",Ft,"混合")):O("",!0)])]),t("div",St,[s[7]||(s[7]=t("div",{class:"feedbacks-log-label"},[t("span",null,"使用模型 ")],-1)),t("div",jt,[t("p",null,_(o.robot.use_model)+"("+_(o.robot.corp_name)+")",1)])])])]),_:1},8,["open"])}}},Lt=S(It,[["__scopeId","data-v-3949ccd6"]]),Nt={class:"team-members-pages"},At={class:"total"},Bt={class:"total-num"},Rt={class:"set-model"},Tt={class:"set-model-body"},Qt={class:"set-date"},Ut={class:"set-date-body"},Vt={class:"set-reset"},Et={class:"list-box"},Jt={class:"user-box"},Ht={class:"name-info"},Pt={class:"user-name"},Xt={class:"user-info"},Zt={key:0,class:"item-type"},Gt={key:1,class:"item-type"},Kt={class:"item-content"},Wt={class:"item-date"},te={__name:"qa-feedback",setup(M){const $=g(null),x=Q(),v=g("1"),o=x.query,C=g([{key:"all",id:"all",label:"全部类型",title:"全部类型"},{key:"1",id:"1",label:"点赞",title:"点赞"},{key:"2",id:"2",label:"点踩",title:"点踩"}]),e=I({robot_id:o.id,page:1,size:20,total:0,type:"all",start_date:"",end_date:""}),a=c=>{e.start_date=c.start_date,e.end_date=c.end_date,D()},u=async c=>{const l=await H({id:c.id});$.value.open(l.data)},d=()=>{e.type="all",e.start_date="",e.end_date="",v.value="1-"+Math.random()},s=c=>{e.page=c.current,e.size=c.pageSize,n()},D=()=>{e.page=1,n()},w=g([]),n=()=>{let c={robot_id:e.robot_id,page:e.page,size:e.size,start_date:e.start_date,end_date:e.end_date};e.type!="all"&&(c.type=e.type),P(c).then(l=>{let Y=l.data.list;Y.forEach(b=>{b.create_time=b.create_time>0?k(b.create_time*1e3).format("YYYY-MM-DD HH:mm"):"--",b.content=b.content?b.content:"--"}),w.value=Y,e.total=+l.data.total})},p=c=>{e.type=c,D()};return L(()=>{}),(c,l)=>{const Y=at,b=st,A=J,B=ot,q=nt,R=j,U=lt;return r(),m("div",Nt,[i(B,{justify:"flex-end"},{default:y(()=>[t("div",At,[l[1]||(l[1]=t("div",{class:"label total-label"},"共计：",-1)),t("div",Bt,_(e.total)+"条",1)]),t("div",Rt,[l[2]||(l[2]=t("div",{class:"label set-model-label"},"类型：",-1)),t("div",Tt,[i(b,{value:e.type,"onUpdate:value":l[0]||(l[0]=f=>e.type=f),placeholder:"全部类型",onChange:p,style:{width:"130px"}},{default:y(()=>[(r(!0),m(z,null,F(C.value,f=>(r(),N(Y,{key:f.key,value:f.id},{default:y(()=>[t("span",null,_(f.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),t("div",Qt,[l[3]||(l[3]=t("div",{class:"label set-date-label"},[t("span",null,"日期：")],-1)),t("div",Ut,[i(ct,{onDateChange:a,datekey:v.value},null,8,["datekey"])])]),t("div",Vt,[i(A,{onClick:d},{default:y(()=>l[4]||(l[4]=[h("重置")])),_:1,__:[4]})])]),_:1}),t("div",Et,[i(U,{"data-source":w.value,pagination:e.total>e.size?{current:e.page,total:e.total,pageSize:e.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}:!1,onChange:s},{default:y(()=>[i(q,{title:"问答","data-index":"question",width:"411px"},{default:y(({record:f})=>[t("div",Jt,[t("div",Ht,[t("div",Pt,_(f.question),1),t("div",Xt,_(f.answer),1)])])]),_:1}),i(q,{title:"回答反馈","data-index":"type",width:"160px"},{default:y(({record:f})=>[f.type=="1"?(r(),m("div",Zt,[i(R,{style:{"font-size":"24px",color:"#8C8C8C"},name:"like"}),l[5]||(l[5]=h("点赞"))])):O("",!0),f.type=="2"?(r(),m("div",Gt,[i(R,{style:{"font-size":"24px",color:"#8C8C8C"},name:"dislike"}),l[6]||(l[6]=h("点踩"))])):O("",!0)]),_:1}),i(q,{title:"反馈内容","data-index":"content",width:"264px"},{default:y(({record:f})=>[t("div",Kt,_(f.content),1)]),_:1}),i(q,{title:"时间","data-index":"create_time",width:"200px"},{default:y(({record:f})=>[t("div",Wt,_(f.create_time),1)]),_:1}),i(q,{title:"操作","data-index":"action",width:"88px"},{default:y(({record:f})=>[i(B,{gap:16,class:"action-box"},{default:y(()=>[i(A,{type:"link",onClick:re=>u(f)},{default:y(()=>l[7]||(l[7]=[h("查看详情")])),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),i(Lt,{ref_key:"feedbacksLogAlertRef",ref:$},null,512)])}}},ee=S(te,[["__scopeId","data-v-e51b0e6b"]]),se={class:"user-model-page"},ae={class:"overview-box"},oe={class:"item-info"},ne={class:"item-icon-content item-like"},le={class:"item-icon-content item-dislike"},ie={class:"list-wrapper"},de={__name:"index",setup(M){const x=Q().query,v=g([]),o=e=>{let a={title:"",id:0};switch(e){case"today_stats":a.title="今日",a.id=1;break;case"yesterday_stats":a.title="昨日",a.id=2;break;case"week_stats":a.title="近7日",a.id=3;break;case"total_stats":a.title="总计",a.id=4;break}return a},C=()=>{let e={robot_id:x.id};X(e).then(a=>{const u=[];for(const d in a.data){const s=a.data[d];u.push({key:d,dislike:s.dislike,like_count:s.like_count,titleObj:o(d)})}v.value=u.sort((d,s)=>d.titleObj.id-s.titleObj.id)})};return L(()=>{C()}),(e,a)=>{const u=j;return r(),m("div",se,[a[0]||(a[0]=t("div",{class:"page-title"},"数据概览",-1)),t("div",ae,[(r(!0),m(z,null,F(v.value,d=>(r(),m("div",{class:"item-box",key:d.titleObj.id},[t("div",oe,_(d.titleObj.title),1),t("div",ne,[i(u,{style:{"font-size":"24px",color:"#8C8C8C"},name:"like"}),h(_(d.like_count),1)]),t("div",le,[i(u,{style:{"font-size":"24px",color:"#8C8C8C"},name:"dislike"}),h(_(d.dislike),1)])]))),128))]),a[1]||(a[1]=t("div",{class:"page-title"},"反馈记录",-1)),t("div",ie,[i(ee)])])}}},ds=S(de,[["__scopeId","data-v-80174709"]]);export{ds as default};
