import{u as K,c as W,_ as Y,cy as lt,cz as it,cA as ct,ac as rt,ad as _t}from"../../index-DSFcP5NQ.js";import{r as p,ag as J,c as Q,V as ut,a as m,b as r,y as v,t as V,p as t,e as L,v as u,_ as A,u as _,z as dt,G as O,E as F,j as pt,ah as mt,h as U,q as H,F as j,l as G,i as vt,Y as ft}from"./vue-chunks-BdaA73Wf.js";import{_ as ht}from"./main-tab-CdcTMZsk.js";import{E as gt}from"./empty-box-DAN5iPDv.js";import{L as X}from"./loading-box-CQ9Pukre.js";/* empty css                                                                     */import{_ as Z}from"./emoji-mart-BBMRoEa3.js";import{g as kt,u as tt,a as bt,b as yt}from"./template-pJlgY6bX.js";import{B as xt,M as E,O as R,b as et,W as wt,I as Tt,q as Ct,bd as $t}from"./ui-antd-Dl1wwwCD.js";import{u as Mt}from"./usePublicNetworkCheck-B51wgX5Y.js";import{P as Dt}from"./public-network-check-BgOXIe2j.js";import"./neo4j-MWxXN7EM.js";import"./editor-cherry-CFIsbKoN.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";import"./list-tabs-Dv38O5dh.js";import"./index-BuURB1pl.js";import"./empty-BFmzY9bl.js";const Nt={class:"_container _plugin-detail-cont"},zt={key:1,class:"content"},Et={class:"base-info"},St={class:"top"},Lt=["src"],Vt={class:"info"},At={class:"left"},Ot={class:"name zm-line1"},Rt={class:"source"},Bt=["src"],It={class:"right"},Pt={class:"desc"},qt={class:"detail-info"},Ft={class:"left"},Ut={class:"main-block"},Ht={class:"main-tit"},jt=["innerHTML"],Gt={__name:"detail-model",setup(ot,{expose:a}){const{t:i}=K("views.explore.templates.detail-model"),g=p(!1),B=l=>{k.value=l.robot_id,f(),g.value=!0},S=J(),y=W(),{companyInfo:x}=y,w=Q(()=>x==null?void 0:x.version),T=p(!0),k=p(null),s=p({});function f(){T.value=!0,kt({robot_id:k.value}).then(l=>{s.value=(l==null?void 0:l.data)||{}}).finally(()=>{T.value=!1})}function I(){const l=s.value;function C(h,d){return h=Number(h.replace(/\D/g,"")),d=Number(d.replace(/\D/g,"")),h>=d}const $=()=>{tt({template_id:l.id,csl_url:l.csl_url}).then(h=>{et.success(i("msg_use_success"));const{id:d,robot_key:z}=h.data,M=S.resolve({path:"/robot/config/workflow",query:{id:d,robot_key:z}});window.open(M.href,"_blank"),g.value=!1})};C(w.value,l.version)?E.confirm({title:i("title_tip"),content:i("msg_confirm_use_template",{name:l.name}),icon:O(R),okText:i("btn_confirm"),cancelText:i("btn_cancel"),onOk:$}):E.confirm({title:i("title_tip"),content:i("msg_version_too_low"),icon:O(R),okText:i("btn_continue_use"),cancelText:i("btn_cancel"),onOk:$})}return a({show:B}),(l,C)=>{const $=Y,h=xt,d=E,z=ut("viewer");return r(),m("div",null,[v(d,{open:g.value,"onUpdate:open":C[0]||(C[0]=M=>g.value=M),title:_(i)("title_template_detail"),wrapClassName:"no-padding-modal",footer:null,width:800},{default:V(()=>[t("div",Nt,[T.value?(r(),L(X,{key:0})):(r(),m("div",zt,[t("div",Et,[t("div",St,[t("img",{class:"avatar",src:s.value.avatar},null,8,Lt),t("div",Vt,[t("div",At,[t("div",Ot,u(s.value.name),1),t("div",Rt,[t("img",{class:"avatar",src:s.value.account_avatar},null,8,Bt),A(" "+u(s.value.author),1)])]),t("div",It,[v(h,{class:"use-btn",type:"primary",ghost:"",onClick:I},{default:V(()=>[v($,{name:"icon-rocket"}),A(" "+u(_(i)("btn_use_template")),1)]),_:1})])])]),t("div",Pt,u(s.value.description),1)]),t("div",qt,[t("div",Ft,[t("div",Ut,[t("div",Ht,u(_(i)("title_usage_instructions")),1),dt(t("pre",{class:"text-cont",innerHTML:s.value.instructions},null,8,jt),[[z]])])])])]))])]),_:1},8,["open","title"])])}}},Kt=Z(Gt,[["__scopeId","data-v-fa9d5cc2"]]),Wt={class:"_container"},Yt={class:"header"},Jt={class:"main-tab-box"},Qt={key:1,class:"content"},Xt={class:"left-box hide-scrollbar"},Zt={class:"title"},te={class:"cate-box"},ee={key:0,class:"count"},oe=["onClick"],se={class:"count"},ne={class:"_plugin-box",style:{"margin-top":"12px"}},ae={key:0,class:"plugin-list"},le=["onClick"],ie={class:"main-pic-box"},ce=["src"],re={class:"base-info-box"},_e={class:"title zm-line1"},ue={class:"avater-box"},de=["src"],pe={class:"author-text"},me={class:"action-box"},ve={class:"left"},fe={class:"right"},he=["onClick"],ge={__name:"index",setup(ot){const{t:a}=K("views.explore.templates.index"),{isPublicNetwork:i}=Mt($),g=mt(),B=J(),S=p(null);p(localStorage.getItem("zm:explore:active")||"4");const y=p(!0),x=p(!1),w=p([]),T=p([]),k=p(0),s=F({keyword:"",category:null}),f=F({current:1,pageSize:50,total:0}),I=W(),{companyInfo:l}=I,C=Q(()=>l==null?void 0:l.version);pt(()=>{g.query.active>1&&S.value.change(g.query.active)});function $(){vt(()=>{h(),d()})}function h(){bt().then(o=>{let n=(o==null?void 0:o.data)||[];k.value=0,n.map(c=>k.value+=Number((c==null?void 0:c.template_count)||0)),T.value=n})}async function d(){var n;y.value=!0;let o={page:f.current,size:f.pageSize};s.keyword&&(o.keyword=s.keyword),s.category&&(o.category_id=(n=s.category)==null?void 0:n.id),yt(o).then(c=>{var D,e;let b=((D=c==null?void 0:c.data)==null?void 0:D.data)||[];(!b.length||b.length<f.pageSize)&&(x.value=!0),w.value.push(...b),f.current+=1,f.total=Number(((e=c==null?void 0:c.data)==null?void 0:e.total)||0)}).finally(()=>{y.value=!1})}function z(o){y.value||x.value||lt(o,d)}function M(){f.current=1,f.total=0,w.value=[],d()}function P(o){s.category=o,M()}function st(o,n){return o=Number(o.replace(/\D/g,"")),n=Number(n.replace(/\D/g,"")),o>=n}function nt(o){const n=()=>{tt({template_id:o.id,csl_url:o.csl_url}).then(c=>{et.success(a("msg_use_success")),d();const{id:b,robot_key:D}=c.data,e=B.resolve({path:"/robot/config/workflow",query:{id:b,robot_key:D}});window.open(e.href,"_blank")})};st(C.value,o.version)?E.confirm({title:a("title_tip"),content:a("msg_confirm_use_template",{name:o.name}),icon:O(R),okText:a("btn_confirm"),cancelText:a("btn_cancel"),onOk:n}):E.confirm({title:a("title_tip"),content:a("msg_version_too_low"),icon:O(R),okText:a("btn_continue_use"),cancelText:a("btn_cancel"),onOk:n})}const q=p(null),at=o=>{q.value.show(o)};return(o,n)=>{const c=Tt,b=Ct,D=Y;return r(),m("div",Wt,[t("div",Yt,[t("div",Jt,[v(ht,{ref_key:"tabRef",ref:S},null,512)])]),_(i)?(r(),m("div",Qt,[t("div",Xt,[t("div",Zt,[v(c,{value:s.keyword,"onUpdate:value":n[0]||(n[0]=e=>s.keyword=e),valueModifiers:{trim:!0},onChange:M,style:{width:"100%"},allowClear:"",placeholder:_(a)("ph_search_template")},{suffix:V(()=>[v(_(wt))]),_:1},8,["value","placeholder"])]),t("div",te,[t("div",{class:U(["cate-item",{active:!s.category}]),onClick:n[1]||(n[1]=e=>P(null))},[t("div",null,u(_(a)("label_all")),1),k.value>0?(r(),m("span",ee,u(k.value),1)):H("",!0)],2),(r(!0),m(j,null,G(T.value,e=>{var N;return r(),m("div",{key:e.id,class:U(["cate-item",{active:e.id==((N=s.category)==null?void 0:N.id)}]),onClick:ke=>P(e)},[t("div",null,u(e.name),1),t("span",se,u(e.template_count||0),1)],10,oe)}),128))])]),t("div",{class:"right-box",onScroll:z},[t("div",ne,[w.value.length?(r(),m("div",ae,[(r(!0),m(j,null,G(w.value,e=>(r(),m("div",{key:e.id,class:"plugin-item",onClick:N=>at(e)},[t("div",ie,[t("img",{src:e.main_pic||_(it),alt:""},null,8,ce)]),t("div",re,[t("div",_e,u(e.name),1),t("div",ue,[t("img",{src:e.avatar||_(ct),alt:""},null,8,de),t("div",pe,u(e.author),1)]),v(b,{title:_(_t)(e.description,e,14,2.5,60),placement:"top"},{default:V(()=>[t("div",{class:"desc zm-line",ref_for:!0,ref:N=>_(rt)(N,e)},u(e.description),513)]),_:2},1032,["title"]),t("div",me,[t("div",ve,[v(_($t)),A(" "+u(e.use_count||0),1)]),t("div",fe,[t("a",{onClick:ft(N=>nt(e),["stop","prevent"])},[v(D,{name:"icon-rocket"}),A(" "+u(_(a)("btn_use_template")),1)],8,he)])])])],8,le))),128))])):(r(),L(gt,{key:1,title:_(a)("msg_no_available_plugin")},null,8,["title"])),y.value?(r(),L(X,{key:2})):H("",!0)])],32)])):(r(),L(Dt,{key:0})),v(Kt,{ref_key:"detailModelRef",ref:q},null,512)])}}},Pe=Z(ge,[["__scopeId","data-v-9f584af9"]]);export{Pe as default};
//# sourceMappingURL=index-1LyEFvn6.js.map
