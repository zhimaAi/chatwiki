import{b as Z,f as le,m as me}from"../../index-CuuB1UbP.js";import{e as be,a as we,g as Ce,d as Ie,b as Me,c as Ae}from"./index-8tBguPN_.js";import{f as E,Y as d,_ as l,F as C,a9 as V,ad as de,a7 as v,u as A,a5 as t,k as o,ai as $e,a2 as n,G as k,ae as D,n as Te,a1 as K,A as Ke,J as G,r as te,a4 as De,aj as Ee,e as ae,w as Se}from"./vue-chunks-Ci-XTWEs.js";import{p as Be,B as ie,F as pe,e as Le,q as Re,R as Ne,u as ve,v as ye,I as Oe,M as oe,a as se,w as ue,x as Pe,y as _e,d as ge,k as ke,z as Ue,E as qe,G as ze,H as Ve}from"./ui-antd-DhoCz7ZP.js";import"./utils-ChQO-_r6.js";const Fe={class:"page-tabs"},Ge=["onClick"],Ye={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(y,{emit:w}){const{t:s}=le(),c=w,S=y,m=E([{value:1,title:s("views.user.model.modelsHaveBeenAdded"),langKey:"views.user.model.modelsHaveBeenAdded"},{value:0,title:s("views.user.model.canAddAModel"),langKey:"views.user.model.canAddAModel"}]),h=i=>{c("update:value",i),c("change",i)};return(i,I)=>(l(),d("div",Fe,[(l(!0),d(C,null,V(m.value,B=>(l(),d("div",{class:de(["tab-item",{active:S.value==B.value}]),onClick:g=>h(B.value),key:B.value},v(A(s)(B.langKey)),11,Ge))),128))]))}},Xe=Z(Ye,[["__scopeId","data-v-cc65f89a"]]),He={class:"model-list"},Je={class:"model-item-left"},je={class:"model-item-left-top"},We=["src"],Qe={class:"model-name"},Ze={class:"model-tags"},et={key:0,class:"tag"},tt={class:"model-item-left-bottom"},lt={class:"model-desc"},ot={class:"model-item-right"},nt={__name:"model-list",props:{type:{type:Number,default:()=>1},list:{type:Array,default:()=>[]}},emits:["edit","new","see","remove","add"],setup(y,{emit:w}){const{t:s}=le(),c=w,S=["azure","ollama","xinference","openaiAgent"],m=y,h=$=>{c("see",G($))},i=$=>{let x=G($);c("edit",x,x.config_list[0])},I=$=>{c("new",G($))},B=$=>{c("add",G($))},g=$=>{let x=G($);c("remove",x.config_list[0])};return($,x)=>{const H=Be,M=ie;return l(),d("div",He,[(l(!0),d(C,null,V(m.list,p=>(l(),d("div",{class:"model-item",key:p.model_define},[t("div",Je,[t("div",je,[t("img",{class:"model-logo",src:p.model_icon_url,alt:""},null,8,We),t("div",Qe,v(p.model_name),1),x[3]||(x[3]=t("div",{class:"line"},null,-1)),t("div",Ze,[(l(!0),d(C,null,V(p.support_list,(f,q)=>(l(),d("div",{key:q},[o(H,null,$e({default:n(()=>[f!="SPEECH2TEXT"&&f!="TTS"?(l(),d("span",et,v(f),1)):D("",!0)]),_:2},[f=="LLM"?{name:"title",fn:n(()=>[x[0]||(x[0]=k("大语言模型，添加机器人时需要选择一个大语言模型。用户的提问将交由大语言模型，结合知识库给出答案。"))]),key:"0"}:f=="TEXT EMBEDDING"?{name:"title",fn:n(()=>[x[1]||(x[1]=k("嵌入模型，添加知识库时需要选择嵌入模型，用于将知识库分段向量化。用户提问时也会将问题生成向量，通过比对向量相似度的方式四配跟提问语义相近的知识库分段。向量检索具备很好的语义分析能力。"))]),key:"1"}:f=="RERANK"?{name:"title",fn:n(()=>[x[2]||(x[2]=k("重排序模型,通过重排序模型,将从知识库中检索出来的分段进行重新排序。再将重排序的结果前top-K传递个大语言模型生成答案。重排序有助于优化检索结果，提高大语言模型回答的准确性。"))]),key:"2"}:void 0]),1024)]))),128))])]),t("div",tt,[t("div",lt,v(p.introduce),1)])]),t("div",ot,[Te(o(M,{class:de({"btn-red":p.listType==1&&m.type==1}),onClick:f=>g(p)},{default:n(()=>[k(v(p.listType==1&&m.type==1?"移除配置":"删除"),1)]),_:2},1032,["class","onClick"]),[[Ke,m.type==1]]),m.type==2&&p.model_define!="azure"?(l(),K(M,{key:0,class:"add-btn",onClick:f=>h(p)},{default:n(()=>x[4]||(x[4]=[k("查看模型")])),_:2,__:[4]},1032,["onClick"])):D("",!0),m.type==2?(l(),K(M,{key:1,disabled:p.listType==1,class:"add-btn",onClick:f=>B(p)},{default:n(()=>x[5]||(x[5]=[k("添加配置")])),_:2,__:[5]},1032,["disabled","onClick"])):D("",!0),p.listType==1&&m.type==1?(l(),d(C,{key:2},[S.indexOf(p.model_define)>-1?(l(),d(C,{key:0},[o(M,{class:"add-btn",onClick:f=>h(p)},{default:n(()=>[k(v(A(s)("views.user.model.modelConfigButton"))+"（"+v(p.config_list.length)+"）",1)]),_:2},1032,["onClick"]),o(M,{class:"add-btn",onClick:f=>I(p)},{default:n(()=>[k(v(A(s)("views.user.model.addModelButton")),1)]),_:2},1032,["onClick"])],64)):(l(),d(C,{key:1},[o(M,{class:"add-btn",onClick:f=>i(p)},{default:n(()=>[k(v(A(s)("views.user.model.editModelButton")),1)]),_:2},1032,["onClick"]),o(M,{class:"add-btn",onClick:f=>h(p)},{default:n(()=>[k(v(A(s)("views.user.model.viewModelButton")),1)]),_:2},1032,["onClick"])],64))],64)):D("",!0)])]))),128))])}}},at=Z(nt,[["__scopeId","data-v-a5bdea91"]]),U={componentType:"input",placeholder:"",defaultValue:""},st={componentType:"radio",defaultValue:void 0},dt={componentType:"select",defaultValue:void 0},fe={id:{hidden:!0},model_types:{...st,key:"model_types",label:"模型类型",optionsKey:"supported_type",options:[],disabled:!1,rules:[{required:!0,message:"请选择模型类型",trigger:"change"}]},thinking_type:{componentType:"radio2",defaultValue:"0",key:"thinking_type",label:"深度思考",optionsKey:"thinking_type",options:[{label:"支持（类似deepseek r1这种只支持思考模式的模型）",value:"1"},{label:"可选（比如doubao1.6,可以通过接口控制是否启用深度思考模式）",value:"2"},{label:"不支持（比如deepseek v3,模型本身不支持深度思考模式）",value:"0"}],disabled:!1,rules:[{required:!0,message:"请选择深度思考",trigger:"change"}]},deployment_name:{...U,label:"部署名称",placeholder:"请与Azure 部署名称保持一致",rules:[{required:!0,message:"请输入部署名称",trigger:"change"}]},model_name:{...U,label:"模型名称",placeholder:"模型名称请保持一致",rules:[{required:!0,message:"请输入模型名称",trigger:"change"}]},api_endpoint:{...U,label:"API 域名",placeholder:"请输入您的API 域名",rules:[{required:!0,message:"请输入API 域名",trigger:"change"}]},model_context_length:{...U,label:"模型上下文长度",placeholder:"请输入您的模型上下文长度",rules:[{required:!0,message:"请输入模型上下文长度",trigger:"change"}]},model_uid:{...U,label:"模型UID",placeholder:"请输入您的模型UID",rules:[{required:!0,message:"请输入模型UID",trigger:"change"}]},api_key:{...U,label:"API Key",placeholder:"请输入您的API Key",rules:[{required:!0,message:"请输入API Key",trigger:"change"}]},secret_key:{...U,label:"Secret Key",placeholder:"请输入您的Secret Key",rules:[{required:!0,message:"请输入Secret Key",trigger:"change"}]},api_version:{...dt,label:"API 版本",placeholder:"请输入您的API 版本",optionsKey:"api_versions",options:[],rules:[{required:!0,message:"请选择API 版本",trigger:"change"}]},app_id:{...U,label:"appid",placeholder:"请输入appid",rules:[{required:!0,message:"请输入appid",trigger:"change"}]},region:{...U,label:"region",placeholder:"请输入地区",rules:[{required:!0,message:"请输入地区",trigger:"change"}]}};function it(y,w){if((w=="yiyan"||w=="doubao")&&y=="secret_key")return{...U,label:"Secret Key",placeholder:"请输入您的Secret Key"};if(fe[y])return fe[y];let s={...U};return s.placeholder="请输入您的"+y,s}const ut={columns:[{title:"模型名称",dataIndex:"model_name",key:"model_name",langKey:"views.user.model.model_name"},{title:"模型类型",dataIndex:"model_type",key:"model_type",langKey:"views.user.model.model_type"}],rows:[],showAddBtn:!1},_t={azure:{columns:[{title:"部署名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},ollama:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},openaiAgent:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"API Key",dataIndex:"api_key",key:"api_key",langKey:"views.user.model.api_key"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},xinference:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"服务器地址",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0}},rt=["azure","ollama","xinference","openaiAgent"];function ct(y){if(rt.indexOf(y.model_define)>-1)return y.config_list;{let w=[];return y.llm_model_list||(y.llm_model_list=[]),y.llm_model_list.forEach(s=>{w.push({model_name:s,model_type:"LLM"})}),y.vector_model_list||(y.vector_model_list=[]),y.vector_model_list.forEach(s=>{w.push({model_name:s,model_type:"TEXT EMBEDDING"})}),y.rerank_model_list.forEach(s=>{w.push({model_name:s,model_type:"RERANK"})}),w}}function he(y){let w=["model_define","model_icon_url"],s=_t[y.model_define];return s||(s=ut),w.forEach(c=>{s[c]=y[c]}),s.rows=ct(y),s}const mt={class:"form-wrapper"},pt={class:"model-logo-box"},ft=["src"],vt={key:0,href:"https://www.yuque.com/zhimaxiaoshiwangluo/pggco1/hmwl4gveq4xwa4uw?singleDoc# ",target:"_blank"},yt={class:"form-box"},gt={class:"form-item-label"},kt={key:0},ht={key:1},xt=["href"],bt={__name:"set-model-alert",emits:["ok"],setup(y,{expose:w,emit:s}){const{t:c}=le(),S=s,m=pe.useForm,h=E(""),i=te({model_icon_url:"",model_define:"",model_name:""}),I=E(!1),B=E({}),g=E({}),$=E([]),x=["ollama","xinference","openaiAgent"],H=(T,r)=>{B.value={},g.value={},$.value=[];const{model_icon_url:j,model_define:W,model_name:z,history_config_params:F}=T;let X=T.config_params;h.value=r?c("common.edit")+" "+z:c("common.add")+" "+z,i.model_icon_url=j,i.model_define=W,i.model_name=z;let R={},_={},e=[];X.unshift("id"),r&&F&&F.length>0&&(X=[...X,...F]),X.forEach(a=>{a=="model_type"&&(a="model_types"),x.indexOf(T.model_define)>-1&&a=="deployment_name"&&(a="model_name");let u=it(a,W);u.key=a,u.help_links=T.help_links,u.disabled=!1,u.key=="model_types"&&r&&(u.disabled=!0);let N=u.options;r?(x.indexOf(r.model_define)>-1&&r.deployment_name&&(r.model_name=r.deployment_name),_[a]=r[a]||void 0):_[a]=u.defaultValue,u.optionsKey&&T[u.optionsKey]&&(N=T[u.optionsKey]),u.hidden||e.push({...u,options:N,key:a}),u.rules&&(R[a]=u.rules)}),T.model_define=="doubao"?(r||(_.region="cn-beijing"),e.forEach(a=>{a.key=="deployment_name"&&(a.placeholder="请输入接入点ID")}),R.deployment_name&&R.deployment_name.length&&(R.deployment_name[0].message="请输入接入点ID")):R.deployment_name&&R.deployment_name.length&&(R.deployment_name[0].message="请输入部署名称"),B.value=R,g.value=_,$.value=e,I.value=!0,setTimeout(()=>{p()},100)},{resetFields:M,clearValidate:p,validate:f,validateInfos:q}=m(g,B),J=()=>{f().then(()=>{g.value.id?Y():O()}).catch(T=>{})},Q=()=>{M(),p()},L=E(!1),O=()=>{let T=G(g.value),r=JSON.parse(JSON.stringify(T));r.model_type=r.model_types,r.model_define=i.model_define,x.indexOf(r.model_define)>-1&&r.model_name&&(r.deployment_name=r.model_name,delete r.model_name),L.value=!0,we(r).then(()=>{L.value=!1,I.value=!1,se.success(c("common.saveSuccess")),S("ok")}).catch(()=>{L.value=!1})},Y=()=>{let T=G(g.value),r=JSON.parse(JSON.stringify(T));r.model_type=r.model_types,r.model_define=i.model_define,x.indexOf(r.model_define)>-1&&r.model_name&&(r.deployment_name=r.model_name,delete r.model_name),L.value=!0,be(r).then(()=>{L.value=!1,I.value=!1,se.success(c("common.saveSuccess")),S("ok")}).catch(()=>{L.value=!1})};return w({open:H}),(T,r)=>{const j=Ne,W=Re,z=ye,F=ve,X=Oe,R=Le,_=pe,e=oe;return l(),K(e,{class:"add-model-alert",width:"650px",open:I.value,"onUpdate:open":r[0]||(r[0]=a=>I.value=a),title:h.value,confirmLoading:L.value,onOk:J,onCancel:Q,maskClosable:!1},{default:n(()=>[t("div",mt,[t("div",pt,[t("img",{class:"model-logo",src:i.model_icon_url,alt:""},null,8,ft),i.model_define=="doubao"?(l(),d("a",vt,"查看使用说明>")):D("",!0)]),t("div",yt,[o(_,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:n(()=>[(l(!0),d(C,null,V($.value,a=>(l(),d(C,{key:a.key},[a.hidden?D("",!0):(l(),K(R,De({key:0,ref_for:!0},A(q)[a.key]),{label:n(()=>[t("div",gt,[i.model_define=="doubao"&&a.key=="deployment_name"?(l(),d("span",kt,"接入点ID")):(l(),d("span",ht,v(A(c)("views.user.model."+a.key)),1))])]),default:n(()=>[a.componentType=="radio"?(l(),K(W,{key:0,value:g.value[a.key],"onUpdate:value":u=>g.value[a.key]=u,disabled:a.disabled},{default:n(()=>[(l(!0),d(C,null,V(a.options,(u,N)=>(l(),K(j,{value:u,key:N},{default:n(()=>[t("span",null,v(u),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):D("",!0),a.componentType=="radio2"?(l(),K(W,{key:1,value:g.value[a.key],"onUpdate:value":u=>g.value[a.key]=u,disabled:a.disabled},{default:n(()=>[(l(!0),d(C,null,V(a.options,(u,N)=>(l(),K(j,{style:{"line-height":"32px"},value:u.value,key:u.value},{default:n(()=>[t("span",null,v(u.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):D("",!0),a.componentType=="select"?(l(),K(F,{key:2,value:g.value[a.key],"onUpdate:value":u=>g.value[a.key]=u,placeholder:a.placeholder},{default:n(()=>[(l(!0),d(C,null,V(a.options,(u,N)=>(l(),K(z,{value:u,key:N},{default:n(()=>[t("span",null,v(u),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):D("",!0),a.componentType=="input"?(l(),d(C,{key:3},[o(X,{value:g.value[a.key],"onUpdate:value":u=>g.value[a.key]=u,placeholder:a.placeholder},null,8,["value","onUpdate:value","placeholder"]),a.key=="api_key"?(l(),d("a",{key:0,href:a.help_links,target:"_blank"},v(A(c)("views.user.model.getApikeyText")),9,xt)):D("",!0)],64)):D("",!0)]),_:2},1040))],64))),128))]),_:1})])])]),_:1},8,["open","title","confirmLoading"])}}},wt=Z(bt,[["__scopeId","data-v-d7fcdeb0"]]),Ct={class:"form-wrapper"},It={class:"tools-wrapper"},Mt=["src"],At={class:"tools-box"},$t={class:"list-box"},Tt=["onClick"],Kt=["onClick"],Dt={__name:"see-model-alert",emits:["new","edit","remove"],setup(y,{expose:w,emit:s}){const{t:c}=le(),S=s,m=E(!1),h=["ollama","xinference","openaiAgent"],i=te({model_icon_url:"",model_define:"",columns:[],rows:[],showAddBtn:!1});let I=Ee({});const B=M=>{I=M;let p=he(M);for(let f in p)i[f]=p[f];m.value=!0},g=()=>{m.value=!1,S("new",{...I})},$=M=>{m.value=!1,S("edit",{...I},G(M))},x=M=>{m.value=!1,S("remove",G(M))},H=()=>{};return w({open:B}),(M,p)=>{const f=ie,q=Pe,J=ue,Q=_e,L=oe;return l(),K(L,{class:"add-model-alert",width:"800px",open:m.value,"onUpdate:open":p[0]||(p[0]=O=>m.value=O),title:A(c)("views.user.model.modelConfigButton"),footer:null,onOk:H},{default:n(()=>[t("div",Ct,[t("div",It,[t("img",{class:"model-logo",src:i.model_icon_url,alt:""},null,8,Mt),t("div",At,[i.showAddBtn?(l(),K(f,{key:0,type:"primary",onClick:g},{default:n(()=>[k(v(A(c)("views.user.model.addModel")),1)]),_:1})):D("",!0)])]),t("div",$t,[o(Q,{"data-source":i.rows,scroll:{y:400},pagination:!1},{default:n(()=>[(l(!0),d(C,null,V(i.columns,O=>(l(),d(C,{key:O.key},[O.key=="action"?(l(),K(J,{key:0,title:A(c)("common.action"),"data-index":O.key,width:"140px"},{default:n(({record:Y})=>[t("span",null,[t("a",{onClick:T=>$(Y)},v(A(c)("common.edit")),9,Tt),o(q,{type:"vertical"}),t("a",{onClick:T=>x(Y)},v(A(c)("common.remove")),9,Kt)])]),_:2},1032,["title","data-index"])):(l(),K(J,{key:1,title:A(c)("views.user.model."+(h.indexOf(i.model_define)>-1&&O.key=="deployment_name"?"model_name":O.key)),"data-index":O.key},null,8,["title","data-index"]))],64))),128))]),_:1},8,["data-source"])])])]),_:1},8,["open","title"])}}},Et=Z(Dt,[["__scopeId","data-v-cb6626b7"]]),St={__name:"buy-record",props:{list:{type:Array,default:()=>[]}},setup(y,{expose:w}){const s=E(!1),c=m=>m<=0?"--":ge(m*1e3).format("YYYY/MM/DD HH:mm:ss");return w({show:()=>{s.value=!0}}),(m,h)=>{const i=ue,I=_e,B=oe;return l(),d("div",null,[o(B,{open:s.value,"onUpdate:open":h[0]||(h[0]=g=>s.value=g),title:"购买记录",footer:null,width:896},{default:n(()=>[o(I,{style:{"margin-top":"16px"},"data-source":y.list},{default:n(()=>[o(i,{key:"create_time",title:"购买时间","data-index":"create_time"},{default:n(({record:g})=>[k(v(c(g.create_time)),1)]),_:1}),o(i,{key:"buy_total",title:"购买积分数","data-index":"buy_total"}),o(i,{key:"use_total",title:"已消耗","data-index":"use_total"}),o(i,{key:"expire_total",title:"已过期","data-index":"expire_total"}),o(i,{key:"surplus_total",title:"剩余额度","data-index":"surplus_total"}),o(i,{key:"expire_time",title:"到期时间","data-index":"expire_time"},{default:n(({record:g})=>[k(v(c(g.expire_time)),1)]),_:1}),o(i,{key:"remark_outer",title:"备注","data-index":"remark_outer"})]),_:1},8,["data-source"])]),_:1},8,["open"])])}}},Bt={class:"modal-box"},Lt={__name:"kefu-modal",setup(y,{expose:w}){const s=E(!1);return w({show:()=>{s.value=!0}}),(S,m)=>{const h=ke,i=oe;return l(),d("div",null,[o(i,{open:s.value,"onUpdate:open":m[0]||(m[0]=I=>s.value=I),title:"购买资源包",footer:null,width:546},{default:n(()=>[t("div",Bt,[o(h,{"show-icon":"",message:"暂不支持线上购买，请扫码联系客服购买"}),m[1]||(m[1]=t("div",{class:"img-box"},[t("img",{src:"https://xkf-upload-oss.xiaokefu.com.cn/static/kefu.png",alt:""})],-1))])]),_:1},8,["open"])])}}},Rt=Z(Lt,[["__scopeId","data-v-7c6c634f"]]),Nt={class:"user-model-page"},Ot={class:"list-wrapper"},Pt={key:0,class:"alert-content-box"},Ut={key:1,class:"content-body-box"},qt={class:"model-group-box"},zt=["onClick"],Vt=["src"],Ft={class:"model-name"},Gt={class:"model-content-box"},Yt={class:"statics-block"},Xt={class:"statics-item"},Ht={class:"num"},Jt={class:"statics-item"},jt={class:"num"},Wt={class:"statics-item"},Qt={class:"num"},Zt={class:"btn-block"},el={class:"search-block"},tl={class:"search-item"},ll={class:"search-item"},ol={class:"list-box"},nl={class:"opration-block"},al={class:"list-box"},sl=["onClick"],dl=["onClick"],il={class:"aleat-box"},ul={class:"alert-description"},_l={key:0,class:"text"},rl={class:"btn-box"},cl={class:"list-box"},ml={key:0},pl={key:1},fl={__name:"index",setup(y){const{t:w}=le(),s=E(1),c=()=>{},S=E([]),m=E([]),h=E(""),i=te({all_surplus:0,all_use:0,min_expiretime:"",list:[]}),I=te({model_supplier:void 0,model_type:void 0}),B=()=>{Ae().then(_=>{i.all_surplus=_.data.all_surplus,i.all_use=_.data.all_use,i.list=_.data.list||[],i.min_expiretime=_.data.min_expiretime>0?ge(_.data.min_expiretime*1e3).format("YYYY-MM-DD"):"--"})},g=E(null),$=E(null),x=()=>{B(),$.value.show()};let H={tongyi:"通义千问",deepseek:"DeepSeek",doubao:"豆包"},M={LLM:"大语言模型","TEXT EMBEDDING":"嵌入模型",RERANK:"重排序模型"};const p=()=>{Me({...I}).then(_=>{if(!_.data){m.value=[];return}m.value=_.data.map(e=>({...e,model_supplier_desc:H[e.model_supplier],model_type_desc:M[e.model_type]}))})},f=ae(()=>S.value.filter(_=>_.model_define==h.value)[0]||{}),q=te({columns:[],rows:[]}),J=_=>{h.value=_.model_define,setTimeout(()=>{Q()},50)},Q=()=>{let _=he(f.value);for(let e in _)q[e]=_[e]},L=ae(()=>S.value.filter(_=>_.listType==1));Se(()=>L,()=>{L.value.filter(_=>_.model_define==h.value).length==0&&(h.value=L.value[0].model_define,J(L.value[0]))},{deep:!0});const O=ae(()=>S.value),Y=()=>{Ce().then(_=>{let e=_.data||[];e.forEach(a=>{a.listType=a.config_list.length>0?1:0}),e.sort((a,u)=>a.listType-u.listType),S.value=e})};Y();const T=E(null),r=_=>{T.value.open(_)},j=_=>{z.value.open(_)},W=_=>{z.value.open(_)},z=E(null),F=(_,e)=>{z.value.open(_,e)},X=()=>{Y()},R=_=>{oe.confirm({title:w("views.user.model.deleteModel"),icon:o(Ve),content:w("views.user.model.deleteModelContent"),onOk(){Ie({id:_.id}).then(()=>{se.success(w("common.deleteSuccessful")),Y()})}})};return(_,e)=>{const a=ke,u=ie,N=ye,re=ve,P=ue,ne=_e,xe=qe;return l(),d(C,null,[t("div",Nt,[o(Xe,{value:s.value,"onUpdate:value":e[0]||(e[0]=b=>s.value=b),onChange:c},null,8,["value"]),t("div",Ot,[s.value==0?(l(),d("div",Pt,[o(a,{"show-icon":""},{message:n(()=>e[7]||(e[7]=[t("div",{class:"title"},"使用说明",-1),t("div",null," 1、模型主要分为嵌入模型（TEXT EMBEDDING）和大模型（LLM），嵌入模型用于将上传知识库的文本内容进行向量化便于后续检索，大模型用于将检索到的相关知识进行理解后返回答案。 ",-1),t("div",null,"2、配置模型时尽量选择同时支持LLM和TEXT EMBEDDING的模型，否则要配置多个模型。",-1),t("div",null," 3、国内模型厂商一般都需要认证后才可使用，所以在配置模型前，确保在模型服务厂商那里已认证，否则配置模型时会提示配置参数错误。 ",-1)])),_:1})])):D("",!0),s.value==1?(l(),d("div",Ut,[t("div",qt,[(l(!0),d(C,null,V(L.value,b=>(l(),d("div",{class:de(["model-list-item",{active:b.model_define==h.value}]),onClick:ee=>J(b),key:b.model_define},[t("img",{class:"avatar",src:b.model_icon_url,alt:""},null,8,Vt),t("div",Ft,v(b.model_name),1)],10,zt))),128))]),t("div",Gt,[h.value=="chatwiki"?(l(),d(C,{key:0},[t("div",Yt,[t("div",Xt,[e[8]||(e[8]=t("div",{class:"title"},"剩余积分",-1)),t("div",Ht,v(A(me)(i.all_surplus)),1)]),t("div",Jt,[e[9]||(e[9]=t("div",{class:"title"},"累计已使用",-1)),t("div",jt,v(A(me)(i.all_use)),1)]),t("div",Wt,[e[10]||(e[10]=t("div",{class:"title"},"最近过期时间",-1)),t("div",Qt,v(i.min_expiretime),1)]),t("div",Zt,[o(u,{type:"primary",onClick:e[1]||(e[1]=b=>g.value.show()),block:""},{default:n(()=>e[11]||(e[11]=[k("购买资源包")])),_:1,__:[11]}),o(u,{onClick:x,block:""},{default:n(()=>e[12]||(e[12]=[k("购买记录")])),_:1,__:[12]})])]),t("div",el,[t("div",tl,[e[16]||(e[16]=t("span",null,"模型供应商：",-1)),o(re,{allowClear:"",onChange:p,value:I.model_supplier,"onUpdate:value":e[2]||(e[2]=b=>I.model_supplier=b),placeholder:"请选择模型供应商",style:{width:"172px"}},{default:n(()=>[o(N,{value:"tongyi"},{default:n(()=>e[13]||(e[13]=[k("通义千问")])),_:1,__:[13]}),o(N,{value:"deepseek"},{default:n(()=>e[14]||(e[14]=[k("DeepSeek")])),_:1,__:[14]}),o(N,{value:"doubao"},{default:n(()=>e[15]||(e[15]=[k("豆包")])),_:1,__:[15]})]),_:1},8,["value"])]),t("div",ll,[e[19]||(e[19]=t("span",null,"模型类型：",-1)),o(re,{allowClear:"",onChange:p,value:I.model_type,"onUpdate:value":e[3]||(e[3]=b=>I.model_type=b),placeholder:"请选择模型类型",style:{width:"172px"}},{default:n(()=>[o(N,{value:"LLM"},{default:n(()=>e[17]||(e[17]=[k("大语言模型")])),_:1,__:[17]}),o(N,{value:"TEXT EMBEDDING"},{default:n(()=>e[18]||(e[18]=[k("嵌入模型")])),_:1,__:[18]})]),_:1},8,["value"])])]),t("div",ol,[o(ne,{"data-source":m.value},{default:n(()=>[o(P,{key:"uni_model_name",title:"模型","data-index":"uni_model_name"}),o(P,{key:"model_supplier_desc",title:"模型服务商","data-index":"model_supplier_desc"}),o(P,{key:"model_type_desc",title:"模型类型","data-index":"model_type_desc"}),o(P,{key:"price",title:"价格","data-index":"price"},{default:n(({record:b})=>[k(v(b.price)+"积分/千Token",1)]),_:1})]),_:1},8,["data-source"])])],64)):(l(),d(C,{key:1},[["xinference","azure","doubao","openaiAgent","ollama"].includes(h.value)?(l(),d(C,{key:0},[t("div",nl,[o(u,{type:"primary",onClick:e[4]||(e[4]=b=>j(f.value))},{default:n(()=>[o(A(Ue)),e[20]||(e[20]=k("添加模型"))]),_:1,__:[20]})]),t("div",al,[o(ne,{pagination:!1,"data-source":f.value.config_list},{default:n(()=>[o(P,{key:"deployment_name","data-index":"deployment_name"},{title:n(()=>[h.value=="doubao"?(l(),d(C,{key:0},[k("接入点ID")],64)):(l(),d(C,{key:1},[k("模型名称")],64))]),_:1}),h.value=="doubao"?(l(),K(P,{key:"show_model_name",title:"模型名称","data-index":"show_model_name"})):D("",!0),o(P,{key:"model_types",title:"模型类型","data-index":"model_types"},{default:n(({record:b,text:ee})=>[k(v(A(M)[ee]),1)]),_:1}),h.value=="azure"?(l(),K(P,{key:"api_version",title:"API版本","data-index":"api_version"})):D("",!0),["openaiAgent","ollama"].includes(h.value)?(l(),K(P,{key:"api_endpoint",title:"API 域名","data-index":"api_endpoint"})):D("",!0),o(P,{width:120,key:"action",title:"操作"},{default:n(({record:b})=>[o(xe,{gap:16},{default:n(()=>[t("a",{onClick:ee=>F(f.value,b)},"编辑",8,sl),t("a",{onClick:ee=>R(b)},"移除",8,dl)]),_:2},1024)]),_:1})]),_:1},8,["data-source"])])],64)):(l(),d(C,{key:1},[t("div",il,[o(a,null,{message:n(()=>[t("div",ul,[f.value.config_list&&f.value.config_list.length?(l(),d("div",_l,[o(A(ze)),k(" API Key："+v(f.value.config_list[0].api_key.slice(0,10)+"..."),1)])):D("",!0),t("div",rl,[o(u,{onClick:e[5]||(e[5]=b=>F(f.value,f.value.config_list[0])),size:"small"},{default:n(()=>e[21]||(e[21]=[k("修改配置")])),_:1,__:[21]}),o(u,{size:"small",onClick:e[6]||(e[6]=b=>R(f.value.config_list[0]))},{default:n(()=>e[22]||(e[22]=[k("移除配置")])),_:1,__:[22]})])])]),_:1})]),t("div",{class:"message-total-tip",onClick:Q}," 支持的模型（"+v(q.rows.length)+"） ",1),t("div",cl,[o(ne,{pagination:!1,"data-source":q.rows},{default:n(()=>[(l(!0),d(C,null,V(q.columns,b=>(l(),K(P,{key:b.key,title:b.title,"data-index":b.dataIndex},{default:n(({record:ee,text:ce})=>[b.key=="model_type"?(l(),d("div",ml,v(A(M)[ce]),1)):(l(),d("div",pl,v(ce),1))]),_:2},1032,["title","data-index"]))),128))]),_:1},8,["data-source"])])],64))],64))])])):D("",!0),s.value==0?(l(),K(at,{list:O.value,type:2,key:"canAddModelList",onAdd:W,onSee:r},null,8,["list"])):D("",!0)])]),o(Et,{ref_key:"seeModelAlertRef",ref:T,onNew:j,onEdit:F,onRemove:R},null,512),o(wt,{ref_key:"setModelAlertRef",ref:z,onOk:X},null,512),o(St,{list:i.list,ref_key:"buyRecordRef",ref:$},null,8,["list"]),o(Rt,{ref_key:"kefuModalRef",ref:g},null,512)],64)}}},xl=Z(fl,[["__scopeId","data-v-ddda2f97"]]);export{xl as default};
