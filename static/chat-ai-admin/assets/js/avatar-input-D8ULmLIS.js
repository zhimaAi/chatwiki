import{_ as L}from"../../index-WMhSApoa.js";import{F as U,a5 as B,a6 as M,u as N,M as V,b as _}from"./ui-antd-BDReVt-O.js";import{f as s,w as A,ac as w,ad as o,az as J,k as h,ar as x,as as d,ae as y,u as b}from"./vue-chunks-CGLjTDrY.js";const z={class:"avatar-uploader"},G=["src"],R=["src"],D={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(r,{emit:k}){function v(e){return new Promise((t,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=p=>n(p)})}const m=k,C=r,l=s([]),g=s(!1),u=s("");A(()=>C.value,e=>{u.value=e},{immediate:!0});const P=U.useInjectFormItemContext(),F=()=>{let e={imageUrl:u.value,file:l.value[0].originFileObj};m("change",e),m("update:value",e.imageUrl),P.onFieldChange()},I=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size/1024<100?(l.value=[e],v(e).then(a=>{u.value=a,g.value=!1,F()}),!1):(_.error("知识库封面图片大小不能超过100kb"),!1):(_.error("知识库封面只支持JPG、PNG格式的图片"),!1),i=s(!1),f=s(""),c=s(""),O=()=>{i.value=!1,c.value=""},j=async e=>{!e.url&&!e.preview&&(e.preview=await v(e.originFileObj)),f.value=e.url||e.preview,i.value=!0,c.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)};return(e,t)=>{const n=N,a=V;return o(),w("div",z,[r.value?(o(),w("img",{key:0,class:"avatar",src:r.value,alt:"avatar"},null,8,G)):J("",!0),h(n,{class:"upload-upload","file-list":l.value,"onUpdate:fileList":t[0]||(t[0]=p=>l.value=p),"list-type":"picture-card","show-upload-list":!1,"before-upload":I,accept:".jpg,.png,.jpeg",onPreview:j},{default:x(()=>[d("div",null,[g.value?(o(),y(b(B),{key:0})):(o(),y(b(M),{key:1})),t[1]||(t[1]=d("div",{class:"ant-upload-text"},"上传照片",-1))])]),_:1},8,["file-list"]),h(a,{open:i.value,title:c.value,footer:null,onCancel:O},{default:x(()=>[d("img",{alt:"example",style:{width:"100%"},src:f.value},null,8,R)]),_:1},8,["open","title"])])}}},q=L(D,[["__scopeId","data-v-a110f5ac"]]);export{q as A};
