import{b as Z,f as ue,m as ge}from"../../index-ZzVqUZIR.js";import{e as Se,a as ze,s as Ge,g as Ke,b as Oe,c as qe,d as Be,f as Pe,h as Xe}from"./index-CkBKI6U4.js";import{f as E,Y as m,_ as l,F as K,a9 as W,ad as he,a7 as L,u as Q,a5 as a,k as n,ai as je,a2 as o,G as u,a1 as c,ae as d,J as se,r as de,a4 as Ve,e as F,ab as Fe,w as Je,o as Ye}from"./vue-chunks-yZ4gwLzA.js";import{p as He,B as ce,F as re,e as xe,q as be,R as Me,u as we,v as Ee,I as $e,M as ne,a as ie,w as _e,x as pe,d as Ie,k as Ae,K as We,y as Le,z as Qe,E as Ze,G as et,H as tt,J as ot,N as lt,O as ye}from"./ui-antd-BJtyvQX6.js";import{g as Ce}from"./util-B9XhpafE.js";import"./utils-smNh_pj2.js";import"./thirdMcp-gvqL04Y3.js";import"./index-CqPQTDjX.js";const nt={class:"page-tabs"},at=["onClick"],it={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(U,{emit:T}){const{t:b}=ue(),g=T,S=U,I=E([{value:1,title:b("views.user.model.modelsHaveBeenAdded"),langKey:"views.user.model.modelsHaveBeenAdded"},{value:0,title:b("views.user.model.canAddAModel"),langKey:"views.user.model.canAddAModel"}]),$=e=>{g("update:value",e),g("change",e)};return(e,s)=>(l(),m("div",nt,[(l(!0),m(K,null,W(I.value,M=>(l(),m("div",{class:he(["tab-item",{active:S.value==M.value}]),onClick:y=>$(M.value),key:M.value},L(Q(b)(M.langKey)),11,at))),128))]))}},st=Z(it,[["__scopeId","data-v-cc65f89a"]]),dt={class:"model-list"},ut={class:"model-item-left"},_t={class:"model-item-left-top"},pt=["src"],mt={class:"model-name"},rt={class:"model-tags"},ct={class:"tag"},ft={class:"model-item-left-bottom"},vt={class:"model-desc"},gt={class:"model-item-right"},yt={__name:"model-list",props:{type:{type:Number,default:()=>1},list:{type:Array,default:()=>[]}},emits:["edit","new","see","remove","add"],setup(U,{emit:T}){const{t:b}=ue(),g=T,S=U,I=e=>{g("see",se(e))},$=e=>{g("add",se(e))};return(e,s)=>{const M=He,y=ce;return l(),m("div",dt,[(l(!0),m(K,null,W(S.list,R=>(l(),m("div",{class:"model-item",key:R.model_define},[a("div",ut,[a("div",_t,[a("img",{class:"model-logo",src:R.model_icon_url,alt:""},null,8,pt),a("div",mt,L(R.model_name),1),s[6]||(s[6]=a("div",{class:"line"},null,-1)),a("div",rt,[(l(!0),m(K,null,W(R.support_list,(C,X)=>(l(),m("div",{key:X},[n(M,null,je({default:o(()=>[a("span",ct,L(C),1)]),_:2},[C=="LLM"?{name:"title",fn:o(()=>[s[0]||(s[0]=u("大语言模型，添加机器人时需要选择一个大语言模型。用户的提问将交由大语言模型，结合知识库给出答案。",-1))]),key:"0"}:C=="TEXT EMBEDDING"?{name:"title",fn:o(()=>[s[1]||(s[1]=u("嵌入模型，添加知识库时需要选择嵌入模型，用于将知识库分段向量化。用户提问时也会将问题生成向量，通过比对向量相似度的方式四配跟提问语义相近的知识库分段。向量检索具备很好的语义分析能力。",-1))]),key:"1"}:C=="RERANK"?{name:"title",fn:o(()=>[s[2]||(s[2]=u("重排序模型,通过重排序模型,将从知识库中检索出来的分段进行重新排序。再将重排序的结果前top-K传递个大语言模型生成答案。重排序有助于优化检索结果，提高大语言模型回答的准确性。",-1))]),key:"2"}:C=="SPEECH2TEXT"?{name:"title",fn:o(()=>[s[3]||(s[3]=u("一种用于将音视频中的语音转化为文字的技术解决方案",-1))]),key:"3"}:C=="TTS"?{name:"title",fn:o(()=>[s[4]||(s[4]=u("语音合成模型",-1))]),key:"4"}:C=="IMAGE"?{name:"title",fn:o(()=>[s[5]||(s[5]=u("图像生成模型",-1))]),key:"5"}:void 0]),1024)]))),128))])]),a("div",ft,[a("div",vt,L(R.introduce),1)])]),a("div",gt,[R.model_define!="azure"?(l(),c(y,{key:0,class:"add-btn",onClick:C=>I(R)},{default:o(()=>[...s[7]||(s[7]=[u("查看模型",-1)])]),_:1},8,["onClick"])):d("",!0),n(y,{class:"add-btn",onClick:C=>$(R)},{default:o(()=>[...s[8]||(s[8]=[u("添加配置",-1)])]),_:1},8,["onClick"])])]))),128))])}}},kt=Z(yt,[["__scopeId","data-v-a182c6d6"]]),P={componentType:"input",placeholder:"",defaultValue:""},ht={componentType:"radio",defaultValue:void 0},xt={componentType:"select",defaultValue:void 0},ke={id:{hidden:!0},config_name:{...P,label:"配置名称",placeholder:"请输入配置的别名，仅用作展示",rules:[{required:!0,message:"请输入配置名称",trigger:"change"}]},model_types:{...ht,key:"model_types",label:"模型类型",optionsKey:"supported_type",options:[],disabled:!1,rules:[{required:!0,message:"请选择模型类型",trigger:"change"}]},thinking_type:{componentType:"radio2",defaultValue:"0",key:"thinking_type",label:"深度思考",optionsKey:"thinking_type",options:[{label:"支持（类似deepseek r1这种只支持思考模式的模型）",value:"1"},{label:"可选（比如doubao1.6,可以通过接口控制是否启用深度思考模式）",value:"2"},{label:"不支持（比如deepseek v3,模型本身不支持深度思考模式）",value:"0"}],disabled:!1,rules:[{required:!0,message:"请选择深度思考",trigger:"change"}]},deployment_name:{...P,label:"部署名称",placeholder:"请与Azure 部署名称保持一致",rules:[{required:!0,message:"请输入部署名称",trigger:"change"}]},model_name:{...P,label:"模型名称",placeholder:"模型名称请保持一致",rules:[{required:!0,message:"请输入模型名称",trigger:"change"}]},api_endpoint:{...P,label:"API 域名",placeholder:"请输入您的API 域名",rules:[{required:!0,message:"请输入API 域名",trigger:"change"}]},model_context_length:{...P,label:"模型上下文长度",placeholder:"请输入您的模型上下文长度",rules:[{required:!0,message:"请输入模型上下文长度",trigger:"change"}]},model_uid:{...P,label:"模型UID",placeholder:"请输入您的模型UID",rules:[{required:!0,message:"请输入模型UID",trigger:"change"}]},api_key:{...P,label:"API Key",placeholder:"请输入您的API Key",rules:[{required:!0,message:"请输入API Key",trigger:"change"}]},secret_key:{...P,label:"Secret Key",placeholder:"请输入您的Secret Key",rules:[{required:!0,message:"请输入Secret Key",trigger:"change"}]},api_version:{...xt,label:"API 版本",placeholder:"请输入您的API 版本",optionsKey:"api_versions",options:[],rules:[{required:!0,message:"请选择API 版本",trigger:"change"}]},app_id:{...P,label:"appid",placeholder:"请输入appid",rules:[{required:!0,message:"请输入appid",trigger:"change"}]},region:{...P,label:"region",placeholder:"请输入地区",rules:[{required:!0,message:"请输入地区",trigger:"change"}]}};function bt(U,T){if((T=="yiyan"||T=="doubao")&&U=="secret_key")return{...P,label:"Secret Key",placeholder:"请输入您的Secret Key"};if(ke[U])return ke[U];let b={...P};return b.placeholder="请输入您的"+U,b}const Mt={class:"form-wrapper"},wt={class:"model-logo-box"},Et=["src"],$t={key:0,href:"https://www.yuque.com/zhimaxiaoshiwangluo/pggco1/hmwl4gveq4xwa4uw?singleDoc# ",target:"_blank"},It={class:"form-box"},At={class:"form-item-label"},Lt={key:0},Ct={key:1},Dt=["href"],Tt={__name:"set-model-alert",emits:["ok"],setup(U,{expose:T,emit:b}){const{t:g}=ue(),S=b,I=re.useForm,$=E(""),e=de({model_icon_url:"",model_define:"",model_name:""}),s=E(!1),M=E({}),y=E({}),R=E([]),C=["ollama","xinference","openaiAgent"],X=(A,_)=>{M.value={},y.value={},R.value=[];const{model_icon_url:f,model_define:q,model_name:N,history_config_params:B}=A;let z=A.config_params;$.value=_?g("common.edit")+" "+N:g("common.add")+" "+N,e.model_icon_url=f,e.model_define=q,e.model_name=N;let G={},i={},oe=[];z.unshift("id"),z.includes("config_name")||z.unshift("config_name"),_&&B&&B.length>0&&(z=[...z,...B]),z.forEach(r=>{r=="model_type"&&(r="model_types"),C.indexOf(A.model_define)>-1&&r=="deployment_name"&&(r="model_name");let k=bt(r,q);k.key=r,k.help_links=A.help_links,k.disabled=!1,k.key=="model_types"&&_&&(k.disabled=!0);let j=k.options;_?(C.indexOf(_.model_define)>-1&&_.deployment_name&&(_.model_name=_.deployment_name),i[r]=_[r]||void 0):i[r]=k.defaultValue,k.optionsKey&&A[k.optionsKey]&&(j=A[k.optionsKey]),k.hidden||oe.push({...k,options:j,key:r}),k.rules&&(G[r]=k.rules)}),A.model_define=="doubao"?(_||(i.region="cn-beijing"),oe.forEach(r=>{r.key=="deployment_name"&&(r.placeholder="请输入接入点ID")}),G.deployment_name&&G.deployment_name.length&&(G.deployment_name[0].message="请输入接入点ID")):G.deployment_name&&G.deployment_name.length&&(G.deployment_name[0].message="请输入部署名称"),i.config_name||(i.config_name=A.model_name),M.value=G,y.value=i,R.value=oe,s.value=!0,setTimeout(()=>{V()},100)},{resetFields:J,clearValidate:V,validate:ee,validateInfos:te}=I(y,M),w=()=>{ee().then(()=>{y.value.id?x():O()}).catch(A=>{})},t=()=>{J(),V()},h=E(!1),O=()=>{let A=se(y.value),_=JSON.parse(JSON.stringify(A));_.model_type=_.model_types,_.model_define=e.model_define,C.indexOf(_.model_define)>-1&&_.model_name&&(_.deployment_name=_.model_name,delete _.model_name),h.value=!0,ze(_).then(f=>{h.value=!1,s.value=!1,ie.success(g("common.saveSuccess")),S("ok",f.data)}).catch(()=>{h.value=!1})},x=()=>{let A=se(y.value),_=JSON.parse(JSON.stringify(A));_.model_type=_.model_types,_.model_define=e.model_define,C.indexOf(_.model_define)>-1&&_.model_name&&(_.deployment_name=_.model_name,delete _.model_name),h.value=!0,Se(_).then(()=>{h.value=!1,s.value=!1,ie.success(g("common.saveSuccess")),S("ok")}).catch(()=>{h.value=!1})};return T({open:X}),(A,_)=>{const f=Me,q=be,N=Ee,B=we,z=$e,G=xe,i=re,oe=ne;return l(),c(oe,{class:"add-model-alert",width:"650px",open:s.value,"onUpdate:open":_[0]||(_[0]=r=>s.value=r),title:$.value,confirmLoading:h.value,onOk:w,onCancel:t,maskClosable:!1},{default:o(()=>[a("div",Mt,[a("div",wt,[a("img",{class:"model-logo",src:e.model_icon_url,alt:""},null,8,Et),e.model_define=="doubao"?(l(),m("a",$t,"查看使用说明>")):d("",!0)]),a("div",It,[n(i,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:o(()=>[(l(!0),m(K,null,W(R.value,r=>(l(),m(K,{key:r.key},[r.hidden?d("",!0):(l(),c(G,Ve({key:0,ref_for:!0},Q(te)[r.key]),{label:o(()=>[a("div",At,[e.model_define=="doubao"&&r.key=="deployment_name"?(l(),m("span",Lt,"接入点ID")):(l(),m("span",Ct,L(Q(g)("views.user.model."+r.key)),1))])]),default:o(()=>[r.componentType=="radio"?(l(),c(q,{key:0,value:y.value[r.key],"onUpdate:value":k=>y.value[r.key]=k,disabled:r.disabled},{default:o(()=>[(l(!0),m(K,null,W(r.options,(k,j)=>(l(),c(f,{value:k,key:j},{default:o(()=>[a("span",null,L(k),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):d("",!0),r.componentType=="radio2"?(l(),c(q,{key:1,value:y.value[r.key],"onUpdate:value":k=>y.value[r.key]=k,disabled:r.disabled},{default:o(()=>[(l(!0),m(K,null,W(r.options,(k,j)=>(l(),c(f,{style:{"line-height":"32px"},value:k.value,key:k.value},{default:o(()=>[a("span",null,L(k.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):d("",!0),r.componentType=="select"?(l(),c(B,{key:2,value:y.value[r.key],"onUpdate:value":k=>y.value[r.key]=k,placeholder:r.placeholder},{default:o(()=>[(l(!0),m(K,null,W(r.options,(k,j)=>(l(),c(N,{value:k,key:j},{default:o(()=>[a("span",null,L(k),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):d("",!0),r.componentType=="input"?(l(),m(K,{key:3},[n(z,{value:y.value[r.key],"onUpdate:value":k=>y.value[r.key]=k,placeholder:r.placeholder},null,8,["value","onUpdate:value","placeholder"]),r.key=="api_key"?(l(),m("a",{key:0,href:r.help_links,target:"_blank"},L(Q(g)("views.user.model.getApikeyText")),9,Dt)):d("",!0)],64)):d("",!0)]),_:2},1040))],64))),128))]),_:1})])])]),_:1},8,["open","title","confirmLoading"])}}},Rt=Z(Tt,[["__scopeId","data-v-2842f309"]]),Nt={class:"form-wrapper"},Ut={class:"tools-wrapper"},St=["src"],zt={__name:"see-model-alert",setup(U,{expose:T}){const b=E({}),g=E(!1),S=E([]);return T({open:$=>{b.value=$,S.value=$.use_model_configs||[],g.value=!0}}),($,e)=>{const s=_e,M=pe,y=ne;return l(),c(y,{class:"add-model-alert",width:"800px",open:g.value,"onUpdate:open":e[0]||(e[0]=R=>g.value=R),title:"模型列表",footer:null},{default:o(()=>[a("div",Nt,[a("div",Ut,[a("img",{class:"model-logo",src:b.value.model_icon_url,alt:""},null,8,St),a("span",null,L(b.value.model_name),1)]),n(M,{"data-source":S.value,pagination:!1,scroll:{y:500}},{default:o(()=>[n(s,{key:"show_model_name",title:"模型名称","data-index":"show_model_name"}),n(s,{key:"model_type",title:"模型类型","data-index":"model_type"})]),_:1},8,["data-source"])])]),_:1},8,["open"])}}},Gt=Z(zt,[["__scopeId","data-v-10aa3df5"]]),Kt={__name:"buy-record",props:{list:{type:Array,default:()=>[]}},setup(U,{expose:T}){const b=E(!1),g=I=>I<=0?"--":Ie(I*1e3).format("YYYY/MM/DD HH:mm:ss");return T({show:()=>{b.value=!0}}),(I,$)=>{const e=_e,s=pe,M=ne;return l(),m("div",null,[n(M,{open:b.value,"onUpdate:open":$[0]||($[0]=y=>b.value=y),title:"购买记录",footer:null,width:896},{default:o(()=>[n(s,{style:{"margin-top":"16px"},"data-source":U.list},{default:o(()=>[n(e,{key:"create_time",title:"购买时间","data-index":"create_time"},{default:o(({record:y})=>[u(L(g(y.create_time)),1)]),_:1}),n(e,{key:"buy_total",title:"购买积分数","data-index":"buy_total"}),n(e,{key:"use_total",title:"已消耗","data-index":"use_total"}),n(e,{key:"expire_total",title:"已过期","data-index":"expire_total"}),n(e,{key:"surplus_total",title:"剩余额度","data-index":"surplus_total"}),n(e,{key:"expire_time",title:"到期时间","data-index":"expire_time"},{default:o(({record:y})=>[u(L(g(y.expire_time)),1)]),_:1}),n(e,{key:"remark_outer",title:"备注","data-index":"remark_outer"})]),_:1},8,["data-source"])]),_:1},8,["open"])])}}},Ot={class:"modal-box"},qt={__name:"kefu-modal",setup(U,{expose:T}){const b=E(!1);return T({show:()=>{b.value=!0}}),(S,I)=>{const $=Ae,e=ne;return l(),m("div",null,[n(e,{open:b.value,"onUpdate:open":I[0]||(I[0]=s=>b.value=s),title:"购买资源包",footer:null,width:546},{default:o(()=>[a("div",Ot,[n($,{"show-icon":"",message:"暂不支持线上购买，请扫码联系客服购买"}),I[1]||(I[1]=a("div",{class:"img-box"},[a("img",{src:"https://xkf-upload-oss.xiaokefu.com.cn/static/kefu.png",alt:""})],-1))])]),_:1},8,["open"])])}}},Bt=Z(qt,[["__scopeId","data-v-7c6c634f"]]),Pt={class:"modal-list-box"},Xt={class:"alert-box"},jt={class:"left-block"},Vt={class:"btn-box"},Ft={class:"tab-box"},Jt={class:"table-box"},Yt={key:0},Ht={key:1},Wt={key:0},Qt={key:1},Zt={key:0},eo={key:1},to={key:2},oo={key:0},lo={key:1},no=["onClick"],ao=["onClick"],io={__name:"has-modal-list",props:{currentModalItem:{type:Object,default:()=>({})}},emits:["addModel","delModel","editConfig","delConfig"],setup(U,{emit:T}){const b=U,g=T,S=Ce();let I={input_text:"文本",input_voice:"语音",input_image:"图片",input_video:"视频",input_document:"文档"},$={output_text:"文本",output_voice:"语音",output_image:"图片",output_video:"视频"};const e=E("LLM"),s=F(()=>b.currentModalItem.config_info||{api_key:""});s.value;const M=F(()=>s.value.model_define=="doubao"?"接入点id":s.value.model_define=="azure"?"部署名称":"model");s.value;const y=F(()=>b.currentModalItem.use_model_configs||[]);function R(w){return w?w.split(",").map(h=>S.find(O=>O.value==h).label).join(","):""}const C=F(()=>y.value.filter(t=>t.model_type==e.value).map(t=>{let h=[],O=[];for(let _ in I)t[_]==1&&h.push(I[_]);for(let _ in $)t[_]==1&&O.push($[_]);let x=t.image_generation?JSON.parse(t.image_generation):{},A="";return t.image_generation&&(A=R(x.image_sizes)),{...t,input_desc:h.join(","),output_desc:O.join(","),image_generation_info:x,image_sizes_desc:A,image_max:x.image_max,image_optimize_prompt:x.image_optimize_prompt,image_watermark:x.image_watermark}})),X=F(()=>[{label:`大语言模型（${y.value.filter(w=>w.model_type=="LLM").length}）`,value:"LLM"},{label:`嵌入模型（${y.value.filter(w=>w.model_type=="TEXT EMBEDDING").length}）`,value:"TEXT EMBEDDING"},{label:`重排序模型（${y.value.filter(w=>w.model_type=="RERANK").length}）`,value:"RERANK"},{label:`图片生成模型（${y.value.filter(w=>w.model_type=="IMAGE").length}）`,value:"IMAGE"}]),J=w=>{g("addModel",b.currentModalItem,w)},V=()=>{g("editConfig",b.currentModalItem,s.value)},ee=()=>{g("delConfig",s.value)},te=w=>{g("delModel",w)};return(w,t)=>{const h=ce,O=Le,x=_e,A=Qe,_=pe;return l(),m("div",Pt,[a("div",Xt,[a("div",jt,[n(Q(We)),["baai","ollama","xinference"].includes(s.value.model_define)?(l(),m(K,{key:0},[t[2]||(t[2]=u(" API endpoint：",-1)),s.value.api_endpoint?(l(),m(K,{key:0},[u(L(s.value.api_endpoint.slice(0,30))+L(s.value.api_endpoint.length>30?"...":""),1)],64)):d("",!0)],64)):(l(),m(K,{key:1},[t[3]||(t[3]=u(" API Key：",-1)),s.value.api_key?(l(),m(K,{key:0},[u(L(s.value.api_key.slice(0,30))+" "+L(s.value.api_key.length>30?"...":""),1)],64)):d("",!0)],64))]),a("div",Vt,[n(h,{onClick:t[0]||(t[0]=f=>J())},{default:o(()=>[...t[4]||(t[4]=[u("添加模型",-1)])]),_:1}),n(h,{onClick:V},{default:o(()=>[...t[5]||(t[5]=[u("修改配置",-1)])]),_:1}),n(h,{onClick:ee},{default:o(()=>[...t[6]||(t[6]=[u("移除配置",-1)])]),_:1})])]),a("div",Ft,[n(O,{value:e.value,"onUpdate:value":t[1]||(t[1]=f=>e.value=f),options:X.value},null,8,["value","options"])]),a("div",Jt,[n(_,{sticky:"","data-source":C.value,pagination:!1,scroll:{x:1e3}},{default:o(()=>[n(x,{width:140,key:"show_model_name",title:"模型名称","data-index":"show_model_name"}),n(x,{width:140,key:"use_model_name",title:M.value,"data-index":"use_model_name"},{default:o(({record:f})=>[u(L(f.use_model_name),1)]),_:1},8,["title"]),e.value=="IMAGE"?(l(),c(x,{width:140,key:"image_sizes_desc",title:"图片比例支持","data-index":"image_sizes_desc"})):d("",!0),e.value=="IMAGE"?(l(),c(x,{width:160,key:"image_max",title:"生成图片最大数量","data-index":"image_max"})):d("",!0),e.value=="IMAGE"?(l(),c(x,{width:140,key:"image_watermark",title:"支持图片水印","data-index":"image_watermark"},{default:o(({record:f})=>[f.image_watermark==1?(l(),m("span",Yt,"支持")):d("",!0),f.image_watermark==0?(l(),m("span",Ht,"不支持")):d("",!0)]),_:1})):d("",!0),e.value=="IMAGE"?(l(),c(x,{width:160,key:"image_optimize_prompt",title:"支持自动优化提示词","data-index":"image_optimize_prompt"},{default:o(({record:f})=>[f.image_optimize_prompt==1?(l(),m("span",Wt,"支持")):d("",!0),f.image_optimize_prompt==0?(l(),m("span",Qt,"不支持")):d("",!0)]),_:1})):d("",!0),e.value=="LLM"?(l(),c(x,{width:140,key:"thinking_type",title:"深度思考","data-index":"thinking_type"},{default:o(({record:f})=>[f.thinking_type==0?(l(),m("span",Zt,"不支持")):d("",!0),f.thinking_type==1?(l(),m("span",eo,"支持")):d("",!0),f.thinking_type==2?(l(),m("span",to,"可选")):d("",!0)]),_:1})):d("",!0),e.value=="LLM"?(l(),c(x,{width:140,key:"function_call",title:"工具调用","data-index":"function_call"},{default:o(({record:f})=>[f.function_call==0?(l(),m("span",oo,"不支持")):d("",!0),f.function_call==1?(l(),m("span",lo,"支持")):d("",!0)]),_:1})):d("",!0),e.value=="TEXT EMBEDDING"?(l(),c(x,{width:120,key:"vector_dimension_list",title:"向量维度","data-index":"vector_dimension_list"})):d("",!0),e.value!="RERANK"?(l(),c(x,{width:140,key:"input_desc",title:"输入","data-index":"input_desc"},{default:o(({record:f})=>[u(L(f.input_desc),1)]),_:1})):d("",!0),e.value=="LLM"?(l(),c(x,{width:140,key:"output_desc",title:"输出","data-index":"output_desc"},{default:o(({record:f})=>[u(L(f.output_desc),1)]),_:1})):d("",!0),n(x,{key:"action",title:"操作",width:120,fixed:"right"},{default:o(({record:f})=>[a("a",{onClick:q=>J(f)},"编辑",8,no),n(A,{type:"vertical"}),a("a",{onClick:q=>te(f)},"删除",8,ao)]),_:1})]),_:1},8,["data-source"])])])}}},so=Z(io,[["__scopeId","data-v-151dfdb3"]]),uo={__name:"add-model-new",emits:"ok",setup(U,{expose:T,emit:b}){const g=E(!1),S=b,I=["siliconflow","doubao","tongyi"],$=Ce(),e=de({model_config_id:"",id:"",model_type:"LLM",use_model_name:"",show_model_name:"",thinking_type:"0",function_call:"1",input_text:!0,input_voice:!1,input_image:!1,input_video:!1,input_document:!1,output_text:!0,output_voice:!1,output_image:!1,output_video:!1,vector_dimension_list:"",image_max:1,image_inputs_image_max:1,image_sizes:$.map(w=>w.value),image_optimize_prompt:!0,image_watermark:!0}),s=E({}),M=E([]),y=F(()=>s.value.model_define=="doubao"?"接入点id":s.value.model_define=="azure"?"部署名称":"model"),R=E(null),C=(w,t)=>{if(s.value=w,M.value=w.supported_type||[],ee(),e.model_config_id=w.config_info.id,t&&(e.id=t.id,e.model_type=t.model_type,e.use_model_name=t.use_model_name,e.show_model_name=t.show_model_name||t.use_model_name,e.thinking_type=t.thinking_type+"",e.function_call=t.function_call+"",e.input_text=t.input_text==1,e.input_voice=t.input_voice==1,e.input_image=t.input_image==1,e.input_video=t.input_video==1,e.input_document=t.input_document==1,e.output_text=t.output_text==1,e.output_voice=t.output_voice==1,e.output_image=t.output_image==1,e.output_video=t.output_video==1,e.vector_dimension_list=t.vector_dimension_list,t.image_generation)){let h=JSON.parse(t.image_generation);e.image_max=h.image_max,e.image_inputs_image_max=h.image_inputs_image_max,e.image_sizes=h.image_sizes?h.image_sizes.split(","):[],e.image_optimize_prompt=h.image_optimize_prompt==1,e.image_watermark=h.image_watermark==1}g.value=!0},X=E(!1),J=()=>{R.value.validate().then(()=>{let w={image_sizes:e.image_sizes.join(","),image_max:e.image_max+"",image_watermark:e.image_watermark?"1":"0",image_optimize_prompt:e.image_optimize_prompt?"1":"0",image_inputs_image_max:e.image_inputs_image_max+""},t={...e,input_text:e.input_text?1:0,input_voice:e.input_voice?1:0,input_image:e.input_image?1:0,input_video:e.input_video?1:0,input_document:e.input_document?1:0,output_text:e.output_text?1:0,output_voice:e.output_voice?1:0,output_image:e.output_image?1:0,output_video:e.output_video?1:0,image_generation:JSON.stringify(w)};X.value=!0,Ge({...t}).then(()=>{ie.success("保存成功"),S("ok"),g.value=!1}).finally(()=>{X.value=!1})})},V=()=>{e.input_voice=!1,e.input_image=!1,e.input_video=!1,e.input_document=!1,e.output_text=!1,e.output_voice=!1,e.output_image=!1,e.output_video=!1};function ee(){Object.assign(e,{model_config_id:"",id:"",model_type:M.value[0],use_model_name:"",show_model_name:"",thinking_type:"0",function_call:"1",input_text:!0,input_voice:!1,input_image:!1,input_video:!1,input_document:!1,output_text:!0,output_voice:!1,output_image:!1,output_video:!1,vector_dimension_list:"",image_max:1,image_inputs_image_max:1,image_sizes:$.map(w=>w.value),image_optimize_prompt:!0,image_watermark:!0})}const te=()=>{e.show_model_name||(e.show_model_name=e.use_model_name)};return T({show:C}),(w,t)=>{const h=Me,O=be,x=xe,A=$e,_=Ze,f=et,q=tt,N=lt,B=ot,z=re,G=ne;return l(),m("div",null,[n(G,{open:g.value,"onUpdate:open":t[22]||(t[22]=i=>g.value=i),title:`${e.id?"编辑":"添加"}模型`,width:700,onOk:J,confirmLoading:X.value},{default:o(()=>[n(z,{class:"form-box",ref_key:"formRef",ref:R,layout:"vertical",model:e},{default:o(()=>[n(x,{name:"model_type",label:"模型类型",required:""},{default:o(()=>[n(O,{onChange:V,value:e.model_type,"onUpdate:value":t[0]||(t[0]=i=>e.model_type=i),name:"radioGroup"},{default:o(()=>[M.value.includes("LLM")?(l(),c(h,{key:0,value:"LLM"},{default:o(()=>[...t[23]||(t[23]=[u("大语言模型",-1)])]),_:1})):d("",!0),M.value.includes("TEXT EMBEDDING")?(l(),c(h,{key:1,value:"TEXT EMBEDDING"},{default:o(()=>[...t[24]||(t[24]=[u("嵌入模型",-1)])]),_:1})):d("",!0),M.value.includes("RERANK")?(l(),c(h,{key:2,value:"RERANK"},{default:o(()=>[...t[25]||(t[25]=[u("重排序模型",-1)])]),_:1})):d("",!0),M.value.includes("IMAGE")?(l(),c(h,{key:3,value:"IMAGE"},{default:o(()=>[...t[26]||(t[26]=[u("图片生成模型",-1)])]),_:1})):d("",!0)]),_:1},8,["value"])]),_:1}),n(x,{name:"use_model_name",label:y.value,rules:[{required:!0,message:`请输入${y.value}`}]},{default:o(()=>[n(A,{value:e.use_model_name,"onUpdate:value":t[1]||(t[1]=i=>e.use_model_name=i),onBlur:te,placeholder:"请输入，为调用模型时参数"},null,8,["value"])]),_:1},8,["label","rules"]),n(x,{name:"show_model_name",label:"模型名称",rules:[{required:!0,message:"请输入模型名称"}]},{default:o(()=>[n(A,{value:e.show_model_name,"onUpdate:value":t[2]||(t[2]=i=>e.show_model_name=i),maxLength:50,placeholder:"请输入模型名称，仅后台展示用"},null,8,["value"])]),_:1}),e.model_type=="TEXT EMBEDDING"?(l(),c(x,{key:0,name:"vector_dimension_list",label:"向量维度"},{default:o(()=>[n(A,{value:e.vector_dimension_list,"onUpdate:value":t[3]||(t[3]=i=>e.vector_dimension_list=i),placeholder:"请输入支持的向量维度，多个向量维度用英文逗号分割"},null,8,["value"]),t[27]||(t[27]=a("div",{class:"form-tip"},"向量维度必须为正整数，比如1024",-1))]),_:1})):d("",!0),I.includes(s.value.model_define)&&e.model_type=="LLM"?(l(),c(x,{key:1,name:"thinking_type",label:"深度思考",required:""},{default:o(()=>[n(O,{class:"thiing-radio-box",value:e.thinking_type,"onUpdate:value":t[4]||(t[4]=i=>e.thinking_type=i)},{default:o(()=>[n(h,{value:"1"},{default:o(()=>[...t[28]||(t[28]=[u("支持（类似deepseek r1这种只支持思考模式的模型）",-1)])]),_:1}),n(h,{value:"2"},{default:o(()=>[...t[29]||(t[29]=[u("可选（比如doubao 1.6，可以通过接口控制是否启用深度思考模式）",-1)])]),_:1}),n(h,{value:"0"},{default:o(()=>[...t[30]||(t[30]=[u("不支持（比如deepseek v3，模型本身不支持深度思考模式）",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):d("",!0),e.model_type=="LLM"?(l(),c(x,{key:2,name:"function_call",label:"工具调用",required:""},{default:o(()=>[n(O,{value:e.function_call,"onUpdate:value":t[5]||(t[5]=i=>e.function_call=i)},{default:o(()=>[n(h,{value:"1"},{default:o(()=>[...t[31]||(t[31]=[u("支持",-1)])]),_:1}),n(h,{value:"0"},{default:o(()=>[...t[32]||(t[32]=[u("不支持",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):d("",!0),e.model_type=="IMAGE"?(l(),c(x,{key:3,name:"image_sizes",label:"图片比列支持",required:"",rules:[{required:!0,message:"请选择图片比列支持"}]},{default:o(()=>[n(_,{class:"image-size-options",value:e.image_sizes,"onUpdate:value":t[6]||(t[6]=i=>e.image_sizes=i),name:"checkboxgroup",options:Q($)},null,8,["value","options"])]),_:1})):d("",!0),e.model_type=="IMAGE"?(l(),c(x,{key:4,name:"image_max",label:"生成图片最大数量",rules:[{required:!0,message:"请输入生成图片最大数量"}]},{default:o(()=>[n(f,{style:{width:"100%"},value:e.image_max,"onUpdate:value":t[7]||(t[7]=i=>e.image_max=i),max:10,precision:0},null,8,["value"])]),_:1})):d("",!0),e.model_type=="IMAGE"?(l(),c(x,{key:5,name:"image_watermark",label:"支持图片水印"},{default:o(()=>[n(q,{checked:e.image_watermark,"onUpdate:checked":t[8]||(t[8]=i=>e.image_watermark=i),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})):d("",!0),e.model_type=="IMAGE"?(l(),c(x,{key:6,name:"image_optimize_prompt",label:"支持自动优化提示词"},{default:o(()=>[n(q,{checked:e.image_optimize_prompt,"onUpdate:checked":t[9]||(t[9]=i=>e.image_optimize_prompt=i),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})):d("",!0),e.model_type!="RERANK"?(l(),c(x,{key:7,label:"支持输入类型",required:""},{default:o(()=>[e.model_type=="LLM"?(l(),c(B,{key:0,gap:8},{default:o(()=>[n(N,{checked:e.input_text,"onUpdate:checked":t[10]||(t[10]=i=>e.input_text=i)},{default:o(()=>[...t[33]||(t[33]=[u("文本",-1)])]),_:1},8,["checked"]),n(N,{checked:e.input_voice,"onUpdate:checked":t[11]||(t[11]=i=>e.input_voice=i)},{default:o(()=>[...t[34]||(t[34]=[u("语音",-1)])]),_:1},8,["checked"]),n(N,{checked:e.input_image,"onUpdate:checked":t[12]||(t[12]=i=>e.input_image=i)},{default:o(()=>[...t[35]||(t[35]=[u("图片",-1)])]),_:1},8,["checked"]),n(N,{checked:e.input_video,"onUpdate:checked":t[13]||(t[13]=i=>e.input_video=i)},{default:o(()=>[...t[36]||(t[36]=[u("视频",-1)])]),_:1},8,["checked"]),n(N,{checked:e.input_document,"onUpdate:checked":t[14]||(t[14]=i=>e.input_document=i)},{default:o(()=>[...t[37]||(t[37]=[u("文档",-1)])]),_:1},8,["checked"])]),_:1})):(l(),c(B,{key:1,gap:8,align:"center"},{default:o(()=>[n(N,{checked:e.input_text,"onUpdate:checked":t[15]||(t[15]=i=>e.input_text=i)},{default:o(()=>[...t[38]||(t[38]=[u("文本",-1)])]),_:1},8,["checked"]),n(N,{checked:e.input_image,"onUpdate:checked":t[16]||(t[16]=i=>e.input_image=i)},{default:o(()=>[...t[39]||(t[39]=[u("图片",-1)])]),_:1},8,["checked"]),e.model_type=="IMAGE"?(l(),c(B,{key:0,align:"center",gap:4},{default:o(()=>[t[40]||(t[40]=u(" 最多 ",-1)),n(f,{style:{width:"120p"},value:e.image_inputs_image_max,"onUpdate:value":t[17]||(t[17]=i=>e.image_inputs_image_max=i),precision:0,min:1,max:4},null,8,["value"]),t[41]||(t[41]=u(" 张图 ",-1))]),_:1})):d("",!0)]),_:1}))]),_:1})):d("",!0),e.model_type=="LLM"?(l(),c(x,{key:8,label:"支持输出类型",required:""},{default:o(()=>[n(B,{gap:8},{default:o(()=>[n(N,{checked:e.output_text,"onUpdate:checked":t[18]||(t[18]=i=>e.output_text=i)},{default:o(()=>[...t[42]||(t[42]=[u("文本",-1)])]),_:1},8,["checked"]),n(N,{checked:e.output_voice,"onUpdate:checked":t[19]||(t[19]=i=>e.output_voice=i)},{default:o(()=>[...t[43]||(t[43]=[u("语音",-1)])]),_:1},8,["checked"]),n(N,{checked:e.output_image,"onUpdate:checked":t[20]||(t[20]=i=>e.output_image=i)},{default:o(()=>[...t[44]||(t[44]=[u("图片",-1)])]),_:1},8,["checked"]),n(N,{checked:e.output_video,"onUpdate:checked":t[21]||(t[21]=i=>e.output_video=i)},{default:o(()=>[...t[45]||(t[45]=[u("视频",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})):d("",!0)]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}},_o=Z(uo,[["__scopeId","data-v-d0e75dd6"]]),po={class:"user-model-page"},mo={class:"list-wrapper"},ro={key:0,class:"alert-content-box"},co={key:1,class:"content-body-box"},fo={class:"model-group-box"},vo=["onClick"],go=["src"],yo={class:"model-name"},ko={class:"model-content-box"},ho={key:0,class:"chatwiki-model-box"},xo={class:"statics-block"},bo={class:"statics-item"},Mo={class:"num"},wo={class:"statics-item"},Eo={class:"num"},$o={class:"statics-item"},Io={class:"num"},Ao={class:"btn-block"},Lo={class:"search-block"},Co={class:"search-item"},Do={class:"list-box"},To={key:0},Ro={key:1},No={key:2},Uo={key:0},So={key:1},zo={__name:"index",setup(U){const T=Fe().query,{t:b}=ue(),g=E(+T.activeTab>=0?+T.activeTab:1),S=()=>{};E([]);const I=E([]),$=E(""),e=de({all_surplus:0,all_use:0,min_expiretime:"",list:[]}),s=de({model_supplier:void 0}),M=E("LLM"),y=F(()=>I.value.filter(p=>p.model_type==M.value)),R=F(()=>[{label:`大语言模型（${I.value.filter(p=>p.model_type=="LLM").length}）`,value:"LLM"},{label:`嵌入模型（${I.value.filter(p=>p.model_type=="TEXT EMBEDDING").length}）`,value:"TEXT EMBEDDING"},{label:`重排序模型（${I.value.filter(p=>p.model_type=="RERANK").length}）`,value:"RERANK"},{label:`图片生成模型（${I.value.filter(p=>p.model_type=="IMAGE").length}）`,value:"IMAGE"}]),C=E([]),X=()=>{Pe().then(p=>{e.all_surplus=p.data.all_surplus,e.all_use=p.data.all_use,e.list=p.data.list||[],e.min_expiretime=p.data.min_expiretime>0?Ie(p.data.min_expiretime*1e3).format("YYYY-MM-DD"):"--"})},J=E(null),V=E(null),ee=()=>{X(),V.value.show()};let te={tongyi:"通义千问",deepseek:"DeepSeek",doubao:"豆包"},w={LLM:"大语言模型","TEXT EMBEDDING":"嵌入模型",RERANK:"重排序模型",IMAGE:"图片生成模型"},t={input_text:"文本",input_voice:"语音",input_image:"图片",input_video:"视频",input_document:"文档"},h={output_text:"文本",output_voice:"语音",output_image:"图片",output_video:"视频"};const O=()=>{qe({...s}).then(p=>{if(!p.data){I.value=[];return}I.value=p.data.map(v=>{let Y=[],ae=[];for(let le in t)v[le]==1&&Y.push(t[le]);for(let le in h)v[le]==1&&ae.push(h[le]);return{...v,model_supplier_desc:te[v.model_supplier],model_type_desc:w[v.model_type],input_desc:Y.join(","),output_desc:ae.join(",")}})})},x=F(()=>C.value.filter(p=>p.config_info_id==$.value)[0]||{}),A=p=>{$.value=p.config_info_id};Je(()=>C,()=>{C.value.filter(p=>p.config_info_id==$.value).length==0&&($.value=C.value[0].config_info_id)},{deep:!0});const _=E([]),f=()=>{Ke().then(p=>{let v=p.data||[];v.forEach(Y=>{Y.config_info_id=Y.model_define=="chatwiki"?"chatwiki":Y.config_info.id}),C.value=v})},q=E(null),N=(p,v)=>{q.value.show(p,v)},B=p=>{ne.confirm({title:"删除模型确认",icon:n(ye),content:`确认删除【${p.show_model_name}】这个模型吗?`,onOk(){Xe({id:p.id}).then(()=>{ie.success("删除成功"),f(),z()})}})},z=()=>{Oe().then(p=>{_.value=p.data||[]})};Ye(()=>{f(),z()});const G=E(null),i=p=>{G.value.open(p)},oe=p=>{k.value.open(p)},r=p=>{k.value.open(p)},k=E(null),j=(p,v)=>{k.value.open(p,v)},fe=()=>{f(),z()},De=p=>{g.value==0&&(g.value=1,$.value=p),fe()},ve=p=>{ne.confirm({title:b("views.user.model.deleteModel"),icon:n(ye),content:b("views.user.model.deleteModelContent"),onOk(){Be({id:p.id}).then(()=>{ie.success(b("common.deleteSuccessful")),f(),z()})}})},Te=E(null),Re=()=>{Te.value.open()};return(p,v)=>{const Y=Ae,ae=ce,le=Le,me=Ee,Ne=we,H=_e,Ue=pe;return l(),m(K,null,[a("div",po,[n(st,{value:g.value,"onUpdate:value":v[0]||(v[0]=D=>g.value=D),onChange:S},null,8,["value"]),a("div",mo,[g.value==0?(l(),m("div",ro,[n(Y,{"show-icon":""},{message:o(()=>[...v[3]||(v[3]=[a("div",{class:"title"},"使用说明",-1),a("div",null," 1、模型主要分为嵌入模型（TEXT EMBEDDING）和大模型（LLM），嵌入模型用于将上传知识库的文本内容进行向量化便于后续检索，大模型用于将检索到的相关知识进行理解后返回答案。 ",-1),a("div",null,"2、配置模型时尽量选择同时支持LLM和TEXT EMBEDDING的模型，否则要配置多个模型。",-1),a("div",null," 3、国内模型厂商一般都需要认证后才可使用，所以在配置模型前，确保在模型服务厂商那里已认证，否则配置模型时会提示配置参数错误。 ",-1)])]),_:1})])):d("",!0),g.value==1?(l(),m("div",co,[a("div",fo,[(l(!0),m(K,null,W(C.value,D=>(l(),m("div",{class:he(["model-list-item",{active:D.config_info_id==$.value}]),onClick:Go=>A(D),key:D.config_info_id},[a("img",{class:"avatar",src:D.model_icon_url,alt:""},null,8,go),a("div",yo,L(D.config_info.config_name||D.model_name),1)],10,vo))),128))]),a("div",ko,[$.value=="chatwiki"?(l(),m("div",ho,[a("div",xo,[a("div",bo,[v[4]||(v[4]=a("div",{class:"title"},"剩余积分",-1)),a("div",Mo,L(Q(ge)(e.all_surplus)),1)]),a("div",wo,[v[5]||(v[5]=a("div",{class:"title"},"累计已使用",-1)),a("div",Eo,L(Q(ge)(e.all_use)),1)]),a("div",$o,[v[6]||(v[6]=a("div",{class:"title"},"最近过期时间",-1)),a("div",Io,L(e.min_expiretime),1)]),a("div",Ao,[n(ae,{type:"primary",onClick:Re,block:""},{default:o(()=>[...v[7]||(v[7]=[u("购买资源包",-1)])]),_:1}),n(ae,{onClick:ee,block:""},{default:o(()=>[...v[8]||(v[8]=[u("购买记录",-1)])]),_:1})])]),a("div",Lo,[n(le,{value:M.value,"onUpdate:value":v[1]||(v[1]=D=>M.value=D),options:R.value},null,8,["value","options"]),a("div",Co,[v[12]||(v[12]=a("span",null,"模型供应商：",-1)),n(Ne,{allowClear:"",onChange:O,value:s.model_supplier,"onUpdate:value":v[2]||(v[2]=D=>s.model_supplier=D),placeholder:"请选择模型供应商",style:{width:"172px"}},{default:o(()=>[n(me,{value:"tongyi"},{default:o(()=>[...v[9]||(v[9]=[u("通义千问",-1)])]),_:1}),n(me,{value:"deepseek"},{default:o(()=>[...v[10]||(v[10]=[u("DeepSeek",-1)])]),_:1}),n(me,{value:"doubao"},{default:o(()=>[...v[11]||(v[11]=[u("豆包",-1)])]),_:1})]),_:1},8,["value"])])]),a("div",Do,[n(Ue,{sticky:"",style:{"margin-top":"8px"},pagination:!1,"data-source":y.value},{default:o(()=>[n(H,{key:"uni_model_name",width:140,title:"模型","data-index":"uni_model_name"}),n(H,{width:140,key:"model_supplier_desc",title:"模型服务商","data-index":"model_supplier_desc"}),M.value=="LLM"?(l(),c(H,{width:140,key:"thinking_type",title:"深度思考","data-index":"thinking_type"},{default:o(({record:D})=>[D.thinking_type==0?(l(),m("span",To,"不支持")):d("",!0),D.thinking_type==1?(l(),m("span",Ro,"支持")):d("",!0),D.thinking_type==2?(l(),m("span",No,"可选")):d("",!0)]),_:1})):d("",!0),M.value=="LLM"?(l(),c(H,{width:140,key:"function_call",title:"工具调用","data-index":"function_call"},{default:o(({record:D})=>[D.function_call==0?(l(),m("span",Uo,"不支持")):d("",!0),D.function_call==1?(l(),m("span",So,"支持")):d("",!0)]),_:1})):d("",!0),M.value=="TEXT EMBEDDING"?(l(),c(H,{width:120,key:"vector_dimension_list",title:"向量维度","data-index":"vector_dimension_list"})):d("",!0),M.value!="RERANK"?(l(),c(H,{width:100,key:"input_desc",title:"输入","data-index":"input_desc"},{default:o(({record:D})=>[u(L(D.input_desc),1)]),_:1})):d("",!0),M.value=="LLM"?(l(),c(H,{width:100,key:"output_desc",title:"输出","data-index":"output_desc"},{default:o(({record:D})=>[u(L(D.output_desc),1)]),_:1})):d("",!0),n(H,{width:130,key:"price",title:"价格","data-index":"price"},{default:o(({record:D})=>[u(L(D.price)+"积分/千Token",1)]),_:1})]),_:1},8,["data-source"])])])):(l(),c(so,{key:1,onAddModel:N,onDelModel:B,onEditConfig:j,onDelConfig:ve,currentModalItem:x.value},null,8,["currentModalItem"]))])])):d("",!0),g.value==0?(l(),c(kt,{list:_.value,type:2,key:"canAddModelList",onAdd:r,onSee:i},null,8,["list"])):d("",!0)])]),n(Gt,{ref_key:"seeModelAlertRef",ref:G,onNew:oe,onEdit:j,onRemove:ve},null,512),n(Rt,{ref_key:"setModelAlertRef",ref:k,onOk:De},null,512),n(Kt,{list:e.list,ref_key:"buyRecordRef",ref:V},null,8,["list"]),n(Bt,{ref_key:"kefuModalRef",ref:J},null,512),n(_o,{ref_key:"addModelNewRef",ref:q,onOk:fe},null,512)],64)}}},Fo=Z(zo,[["__scopeId","data-v-415b803b"]]);export{Fo as default};
