import{b as V,bO as h,ar as B,aU as T}from"../../index-0TFHdij1.js";import{e as U,ab as L,f as p,r as J,o as D,Y as E,k as a,a5 as y,a2 as t,_ as i,a1 as g,ae as b,G as m,u as k,J as R}from"./vue-chunks-CXJTX1FC.js";import{C as q}from"./config-page-menu-CGN1dwA8.js";import{M as v}from"./model-select-Dks01hRk.js";import{F,e as G,Y as P,p as Y,am as N,B as j,M as A,a as X}from"./ui-antd-D3ZAJ1Vq.js";import"./utils-yZpnICoG.js";import"./index-B551IHpY.js";const $={class:"ai-config-page"},z={class:"page-container"},H={class:"ai-config-form"},K={__name:"index",setup(Q){const I=h(),w=L(),C=U(()=>w.query.library_id),_=p(),n=p(!1);let r={};const o=J({library_name:"",library_intro:"",ai_summary:"",ai_summary_model:"",access_rights:"",model_config_id:"",use_model:"",use_model_switch:"",statistics_set:"",summary_model_config_id:""}),M=async()=>{try{await _.value.validate(),r.use_model!=o.use_model?A.confirm({title:"确定切换模型为"+o.use_model+"吗？",content:"切换模型后，文档会重新向量化，会消耗token",okText:"确定",cancelText:"取消",onOk(){u()}}):u()}catch(l){console.error("表单验证失败:",l)}},u=()=>{let l={...R(o)};n.value=!0,T(l).then(()=>{X.success("保存成功"),n.value=!1,r=JSON.parse(JSON.stringify(l)),I.getLibraryInfo()}).catch(()=>{n.value=!1})},S=()=>{B({id:C.value}).then(l=>{let e=l.data||{};e.use_model=e.use_model||void 0,e.ai_summary_model=e.ai_summary_model||void 0,r=JSON.parse(JSON.stringify(e)),Object.assign(o,e)})};return D(()=>{S()}),(l,e)=>{const c=Y,f=P,d=G,x=j,O=F;return i(),E("div",$,[a(q),y("div",z,[y("div",H,[a(O,{ref_key:"formRef",ref:_,model:o,"label-col":{span:4},"wrapper-col":{span:8}},{default:t(()=>[a(d,null,{label:t(()=>[e[7]||(e[7]=m(" 嵌入  ")),a(c,null,{title:t(()=>e[6]||(e[6]=[m("开启嵌入功能后，才能在机器人中关联本知识库。")])),default:t(()=>[a(k(N))]),_:1})]),default:t(()=>[a(f,{checked:o.use_model_switch,"onUpdate:checked":e[0]||(e[0]=s=>o.use_model_switch=s),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),o.use_model_switch==1?(i(),g(d,{key:0,label:"嵌入模型",name:"use_model",rules:[{required:!0,message:"请选择嵌入模型"}]},{default:t(()=>[a(v,{modelType:"TEXT EMBEDDING",placeholder:"请选择嵌入模型",modeName:o.use_model,"onUpdate:modeName":e[1]||(e[1]=s=>o.use_model=s),modeId:o.model_config_id,"onUpdate:modeId":e[2]||(e[2]=s=>o.model_config_id=s)},null,8,["modeName","modeId"])]),_:1})):b("",!0),a(d,null,{label:t(()=>[e[9]||(e[9]=m(" AI智能总结  ")),a(c,null,{title:t(()=>e[8]||(e[8]=[m("开启后，搜索知识库时，由大模型自动总结文档，并给出总结后的结果")])),default:t(()=>[a(k(N))]),_:1})]),default:t(()=>[a(f,{checked:o.ai_summary,"onUpdate:checked":e[3]||(e[3]=s=>o.ai_summary=s),unCheckedValue:"0",checkedValue:"1"},null,8,["checked"])]),_:1}),o.ai_summary==1?(i(),g(d,{key:1,label:"总结模型",name:"ai_summary_model",rules:[{required:!0,message:"请选择总结模型"}]},{default:t(()=>[a(v,{modelType:"LLM",modeName:o.ai_summary_model,"onUpdate:modeName":e[4]||(e[4]=s=>o.ai_summary_model=s),modeId:o.summary_model_config_id,"onUpdate:modeId":e[5]||(e[5]=s=>o.summary_model_config_id=s)},null,8,["modeName","modeId"])]),_:1})):b("",!0),a(d,{"wrapper-col":{offset:4,span:8}},{default:t(()=>[a(x,{type:"primary",loading:n.value,onClick:M},{default:t(()=>e[10]||(e[10]=[m("保存")])),_:1,__:[10]},8,["loading"])]),_:1})]),_:1},8,["model"])])])])}}},le=V(K,[["__scopeId","data-v-27aaec9b"]]);export{le as default};
