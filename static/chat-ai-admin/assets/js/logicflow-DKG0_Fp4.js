import{a as Fe,c as xe,m as kn,g as ei,n as qa,p as Pn,f as Oe,t as Wr,b as gr,d as hn,i as Bn,e as Rt,s as $c,h as Wc,j as Io,k as Es,l as Uc,o as tf,q as Vc,r as Kc,u as zl,v as Zc,w as bs,x as rf,y as qc,z as nf,A as li,B as Jc,C as Qc}from"./lodash-Bm5sK6rN.js";import{M as Gi}from"./medium-editor-DkrXt2qq.js";import{g as yl}from"./editor-cherry-CFIsbKoN.js";import{E as eh,d as of,G as ko,F as th,k as rh,T as nh,H as af}from"./vue-chunks-BdaA73Wf.js";var Ia,Ne,sf,nn,Yl,lf,uf,df,ml,Ss,Os,Bo={},ff=[],oh=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ti=Array.isArray;function Rr(r,t){for(var e in t)r[e]=t[e];return r}function _l(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function ce(r,t,e){var n,o,i,a={};for(i in t)i=="key"?n=t[i]:i=="ref"?o=t[i]:a[i]=t[i];if(arguments.length>2&&(a.children=arguments.length>3?Ia.call(arguments,2):e),typeof r=="function"&&r.defaultProps!=null)for(i in r.defaultProps)a[i]===void 0&&(a[i]=r.defaultProps[i]);return Li(r,a,n,o,null)}function Li(r,t,e,n,o){var i={type:r,props:t,key:e,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++sf,__i:-1,__u:0};return o==null&&Ne.vnode!=null&&Ne.vnode(i),i}function ka(){return{current:null}}function Xn(r){return r.children}function De(r,t){this.props=r,this.context=t}function Hn(r,t){if(t==null)return r.__?Hn(r.__,r.__i+1):null;for(var e;t<r.__k.length;t++)if((e=r.__k[t])!=null&&e.__e!=null)return e.__e;return typeof r.type=="function"?Hn(r):null}function cf(r){var t,e;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,t=0;t<r.__k.length;t++)if((e=r.__k[t])!=null&&e.__e!=null){r.__e=r.__c.base=e.__e;break}return cf(r)}}function Fl(r){(!r.__d&&(r.__d=!0)&&nn.push(r)&&!zi.__r++||Yl!=Ne.debounceRendering)&&((Yl=Ne.debounceRendering)||lf)(zi)}function zi(){for(var r,t,e,n,o,i,a,s=1;nn.length;)nn.length>s&&nn.sort(uf),r=nn.shift(),s=nn.length,r.__d&&(e=void 0,n=void 0,o=(n=(t=r).__v).__e,i=[],a=[],t.__P&&((e=Rr({},n)).__v=n.__v+1,Ne.vnode&&Ne.vnode(e),xl(t.__P,e,n,t.__n,t.__P.namespaceURI,32&n.__u?[o]:null,i,o??Hn(n),!!(32&n.__u),a),e.__v=n.__v,e.__.__k[e.__i]=e,vf(i,e,a),n.__e=n.__=null,e.__e!=o&&cf(e)));zi.__r=0}function hf(r,t,e,n,o,i,a,s,l,u,f){var d,c,h,p,v,g,y,w=n&&n.__k||ff,M=t.length;for(l=ih(e,t,w,l,M),d=0;d<M;d++)(h=e.__k[d])!=null&&(c=h.__i==-1?Bo:w[h.__i]||Bo,h.__i=d,g=xl(r,h,c,o,i,a,s,l,u,f),p=h.__e,h.ref&&c.ref!=h.ref&&(c.ref&&wl(c.ref,null,h),f.push(h.ref,h.__c||p,h)),v==null&&p!=null&&(v=p),(y=!!(4&h.__u))||c.__k===h.__k?l=pf(h,l,r,y):typeof h.type=="function"&&g!==void 0?l=g:p&&(l=p.nextSibling),h.__u&=-7);return e.__e=v,l}function ih(r,t,e,n,o){var i,a,s,l,u,f=e.length,d=f,c=0;for(r.__k=new Array(o),i=0;i<o;i++)(a=t[i])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=r.__k[i]=Li(null,a,null,null,null):ti(a)?a=r.__k[i]=Li(Xn,{children:a},null,null,null):a.constructor==null&&a.__b>0?a=r.__k[i]=Li(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):r.__k[i]=a,l=i+c,a.__=r,a.__b=r.__b+1,(u=a.__i=ah(a,e,l,d))!=-1&&(d--,(s=e[u])&&(s.__u|=2)),s==null||s.__v==null?(u==-1&&(o>f?c--:o<f&&c++),typeof a.type!="function"&&(a.__u|=4)):u!=l&&(u==l-1?c--:u==l+1?c++:(u>l?c--:c++,a.__u|=4))):r.__k[i]=null;if(d)for(i=0;i<f;i++)(s=e[i])!=null&&(2&s.__u)==0&&(s.__e==n&&(n=Hn(s)),yf(s,s));return n}function pf(r,t,e,n){var o,i;if(typeof r.type=="function"){for(o=r.__k,i=0;o&&i<o.length;i++)o[i]&&(o[i].__=r,t=pf(o[i],t,e,n));return t}r.__e!=t&&(n&&(t&&r.type&&!t.parentNode&&(t=Hn(r)),e.insertBefore(r.__e,t||null)),t=r.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Yi(r,t){return t=t||[],r==null||typeof r=="boolean"||(ti(r)?r.some(function(e){Yi(e,t)}):t.push(r)),t}function ah(r,t,e,n){var o,i,a,s=r.key,l=r.type,u=t[e],f=u!=null&&(2&u.__u)==0;if(u===null&&s==null||f&&s==u.key&&l==u.type)return e;if(n>(f?1:0)){for(o=e-1,i=e+1;o>=0||i<t.length;)if((u=t[a=o>=0?o--:i++])!=null&&(2&u.__u)==0&&s==u.key&&l==u.type)return a}return-1}function $l(r,t,e){t[0]=="-"?r.setProperty(t,e??""):r[t]=e==null?"":typeof e!="number"||oh.test(t)?e:e+"px"}function ui(r,t,e,n,o){var i,a;e:if(t=="style")if(typeof e=="string")r.style.cssText=e;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(t in n)e&&t in e||$l(r.style,t,"");if(e)for(t in e)n&&e[t]==n[t]||$l(r.style,t,e[t])}else if(t[0]=="o"&&t[1]=="n")i=t!=(t=t.replace(df,"$1")),a=t.toLowerCase(),t=a in r||t=="onFocusOut"||t=="onFocusIn"?a.slice(2):t.slice(2),r.l||(r.l={}),r.l[t+i]=e,e?n?e.u=n.u:(e.u=ml,r.addEventListener(t,i?Os:Ss,i)):r.removeEventListener(t,i?Os:Ss,i);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in r)try{r[t]=e??"";break e}catch{}typeof e=="function"||(e==null||e===!1&&t[4]!="-"?r.removeAttribute(t):r.setAttribute(t,t=="popover"&&e==1?"":e))}}function Wl(r){return function(t){if(this.l){var e=this.l[t.type+r];if(t.t==null)t.t=ml++;else if(t.t<e.u)return;return e(Ne.event?Ne.event(t):t)}}}function xl(r,t,e,n,o,i,a,s,l,u){var f,d,c,h,p,v,g,y,w,M,C,P,S,E,T,j,q,ee=t.type;if(t.constructor!=null)return null;128&e.__u&&(l=!!(32&e.__u),i=[s=t.__e=e.__e]),(f=Ne.__b)&&f(t);e:if(typeof ee=="function")try{if(y=t.props,w="prototype"in ee&&ee.prototype.render,M=(f=ee.contextType)&&n[f.__c],C=f?M?M.props.value:f.__:n,e.__c?g=(d=t.__c=e.__c).__=d.__E:(w?t.__c=d=new ee(y,C):(t.__c=d=new De(y,C),d.constructor=ee,d.render=lh),M&&M.sub(d),d.state||(d.state={}),d.__n=n,c=d.__d=!0,d.__h=[],d._sb=[]),w&&d.__s==null&&(d.__s=d.state),w&&ee.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=Rr({},d.__s)),Rr(d.__s,ee.getDerivedStateFromProps(y,d.__s))),h=d.props,p=d.state,d.__v=t,c)w&&ee.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),w&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(w&&ee.getDerivedStateFromProps==null&&y!==h&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(y,C),t.__v==e.__v||!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(y,d.__s,C)===!1){for(t.__v!=e.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=e.__e,t.__k=e.__k,t.__k.some(function(he){he&&(he.__=t)}),P=0;P<d._sb.length;P++)d.__h.push(d._sb[P]);d._sb=[],d.__h.length&&a.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(y,d.__s,C),w&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(h,p,v)})}if(d.context=C,d.props=y,d.__P=r,d.__e=!1,S=Ne.__r,E=0,w){for(d.state=d.__s,d.__d=!1,S&&S(t),f=d.render(d.props,d.state,d.context),T=0;T<d._sb.length;T++)d.__h.push(d._sb[T]);d._sb=[]}else do d.__d=!1,S&&S(t),f=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++E<25);d.state=d.__s,d.getChildContext!=null&&(n=Rr(Rr({},n),d.getChildContext())),w&&!c&&d.getSnapshotBeforeUpdate!=null&&(v=d.getSnapshotBeforeUpdate(h,p)),j=f,f!=null&&f.type===Xn&&f.key==null&&(j=gf(f.props.children)),s=hf(r,ti(j)?j:[j],t,e,n,o,i,a,s,l,u),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),g&&(d.__E=d.__=null)}catch(he){if(t.__v=null,l||i!=null)if(he.then){for(t.__u|=l?160:128;s&&s.nodeType==8&&s.nextSibling;)s=s.nextSibling;i[i.indexOf(s)]=null,t.__e=s}else{for(q=i.length;q--;)_l(i[q]);Ms(t)}else t.__e=e.__e,t.__k=e.__k,he.then||Ms(t);Ne.__e(he,t,e)}else i==null&&t.__v==e.__v?(t.__k=e.__k,t.__e=e.__e):s=t.__e=sh(e.__e,t,e,n,o,i,a,l,u);return(f=Ne.diffed)&&f(t),128&t.__u?void 0:s}function Ms(r){r&&r.__c&&(r.__c.__e=!0),r&&r.__k&&r.__k.forEach(Ms)}function vf(r,t,e){for(var n=0;n<e.length;n++)wl(e[n],e[++n],e[++n]);Ne.__c&&Ne.__c(t,r),r.some(function(o){try{r=o.__h,o.__h=[],r.some(function(i){i.call(o)})}catch(i){Ne.__e(i,o.__v)}})}function gf(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:ti(r)?r.map(gf):Rr({},r)}function sh(r,t,e,n,o,i,a,s,l){var u,f,d,c,h,p,v,g=e.props||Bo,y=t.props,w=t.type;if(w=="svg"?o="http://www.w3.org/2000/svg":w=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),i!=null){for(u=0;u<i.length;u++)if((h=i[u])&&"setAttribute"in h==!!w&&(w?h.localName==w:h.nodeType==3)){r=h,i[u]=null;break}}if(r==null){if(w==null)return document.createTextNode(y);r=document.createElementNS(o,w,y.is&&y),s&&(Ne.__m&&Ne.__m(t,i),s=!1),i=null}if(w==null)g===y||s&&r.data==y||(r.data=y);else{if(i=i&&Ia.call(r.childNodes),!s&&i!=null)for(g={},u=0;u<r.attributes.length;u++)g[(h=r.attributes[u]).name]=h.value;for(u in g)if(h=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")d=h;else if(!(u in y)){if(u=="value"&&"defaultValue"in y||u=="checked"&&"defaultChecked"in y)continue;ui(r,u,null,h,o)}}for(u in y)h=y[u],u=="children"?c=h:u=="dangerouslySetInnerHTML"?f=h:u=="value"?p=h:u=="checked"?v=h:s&&typeof h!="function"||g[u]===h||ui(r,u,h,g[u],o);if(f)s||d&&(f.__html==d.__html||f.__html==r.innerHTML)||(r.innerHTML=f.__html),t.__k=[];else if(d&&(r.innerHTML=""),hf(t.type=="template"?r.content:r,ti(c)?c:[c],t,e,n,w=="foreignObject"?"http://www.w3.org/1999/xhtml":o,i,a,i?i[0]:e.__k&&Hn(e,0),s,l),i!=null)for(u=i.length;u--;)_l(i[u]);s||(u="value",w=="progress"&&p==null?r.removeAttribute("value"):p!=null&&(p!==r[u]||w=="progress"&&!p||w=="option"&&p!=g[u])&&ui(r,u,p,g[u],o),u="checked",v!=null&&v!=r[u]&&ui(r,u,v,g[u],o))}return r}function wl(r,t,e){try{if(typeof r=="function"){var n=typeof r.__u=="function";n&&r.__u(),n&&t==null||(r.__u=r(t))}else r.current=t}catch(o){Ne.__e(o,e)}}function yf(r,t,e){var n,o;if(Ne.unmount&&Ne.unmount(r),(n=r.ref)&&(n.current&&n.current!=r.__e||wl(n,null,t)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){Ne.__e(i,t)}n.base=n.__P=null}if(n=r.__k)for(o=0;o<n.length;o++)n[o]&&yf(n[o],t,e||typeof r.type!="function");e||_l(r.__e),r.__c=r.__=r.__e=void 0}function lh(r,t,e){return this.constructor(r,e)}function uh(r,t,e){var n,o,i,a;t==document&&(t=document.documentElement),Ne.__&&Ne.__(r,t),o=(n=!1)?null:t.__k,i=[],a=[],xl(t,r=t.__k=ce(Xn,null,[r]),o||Bo,Bo,t.namespaceURI,o?null:t.firstChild?Ia.call(t.childNodes):null,i,o?o.__e:t.firstChild,n,a),vf(i,r,a)}Ia=ff.slice,Ne={__e:function(r,t,e,n){for(var o,i,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&i.getDerivedStateFromError!=null&&(o.setState(i.getDerivedStateFromError(r)),a=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(r,n||{}),a=o.__d),a)return o.__E=o}catch(s){r=s}throw r}},sf=0,De.prototype.setState=function(r,t){var e;e=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Rr({},this.state),typeof r=="function"&&(r=r(Rr({},e),this.props)),r&&Rr(e,r),r!=null&&this.__v&&(t&&this._sb.push(t),Fl(this))},De.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),Fl(this))},De.prototype.render=Xn,nn=[],lf=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,uf=function(r,t){return r.__v.__b-t.__v.__b},zi.__r=0,df=/(PointerCapture)$|Capture$/i,ml=0,Ss=Wl(!1),Os=Wl(!0);var dh="An invariant failed, however the error is obfuscated because this is a production build.",Fi=[];Object.freeze(Fi);var El={};Object.freeze(El);function Ht(){return++ie.mobxGuid}function We(r){throw dn(!1,r),"X"}function dn(r,t){if(!r)throw new Error("[mobx] "+(t||dh))}function mf(r){var t=!1;return function(){if(!t)return t=!0,r.apply(this,arguments)}}var di=function(){};function fh(r){var t=[];return r.forEach(function(e){t.indexOf(e)===-1&&t.push(e)}),t}function bl(r){return r!==null&&typeof r=="object"}function Qn(r){if(r===null||typeof r!="object")return!1;var t=Object.getPrototypeOf(r);return t===Object.prototype||t===null}function ch(r){if(to(r)||Gt(r))return r;if(Array.isArray(r))return new Map(r);if(Qn(r)){var t=new Map;for(var e in r)t.set(e,r[e]);return t}else return We("Cannot convert to map from '"+r+"'")}function eo(r,t,e){Object.defineProperty(r,t,{enumerable:!1,writable:!0,configurable:!0,value:e})}function hh(r,t,e){Object.defineProperty(r,t,{enumerable:!1,writable:!1,configurable:!0,value:e})}function ph(r,t){var e=Object.getOwnPropertyDescriptor(r,t);return!e||e.configurable!==!1&&e.writable!==!1}function Ur(r,t){var e="isMobX"+r;return t.prototype[e]=!0,function(n){return bl(n)&&n[e]===!0}}function to(r){return r instanceof Map}function ri(r){return r instanceof Set}function _f(r){var t=new Set;for(var e in r)t.add(e);return Object.getOwnPropertySymbols(r).forEach(function(n){Object.getOwnPropertyDescriptor(r,n).enumerable&&t.add(n)}),Array.from(t)}function Hr(r){return r&&r.toString?r.toString():new String(r).toString()}function xf(r){return r===null?null:typeof r=="object"?""+r:r}var vh=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames,we=Symbol("mobx administration"),ro=(function(){function r(t){t===void 0&&(t="Atom@"+Ht()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=Ve.NOT_TRACKING}return r.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},r.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},r.prototype.reportObserved=function(){return Pf(this)},r.prototype.reportChanged=function(){cr(),kh(this),hr()},r.prototype.toString=function(){return this.name},r})(),Sl=Ur("Atom",ro);function Ol(r,t,e){t===void 0&&(t=di),e===void 0&&(e=di);var n=new ro(r);return t!==di&&Zh(n,t),e!==di&&kf(n,e),n}function gh(r,t){return Uf(r,t)}function yh(r,t){return Object.is(r,t)}var Gn={structural:gh,default:yh};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var As=function(r,t){return As=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])},As(r,t)};function mh(r,t){As(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var $i=function(){return $i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},$i.apply(this,arguments)};function Sr(r){var t=typeof Symbol=="function"&&r[Symbol.iterator],e=0;return t?t.call(r):{next:function(){return r&&e>=r.length&&(r=void 0),{value:r&&r[e++],done:!r}}}}function Dn(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i}function Ml(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(Dn(arguments[t]));return r}var Wi=Symbol("mobx did run lazy initializers"),go=Symbol("mobx pending decorators"),_h={},xh={};function wh(r,t){var e=t?_h:xh;return e[r]||(e[r]={configurable:!0,enumerable:t,get:function(){return pn(this),this[r]},set:function(n){pn(this),this[r]=n}})}function pn(r){var t,e;if(r[Wi]!==!0){var n=r[go];if(n){eo(r,Wi,!0);var o=Ml(Object.getOwnPropertySymbols(n),Object.keys(n));try{for(var i=Sr(o),a=i.next();!a.done;a=i.next()){var s=a.value,l=n[s];l.propertyCreator(r,l.prop,l.descriptor,l.decoratorTarget,l.decoratorArguments)}}catch(u){t={error:u}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}}}function wf(r,t){return function(){var n,o=function(a,s,l,u){if(u===!0)return t(a,s,l,a,n),null;if(!Object.prototype.hasOwnProperty.call(a,go)){var f=a[go];eo(a,go,$i({},f))}return a[go][s]={prop:s,propertyCreator:t,descriptor:l,decoratorTarget:a,decoratorArguments:n},wh(s,r)};return Eh(arguments)?(n=Fi,o.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),o)}}function Eh(r){return(r.length===2||r.length===3)&&(typeof r[1]=="string"||typeof r[1]=="symbol")||r.length===4&&r[3]===!0}function ni(r,t,e){return $n(r)?r:Array.isArray(r)?I.array(r,{name:e}):Qn(r)?I.object(r,void 0,{name:e}):to(r)?I.map(r,{name:e}):ri(r)?I.set(r,{name:e}):r}function bh(r,t,e){return r==null||yr(r)||Cr(r)||Gt(r)||tr(r)?r:Array.isArray(r)?I.array(r,{name:e,deep:!1}):Qn(r)?I.object(r,void 0,{name:e,deep:!1}):to(r)?I.map(r,{name:e,deep:!1}):ri(r)?I.set(r,{name:e,deep:!1}):We(!1)}function Ba(r){return r}function Sh(r,t,e){return Uf(r,t)?t:r}function Xa(r){dn(r);var t=wf(!0,function(n,o,i,a,s){var l=i?i.initializer?i.initializer.call(n):i.value:void 0;Pl(n).addObservableProp(o,l,r)}),e=t;return e.enhancer=r,e}var Ef={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Ef);function Tn(r){return r==null?Ef:typeof r=="string"?{name:r,deep:!0,proxy:!0}:r}var Al=Xa(ni),Oh=Xa(bh),bf=Xa(Ba),Mh=Xa(Sh);function fi(r){return r.defaultDecorator?r.defaultDecorator.enhancer:r.deep===!1?Ba:ni}function Ah(r,t,e){if(typeof arguments[1]=="string"||typeof arguments[1]=="symbol")return Al.apply(null,arguments);if($n(r))return r;var n=Qn(r)?I.object(r,t,e):Array.isArray(r)?I.array(r,t):to(r)?I.map(r,t):ri(r)?I.set(r,t):r;if(n!==r)return n;We(!1)}var Ul={box:function(r,t){arguments.length>2&&co("box");var e=Tn(t);return new cn(r,fi(e),e.name,!0,e.equals)},array:function(r,t){arguments.length>2&&co("array");var e=Tn(t);return fp(r,fi(e),e.name)},map:function(r,t){arguments.length>2&&co("map");var e=Tn(t);return new Tl(r,fi(e),e.name)},set:function(r,t){arguments.length>2&&co("set");var e=Tn(t);return new $f(r,fi(e),e.name)},object:function(r,t,e){typeof arguments[1]=="string"&&co("object");var n=Tn(e);if(n.proxy===!1)return Rs({},r,t,n);var o=Xf(n),i=Rs({},void 0,void 0,n),a=lp(i);return Hf(a,r,t,o),a},ref:bf,shallow:Oh,deep:Al,struct:Mh},I=Ah;Object.keys(Ul).forEach(function(r){return I[r]=Ul[r]});function co(r){We("Expected one or two arguments to observable."+r+". Did you accidentally try to use observable."+r+" as decorator?")}var Ui=wf(!1,function(r,t,e,n,o){var i=e.get,a=e.set,s=o[0]||{};Pl(r).addComputedProp(r,t,$i({get:i,set:a,context:r},s))}),Nh=Ui({equals:Gn.structural}),et=function(t,e,n){if(typeof e=="string"||t!==null&&typeof t=="object"&&arguments.length===1)return Ui.apply(null,arguments);var o=typeof e=="object"?e:{};return o.get=t,o.set=typeof e=="function"?e:o.set,o.name=o.name||t.name||"",new Yn(o)};et.struct=Nh;var Ve;(function(r){r[r.NOT_TRACKING=-1]="NOT_TRACKING",r[r.UP_TO_DATE=0]="UP_TO_DATE",r[r.POSSIBLY_STALE=1]="POSSIBLY_STALE",r[r.STALE=2]="STALE"})(Ve||(Ve={}));var Or;(function(r){r[r.NONE=0]="NONE",r[r.LOG=1]="LOG",r[r.BREAK=2]="BREAK"})(Or||(Or={}));var Vi=(function(){function r(t){this.cause=t}return r})();function yo(r){return r instanceof Vi}function Ns(r){switch(r.dependenciesState){case Ve.UP_TO_DATE:return!1;case Ve.NOT_TRACKING:case Ve.STALE:return!0;case Ve.POSSIBLY_STALE:{for(var t=Nl(!0),e=no(),n=r.observing,o=n.length,i=0;i<o;i++){var a=n[i];if(Fn(a)){if(ie.disableErrorBoundaries)a.get();else try{a.get()}catch{return Yr(e),xo(t),!0}if(r.dependenciesState===Ve.STALE)return Yr(e),xo(t),!0}}return Mf(r),Yr(e),xo(t),!1}}}function zn(r){var t=r.observers.size>0;ie.computationDepth>0&&t&&We(!1),!ie.allowStateChanges&&(t||ie.enforceActions==="strict")&&We(!1)}function Sf(r,t,e){var n=Nl(!0);Mf(r),r.newObserving=new Array(r.observing.length+100),r.unboundDepsCount=0,r.runId=++ie.runId;var o=ie.trackingDerivation;ie.trackingDerivation=r;var i;if(ie.disableErrorBoundaries===!0)i=t.call(e);else try{i=t.call(e)}catch(a){i=new Vi(a)}return ie.trackingDerivation=o,Ch(r),xo(n),i}function Ch(r){for(var t=r.observing,e=r.observing=r.newObserving,n=Ve.UP_TO_DATE,o=0,i=r.unboundDepsCount,a=0;a<i;a++){var s=e[a];s.diffValue===0&&(s.diffValue=1,o!==a&&(e[o]=s),o++),s.dependenciesState>n&&(n=s.dependenciesState)}for(e.length=o,r.newObserving=null,i=t.length;i--;){var s=t[i];s.diffValue===0&&Cf(s,r),s.diffValue=0}for(;o--;){var s=e[o];s.diffValue===1&&(s.diffValue=0,Ih(s,r))}n!==Ve.UP_TO_DATE&&(r.dependenciesState=n,r.onBecomeStale())}function Cs(r){var t=r.observing;r.observing=[];for(var e=t.length;e--;)Cf(t[e],r);r.dependenciesState=Ve.NOT_TRACKING}function Of(r){var t=no();try{return r()}finally{Yr(t)}}function no(){var r=ie.trackingDerivation;return ie.trackingDerivation=null,r}function Yr(r){ie.trackingDerivation=r}function Nl(r){var t=ie.allowStateReads;return ie.allowStateReads=r,t}function xo(r){ie.allowStateReads=r}function Mf(r){if(r.dependenciesState!==Ve.UP_TO_DATE){r.dependenciesState=Ve.UP_TO_DATE;for(var t=r.observing,e=t.length;e--;)t[e].lowestObserverState=Ve.UP_TO_DATE}}var Ki=0,Th=1,Vl=Object.getOwnPropertyDescriptor(function(){},"name");Vl&&Vl.configurable;function fn(r,t,e){var n=function(){return Af(r,t,e||this,arguments)};return n.isMobxAction=!0,n}function Af(r,t,e,n){var o=Ph();try{return t.apply(e,n)}catch(i){throw o.error=i,i}finally{Dh(o)}}function Ph(r,t,e){var n=Qt(),o=0,i=no();cr();var a=Ha(!0),s=Nl(!0),l={prevDerivation:i,prevAllowStateChanges:a,prevAllowStateReads:s,notifySpy:n,startTime:o,actionId:Th++,parentActionId:Ki};return Ki=l.actionId,l}function Dh(r){Ki!==r.actionId&&We("invalid action stack. did you forget to finish an action?"),Ki=r.parentActionId,r.error!==void 0&&(ie.suppressReactionErrors=!0),Ga(r.prevAllowStateChanges),xo(r.prevAllowStateReads),hr(),Yr(r.prevDerivation),r.notifySpy,ie.suppressReactionErrors=!1}function Ha(r){var t=ie.allowStateChanges;return ie.allowStateChanges=r,t}function Ga(r){ie.allowStateChanges=r}var cn=(function(r){mh(t,r);function t(e,n,o,i,a){o===void 0&&(o="ObservableValue@"+Ht()),a===void 0&&(a=Gn.default);var s=r.call(this,o)||this;return s.enhancer=n,s.name=o,s.equals=a,s.hasUnreportedChange=!1,s.value=n(e,void 0,o),s}return t.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},t.prototype.set=function(e){this.value,e=this.prepareNewValue(e),e!==ie.UNCHANGED&&this.setNewValue(e)},t.prototype.prepareNewValue=function(e){if(zn(this),Mr(this)){var n=Ar(this,{object:this,type:"update",newValue:e});if(!n)return ie.UNCHANGED;e=n.newValue}return e=this.enhancer(e,this.value,this.name),this.equals(this.value,e)?ie.UNCHANGED:e},t.prototype.setNewValue=function(e){var n=this.value;this.value=e,this.reportChanged(),pr(this)&&vr(this,{type:"update",object:this,newValue:e,oldValue:n})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(e){return oi(this,e)},t.prototype.observe=function(e,n){return n&&e({object:this,type:"update",newValue:this.value,oldValue:void 0}),ii(this,e)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return xf(this.get())},t.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},t})(ro),Rh=Ur("ObservableValue",cn),Yn=(function(){function r(t){this.dependenciesState=Ve.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=Ve.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Ht(),this.value=new Vi(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=Or.NONE,dn(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+Ht(),t.set&&(this.setter=fn(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?Gn.structural:Gn.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return r.prototype.onBecomeStale=function(){Xh(this)},r.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},r.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},r.prototype.get=function(){this.isComputing&&We("Cycle detected in computation "+this.name+": "+this.derivation),ie.inBatch===0&&this.observers.size===0&&!this.keepAlive?Ns(this)&&(this.warnAboutUntrackedRead(),cr(),this.value=this.computeValue(!1),hr()):(Pf(this),Ns(this)&&this.trackAndCompute()&&Bh(this));var t=this.value;if(yo(t))throw t.cause;return t},r.prototype.peek=function(){var t=this.computeValue(!1);if(yo(t))throw t.cause;return t},r.prototype.set=function(t){if(this.setter){dn(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else dn(!1,!1)},r.prototype.trackAndCompute=function(){var t=this.value,e=this.dependenciesState===Ve.NOT_TRACKING,n=this.computeValue(!0),o=e||yo(t)||yo(n)||!this.equals(t,n);return o&&(this.value=n),o},r.prototype.computeValue=function(t){this.isComputing=!0,ie.computationDepth++;var e;if(t)e=Sf(this,this.derivation,this.scope);else if(ie.disableErrorBoundaries===!0)e=this.derivation.call(this.scope);else try{e=this.derivation.call(this.scope)}catch(n){e=new Vi(n)}return ie.computationDepth--,this.isComputing=!1,e},r.prototype.suspend=function(){this.keepAlive||(Cs(this),this.value=void 0)},r.prototype.observe=function(t,e){var n=this,o=!0,i=void 0;return Uh(function(){var a=n.get();if(!o||e){var s=no();t({type:"update",object:n,newValue:a,oldValue:i}),Yr(s)}o=!1,i=a})},r.prototype.warnAboutUntrackedRead=function(){},r.prototype.toJSON=function(){return this.get()},r.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},r.prototype.valueOf=function(){return xf(this.get())},r.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},r})(),Fn=Ur("ComputedValue",Yn),ji=(function(){function r(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return r})(),Lh={};function Ts(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:Lh}var Ii=!0,Nf=!1,ie=(function(){var r=Ts();return r.__mobxInstanceCount>0&&!r.__mobxGlobals&&(Ii=!1),r.__mobxGlobals&&r.__mobxGlobals.version!==new ji().version&&(Ii=!1),Ii?r.__mobxGlobals?(r.__mobxInstanceCount+=1,r.__mobxGlobals.UNCHANGED||(r.__mobxGlobals.UNCHANGED={}),r.__mobxGlobals):(r.__mobxInstanceCount=1,r.__mobxGlobals=new ji):(setTimeout(function(){Nf||We("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new ji)})();function jh(){(ie.pendingReactions.length||ie.inBatch||ie.isRunningReactions)&&We("isolateGlobalState should be called before MobX is running any reactions"),Nf=!0,Ii&&(--Ts().__mobxInstanceCount===0&&(Ts().__mobxGlobals=void 0),ie=new ji)}function Ps(){return ie}function Ih(r,t){r.observers.add(t),r.lowestObserverState>t.dependenciesState&&(r.lowestObserverState=t.dependenciesState)}function Cf(r,t){r.observers.delete(t),r.observers.size===0&&Tf(r)}function Tf(r){r.isPendingUnobservation===!1&&(r.isPendingUnobservation=!0,ie.pendingUnobservations.push(r))}function cr(){ie.inBatch++}function hr(){if(--ie.inBatch===0){Lf();for(var r=ie.pendingUnobservations,t=0;t<r.length;t++){var e=r[t];e.isPendingUnobservation=!1,e.observers.size===0&&(e.isBeingObserved&&(e.isBeingObserved=!1,e.onBecomeUnobserved()),e instanceof Yn&&e.suspend())}ie.pendingUnobservations=[]}}function Pf(r){var t=ie.trackingDerivation;return t!==null?(t.runId!==r.lastAccessedBy&&(r.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=r,r.isBeingObserved||(r.isBeingObserved=!0,r.onBecomeObserved())),!0):(r.observers.size===0&&ie.inBatch>0&&Tf(r),!1)}function kh(r){r.lowestObserverState!==Ve.STALE&&(r.lowestObserverState=Ve.STALE,r.observers.forEach(function(t){t.dependenciesState===Ve.UP_TO_DATE&&(t.isTracing!==Or.NONE&&Df(t,r),t.onBecomeStale()),t.dependenciesState=Ve.STALE}))}function Bh(r){r.lowestObserverState!==Ve.STALE&&(r.lowestObserverState=Ve.STALE,r.observers.forEach(function(t){t.dependenciesState===Ve.POSSIBLY_STALE?t.dependenciesState=Ve.STALE:t.dependenciesState===Ve.UP_TO_DATE&&(r.lowestObserverState=Ve.UP_TO_DATE)}))}function Xh(r){r.lowestObserverState===Ve.UP_TO_DATE&&(r.lowestObserverState=Ve.POSSIBLY_STALE,r.observers.forEach(function(t){t.dependenciesState===Ve.UP_TO_DATE&&(t.dependenciesState=Ve.POSSIBLY_STALE,t.isTracing!==Or.NONE&&Df(t,r),t.onBecomeStale())}))}function Df(r,t){if(""+r.name+t.name,r.isTracing===Or.BREAK){var e=[];Rf(Jh(r),e,1),new Function(`debugger;
/*
Tracing '`+r.name+`'

You are entering this break point because derivation '`+r.name+"' is being traced and '"+t.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(r instanceof Yn?r.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+e.join(`
`)+`
*/
    `)()}}function Rf(r,t,e){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(e).join("	")+r.name),r.dependencies&&r.dependencies.forEach(function(n){return Rf(n,t,e+1)})}var Xo=(function(){function r(t,e,n,o){t===void 0&&(t="Reaction@"+Ht()),o===void 0&&(o=!1),this.name=t,this.onInvalidate=e,this.errorHandler=n,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=Ve.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Ht(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=Or.NONE}return r.prototype.onBecomeStale=function(){this.schedule()},r.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,ie.pendingReactions.push(this),Lf())},r.prototype.isScheduled=function(){return this._isScheduled},r.prototype.runReaction=function(){if(!this.isDisposed){if(cr(),this._isScheduled=!1,Ns(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&Qt()}catch(t){this.reportExceptionInDerivation(t)}}hr()}},r.prototype.track=function(t){if(!this.isDisposed){cr(),this._isRunning=!0;var e=Sf(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&Cs(this),yo(e)&&this.reportExceptionInDerivation(e.cause),hr()}},r.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler){this.errorHandler(t,this);return}if(ie.disableErrorBoundaries)throw t;var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";ie.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(n,t),ie.globalReactionErrorHandlers.forEach(function(o){return o(t,e)})},r.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(cr(),Cs(this),hr()))},r.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t[we]=this,t},r.prototype.toString=function(){return"Reaction["+this.name+"]"},r.prototype.trace=function(t){t===void 0&&(t=!1),ip(this,t)},r})(),Kl=100,Ds=function(r){return r()};function Lf(){ie.inBatch>0||ie.isRunningReactions||Ds(Hh)}function Hh(){ie.isRunningReactions=!0;for(var r=ie.pendingReactions,t=0;r.length>0;){++t===Kl&&(console.error("Reaction doesn't converge to a stable state after "+Kl+" iterations."+(" Probably there is a cycle in the reactive function: "+r[0])),r.splice(0));for(var e=r.splice(0),n=0,o=e.length;n<o;n++)e[n].runReaction()}ie.isRunningReactions=!1}var Zi=Ur("Reaction",Xo);function Gh(r){var t=Ds;Ds=function(e){return r(function(){return t(e)})}}function Qt(){return!1}function zh(r){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}function Yh(){We(!1)}function Zl(r){return function(t,e,n){if(n){if(n.value)return{value:fn(r,n.value),enumerable:!1,configurable:!0,writable:!0};var o=n.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return fn(r,o.call(this))}}}return Fh(r).apply(this,arguments)}}function Fh(r){return function(t,e,n){Object.defineProperty(t,e,{configurable:!0,enumerable:!1,get:function(){},set:function(o){eo(this,e,L(r,o))}})}}function $h(r,t,e,n){return n===!0?(Ja(r,t,e.value),null):e?{configurable:!0,enumerable:!1,get:function(){return Ja(this,t,e.value||e.initializer.call(this)),this[t]},set:Yh}:{enumerable:!1,configurable:!0,set:function(o){Ja(this,t,o)},get:function(){}}}var L=function(t,e,n,o){if(arguments.length===1&&typeof t=="function")return fn(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof e=="function")return fn(t,e);if(arguments.length===1&&typeof t=="string")return Zl(t);if(o===!0)eo(t,e,fn(t.name||e,n.value,this));else return Zl(e).apply(null,arguments)};L.bound=$h;function Wh(r,t){var e=typeof r=="string"?r:r.name||"<unnamed action>",n=typeof r=="function"?r:t;return Af(e,n,this,void 0)}function Ja(r,t,e){eo(r,t,fn(t,e.bind(r)))}function Uh(r,t){t===void 0&&(t=El);var e=t&&t.name||r.name||"Autorun@"+Ht(),n=!t.scheduler&&!t.delay,o;if(n)o=new Xo(e,function(){this.track(s)},t.onError,t.requiresObservable);else{var i=jf(t),a=!1;o=new Xo(e,function(){a||(a=!0,i(function(){a=!1,o.isDisposed||o.track(s)}))},t.onError,t.requiresObservable)}function s(){r(o)}return o.schedule(),o.getDisposer()}var Vh=function(r){return r()};function jf(r){return r.scheduler?r.scheduler:r.delay?function(t){return setTimeout(t,r.delay)}:Vh}function If(r,t,e){e===void 0&&(e=El);var n=e.name||"Reaction@"+Ht(),o=L(n,e.onError?Kh(e.onError,t):t),i=!e.scheduler&&!e.delay,a=jf(e),s=!0,l=!1,u,f=e.compareStructural?Gn.structural:e.equals||Gn.default,d=new Xo(n,function(){s||i?c():l||(l=!0,a(c))},e.onError,e.requiresObservable);function c(){if(l=!1,!d.isDisposed){var h=!1;d.track(function(){var p=r(d);h=s||!f(u,p),u=p}),s&&e.fireImmediately&&o(u,d),!s&&h===!0&&o(u,d),s&&(s=!1)}}return d.schedule(),d.getDisposer()}function Kh(r,t){return function(){try{return t.apply(this,arguments)}catch(e){r.call(this,e)}}}function Zh(r,t,e){return Bf("onBecomeObserved",r,t)}function kf(r,t,e){return Bf("onBecomeUnobserved",r,t)}function Bf(r,t,e,n){var o=$r(t),i=e,a=r+"Listeners";o[a]?o[a].add(i):o[a]=new Set([i]);var s=o[r];return typeof s!="function"?We(!1):function(){var l=o[a];l&&(l.delete(i),l.size===0&&delete o[a])}}function qh(r){var t=r.enforceActions,e=r.computedRequiresReaction,n=r.computedConfigurable,o=r.disableErrorBoundaries,i=r.reactionScheduler,a=r.reactionRequiresObservable,s=r.observableRequiresReaction;if(jh(),t!==void 0){var l=void 0;switch(t){case!0:case"observed":l=!0;break;case!1:case"never":l=!1;break;case"strict":case"always":l="strict";break;default:We("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}ie.enforceActions=l,ie.allowStateChanges=!(l===!0||l==="strict")}e!==void 0&&(ie.computedRequiresReaction=!!e),a!==void 0&&(ie.reactionRequiresObservable=!!a),s!==void 0&&(ie.observableRequiresReaction=!!s,ie.allowStateReads=!ie.observableRequiresReaction),n!==void 0&&(ie.computedConfigurable=!!n),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."),ie.disableErrorBoundaries=!!o),i&&Gh(i)}function Rs(r,t,e,n){n=Tn(n);var o=Xf(n);return pn(r),Pl(r,n.name,o.enhancer),t&&Hf(r,t,e,o),r}function Xf(r){return r.defaultDecorator||(r.deep===!1?bf:Al)}function Hf(r,t,e,n){var o,i,a,s,l,u;cr();try{var a=vh(t);try{for(var f=Sr(a),d=f.next();!d.done;d=f.next()){var u=d.value,c=Object.getOwnPropertyDescriptor(t,u),h=e&&u in e?e[u]:c.get?Ui:n,p=h(r,u,c,!0);p&&Object.defineProperty(r,u,p)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}finally{hr()}}function Jh(r,t){return Gf($r(r,t))}function Gf(r){var t={name:r.name};return r.observing&&r.observing.length>0&&(t.dependencies=fh(r.observing).map(Gf)),t}function zf(r,t){if(r==null)return!1;if(t!==void 0){if(yr(r)===!1||!r[we].values.has(t))return!1;var e=$r(r,t);return Fn(e)}return Fn(r)}function Qh(r){return arguments.length>1?We(!1):zf(r)}function ql(r,t){return typeof t!="string"?We(!1):zf(r,t)}function ep(r,t){return r==null?!1:yr(r)||!!r[we]||Sl(r)||Zi(r)||Fn(r)}function $n(r){return arguments.length!==1&&We(!1),ep(r)}function Wn(r){return yr(r)?r[we].getKeys():Gt(r)||tr(r)?Array.from(r.keys()):Cr(r)?r.map(function(t,e){return e}):We(!1)}function tp(r){return yr(r)?Wn(r).map(function(t){return r[t]}):Gt(r)?Wn(r).map(function(t){return r.get(t)}):tr(r)?Array.from(r.values()):Cr(r)?r.slice():We(!1)}function rp(r){return yr(r)?Wn(r).map(function(t){return[t,r[t]]}):Gt(r)?Wn(r).map(function(t){return[t,r.get(t)]}):tr(r)?Array.from(r.entries()):Cr(r)?r.map(function(t,e){return[e,t]}):We(!1)}function Cl(r,t,e){if(arguments.length===2&&!tr(r)){cr();var n=t;try{for(var o in n)Cl(r,o,n[o])}finally{hr()}return}if(yr(r)){var i=r[we],a=i.values.get(t);a?i.write(t,e):i.addObservableProp(t,e,i.defaultEnhancer)}else if(Gt(r))r.set(t,e);else if(tr(r))r.add(t);else if(Cr(r))typeof t!="number"&&(t=parseInt(t,10)),dn(t>=0,"Not a valid index: '"+t+"'"),cr(),t>=r.length&&(r.length=t+1),r[t]=e,hr();else return We(!1)}function Yf(r,t,e,n){return np(r,t,e)}function np(r,t,e){return za(r).observe(t,e)}var op={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function wn(r,t,e,n){return n.detectCycles&&r.set(t,e),e}function Ir(r,t,e){if(!t.recurseEverything&&!$n(r)||typeof r!="object")return r;if(r===null)return null;if(r instanceof Date)return r;if(Rh(r))return Ir(r.get(),t,e);$n(r)&&Wn(r);var n=t.detectCycles===!0;if(n&&r!==null&&e.has(r))return e.get(r);if(Cr(r)||Array.isArray(r)){var o=wn(e,r,[],t),i=r.map(function(h){return Ir(h,t,e)});o.length=i.length;for(var a=0,s=i.length;a<s;a++)o[a]=i[a];return o}if(tr(r)||Object.getPrototypeOf(r)===Set.prototype)if(t.exportMapsAsObjects===!1){var l=wn(e,r,new Set,t);return r.forEach(function(h){l.add(Ir(h,t,e))}),l}else{var u=wn(e,r,[],t);return r.forEach(function(h){u.push(Ir(h,t,e))}),u}if(Gt(r)||Object.getPrototypeOf(r)===Map.prototype)if(t.exportMapsAsObjects===!1){var f=wn(e,r,new Map,t);return r.forEach(function(h,p){f.set(p,Ir(h,t,e))}),f}else{var d=wn(e,r,{},t);return r.forEach(function(h,p){d[p]=Ir(h,t,e)}),d}var c=wn(e,r,{},t);return _f(r).forEach(function(h){c[h]=Ir(r[h],t,e)}),c}function lr(r,t){typeof t=="boolean"&&(t={detectCycles:t}),t||(t=op),t.detectCycles=t.detectCycles===void 0?t.recurseEverything===!0:t.detectCycles===!0;var e;return t.detectCycles&&(e=new Map),Ir(r,t,e)}function ip(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=!1;typeof r[r.length-1]=="boolean"&&(e=r.pop());var n=ap(r);if(!n)return We(!1);n.isTracing===Or.NONE&&""+n.name,n.isTracing=e?Or.BREAK:Or.LOG}function ap(r){switch(r.length){case 0:return ie.trackingDerivation;case 1:return $r(r[0]);case 2:return $r(r[0],r[1])}}function dr(r,t){t===void 0&&(t=void 0),cr();try{return r.apply(t)}finally{hr()}}function ci(r){return r[we]}function hi(r){return typeof r=="string"||typeof r=="number"||typeof r=="symbol"}var sp={has:function(r,t){if(t===we||t==="constructor"||t===Wi)return!0;var e=ci(r);return hi(t)?e.has(t):t in r},get:function(r,t){if(t===we||t==="constructor"||t===Wi)return r[t];var e=ci(r),n=e.values.get(t);if(n instanceof ro){var o=n.get();return o===void 0&&e.has(t),o}return hi(t)&&e.has(t),r[t]},set:function(r,t,e){return hi(t)?(Cl(r,t,e),!0):!1},deleteProperty:function(r,t){if(!hi(t))return!1;var e=ci(r);return e.remove(t),!0},ownKeys:function(r){var t=ci(r);return t.keysAtom.reportObserved(),Reflect.ownKeys(r)},preventExtensions:function(r){return We("Dynamic observable objects cannot be frozen"),!1}};function lp(r){var t=new Proxy(r,sp);return r[we].proxy=t,t}function Mr(r){return r.interceptors!==void 0&&r.interceptors.length>0}function oi(r,t){var e=r.interceptors||(r.interceptors=[]);return e.push(t),mf(function(){var n=e.indexOf(t);n!==-1&&e.splice(n,1)})}function Ar(r,t){var e=no();try{for(var n=Ml(r.interceptors||[]),o=0,i=n.length;o<i&&(t=n[o](t),dn(!t||t.type,"Intercept handlers should return nothing or a change object"),!!t);o++);return t}finally{Yr(e)}}function pr(r){return r.changeListeners!==void 0&&r.changeListeners.length>0}function ii(r,t){var e=r.changeListeners||(r.changeListeners=[]);return e.push(t),mf(function(){var n=e.indexOf(t);n!==-1&&e.splice(n,1)})}function vr(r,t){var e=no(),n=r.changeListeners;if(n){n=n.slice();for(var o=0,i=n.length;o<i;o++)n[o](t);Yr(e)}}var up=1e4,dp={get:function(r,t){return t===we?r[we]:t==="length"?r[we].getArrayLength():typeof t=="number"?Dr.get.call(r,t):typeof t=="string"&&!isNaN(t)?Dr.get.call(r,parseInt(t)):Dr.hasOwnProperty(t)?Dr[t]:r[t]},set:function(r,t,e){return t==="length"&&r[we].setArrayLength(e),typeof t=="number"&&Dr.set.call(r,t,e),typeof t=="symbol"||isNaN(t)?r[t]=e:Dr.set.call(r,parseInt(t),e),!0},preventExtensions:function(r){return We("Observable arrays cannot be frozen"),!1}};function fp(r,t,e,n){e===void 0&&(e="ObservableArray@"+Ht()),n===void 0&&(n=!1);var o=new Ff(e,t,n);hh(o.values,we,o);var i=new Proxy(o.values,dp);if(o.proxy=i,r&&r.length){var a=Ha(!0);o.spliceWithArray(0,0,r),Ga(a)}return i}var Ff=(function(){function r(t,e,n){this.owned=n,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new ro(t||"ObservableArray@"+Ht()),this.enhancer=function(o,i){return e(o,i,t+"[..]")}}return r.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},r.prototype.dehanceValues=function(t){return this.dehancer!==void 0&&t.length>0?t.map(this.dehancer):t},r.prototype.intercept=function(t){return oi(this,t)},r.prototype.observe=function(t,e){return e===void 0&&(e=!1),e&&t({object:this.proxy,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),ii(this,t)},r.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},r.prototype.setArrayLength=function(t){if(typeof t!="number"||t<0)throw new Error("[mobx.array] Out of range: "+t);var e=this.values.length;if(t!==e)if(t>e){for(var n=new Array(t-e),o=0;o<t-e;o++)n[o]=void 0;this.spliceWithArray(e,0,n)}else this.spliceWithArray(t,e-t)},r.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");this.lastKnownLength+=e},r.prototype.spliceWithArray=function(t,e,n){var o=this;zn(this.atom);var i=this.values.length;if(t===void 0?t=0:t>i?t=i:t<0&&(t=Math.max(0,i+t)),arguments.length===1?e=i-t:e==null?e=0:e=Math.max(0,Math.min(e,i-t)),n===void 0&&(n=Fi),Mr(this)){var a=Ar(this,{object:this.proxy,type:"splice",index:t,removedCount:e,added:n});if(!a)return Fi;e=a.removedCount,n=a.added}n=n.length===0?n:n.map(function(l){return o.enhancer(l,void 0)});var s=this.spliceItemsIntoValues(t,e,n);return(e!==0||n.length!==0)&&this.notifyArraySplice(t,n,s),this.dehanceValues(s)},r.prototype.spliceItemsIntoValues=function(t,e,n){var o;if(n.length<up)return(o=this.values).splice.apply(o,Ml([t,e],n));var i=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(n,this.values.slice(t+e)),i},r.prototype.notifyArrayChildUpdate=function(t,e,n){var o=!this.owned&&Qt(),i=pr(this),a=i||o?{object:this.proxy,type:"update",index:t,newValue:e,oldValue:n}:null;this.atom.reportChanged(),i&&vr(this,a)},r.prototype.notifyArraySplice=function(t,e,n){var o=!this.owned&&Qt(),i=pr(this),a=i||o?{object:this.proxy,type:"splice",index:t,removed:n,added:e,removedCount:n.length,addedCount:e.length}:null;this.atom.reportChanged(),i&&vr(this,a)},r})(),Dr={intercept:function(r){return this[we].intercept(r)},observe:function(r,t){t===void 0&&(t=!1);var e=this[we];return e.observe(r,t)},clear:function(){return this.splice(0)},replace:function(r){var t=this[we];return t.spliceWithArray(0,t.values.length,r)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(r,t){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var o=this[we];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray(r);case 2:return o.spliceWithArray(r,t)}return o.spliceWithArray(r,t,e)},spliceWithArray:function(r,t,e){var n=this[we];return n.spliceWithArray(r,t,e)},push:function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=this[we];return e.spliceWithArray(e.values.length,0,r),e.values.length},pop:function(){return this.splice(Math.max(this[we].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=this[we];return e.spliceWithArray(0,0,r),e.values.length},reverse:function(){var r=this.slice();return r.reverse.apply(r,arguments)},sort:function(r){var t=this.slice();return t.sort.apply(t,arguments)},remove:function(r){var t=this[we],e=t.dehanceValues(t.values).indexOf(r);return e>-1?(this.splice(e,1),!0):!1},get:function(r){var t=this[we];if(t){if(r<t.values.length)return t.atom.reportObserved(),t.dehanceValue(t.values[r]);console.warn("[mobx.array] Attempt to read an array index ("+r+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},set:function(r,t){var e=this[we],n=e.values;if(r<n.length){zn(e.atom);var o=n[r];if(Mr(e)){var i=Ar(e,{type:"update",object:e.proxy,index:r,newValue:t});if(!i)return;t=i.newValue}t=e.enhancer(t,o);var a=t!==o;a&&(n[r]=t,e.notifyArrayChildUpdate(r,t,o))}else if(r===n.length)e.spliceWithArray(r,0,[t]);else throw new Error("[mobx.array] Index out of bounds, "+r+" is larger than "+n.length)}};["concat","flat","includes","indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(r){typeof Array.prototype[r]=="function"&&(Dr[r]=function(){var t=this[we];t.atom.reportObserved();var e=t.dehanceValues(t.values);return e[r].apply(e,arguments)})});["every","filter","find","findIndex","flatMap","forEach","map","some"].forEach(function(r){typeof Array.prototype[r]=="function"&&(Dr[r]=function(t,e){var n=this,o=this[we];o.atom.reportObserved();var i=o.dehanceValues(o.values);return i[r](function(a,s){return t.call(e,a,s,n)},e)})});["reduce","reduceRight"].forEach(function(r){Dr[r]=function(){var t=this,e=this[we];e.atom.reportObserved();var n=arguments[0];return arguments[0]=function(o,i,a){return i=e.dehanceValue(i),n(o,i,a,t)},e.values[r].apply(e.values,arguments)}});var cp=Ur("ObservableArrayAdministration",Ff);function Cr(r){return bl(r)&&cp(r[we])}var Jl,hp={},Tl=(function(){function r(t,e,n){if(e===void 0&&(e=ni),n===void 0&&(n="ObservableMap@"+Ht()),this.enhancer=e,this.name=n,this[Jl]=hp,this._keysAtom=Ol(this.name+".keys()"),this[Symbol.toStringTag]="Map",typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return r.prototype._has=function(t){return this._data.has(t)},r.prototype.has=function(t){var e=this;if(!ie.trackingDerivation)return this._has(t);var n=this._hasMap.get(t);if(!n){var o=n=new cn(this._has(t),Ba,this.name+"."+Hr(t)+"?",!1);this._hasMap.set(t,o),kf(o,function(){return e._hasMap.delete(t)})}return n.get()},r.prototype.set=function(t,e){var n=this._has(t);if(Mr(this)){var o=Ar(this,{type:n?"update":"add",object:this,newValue:e,name:t});if(!o)return this;e=o.newValue}return n?this._updateValue(t,e):this._addValue(t,e),this},r.prototype.delete=function(t){var e=this;if(zn(this._keysAtom),Mr(this)){var n=Ar(this,{type:"delete",object:this,name:t});if(!n)return!1}if(this._has(t)){var o=Qt(),i=pr(this),n=i||o?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return dr(function(){e._keysAtom.reportChanged(),e._updateHasMapEntry(t,!1);var s=e._data.get(t);s.setNewValue(void 0),e._data.delete(t)}),i&&vr(this,n),!0}return!1},r.prototype._updateHasMapEntry=function(t,e){var n=this._hasMap.get(t);n&&n.setNewValue(e)},r.prototype._updateValue=function(t,e){var n=this._data.get(t);if(e=n.prepareNewValue(e),e!==ie.UNCHANGED){var o=Qt(),i=pr(this),a=i||o?{type:"update",object:this,oldValue:n.value,name:t,newValue:e}:null;n.setNewValue(e),i&&vr(this,a)}},r.prototype._addValue=function(t,e){var n=this;zn(this._keysAtom),dr(function(){var s=new cn(e,n.enhancer,n.name+"."+Hr(t),!1);n._data.set(t,s),e=s.value,n._updateHasMapEntry(t,!0),n._keysAtom.reportChanged()});var o=Qt(),i=pr(this),a=i||o?{type:"add",object:this,name:t,newValue:e}:null;i&&vr(this,a)},r.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},r.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},r.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},r.prototype.values=function(){var t=this,e=this.keys();return qi({next:function(){var n=e.next(),o=n.done,i=n.value;return{done:o,value:o?void 0:t.get(i)}}})},r.prototype.entries=function(){var t=this,e=this.keys();return qi({next:function(){var n=e.next(),o=n.done,i=n.value;return{done:o,value:o?void 0:[i,t.get(i)]}}})},r.prototype[Jl=we,Symbol.iterator]=function(){return this.entries()},r.prototype.forEach=function(t,e){var n,o;try{for(var i=Sr(this),a=i.next();!a.done;a=i.next()){var s=Dn(a.value,2),l=s[0],u=s[1];t.call(e,u,l,this)}}catch(f){n={error:f}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},r.prototype.merge=function(t){var e=this;return Gt(t)&&(t=t.toJS()),dr(function(){var n=Ha(!0);try{Qn(t)?_f(t).forEach(function(o){return e.set(o,t[o])}):Array.isArray(t)?t.forEach(function(o){var i=Dn(o,2),a=i[0],s=i[1];return e.set(a,s)}):to(t)?(t.constructor!==Map&&We("Cannot initialize from classes that inherit from Map: "+t.constructor.name),t.forEach(function(o,i){return e.set(i,o)})):t!=null&&We("Cannot initialize map from "+t)}finally{Ga(n)}}),this},r.prototype.clear=function(){var t=this;dr(function(){Of(function(){var e,n;try{for(var o=Sr(t.keys()),i=o.next();!i.done;i=o.next()){var a=i.value;t.delete(a)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}})})},r.prototype.replace=function(t){var e=this;return dr(function(){var n,o,i,a,s=ch(t),l=new Map,u=!1;try{for(var f=Sr(e._data.keys()),d=f.next();!d.done;d=f.next()){var c=d.value;if(!s.has(c)){var h=e.delete(c);if(h)u=!0;else{var p=e._data.get(c);l.set(c,p)}}}}catch(T){n={error:T}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}try{for(var v=Sr(s.entries()),g=v.next();!g.done;g=v.next()){var y=Dn(g.value,2),c=y[0],p=y[1],w=e._data.has(c);if(e.set(c,p),e._data.has(c)){var M=e._data.get(c);l.set(c,M),w||(u=!0)}}}catch(T){i={error:T}}finally{try{g&&!g.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}if(!u)if(e._data.size!==l.size)e._keysAtom.reportChanged();else for(var C=e._data.keys(),P=l.keys(),S=C.next(),E=P.next();!S.done;){if(S.value!==E.value){e._keysAtom.reportChanged();break}S=C.next(),E=P.next()}e._data=l}),this},Object.defineProperty(r.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),r.prototype.toPOJO=function(){var t,e,n={};try{for(var o=Sr(this),i=o.next();!i.done;i=o.next()){var a=Dn(i.value,2),s=a[0],l=a[1];n[typeof s=="symbol"?s:Hr(s)]=l}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},r.prototype.toJS=function(){return new Map(this)},r.prototype.toJSON=function(){return this.toPOJO()},r.prototype.toString=function(){var t=this;return this.name+"[{ "+Array.from(this.keys()).map(function(e){return Hr(e)+": "+(""+t.get(e))}).join(", ")+" }]"},r.prototype.observe=function(t,e){return ii(this,t)},r.prototype.intercept=function(t){return oi(this,t)},r})(),Gt=Ur("ObservableMap",Tl),Ql,pp={},$f=(function(){function r(t,e,n){if(e===void 0&&(e=ni),n===void 0&&(n="ObservableSet@"+Ht()),this.name=n,this[Ql]=pp,this._data=new Set,this._atom=Ol(this.name),this[Symbol.toStringTag]="Set",typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,i){return e(o,i,n)},t&&this.replace(t)}return r.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},r.prototype.clear=function(){var t=this;dr(function(){Of(function(){var e,n;try{for(var o=Sr(t._data.values()),i=o.next();!i.done;i=o.next()){var a=i.value;t.delete(a)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}})})},r.prototype.forEach=function(t,e){var n,o;try{for(var i=Sr(this),a=i.next();!a.done;a=i.next()){var s=a.value;t.call(e,s,s,this)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},Object.defineProperty(r.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),r.prototype.add=function(t){var e=this;if(zn(this._atom),Mr(this)){var n=Ar(this,{type:"add",object:this,newValue:t});if(!n)return this}if(!this.has(t)){dr(function(){e._data.add(e.enhancer(t,void 0)),e._atom.reportChanged()});var o=Qt(),i=pr(this),n=i||o?{type:"add",object:this,newValue:t}:null;i&&vr(this,n)}return this},r.prototype.delete=function(t){var e=this;if(Mr(this)){var n=Ar(this,{type:"delete",object:this,oldValue:t});if(!n)return!1}if(this.has(t)){var o=Qt(),i=pr(this),n=i||o?{type:"delete",object:this,oldValue:t}:null;return dr(function(){e._atom.reportChanged(),e._data.delete(t)}),i&&vr(this,n),!0}return!1},r.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},r.prototype.entries=function(){var t=0,e=Array.from(this.keys()),n=Array.from(this.values());return qi({next:function(){var o=t;return t+=1,o<n.length?{value:[e[o],n[o]],done:!1}:{done:!0}}})},r.prototype.keys=function(){return this.values()},r.prototype.values=function(){this._atom.reportObserved();var t=this,e=0,n=Array.from(this._data.values());return qi({next:function(){return e<n.length?{value:t.dehanceValue(n[e++]),done:!1}:{done:!0}}})},r.prototype.replace=function(t){var e=this;return tr(t)&&(t=t.toJS()),dr(function(){var n=Ha(!0);try{Array.isArray(t)?(e.clear(),t.forEach(function(o){return e.add(o)})):ri(t)?(e.clear(),t.forEach(function(o){return e.add(o)})):t!=null&&We("Cannot initialize set from "+t)}finally{Ga(n)}}),this},r.prototype.observe=function(t,e){return ii(this,t)},r.prototype.intercept=function(t){return oi(this,t)},r.prototype.toJS=function(){return new Set(this)},r.prototype.toString=function(){return this.name+"[ "+Array.from(this).join(", ")+" ]"},r.prototype[Ql=we,Symbol.iterator]=function(){return this.values()},r})(),tr=Ur("ObservableSet",$f),Wf=(function(){function r(t,e,n,o){e===void 0&&(e=new Map),this.target=t,this.values=e,this.name=n,this.defaultEnhancer=o,this.keysAtom=new ro(n+".keys")}return r.prototype.read=function(t){return this.values.get(t).get()},r.prototype.write=function(t,e){var n=this.target,o=this.values.get(t);if(o instanceof Yn){o.set(e);return}if(Mr(this)){var i=Ar(this,{type:"update",object:this.proxy||n,name:t,newValue:e});if(!i)return;e=i.newValue}if(e=o.prepareNewValue(e),e!==ie.UNCHANGED){var a=pr(this),s=Qt(),i=a||s?{type:"update",object:this.proxy||n,oldValue:o.value,name:t,newValue:e}:null;o.setNewValue(e),a&&vr(this,i)}},r.prototype.has=function(t){var e=this.pendingKeys||(this.pendingKeys=new Map),n=e.get(t);if(n)return n.get();var o=!!this.values.get(t);return n=new cn(o,Ba,this.name+"."+Hr(t)+"?",!1),e.set(t,n),n.get()},r.prototype.addObservableProp=function(t,e,n){n===void 0&&(n=this.defaultEnhancer);var o=this.target;if(Mr(this)){var i=Ar(this,{object:this.proxy||o,name:t,type:"add",newValue:e});if(!i)return;e=i.newValue}var a=new cn(e,n,this.name+"."+Hr(t),!1);this.values.set(t,a),e=a.value,Object.defineProperty(o,t,vp(t)),this.notifyPropertyAddition(t,e)},r.prototype.addComputedProp=function(t,e,n){var o=this.target;n.name=n.name||this.name+"."+Hr(e),this.values.set(e,new Yn(n)),(t===o||ph(t,e))&&Object.defineProperty(t,e,gp(e))},r.prototype.remove=function(t){if(this.values.has(t)){var e=this.target;if(Mr(this)){var n=Ar(this,{object:this.proxy||e,name:t,type:"remove"});if(!n)return}try{cr();var o=pr(this),i=Qt(),a=this.values.get(t),s=a&&a.get();if(a&&a.set(void 0),this.keysAtom.reportChanged(),this.values.delete(t),this.pendingKeys){var l=this.pendingKeys.get(t);l&&l.set(!1)}delete this.target[t];var n=o||i?{type:"remove",object:this.proxy||e,oldValue:s,name:t}:null;o&&vr(this,n)}finally{hr()}}},r.prototype.illegalAccess=function(t,e){console.warn("Property '"+e+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},r.prototype.observe=function(t,e){return ii(this,t)},r.prototype.intercept=function(t){return oi(this,t)},r.prototype.notifyPropertyAddition=function(t,e){var n=pr(this),o=Qt(),i=n||o?{type:"add",object:this.proxy||this.target,name:t,newValue:e}:null;if(n&&vr(this,i),this.pendingKeys){var a=this.pendingKeys.get(t);a&&a.set(!0)}this.keysAtom.reportChanged()},r.prototype.getKeys=function(){var t,e;this.keysAtom.reportObserved();var n=[];try{for(var o=Sr(this.values),i=o.next();!i.done;i=o.next()){var a=Dn(i.value,2),s=a[0],l=a[1];l instanceof cn&&n.push(s)}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},r})();function Pl(r,t,e){if(t===void 0&&(t=""),e===void 0&&(e=ni),Object.prototype.hasOwnProperty.call(r,we))return r[we];Qn(r)||(t=(r.constructor.name||"ObservableObject")+"@"+Ht()),t||(t="ObservableObject@"+Ht());var n=new Wf(r,new Map,Hr(t),e);return eo(r,we,n),n}var eu=Object.create(null),tu=Object.create(null);function vp(r){return eu[r]||(eu[r]={configurable:!0,enumerable:!0,get:function(){return this[we].read(r)},set:function(t){this[we].write(r,t)}})}function ru(r){var t=r[we];return t||(pn(r),r[we])}function gp(r){return tu[r]||(tu[r]={configurable:ie.computedConfigurable,enumerable:!1,get:function(){return ru(this).read(r)},set:function(t){ru(this).write(r,t)}})}var yp=Ur("ObservableObjectAdministration",Wf);function yr(r){return bl(r)?(pn(r),yp(r[we])):!1}function $r(r,t){if(typeof r=="object"&&r!==null){if(Cr(r))return t!==void 0&&We(!1),r[we].atom;if(tr(r))return r[we];if(Gt(r)){var e=r;if(t===void 0)return e._keysAtom;var n=e._data.get(t)||e._hasMap.get(t);return n||We(!1),n}if(pn(r),t&&!r[we]&&r[t],yr(r)){if(!t)return We(!1);var n=r[we].values.get(t);return n||We(!1),n}if(Sl(r)||Fn(r)||Zi(r))return r}else if(typeof r=="function"&&Zi(r[we]))return r[we];return We(!1)}function za(r,t){if(r||We("Expecting some object"),t!==void 0)return za($r(r,t));if(Sl(r)||Fn(r)||Zi(r)||Gt(r)||tr(r))return r;if(pn(r),r[we])return r[we];We(!1)}function mp(r,t){var e;return t!==void 0?e=$r(r,t):yr(r)||Gt(r)||tr(r)?e=za(r):e=$r(r),e.name}var nu=Object.prototype.toString;function Uf(r,t,e){return e===void 0&&(e=-1),Ls(r,t,e)}function Ls(r,t,e,n,o){if(r===t)return r!==0||1/r===1/t;if(r==null||t==null)return!1;if(r!==r)return t!==t;var i=typeof r;if(i!=="function"&&i!=="object"&&typeof t!="object")return!1;var a=nu.call(r);if(a!==nu.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+r==""+t;case"[object Number]":return+r!=+r?+t!=+t:+r==0?1/+r===1/t:+r==+t;case"[object Date]":case"[object Boolean]":return+r==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(r)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":e>=0&&e++;break}r=ou(r),t=ou(t);var s=a==="[object Array]";if(!s){if(typeof r!="object"||typeof t!="object")return!1;var l=r.constructor,u=t.constructor;if(l!==u&&!(typeof l=="function"&&l instanceof l&&typeof u=="function"&&u instanceof u)&&"constructor"in r&&"constructor"in t)return!1}if(e===0)return!1;e<0&&(e=-1),n=n||[],o=o||[];for(var f=n.length;f--;)if(n[f]===r)return o[f]===t;if(n.push(r),o.push(t),s){if(f=r.length,f!==t.length)return!1;for(;f--;)if(!Ls(r[f],t[f],e-1,n,o))return!1}else{var d=Object.keys(r),c=void 0;if(f=d.length,Object.keys(t).length!==f)return!1;for(;f--;)if(c=d[f],!(_p(t,c)&&Ls(r[c],t[c],e-1,n,o)))return!1}return n.pop(),o.pop(),!0}function ou(r){return Cr(r)?r.slice():to(r)||Gt(r)||ri(r)||tr(r)?Array.from(r.entries()):r}function _p(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function qi(r){return r[Symbol.iterator]=xp,r}function xp(){return this}if(typeof Proxy>"u"||typeof Symbol>"u")throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:zh,extras:{getDebugName:mp},$mobx:we});function wp(r){return!(r.prototype&&r.prototype.render)&&!De.isPrototypeOf(r)}function Vf(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=t.prefix,n=e===void 0?"":e,o=t.suffix,i=o===void 0?"":o,a=r.displayName||r.name||r.constructor&&r.constructor.name||"<component>";return n+a+i}var iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Kf=function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")},Zf=(function(){function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}})(),qf=function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)},Jf=function(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r},au=console;function Ep(r){var t=Ps().allowStateChanges;return Ps().allowStateChanges=r,t}function bp(r){Ps().allowStateChanges=r}function Sp(r,t,e,n,o){var i=Ep(r),a=void 0;try{a=t(e,n,o)}finally{bp(i)}return a}function su(r,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=r[t],o=Qf[t],i=n?e===!0?function(){o.apply(this,arguments),n.apply(this,arguments)}:function(){n.apply(this,arguments),o.apply(this,arguments)}:o;r[t]=i}function lu(r,t){if(r==null||t==null||(typeof r>"u"?"undefined":iu(r))!=="object"||(typeof t>"u"?"undefined":iu(t))!=="object")return r!==t;var e=Object.keys(r);if(e.length!==Object.keys(t).length)return!0;for(var n=void 0,o=e.length-1;n=e[o];o--)if(t[n]!==r[n])return!0;return!1}var Qf={componentWillMount:function(){var t=this,e=Vf(this),n=!1,o=!1;function i(d){var c=this[d],h=Ol("reactive "+d);Object.defineProperty(this,d,{configurable:!0,enumerable:!0,get:function(){return h.reportObserved(),c},set:function(v){!o&&lu(c,v)?(c=v,n=!0,h.reportChanged(),n=!1):c=v}})}i.call(this,"props"),i.call(this,"state");var a=this.render.bind(this),s=null,l=!1,u=function(){return s=new Xo(e+".render()",function(){if(!l&&(l=!0,typeof t.componentWillReact=="function"&&t.componentWillReact(),t.__$mobxIsUnmounted!==!0)){var c=!0;try{o=!0,n||De.prototype.forceUpdate.call(t),c=!1}finally{o=!1,c&&s.dispose()}}}),s.reactComponent=t,f.$mobx=s,t.render=f,f(t.props,t.state,t.context)},f=function(c,h,p){l=!1;var v=void 0,g=void 0;if(s.track(function(){try{g=Sp(!1,a,c,h,p)}catch(y){v=y}}),v)throw v;return g};this.render=u},componentWillUnmount:function(){this.render.$mobx&&this.render.$mobx.dispose(),this.__$mobxIsUnmounted=!0},componentDidMount:function(){},componentDidUpdate:function(){},shouldComponentUpdate:function(t,e){return this.state!==e?!0:lu(this.props,t)}};function Dl(r){if(arguments.length>1&&au.warn('Mobx observer: Using observer to inject stores is not supported. Use `@connect(["store1", "store2"]) ComponentClass instead or preferably, use `@inject("store1", "store2") @observer ComponentClass` or `inject("store1", "store2")(observer(componentClass))``'),r.isMobxInjector===!0&&au.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),wp(r)){var t,e;return Dl((e=t=(function(o){qf(i,o);function i(){return Kf(this,i),Jf(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return Zf(i,[{key:"render",value:function(){return r.call(this,this.props,this.context)}}]),i})(De),t.displayName=Vf(r),e))}if(!r)throw new Error("Please pass a valid component to 'observer'");var n=r.prototype||r;return Op(n),r.isMobXReactObserver=!0,r}function Op(r){su(r,"componentWillMount",!0),su(r,"componentDidMount"),r.shouldComponentUpdate||(r.shouldComponentUpdate=Qf.shouldComponentUpdate)}var Mp=Dl(function(r){var t=r.children;return t[0]()});Mp.displayName="Observer";var Ap=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Np(r,t){return t={exports:{}},r(t,t.exports),t.exports}Np(function(r,t){(function(e,n){r.exports=n()})(Ap,(function(){var e={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o=Object.defineProperty,i=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,s=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,u=l&&l(Object);return function f(d,c,h){if(typeof c!="string"){if(u){var p=l(c);p&&p!==u&&f(d,p,h)}var v=i(c);a&&(v=v.concat(a(c)));for(var g=0;g<v.length;++g){var y=v[g];if(!e[y]&&!n[y]&&(!h||!h[y])){var w=s(c,y);try{o(d,y,w)}catch{}}}return d}return d}}))});var uu={children:!0,key:!0,ref:!0},du=console;(function(r){qf(t,r);function t(){return Kf(this,t),Jf(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Zf(t,[{key:"render",value:function(n){var o=n.children;return o.length>1?ce("div",null," ",o," "):o[0]}},{key:"getChildContext",value:function(){var n={},o=this.context.mobxStores;if(o)for(var i in o)n[i]=o[i];for(var a in this.props)!uu[a]&&a!=="suppressChangedStoreWarning"&&(n[a]=this.props[a]);return{mobxStores:n}}},{key:"componentWillReceiveProps",value:function(n){if(Object.keys(n).length!==Object.keys(this.props).length&&du.warn("MobX Provider: The set of provided stores has changed. Please avoid changing stores as the change might not propagate to all children"),!n.suppressChangedStoreWarning)for(var o in n)!uu[o]&&this.props[o]!==n[o]&&du.warn("MobX Provider: Provided store '"+o+"' has changed. Please avoid replacing stores as the change might not propagate to all children")}}]),t})(De);if(!De)throw new Error("mobx-preact requires Preact to be available");var Er,Qa,fu,ec=[],St=Ne,cu=St.__b,hu=St.__r,pu=St.diffed,vu=St.__c,gu=St.unmount,yu=St.__;function Cp(){for(var r;r=ec.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(ki),r.__H.__h.forEach(js),r.__H.__h=[]}catch(t){r.__H.__h=[],St.__e(t,r.__v)}}St.__b=function(r){Er=null,cu&&cu(r)},St.__=function(r,t){r&&t.__k&&t.__k.__m&&(r.__m=t.__k.__m),yu&&yu(r,t)},St.__r=function(r){hu&&hu(r);var t=(Er=r.__c).__H;t&&(Qa===Er?(t.__h=[],Er.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(ki),t.__h.forEach(js),t.__h=[])),Qa=Er},St.diffed=function(r){pu&&pu(r);var t=r.__c;t&&t.__H&&(t.__H.__h.length&&(ec.push(t)!==1&&fu===St.requestAnimationFrame||((fu=St.requestAnimationFrame)||Tp)(Cp)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),Qa=Er=null},St.__c=function(r,t){t.some(function(e){try{e.__h.forEach(ki),e.__h=e.__h.filter(function(n){return!n.__||js(n)})}catch(n){t.some(function(o){o.__h&&(o.__h=[])}),t=[],St.__e(n,e.__v)}}),vu&&vu(r,t)},St.unmount=function(r){gu&&gu(r);var t,e=r.__c;e&&e.__H&&(e.__H.__.forEach(function(n){try{ki(n)}catch(o){t=o}}),e.__H=void 0,t&&St.__e(t,e.__v))};var mu=typeof requestAnimationFrame=="function";function Tp(r){var t,e=function(){clearTimeout(n),mu&&cancelAnimationFrame(t),setTimeout(r)},n=setTimeout(e,35);mu&&(t=requestAnimationFrame(e))}function ki(r){var t=Er,e=r.__c;typeof e=="function"&&(r.__c=void 0,e()),Er=t}function js(r){var t=Er;r.__c=r.__(),Er=t}function Pp(r,t){for(var e in t)r[e]=t[e];return r}function _u(r,t){for(var e in r)if(e!=="__source"&&!(e in t))return!0;for(var n in t)if(n!=="__source"&&r[n]!==t[n])return!0;return!1}function xu(r,t){this.props=r,this.context=t}(xu.prototype=new De).isPureReactComponent=!0,xu.prototype.shouldComponentUpdate=function(r,t){return _u(this.props,r)||_u(this.state,t)};var wu=Ne.__b;Ne.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),wu&&wu(r)};var Dp=Ne.__e;Ne.__e=function(r,t,e,n){if(r.then){for(var o,i=t;i=i.__;)if((o=i.__c)&&o.__c)return t.__e==null&&(t.__e=e.__e,t.__k=e.__k),o.__c(r,t)}Dp(r,t,e,n)};var Eu=Ne.unmount;function tc(r,t,e){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=Pp({},r)).__c!=null&&(r.__c.__P===e&&(r.__c.__P=t),r.__c.__e=!0,r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return tc(n,t,e)})),r}function rc(r,t,e){return r&&e&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return rc(n,t,e)}),r.__c&&r.__c.__P===t&&(r.__e&&e.appendChild(r.__e),r.__c.__e=!0,r.__c.__P=e)),r}function es(){this.__u=0,this.o=null,this.__b=null}function nc(r){var t=r.__.__c;return t&&t.__a&&t.__a(r)}function pi(){this.i=null,this.l=null}Ne.unmount=function(r){var t=r.__c;t&&t.__R&&t.__R(),t&&32&r.__u&&(r.type=null),Eu&&Eu(r)},(es.prototype=new De).__c=function(r,t){var e=t.__c,n=this;n.o==null&&(n.o=[]),n.o.push(e);var o=nc(n.__v),i=!1,a=function(){i||(i=!0,e.__R=null,o?o(s):s())};e.__R=a;var s=function(){if(!--n.__u){if(n.state.__a){var l=n.state.__a;n.__v.__k[0]=rc(l,l.__c.__P,l.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.o.pop();)u.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(a,a)},es.prototype.componentWillUnmount=function(){this.o=[]},es.prototype.render=function(r,t){if(this.__b){if(this.__v.__k){var e=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=tc(this.__b,e,n.__O=n.__P)}this.__b=null}var o=t.__a&&ce(Xn,null,r.fallback);return o&&(o.__u&=-33),[ce(Xn,null,t.__a?null:r.children),o]};var bu=function(r,t,e){if(++e[1]===e[0]&&r.l.delete(t),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.l.size))for(e=r.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;r.i=e=e[2]}};(pi.prototype=new De).__a=function(r){var t=this,e=nc(t.__v),n=t.l.get(r);return n[0]++,function(o){var i=function(){t.props.revealOrder?(n.push(o),bu(t,r,n)):o()};e?e(i):i()}},pi.prototype.render=function(r){this.i=null,this.l=new Map;var t=Yi(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return r.children},pi.prototype.componentDidUpdate=pi.prototype.componentDidMount=function(){var r=this;this.l.forEach(function(t,e){bu(r,e,t)})};var Rp=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Lp=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,jp=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Ip=/[A-Z0-9]/g,kp=typeof document<"u",Bp=function(r){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(r)};function Su(r,t,e){return t.__k==null&&(t.textContent=""),uh(r,t),typeof e=="function"&&e(),r?r.__c:null}De.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(De.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(t){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:t})}})});var Ou=Ne.event;function Xp(){}function Hp(){return this.cancelBubble}function Gp(){return this.defaultPrevented}Ne.event=function(r){return Ou&&(r=Ou(r)),r.persist=Xp,r.isPropagationStopped=Hp,r.isDefaultPrevented=Gp,r.nativeEvent=r};var zp={enumerable:!1,configurable:!0,get:function(){return this.class}},Mu=Ne.vnode;Ne.vnode=function(r){typeof r.type=="string"&&(function(t){var e=t.props,n=t.type,o={},i=n.indexOf("-")===-1;for(var a in e){var s=e[a];if(!(a==="value"&&"defaultValue"in e&&s==null||kp&&a==="children"&&n==="noscript"||a==="class"||a==="className")){var l=a.toLowerCase();a==="defaultValue"&&"value"in e&&e.value==null?a="value":a==="download"&&s===!0?s="":l==="translate"&&s==="no"?s=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?a="ondblclick":l!=="onchange"||n!=="input"&&n!=="textarea"||Bp(e.type)?l==="onfocus"?a="onfocusin":l==="onblur"?a="onfocusout":jp.test(a)&&(a=l):l=a="oninput":i&&Lp.test(a)?a=a.replace(Ip,"-$&").toLowerCase():s===null&&(s=void 0),l==="oninput"&&o[a=l]&&(a="oninputCapture"),o[a]=s}}n=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=Yi(e.children).forEach(function(u){u.props.selected=o.value.indexOf(u.props.value)!=-1})),n=="select"&&o.defaultValue!=null&&(o.value=Yi(e.children).forEach(function(u){u.props.selected=o.multiple?o.defaultValue.indexOf(u.props.value)!=-1:o.defaultValue==u.props.value})),e.class&&!e.className?(o.class=e.class,Object.defineProperty(o,"className",zp)):(e.className&&!e.class||e.class&&e.className)&&(o.class=o.className=e.className),t.props=o})(r),r.$$typeof=Rp,Mu&&Mu(r)};var Au=Ne.__r;Ne.__r=function(r){Au&&Au(r),r.__c};var Nu=Ne.diffed;Ne.diffed=function(r){Nu&&Nu(r);var t=r.props,e=r.__e;e!=null&&r.type==="textarea"&&"value"in t&&t.value!==e.value&&(e.value=t.value==null?"":t.value)};var Yp=0;function k(r,t,e,n,o,i){t||(t={});var a,s,l=t;if("ref"in l)for(s in l={},t)s=="ref"?a=t[s]:l[s]=t[s];var u={type:r,props:l,key:e,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Yp,__i:-1,__u:0,__source:o,__self:i};if(typeof r=="function"&&(a=r.defaultProps))for(s in a)l[s]===void 0&&(l[s]=a[s]);return Ne.vnode&&Ne.vnode(u),u}var Fp=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},Ho;(function(r){function t(e){var n=Fp(e,[]),o=e.container;if(!o)throw new Error("Ensure the container of LogicFlow is specified and valid.");return Fe({},r.defaults,n)}r.get=t})(Ho||(Ho={}));(function(r){r.defaults={background:!1,grid:!1,textEdit:!0,snapline:!0,outline:!1,disabledTools:[]}})(Ho||(Ho={}));var Cu={node:!1,edge:!1},$p={node:!0,edge:!0},Wp=function(r){return!r||typeof r=="boolean"?r===!0?xe($p):xe(Cu):kn(xe(Cu),r)},Up=function(){return ei(window,"navigator.userAgent","").match(/MSIE|Trident/)!==null};function Ct(r){try{return JSON.parse(JSON.stringify(r))}catch{return r}}var vi=200,Vp=9999,Kp=10,Xe;(function(r){r[r.DEFAULT=1]="DEFAULT",r[r.TEXT_EDIT=2]="TEXT_EDIT",r[r.SHOW_MENU=3]="SHOW_MENU",r[r.ALLOW_CONNECT=4]="ALLOW_CONNECT",r[r.NOT_ALLOW_CONNECT=5]="NOT_ALLOW_CONNECT"})(Xe||(Xe={}));var at;(function(r){r.NODE="node",r.EDGE="edge",r.GRAPH="graph"})(at||(at={}));var Ae;(function(r){r.NODE="node",r.CIRCLE_NODE="circle-node",r.POLYGON_NODE="polygon-node",r.RECT_NODE="rect-node",r.TEXT_NODE="text-node",r.ELLIPSE_NODE="ellipse-node",r.DIAMOND_NODE="diamond-node",r.HTML_NODE="html-node",r.CUSTOM_HTML_NODE="custom-html-node",r.EDGE="edge",r.LINE_EDGE="line-edge",r.POLYLINE_EDGE="polyline-edge",r.BEZIER_EDGE="bezier-edge",r.GRAPH="graph"})(Ae||(Ae={}));var ne;(function(r){r.ELEMENT_CLICK="element:click",r.NODE_ADD="node:add",r.NODE_DELETE="node:delete",r.NODE_CLICK="node:click",r.NODE_DBCLICK="node:dbclick",r.NODE_GROUP_COPY="node:group-copy-add",r.NODE_DND_ADD="node:dnd-add",r.NODE_DND_DRAG="node:dnd-drag",r.NODE_MOUSEDOWN="node:mousedown",r.NODE_DRAGSTART="node:dragstart",r.NODE_DRAG="node:drag",r.NODE_DROP="node:drop",r.NODE_MOUSEUP="node:mouseup",r.NODE_MOUSEMOVE="node:mousemove",r.NODE_MOUSEENTER="node:mouseenter",r.NODE_MOUSELEAVE="node:mouseleave",r.NODE_CONTEXTMENU="node:contextmenu",r.NODE_ROTATE="node:rotate",r.NODE_RESIZE="node:resize",r.NODE_FOCUS="node:focus",r.NODE_BLUR="node:blur",r.NODE_PROPERTIES_CHANGE="node:properties-change",r.NODE_PROPERTIES_DELETE="node:properties-delete",r.EDGE_ADD="edge:add",r.EDGE_DELETE="edge:delete",r.EDGE_CLICK="edge:click",r.EDGE_DBCLICK="edge:dbclick",r.EDGE_FOCUS="edge:focus",r.EDGE_BLUR="edge:blur",r.EDGE_MOUSEENTER="edge:mouseenter",r.EDGE_MOUSELEAVE="edge:mouseleave",r.EDGE_CONTEXTMENU="edge:contextmenu",r.EDGE_ADJUST="edge:adjust",r.EDGE_EXCHANGE_NODE="edge:exchange-node",r.ANCHOR_CLICK="anchor:click",r.ANCHOR_MOUSEDOWN="anchor:mousedown",r.ANCHOR_DRAGSTART="anchor:dragstart",r.ANCHOR_DRAG="anchor:drag",r.ANCHOR_DROP="anchor:drop",r.ANCHOR_DRAGEND="anchor:dragend",r.ADJUST_POINT_MOUSEDOWN="adjustPoint:mousedown",r.ADJUST_POINT_MOUSEUP="adjustPoint:mouseup",r.ADJUST_POINT_MOUSEMOVE="adjustPoint:mousemove",r.ADJUST_POINT_DRAGSTART="adjustPoint:dragstart",r.ADJUST_POINT_DRAG="adjustPoint:drag",r.ADJUST_POINT_DROP="adjustPoint:drop",r.ADJUST_POINT_DRAGEND="adjustPoint:dragend",r.BLANK_MOUSEDOWN="blank:mousedown",r.BLANK_DRAGSTART="blank:dragstart",r.BLANK_DRAG="blank:drag",r.BLANK_DROP="blank:drop",r.BLANK_MOUSEMOVE="blank:mousemove",r.BLANK_CANVAS_MOUSEMOVE="blank:canvas-mousemove",r.BLANK_MOUSEUP="blank:mouseup",r.BLANK_CLICK="blank:click",r.BLANK_CONTEXTMENU="blank:contextmenu",r.SELECTION_MOUSEDOWN="selection:mousedown",r.SELECTION_DRAGSTART="selection:dragstart",r.SELECTION_DRAG="selection:drag",r.SELECTION_DROP="selection:drop",r.SELECTION_MOUSEMOVE="selection:mousemove",r.SELECTION_MOUSEUP="selection:mouseup",r.SELECTION_CONTEXTMENU="selection:contextmenu",r.CONNECTION_NOT_ALLOWED="connection:not-allowed",r.TEXT_MOUSEDOWN="text:mousedown",r.TEXT_DRAGSTART="text:dragstart",r.TEXT_DRAG="text:drag",r.TEXT_DROP="text:drop",r.TEXT_CLICK="text:click",r.TEXT_DBCLICK="text:dbclick",r.TEXT_BLUR="text:blur",r.TEXT_MOUSEMOVE="text:mousemove",r.TEXT_MOUSEUP="text:mouseup",r.TEXT_FOCUS="text:focus",r.TEXT_ADD="text:add",r.TEXT_UPDATE="text:update",r.TEXT_CLEAR="text:clear",r.LABEL_MOUSEDOWN="label:mousedown",r.LABEL_DRAGSTART="label:dragstart",r.LABEL_DRAG="label:drag",r.LABEL_DROP="label:drop",r.LABEL_CLICK="label:click",r.LABEL_DBCLICK="label:dbclick",r.LABEL_BLUR="label:blur",r.LABEL_MOUSEMOVE="label:mousemove",r.LABEL_MOUSEUP="label:mouseup",r.LABEL_FOCUS="label:focus",r.LABEL_ADD="label:add",r.LABEL_UPDATE="label:update",r.LABEL_CLEAR="label:clear",r.LABEL_DELETE="label:delete",r.LABEL_SHOULD_ADD="label:should-add",r.LABEL_BATCH_ADD="label:batch-add",r.LABEL_SHOULD_UPDATE="label:should-update",r.LABEL_SHOULD_DELETE="label:should-delete",r.LABEL_BATCH_DELETE="label:batch-delete",r.LABEL_NOT_ALLOWED_ADD="label:not-allowed-add",r.HISTORY_CHANGE="history:change",r.GRAPH_TRANSFORM="graph:transform",r.GRAPH_RENDERED="graph:rendered",r.GRAPH_UPDATED="graph:updated",r.EDIT_CONFIG_CHANGED="editConfig:changed"})(ne||(ne={}));var gt;(function(r){r[r.STATIC=-1]="STATIC",r[r.DEFAULT=0]="DEFAULT",r[r.INCREASE=1]="INCREASE",r[r.EDGE_TOP=2]="EDGE_TOP"})(gt||(gt={}));var tt;(function(r){r.HORIZONTAL="horizontal",r.VERTICAL="vertical"})(tt||(tt={}));var er;(function(r){r.TEXT="text",r.LABEL="label"})(er||(er={}));var Zp=0,rr=(function(){function r(t){var e=t.onDragStart,n=e===void 0?qa:e,o=t.onDragging,i=o===void 0?qa:o,a=t.onDragEnd,s=a===void 0?qa:a,l=t.eventType,u=l===void 0?"":l,f=t.eventCenter,d=t.step,c=d===void 0?1:d,h=t.isStopPropagation,p=h===void 0?!0:h,v=t.model,g=t.data,y=this;this.isDragging=!1,this.isStartDragging=!1,this.startX=0,this.startY=0,this.sumDeltaX=0,this.sumDeltaY=0,this.handleMouseDown=function(w){var M,C,P=window==null?void 0:window.document;if(w.button===Zp){y.isStopPropagation&&w.stopPropagation(),w.preventDefault(),y.isStartDragging=!0,y.startX=w.clientX,y.startY=w.clientY,P.addEventListener("pointermove",y.handleMouseMove,!1),P.addEventListener("pointerup",y.handleMouseUp,!1);var S=(M=y.model)===null||M===void 0?void 0:M.getData();(C=y.eventCenter)===null||C===void 0||C.emit(ne["".concat(y.eventType,"_MOUSEDOWN")],{e:w,data:y.data||S}),y.startTime=new Date().getTime()}},this.handleMouseMove=function(w){var M,C;if(y.isStopPropagation&&w.stopPropagation(),w.preventDefault(),!!y.isStartDragging&&(y.sumDeltaX+=w.clientX-y.startX,y.sumDeltaY+=w.clientY-y.startY,y.startX=w.clientX,y.startY=w.clientY,y.step<=1||Math.abs(y.sumDeltaX)>y.step||Math.abs(y.sumDeltaY)>y.step)){var P=y.sumDeltaX%y.step,S=y.sumDeltaY%y.step,E=y.sumDeltaX-P,T=y.sumDeltaY-S;y.sumDeltaX=P,y.sumDeltaY=S;var j=(M=y.model)===null||M===void 0?void 0:M.getData();y.isDragging||((C=y.eventCenter)===null||C===void 0||C.emit(ne["".concat(y.eventType,"_DRAGSTART")],{e:w,data:y.data||j}),y.onDragStart({event:w})),y.isDragging=!0,Promise.resolve().then(function(){var q,ee;y.onDragging({deltaX:E,deltaY:T,event:w}),(q=y.eventCenter)===null||q===void 0||q.emit(ne["".concat(y.eventType,"_MOUSEMOVE")],{deltaX:E,deltaY:T,e:w,data:y.data||j}),(ee=y.eventCenter)===null||ee===void 0||ee.emit(ne["".concat(y.eventType,"_DRAG")],{e:w,data:y.data||j})})}},this.handleMouseUp=function(w){var M=window.document;y.isStartDragging=!1,y.isStopPropagation&&w.stopPropagation();var C=w.target;C&&typeof C.releasePointerCapture=="function"&&C.releasePointerCapture(w.pointerId),Promise.resolve().then(function(){var P,S,E;M.removeEventListener("pointermove",y.handleMouseMove,!1),M.removeEventListener("pointerup",y.handleMouseUp,!1);var T=(P=y.model)===null||P===void 0?void 0:P.getData();(S=y.eventCenter)===null||S===void 0||S.emit(ne["".concat(y.eventType,"_MOUSEUP")],{e:w,data:y.data||T}),y.isDragging&&(y.isDragging=!1,y.onDragEnd({event:w}),(E=y.eventCenter)===null||E===void 0||E.emit(ne["".concat(y.eventType,"_DROP")],{e:w,data:y.data||T}))})},this.cancelDrag=function(){var w=window==null?void 0:window.document;w.removeEventListener("pointermove",y.handleMouseMove,!1),w.removeEventListener("pointerup",y.handleMouseUp,!1),y.onDragEnd({event:void 0}),y.isDragging=!1},this.destroy=function(){y.isStartDragging&&y.cancelDrag()},this.onDragStart=n,this.onDragging=i,this.onDragEnd=s,this.step=c,this.isStopPropagation=p,this.eventType=u,this.eventCenter=f,this.model=v,this.data=g}return r.prototype.setStep=function(t){this.step=t},r.prototype.setModel=function(t){this.model=t},r})(),qp=function(r){var t=r.x,e=r.y,n=r.width,o=r.height;return{x:t-n/2,y:e-o/2,x1:t+n/2,y1:e+o/2}},Jp=function(r){var t=r.startPoint,e=r.endPoint,n=(t.x+e.x)/2,o=(t.y+e.y)/2,i=Math.abs(t.x-e.x)+10,a=Math.abs(t.y-e.y)+10;return{x:n-i/2,y:o-a/2,x1:n+i/2,y1:o+a/2}},Qp=function(r){var t=r.points,e=vn(t),n=Yo(e,8),o=n.x,i=n.y,a=n.width,s=n.height;return{x:o-a/2,y:i-s/2,x1:o+a/2,y1:i+s/2}},ev=function(r){var t=r.path,e=Rl(t),n=Yo(e,8),o=n.x,i=n.y,a=n.width,s=n.height;return{x:o-a/2,y:i-s/2,x1:o+a/2,y1:i+s/2}},tv=function(r){if(r.modelType===Ae.LINE_EDGE)return Jp(r);if(r.modelType===Ae.POLYLINE_EDGE)return Qp(r);if(r.modelType===Ae.BEZIER_EDGE)return ev(r)},rv=function(r,t,e,n){var o=(t.y-r.y)*(n.x-e.x)-(r.x-t.x)*(e.y-n.y);if(o===0)return!1;var i=((t.x-r.x)*(n.x-e.x)*(e.y-r.y)+(t.y-r.y)*(n.x-e.x)*r.x-(n.y-e.y)*(t.x-r.x)*e.x)/o,a=-((t.y-r.y)*(n.y-e.y)*(e.x-r.x)+(t.x-r.x)*(n.y-e.y)*r.y-(n.x-e.x)*(t.y-r.y)*e.y)/o;return(i-r.x)*(i-t.x)<=0&&(a-r.y)*(a-t.y)<=0&&(i-e.x)*(i-n.x)<=0&&(a-e.y)*(a-n.y)<=0?{x:i,y:a}:!1},Go=function(r,t,e){var n=r.x,o=r.y,i=t.x,a=t.y,s=e.x,l=e.y,u=(l-a)/(s-i),f=a-u*i;return(n>=i&&n<=s||n<=i&&n>=s)&&(o>=a&&o<=l||o<=a&&o>=l)&&Math.abs(o-u*n-f)<Number.EPSILON},zo=function(r){var t=r.start,e=r.end,n=r.offset,o=r.verticalLength,i=r.type,a={leftX:0,leftY:0,rightX:0,rightY:0},s=Math.atan((e.y-t.y)/(e.x-t.x)),l=Math.atan(n/o),u=Math.sqrt(o*o+n*n);return i==="start"?e.x>=t.x?(a.leftX=t.x+u*Math.sin(s+l),a.leftY=t.y-u*Math.cos(s+l),a.rightX=t.x-u*Math.sin(s-l),a.rightY=t.y+u*Math.cos(s-l)):(a.leftX=t.x-u*Math.sin(s+l),a.leftY=t.y+u*Math.cos(s+l),a.rightX=t.x+u*Math.sin(s-l),a.rightY=t.y-u*Math.cos(s-l)):i==="end"&&(e.x>=t.x?(a.leftX=e.x+u*Math.sin(s-l),a.leftY=e.y-u*Math.cos(s-l),a.rightX=e.x-u*Math.sin(s+l),a.rightY=e.y+u*Math.cos(s+l)):(a.leftX=e.x-u*Math.sin(s-l),a.leftY=e.y+u*Math.cos(s-l),a.rightX=e.x+u*Math.sin(s+l),a.rightY=e.y-u*Math.cos(s+l))),a},Rn=function(){return Rn=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Rn.apply(this,arguments)},qt=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Gr=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},nv=function(r,t){return Math.abs(r.centerX-t.centerX)*2<r.width+t.width&&Math.abs(r.centerY-t.centerY)*2<r.height+t.height},Is=function(r){var t=[],e={};return r.forEach(function(n){var o="".concat(n.x,"-").concat(n.y);n.id=o,e[o]=n}),Object.keys(e).forEach(function(n){t.push(e[n])}),t},Ji=function(r,t){return r.width===0&&r.height===0?r:{x:r.x,y:r.y,centerX:r.centerX,centerY:r.centerY,minX:r.minX-t,minY:r.minY-t,maxX:r.maxX+t,maxY:r.maxY+t,height:r.height+2*t,width:r.width+2*t}},ov=function(r,t){var e=Math.abs(r.x-t.centerX),n=Math.abs(r.y-t.centerY);return e/t.width>n/t.height?tt.HORIZONTAL:tt.VERTICAL},Qi=function(r,t,e){var n=ov(e,t);return n===tt.HORIZONTAL?{x:e.x>r.centerX?r.maxX:r.minX,y:e.y}:{x:e.x,y:e.y>r.centerY?r.maxY:r.minY}},Tu=function(r,t){var e=Math.min(r.minX,t.minX),n=Math.min(r.minY,t.minY),o=Math.max(r.maxX,t.maxX),i=Math.max(r.maxY,t.maxY);return{x:(e+o)/2,y:(n+i)/2,centerX:(e+o)/2,centerY:(n+i)/2,minX:e,minY:n,maxX:o,maxY:i,height:i-n,width:o-e}},Yo=function(r,t){r===void 0&&(r=[]);var e=[],n=[];r.forEach(function(f){e.push(f.x),n.push(f.y)});var o=Math.min.apply(Math,Gr([],qt(e),!1)),i=Math.max.apply(Math,Gr([],qt(e),!1)),a=Math.min.apply(Math,Gr([],qt(n),!1)),s=Math.max.apply(Math,Gr([],qt(n),!1)),l=i-o,u=s-a;return t&&(l+=t,u+=t),{centerX:(o+i)/2,centerY:(a+s)/2,maxX:i,maxY:s,minX:o,minY:a,x:(o+i)/2,y:(a+s)/2,height:u,width:l}},ea=function(r){var t=r.minX,e=r.minY,n=r.maxX,o=r.maxY;return[{x:t,y:e},{x:n,y:e},{x:n,y:o},{x:t,y:o}]},gi=function(r,t){var e=r.x,n=r.y;return e<t.minX||e>t.maxX||n<t.minY||n>t.maxY},iv=function(r,t){return t<r.minX||t>r.maxX?[]:[{x:t,y:r.minY},{x:t,y:r.maxY}]},av=function(r,t){return t<r.minY||t>r.maxY?[]:[{x:r.minX,y:t},{x:r.maxX,y:t}]},sv=function(r,t){return Gr(Gr([],qt(iv(r,t.x)),!1),qt(av(r,t.y)),!1)},ks=function(r,t){return Math.abs(r.x-t.x)+Math.abs(r.y-t.y)},lv=function(r,t){var e=-2,n=0;return t.forEach(function(o){o&&(r.x===o.x&&(n+=e),r.y===o.y&&(n+=e))}),n},Pu=function(r,t,e,n,o){return ks(r,t)+ks(r,e)+lv(r,[t,e,n,o])},oc=function(r,t,e,n,o){o||(o=0),r.unshift(t[n]),e[n]&&e[n]!==n&&o<=100&&oc(r,t,e,e[n],o+1)},uv=function(r,t){var e=r.indexOf(t);e>-1&&r.splice(e,1)},mo=function(r,t,e,n){var o=t.x-r.x,i=t.y-r.y,a=n.x-e.x,s=n.y-e.y,l=(-i*(r.x-e.x)+o*(r.y-e.y))/(-a*i+o*s),u=(a*(r.y-e.y)-s*(r.x-e.x))/(-a*i+o*s);return l>=0&&l<=1&&u>=0&&u<=1},Du=function(r,t,e){if(e.width===0&&e.height===0)return!1;var n=qt(ea(e),4),o=n[0],i=n[1],a=n[2],s=n[3];return mo(r,t,o,i)||mo(r,t,o,s)||mo(r,t,i,a)||mo(r,t,a,s)},dv=function(r,t,e,n){var o=[];return r.forEach(function(i){i!==t&&(i.x===t.x||i.y===t.y)&&!Du(i,t,e)&&!Du(i,t,n)&&o.push(i)}),Is(o)},fv=function(r,t,e,n,o,i,a){var s=[],l=[t],u={},f={},d={};t.id&&(f[t.id]=0,d[t.id]=Pu(t,e,t));var c={};r.forEach(function(v){v.id&&(c[v.id]=v)});for(var h=function(){var v,g=1/0;if(l.forEach(function(w){w.id&&d[w.id]<g&&(g=d[w.id],v=w)}),v===e&&e.id){var y=[];return oc(y,c,u,e.id),{value:y}}if(!v)return{value:[t,e]};uv(l,v),s.push(v),dv(r,v,n,o).forEach(function(w){if(s.indexOf(w)===-1&&(l.indexOf(w)===-1&&l.push(w),v!=null&&v.id&&(w!=null&&w.id))){var M=d[v.id]+ks(v,w);if(f[w.id]&&M>=f[w.id])return;u[w.id]=v.id,f[w.id]=M,d[w.id]=f[w.id]+Pu(w,e,t,i,a)}})};l.length;){var p=h();if(typeof p=="object")return p.value}return[t,e]},Ru=function(r){return Wt(r)},ic=function(r){for(var t=1;t<r.length-1;){var e=r[t-1],n=r[t],o=r[t+1];e.x===n.x&&n.x===o.x||e.y===n.y&&n.y===o.y?r.splice(t,1):t++}return r},Lu=function(r,t,e,n,o){var i=Ru(e),a=Ru(n),s=Ji(i,o),l=Ji(a,o),u=Qi(s,i,r),f=Qi(l,a,t);if(nv(s,l)){var d=hv(r,t,u,f);return Gr(Gr([r,u],qt(d),!1),[f,t],!1)}var c=Yo([u,f]),h=Tu(s,c),p=Tu(l,c),v=[];v=v.concat(ea(h)),v=v.concat(ea(p));var g={x:(r.x+t.x)/2,y:(r.y+t.y)/2};[c,h,p].forEach(function(w){v=v.concat(sv(w,g).filter(function(M){return gi(M,s)&&gi(M,l)}))}),[{x:u.x,y:f.y},{x:f.x,y:u.y}].forEach(function(w){gi(w,s)&&gi(w,l)&&v.push(w)}),v.unshift(u),v.push(f),v=Is(v);var y=fv(v,u,f,i,a,r,t);return y.unshift(r),y.push(t),y.length>2&&(y=ic(y)),Is(y)},cv=function(r){if(r.length===1){var t=qt(r,1),e=t[0];return[e,e]}else{for(var n=r[0],o=r[1],i=fr(n.x,n.y,o.x,o.y),a=1;a<r.length-1;a++){var s=r[a],l=r[a+1],u=fr(s.x,s.y,l.x,l.y);u>i&&(i=u,n=s,o=l)}return[n,o]}},ju=function(r,t,e){var n=Lr(r,e),o=Lr(t,e);return n&&o},Iu=function(r,t,e){var n=Lr(r,e),o=Lr(t,e),i=n&&o,a=n||o;return!i&&a},ku=function(r,t,e){for(var n=void 0,o=Wt(e),i=ea(o),a=0;a<i.length;a++){var s=mo(r,t,i[a],i[(a+1)%i.length]);s&&(n=[i[a],i[(a+1)%i.length]])}if(n)return rv(r,t,n[0],n[1])},ta=function(r,t){var e=void 0;return r.x===t.x?e=tt.VERTICAL:r.y===t.y&&(e=tt.HORIZONTAL),e},vn=function(r){var t=r.split(" "),e=[];return t&&t.forEach(function(n){var o=qt(n.split(","),2),i=o[0],a=o[1];e.push({x:Number(i),y:Number(a)})}),e},hv=function(r,t,e,n){var o=[],i=ta(r,e),a=ta(t,n);if(i===a)r.y===e.y?(o.push({x:e.x,y:(e.y+n.y)/2}),o.push({x:n.x,y:(e.y+n.y)/2})):(o.push({x:(e.x+n.x)/2,y:e.y}),o.push({x:(e.x+n.x)/2,y:n.y}));else{var s={x:e.x,y:n.y},l=Go(s,r,e),u=Go(s,t,n);if(l||u)s={x:n.x,y:e.y};else{var f=Bu(s,r,e),d=Bu(s,t,n);f&&d&&(s={x:n.x,y:e.y})}o.push(s)}return o},Bu=function(r,t,e){return r.x===t.x&&r.x===e.x||r.y===t.y&&r.y===e.y},ac=function(r){if(!r)return 0;for(var t=0,e=0;e<r.length;e++){var n=r.charCodeAt(e);r.match(/[A-Z]/)?t+=1.5:n>=1&&n<=126||n>=65376&&n<=65439?t+=1:t+=2}return t},pv=function(r){var t=r.start,e=r.end,n;if(t.x===e.x&&t.y===e.y)n="";else{var o={start:t,end:e,offset:10,verticalLength:5},i=zo(Rn(Rn({},o),{type:"start"})),a=zo(Rn(Rn({},o),{type:"end"}));n="M".concat(i.leftX," ").concat(i.leftY,`
    L`).concat(i.rightX," ").concat(i.rightY,`
    L`).concat(a.rightX," ").concat(a.rightY,`
    L`).concat(a.leftX," ").concat(a.leftY," z")}return{d:n,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}},Xu=function(r){var t=r.start,e=r.end,n=r.sourceNode,o=r.targetNode,i=r.offset,a=Wt(n),s=Wt(o),l=Ji(a,i),u=Ji(s,i),f=Qi(l,a,t),d=Qi(u,s,e);return{sNext:f,ePre:d}},Rl=function(r){var t=r.replace(/M/g,"").replace(/C/g,",").split(","),e=yi(t[0]),n=yi(t[1]),o=yi(t[2]),i=yi(t[3]);return[e,n,o,i]},yi=function(r){var t=qt(r.replace(/(^\s*)/g,"").split(" "),2),e=t[0],n=t[1];return{x:+e,y:+n}},Hu=function(r,t){var e=qt(r,4),n=e[0],o=e[1],i=e[2],a=e[3],s=og(n,o,i,a,t);return[s,r[3]]},sc=function(r,t){for(var e=r.x,n=r.y,o=vn(t),i=Number.MAX_SAFE_INTEGER,a,s=[],l=0;l<o.length;l++)s.push({start:o[l],end:o[(l+1)%o.length]});if(s.forEach(function(c){var h=c.start,p=c.end;if(h.x===p.x){var v={x:h.x,y:n},g=Go(v,h,p);if(g){var y=Math.abs(h.x-e);y<i&&(i=y,a=v)}}else if(h.y===p.y){var v={x:e,y:h.y},g=Go(v,h,p);if(g){var y=Math.abs(h.y-n);y<i&&(i=y,a=v)}}}),!a){var u=s[0],f=u.start,d=u.end;a={x:f.x+(d.x-f.x)/2,y:f.y+(d.y-f.y)/2}}return a},vv=function(r){return Pn(r,["id","type","sourceNodeId","sourceAnchorId","targetNodeId","targetAnchorId","pointsList","startPoint","endPoint","properties"])},Gu=function(r,t){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))};function gv(r,t){return typeof t!="function"?function(e,n,o){return Object.assign({type:r.edgeType},o)}:function(e,n,o){var i=t(e,n,o);return i?typeof i=="string"?Object.assign({},o,{type:i}):Object.assign({type:i},o):{type:r.edgeType}}}var yv=function(r){var t=r.rows,e=r.rowsLength,n=r.fontSize,o=0;return Oe(t,function(i){var a=ac(i);o=a>o?a:o}),{width:Math.ceil(o/2)*n+n/4,height:e*(n+2)+n/4}},En=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},mi=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))};function Un(r,t,e){return e&&t*Math.round(r/t)||r}function mv(r,t,e){if(!r)return[];var n=Math.min.apply(Math,mi([],En(r.map(function(v){return v[0]})),!1)),o=Math.max.apply(Math,mi([],En(r.map(function(v){return v[0]})),!1)),i=Math.min.apply(Math,mi([],En(r.map(function(v){return v[1]})),!1)),a=Math.max.apply(Math,mi([],En(r.map(function(v){return v[1]})),!1)),s=-n,l=-i,u=r.map(function(v){var g=En(v,2),y=g[0],w=g[1];return[y+s,w+l]}),f=o-n,d=a-i,c=t?t/f:1,h=e?e/d:1,p=Math.min(c,h);return u.map(function(v){var g=En(v,2),y=g[0],w=g[1];return[y*p,w*p]})}var ts=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},rs=function(r,t,e){var n=ts(r,2),o=n[0],i=n[1],a=ts(t,2),s=a[0],l=a[1],u=ts(e,2),f=u[0],d=u[1];return o>s&&o<f&&i>l&&i<d},lc=function(r,t){var e=t.multipleSelectKey,n=!1;switch(e){case"meta":n=r.metaKey;break;case"alt":n=r.altKey;break;case"shift":n=r.shiftKey;break;case"ctrl":n=r.ctrlKey;break;default:n=!1;break}return n},Ll=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})();function zu(r,t){return r instanceof Ot&&t instanceof Ot}var uc=(function(r){Ll(t,r);function t(e,n,o){var i=r.call(this,3)||this;return i[0]=e,i[1]=n,i[2]=o,i.x=e,i.y=n,i.z=o,Object.setPrototypeOf(i,t.prototype),i}return t.prototype.add=function(e){if(zu(this,e))return new Ot(this.x+e.x,this.y+e.y);var n=this.z+e.z;return new Bs((this.x+e.x)/n,(this.y+e.y)/n)},t.prototype.subtract=function(e){if(zu(this,e))return new Ot(this.x-e.x,this.y-e.y);var n=this.z-e.z;return n===0?new Ot(this.x-e.x,this.y-e.y):new Bs((this.x-e.x)/n,(this.y-e.y)/n)},t})(Array),Ot=(function(r){Ll(t,r);function t(e,n,o){var i=r.call(this,e,n,o??0)||this;return Object.setPrototypeOf(i,t.prototype),i}return t.prototype.toString=function(){return"Vector"},t.prototype.dot=function(e){var n=this;return e.reduce(function(o,i,a){return o+i*n[a]})},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.getLength=function(){return Math.hypot(this.x,this.y)},t.prototype.normalize=function(){var e=this.getLength();return new t(this.x/e,this.y/e)},t.prototype.crossZ=function(e){return this.x*e.y-this.y*e.x},t.prototype.angle=function(e){var n=this.crossZ(e),o=Math.acos(this.normalize().dot(e.normalize()));return n>=0?o:-o},t})(uc),Bs=(function(r){Ll(t,r);function t(e,n){var o=r.call(this,e,n,1)||this;return Object.setPrototypeOf(o,t.prototype),o}return t.prototype.toString=function(){return"Point"},t})(uc),Ya=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),bn=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},ns=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},ai=(function(r){Ya(t,r);function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=r.call(this,e.length)||this;return o.fill(new Array(3)),e.forEach(function(i,a){o[a]=i}),o.columns=e[0].length,o.rows=e.length,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.getRow=function(e){return this[e]},t.prototype.getColumn=function(e){return ns([],bn(this.map(function(n){return n[e]})),!1)},t.prototype.transpose=function(){for(var e=[],n=0;n<this.columns;n++)e.push(this.getColumn(n));return new(t.bind.apply(t,ns([void 0],bn(e),!1)))},t.prototype.cross=function(e){var n=new Array(this.rows).fill("").map(function(){return[]});if(this.columns===e.rows)for(var o=0;o<this.rows;o++)for(var i=this.getRow(o),a=function(l){var u=e.getColumn(l);n[o][l]=i.reduce(function(f,d,c){return f+d*u[c]},0)},s=0;s<e.columns;s++)a(s);return new(t.bind.apply(t,ns([void 0],bn(n),!1)))},t.prototype.to2D=function(){return this.map(function(e){return[e[0],e[1]]})},t.prototype.toPoints=function(){return this.map(function(e){return new Bs(e[0],e[1])})},t.prototype.toString=function(){var e=bn(this[0],2),n=e[0],o=e[1],i=bn(this[1],2),a=i[0],s=i[1],l=bn(this[2],2),u=l[0],f=l[1];return"matrix(".concat(n," ").concat(o," ").concat(a," ").concat(s," ").concat(u," ").concat(f,")")},t.prototype.translate=function(e,n){return this.cross(new ra(e,n))},t.prototype.rotate=function(e){return this.cross(new _v(e))},t.prototype.scale=function(e,n){return this.cross(new xv(e,n))},t})(Array),_v=(function(r){Ya(t,r);function t(e){var n=r.call(this,new Ot(+Math.cos(e).toFixed(2),+Math.sin(e).toFixed(2),0),new Ot(-Math.sin(e).toFixed(2),+Math.cos(e).toFixed(2),0),new Ot(0,0,1))||this;return Object.setPrototypeOf(n,t.prototype),n}return t.prototype.inverse=function(){return this.transpose()},t})(ai),xv=(function(r){Ya(t,r);function t(e,n){var o=r.call(this,new Ot(e,0,0),new Ot(0,n,0),new Ot(0,0,1))||this;return o.sx=e,o.sy=n,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.inverse=function(){return new t(1/this.sx,1/this.sy)},t})(ai),ra=(function(r){Ya(t,r);function t(e,n){var o=r.call(this,new Ot(1,0,0),new Ot(0,1,0),new Ot(e,n,1))||this;return o.tx=e,o.ty=n,Object.setPrototypeOf(o,t.prototype),o}return t.prototype.inverse=function(){return new t(-this.tx,-this.ty)},t})(ai);qh({});var na=function(){return na=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},na.apply(this,arguments)},wv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Xs=function(r){var t=r.anchors;return t},oa=function(r,t){for(var e=t.nodes,n,o=e.length-1;o>=0;o--){var i=e[o],a=Sv(r,i);if(a){var s=i.getTargetAnchor(r);if(s){var l={node:i,anchorIndex:s.index,anchor:s.anchor};(!n||Ev(i,n.node,t))&&(n=l)}}}return n},Ev=function(r,t,e){return r.zIndex>t.zIndex?!0:e.nodesMap[r.id].index>e.nodesMap[t.id].index},bv=function(r,t){for(var e=Xs(t),n,o=Number.MAX_SAFE_INTEGER,i=0;i<e.length;i++){var a=fr(r.x,r.y,e[i].x,e[i].y);a<o&&(o=a,n={index:i,anchor:na(na({},e[i]),{x:e[i].x,y:e[i].y,id:e[i].id})})}return n},fr=function(r,t,e,n){return Math.hypot(r-e,t-n)},Lr=function(r,t,e){e===void 0&&(e=0);var n=!1,o=Wt(t),i=wv(new ai([r.x,r.y,1]).translate(-t.x,-t.y).rotate(-t.rotate).translate(t.x,t.y)[0],2),a=i[0],s=i[1],l={x:a,y:s};return l.x>=o.minX-e&&l.x<=o.maxX+e&&l.y>=o.minY-e&&l.y<=o.maxY+e&&(n=!0),n},Sv=function(r,t){return Lr(r,t,5)},Wt=function(r){var t=r.x,e=r.y,n=r.width,o=r.height;return{minX:t-n/2,minY:e-o/2,maxX:t+n/2,maxY:e+o/2,x:t,y:e,width:n,height:o,centerX:t,centerY:e}},Ov=function(r){var t=r,e=t.x,n=t.y,o=t.width,i=t.height,a=t.radius;return[{x:e-o/2+a,y:n-i/2+a,r:a},{x:e+o/2-a,y:n-i/2+a,r:a},{x:e-o/2+a,y:n+i/2-a,r:a},{x:e+o/2-a,y:n+i/2-a,r:a}]},Yu=function(r,t,e){var n=Ov(e),o,i=Number.MAX_SAFE_INTEGER;return n.forEach(function(a){var s=fr(r.x,r.y,a.x,a.y);s<i&&(i=s,o=a)}),Hs(r,t,o)},Hs=function(r,t,e){var n,o=e.x,i=e.y,a=e.r;if(t===tt.HORIZONTAL){var s=o-Math.sqrt(a*a-(r.y-i)*(r.y-i)),l=o+Math.sqrt(a*a-(r.y-i)*(r.y-i)),u=Math.abs(s-r.x)<Math.abs(l-r.x)?s:l;n={x:u,y:r.y}}else if(t===tt.VERTICAL){var f=i-Math.sqrt(a*a-(r.x-o)*(r.x-o)),d=i+Math.sqrt(a*a-(r.x-o)*(r.x-o)),c=Math.abs(f-r.y)<Math.abs(d-r.y)?f:d;n={x:r.x,y:c}}return n},Fu=function(r,t){var e=t,n=!1,o=e.x,i=e.y,a=e.width,s=e.height,l=e.radius,u={minX:o-a/2+l,maxX:o+a/2-l,minY:i-s/2+l,maxY:i+s/2-l};return r.y===i+s/2||r.y===i-s/2?n=r.x>u.minX&&r.x<u.maxX:(r.x===o+a/2||r.x===o-a/2)&&(n=r.y>u.minY&&r.y<u.maxY),n},$u=function(r,t,e){var n,o=e,i=o.x,a=o.y,s=o.rx,l=o.ry;if(t===tt.HORIZONTAL){var u=i-Math.sqrt(s*s-(r.y-a)*(r.y-a)*s*s/(l*l)),f=i+Math.sqrt(s*s-(r.y-a)*(r.y-a)*s*s/(l*l)),d=Math.abs(u-r.x)<Math.abs(f-r.x)?u:f;n={x:d,y:r.y}}else if(t===tt.VERTICAL){var c=a-Math.sqrt(l*l-(r.x-i)*(r.x-i)*l*l/(s*s)),h=a+Math.sqrt(l*l-(r.x-i)*(r.x-i)*l*l/(s*s)),p=Math.abs(c-r.y)<Math.abs(h-r.y)?c:h;n={x:r.x,y:p}}return n},_i=function(r,t,e){for(var n=e.pointsPosition,o=Number.MAX_SAFE_INTEGER,i,a=[],s=0;s<n.length;s++)a.push({start:n[s],end:n[(s+1)%n.length]});return a.forEach(function(l){var u=l.start,f=l.end,d=u,c=f;u.x>f.x&&(d=f,c=u);var h={x:r.x,y:r.y};if(d.x===c.x&&t===tt.HORIZONTAL&&(h={x:d.x,y:r.y}),d.y===c.y&&t===tt.VERTICAL&&(h={x:r.x,y:d.y}),d.x!==c.x&&d.y!==c.y){var p=(c.y-d.y)/(c.x-d.x),v=(d.x*c.y-c.x*d.y)/(d.x-c.x);t===tt.HORIZONTAL?h={x:(r.y-v)/p,y:r.y}:t===tt.VERTICAL&&(h={x:r.x,y:p*r.x+v})}var g=Go(h,u,f);if(g){var y=fr(h.x,h.y,r.x,r.y);y<o&&(o=y,i=h)}}),i},Mv=function(r){var t=Pn(r,["id","type","x","y","text","label","properties","virtual","rotate","resizable","rotatable"]);return t},Wu=function(r,t,e,n){var o=r.x,i=r.y;return t.x>r.x?o=r.x+e/2:t.x<r.x&&(o=r.x-e/2),t.y>r.y?i=r.y+n/2:t.y<r.y&&(i=r.y-n/2),{x:o,y:i}},dc=function(r){var t=r.rows,e=r.style,n=r.rowsLength,o=r.className,i=document.createElement("div");i.className=o,i.style.fontSize="".concat(e.fontSize),i.style.width="".concat(e.width),i.style.lineHeight="".concat(e.lineHeight),i.style.padding="".concat(e.padding),e.fontFamily&&(i.style.fontFamily="".concat(e.fontFamily)),n>1?t.forEach(function(s){var l=document.createElement("div");l.textContent=s,i.appendChild(l)}):i.textContent=t[0],document.body.appendChild(i);var a=i.clientHeight;return document.body.removeChild(i),a},Uu=function(r){var t=r.rows,e=r.rowsLength,n=r.fontSize,o=0;return t&&t.forEach(function(i){var a=ac(i);o=a>o?a:o}),{width:Math.ceil(o/2)*n+n/4,height:e*(n+2)+n/4}},ia=function(r){return typeof r!="object"?{isAllPass:!!r,msg:r?"":""}:r};let xi;const Av=new Uint8Array(16);function Nv(){if(!xi&&(xi=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!xi))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return xi(Av)}const bt=[];for(let r=0;r<256;++r)bt.push((r+256).toString(16).slice(1));function Cv(r,t=0){return bt[r[t+0]]+bt[r[t+1]]+bt[r[t+2]]+bt[r[t+3]]+"-"+bt[r[t+4]]+bt[r[t+5]]+"-"+bt[r[t+6]]+bt[r[t+7]]+"-"+bt[r[t+8]]+bt[r[t+9]]+"-"+bt[r[t+10]]+bt[r[t+11]]+bt[r[t+12]]+bt[r[t+13]]+bt[r[t+14]]+bt[r[t+15]]}const Tv=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Vu={randomUUID:Tv};function Pv(r,t,e){if(Vu.randomUUID&&!r)return Vu.randomUUID();r=r||{};const n=r.random||(r.rng||Nv)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Cv(n)}var Fr=function(){return Pv()},wo=new Map,fc=function(r){var t=Fr();function e(){r();var o=wo.get(t);if(o){var i=window.requestAnimationFrame(e);wo.set(t,i)}}var n=window.requestAnimationFrame(e);return wo.set(t,n),t},aa=function(r){var t=wo.get(r);t&&(window.cancelAnimationFrame(t),wo.delete(r))},Fo=function(){return Fo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Fo.apply(this,arguments)},Dv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function cc(r){var t=r.x,e=t===void 0?0:t,n=r.y,o=n===void 0?0:n,i=r.value,a=r.fontSize,s=a===void 0?12:a,l=r.fill,u=l===void 0?"currentColor":l,f=r.overflowMode,d=f===void 0?"default":f,c=r.textWidth,h=c===void 0?void 0:c,p=r.model,v={x:e,y:o,fill:u,fontSize:s,textAnchor:"middle",dominantBaseline:"central"};if(Oe(Wr(r),function(P){var S=Dv(P,2),E=S[0],T=S[1];typeof T!="object"&&(v[E]=T)}),i){var g=String(i).split(/[\r\n]/g),y=g.length;if(d!=="default"){var w=p.BaseType,M=p.modelType;if(w===at.NODE&&M!==Ae.TEXT_NODE||w===at.EDGE&&h)return Rv(r)}if(y>1){var C=g.map(function(P,S){var E=s+2,T=(S-(y-1)/2)*E;return k("tspan",{className:"lf-text-tspan",x:e,y:o+T,children:P})});return k("text",Fo({},v,{children:C}))}return k("text",Fo({},v,{children:i}))}return null}function Rv(r){var t=r.x,e=r.y,n=r.value,o=r.model,i=r.textWidth,a=r.fontSize,s=a===void 0?12:a,l=r.lineHeight,u=r.fontFamily,f=u===void 0?"":u,d=r.wrapPadding,c=d===void 0?"0, 0":d,h=r.overflowMode,p=o.width,v=o.height,g=o.textHeight,y=i||p,w=String(n).split(/[\r\n]/g),M=w.length,C=dc({rows:w,style:{fontSize:"".concat(s,"px"),width:"".concat(y,"px"),fontFamily:f,lineHeight:l,padding:c},rowsLength:M,className:"lf-get-text-height"}),P=v>C?v:C;g&&(P=g);var S=h==="ellipsis";return S&&(P=s+2),k("g",{children:k("foreignObject",{width:y,height:P,x:t-y/2,y:e-P/2,style:{overflow:"visible",textAlign:"left"},children:k("div",{className:"lf-node-text-auto-wrap",style:{minHeight:P,width:y,padding:c},children:k("div",{className:S?"lf-node-text-ellipsis-content":"lf-node-text-auto-wrap-content",title:S?w.join(""):"",style:Fo({},r),children:w.map(function(E){return k("div",{className:"lf-node-text--auto-wrap-inner",children:E})})})})})})}var Gs=function(){return Gs=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Gs.apply(this,arguments)},Lv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Vn(r){var t={x1:10,y1:10,x2:20,y2:20,stroke:"black"};return Oe(Wr(r),function(e){var n=Lv(e,2),o=n[0],i=n[1];(o==="style"||typeof i!="object")&&(t[o]=i)}),k("line",Gs({},t))}var zs=function(){return zs=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},zs.apply(this,arguments)},jv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Jt(r){var t=r.x,e=r.y,n=r.width,o=r.height,i=r.className,a=r.strokeWidth,s=r.radius,l=s===void 0?0:s,u=t-n/2,f=e-o/2,d={};return d["stroke-width"]=a,Oe(Wr(r),function(c){var h=jv(c,2),p=h[0],v=h[1];typeof v!="object"&&(d[p]=v)}),i?d.className="lf-basic-shape ".concat(i):d.className="lf-basic-shape",l&&(d.rx=l,d.ry=l),d.x=u,d.y=f,k("rect",zs({},d))}var Ys=function(){return Ys=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ys.apply(this,arguments)},Iv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function $o(r){var t={d:""};return Oe(Wr(r),function(e){var n=Iv(e,2),o=n[0],i=n[1];(o==="style"||typeof i!="object")&&(t[o]=i)}),k("path",Ys({},t))}var Fs=function(){return Fs=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Fs.apply(this,arguments)},kv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Kn(r){var t=r.x,e=t===void 0?0:t,n=r.y,o=n===void 0?0:n,i=r.r,a=i===void 0?4:i,s=r.className,l={cx:e,cy:o,r:a,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return Oe(Wr(r),function(u){var f=kv(u,2),d=f[0],c=f[1];typeof c!="object"&&(l[d]=c)}),s?l.className="lf-basic-shape ".concat(s):l.className="lf-basic-shape",k("circle",Fs({},l))}var $s=function(){return $s=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},$s.apply(this,arguments)},Bv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Xv(r){var t=r.x,e=t===void 0?0:t,n=r.y,o=n===void 0?0:n,i=r.rx,a=i===void 0?4:i,s=r.ry,l=s===void 0?4:s,u=r.className,f={cx:e,cy:o,rx:a,ry:l,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return Oe(Wr(r),function(d){var c=Bv(d,2),h=c[0],p=c[1];typeof p!="object"&&(f[h]=p)}),u?f.className="lf-basic-shape ".concat(u):f.className="lf-basic-shape",k("ellipse",$s({},f))}var sa=function(){return sa=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},sa.apply(this,arguments)},Hv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Gv(r,t){var e=r.map(function(w){return{x:w[0],y:w[1]}}),n=e.length;if(n<3)return"";for(var o=Math.abs(t),i="",a=0;a<n;a++){var s=e[(a-1+n)%n],l=e[a],u=e[(a+1)%n],f={x:l.x-s.x,y:l.y-s.y},d={x:u.x-l.x,y:u.y-l.y},c=Math.hypot(f.x,f.y),h=Math.hypot(d.x,d.y),p={x:f.x/c,y:f.y/c},v={x:d.x/h,y:d.y/h},g={x:l.x-p.x*o,y:l.y-p.y*o},y={x:l.x+v.x*o,y:l.y+v.y*o};a===0?i+="M ".concat(g.x," ").concat(g.y," "):i+="L ".concat(g.x," ").concat(g.y," "),i+="Q ".concat(l.x," ").concat(l.y," ").concat(y.x," ").concat(y.y," ")}return i+="Z",i}function jl(r){var t=r.points,e=t===void 0?[]:t,n=r.className,o=r.radius,i={fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1,points:""};if(Oe(Wr(r),function(s){var l=Hv(s,2),u=l[0],f=l[1];typeof f!="object"&&(i[u]=f)}),n?i.classNmae="lf-basic-shape ".concat(n):i.className="lf-basic-shape",o){var a=Gv(e,o);return i.d=a,k("path",sa({},i))}else return i.points=e.map(function(s){return s.join(",")}).join(" "),k("polygon",sa({},i))}var Ws=function(){return Ws=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ws.apply(this,arguments)},zv=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i};function Yv(r){var t=r.className,e={points:"",fill:"none"};return Oe(Wr(r),function(n){var o=zv(n,2),i=o[0],a=o[1];(i==="style"||typeof a!="object")&&(e[i]=a)}),t&&(e.className="".concat(t)),k("polyline",Ws({},e))}var hc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Wo=function(){return Wo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Wo.apply(this,arguments)},Fv=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},$v=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ye;(function(r){r[r.LEFT_TOP=0]="LEFT_TOP",r[r.RIGHT_TOP=1]="RIGHT_TOP",r[r.RIGHT_BOTTOM=2]="RIGHT_BOTTOM",r[r.LEFT_BOTTOM=3]="LEFT_BOTTOM"})(Ye||(Ye={}));var Wv=(function(r){hc(t,r);function t(e){var n=r.call(this)||this;n.isShiftPressed=!1,n.bindKeyboardEvents=function(){document.addEventListener("keydown",n.handleKeyDown),document.addEventListener("keyup",n.handleKeyUp)},n.handleKeyDown=function(s){s.key==="Shift"&&(n.isShiftPressed=!0)},n.handleKeyUp=function(s){s.key==="Shift"&&(n.isShiftPressed=!1)},n.updateEdgePointByAnchors=function(){var s=n.nodeModel,l=s.id,u=s.anchors,f=n.graphModel.getNodeEdges(l);Oe(f,function(d){if(d.sourceNodeId===l){var c=hn(u,function(h){return h.id===d.sourceAnchorId});c&&d.updateStartPoint({x:c.x,y:c.y})}else if(d.targetNodeId===l){var c=hn(u,function(p){return p.id===d.targetAnchorId});c&&d.updateEndPoint({x:c.x,y:c.y})}})},n.triggerResizeEvent=function(s,l,u,f,d,c){n.graphModel.eventCenter.emit(ne.NODE_RESIZE,{preData:s,data:l,deltaX:u,deltaY:f,index:d,model:c})},n.recalcResizeInfo=function(s,l,u,f,d){u===void 0&&(u=1),f===void 0&&(f=!1),d===void 0&&(d=!1);var c=xe(l),h=c.deltaX,p=c.deltaY,v=c.width,g=c.height,y=c.PCTResizeInfo;if(y){var w=4,M=0,C=0;switch(s){case Ye.LEFT_TOP:C=(h*-1-p)/w;break;case Ye.RIGHT_TOP:C=(h-p)/w;break;case Ye.RIGHT_BOTTOM:C=(h+p)/w;break;case Ye.LEFT_BOTTOM:C=(h*-1+p)/w;break}C!==0&&(M=Math.round(C/y.ResizeBasis.basisHeight*1e5)/1e3),y.ResizePCT.widthPCT=Math.max(Math.min(y.ResizePCT.widthPCT+M,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit),y.ResizePCT.heightPCT=Math.max(Math.min(y.ResizePCT.heightPCT+M,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit);var P=Math.round(y.ResizePCT.widthPCT*y.ResizeBasis.basisWidth/100),S=Math.round(y.ResizePCT.heightPCT*y.ResizeBasis.basisHeight/100);switch(s){case Ye.LEFT_TOP:h=v-P,p=g-S;break;case Ye.RIGHT_TOP:h=P-v,p=g-S;break;case Ye.RIGHT_BOTTOM:h=P-v,p=S-g;break;case Ye.LEFT_BOTTOM:h=v-P,p=S-g;break}return c}switch(s){case Ye.LEFT_TOP:c.width=f?v:v-h*u,c.height=d?g:g-p*u;break;case Ye.RIGHT_TOP:c.width=f?v:v+h*u,c.height=d?g:g-p*u;break;case Ye.RIGHT_BOTTOM:c.width=f?v:v+h*u,c.height=d?g:g+p*u;break;case Ye.LEFT_BOTTOM:c.width=f?v:v-h*u,c.height=d?g:g+p*u;break}return c},n.resizeNode=function(s){var l=s.deltaX,u=s.deltaY,f=n.index,d=n.props,c=d.model,h=d.graphModel,p=d.x,v=d.y;pc({x:p,y:v,deltaX:l,deltaY:u,index:f,nodeModel:c,graphModel:h,forceProportional:n.isShiftPressed,cancelCallback:function(){n.dragHandler.cancelDrag()}})},n.onDragStart=function(){n.graphModel.selectNodeById(n.nodeModel.id)},n.onDragging=function(s){var l=s.deltaX,u=s.deltaY,f=n.graphModel.transformModel,d=$v(f.fixDeltaXY(l,u),2),c=d[0],h=d[1];n.resizeNode({deltaX:c,deltaY:h})},n.onDragEnd=function(){var s=n.nodeModel.x,l=n.nodeModel.y;n.nodeModel.moveTo(s,l),n.updateEdgePointByAnchors()};var o=e.index,i=e.model,a=e.graphModel;return n.index=o,n.nodeModel=i,n.graphModel=a,n.dragHandler=new rr({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:a.gridSize}),n.bindKeyboardEvents(),n}return t.prototype.componentWillUnmount=function(){this.dragHandler.destroy(),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},t.prototype.render=function(){var e=this.props,n=e.x,o=e.y,i=e.direction,a=e.model,s=a.getResizeControlStyle(),l=s.width,u=s.height,f=Fv(s,["width","height"]);return k("g",{className:"lf-resize-control lf-resize-control-".concat(i),children:[k(Jt,Wo({className:"lf-resize-control-content",x:n,y:o,width:l??7,height:u??7},f)),k(Jt,{className:"lf-resize-control-content",x:n,y:o,width:25,height:25,fill:"transparent",stroke:"transparent",onPointerDown:this.dragHandler.handleMouseDown})]})},t})(De),Uv=(function(r){hc(t,r);function t(){return r.call(this)||this}return t.prototype.getResizeControl=function(){var e=this.props,n=e.model,o=e.graphModel,i=Wt(n),a=i.minX,s=i.minY,l=i.maxX,u=i.maxY,f=[{index:Ye.LEFT_TOP,direction:"nw",x:a,y:s},{index:Ye.RIGHT_TOP,direction:"ne",x:l,y:s},{index:Ye.RIGHT_BOTTOM,direction:"se",x:l,y:u},{index:Ye.LEFT_BOTTOM,direction:"sw",x:a,y:u}];return gr(f,function(d){return k(Wv,Wo({},d,{model:n,graphModel:o}))})},t.prototype.getResizeOutline=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.getResizeOutlineStyle();return k(Jt,Wo({},s,{x:n,y:o,width:i,height:a}))},t.prototype.render=function(){return k("g",{className:"lf-resize-control-group",children:[this.getResizeOutline(),this.getResizeControl()]})},t})(De);function Vv(r,t){var e=r.x,n=r.y,o=t.x,i=t.y,a={x:e+(o-e)/2,y:n+(i-n)/2};return a}function _o(r,t,e){var n=Kv(e),o=r.x-t.x,i=r.y-t.y,a=o*Math.cos(n)-i*Math.sin(n)+t.x,s=o*Math.sin(n)+i*Math.cos(n)+t.y;return{x:a,y:s}}function Kv(r){return r*Math.PI/180}function Zv(r){return r/Math.PI*180}function qv(r,t,e,n,o,i,a,s){o===void 0&&(o=!1),i===void 0&&(i=!1);var l={x:e.x-(r.x-e.x),y:e.y-(r.y-e.y)},u=Vv(l,t),f=_o(t,u,-n),d=_o(l,u,-n);if(o){var c=Math.abs(f.x-d.x),h=c-a;u.x>f.x?u.x=u.x+h/2:u.x=u.x-h/2}if(i){var p=Math.abs(f.y-d.y),v=p-s;u.y>f.y?u.y=u.y+v/2:u.y=u.y-v/2}if(o||i){var g=_o(d,u,n),y=g.x-l.x,w=g.y-l.y;u.x=u.x-y,u.y=u.y-w,d=_o(l,u,-n),f={x:u.x-(d.x-u.x),y:u.y-(d.y-u.y)}}var M=Math.abs(f.x-d.x),C=Math.abs(f.y-d.y);return o&&(M=a),i&&(C=s),{width:M,height:C,center:u}}function Jv(r,t,e,n,o,i,a,s,l){s===void 0&&(s=!1),l===void 0&&(l=!1);var u=t.deltaX,f=t.deltaY,d=t.width,c=t.height,h=Zv(e),p={x:n,y:o},v={x:i,y:a},g=_o(p,v,h),y={x:g.x+u,y:g.y+f},w=qv(g,y,v,h,s,l,d,c),M=w.width,C=w.height,P=w.center;return t.width=M*r,t.height=C*r,t.deltaX=(P.x-v.x)*2,t.deltaY=(P.y-v.y)*2,t}var Qv=function(r,t,e,n,o,i,a,s,l,u,f){e===void 0&&(e=1),n===void 0&&(n=!1),o===void 0&&(o=!1),i===void 0&&(i=0),f===void 0&&(f=!1);var d=xe(t),c=d.deltaX,h=d.deltaY,p=d.width,v=d.height,g=d.PCTResizeInfo;if(g){var y=4,w=0,M=0;switch(r){case Ye.LEFT_TOP:M=(c*-1-h)/y;break;case Ye.RIGHT_TOP:M=(c-h)/y;break;case Ye.RIGHT_BOTTOM:M=(c+h)/y;break;case Ye.LEFT_BOTTOM:M=(c*-1+h)/y;break}M!==0&&(w=Math.round(M/g.ResizeBasis.basisHeight*1e5)/1e3),g.ResizePCT.widthPCT=Math.max(Math.min(g.ResizePCT.widthPCT+w,g.ScaleLimit.maxScaleLimit),g.ScaleLimit.minScaleLimit),g.ResizePCT.heightPCT=Math.max(Math.min(g.ResizePCT.heightPCT+w,g.ScaleLimit.maxScaleLimit),g.ScaleLimit.minScaleLimit);var C=Math.round(g.ResizePCT.widthPCT*g.ResizeBasis.basisWidth/100),P=Math.round(g.ResizePCT.heightPCT*g.ResizeBasis.basisHeight/100);switch(r){case Ye.LEFT_TOP:c=p-C,h=v-P;break;case Ye.RIGHT_TOP:c=C-p,h=v-P;break;case Ye.RIGHT_BOTTOM:c=C-p,h=P-v;break;case Ye.LEFT_BOTTOM:c=p-C,h=P-v;break}return d}if(i%(2*Math.PI)!==0&&a!==void 0&&s!==void 0)return Jv(e,d,i,a,s,l,u,n,o);if(f){var S=p/v,E=0,T=p,j=v;switch(r){case Ye.LEFT_TOP:E=Math.abs(c)>Math.abs(h)?-c:-h,S>=1?(T=p+E,j=T/S):(j=v+E,T=j*S),d.width=T,d.height=j,d.deltaX=p-T,d.deltaY=v-j;break;case Ye.RIGHT_TOP:E=Math.abs(c)>Math.abs(h)?c:-h,S>=1?(T=p+E,j=T/S):(j=v-E,T=j*S),d.width=T,d.height=j,d.deltaX=T-p,d.deltaY=v-j;break;case Ye.RIGHT_BOTTOM:E=Math.abs(c)>Math.abs(h)?c:h,S>=1?(T=p+E,j=T/S):(j=v+E,T=j*S),d.width=T,d.height=j,d.deltaX=T-p,d.deltaY=j-v;break;case Ye.LEFT_BOTTOM:E=Math.abs(c)>Math.abs(h)?-c:h,S>=1?(T=p-E,j=T/S):(j=v+E,T=j*S),d.width=T,d.height=j,d.deltaX=p-T,d.deltaY=j-v;break}return d}switch(r){case Ye.LEFT_TOP:d.width=n?p:p-c*e,d.height=o?v:v-h*e;break;case Ye.RIGHT_TOP:d.width=n?p:p+c*e,d.height=o?v:v-h*e;break;case Ye.RIGHT_BOTTOM:d.width=n?p:p+c*e,d.height=o?v:v+h*e;break;case Ye.LEFT_BOTTOM:d.width=n?p:p-c*e,d.height=o?v:v+h*e;break}return d},eg=function(r,t){var e=r.id,n=r.anchors,o=t.getNodeEdges(e);Oe(o,function(i){if(i.sourceNodeId===e){var a=hn(n,function(s){return s.id===i.sourceAnchorId});a&&i.updateStartPoint({x:a.x,y:a.y})}else if(i.targetNodeId===e){var a=hn(n,function(l){return l.id===i.targetAnchorId});a&&i.updateEndPoint({x:a.x,y:a.y})}})},tg=function(r,t,e,n,o,i,a){a.eventCenter.emit(ne.NODE_RESIZE,{preData:r,data:t,deltaX:e,deltaY:n,index:o,model:i})},pc=function(r){var t=r.x,e=r.y,n=r.deltaX,o=r.deltaY,i=r.index,a=r.nodeModel,s=r.graphModel,l=r.cancelCallback,u=r.forceProportional,f=u===void 0?!1:u,d=a.r,c=a.rx,h=a.ry,p=a.width,v=a.height,g=a.PCTResizeInfo,y=a.minWidth,w=a.minHeight,M=a.maxWidth,C=a.maxHeight,P=a.rotate,S=a.x,E=a.y,T=y===M,j=w===C,q={width:d||c||p,height:d||h||v,deltaX:n,deltaY:o,PCTResizeInfo:g},ee=d||c&&h?1/2:1,he=t,ke=e,be=Qv(i,q,ee,T,j,P,he,ke,S,E,f);if(be.width<y||be.width>M||be.height<w||be.height>C){l==null||l();return}(P%(2*Math.PI)==0||g||he===void 0||ke===void 0)&&(be.deltaX=T?0:be.deltaX,be.deltaY=j?0:be.deltaY);var $e=a.getData(),rt=a.resize(be);$e.x===rt.x&&$e.y===rt.y||(eg(a,s),tg($e,rt,n,o,i,a,s))},rg=100,ng={x:1,y:0};function og(r,t,e,n,o){for(var i=function(h){if(h<0||h>1)throw new RangeError('The value range of parameter "t" is [0,1]');return{x:r.x*Math.pow(1-h,3)+3*t.x*h*Math.pow(1-h,2)+3*e.x*Math.pow(h,2)*(1-h)+n.x*Math.pow(h,3),y:r.y*Math.pow(1-h,3)+3*t.y*h*Math.pow(1-h,2)+3*e.y*Math.pow(h,2)*(1-h)+n.y*Math.pow(h,3)}},a=0,s=2,l=n.x,u=n.y,f=n;a<o&&s<50;){f=i(1-s/rg);var d=f.x,c=f.y;a=fr(l,u,d,c),s++}return f}function ig(r,t){return r.x*t.y-r.y*t.x}function ag(r,t){var e=[r.x,r.y,r.z],n=[t.x,t.y,t.z];return n.reduce(function(o,i,a){return o+i*e[a]})}function sg(r,t){var e=ig(r,t),n=Math.acos(ag(Ku(r),Ku(t)));return e>=0?n:-n}function Ku(r){var t=Math.hypot(r.x,r.y);return{x:r.x/t,y:r.y/t,z:0}}function lg(r){return sg(ng,r)}function ug(r){return r*(180/Math.PI)}var vc={baseNode:{fill:"#fff",stroke:"#000",strokeWidth:2},baseEdge:{stroke:"#000",strokeWidth:2},rect:{},circle:{},diamond:{},ellipse:{},polygon:{},text:{color:"#000",stroke:"none",fontSize:12,background:{fill:"transparent"}},anchor:{stroke:"#000",fill:"#fff",r:4,hover:{r:10,fill:"#949494",fillOpacity:.5,stroke:"#949494"}},anchorLine:{stroke:"#000",strokeWidth:2,strokeDasharray:"3,2"},nodeText:{color:"#000",overflowMode:"default",fontSize:12,lineHeight:1.2},edgeText:{textWidth:100,overflowMode:"default",fontSize:12,background:{fill:"#fff"}},line:{},polyline:{},bezier:{fill:"none",adjustLine:{stroke:"#949494"},adjustAnchor:{r:4,fill:"#949494",fillOpacity:1,stroke:"#949494"}},arrow:{offset:10,verticalLength:5},snapline:{stroke:"#949494",strokeWidth:1},edgeAdjust:{r:4,fill:"#fff",stroke:"#949494",strokeWidth:2},outline:{fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},edgeAnimation:{stroke:"red",strokeDasharray:"10,10",strokeDashoffset:"100%",animationName:"lf_animate_dash",animationDuration:"20s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"normal"},rotateControl:{stroke:"#000",fill:"#fff",strokeWidth:1.5},resizeControl:{width:7,height:7,fill:"#fff",stroke:"#000"},resizeOutline:{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},dg={rect:{radius:8},diamond:{radius:8},polygon:{radius:8},polyline:{radius:8},arrow:{strokeLinecap:"round",strokeLinejoin:"round",offset:10,verticalLength:5},snapline:{strokeLinecap:"round",strokeLinejoin:"round",stroke:"#949494",strokeWidth:1},outline:{radius:8,fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},resizeOutline:{radius:8,fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},fg={baseNode:{fill:"#23272e",stroke:"#fefeff"},baseEdge:{stroke:"#fefeff"},rect:{radius:8},diamond:{radius:8},polygon:{radius:8},polyline:{radius:8},nodeText:{color:"#fefeff",overflowMode:"default",fontSize:12,lineHeight:1.2},arrow:{strokeLinecap:"round",strokeLinejoin:"round",offset:10,verticalLength:5},snapline:{strokeLinecap:"round",strokeLinejoin:"round",stroke:"#949494",strokeWidth:1},outline:{radius:8,fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},resizeOutline:{radius:8,fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},cg={rect:{fill:"#72CBFF",stroke:"#3ABDF9",radius:8},circle:{fill:"#FFE075",stroke:"#F9CE3A",radius:8},ellipse:{fill:"#FFA8A8",stroke:"#FF6B66",radius:8},text:{fill:"#72CBFF",radius:8},diamond:{fill:"#96F7AF",stroke:"#40EF7E",radius:8},polygon:{fill:"#E0A8FF",stroke:"#C271FF",radius:8},polyline:{radius:8},arrow:{strokeLinecap:"round",strokeLinejoin:"round",offset:10,verticalLength:5},snapline:{strokeLinecap:"round",strokeLinejoin:"round",stroke:"#949494",strokeWidth:1},outline:{radius:8,fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},resizeOutline:{radius:8,fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},Uo={colorful:cg,dark:fg,radius:dg,default:vc},hg={background:"#23272e"},pg={background:"#fefeff"},Us={background:"#ffffff"},Vo={colorful:pg,dark:hg,radius:Us,default:Us},vg={color:"#66676a",thickness:1},gg={color:"#dadada",thickness:1},Vs={color:"#acacac",thickness:1},Ko={colorful:gg,dark:vg,radius:Vs,default:Vs},gc=function(r,t){var e=xe(vc);return t&&(e=kn(e,Uo[t])),r&&(e=kn(e,r)),e},yg=function(r,t){if(Uo[r]){console.warn("theme mode ".concat(r," already exists"));return}Uo[r]=t,Vo[r]=t.background||Us,Ko[r]=t.grid||Vs},mg=function(r){delete Uo[r],delete Vo[r],delete Ko[r]},Zu=function(){var r={colorful:{},dark:{},radius:{},default:{}};Fe(Uo,r),Fe(Vo,r),Fe(Ko,r)},_g=gc,xg=1e3,wg=999,Zo=function(){return++xg},Eg=function(){return--wg},lt=function(){return lt=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},lt.apply(this,arguments)},fe=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Fa=(function(){function r(t,e){var n;this.BaseType=at.EDGE,this.id="",this.type="",this.sourceNodeId="",this.targetNodeId="",this.textMode=er.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this.points="",this.pointsList=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.isAnimation=!1,this.isShowAdjustPoint=!1,this.zIndex=0,this.state=Xe.DEFAULT,this.modelType=Ae.EDGE,this.customTextPosition=!1,this.style={},this.arrowConfig={markerEnd:"url(#marker-end-".concat(this.id,")"),markerStart:"url(#marker-start-".concat(this.id,")")},this.graphModel=e,this.properties=(n=t.properties)!==null&&n!==void 0?n:{},this.initEdgeData(t),this.setAttributes()}return r.prototype.initEdgeData=function(t){var e=this;if(t.properties||(t.properties={}),!t.id){var n=this.graphModel.idGenerator,o=n&&n(t.type),i=this.createId();t.id=i||o||Fr()}this.arrowConfig.markerEnd="url(#marker-end-".concat(t.id,")"),this.arrowConfig.markerStart="url(#marker-start-".concat(t.id,")");var a=this.graphModel.editConfigModel.adjustEdgeStartAndEnd;this.isShowAdjustPoint=a,Fe(this,vv(t));var s=this.graphModel,l=s.overlapMode,u=s.eventCenter;this.updateZIndexByOverlap(l,t.zIndex||Zo()),this.setAnchors(),this.initPoints(),this.formatText(t),u.on("overlap:change",function(f){var d=f.overlapMode;e.updateZIndexByOverlap(d,e.zIndex||Zo())})},r.prototype.setAttributes=function(){},r.prototype.createId=function(){return null},r.prototype.getEdgeStyle=function(){return lt(lt({},this.graphModel.theme.baseEdge),this.style)},r.prototype.getAdjustPointStyle=function(){return lt({},this.graphModel.theme.edgeAdjust)},r.prototype.getTextStyle=function(){var t=this.graphModel.theme.edgeText;return xe(t)},r.prototype.getEdgeAnimationStyle=function(){var t=this.graphModel.theme.edgeAnimation;return xe(t)},r.prototype.getArrowStyle=function(){var t=this.getEdgeStyle(),e=this.getEdgeAnimationStyle(),n=this.graphModel.theme.arrow,o=this.isAnimation?e.stroke:t.stroke;return lt(lt(lt({},t),{fill:o,stroke:o}),n)},r.prototype.getOutlineStyle=function(){var t=this.graphModel,e=t.theme.outline;return xe(e)},r.prototype.getTextPosition=function(){return{x:0,y:0}},Object.defineProperty(r.prototype,"sourceNode",{get:function(){var t,e;return(e=(t=this.graphModel)===null||t===void 0?void 0:t.nodesMap[this.sourceNodeId])===null||e===void 0?void 0:e.model},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"targetNode",{get:function(){var t,e;return(e=(t=this.graphModel)===null||t===void 0?void 0:t.nodesMap[this.targetNodeId])===null||e===void 0?void 0:e.model},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textPosition",{get:function(){return this.getTextPosition()},enumerable:!1,configurable:!0}),r.prototype.getBeginAnchor=function(t,e,n){var o,i,a=Xs(t);if(n){if(o=hn(a,function(s){return s.id===n}),o)return o;console.warn("".concat(n,""))}return a.forEach(function(s){var l=Gu(s,e);(i===void 0||l<i)&&(i=l,o=s)}),o},r.prototype.getEndAnchor=function(t,e){var n=this,o,i,a=Xs(t);if(e){if(o=hn(a,function(s){return s.id===e}),o)return o;console.warn("".concat(e,""))}return a.forEach(function(s){if(n.startPoint){var l=Gu(s,n.startPoint);(i===void 0||l<i)&&(i=l,o=s)}}),o},r.prototype.getProperties=function(){return lr(this.properties)},r.prototype.getData=function(){var t=this.properties;$n(t)&&(t=lr(t));var e={id:this.id,type:this.type,properties:t,sourceNodeId:this.sourceNodeId,targetNodeId:this.targetNodeId,sourceAnchorId:this.sourceAnchorId,targetAnchorId:this.targetAnchorId,startPoint:Fe({},this.startPoint),endPoint:Fe({},this.endPoint)};[gt.INCREASE,gt.STATIC].includes(this.graphModel.overlapMode)&&(e.zIndex=this.zIndex);var n=this.text,o=n.x,i=n.y,a=n.value;return a&&(e.text={x:o,y:i,value:a}),e},r.prototype.getHistoryData=function(){return this.getData()},r.prototype.setProperty=function(t,e){Cl(this.properties,t,Ct(e)),this.setAttributes()},r.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},r.prototype.setProperties=function(t){this.properties=lt(lt({},lr(this.properties)),Ct(t)),this.setAttributes()},r.prototype.changeEdgeId=function(t){var e=this.arrowConfig,n=e.markerEnd,o=e.markerStart;o&&o==="url(#marker-start-".concat(this.id,")")&&(this.arrowConfig.markerStart="url(#marker-start-".concat(t,")")),n&&n==="url(#marker-end-".concat(this.id,")")&&(this.arrowConfig.markerEnd="url(#marker-end-".concat(t,")")),this.id=t},r.prototype.setStyle=function(t,e){var n;this.style=lt(lt({},this.style),(n={},n[t]=Ct(e),n))},r.prototype.setStyles=function(t){this.style=lt(lt({},this.style),Ct(t))},r.prototype.updateStyles=function(t){this.style=lt({},Ct(t))},r.prototype.setTextMode=function(t){this.textMode=t},r.prototype.formatText=function(t){var e,n,o,i=this.graphModel.editConfigModel,a=i.edgeTextDraggable,s=i.edgeTextEdit,l=this.textPosition,u=l.x,f=l.y,d=t.text,c={value:"",x:u,y:f,draggable:a,editable:s};d&&(typeof d=="string"?c=lt(lt({},c),{value:d}):(c=lt(lt({},c),{x:(e=d.x)!==null&&e!==void 0?e:u,y:(n=d.y)!==null&&n!==void 0?n:f,value:(o=d.value)!==null&&o!==void 0?o:""}),Bn(d.draggable)||(c.draggable=d.draggable),Bn(d.editable)||(c.editable=d.editable))),this.text=c},r.prototype.resetTextPosition=function(){var t=this.textPosition,e=t.x,n=t.y;this.text.x=e,this.text.y=n},r.prototype.moveText=function(t,e){var n=this.text,o=n.x,i=n.y,a=n.value,s=n.draggable,l=n.editable;this.text={value:a,editable:l,draggable:s,x:o+t,y:i+e}},r.prototype.setText=function(t){t&&Fe(this.text,t)},r.prototype.updateText=function(t){this.text=lt(lt({},lr(this.text)),{value:t})},r.prototype.setAnchors=function(){if(!this.sourceAnchorId||!this.startPoint){var t=this.getBeginAnchor(this.sourceNode,this.targetNode,this.sourceAnchorId);if(!t)throw new Error("beginAnchoranchorsanchors");this.startPoint||(this.startPoint={x:t.x,y:t.y}),this.sourceAnchorId||(this.sourceAnchorId=t.id)}if(!this.targetAnchorId||!this.endPoint){var t=this.getEndAnchor(this.targetNode,this.targetAnchorId);if(!t)throw new Error("endAnchoranchorsanchors");this.endPoint||(this.endPoint={x:t.x,y:t.y}),this.targetAnchorId||(this.targetAnchorId=t.id)}},r.prototype.setSelected=function(t){t===void 0&&(t=!0),this.isSelected=t},r.prototype.setHovered=function(t){t===void 0&&(t=!0),this.isHovered=t},r.prototype.setHitable=function(t){t===void 0&&(t=!0),this.isHitable=t},r.prototype.setHittable=function(t){t===void 0&&(t=!0),this.isHittable=t},r.prototype.openEdgeAnimation=function(){this.isAnimation=!0},r.prototype.closeEdgeAnimation=function(){this.isAnimation=!1},r.prototype.setElementState=function(t,e){this.state=t,this.additionStateData=e},r.prototype.updateStartPoint=function(t){this.startPoint=t},r.prototype.moveStartPoint=function(t,e){this.startPoint&&(this.startPoint.x+=t,this.startPoint.y+=e)},r.prototype.updateEndPoint=function(t){this.endPoint=t},r.prototype.moveEndPoint=function(t,e){this.endPoint&&(this.endPoint.x+=t,this.endPoint.y+=e)},r.prototype.setZIndex=function(t){t===void 0&&(t=0),this.zIndex=t},r.prototype.initPoints=function(){},r.prototype.updateAttributes=function(t){Fe(this,t)},r.prototype.getAdjustStart=function(){return this.startPoint},r.prototype.getAdjustEnd=function(){return this.endPoint},r.prototype.updateAfterAdjustStartAndEnd=function(t){var e=t.startPoint,n=t.endPoint;this.updateStartPoint({x:e.x,y:e.y}),this.updateEndPoint({x:n.x,y:n.y})},r.prototype.updateZIndexByOverlap=function(t,e){switch(t){case gt.DEFAULT:this.zIndex=0;break;case gt.EDGE_TOP:this.zIndex=1;break;case gt.INCREASE:this.zIndex=e;break}},r.BaseType=at.EDGE,fe([I],r.prototype,"type",void 0),fe([I],r.prototype,"sourceNodeId",void 0),fe([I],r.prototype,"targetNodeId",void 0),fe([I],r.prototype,"startPoint",void 0),fe([I],r.prototype,"endPoint",void 0),fe([I],r.prototype,"textMode",void 0),fe([I],r.prototype,"text",void 0),fe([I],r.prototype,"properties",void 0),fe([I],r.prototype,"points",void 0),fe([I],r.prototype,"pointsList",void 0),fe([I],r.prototype,"isSelected",void 0),fe([I],r.prototype,"isHovered",void 0),fe([I],r.prototype,"isHitable",void 0),fe([I],r.prototype,"isHittable",void 0),fe([I],r.prototype,"draggable",void 0),fe([I],r.prototype,"visible",void 0),fe([I],r.prototype,"isAnimation",void 0),fe([I],r.prototype,"isShowAdjustPoint",void 0),fe([I],r.prototype,"zIndex",void 0),fe([I],r.prototype,"state",void 0),fe([I],r.prototype,"style",void 0),fe([I],r.prototype,"arrowConfig",void 0),fe([et],r.prototype,"sourceNode",null),fe([et],r.prototype,"targetNode",null),fe([et],r.prototype,"textPosition",null),fe([L],r.prototype,"setProperty",null),fe([L],r.prototype,"deleteProperty",null),fe([L],r.prototype,"setProperties",null),fe([L],r.prototype,"changeEdgeId",null),fe([L],r.prototype,"setStyle",null),fe([L],r.prototype,"setStyles",null),fe([L],r.prototype,"updateStyles",null),fe([L],r.prototype,"setTextMode",null),fe([L],r.prototype,"formatText",null),fe([L],r.prototype,"resetTextPosition",null),fe([L],r.prototype,"moveText",null),fe([L],r.prototype,"setText",null),fe([L],r.prototype,"updateText",null),fe([L],r.prototype,"setAnchors",null),fe([L],r.prototype,"setSelected",null),fe([L],r.prototype,"setHovered",null),fe([L],r.prototype,"setHitable",null),fe([L],r.prototype,"setHittable",null),fe([L],r.prototype,"openEdgeAnimation",null),fe([L],r.prototype,"closeEdgeAnimation",null),fe([L],r.prototype,"setElementState",null),fe([L],r.prototype,"updateStartPoint",null),fe([L],r.prototype,"moveStartPoint",null),fe([L],r.prototype,"updateEndPoint",null),fe([L],r.prototype,"moveEndPoint",null),fe([L],r.prototype,"setZIndex",null),fe([L],r.prototype,"initPoints",null),fe([L],r.prototype,"updateAttributes",null),fe([L],r.prototype,"getAdjustStart",null),fe([L],r.prototype,"getAdjustEnd",null),fe([L],r.prototype,"updateAfterAdjustStartAndEnd",null),fe([L],r.prototype,"updateZIndexByOverlap",null),r})(),bg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),on=function(){return on=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},on.apply(this,arguments)},Vt=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},os=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},qu=(function(r){bg(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Ae.BEZIER_EDGE,o.path="",o.initEdgeData(e),o.setAttributes(),o}return t.prototype.initEdgeData=function(e){this.offset=ei(e,"properties.offset",100),r.prototype.initEdgeData.call(this,e)},t.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.bezier,n=r.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return on(on(on({},n),xe(e)),xe(i))},t.prototype.getTextPosition=function(){if(this.pointsList&&this.pointsList.length>0){var e=0,n=0;return this.pointsList.forEach(function(o){var i=o.x,a=o.y;e+=i,n+=a}),{x:e/this.pointsList.length,y:n/this.pointsList.length}}return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},t.prototype.getData=function(){var e=r.prototype.getData.call(this),n=this.pointsList.map(function(o){var i=o.x,a=o.y;return{x:i,y:a}});return on(on({},e),{pointsList:n})},t.prototype.getControls=function(){var e=this.startPoint,n=this.endPoint,o=Xu({start:e,end:n,sourceNode:this.sourceNode,targetNode:this.targetNode,offset:this.offset});return o},t.prototype.getPath=function(e){var n=os(e,4),o=n[0],i=n[1],a=n[2],s=n[3];return"M ".concat(o.x," ").concat(o.y,`
    C `).concat(i.x," ").concat(i.y,`,
    `).concat(a.x," ").concat(a.y,`,
    `).concat(s.x," ").concat(s.y)},t.prototype.initPoints=function(){this.pointsList.length>0?this.path=this.getPath(this.pointsList):this.updatePoints()},t.prototype.updatePoints=function(){var e=this.getControls(),n=e.sNext,o=e.ePre;this.updatePath(n,o)},t.prototype.updatePath=function(e,n){e=xe(e),n=xe(n);var o={x:this.startPoint.x,y:this.startPoint.y},i={x:this.endPoint.x,y:this.endPoint.y};if(!e||!n){var a=this.getControls();e=a.sNext,n=a.ePre}this.pointsList=[o,e,n,i],this.path=this.getPath(this.pointsList)},t.prototype.updateStartPoint=function(e){this.startPoint=Object.assign({},e),this.updatePoints()},t.prototype.updateEndPoint=function(e){this.endPoint=Object.assign({},e),this.updatePoints()},t.prototype.moveStartPoint=function(e,n){this.startPoint.x+=e,this.startPoint.y+=n;var o=os(this.pointsList,3),i=o[1],a=o[2];i.x+=e,i.y+=n,this.updatePath(i,a)},t.prototype.moveEndPoint=function(e,n){this.endPoint.x+=e,this.endPoint.y+=n;var o=os(this.pointsList,3),i=o[1],a=o[2];a.x+=e,a.y+=n,this.updatePath(i,a)},t.prototype.updateAdjustAnchor=function(e,n){var o;n==="sNext"?this.pointsList[1]=e:n==="ePre"&&(this.pointsList[2]=e),this.path=this.getPath(this.pointsList),!((o=this.text)===null||o===void 0)&&o.value&&this.setText(Fe({},this.text,this.textPosition))},t.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},t.prototype.getAdjustEnd=function(){var e=this.pointsList;return e[e.length-1]||this.endPoint},t.prototype.updateAfterAdjustStartAndEnd=function(e){var n=e.startPoint,o=e.endPoint,i=e.sourceNode,a=e.targetNode,s=Xu({start:n,end:o,sourceNode:i,targetNode:a,offset:this.offset}),l=s.sNext,u=s.ePre;this.pointsList=[n,l,u,o],this.initPoints()},Vt([I],t.prototype,"offset",void 0),Vt([I],t.prototype,"path",void 0),Vt([L],t.prototype,"initPoints",null),Vt([L],t.prototype,"updatePoints",null),Vt([L],t.prototype,"updateStartPoint",null),Vt([L],t.prototype,"updateEndPoint",null),Vt([L],t.prototype,"moveStartPoint",null),Vt([L],t.prototype,"moveEndPoint",null),Vt([L],t.prototype,"updateAdjustAnchor",null),Vt([L],t.prototype,"getAdjustStart",null),Vt([L],t.prototype,"getAdjustEnd",null),Vt([L],t.prototype,"updateAfterAdjustStartAndEnd",null),t})(Fa),Sg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Eo=function(){return Eo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Eo.apply(this,arguments)},Ju=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Og=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Qu=(function(r){Sg(t,r);function t(){var e=r.apply(this,Og([],Ju(arguments),!1))||this;return e.modelType=Ae.LINE_EDGE,e}return t.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.line,n=r.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return Eo(Eo(Eo({},n),xe(e)),xe(i))},t.prototype.initEdgeData=function(e){r.prototype.initEdgeData.call(this,e),this.points=this.getPath([this.startPoint,this.endPoint])},t.prototype.getPath=function(e){var n=Ju(e,2),o=n[0],i=n[1];return"".concat(o.x,",").concat(o.y," ").concat(i.x,",").concat(i.y)},t.prototype.getTextPosition=function(){return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},t})(Fa),Mg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),bo=function(){return bo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},bo.apply(this,arguments)},Et=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},ed=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ag=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},qo=(function(r){Mg(t,r);function t(){var e=r.apply(this,Ag([],ed(arguments),!1))||this;return e.modelType=Ae.POLYLINE_EDGE,e.draggingPointList=[],e}return t.prototype.initEdgeData=function(e){this.offset=ei(e,"properties.offset",30),e.pointsList&&(this.pointsList=e.pointsList),r.prototype.initEdgeData.call(this,e)},t.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.polyline,n=r.prototype.getEdgeStyle.call(this),o=this.properties.style,i=o===void 0?{}:o;return bo(bo(bo({},n),xe(e)),xe(i))},t.prototype.getTextPosition=function(){var e,n=(e=this.text)===null||e===void 0?void 0:e.value;if(this.dbClickPosition&&!n){var o=this.dbClickPosition,i=o.x,a=o.y;return{x:i,y:a}}var s=vn(this.points),l=ed(cv(s),2),u=l[0],f=l[1];return{x:(u.x+f.x)/2,y:(u.y+f.y)/2}},t.prototype.getAfterAnchor=function(e,n,o){var i,a;return o.forEach(function(s){var l;e===tt.HORIZONTAL?l=Math.abs(n.y-s.y):e===tt.VERTICAL&&(l=Math.abs(n.x-s.x)),(!a||a>l)&&(a=l,i=s)}),i},t.prototype.getCrossPoint=function(e,n,o){var i;return e===tt.HORIZONTAL?i={x:o.x,y:n.y}:e===tt.VERTICAL&&(i={x:n.x,y:o.y}),i},t.prototype.removeCrossPoints=function(e,n,o){var i=o.map(function(y){return y});if(e===1){var a=i[e],s=i[n],l=i[e-1],u=ju(l,a,this.sourceNode);if(u){var f=Iu(a,s,this.sourceNode);if(f){var d=ku(a,s,this.sourceNode);d&&(i[e]=d,i.splice(e-1,1),e--,n--)}}else{var c=this.sourceNode.anchors;c.forEach(function(y){if(y.x===l.x&&y.x===a.x||y.y===l.y&&y.y===a.y){var w=fr(y.x,y.y,a.x,a.y),M=fr(l.x,l.y,a.x,a.y);w<M&&(i[e-1]=y)}})}}if(n===o.length-2){var h=i[e],p=i[n],v=i[n+1],g=ju(p,v,this.targetNode);if(g){var f=Iu(h,p,this.targetNode);if(f){var d=ku(h,p,this.targetNode);d&&(i[n]=d,i.splice(n+1,1))}}else{var c=this.targetNode.anchors;c.forEach(function(w){if(w.x===v.x&&w.x===p.x||w.y===v.y&&w.y===p.y){var M=fr(w.x,w.y,p.x,p.y),C=fr(v.x,v.y,p.x,p.y);M<C&&(i[n+1]=w)}})}}return i},t.prototype.getDraggingPoints=function(e,n,o,i,a){var s=a.map(function(f){return f}),l=this.getAfterAnchor(e,o,i),u=this.getCrossPoint(e,o,l);return n==="start"?(s.unshift(u),s.unshift(l)):(s.push(u),s.push(l)),s},t.prototype.updateCrossPoints=function(e){var n=e.map(function(w){return w}),o=e[0],i=e[1],a=e[n.length-2],s=e[n.length-1],l=this,u=l.sourceNode,f=l.targetNode,d=u.modelType,c=f.modelType,h=ta(o,i),p=n[0];switch(d){case Ae.RECT_NODE:if(u.radius!==0){var v=Fu(o,u);v||(p=Yu(o,h,u))}break;case Ae.CIRCLE_NODE:p=Hs(o,h,u);break;case Ae.ELLIPSE_NODE:p=$u(o,h,u);break;case Ae.DIAMOND_NODE:p=_i(o,h,u);break;case Ae.POLYGON_NODE:p=_i(o,h,u);break}p&&(n[0]=p);var g=ta(a,s),y=n[n.length-1];switch(c){case Ae.RECT_NODE:if(f.radius!==0){var v=Fu(s,f);v||(y=Yu(s,g,f))}break;case Ae.CIRCLE_NODE:y=Hs(s,g,f);break;case Ae.ELLIPSE_NODE:y=$u(s,g,f);break;case Ae.DIAMOND_NODE:y=_i(s,g,f);break;case Ae.POLYGON_NODE:y=_i(s,g,f);break}return y&&(n[n.length-1]=y),n},t.prototype.updatePath=function(e){this.pointsList=e,this.points=this.getPath(this.pointsList)},t.prototype.getData=function(){var e=r.prototype.getData.call(this),n=this.pointsList.map(function(o){var i=o.x,a=o.y;return{x:i,y:a}});return Object.assign({},e,{pointsList:n})},t.prototype.getPath=function(e){return e.map(function(n){return"".concat(n.x,",").concat(n.y)}).join(" ")},t.prototype.initPoints=function(){this.pointsList.length>0?this.points=this.getPath(this.pointsList):this.updatePoints()},t.prototype.updatePoints=function(){var e=Lu({x:this.startPoint.x,y:this.startPoint.y},{x:this.endPoint.x,y:this.endPoint.y},this.sourceNode,this.targetNode,this.offset||0);this.pointsList=e,this.points=e.map(function(n){return"".concat(n.x,",").concat(n.y)}).join(" ")},t.prototype.updateStartPoint=function(e){this.startPoint=Object.assign({},e),this.updatePoints()},t.prototype.moveStartPoint=function(e,n){this.startPoint.x+=e,this.startPoint.y+=n,this.updatePoints()},t.prototype.updateEndPoint=function(e){this.endPoint=Object.assign({},e),this.updatePoints()},t.prototype.moveEndPoint=function(e,n){this.endPoint.x+=e,this.endPoint.y+=n,this.updatePoints()},t.prototype.updatePointsList=function(e,n){this.pointsList.forEach(function(a){a.x+=e,a.y+=n});var o=this.pointsList[0];this.startPoint=Object.assign({},o);var i=this.pointsList[this.pointsList.length-1];this.endPoint=Object.assign({},i),this.initPoints()},t.prototype.dragAppendStart=function(){this.draggingPointList=this.pointsList.map(function(e){return e})},t.prototype.dragAppendSimple=function(e,n){var o;this.isDragging=!0;var i=e.start,a=e.end,s=e.startIndex,l=e.endIndex,u=e.direction,f=this.pointsList,d=f;return u===tt.HORIZONTAL?(f[s]={x:i.x,y:i.y+n.y},f[l]={x:a.x,y:a.y+n.y},d=this.pointsList.map(function(c){return c})):u===tt.VERTICAL&&(f[s]={x:i.x+n.x,y:i.y},f[l]={x:a.x+n.x,y:a.y},d=this.pointsList.map(function(c){return c})),this.updatePointsAfterDrag(d),this.draggingPointList=d,!((o=this.text)===null||o===void 0)&&o.value&&this.setText(Fe({},this.text,this.textPosition)),{start:Fe({},f[s]),end:Fe({},f[l]),startIndex:s,endIndex:l,direction:u}},t.prototype.dragAppend=function(e,n){var o;this.isDragging=!0;var i=e.start,a=e.end,s=e.startIndex,l=e.endIndex,u=e.direction,f=this.pointsList;if(u===tt.HORIZONTAL){f[s]={x:i.x,y:i.y+n.y},f[l]={x:a.x,y:a.y+n.y};var d=this.pointsList.map(function(g){return g});if(s!==0&&l!==this.pointsList.length-1&&(d=this.removeCrossPoints(s,l,d)),s===0){var c={x:i.x,y:i.y+n.y},h=Lr(c,this.sourceNode);if(!h){var p=this.sourceNode.anchors;d=this.getDraggingPoints(u,"start",c,p,d)}}if(l===this.pointsList.length-1){var v={x:a.x,y:a.y+n.y},h=Lr(v,this.targetNode);if(!h){var p=this.targetNode.anchors;d=this.getDraggingPoints(u,"end",v,p,d)}}this.updatePointsAfterDrag(d),this.draggingPointList=d}else if(u===tt.VERTICAL){f[s]={x:i.x+n.x,y:i.y},f[l]={x:a.x+n.x,y:a.y};var d=this.pointsList.map(function(y){return y});if(s!==0&&l!==this.pointsList.length-1&&(d=this.removeCrossPoints(s,l,d)),s===0){var c={x:i.x+n.x,y:i.y},h=Lr(c,this.sourceNode);if(!h){var p=this.sourceNode.anchors;d=this.getDraggingPoints(u,"start",c,p,d)}}if(l===this.pointsList.length-1){var v={x:a.x+n.x,y:a.y},h=Lr(v,this.targetNode);if(!h){var p=this.targetNode.anchors;d=this.getDraggingPoints(u,"end",v,p,d)}}this.updatePointsAfterDrag(d),this.draggingPointList=d}return!((o=this.text)===null||o===void 0)&&o.value&&this.setText(Fe({},this.text,this.textPosition)),{start:Fe({},f[s]),end:Fe({},f[l]),startIndex:s,endIndex:l,direction:u}},t.prototype.dragAppendEnd=function(){if(this.draggingPointList){var e=ic(vn(this.points));this.pointsList=e.map(function(i){return i}),this.draggingPointList=[];var n=e[0];this.startPoint=Fe({},n);var o=e[e.length-1];this.endPoint=Fe({},o)}this.isDragging=!1},t.prototype.updatePointsAfterDrag=function(e){var n=this.updateCrossPoints(e);this.points=n.map(function(o){return"".concat(o.x,",").concat(o.y)}).join(" ")},t.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},t.prototype.getAdjustEnd=function(){var e=this.pointsList;return e[e.length-1]||this.endPoint},t.prototype.updateAfterAdjustStartAndEnd=function(e){var n=e.startPoint,o=e.endPoint,i=e.sourceNode,a=e.targetNode;this.pointsList=Lu({x:n.x,y:n.y},{x:o.x,y:o.y},i,a,this.offset||0),this.initPoints()},Et([I],t.prototype,"offset",void 0),Et([I],t.prototype,"dbClickPosition",void 0),Et([L],t.prototype,"initPoints",null),Et([L],t.prototype,"updatePoints",null),Et([L],t.prototype,"updateStartPoint",null),Et([L],t.prototype,"moveStartPoint",null),Et([L],t.prototype,"updateEndPoint",null),Et([L],t.prototype,"moveEndPoint",null),Et([L],t.prototype,"updatePointsList",null),Et([L],t.prototype,"dragAppendStart",null),Et([L],t.prototype,"dragAppendSimple",null),Et([L],t.prototype,"dragAppend",null),Et([L],t.prototype,"dragAppendEnd",null),Et([L],t.prototype,"updatePointsAfterDrag",null),Et([L],t.prototype,"getAdjustStart",null),Et([L],t.prototype,"getAdjustEnd",null),Et([L],t.prototype,"updateAfterAdjustStartAndEnd",null),t})(Fa),ht=function(){return ht=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ht.apply(this,arguments)},_e=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},td=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ng=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Vr=(function(){function r(t,e){var n;this.BaseType=at.NODE,this.id="",this.type="",this.x=0,this.y=0,this.textMode=er.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this._width=100,this._height=80,this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.anchorsOffset=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isShowAnchor=!1,this.isDragging=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.rotatable=!0,this.resizable=!0,this.zIndex=1,this.state=Xe.DEFAULT,this.autoToFront=!0,this.style={},this._rotate=0,this.modelType=Ae.NODE,this.additionStateData={},this.targetRules=[],this.sourceRules=[],this.moveRules=[],this.resizeRules=[],this.hasSetTargetRules=!1,this.hasSetSourceRules=!1,this.graphModel=e,this.properties=(n=t.properties)!==null&&n!==void 0?n:{},this.initNodeData(t),this.setAttributes()}return Object.defineProperty(r.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t;var e=this,n=e.x,o=n===void 0?0:n,i=e.y,a=i===void 0?0:i;this.transform=new ra(-o,-a).rotate(t).translate(o,a).toString()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"incoming",{get:function(){return{nodes:this.graphModel.getNodeIncomingNode(this.id),edges:this.graphModel.getNodeIncomingEdge(this.id)}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"outgoing",{get:function(){return{nodes:this.graphModel.getNodeOutgoingNode(this.id),edges:this.graphModel.getNodeOutgoingEdge(this.id)}},enumerable:!1,configurable:!0}),r.prototype.initNodeData=function(t){var e=this;if(t.properties||(t.properties={}),!t.id){var n=this.graphModel.idGenerator,o=n&&n(t.type),i=this.createId();t.id=i||o||Fr()}this.formatText(t),Fe(this,Mv(t));var a=this.graphModel,s=a.overlapMode,l=a.eventCenter;this.updateZIndexByOverlap(s,t.zIndex||Zo()),l.on("overlap:change",function(u){var f=u.overlapMode;e.updateZIndexByOverlap(f,e.zIndex||Zo())})},r.prototype.setAttributes=function(){},r.prototype.createId=function(){return null},r.prototype.setTextMode=function(t){this.textMode=t},r.prototype.formatText=function(t){var e,n,o,i=this.graphModel.editConfigModel,a=i.nodeTextDraggable,s=i.nodeTextEdit,l=t.x,u=t.y,f=t.text,d={value:"",x:l,y:u,draggable:a,editable:s};f&&(typeof f=="string"?d.value=f:(d=ht(ht({},d),{x:(e=f.x)!==null&&e!==void 0?e:l,y:(n=f.y)!==null&&n!==void 0?n:u,value:(o=f.value)!==null&&o!==void 0?o:""}),Bn(f.draggable)||(d.draggable=f.draggable),Bn(f.editable)||(d.editable=f.editable))),t.text=d},r.prototype.resize=function(t){var e=t.width,n=t.height,o=t.deltaX,i=t.deltaY,a=this.isAllowResizeNode(o,i,e,n);return a?(this.move(o/2,i/2),this.width=e,this.height=n,this.setProperties({width:e,height:n}),this.getData()):this.getData()},r.prototype.proportionalResize=function(){},r.prototype.getData=function(){var t=this.text,e=t.x,n=t.y,o=t.value,i=this.properties;$n(i)&&(i=lr(i)),Rt(i.width)&&(i.width=this.width),Rt(i.height)&&(i.height=this.height);var a={id:this.id,type:this.type,x:this.x,y:this.y,properties:i};return this.rotate&&(a.rotate=this.rotate),[gt.INCREASE,gt.STATIC].includes(this.graphModel.overlapMode)&&(a.zIndex=this.zIndex),o&&(a.text={x:e,y:n,value:o}),a},r.prototype.getHistoryData=function(){return this.getData()},r.prototype.getProperties=function(){return lr(this.properties)},r.prototype.getOuterGAttributes=function(){return{className:""}},r.prototype.getNodeStyle=function(){return ht(ht({},this.graphModel.theme.baseNode),this.style)},r.prototype.getTextStyle=function(){var t=this.graphModel.theme.nodeText,e=this.properties.textStyle,n=e===void 0?{}:e;return ht(ht({},xe(t)),xe(n))},r.prototype.getRotateControlStyle=function(){var t=this.graphModel.theme.rotateControl;return xe(t)},r.prototype.getResizeControlStyle=function(){var t=this.graphModel.theme.resizeControl;return xe(t)},r.prototype.getResizeOutlineStyle=function(){var t=this.graphModel.theme.resizeOutline;return xe(t)},r.prototype.getAnchorStyle=function(t){var e=this.graphModel.theme.anchor;return xe(e)},r.prototype.getAnchorLineStyle=function(t){var e=this.graphModel.theme.anchorLine;return xe(e)},r.prototype.getOutlineStyle=function(){var t=this.graphModel.theme.outline;return xe(t)},r.prototype.isAllowConnectedAsSource=function(t,e,n,o){var i=this.hasSetSourceRules?this.sourceRules:this.getConnectedSourceRules();this.hasSetSourceRules=!0;for(var a=!0,s="",l=0;l<i.length;l++){var u=i[l];if(!u.validate.call(this,this,t,e,n,o)){a=!1,s=u.message;break}}return{isAllPass:a,msg:s}},r.prototype.getConnectedSourceRules=function(){return this.sourceRules},r.prototype.isAllowConnectedAsTarget=function(t,e,n,o){var i=this.hasSetTargetRules?this.targetRules:this.getConnectedTargetRules();this.hasSetTargetRules=!0;for(var a=!0,s="",l=0;l<i.length;l++){var u=i[l];if(!u.validate.call(this,t,this,e,n,o)){a=!1,s=u.message;break}}return{isAllPass:a,msg:s}},r.prototype.isAllowMoveNode=function(t,e){var n,o,i=!0,a=!0,s=this.moveRules.concat(this.graphModel.nodeMoveRules);try{for(var l=td(s),u=l.next();!u.done;u=l.next()){var f=u.value,d=f(this,t,e);if(!d)return!1;if(typeof d=="object"){var c=d;if(!c.x&&!c.y)return!1;i=i&&c.x,a=a&&c.y}}}catch(h){n={error:h}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return{x:i,y:a}},r.prototype.getConnectedTargetRules=function(){return this.targetRules},r.prototype.getAnchorsByOffset=function(){var t=this,e=t.anchorsOffset,n=t.id,o=t.x,i=t.y;return e&&e.length>0?e.map(function(a,s){return a.length?(a=a,{id:"".concat(n,"_").concat(s),x:o+a[0],y:i+a[1]}):(a=a,ht(ht({},a),{x:o+a.x,y:i+a.y,id:a.id||"".concat(n,"_").concat(s)}))}):this.getDefaultAnchor()},r.prototype.getDefaultAnchor=function(){return[]},r.prototype.getTargetAnchor=function(t){return bv(t,this)},r.prototype.getBounds=function(){return{minX:this.x-this.width/2,minY:this.y-this.height/2,maxX:this.x+this.width/2,maxY:this.y+this.height/2}},Object.defineProperty(r.prototype,"anchors",{get:function(){var t=this.getAnchorsByOffset(),e=this,n=e.x,o=e.y,i=e.rotate;return t.forEach(function(a){var s=a.x,l=a.y,u=Ng(new ai([s,l,1]).translate(-n,-o).rotate(i).translate(n,o)[0],2),f=u[0],d=u[1];a.x=f,a.y=d}),t},enumerable:!1,configurable:!0}),r.prototype.getAnchorInfo=function(t){if(!Rt(t))for(var e=0;e<this.anchors.length;e++){var n=this.anchors[e];if(n.id===t)return n}},r.prototype.addNodeMoveRules=function(t){this.moveRules.includes(t)||this.moveRules.push(t)},r.prototype.isAllowMoveByXORY=function(t,e,n){var o,i;if(n)o=!0,i=!0;else{var a=this.isAllowMoveNode(t,e);typeof a=="boolean"?(o=a,i=a):(o=a.x,i=a.y)}return{isAllowMoveX:o,isAllowMoveY:i}},r.prototype.move=function(t,e,n){n===void 0&&(n=!1);var o=this.isAllowMoveByXORY(t,e,n),i=o.isAllowMoveX,a=o.isAllowMoveY;return i&&(this.x=this.x+t,this.text&&this.moveText(t,0)),a&&(this.y=this.y+e,this.text&&this.moveText(0,e)),(i||a)&&(this.rotate=this._rotate),i||a},r.prototype.getMoveDistance=function(t,e,n){n===void 0&&(n=!1);var o=this.isAllowMoveByXORY(t,e,n),i=o.isAllowMoveX,a=o.isAllowMoveY,s=0,l=0;return i&&t&&(this.x=this.x+t,this.text&&this.moveText(t,0),s=t),a&&e&&(this.y=this.y+e,this.text&&this.moveText(0,e),l=e),this.transform=new ra(-this.x,-this.y).rotate(this.rotate).translate(this.x,this.y).toString(),[s,l]},r.prototype.moveTo=function(t,e,n){n===void 0&&(n=!1);var o=t-this.x,i=e-this.y;return!n&&!this.isAllowMoveNode(o,i)?!1:(this.text&&this.moveText(o,i),this.x=t,this.y=e,!0)},r.prototype.moveText=function(t,e){var n=this.text,o=n.x,i=n.y,a=n.value,s=n.draggable,l=n.editable;this.text={value:a,editable:l,draggable:s,x:o+t,y:i+e}},r.prototype.updateText=function(t){this.text=ht(ht({},lr(this.text)),{value:t})},r.prototype.addNodeResizeRules=function(t){this.resizeRules.includes(t)||this.resizeRules.push(t)},r.prototype.isAllowResizeNode=function(t,e,n,o){var i,a,s=this.resizeRules.concat(this.graphModel.nodeResizeRules);try{for(var l=td(s),u=l.next();!u.done;u=l.next()){var f=u.value,d=f(this,t,e,n,o);if(!d)return!1}}catch(c){i={error:c}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return!0},r.prototype.setSelected=function(t){t===void 0&&(t=!0),this.isSelected=t},r.prototype.setHovered=function(t){t===void 0&&(t=!0),this.isHovered=t,this.setIsShowAnchor(t)},r.prototype.setIsShowAnchor=function(t){t===void 0&&(t=!0),this.isShowAnchor=t},r.prototype.setRotatable=function(t){t===void 0&&(t=!0),this.rotatable=t},r.prototype.setResizable=function(t){t===void 0&&(t=!0),this.resizable=t},r.prototype.setHitable=function(t){t===void 0&&(t=!0),this.isHitable=t},r.prototype.setHittable=function(t){t===void 0&&(t=!0),this.isHittable=t},r.prototype.setElementState=function(t,e){this.state=t,this.additionStateData=e},r.prototype.updateProperties=function(t,e){var n=lr(this.properties);this.properties=t,this.setAttributes(),this.graphModel.eventCenter.emit(ne.NODE_PROPERTIES_CHANGE,{id:this.id,keys:e,preProperties:n,properties:t})},r.prototype.setProperty=function(t,e){var n=lr(this.properties),o=xe(n);$c(o,t,Ct(e)),this.updateProperties(o,[t])},r.prototype.setProperties=function(t){var e=lr(this.properties),n=ht(ht({},e),Ct(t)),o=[];Wc(t,function(i,a){(Io(e,a)&&e[a]!==i||!Io(e,a))&&o.push(a)}),this.updateProperties(n,o)},r.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},r.prototype.setStyle=function(t,e){var n;this.style=ht(ht({},this.style),(n={},n[t]=Ct(e),n))},r.prototype.setStyles=function(t){this.style=ht(ht({},this.style),Ct(t))},r.prototype.updateStyles=function(t){this.style=ht({},Ct(t))},r.prototype.setZIndex=function(t){t===void 0&&(t=1),this.zIndex=t},r.prototype.updateAttributes=function(t){Fe(this,t)},r.prototype.updateZIndexByOverlap=function(t,e){switch(t){case gt.DEFAULT:this.zIndex=1;break;case gt.EDGE_TOP:this.zIndex=0;break;case gt.INCREASE:this.zIndex=e;break}},r.BaseType=at.NODE,_e([I],r.prototype,"type",void 0),_e([I],r.prototype,"x",void 0),_e([I],r.prototype,"y",void 0),_e([I],r.prototype,"textMode",void 0),_e([I],r.prototype,"text",void 0),_e([I],r.prototype,"properties",void 0),_e([I],r.prototype,"_width",void 0),_e([I],r.prototype,"_height",void 0),_e([I],r.prototype,"anchorsOffset",void 0),_e([I],r.prototype,"isSelected",void 0),_e([I],r.prototype,"isHovered",void 0),_e([I],r.prototype,"isShowAnchor",void 0),_e([I],r.prototype,"isDragging",void 0),_e([I],r.prototype,"isHitable",void 0),_e([I],r.prototype,"isHittable",void 0),_e([I],r.prototype,"draggable",void 0),_e([I],r.prototype,"visible",void 0),_e([I],r.prototype,"rotatable",void 0),_e([I],r.prototype,"resizable",void 0),_e([I],r.prototype,"zIndex",void 0),_e([I],r.prototype,"state",void 0),_e([I],r.prototype,"autoToFront",void 0),_e([I],r.prototype,"style",void 0),_e([I],r.prototype,"transform",void 0),_e([I],r.prototype,"_rotate",void 0),_e([et],r.prototype,"incoming",null),_e([et],r.prototype,"outgoing",null),_e([L],r.prototype,"setTextMode",null),_e([L],r.prototype,"addNodeMoveRules",null),_e([L],r.prototype,"move",null),_e([L],r.prototype,"getMoveDistance",null),_e([L],r.prototype,"moveTo",null),_e([L],r.prototype,"moveText",null),_e([L],r.prototype,"updateText",null),_e([L],r.prototype,"addNodeResizeRules",null),_e([L],r.prototype,"setSelected",null),_e([L],r.prototype,"setHovered",null),_e([L],r.prototype,"setIsShowAnchor",null),_e([L],r.prototype,"setRotatable",null),_e([L],r.prototype,"setResizable",null),_e([L],r.prototype,"setHitable",null),_e([L],r.prototype,"setHittable",null),_e([L],r.prototype,"setElementState",null),_e([L],r.prototype,"setProperty",null),_e([L],r.prototype,"setProperties",null),_e([L],r.prototype,"deleteProperty",null),_e([L],r.prototype,"setStyle",null),_e([L],r.prototype,"setStyles",null),_e([L],r.prototype,"updateStyles",null),_e([L],r.prototype,"setZIndex",null),_e([L],r.prototype,"updateAttributes",null),_e([L],r.prototype,"updateZIndexByOverlap",null),r})(),Cg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),So=function(){return So=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},So.apply(this,arguments)},is=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},la=(function(r){Cg(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Ae.CIRCLE_NODE,o.r=50,o.initNodeData(e),o.setAttributes(),o}return Object.defineProperty(t.prototype,"width",{get:function(){return this.r*2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.r*2},enumerable:!1,configurable:!0}),t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties.r;e&&(this.r=e)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.circle,o=this.properties.style,i=o===void 0?{}:o;return So(So(So({},e),xe(n)),xe(i))},t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.r;return[{x:n,y:o-i,id:"".concat(this.id,"_0")},{x:n+i,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+i,id:"".concat(this.id,"_2")},{x:n-i,y:o,id:"".concat(this.id,"_3")}]},t.prototype.resize=function(e){var n=e.width,o=e.deltaX,i=e.deltaY;return this.move(o/2,i/2),this.r=n,this.setProperties({r:n}),this.getData()},is([I],t.prototype,"r",void 0),is([et],t.prototype,"width",null),is([et],t.prototype,"height",null),t})(Vr),Tg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Oo=function(){return Oo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Oo.apply(this,arguments)},Sn=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},wi=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ks=(function(r){Tg(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Ae.DIAMOND_NODE,o.rx=30,o.ry=50,o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.rx,o=e.ry;n&&(this.rx=n),o&&(this.ry=o)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.diamond,o=this.properties.style,i=o===void 0?{}:o;return Oo(Oo(Oo({},e),xe(n)),xe(i))},Object.defineProperty(t.prototype,"points",{get:function(){var e=this,n=e.x,o=e.y,i=e.rx,a=e.ry;return[[n,o-a],[n+i,o],[n,o+a],[n-i,o]]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointsPosition",{get:function(){return gr(this.points,function(e){var n=wi(e,2),o=n[0],i=n[1];return{x:o,y:i}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return Oe(this.points,function(o){var i=wi(o,1),a=i[0];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return Oe(this.points,function(o){var i=wi(o,2),a=i[1];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var e=this;return gr(this.points,function(n,o){var i=wi(n,2),a=i[0],s=i[1];return{x:a,y:s,id:"".concat(e.id,"_").concat(o)}})},t.prototype.resize=function(e){var n=e.width,o=e.height,i=e.deltaX,a=e.deltaY;return this.move(i/2,a/2),this.rx=n,this.ry=o,this.setProperties({rx:n,ry:o}),this.getData()},Sn([I],t.prototype,"rx",void 0),Sn([I],t.prototype,"ry",void 0),Sn([et],t.prototype,"points",null),Sn([et],t.prototype,"pointsPosition",null),Sn([et],t.prototype,"width",null),Sn([et],t.prototype,"height",null),t})(Vr),Pg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Mo=function(){return Mo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Mo.apply(this,arguments)},Ei=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Zs=(function(r){Pg(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Ae.ELLIPSE_NODE,o.rx=30,o.ry=45,o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.rx,o=e.ry;n&&(this.rx=n),o&&(this.ry=o)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.ellipse,o=this.properties.style,i=o===void 0?{}:o;return Mo(Mo(Mo({},e),xe(n)),xe(i))},Object.defineProperty(t.prototype,"width",{get:function(){return this.rx*2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.ry*2},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.rx,a=e.ry;return[{x:n,y:o-a,id:"".concat(this.id,"_0")},{x:n+i,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a,id:"".concat(this.id,"_2")},{x:n-i,y:o,id:"".concat(this.id,"_3")}]},t.prototype.resize=function(e){var n=e.width,o=e.height,i=e.deltaX,a=e.deltaY;return this.move(i/2,a/2),this.rx=n,this.ry=o,this.setProperties({rx:n,ry:o}),this.getData()},Ei([I],t.prototype,"rx",void 0),Ei([I],t.prototype,"ry",void 0),Ei([et],t.prototype,"width",null),Ei([et],t.prototype,"height",null),t})(Vr),Dg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Ao=function(){return Ao=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ao.apply(this,arguments)},bi=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Si=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},ua=(function(r){Dg(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Ae.POLYGON_NODE,o.points=[[50,0],[100,50],[50,100],[0,50]],o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.points,o=e.width,i=e.height,a=n||this.points;this.points=mv(a,o,i)},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.polygon,o=this.properties.style,i=o===void 0?{}:o;return Ao(Ao(Ao({},e),xe(n)),xe(i))},Object.defineProperty(t.prototype,"pointsPosition",{get:function(){var e=this,n=e.x,o=e.y,i=e.width,a=e.height;return this.points.map(function(s){return{x:s[0]+n-i/2,y:s[1]+o-a/2}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(o){var i=Si(o,1),a=i[0];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(o){var i=Si(o,2),a=i[1];a<e&&(e=a),a>n&&(n=a)}),n-e},enumerable:!1,configurable:!0}),t.prototype.getDefaultAnchor=function(){var e=this,n=this,o=n.x,i=n.y,a=n.width,s=n.height,l=n.points;return l.map(function(u,f){var d=Si(u,2),c=d[0],h=d[1];return{x:o+c-a/2,y:i+h-s/2,id:"".concat(e.id,"_").concat(f)}})},t.prototype.resize=function(e){var n=this,o=e.width,i=e.height,a=e.deltaX,s=e.deltaY;this.move(a/2,s/2);var l=gr(this.points,function(u){var f=Si(u,2),d=f[0],c=f[1];return[d*o/n.width,c*i/n.height]});return this.points=l,this.properties.points=l,this.getData()},bi([I],t.prototype,"points",void 0),bi([et],t.prototype,"pointsPosition",null),bi([et],t.prototype,"width",null),bi([et],t.prototype,"height",null),t})(Vr),Rg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),No=function(){return No=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},No.apply(this,arguments)},Lg=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Zn=(function(r){Rg(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Ae.RECT_NODE,o.radius=0,o.initNodeData(e),o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.width,o=e.height,i=e.radius,a=this.getNodeStyle().radius;Rt(n)||(this.width=n),Rt(o)||(this.height=o),Rt(i)||(this.radius=i),Rt(a)||(this.radius=a)},t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.width,a=e.height;return[{x:n,y:o-a/2,id:"".concat(this.id,"_0")},{x:n+i/2,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a/2,id:"".concat(this.id,"_2")},{x:n-i/2,y:o,id:"".concat(this.id,"_3")}]},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.graphModel.theme.rect,o=this.properties.style,i=o===void 0?{}:o;return No(No(No({},e),xe(n)),xe(i))},Lg([I],t.prototype,"radius",void 0),t})(Vr),jg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Co=function(){return Co=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Co.apply(this,arguments)},rd=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ig=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},kg=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},nd=(function(r){jg(t,r);function t(){var e=r.apply(this,kg([],Ig(arguments),!1))||this;return e.modelType=Ae.TEXT_NODE,e}return t.prototype.getTextStyle=function(){var e=r.prototype.getTextStyle.call(this),n=this.graphModel.theme.text,o=this.properties.textStyle;return Co(Co(Co({},e),xe(n)),xe(o))},Object.defineProperty(t.prototype,"width",{get:function(){var e=String(this.text.value).split(/[\r\n]/g),n=this.getTextStyle().fontSize,o=Uu({rows:e,fontSize:n,rowsLength:e.length}).width;return o},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var e=String(this.text.value).split(/[\r\n]/g),n=this.getTextStyle().fontSize,o=Uu({rows:e,fontSize:n,rowsLength:e.length}).height;return o},enumerable:!1,configurable:!0}),rd([et],t.prototype,"width",null),rd([et],t.prototype,"height",null),t})(Vr),Bg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),da=(function(r){Bg(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.modelType=Ae.HTML_NODE,o.setAttributes(),o}return t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this);var e=this.properties,n=e.width,o=e.height;n&&(this.width=n),o&&(this.height=o)},t.prototype.getDefaultAnchor=function(){var e=this,n=e.x,o=e.y,i=e.width,a=e.height;return[{x:n,y:o-a/2,id:"".concat(this.id,"_0")},{x:n+i/2,y:o,id:"".concat(this.id,"_1")},{x:n,y:o+a/2,id:"".concat(this.id,"_2")},{x:n-i/2,y:o,id:"".concat(this.id,"_3")}]},t})(Vr),ze=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Xg={stopZoomGraph:!1,stopScrollGraph:!1,stopMoveGraph:!1,adjustEdge:!1,adjustEdgeStartAndEnd:!1,adjustNodePosition:!1,hideAnchors:!0,allowRotate:!1,allowResize:!1,nodeSelectedOutline:!0,textEdit:!1,nodeTextEdit:!1,edgeTextEdit:!1,textDraggable:!1,nodeTextDraggable:!1,edgeTextDraggable:!1},Oi=["isSilentMode","stopZoomGraph","stopScrollGraph","stopMoveGraph","snapGrid","adjustEdge","adjustEdgeMiddle","adjustEdgeStartAndEnd","adjustEdgeStart","adjustEdgeEnd","adjustNodePosition","hideAnchors","allowRotate","allowResize","autoExpand","hoverOutline","nodeSelectedOutline","edgeSelectedOutline","textEdit","nodeTextEdit","edgeTextEdit","textDraggable","nodeTextDraggable","edgeTextDraggable","multipleSelectKey","textMode","nodeTextMode","edgeTextMode","nodeTextMultiple","edgeTextMultiple","nodeTextVertical","edgeTextVertical","isPinching"],Hg=(function(){function r(t){this.isSilentMode=!1,this.stopZoomGraph=!1,this.stopMoveGraph=!1,this.stopScrollGraph=!1,this.snapGrid=!1,this.isPinching=!1,this.textMode=er.TEXT,this.textEdit=!0,this.textDraggable=!1,this.nodeTextEdit=!0,this.nodeTextDraggable=!1,this.nodeTextMultiple=!1,this.nodeTextVertical=!1,this.nodeTextMode=er.TEXT,this.edgeTextMode=er.TEXT,this.edgeTextEdit=!0,this.edgeTextDraggable=!1,this.edgeTextMultiple=!1,this.edgeTextVertical=!1,this.hideAnchors=!1,this.allowRotate=!1,this.allowResize=!1,this.hoverOutline=!0,this.nodeSelectedOutline=!0,this.adjustNodePosition=!0,this.autoExpand=!1,this.adjustEdge=!0,this.adjustEdgeMiddle=!1,this.adjustEdgeStartAndEnd=!1,this.adjustEdgeStart=!1,this.adjustEdgeEnd=!1,this.edgeSelectedOutline=!0,this.multipleSelectKey="",Fe(this,this.computeConfig(t))}return r.prototype.updateEditConfig=function(t){var e=this.computeConfig(t);Fe(this,e)},r.prototype.computeConfig=function(t){var e=t.isSilentMode,n=t.textDraggable,o=t.textMode,i=t.textEdit,a=t.adjustEdgeStartAndEnd,s={};if(e===!1&&Fe(s,this.stagedConfig),e===!0&&e!==this.isSilentMode){var l=Pn(Xg,Oi);this.stagedConfig=Pn(this,Oi),Fe(s,l)}Bn(i)||Fe(s,{nodeTextEdit:i,edgeTextEdit:i}),Bn(n)||Fe(s,{nodeTextDraggable:n,edgeTextDraggable:n}),o&&Fe(s,{nodeTextMode:o,edgeTextMode:o}),Es(a)&&Fe(s,{adjustEdgeStart:a,adjustEdgeEnd:a});var u=Pn(t,Oi);return Fe(s,u)},r.prototype.updateTextMode=function(t){this.textMode=t,this.edgeTextMode=t,this.nodeTextMode=t},r.prototype.getConfig=function(){return Pn(this,Oi)},ze([I],r.prototype,"isSilentMode",void 0),ze([I],r.prototype,"stopZoomGraph",void 0),ze([I],r.prototype,"stopMoveGraph",void 0),ze([I],r.prototype,"stopScrollGraph",void 0),ze([I],r.prototype,"snapGrid",void 0),ze([I],r.prototype,"isPinching",void 0),ze([I],r.prototype,"textMode",void 0),ze([I],r.prototype,"textEdit",void 0),ze([I],r.prototype,"textDraggable",void 0),ze([I],r.prototype,"nodeTextEdit",void 0),ze([I],r.prototype,"nodeTextDraggable",void 0),ze([I],r.prototype,"nodeTextMultiple",void 0),ze([I],r.prototype,"nodeTextVertical",void 0),ze([I],r.prototype,"nodeTextMode",void 0),ze([I],r.prototype,"edgeTextMode",void 0),ze([I],r.prototype,"edgeTextEdit",void 0),ze([I],r.prototype,"edgeTextDraggable",void 0),ze([I],r.prototype,"edgeTextMultiple",void 0),ze([I],r.prototype,"edgeTextVertical",void 0),ze([I],r.prototype,"hideAnchors",void 0),ze([I],r.prototype,"allowRotate",void 0),ze([I],r.prototype,"allowResize",void 0),ze([I],r.prototype,"hoverOutline",void 0),ze([I],r.prototype,"nodeSelectedOutline",void 0),ze([I],r.prototype,"adjustNodePosition",void 0),ze([I],r.prototype,"autoExpand",void 0),ze([I],r.prototype,"adjustEdge",void 0),ze([I],r.prototype,"adjustEdgeMiddle",void 0),ze([I],r.prototype,"adjustEdgeStartAndEnd",void 0),ze([I],r.prototype,"adjustEdgeStart",void 0),ze([I],r.prototype,"adjustEdgeEnd",void 0),ze([I],r.prototype,"edgeSelectedOutline",void 0),ze([L],r.prototype,"updateEditConfig",null),ze([L],r.prototype,"updateTextMode",null),r})(),Gg="*",zg=(function(){function r(){this._events={}}return r.prototype.on=function(t,e,n){var o=this;t==null||t.split(",").forEach(function(i){i=i.trim(),o._events[i]||(o._events[i]=[]),o._events[i].push({callback:e,once:!!n})})},r.prototype.once=function(t,e){var n=this;t==null||t.split(",").forEach(function(o){o=o.trim(),n.on(o,e,!0)})},r.prototype.emit=function(t,e){var n=this;t==null||t.split(",").forEach(function(o){var i=n._events[o]||[],a=n._events[Gg]||[],s=function(l){for(var u=l.length,f=0;f<u;f++)if(l[f]){var d=l[f],c=d.callback,h=d.once;h&&(l.splice(f,1),l.length===0&&delete n._events[o],u--,f--),c.apply(n,[e])}};s(i),s(a)})},r.prototype.off=function(t,e){var n=this;t||(this._events={}),t.split(",").forEach(function(o){if(!e)delete n._events[o];else{for(var i=n._events[o]||[],a=i.length,s=0;s<a;s++)i[s].callback===e&&(i.splice(s,1),a--,s--);i.length===0&&delete n._events[o]}})},r.prototype.getEvents=function(){return this._events},r.prototype.destroy=function(){this._events={}},r})(),Yg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Fg=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},$g=(function(r){Yg(t,r);function t(e){var n=r.call(this)||this;n.stepScrollX=0,n.stepScrollY=0,n.pointers=new Map,n.onDragging=function(s){var l=s.deltaX,u=s.deltaY;n.longPressTimer&&(clearTimeout(n.longPressTimer),n.longPressTimer=void 0),n.setState({isDragging:!0});var f=n.props.graphModel,d=f.transformModel,c=f.editConfigModel;c.stopMoveGraph!==!0&&d.translate(l,u)},n.onDragEnd=function(){n.setState({isDragging:!1})},n.zoomHandler=function(s){var l=n.props,u=l.graphModel,f=u.editConfigModel,d=u.transformModel,c=u.gridSize,h=l.graphModel,p=s.deltaX,v=s.deltaY,g=f.stopScrollGraph,y=f.stopZoomGraph;if(!g&&!s.ctrlKey&&!s.metaKey){if(s.preventDefault(),n.stepScrollX+=p,n.stepScrollY+=v,Math.abs(n.stepScrollX)>=c){var w=n.stepScrollX%c,M=n.stepScrollX-w;d.translate(-M*d.SCALE_X,0),n.stepScrollX=w}if(Math.abs(n.stepScrollY)>=c){var C=n.stepScrollY%c,P=n.stepScrollY-C;d.translate(0,-P*d.SCALE_Y),n.stepScrollY=C}return}if(!y){s.preventDefault();var S=h.getPointByClient({x:s.clientX,y:s.clientY}),E=S.canvasOverlayPosition,T=E.x,j=E.y;d.zoom(s.deltaY<0,[T,j])}},n.clickHandler=function(s){var l=s.target;if(l.getAttribute("name")==="canvas-overlay"){var u=n.props.graphModel,f=u.selectElements;f.size>0&&u.clearSelectElements(),u.eventCenter.emit(ne.BLANK_CLICK,{e:s})}},n.handleContextMenu=function(s){var l=s.target;if(l.getAttribute("name")==="canvas-overlay"){s.preventDefault();var u=n.props.graphModel,f=u.getPointByClient({x:s.clientX,y:s.clientY});u.eventCenter.emit(ne.BLANK_CONTEXTMENU,{e:s,position:f})}},n.pointerDownHandler=function(s){var l=n.props.graphModel,u=l.eventCenter,f=l.editConfigModel,d=l.transformModel.SCALE_X,c=l.gridSize;if(n.pointers.set(s.pointerId,{x:s.clientX,y:s.clientY}),n.longPressTimer&&clearTimeout(n.longPressTimer),s.pointerType==="touch"&&(n.longPressTimer=window.setTimeout(function(){n.handleContextMenu(s)},500)),n.pointers.size===2){var h=n.props.graphModel,p=h.transformModel,v=h.editConfigModel,g=Array.from(n.pointers.values()),y=g[0].x-g[1].x,w=g[0].y-g[1].y,M=(g[0].x+g[1].x)/2,C=(g[0].y+g[1].y)/2;n.pinchStartDistance=Math.hypot(y,w),n.pinchStartScale=p.SCALE_X,n.stepDrag.cancelDrag(),n.pinchLastCenterX=M,n.pinchLastCenterY=C,v.updateEditConfig({isPinching:!0});return}var P=f.adjustEdge,S=f.adjustNodePosition,E=f.stopMoveGraph,T=s.target,j=!P&&!S;(T.getAttribute("name")==="canvas-overlay"||j)&&(E!==!0?(n.stepDrag.setStep(c*d),n.stepDrag.handleMouseDown(s)):u.emit(ne.BLANK_MOUSEDOWN,{e:s}),n.clickHandler(s))},n.pointerMoveHandler=function(s){var l;if(n.pointers.set(s.pointerId,{x:s.clientX,y:s.clientY}),n.pinchStartDistance&&n.pointers.size>=2){var u=n.props,f=u.graphModel,d=u.graphModel,c=d.editConfigModel,h=d.transformModel;if(c.stopZoomGraph)return;n.longPressTimer&&clearTimeout(n.longPressTimer);var p=Array.from(n.pointers.values()),v=p[0].x-p[1].x,g=p[0].y-p[1].y,y=Math.hypot(v,g),w=((l=n.pinchStartScale)!==null&&l!==void 0?l:h.SCALE_X)*(y/n.pinchStartDistance),M=(p[0].x+p[1].x)/2,C=(p[0].y+p[1].y)/2,P=f.getPointByClient({x:M,y:C}),S=P.canvasOverlayPosition,E=S.x,T=S.y;if(h.zoom(w,[E,T]),!c.stopMoveGraph||c.isPinching){var j=n.pinchLastCenterX===void 0?0:M-n.pinchLastCenterX,q=n.pinchLastCenterY===void 0?0:C-n.pinchLastCenterY;h.translate(j,q),n.pinchLastCenterX=M,n.pinchLastCenterY=C}s.preventDefault()}},n.pointerUpHandler=function(s){if(n.pointers.delete(s.pointerId),n.longPressTimer&&(clearTimeout(n.longPressTimer),n.longPressTimer=void 0),n.pointers.size<2){n.pinchStartDistance=void 0,n.pinchStartScale=void 0,n.pinchLastCenterX=void 0,n.pinchLastCenterY=void 0;var l=n.props.graphModel.editConfigModel;l.updateEditConfig({isPinching:!1})}};var o=e.graphModel,i=o.gridSize,a=o.eventCenter;return n.stepDrag=new rr({onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:i,eventType:"BLANK",isStopPropagation:!1,eventCenter:a,model:void 0}),n.state={isDragging:!1},n}return t.prototype.render=function(){var e=this.props.graphModel.transformModel,n=e.getTransformStyle().transform,o=this.props.children,i=this.state.isDragging;return k("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",name:"canvas-overlay",onWheel:this.zoomHandler,onPointerDown:this.pointerDownHandler,onPointerMove:this.pointerMoveHandler,onPointerUp:this.pointerUpHandler,onPointerCancel:this.pointerUpHandler,onContextMenu:this.handleContextMenu,style:{touchAction:"none",WebkitUserSelect:"none"},className:i?"lf-canvas-overlay lf-dragging":"lf-canvas-overlay lf-drag-able",children:k("g",{transform:n,children:o})})},t=Fg([Lt],t),t})(De),yc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Jo=function(){return Jo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Jo.apply(this,arguments)},Wg=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Ug=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},od=(function(r){yc(t,r);function t(){var e=r.call(this)||this;return e.onDragging=function(n){var o=n.event,i=e.props,a=i.graphModel,s=i.bezierModel,l=i.type,u=a.getPointByClient({x:o.clientX,y:o.clientY}).canvasOverlayPosition,f=u.x,d=u.y;s.updateAdjustAnchor({x:f,y:d},l),a.eventCenter.emit(ne.EDGE_ADJUST,{data:s.getData()})},e.onDragEnd=function(){var n=e.props.bezierModel;n.isDragging=!1},e.dragHandler=new rr({onDragging:e.onDragging,onDragEnd:e.onDragEnd}),e}return t.prototype.render=function(){var e=this,n=this.props.position,o=n.x,i=n.y,a=this.props.bezierModel,s=a.getEdgeStyle().adjustAnchor;return k(Kn,Jo({className:"lf-bezier-adjust-anchor",x:o,y:i},s,{onPointerDown:function(l){e.dragHandler.handleMouseDown(l)}}))},t})(De),Vg=(function(r){yc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getBezierAdjust=function(e,n){var o=e.path,i=e.id,a=Rl(o),s=Ug(a,4),l=s[0],u=s[1],f=s[2],d=s[3],c=e.getEdgeStyle().adjustLine,h=[];return h.push(k(Vn,Jo({x1:l.x,y1:l.y,x2:u.x,y2:u.y},c))),h.push(k(od,{position:u,bezierModel:e,graphModel:n,type:"sNext"},"".concat(i,"_ePre"))),h.push(k(Vn,Jo({x1:d.x,y1:d.y,x2:f.x,y2:f.y},c))),h.push(k(od,{position:f,bezierModel:e,graphModel:n,type:"ePre"},"".concat(i,"_sNext"))),h},t.prototype.selectedBezierEdge=function(){for(var e=this.props.graphModel,n=e.edges,o=[],i=0;i<n.length;i++){var a=n[i];a.isSelected&&a.modelType===Ae.BEZIER_EDGE&&a.draggable&&o.push(this.getBezierAdjust(a,e))}return o},t.prototype.render=function(){return k("g",{className:"lf-bezier-adjust",children:this.selectedBezierEdge()})},t=Wg([Lt],t),t})(De),Kg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Zg=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},qg=(function(r){Kg(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(){var e=this.props.background;return k("div",{className:"lf-background",children:k("div",{style:Uc(e)?e:{},className:"lf-background-area"})})},t=Zg([Lt],t),t})(De),Jg=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Qg=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},In=(function(r){Jg(t,r);function t(e){var n=r.call(this,e)||this;return n.id=Fr(),n.gridOptions=n.props.graphModel.grid,n}return t.prototype.renderDot=function(){var e=this.gridOptions,n=e.config,o=e.size,i=o===void 0?1:o,a=e.visible,s=n??{},l=s.color,u=s.thickness,f=u===void 0?2:u,d=Math.min(Math.max(2,f),i/4),c=a?1:0;return k("g",{fill:l,opacity:c,children:[k("circle",{cx:0,cy:0,r:d/2}),k("circle",{cx:0,cy:i,r:d/2}),k("circle",{cx:i,cy:0,r:d/2}),k("circle",{cx:i,cy:i,r:d/2})]})},t.prototype.renderMesh=function(){var e=this.gridOptions,n=e.config,o=e.size,i=o===void 0?1:o,a=e.visible,s=n??{},l=s.color,u=s.thickness,f=u===void 0?1:u,d=Math.min(Math.max(1,f),i/2),c="M 0 0 H ".concat(i," V ").concat(i," H 0 Z"),h=a?1:0;return k("path",{d:c,stroke:l,strokeWidth:d/2,opacity:h,fill:"transparent"})},t.prototype.render=function(){var e=this.props.graphModel,n=e.transformModel,o=e.grid;this.gridOptions=o;var i=this.gridOptions,a=i.type,s=i.size,l=s===void 0?1:s,u=n.SCALE_X,f=n.SKEW_Y,d=n.SKEW_X,c=n.SCALE_Y,h=n.TRANSLATE_X,p=n.TRANSLATE_Y,v=[u,f,d,c,h,p].join(","),g="matrix(".concat(v,")");return k("div",{className:"lf-grid",children:k("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",children:[k("defs",{children:k("pattern",{id:this.id,patternUnits:"userSpaceOnUse",patternTransform:g,x:"0",y:"0",width:l,height:l,children:[a==="dot"&&this.renderDot(),a==="mesh"&&this.renderMesh()]})}),k("rect",{width:"100%",height:"100%",fill:"url(#".concat(this.id,")")})]})})},t=Qg([Lt],t),t})(De);(function(r){r.defaultProps={size:Kp,visible:!0,type:"dot",config:{color:"#ababab",thickness:1}};function t(e){var n=xe(r.defaultProps);return typeof e=="number"?Fe(n,{size:e}):typeof e=="boolean"?Fe(n,{visible:e}):Fe(n,e)}r.getGridOptions=t})(In||(In={}));var ey=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),ty=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},ry=(function(r){ey(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(){var e=this.props.graphModel.transformModel,n=e.getTransformStyle().transform,o=this.props.children;return k("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",className:"modification-overlay",children:k("g",{transform:n,children:o})})},t=ty([Lt],t),t})(De),ny=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),kr=function(){return kr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},kr.apply(this,arguments)},oy=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},iy=(function(r){ny(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getNodesOutline=function(){var e=this.props.graphModel,n=e.nodes,o=e.editConfigModel,i=o.hoverOutline,a=o.nodeSelectedOutline,s=[];return n.forEach(function(l){if(l.isHovered||l.isSelected){var u=l.isHovered,f=l.isSelected,d=l.x,c=l.y,h=l.width,p=l.height;if(a&&f||i&&u){var v=l.getOutlineStyle(),g={};if(Object.keys(v).forEach(function(w){w!=="hover"&&(g[w]=v[w])}),u){var y=v.hover;g=kr(kr({},g),y)}s.push(k(Jt,kr({transform:l.transform,className:"lf-outline-node",x:d,y:c,width:h+10,height:p+10},g)))}}}),s},t.prototype.getEdgeOutline=function(){for(var e=this.props.graphModel,n=e.edges,o=e.editConfigModel,i=o.edgeSelectedOutline,a=o.hoverOutline,s=[],l=0;l<n.length;l++){var u=n[l];(i&&u.isSelected||a&&u.isHovered)&&(u.modelType===Ae.LINE_EDGE?s.push(this.getLineOutline(u)):u.modelType===Ae.POLYLINE_EDGE?s.push(this.getPolylineOutline(u)):u.modelType===Ae.BEZIER_EDGE&&s.push(this.getBezierOutline(u)))}return s},t.prototype.getLineOutline=function(e){var n=e.startPoint,o=e.endPoint,i=(n.x+o.x)/2,a=(n.y+o.y)/2,s=Math.abs(n.x-o.x)+10,l=Math.abs(n.y-o.y)+10,u=e.getOutlineStyle();return k(Jt,kr({className:"lf-outline-edge",x:i,y:a,width:s,height:l},u))},t.prototype.getPolylineOutline=function(e){var n=e.points,o=vn(n),i=Yo(o,8),a=i.x,s=i.y,l=i.width,u=i.height,f=e.getOutlineStyle();return k(Jt,kr({className:"lf-outline",x:a,y:s,width:l,height:u},f))},t.prototype.getBezierOutline=function(e){var n=e.path,o=Rl(n),i=Yo(o,8),a=i.x,s=i.y,l=i.width,u=i.height,f=e.getOutlineStyle();return k(Jt,kr({className:"lf-outline",x:a,y:s,width:l,height:u},f))},t.prototype.render=function(){return k("g",{className:"lf-outline",children:[this.getNodesOutline(),this.getEdgeOutline()]})},t=oy([Lt],t),t})(De),ay=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Br=function(){return Br=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Br.apply(this,arguments)},sy=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},ly=(function(r){ay(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.render=function(){var e=this.props.snaplineModel,n=e??{},o=n.position,i=n.isShowHorizontal,a=n.isShowVertical,s=e==null?void 0:e.getStyle(),l=o??{},u=l.x,f=u===void 0?0:u,d=l.y,c=d===void 0?0:d,h=Br(Br({x1:-1e5,y1:c,x2:1e5,y2:c},s),{stroke:i?s==null?void 0:s.stroke:"none"}),p=Br(Br({x1:f,y1:-1e5,x2:f,y2:1e5},s),{stroke:a?s==null?void 0:s.stroke:"none"});return k("g",{className:"lf-snapline",children:[k(Vn,Br({},h)),k(Vn,Br({},p))]})},t=sy([Lt],t),t})(De),uy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),dy=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},fy=(function(r){uy(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){this.triggerToolRender()},t.prototype.componentDidUpdate=function(){this.triggerToolRender()},t.prototype.getTools=function(){var e=this.props,n=e.tool,o=e.graphModel,i=o.textEditElement,a=n.getTools(),s=a.map(function(l){return ce(l,{textEditElement:i,graphModel:o,lf:n.instance})});return n.components=s,s},t.prototype.triggerToolRender=function(){var e=this.props,n=e.tool,o=e.graphModel,i=document.querySelector("#ToolOverlay_".concat(o.flowId)),a=n.getInstance();a.components.forEach(function(s){return s(a,i)}),a.components=[]},t.prototype.render=function(){var e=this.props.graphModel;return k("div",{className:"lf-tool-overlay",id:"ToolOverlay_".concat(e.flowId),children:this.getTools()})},t=dy([Lt],t),t})(De),or=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},On=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},cy={false:[-1/0,-1/0,1/0,1/0],true:[-1/0,-1/0,1/0,1/0],vertical:[-1/0,0,1/0,0],horizontal:[0,-1/0,0,1/0]},hy=(function(){function r(t,e){this.MINI_SCALE_SIZE=.2,this.MAX_SCALE_SIZE=16,this.SCALE_X=1,this.SKEW_Y=0,this.SKEW_X=0,this.SCALE_Y=1,this.TRANSLATE_X=0,this.TRANSLATE_Y=0,this.ZOOM_SIZE=.04,this.translateLimitMinX=-1/0,this.translateLimitMinY=-1/0,this.translateLimitMaxX=1/0,this.translateLimitMaxY=1/0,this.eventCenter=t;var n=e.stopMoveGraph,o=n===void 0?!1:n;this.updateTranslateLimits(o)}return r.prototype.setZoomMiniSize=function(t){this.MINI_SCALE_SIZE=t},r.prototype.setZoomMaxSize=function(t){this.MAX_SCALE_SIZE=t},r.prototype.HtmlPointToCanvasPoint=function(t){var e=On(t,2),n=e[0],o=e[1];return[(n-this.TRANSLATE_X)/this.SCALE_X,(o-this.TRANSLATE_Y)/this.SCALE_Y]},r.prototype.CanvasPointToHtmlPoint=function(t){var e=On(t,2),n=e[0],o=e[1];return[n*this.SCALE_X+this.TRANSLATE_X,o*this.SCALE_Y+this.TRANSLATE_Y]},r.prototype.moveCanvasPointByHtml=function(t,e,n){var o=On(t,2),i=o[0],a=o[1];return[i+e/this.SCALE_X,a+n/this.SCALE_Y]},r.prototype.fixDeltaXY=function(t,e){return[t/this.SCALE_X,e/this.SCALE_Y]},r.prototype.getTransformStyle=function(){var t=[this.SCALE_X,this.SKEW_Y,this.SKEW_X,this.SCALE_Y,this.TRANSLATE_X,this.TRANSLATE_Y].join(",");return{transform:"matrix(".concat(t,")")}},r.prototype.zoom=function(t,e){t===void 0&&(t=!1);var n=this.SCALE_X,o=this.SCALE_Y;return typeof t=="number"?(n=t,o=t):t?(n+=this.ZOOM_SIZE,o+=this.ZOOM_SIZE):(n-=this.ZOOM_SIZE,o-=this.ZOOM_SIZE),n<this.MINI_SCALE_SIZE||n>this.MAX_SCALE_SIZE?"".concat(this.SCALE_X*100,"%"):(e&&(this.TRANSLATE_X-=(n-this.SCALE_X)*e[0],this.TRANSLATE_Y-=(o-this.SCALE_Y)*e[1]),this.SCALE_X=n,this.SCALE_Y=o,this.emitGraphTransform("zoom"),"".concat(this.SCALE_X*100,"%"))},r.prototype.emitGraphTransform=function(t){this.eventCenter.emit(ne.GRAPH_TRANSFORM,{type:t,transform:{SCALE_X:this.SCALE_X,SKEW_Y:this.SKEW_Y,SKEW_X:this.SKEW_X,SCALE_Y:this.SCALE_Y,TRANSLATE_X:this.TRANSLATE_X,TRANSLATE_Y:this.TRANSLATE_Y}})},r.prototype.resetZoom=function(){this.SCALE_X=1,this.SCALE_Y=1,this.emitGraphTransform("resetZoom")},r.prototype.translate=function(t,e){this.TRANSLATE_X+t<=this.translateLimitMaxX&&this.TRANSLATE_X+t>=this.translateLimitMinX&&(this.TRANSLATE_X+=t),this.TRANSLATE_Y+e<=this.translateLimitMaxY&&this.TRANSLATE_Y+e>=this.translateLimitMinY&&(this.TRANSLATE_Y+=e),this.emitGraphTransform("translate")},r.prototype.focusOn=function(t,e,n,o){var i=On(this.CanvasPointToHtmlPoint([t,e]),2),a=i[0],s=i[1],l=On([n/2-a,o/2-s],2),u=l[0],f=l[1];this.TRANSLATE_X+=u,this.TRANSLATE_Y+=f,this.emitGraphTransform("focusOn")},r.prototype.updateTranslateLimits=function(t){var e;e=On(Array.isArray(t)&&t.length===4?t:cy[t.toString()],4),this.translateLimitMinX=e[0],this.translateLimitMinY=e[1],this.translateLimitMaxX=e[2],this.translateLimitMaxY=e[3]},or([I],r.prototype,"SCALE_X",void 0),or([I],r.prototype,"SKEW_Y",void 0),or([I],r.prototype,"SKEW_X",void 0),or([I],r.prototype,"SCALE_Y",void 0),or([I],r.prototype,"TRANSLATE_X",void 0),or([I],r.prototype,"TRANSLATE_Y",void 0),or([I],r.prototype,"ZOOM_SIZE",void 0),or([L],r.prototype,"zoom",null),or([L],r.prototype,"resetZoom",null),or([L],r.prototype,"translate",null),or([L],r.prototype,"focusOn",null),r})(),py=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),as=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},vy=(function(r){py(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.parentTransform=n.parentTransform,o}return t.prototype.setParentTransform=function(e){this.parentTransform=e},t.prototype.getCumulativeScale=function(){var e=this.SCALE_X,n=this.SCALE_Y;if(this.parentTransform)if(this.parentTransform instanceof t){var o=this.parentTransform.getCumulativeScale();e*=o.scaleX,n*=o.scaleY}else e*=this.parentTransform.SCALE_X,n*=this.parentTransform.SCALE_Y;return{scaleX:e,scaleY:n}},t.prototype.getCumulativeTranslate=function(){var e=this.TRANSLATE_X,n=this.TRANSLATE_Y;if(this.parentTransform&&this.parentTransform instanceof t){var o=this.parentTransform.getCumulativeScale(),i=o.scaleX,a=o.scaleY;e=i*e,n=a*n}return{translateX:e,translateY:n}},t.prototype.HtmlPointToCanvasPoint=function(e){var n=as(e,2),o=n[0],i=n[1],a=this.getCumulativeScale(),s=a.scaleX,l=a.scaleY,u=this.getCumulativeTranslate(),f=u.translateX,d=u.translateY;return[(o-f)/s,(i-d)/l]},t.prototype.CanvasPointToHtmlPoint=function(e){var n=as(e,2),o=n[0],i=n[1],a=this.getCumulativeScale(),s=a.scaleX,l=a.scaleY,u=this.getCumulativeTranslate(),f=u.translateX,d=u.translateY;return[o*s+f,i*l+d]},t.prototype.moveCanvasPointByHtml=function(e,n,o){var i=as(e,2),a=i[0],s=i[1],l=this.getCumulativeScale(),u=l.scaleX,f=l.scaleY;return[a+n/u,s+o/f]},t.prototype.fixDeltaXY=function(e,n){var o=this.getCumulativeScale(),i=o.scaleX,a=o.scaleY;return[e/i,n/a]},t})(hy),At=function(){return At=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},At.apply(this,arguments)},oe=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},gy=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ct=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},$t=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},yy=(function(){function r(t){var e=this,n,o;this.modelMap=new Map,this.nodeModelMap=new Map,this.edgeModelMap=new Map,this.elementsModelMap=new Map,this.nodeMoveRules=[],this.nodeResizeRules=[],this.nodes=[],this.edges=[],this.overlapMode=gt.DEFAULT,this.gridSize=1,this.partial=!1,this.waitCleanEffects=[];var i=t.container,a=t.partial,s=t.background,l=s===void 0?{}:s,u=t.grid,f=t.idGenerator,d=t.edgeGenerator,c=t.animation,h=t.customTrajectory;this.rootEl=i,this.partial=!!a,this.background=l,typeof u=="object"&&t.snapGrid&&(this.gridSize=u.size||1),this.customStyles=t.style||{},this.grid=In.getGridOptions(u??!1),this.theme=gc(t.style,t.themeMode),this.theme.grid=xe(this.grid),this.theme.background=xe(this.background),this.edgeType=t.edgeType||"polyline",this.animation=Wp(c),this.overlapMode=t.overlapMode||gt.DEFAULT,this.isMiniMap=t.isMiniMap||!1,this.width=(n=t.width)!==null&&n!==void 0?n:this.rootEl.getBoundingClientRect().width,this.isContainerWidth=Rt(t.width),this.height=(o=t.height)!==null&&o!==void 0?o:this.rootEl.getBoundingClientRect().height,this.isContainerHeight=Rt(t.height);var p=new ResizeObserver(tf((function(v){var g,y;try{for(var w=gy(v),M=w.next();!M.done;M=w.next()){var C=M.value;C.target===e.rootEl&&(e.resize(),e.eventCenter.emit("graph:resize",{target:e.rootEl,contentRect:C.contentRect}))}}catch(P){g={error:P}}finally{try{M&&!M.done&&(y=w.return)&&y.call(w)}finally{if(g)throw g.error}}}),16));p.observe(this.rootEl),this.waitCleanEffects.push(function(){p.disconnect()}),this.eventCenter=new zg,this.editConfigModel=new Hg(t),this.transformModel=new vy(this.eventCenter,t),this.flowId=Fr(),this.idGenerator=f,this.edgeGenerator=gv(this,d),this.customTrajectory=h}return Object.defineProperty(r.prototype,"nodesMap",{get:function(){return this.nodes.reduce(function(t,e,n){return t[e.id]={index:n,model:e},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"edgesMap",{get:function(){return this.edges.reduce(function(t,e,n){return t[e.id]={index:n,model:e},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"modelsMap",{get:function(){return $t($t([],ct(this.nodes),!1),ct(this.edges),!1).reduce(function(t,e){return t[e.id]=e,t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"sortElements",{get:function(){for(var t=function(l){return $t([],ct(l),!1).sort(function(u,f){return u.zIndex-f.zIndex})},e=t($t($t([],ct(this.nodes),!1),ct(this.edges),!1)),n=[],o=[-vi,-vi],i=[this.width+vi,this.height+vi],a=0;a<e.length;a++){var s=e[a];s.visible&&(!this.partial||s.isSelected||this.isElementInArea(s,o,i,!1,!1))&&n.push(s)}return n},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textEditElement",{get:function(){var t=this.nodes.find(function(n){return n.state===Xe.TEXT_EDIT}),e=this.edges.find(function(n){return n.state===Xe.TEXT_EDIT});return t||e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selectElements",{get:function(){var t=new Map;return this.nodes.forEach(function(e){e.isSelected&&t.set(e.id,e)}),this.edges.forEach(function(e){e.isSelected&&t.set(e.id,e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selectNodes",{get:function(){var t=[];return this.nodes.forEach(function(e){e.isSelected&&t.push(e)}),t},enumerable:!1,configurable:!0}),r.prototype.getAreaElement=function(t,e,n,o,i){var a=this;n===void 0&&(n=!0),o===void 0&&(o=!0),i===void 0&&(i=!1);var s=[];return Oe($t($t([],ct(this.nodes),!1),ct(this.edges),!1),function(l){var u=a.isElementInArea(l,t,e,n,o);(!i||l.visible)&&u&&s.push(l)}),s},r.prototype.getModel=function(t){return this.modelMap.get(t)},r.prototype.getNodeModelById=function(t){var e;return this.fakeNode&&t===this.fakeNode.id?this.fakeNode:(e=this.nodesMap[t])===null||e===void 0?void 0:e.model},r.prototype.getPointByClient=function(t){var e=t.x,n=t.y,o=this.rootEl.getBoundingClientRect(),i={x:e-o.left,y:n-o.top},a=ct(this.transformModel.HtmlPointToCanvasPoint([i.x,i.y]),2),s=a[0],l=a[1],u={x:s,y:l};return{domOverlayPosition:i,canvasOverlayPosition:u}},r.prototype.isElementInArea=function(t,e,n,o,i){var a;if(o===void 0&&(o=!0),i===void 0&&(i=!0),t.BaseType===at.NODE){t=t;for(var s=Wt(t),l=s.minX,u=s.minY,f=s.maxX,d=s.maxY,c=[{x:l,y:u},{x:f,y:u},{x:f,y:d},{x:l,y:d}],h=i,p=0;p<c.length;p++){var v=c[p],g=v.x,y=v.y;if(a=ct(this.transformModel.CanvasPointToHtmlPoint([g,y]),2),g=a[0],y=a[1],rs([g,y],e,n)!==i){h=!i;break}}return h}if(t.BaseType===at.EDGE){t=t;var w=t.startPoint,M=t.endPoint,C=this.transformModel.CanvasPointToHtmlPoint([w.x,w.y]),P=this.transformModel.CanvasPointToHtmlPoint([M.x,M.y]),S=rs(C,e,n),E=rs(P,e,n);return o?S&&E:S||E}return!1},r.prototype.graphDataToModel=function(t){var e=this;if(!t){this.clearData();return}if(this.elementsModelMap.clear(),this.nodeModelMap.clear(),this.edgeModelMap.clear(),t.nodes?this.nodes=gr(t.nodes,function(o){var i=e.getModelAfterSnapToGrid(o);return e.elementsModelMap.set(i.id,i),e.nodeModelMap.set(i.id,i),i}):this.nodes=[],t.edges){var n=this.edgeType;this.edges=gr(t.edges,function(o){var i,a=e.getModel((i=o.type)!==null&&i!==void 0?i:n);if(!a)throw new Error("".concat(o.type,""));var s=new a(o,e);return e.edgeModelMap.set(s.id,s),e.elementsModelMap.set(s.id,s),s})}else this.edges=[]},r.prototype.modelToGraphData=function(){var t=[];this.edges.forEach(function(n){var o=n.getData();o&&!n.virtual&&t.push(o)});var e=[];return this.nodes.forEach(function(n){var o=n.getData();o&&!n.virtual&&e.push(o)}),{nodes:e,edges:t}},r.prototype.modelToHistoryData=function(){for(var t=!1,e=[],n=0;n<this.nodes.length;n++){var o=this.nodes[n];if(o.isDragging){t=!0;break}else e.push(o.getHistoryData())}if(t)return!1;for(var i=!1,a=[],s=0;s<this.edges.length;s++){var l=this.edges[s];if(l.isDragging){i=!0;break}else a.push(l.getHistoryData())}return i?!1:{nodes:e,edges:a}},r.prototype.getEdgeModelById=function(t){var e;return(e=this.edgesMap[t])===null||e===void 0?void 0:e.model},r.prototype.getElement=function(t){return this.modelsMap[t]},r.prototype.getNodeEdges=function(t){for(var e=[],n=0;n<this.edges.length;n++){var o=this.edges[n],i=o.sourceNodeId===t,a=o.targetNodeId===t;(i||a)&&e.push(o)}return e},r.prototype.getSelectElements=function(t){t===void 0&&(t=!0);var e=this.selectElements,n={nodes:[],edges:[]};return e.forEach(function(o){if(o.BaseType===at.NODE&&n.nodes.push(o.getData()),o.BaseType===at.EDGE){var i=o.getData(),a=e.get(i.sourceNodeId)&&e.get(i.targetNodeId);(t||a)&&n.edges.push(i)}}),n},r.prototype.updateAttributes=function(t,e){var n=this.getElement(t);n==null||n.updateAttributes(e)},r.prototype.changeNodeId=function(t,e){return e||(e=Fr()),this.nodesMap[e]?(console.warn("".concat(e,", ")),""):this.nodesMap[t]?(this.edges.forEach(function(n){n.sourceNodeId===t&&(n.sourceNodeId=e),n.targetNodeId===t&&(n.targetNodeId=e)}),this.nodesMap[t].model.id=e,this.nodesMap[e]=this.nodesMap[t],e):(console.warn("".concat(t,", ")),"")},r.prototype.changeEdgeId=function(t,e){return e||(e=Fr()),this.edgesMap[e]?(console.warn(": ".concat(e,", ")),""):this.edgesMap[t]?(this.edges.forEach(function(n){n.id===t&&n.changeEdgeId(e)}),e):(console.warn(": ".concat(e,", ")),"")},r.prototype.getTextModel=function(t){var e=this.editConfigModel,n=e.textMode,o=e.nodeTextMode,i=e.edgeTextMode;if(t.BaseType===at.NODE)return t.textMode||o||n||er.TEXT;if(t.BaseType===at.EDGE)return t.textMode||i||n||er.TEXT},r.prototype.setOverlapMode=function(t){this.overlapMode=t,this.eventCenter.emit("overlap:change",{overlapMode:t})},r.prototype.setTextMode=function(t,e){this.editConfigModel.updateEditConfig({textMode:t})},r.prototype.setFakeNode=function(t){this.fakeNode=t},r.prototype.removeFakeNode=function(){this.fakeNode=null},r.prototype.setModel=function(t,e){return this.modelMap.set(t,e)},r.prototype.toFront=function(t){var e,n,o,i=((e=this.nodesMap[t])===null||e===void 0?void 0:e.model)||((n=this.edgesMap[t])===null||n===void 0?void 0:n.model);if(i){if(this.overlapMode===gt.STATIC)return;if(this.overlapMode===gt.INCREASE){this.setElementZIndex(t,"top");return}(o=this.topElement)===null||o===void 0||o.setZIndex(),i.setZIndex(Vp),this.topElement=i}},r.prototype.setElementZIndex=function(t,e){var n,o,i=((n=this.nodesMap[t])===null||n===void 0?void 0:n.model)||((o=this.edgesMap[t])===null||o===void 0?void 0:o.model);if(i){var a=void 0;typeof e=="number"?a=e:(e==="top"&&(a=Zo()),e==="bottom"&&(a=Eg())),i.setZIndex(a)}},r.prototype.deleteNode=function(t){var e=this.nodesMap[t].model,n=e.getData();this.deleteEdgeBySource(t),this.deleteEdgeByTarget(t),this.nodes.splice(this.nodesMap[t].index,1),this.eventCenter.emit(ne.NODE_DELETE,{data:n,model:e})},r.prototype.addNode=function(t,e,n){e===void 0&&(e=ne.NODE_ADD);var o=Ct(t),i=o.id;i&&this.nodesMap[i]&&delete o.id;var a=this.getModelAfterSnapToGrid(o);this.nodes.push(a);var s=a.getData(),l={data:s};return n&&(l.e=n),this.eventCenter.emit(e,l),a},r.prototype.getModelAfterSnapToGrid=function(t){var e=this.getModel(t.type),n=this.editConfigModel.snapGrid;if(!e)throw new Error("".concat(t.type,""));var o=t.x,i=t.y;o&&i&&(t.x=Un(o,this.gridSize,n),t.y=Un(i,this.gridSize,n),typeof t.text=="object"&&t.text!==null&&(t.text.x+=t.x-o,t.text.y+=t.y-i));var a=new e(t,this);return this.nodeModelMap.set(a.id,a),this.elementsModelMap.set(a.id,a),a},r.prototype.cloneNode=function(t){var e=this.getNodeModelById(t),n=e==null?void 0:e.getData();if(n){n.x+=30,n.y+=30,n.id="",typeof n.text=="object"&&n.text!==null&&(n.text.x+=30,n.text.y+=30);var o=this.addNode(n);return o.setSelected(!0),e==null||e.setSelected(!1),o.getData()}},r.prototype.moveNode=function(t,e,n,o){var i;o===void 0&&(o=!1);var a=this.nodesMap[t];if(!a){console.warn("id".concat(t,""));return}var s=a.model;i=ct(s.getMoveDistance(e,n,o),2),e=i[0],n=i[1],this.moveEdge(t,e,n)},r.prototype.moveNode2Coordinate=function(t,e,n,o){o===void 0&&(o=!1);var i=this.nodesMap[t];if(!i){console.warn("id".concat(t,""));return}var a=i.model,s=a.x,l=a.y,u=e-s,f=n-l;this.moveNode(t,u,f,o)},r.prototype.editText=function(t){this.setElementStateById(t,Xe.TEXT_EDIT)},r.prototype.addEdge=function(t){var e=Ct(t),n=e.type;n||(n=this.edgeType),e.id&&this.edgesMap[e.id]&&(delete e.id,delete e.sourceAnchorId,delete e.targetAnchorId);var o=this.getModel(n);if(!o)throw new Error("".concat(n,""));var i=new o(At(At({},e),{type:n}),this);this.edgeModelMap.set(i.id,i),this.elementsModelMap.set(i.id,i);var a=i.getData();return this.edges.push(i),this.eventCenter.emit(ne.EDGE_ADD,{data:a}),i},r.prototype.moveEdge=function(t,e,n){for(var o=0;o<this.edges.length;o++){var i=this.edges[o],a=i.textPosition,s=a.x,l=a.y,u=this.edges[o].sourceNodeId===t,f=this.edges[o].targetNodeId===t;u&&i.moveStartPoint(e,n),f&&i.moveEndPoint(e,n),(u||f)&&this.handleEdgeTextMove(i,s,l)}},r.prototype.handleEdgeTextMove=function(t,e,n){var o;if(t.customTextPosition){t.resetTextPosition();return}if(t.modelType===Ae.POLYLINE_EDGE&&(!((o=t.text)===null||o===void 0)&&o.value)){var i=t.text,a=sc(i,t.points);t.moveText(a.x-i.x,a.y-i.y)}var s=t.textPosition,l=s.x,u=s.y;t.moveText(l-e,u-n)},r.prototype.deleteEdgeBySourceAndTarget=function(t,e){for(var n=0;n<this.edges.length;n++)if(this.edges[n].sourceNodeId===t&&this.edges[n].targetNodeId===e){var o=this.edges[n].getData();this.edges.splice(n,1),n--,this.eventCenter.emit(ne.EDGE_DELETE,{data:o})}},r.prototype.deleteEdgeById=function(t){var e=this.edgesMap[t];if(e){var n=this.edgesMap[t].index,o=this.edgesMap[t].model.getData();this.edges.splice(n,1),this.eventCenter.emit(ne.EDGE_DELETE,{data:o})}},r.prototype.deleteEdgeBySource=function(t){for(var e=0;e<this.edges.length;e++)if(this.edges[e].sourceNodeId===t){var n=this.edges[e].getData();this.edges.splice(e,1),e--,this.eventCenter.emit(ne.EDGE_DELETE,{data:n})}},r.prototype.deleteEdgeByTarget=function(t){for(var e=0;e<this.edges.length;e++)if(this.edges[e].targetNodeId===t){var n=this.edges[e].getData();this.edges.splice(e,1),e--,this.eventCenter.emit(ne.EDGE_DELETE,{data:n})}},r.prototype.setElementStateById=function(t,e,n){this.nodes.forEach(function(o){o.id===t?o.setElementState(e,n):o.setElementState(Xe.DEFAULT)}),this.edges.forEach(function(o){o.id===t?o.setElementState(e,n):o.setElementState(Xe.DEFAULT)})},r.prototype.updateText=function(t,e){var n=hn($t($t([],ct(this.nodes),!1),ct(this.edges),!1),function(o){return o.id===t});n==null||n.updateText(e)},r.prototype.selectNodeById=function(t,e){var n;e===void 0&&(e=!1),e||this.clearSelectElements();var o=(n=this.nodesMap[t])===null||n===void 0?void 0:n.model;o==null||o.setSelected(!0)},r.prototype.selectEdgeById=function(t,e){var n;e===void 0&&(e=!1),e||this.clearSelectElements();var o=(n=this.edgesMap[t])===null||n===void 0?void 0:n.model;o==null||o.setSelected(!0)},r.prototype.selectElementById=function(t,e){e===void 0&&(e=!1),e||this.clearSelectElements();var n=this.getElement(t);n==null||n.setSelected(!0)},r.prototype.deselectElementById=function(t){var e=this.getElement(t);e&&e.setSelected(!1)},r.prototype.clearSelectElements=function(){var t;this.selectElements.forEach(function(e){e==null||e.setSelected(!1),e==null||e.setHovered(!1)}),this.selectElements.clear(),[gt.DEFAULT,gt.EDGE_TOP].includes(this.overlapMode)&&((t=this.topElement)===null||t===void 0||t.setZIndex())},r.prototype.moveNodes=function(t,e,n,o){var i,a,s,l=this;o===void 0&&(o=!1);for(var u=t.reduce(function(M,C){var P,S=(P=l.nodesMap[C])===null||P===void 0?void 0:P.model;return S&&(M[C]=S.getMoveDistance(e,n,o)),M},{}),f=0;f<this.edges.length;f++){var d=this.edges[f],c=d.textPosition,h=c.x,p=c.y,v=u[d.sourceNodeId],g=u[d.targetNodeId],y=void 0,w=void 0;v&&g&&d.modelType===Ae.POLYLINE_EDGE?(i=ct(v,2),y=i[0],w=i[1],d.updatePointsList(y,w)):(v&&(a=ct(v,2),y=a[0],w=a[1],d.moveStartPoint(y,w)),g&&(s=ct(g,2),y=s[0],w=s[1],d.moveEndPoint(y,w))),(v||g)&&this.handleEdgeTextMove(d,h,p)}},r.prototype.addNodeMoveRules=function(t){this.nodeMoveRules.includes(t)||this.nodeMoveRules.push(t)},r.prototype.addNodeResizeRules=function(t){this.nodeResizeRules.includes(t)||this.nodeResizeRules.push(t)},r.prototype.setDefaultEdgeType=function(t){this.edgeType=t},r.prototype.changeNodeType=function(t,e){var n=this.getNodeModelById(t);if(!n){console.warn("id".concat(t,""));return}var o=n.getData();o.type=e;var i=this.getModel(e);if(!i)throw new Error("".concat(e,""));var a=new i(o,this);this.nodes.splice(this.nodesMap[t].index,1,a);var s=this.getNodeEdges(t);s.forEach(function(l){if(l.sourceNodeId===t){var u=Wu(a,l.startPoint,a.width,a.height);l.updateStartPoint(u)}if(l.targetNodeId===t){var u=Wu(a,l.endPoint,a.width,a.height);l.updateEndPoint(u)}})},r.prototype.changeEdgeType=function(t,e){var n=this.getEdgeModelById(t);if(!n){console.warn("id".concat(t,""));return}if(n.type!==e){var o=n.getData();o.type=e;var i=this.getModel(e);if(!i)throw new Error("".concat(e,""));delete o.pointsList;var a=new i(o,this);this.edges.splice(this.edgesMap[t].index,1,a)}},r.prototype.getNodeIncomingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.targetNodeId===t&&e.push(n)}),e},r.prototype.getNodeOutgoingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.sourceNodeId===t&&e.push(n)}),e},r.prototype.getAnchorIncomingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.targetAnchorId===t&&e.push(n)}),e},r.prototype.getAnchorOutgoingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.sourceAnchorId===t&&e.push(n)}),e},r.prototype.getNodeIncomingNode=function(t){var e=this,n=[];return this.edges.forEach(function(o){var i;o.targetNodeId===t&&n.push((i=e.nodesMap[o.sourceNodeId])===null||i===void 0?void 0:i.model)}),n},r.prototype.getNodeOutgoingNode=function(t){var e=this,n=[];return this.edges.forEach(function(o){o.sourceNodeId===t&&n.push(e.nodesMap[o.targetNodeId].model)}),n},r.prototype.setTheme=function(t,e){var n;if(e&&(Vo[e]&&this.updateBackgroundOptions(At(At({},typeof this.background=="object"?this.background:{}),Vo[e])),Ko[e]&&this.updateGridOptions(In.getGridOptions(At(At({},this.grid),Ko[e])))),t.background&&this.updateBackgroundOptions(t.background),t.grid){var o=In.getGridOptions((n=t.grid)!==null&&n!==void 0?n:!1);this.updateGridOptions(o)}this.theme=_g(At(At({},this.customStyles),t),e),this.customStyles=At(At({},this.customStyles),t)},r.prototype.getTheme=function(){var t=this,e=t.background,n=t.grid,o=At(At({},xe(this.theme)),{background:e,grid:n});return o},r.prototype.updateGridOptions=function(t){kn(this.grid,t)},r.prototype.updateGridSize=function(t){this.gridSize=t},r.prototype.updateBackgroundOptions=function(t){Es(t)||Es(this.background)?this.background=t:this.background=At(At({},this.background),t)},r.prototype.resize=function(t,e){this.width=t??this.rootEl.getBoundingClientRect().width,this.isContainerWidth=Rt(t),this.height=e??this.rootEl.getBoundingClientRect().height,this.isContainerHeight=Rt(e),(!this.width||!this.height)&&console.warn("containerDOM@see https://github.com/didi/LogicFlow/issues/675")},r.prototype.clearData=function(){this.nodes=[],this.edges=[],this.edgeModelMap.clear(),this.nodeModelMap.clear(),this.elementsModelMap.clear()},r.prototype.getVirtualRectSize=function(){var t=this.nodes,e=[],n=[];t.forEach(function(c){var h=c.x,p=c.y,v=c.width,g=c.height,y=c.getNodeStyle().strokeWidth,w=y===void 0?0:y,M=h+v/2+w,C=h-v/2-w,P=p+g/2+w,S=p-g/2-w;e=e.concat([M,C].filter(function(E){return!Number.isNaN(E)})),n=n.concat([P,S].filter(function(E){return!Number.isNaN(E)}))});var o=Math.min.apply(Math,$t([],ct(e),!1)),i=Math.max.apply(Math,$t([],ct(e),!1)),a=Math.min.apply(Math,$t([],ct(n),!1)),s=Math.max.apply(Math,$t([],ct(n),!1)),l=i-o||0,u=s-a||0,f=o+l/2,d=a+u/2;return{width:l,height:u,x:f,y:d}},r.prototype.translateCenter=function(){var t=this,e=t.nodes,n=t.width,o=t.height,i=t.rootEl,a=t.transformModel;if(e.length){var s=n||i.clientWidth,l=o||i.clientHeight,u=this.getVirtualRectSize(),f=u.x,d=u.y;a.focusOn(f,d,s,l)}},r.prototype.fitView=function(t,e){t===void 0&&(t=20),e===void 0&&(e=20);var n=this,o=n.nodes,i=n.width,a=n.height,s=n.rootEl,l=n.transformModel;if(o.length){var u=i||s.clientWidth,f=a||s.clientHeight,d=this.getVirtualRectSize(),c=d.width,h=d.height,p=d.x,v=d.y,g=(c+e)/u,y=(h+t)/f,w=1/Math.max(g,y),M=[u/2,f/2];l.zoom(w,M),l.focusOn(p,v,u,f)}},r.prototype.openEdgeAnimation=function(t){var e=this.getEdgeModelById(t);e==null||e.openEdgeAnimation()},r.prototype.closeEdgeAnimation=function(t){var e=this.getEdgeModelById(t);e==null||e.closeEdgeAnimation()},r.prototype.getPartial=function(){return this.partial},r.prototype.setPartial=function(t){this.partial=t},r.prototype.destroy=function(){try{this.waitCleanEffects.forEach(function(t){t()})}catch(t){console.warn("error on destroy GraphModel",t)}this.waitCleanEffects.length=0,this.eventCenter.destroy()},oe([I],r.prototype,"width",void 0),oe([I],r.prototype,"height",void 0),oe([I],r.prototype,"theme",void 0),oe([I],r.prototype,"grid",void 0),oe([I],r.prototype,"edgeType",void 0),oe([I],r.prototype,"nodes",void 0),oe([I],r.prototype,"edges",void 0),oe([I],r.prototype,"fakeNode",void 0),oe([I],r.prototype,"overlapMode",void 0),oe([I],r.prototype,"background",void 0),oe([I],r.prototype,"gridSize",void 0),oe([I],r.prototype,"transformModel",void 0),oe([I],r.prototype,"editConfigModel",void 0),oe([I],r.prototype,"partial",void 0),oe([et],r.prototype,"nodesMap",null),oe([et],r.prototype,"edgesMap",null),oe([et],r.prototype,"modelsMap",null),oe([et],r.prototype,"sortElements",null),oe([et],r.prototype,"textEditElement",null),oe([et],r.prototype,"selectElements",null),oe([et],r.prototype,"selectNodes",null),oe([L],r.prototype,"setOverlapMode",null),oe([L],r.prototype,"setTextMode",null),oe([L],r.prototype,"setFakeNode",null),oe([L],r.prototype,"removeFakeNode",null),oe([L],r.prototype,"setModel",null),oe([L],r.prototype,"toFront",null),oe([L],r.prototype,"setElementZIndex",null),oe([L],r.prototype,"deleteNode",null),oe([L],r.prototype,"addNode",null),oe([L],r.prototype,"cloneNode",null),oe([L],r.prototype,"moveNode",null),oe([L],r.prototype,"moveNode2Coordinate",null),oe([L],r.prototype,"editText",null),oe([L],r.prototype,"addEdge",null),oe([L],r.prototype,"moveEdge",null),oe([L],r.prototype,"deleteEdgeBySourceAndTarget",null),oe([L],r.prototype,"deleteEdgeById",null),oe([L],r.prototype,"deleteEdgeBySource",null),oe([L],r.prototype,"deleteEdgeByTarget",null),oe([L],r.prototype,"setElementStateById",null),oe([L],r.prototype,"updateText",null),oe([L],r.prototype,"selectNodeById",null),oe([L],r.prototype,"selectEdgeById",null),oe([L],r.prototype,"selectElementById",null),oe([L],r.prototype,"deselectElementById",null),oe([L],r.prototype,"clearSelectElements",null),oe([L],r.prototype,"moveNodes",null),oe([L],r.prototype,"setDefaultEdgeType",null),oe([L],r.prototype,"changeNodeType",null),oe([L],r.prototype,"changeEdgeType",null),oe([L],r.prototype,"getNodeIncomingEdge",null),oe([L],r.prototype,"getNodeOutgoingEdge",null),oe([L],r.prototype,"getAnchorIncomingEdge",null),oe([L],r.prototype,"getAnchorOutgoingEdge",null),oe([L],r.prototype,"getNodeIncomingNode",null),oe([L],r.prototype,"getNodeOutgoingNode",null),oe([L],r.prototype,"setTheme",null),oe([L],r.prototype,"getTheme",null),oe([L],r.prototype,"resize",null),oe([L],r.prototype,"clearData",null),oe([L],r.prototype,"translateCenter",null),oe([L],r.prototype,"fitView",null),oe([L],r.prototype,"openEdgeAnimation",null),oe([L],r.prototype,"closeEdgeAnimation",null),oe([L],r.prototype,"setPartial",null),r})(),an=function(){return an=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},an.apply(this,arguments)},ho=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},my=(function(){function r(t,e){e===void 0&&(e=1),this.isShowHorizontal=!1,this.isShowVertical=!1,this.position={x:0,y:0},this.graphModel=t,this.epsilon=e}return r.prototype.getStyle=function(){return an({},this.graphModel.theme.snapline)},r.prototype.getCenterSnapLine=function(t,e){for(var n=t.x,o=t.y,i=!1,a=!1,s=0;s<e.length;s++){var l=e[s];if(l.id!==t.id&&(ir(n,l.x,this.epsilon)&&(i=!0),ir(o,l.y,this.epsilon)&&(a=!0),i&&a))break}return{isShowVertical:i,isShowHorizontal:a,position:{x:n,y:o}}},r.prototype.getHorizontalSnapline=function(t,e){var n=!1,o=0,i=t.id,a;if(i){var s=this.graphModel.fakeNode;if(s&&s.id===i)a=Wt(s);else{var l=this.graphModel.getNodeModelById(i);l&&(a=Wt(l))}}for(var u=0;u<e.length;u++){var f=e[u];if(f.id!==t.id){var d=Wt(f);if(ir(d.minY,a==null?void 0:a.minY,this.epsilon)||ir(d.maxY,a==null?void 0:a.minY,this.epsilon)){n=!0,o=a.minY;break}if(ir(d.minY,a==null?void 0:a.maxY,this.epsilon)||ir(d.maxY,a==null?void 0:a.maxY,this.epsilon)){n=!0,o=a.maxY;break}}}return{isShowHorizontal:n,isShowVertical:this.isShowVertical,position:an(an({},this.position),{y:o})}},r.prototype.getVerticalSnapline=function(t,e){var n=!1,o=0,i=t.id,a;if(i){var s=this.graphModel.fakeNode;if(s&&s.id===i)a=Wt(s);else{var l=this.graphModel.getNodeModelById(i);l&&(a=Wt(l))}}for(var u=0;u<e.length;u++){var f=e[u];if(f.id!==t.id){var d=Wt(f);if(ir(d.minX,a==null?void 0:a.minX,this.epsilon)){n=!0,o=a.minX;break}if(ir(d.minX,a==null?void 0:a.minX,this.epsilon)||ir(d.maxX,a==null?void 0:a.minX,this.epsilon)){n=!0,o=a.minX;break}if(ir(d.minX,a==null?void 0:a.maxX,this.epsilon)||ir(d.maxX,a==null?void 0:a.maxX,this.epsilon)){n=!0,o=a.maxX;break}}}return{isShowHorizontal:this.isShowHorizontal,isShowVertical:n,position:an(an({},this.position),{x:o})}},r.prototype.getSnapLinePosition=function(t,e){var n=this.getCenterSnapLine(t,e),o=n.isShowHorizontal,i=n.isShowVertical;if(!o){var a=this.getHorizontalSnapline(t,e);a.isShowHorizontal&&(n.isShowHorizontal=a.isShowHorizontal,n.position.y=a.position.y)}if(!i){var s=this.getVerticalSnapline(t,e);s.isShowVertical&&(n.isShowVertical=s.isShowVertical,n.position.x=s.position.x)}return n},r.prototype.setSnaplineInfo=function(t){var e=t.isShowHorizontal,n=t.isShowVertical,o=t.position;this.position=o,this.isShowHorizontal=e,this.isShowVertical=n},r.prototype.clearSnapline=function(){this.position={x:0,y:0},this.isShowHorizontal=!1,this.isShowVertical=!1},r.prototype.setNodeSnapLine=function(t){var e=this.graphModel.nodes,n=this.getSnapLinePosition(t,e);this.setSnaplineInfo(n)},ho([I],r.prototype,"isShowHorizontal",void 0),ho([I],r.prototype,"isShowVertical",void 0),ho([I],r.prototype,"position",void 0),ho([L],r.prototype,"clearSnapline",null),ho([L],r.prototype,"setNodeSnapLine",null),r})();function ir(r,t,e){return Math.abs(r-t)<=e}var _y=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),xy=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},wy=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ey=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},by=(function(r){_y(t,r);function t(){var e=r.apply(this,Ey([],wy(arguments),!1))||this;return e.handleResize=function(){var n=e.props,o=n.graphModel,i=n.options,a=o.width,s=o.height,l=o.isContainerWidth,u=o.isContainerHeight,f=a,d=s,c=!1;l&&(f=void 0,c=!0),u&&(d=void 0,c=!0),c&&o.resize(f,d),i.width=a,i.height=s},e.throttleResize=Vc(e.handleResize,200),e}return t.prototype.componentDidMount=function(){window.addEventListener("resize",this.throttleResize)},t.prototype.componentDidUpdate=function(){var e=this.props.graphModel.modelToGraphData();this.props.graphModel.eventCenter.emit(ne.GRAPH_UPDATED,{data:e})},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.throttleResize)},t.prototype.getComponent=function(e,n,o){o===void 0&&(o="canvas-overlay");var i=this.props.getView,a=i(e.type);return a?k(a,{model:e,graphModel:n,overlay:o},e.id):null},t.prototype.render=function(){var e=this,n=this.props,o=n.graphModel,i=n.tool,a=n.options,s=n.dnd,l=n.snaplineModel,u={};a.width&&(u.width="".concat(o.width,"px")),a.height&&(u.height="".concat(o.height,"px"));var f=o.fakeNode,d=o.editConfigModel,c=o.background,h=d.adjustEdge;return k("div",{className:"lf-graph","flow-id":o.flowId,style:u,children:[k($g,{graphModel:o,dnd:s,children:[k("g",{className:"lf-base",children:gr(o.sortElements,function(p){return e.getComponent(p,o)})}),f?this.getComponent(f,o):""]}),k(ry,{graphModel:o,children:[k(iy,{graphModel:o}),h?k(Vg,{graphModel:o}):"",a.snapline!==!1?k(ly,{snaplineModel:l}):""]}),k(fy,{graphModel:o,tool:i}),c&&k(qg,{background:c}),k(In,{graphModel:o})]})},t=xy([Lt],t),t})(De),Sy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),wr=function(){return wr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},wr.apply(this,arguments)},Oy=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},My=(function(r){Sy(t,r);function t(){var e=r.call(this)||this;return e.onDragStart=function(n){var o=n.event,i=e.props,a=i.anchorData,s=i.nodeModel,l=i.graphModel;l.selectNodeById(s.id),s.autoToFront&&l.toFront(s.id),l.eventCenter.emit(ne.ANCHOR_DRAGSTART,{data:a,e:o,nodeModel:s}),e.setState({startX:a.x,startY:a.y,endX:a.x,endY:a.y})},e.onDragging=function(n){var o=n.event,i=e.props,a=i.graphModel,s=i.nodeModel,l=i.anchorData,u=a.transformModel,f=a.eventCenter,d=a.width,c=a.height,h=a.editConfigModel,p=h.autoExpand,v=h.stopMoveGraph;if(o){var g=o.clientX,y=o.clientY,w=a.getPointByClient({x:g,y}),M=w.domOverlayPosition,C=M.x,P=M.y,S=w.canvasOverlayPosition,E=S.x,T=S.y;e.t&&aa(e.t);var j=[],q=10;C<10?j=[q,0]:C+10>d?j=[-q,0]:P<10?j=[0,q]:P+10>c&&(j=[0,-q]),e.setState({endX:E,endY:T,dragging:!0}),e.moveAnchorEnd(E,T,o),j.length>0&&!v&&p&&(e.t=fc(function(){var ee=Oy(j,2),he=ee[0],ke=ee[1];u.translate(he,ke);var be=e.state,$e=be.endX,rt=be.endY;e.setState({endX:$e-he,endY:rt-ke}),e.moveAnchorEnd($e-he,rt-ke,o)})),f.emit(ne.ANCHOR_DRAG,{data:l,e:o,nodeModel:s})}},e.onDragEnd=function(n){var o=n.event;e.t&&aa(e.t);var i=e.checkEnd(o);e.setState({startX:0,startY:0,endX:0,endY:0,dragging:!1}),e.sourceRuleResults.clear(),e.targetRuleResults.clear();var a=e.props,s=a.graphModel,l=a.nodeModel,u=a.anchorData;e.preTargetNode&&(e.preTargetNode.setHovered(!1),e.preTargetNode=void 0),s.eventCenter.emit(ne.ANCHOR_DRAGEND,{data:u,e:o,nodeModel:l,edgeModel:i??void 0})},e.checkEnd=function(n){var o,i=e.props,a=i.graphModel,s=i.nodeModel,l=i.anchorData,u=l.x,f=l.y,d=l.id,c=e.state,h=c.endX,p=c.endY,v=c.dragging,g=oa({x:h,y:p},a);if(e.preTargetNode&&e.preTargetNode.state!==Xe.DEFAULT&&e.preTargetNode.setElementState(Xe.DEFAULT),!!v&&g&&g.node){var y=g.node,w=g.anchor.id,M="".concat(s.id,"_").concat(y.id,"_").concat(w,"_").concat(d),C=e.sourceRuleResults.get(M)||{},P=C.isAllPass,S=C.msg,E=e.targetRuleResults.get(M)||{},T=E.isAllPass,j=E.msg;if(P&&T){y.setElementState(Xe.DEFAULT);var q=a.getNodeModelById(g.node.id),ee=(o=a.edgeGenerator)===null||o===void 0?void 0:o.call(a,s.getData(),q==null?void 0:q.getData()),he=a.addEdge(wr(wr({},ee),{sourceNodeId:s.id,sourceAnchorId:d,startPoint:{x:u,y:f},targetNodeId:g.node.id,targetAnchorId:g.anchor.id,endPoint:{x:g.anchor.x,y:g.anchor.y}})),ke=e.props.anchorData;return a.eventCenter.emit(ne.ANCHOR_DROP,{data:ke,e:n,nodeModel:s,edgeModel:he}),he}var be=y.getData();return a.eventCenter.emit(ne.CONNECTION_NOT_ALLOWED,{data:be,msg:j||S||""}),null}},e.sourceRuleResults=new Map,e.targetRuleResults=new Map,e.state={startX:0,startY:0,endX:0,endY:0,dragging:!1},e.dragHandler=new rr({onDragStart:e.onDragStart,onDragging:e.onDragging,onDragEnd:e.onDragEnd}),e}return t.prototype.getAnchorShape=function(){var e=this.props,n=e.anchorData,o=e.style,i=e.node,a=i.getAnchorShape(n);if(a)return a;var s=n.x,l=n.y,u=wr(wr({},o),o==null?void 0:o.hover);return k("g",{children:[k(Kn,wr({className:"lf-node-anchor-hover"},u,{x:s,y:l})),k(Kn,wr({className:"lf-node-anchor"},o,{x:s,y:l}))]})},Object.defineProperty(t.prototype,"customTrajectory",{get:function(){var e=this.props.graphModel.customTrajectory;return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relateEdges",{get:function(){var e=this.props,n=e.graphModel,o=n.getAnchorIncomingEdge,i=n.getAnchorOutgoingEdge,a=e.anchorData.id;return{incomingEdgeList:o(a),outgoingEdgeList:i(a)}},enumerable:!1,configurable:!0}),t.prototype.moveAnchorEnd=function(e,n,o){var i,a,s=this.props,l=s.graphModel,u=s.nodeModel,f=s.anchorData,d=oa({x:e,y:n},l);if(d){var c=d.node,h=d.anchor.id;if(this.preTargetNode&&this.preTargetNode!==d.node&&this.preTargetNode.setElementState(Xe.DEFAULT),f.id===h)return;this.preTargetNode=c;var p="".concat(u.id,"_").concat(c.id,"_").concat(h,"_").concat(f.id);if(!this.targetRuleResults.has(p)){var v=d.anchor,g=u.isAllowConnectedAsSource(c,f,v),y=c.isAllowConnectedAsTarget(u,f,v);this.sourceRuleResults.set(p,ia(g)),this.targetRuleResults.set(p,ia(y))}var w=((i=this.sourceRuleResults.get(p))!==null&&i!==void 0?i:{}).isAllPass,M=((a=this.targetRuleResults.get(p))!==null&&a!==void 0?a:{}).isAllPass;if(w&&M?c.setElementState(Xe.ALLOW_CONNECT):c.setElementState(Xe.NOT_ALLOW_CONNECT),!c.isHovered){var C=c.getData();o&&l.eventCenter.emit(ne.NODE_MOUSEENTER,{data:C,e:o}),c.setHovered(!0)}}else if(this.preTargetNode&&this.preTargetNode.state!==Xe.DEFAULT){this.preTargetNode.setElementState(Xe.DEFAULT);var P=this.preTargetNode.getData();o&&l.eventCenter.emit(ne.NODE_MOUSELEAVE,{data:P,e:o}),this.preTargetNode.setHovered(!1),this.preTargetNode=void 0}},t.prototype.isShowLine=function(){var e=this.state,n=e.startX,o=e.startY,i=e.endX,a=e.endY,s=fr(n,o,i,a);return s>10},t.prototype.render=function(){var e=this,n=this.state,o=n.startX,i=n.startY,a=n.endX,s=n.endY,l=this.props,u=l.anchorData,f=l.edgeStyle,d=l.nodeModel,c=l.graphModel,h=u.edgeAddable;return k("g",{className:"lf-anchor",children:[k("g",{onClick:function(p){p.stopPropagation(),c.eventCenter.emit(ne.ANCHOR_CLICK,{data:u,e:p,nodeModel:d})},onPointerDown:function(p){c.eventCenter.emit(ne.ANCHOR_MOUSEDOWN,{data:u,e:p,nodeModel:d}),h!==!1&&e.dragHandler.handleMouseDown(p)},children:this.getAnchorShape()}),this.isShowLine()&&(this.customTrajectory?this.customTrajectory(wr({sourcePoint:{x:o,y:i},targetPoint:{x:a,y:s}},f)):k(Vn,wr({x1:o,y1:i,x2:a,y2:s},f,{"pointer-events":"none"})))]})},t})(De),Ay=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),qs=function(){return qs=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},qs.apply(this,arguments)},Ny=(function(r){Ay(t,r);function t(e){var n=r.call(this,e)||this;return n.style={},n.onDragging=function(o){var i,a=o.event,s=n.props,l=s.graphModel,u=s.nodeModel,f=s.eventCenter,d=l.selectNodes,c=u.x,h=u.y,p=a.clientX,v=a.clientY,g=l.getPointByClient({x:p,y:v}).canvasOverlayPosition,y=g.x,w=g.y,M=new Ot(y-c,w-h),C=((i=n.normal)===null||i===void 0?void 0:i.angle(M))-n.defaultAngle,P=new ra(-c,-h).rotate(C).translate(c,h).toString();u.transform=P,u.rotate=C;var S=gr(d,function(T){return T.id});S.indexOf(u.id)===-1&&(S=[u.id]);var E=Kc(S,function(T,j){var q=l.getNodeModelById(j);return T[j]=q==null?void 0:q.getMoveDistance(0,0,!1),T},{});S.forEach(function(T){var j=l.getNodeEdges(T);j.forEach(function(q){if(E[q.sourceNodeId]){var ee=l.getNodeModelById(q.sourceNodeId),he=ee.anchors.find(function(ke){return ke.id===q.sourceAnchorId});q.updateStartPoint(he)}if(E[q.targetNodeId]){var ee=l.getNodeModelById(q.targetNodeId),he=ee.anchors.find(function($e){return $e.id===q.targetAnchorId});q.updateEndPoint(he)}})}),f.emit(ne.NODE_ROTATE,{e:a,model:u,data:u.getData()})},n.style=e.style,n.stepperDrag=new rr({onDragging:n.onDragging}),n}return t.prototype.render=function(){var e=this,n=this.props.nodeModel,o=n.x,i=n.y,a=n.width,s=n.height,l=o+a/2+20,u=i-s/2-20;return this.normal=new Ot(1,0),this.defaultAngle=this.normal.angle(new Ot(l-o,u-i)),n.defaultAngle=this.defaultAngle,k("g",{className:"lf-rotate-control",children:k("g",{onPointerDown:function(f){e.stepperDrag.handleMouseDown(f)},children:k(Kn,qs({},this.style,{cx:l,cy:u}))})})},t})(De),ss={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var id;function Cy(){return id||(id=1,(function(r){(function(){var t={}.hasOwnProperty;function e(){for(var i="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(i=o(i,n(s)))}return i}function n(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return e.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var s in i)t.call(i,s)&&i[s]&&(a=o(a,s));return a}function o(i,a){return a?i?i+" "+a:i+a:i}r.exports?(e.default=e,r.exports=e):window.classNames=e})()})(ss)),ss.exports}var Ty=Cy();const Js=yl(Ty);var Py=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Qs=function(){return Qs=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Qs.apply(this,arguments)},Dy=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},mc=(function(r){Py(t,r);function t(e){var n=r.call(this)||this;n.mouseDownHandler=function(i){var a=n.props,s=a.draggable,l=a.model,u=a.graphModel,f=u.editConfigModel.nodeTextDraggable;(s??f)&&(i.stopPropagation(),n.stepperDrag.model=l,n.stepperDrag.handleMouseDown(i))},n.onDragging=function(i){var a=i.deltaX,s=i.deltaY,l=n.props,u=l.model,f=l.graphModel.transformModel;if(a||s){var d=Dy(f.fixDeltaXY(a,s),2),c=d[0],h=d[1];u.moveText(c,h)}},n.dbClickHandler=function(){var i=n.props,a=i.editable,s=i.graphModel.eventCenter,l=i.model;a&&l.setElementState(Xe.TEXT_EDIT),s.emit(ne.TEXT_DBCLICK,{data:l.text,model:l})};var o=e.draggable;return n.stepperDrag=new rr({onDragging:n.onDragging,step:1,eventType:"TEXT",isStopPropagation:o}),n}return t.prototype.getShape=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=n.text,s=a.value,l=a.x,u=a.y,f=a.editable,d=a.draggable,c={x:l,y:u,className:"",value:s},h=n.getTextStyle(),p=i.nodeTextDraggable||d;return k(cc,Qs({},c,h,{className:Js({"lf-element-text":f,"lf-text-draggable":!f&&p,"lf-text-disabled":!f&&!p}),model:n}))},t.prototype.render=function(){var e=this.props.model.text;if(e)return k("g",{onPointerDown:this.mouseDownHandler,onDblClick:this.dbClickHandler,children:this.getShape()})},t})(De),Ry=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),ar=function(){return ar=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ar.apply(this,arguments)},Mi=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Ly=(function(r){Ry(t,r);function t(e){var n=r.call(this,e)||this;return n.setHoverOn=function(){n.setState({isHovered:!0})},n.setHoverOff=function(){n.setState({isHovered:!1})},n.state={isHovered:!1},n}return t.prototype.getBackground=function(){var e=this.state.isHovered,n=this.props.model,o=n.text,i=n.getTextStyle(),a=i.background||{};if(e&&i.hover&&i.hover.background&&(a=ar(ar({},a),i.hover.background)),o!=null&&o.value&&(a==null?void 0:a.fill)!=="transparent"){var s=i.fontSize,l=i.textWidth,u=i.lineHeight,f=i.overflowMode,d=a.wrapPadding,c=o==null?void 0:o.value.split(/[\r\n]/g),h=c.length,p=o.x,v=o.y,g={};if(f==="autoWrap"&&l){var y=dc({rows:c,style:{fontSize:"".concat(s,"px"),width:"".concat(l,"px"),lineHeight:u,padding:d},rowsLength:h,className:"lf-get-text-height"});g=ar(ar({},a),{x:p,y:v,width:l,height:y})}else{var w=yv({rows:c,rowsLength:h,fontSize:s}),M=w.width,C=w.height;if(f==="ellipsis"&&(M=l,C=s+2),typeof a.wrapPadding=="string"){var P=a.wrapPadding.split(",").filter(function(ot){return ot.trim()}).map(function(ot){return parseFloat(ot.trim())});if(P.length>0&&P.length<=4){if(P.length===1){var S=Mi(P,1),E=S[0];P=[E,E,E,E]}else if(P.length===2){var T=Mi(P,2),j=T[0],q=T[1];P=[j,q,j,q]}else if(P.length===3){var ee=Mi(P,3),he=ee[0],q=ee[1],ke=ee[2];P=[he,q,ke,q]}var be=Mi(P,4),$e=be[0],rt=be[1],yt=be[2],pt=be[3];M+=rt+pt,C+=$e+yt,p=p+(rt-pt)/2,v=v+(yt-$e)/2}}g=ar(ar({},a),{x:p-1,y:v-1,width:M,height:C})}return k(Jt,ar({},g))}return null},t.prototype.getShape=function(){var e=this.props.model,n=e.text,o=n.x,i=n.y,a=n.value;if(!a)return null;var s=e.getTextStyle(),l=ar({x:o,y:i,value:a,model:e,className:"lf-element-text"},s);return k("g",{className:"lf-line-text",onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,children:[this.getBackground(),k(cc,ar({},l))]})},t})(mc),jy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),fa=function(){return fa=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},fa.apply(this,arguments)},Iy=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},Ai=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Kr=(function(r){jy(t,r);function t(e){var n=r.call(this)||this;n.onDragStart=function(l){var u=l.event,f=n.props,d=f.model,c=f.graphModel;if(u){var h=c.getPointByClient({x:u.clientX,y:u.clientY}).canvasOverlayPosition,p=h.x,v=h.y;n.moveOffset={dx:d.x-p,dy:d.y-v}}},n.onDragging=function(l){var u,f,d,c,h=l.event,p=n.props,v=p.model,g=p.graphModel,y=g.editConfigModel,w=y.stopMoveGraph,M=y.autoExpand,C=y.snapGrid,P=g.transformModel,S=g.selectNodes,E=g.width,T=g.height,j=g.gridSize;v.isDragging=!0;var q=h,ee=q.clientX,he=q.clientY,ke=g.getPointByClient({x:ee,y:he}).canvasOverlayPosition,be=ke.x,$e=ke.y,rt=Ai(P.CanvasPointToHtmlPoint([be,$e]),2),yt=rt[0],pt=rt[1];if(be=be+((f=(u=n.moveOffset)===null||u===void 0?void 0:u.dx)!==null&&f!==void 0?f:0),$e=$e+((c=(d=n.moveOffset)===null||d===void 0?void 0:d.dy)!==null&&c!==void 0?c:0),be=Un(be,j,C),$e=Un($e,j,C),!E||!T){g.moveNode2Coordinate(v.id,be,$e);return}var ot=yt<0||pt<0||yt>E||pt>T;if(!(M&&!w&&ot)){var st=Ai(P.CanvasPointToHtmlPoint([be-v.width/2,$e-v.height/2]),2),ge=st[0],Re=st[1],Be=Ai(P.CanvasPointToHtmlPoint([be+v.width/2,$e+v.height/2]),2),Ce=Be[0],Ke=Be[1],N=Math.max(j,20),X=[];ge<0?X=[N,0]:Ce>g.width?X=[-N,0]:Re<0?X=[0,N]:Ke>g.height&&(X=[0,-N]),n.t&&aa(n.t);var G=S.map(function(V){return V.id});G.indexOf(v.id)===-1&&(G=[v.id]),X.length>0&&!w&&M?n.t=fc(function(){var V=Ai(X,2),J=V[0],le=V[1];P.translate(J??0,le??0);var ve=-(J??0)/P.SCALE_X,qe=-(le??0)/P.SCALE_X;g.moveNodes(G,ve,qe)}):g.moveNodes(G,be-v.x,$e-v.y)}},n.onDragEnd=function(){n.t&&aa(n.t);var l=n.props.model;l.isDragging=!1},n.onMouseOut=function(l){Up()&&n.setHoverOff(l)},n.handleMouseUp=function(){var l=n.props.model;n.mouseUpDrag=l.isDragging,n.longPressTimer&&(clearTimeout(n.longPressTimer),n.longPressTimer=void 0)},n.handleClick=function(l){var u=n.mouseUpDrag===!1,f=new Date().getTime();if(n.startTime){var d=f-n.startTime,c=n.props,h=c.model,p=c.graphModel;if(!(!u&&d>100)){u||(n.onDragEnd(),n.handleMouseUp());var v=h.getData(),g=p.getPointByClient({x:l.clientX,y:l.clientY}),y={data:v,e:l,position:g,isSelected:!1,isMultiple:!1},w=l.button===2,M=l.detail===2;if(!w){var C=p.editConfigModel,P=lc(l,C);y.isMultiple=P,h.isSelected&&!M&&P?(y.isSelected=!1,h.setSelected(!1)):(p.selectNodeById(h.id,P),y.isSelected=!0,C.isSilentMode||n.toFront()),M?(C.nodeTextEdit&&h.text.editable&&C.textMode===er.TEXT&&(h.setSelected(!1),p.setElementStateById(h.id,Xe.TEXT_EDIT)),p.eventCenter.emit(ne.NODE_DBCLICK,y)):(p.eventCenter.emit(ne.ELEMENT_CLICK,y),p.eventCenter.emit(ne.NODE_CLICK,y))}}}},n.handleContextMenu=function(l){l.preventDefault();var u=n.props,f=u.model,d=u.graphModel,c=d.editConfigModel,h=f.getData(),p=d.getPointByClient({x:l.clientX,y:l.clientY});d.setElementStateById(f.id,Xe.SHOW_MENU,p.domOverlayPosition),f.isSelected||d.selectNodeById(f.id),d.eventCenter.emit(ne.NODE_CONTEXTMENU,{data:h,e:l,position:p}),c.isSilentMode||n.toFront()},n.handleMouseDown=function(l){var u=n.props,f=u.model,d=u.graphModel;n.startTime=new Date().getTime();var c=d.editConfigModel;c.adjustNodePosition&&f.draggable&&n.stepDrag&&n.stepDrag.handleMouseDown(l),n.longPressTimer&&clearTimeout(n.longPressTimer),l.pointerType==="touch"&&(n.longPressTimer=window.setTimeout(function(){n.props.model.isDragging||n.handleContextMenu(l)},500))},n.handleFocus=function(){var l=n.props,u=l.model,f=l.graphModel;f.eventCenter.emit(ne.NODE_FOCUS,{data:u.getData()})},n.handleBlur=function(){if(n.props){var l=n.props,u=l.model,f=l.graphModel;f.eventCenter.emit(ne.NODE_BLUR,{data:u.getData()})}},n.setHoverOn=function(l){var u=n.props,f=u.model,d=u.graphModel;if(!f.isHovered){var c=f.getData();f.setHovered(!0),d.eventCenter.emit(ne.NODE_MOUSEENTER,{data:c,e:l})}},n.setHoverOff=function(l){var u=n.props,f=u.model,d=u.graphModel,c=f.getData();f.isHovered&&(f.setHovered(!1),d.eventCenter.emit(ne.NODE_MOUSELEAVE,{data:c,e:l}))};var o=e.graphModel,i=o.gridSize,a=o.eventCenter,s=e.model;return n.stepDrag=new rr({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:i,eventType:"NODE",isStopPropagation:!1,eventCenter:a,model:s}),n.modelDisposer=If(function(){return n.props},function(l){l&&l.model&&n.stepDrag.setModel(l.model)}),n}return t.prototype.componentWillUnmount=function(){this.modelDisposer&&this.modelDisposer(),this.render.$mobx&&this.render.$mobx.dispose()},t.prototype.componentDidMount=function(){},t.prototype.componentDidUpdate=function(){},t.prototype.getAnchorShape=function(e){return null},t.prototype.getAnchors=function(){var e=this,n=this.props,o=n.model,i=n.graphModel,a=o.isSelected,s=o.isHitable,l=o.isDragging,u=o.isShowAnchor;return s&&(a||u)&&!l?gr(o.anchors,function(f,d){var c=o.getAnchorLineStyle(f),h=o.getAnchorStyle(f);return k(My,{anchorData:f,node:e,style:h,edgeStyle:c,anchorIndex:d,nodeModel:o,graphModel:i,setHoverOff:e.setHoverOff})}):[]},t.prototype.getRotateControl=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.isSilentMode,s=i.allowRotate,l=n.isSelected,u=n.isHitable,f=n.rotatable,d=n.isHovered,c=s&&f,h=n.getRotateControlStyle();if(!a&&u&&(l||d)&&c)return k(Ny,{graphModel:o,nodeModel:n,eventCenter:o.eventCenter,style:h})},t.prototype.getResizeControl=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.isSilentMode,s=i.allowResize,l=n.isSelected,u=n.isHitable,f=n.resizable,d=n.isHovered,c=s&&f,h=n.getResizeControlStyle();return!a&&u&&(l||d)&&c?k(Uv,{style:h,model:n,graphModel:o}):null},t.prototype.getText=function(){var e,n=this.props,o=n.model,i=n.graphModel,a=i.editConfigModel;if(a.nodeTextMode!==er.TEXT||o.state===Xe.TEXT_EDIT)return null;if(o.text){var s=!1;return a.nodeTextDraggable&&o.text.draggable&&(s=!0),k(mc,{editable:a.nodeTextEdit&&((e=o.text.editable)!==null&&e!==void 0?e:!0),model:o,graphModel:i,draggable:s})}return null},t.prototype.getStateClassName=function(){var e=this.props.model,n=e.state,o=e.isDragging,i=e.isSelected,a="lf-node";switch(n){case Xe.ALLOW_CONNECT:a+=" lf-node-allow";break;case Xe.NOT_ALLOW_CONNECT:a+=" lf-node-not-allow";break;default:a+=" lf-node-default";break}return o&&(a+=" lf-dragging"),i&&(a+=" lf-node-selected"),a},t.prototype.toFront=function(){var e=this.props,n=e.model,o=e.graphModel;n.autoToFront&&o.toFront(n.id)},t.prototype.render=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.hideAnchors,s=i.adjustNodePosition,l=i.allowRotate,u=i.allowResize,f=o.gridSize,d=o.transformModel.SCALE_X,c=n.isHitable,h=n.draggable,p=n.transform,v=n.getOuterGAttributes(),g=v.className,y=g===void 0?"":g,w=Iy(v,["className"]),M=k("g",{className:"lf-node-content",children:[k("g",{transform:p,children:[this.getShape(),this.getText(),l&&this.getRotateControl(),u&&this.getResizeControl()]}),!a&&this.getAnchors()]}),C;return c?(s&&h&&this.stepDrag.setStep(f*d),C=k("g",fa({className:"".concat(this.getStateClassName()," ").concat(y),onPointerDown:this.handleMouseDown,onPointerUp:this.handleMouseUp,onClick:this.handleClick,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,onMouseOut:this.onMouseOut,onContextMenu:this.handleContextMenu,onFocus:this.handleFocus,onBlur:this.handleBlur},w,{children:M}))):C=k("g",fa({className:"".concat(this.getStateClassName()," ").concat(y)},w,{children:M})),C},t.isObserved=!1,t})(De),ky=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),el=function(){return el=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},el.apply(this,arguments)},gn=(function(r){ky(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle();return k(Jt,el({},n,{x:e.x,y:e.y,width:e.width,height:e.height,radius:e.radius}))},t})(Kr),By=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),tl=function(){return tl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},tl.apply(this,arguments)},ca=(function(r){By(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.r,a=e.getNodeStyle();return k(Kn,tl({},a,{x:n,y:o,r:i}))},t})(Kr),Xy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),ha=function(){return ha=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ha.apply(this,arguments)},pa=(function(r){Xy(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e,o=n.x,i=n.y,a=n.width,s=n.height,l=n.points,u=e.getNodeStyle(),f={transform:"matrix(1 0 0 1 ".concat(o-a/2," ").concat(i-s/2,")")};return k("g",ha({},f,{children:k(jl,ha({},u,{points:l,x:o,y:i}))}))},t})(Kr),Hy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),rl=function(){return rl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},rl.apply(this,arguments)},nl=(function(r){Hy(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle();return k("g",{children:k(jl,rl({},n,{points:e.points,x:e.x,y:e.y}))})},t})(Kr),Gy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),ol=function(){return ol=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ol.apply(this,arguments)},il=(function(r){Gy(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle();return k(Xv,ol({},n,{x:e.x,y:e.y,rx:e.rx,ry:e.ry}))},t})(Kr),zy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),To=function(){return To=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},To.apply(this,arguments)},ad=(function(r){zy(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getBackground=function(){var e=this.props.model,n=e.getTextStyle(),o=e.width,i=e.height,a=e.x,s=e.y,l=To(To({},n.background),{x:a,y:s,width:o,height:i});return k(Jt,To({},l))},t.prototype.getResizeControl=function(){return null},t.prototype.getShape=function(){return k("g",{children:this.getBackground()})},t})(Kr),Yy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),al=function(){return al=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},al.apply(this,arguments)},Fy=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},$y=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},va=(function(r){Yy(t,r);function t(){var e=r.apply(this,$y([],Fy(arguments),!1))||this;return e.ref=ka(),e}return Object.defineProperty(t.prototype,"rootEl",{get:function(){return this.ref.current},enumerable:!1,configurable:!0}),t.prototype.setHtml=function(e){e.appendChild(document.createElement("div"))},t.prototype.confirmUpdate=function(e){this.setHtml(e)},t.prototype.shouldUpdate=function(){return this.preProperties&&this.preProperties===this.currentProperties?!1:(this.preProperties=this.currentProperties,!0)},t.prototype.componentDidMount=function(){this.shouldUpdate()&&this.rootEl&&this.setHtml(this.rootEl)},t.prototype.componentDidUpdate=function(){this.shouldUpdate()&&this.rootEl&&this.confirmUpdate(this.rootEl)},t.prototype.componentWillUnmount=function(){r.prototype.componentWillUnmount.call(this),this.rootEl.innerHTML=""},t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.height,a=e.width,s=e.getNodeStyle();return this.currentProperties=JSON.stringify(e.properties),k("foreignObject",al({},s,{x:n-a/2,y:o-i/2,width:a,height:i,ref:this.ref}))},t})(Kr),Wy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),sr=function(){return sr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},sr.apply(this,arguments)},Uy=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},Vy=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},br;(function(r){r.SOURCE="SOURCE",r.TARGET="TARGET"})(br||(br={}));var sd=(function(r){Wy(t,r);function t(e){var n=r.call(this)||this;n.handleMouseDown=function(l){n.stepDrag&&n.stepDrag.handleMouseDown(l)},n.onDragStart=function(){var l=n.props,u=l.x,f=l.y,d=l.edgeModel,c=d.startPoint,h=d.endPoint,p=d.pointsList;n.oldEdge={startPoint:c,endPoint:h,pointsList:p},n.setState({endX:u,endY:f,dragging:!0})},n.onDragging=function(l){var u=l.deltaX,f=l.deltaY,d=n.state,c=d.endX,h=d.endY,p=n.props,v=p.graphModel,g=p.type,y=v.transformModel,w=v.editConfigModel,M=Vy(y.moveCanvasPointByHtml([c,h],u,f),2),C=M[0],P=M[1];n.setState({endX:C,endY:P,dragging:!0});var S=n.props.edgeModel,E=oa({x:c,y:h},v);if(E&&E.node&&n.isAllowAdjust(E).pass){var T=S.startPoint,j=S.endPoint,q=S.sourceNode,ee=S.targetNode,he=g===br.SOURCE?{startPoint:{x:E.anchor.x,y:E.anchor.y},endPoint:{x:j.x,y:j.y},sourceNode:E.node,targetNode:ee}:{startPoint:{x:T.x,y:T.y},endPoint:{x:E.anchor.x,y:E.anchor.y},sourceNode:q,targetNode:E.node};S.updateAfterAdjustStartAndEnd(he)}else g===br.SOURCE?S.updateStartPoint({x:C,y:P}):S.updateEndPoint({x:C,y:P});S.text.value&&w.adjustEdge&&S.setText(Object.assign({},S.text,S.textPosition))},n.onDragEnd=function(l){var u,f,d,c=l.event;try{n.setState({dragging:!1});var h=n.props,p=h.graphModel,v=h.edgeModel,g=h.type,y=n.state,w=y.endX,M=y.endY,C=y.dragging,P=oa({x:w,y:M},p);if(!C)return;var S=!1,E=void 0;if(P&&P.node){var T=n.isAllowAdjust(P),j=T.pass,q=T.msg,ee=T.newTargetNode;if(j){var he=v.getData(),ke=he.text,be=he.sourceAnchorId,$e=be===void 0?"":be,rt=he.targetAnchorId,yt=rt===void 0?"":rt,pt=Uy(he,["text","sourceAnchorId","targetAnchorId"]);if(E=sr(sr({sourceAnchorId:$e,targetAnchorId:yt},pt),{text:(ke==null?void 0:ke.value)||""}),g===br.SOURCE){var ot=p.getNodeModelById(P.node.id),st=p.getNodeModelById(v.targetNodeId),ge=(u=p.edgeGenerator)===null||u===void 0?void 0:u.call(p,ot==null?void 0:ot.getData(),st==null?void 0:st.getData(),E);E=sr(sr({},ge),{sourceNodeId:P.node.id,sourceAnchorId:P.anchor.id,startPoint:{x:P.anchor.x,y:P.anchor.y},targetNodeId:v.targetNodeId,endPoint:sr({},v.endPoint)}),v.sourceNodeId===P.node.id&&v.sourceAnchorId===P.anchor.id&&(S=!0)}else if(g===br.TARGET){var ot=p.getNodeModelById(v.sourceNodeId),st=p.getNodeModelById(P.node.id),ge=(f=p.edgeGenerator)===null||f===void 0?void 0:f.call(p,ot==null?void 0:ot.getData(),st==null?void 0:st.getData(),E);E=sr(sr({},ge),{sourceNodeId:v.sourceNodeId,startPoint:sr({},v.startPoint),targetNodeId:P.node.id,targetAnchorId:P.anchor.id,endPoint:{x:P.anchor.x,y:P.anchor.y}}),v.targetNodeId===P.node.id&&v.targetAnchorId===P.anchor.id&&(S=!0)}}else{S=!0;var Re=ee.getData();p.eventCenter.emit(ne.CONNECTION_NOT_ALLOWED,{data:Re,msg:q})}}else S=!0;if(S)n.recoveryEdge();else{var Be=v.getData();p.deleteEdgeById(v.id);var Ce=p.addEdge(sr({},E));p.eventCenter.emit(ne.EDGE_EXCHANGE_NODE,{data:{newEdge:Ce.getData(),oldEdge:Be}})}(d=n.preTargetNode)===null||d===void 0||d.setElementState(Xe.DEFAULT)}finally{var p=n.props.graphModel;p.eventCenter.emit(ne.ADJUST_POINT_DRAGEND,{e:c,data:n.stepDragData})}},n.recoveryEdge=function(){var l=n.props.edgeModel,u=n.oldEdge,f=u.startPoint,d=u.endPoint,c=u.pointsList;l.updateStartPoint(f),l.updateEndPoint(d),l.modelType!==Ae.LINE_EDGE&&(l.pointsList=c??[],l.initPoints())},n.getAdjustPointStyle=function(){var l=n.props.graphModel.theme,u=l.edgeAdjust;return u},n.state={dragging:!1,endX:0,endY:0},n.targetRuleResults=new Map,n.sourceRuleResults=new Map;var o=e.type,i=e.edgeModel,a=e.graphModel,s=a.eventCenter;return n.stepDragData={type:o,edgeData:i.getData()},n.stepDrag=new rr({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,eventType:"ADJUST_POINT",isStopPropagation:!1,eventCenter:s,data:n.stepDragData}),n}return t.prototype.isAllowAdjust=function(e){var n=this.props,o=n.edgeModel,i=o.id,a=o.sourceNode,s=o.targetNode,l=o.sourceAnchorId,u=o.targetAnchorId,f=n.type,d,c,h,p;if(f===br.SOURCE?(d=e.node,c=s,h=e.anchor,p=s.getAnchorInfo(u)):(d=a,c=e.node,p=e.anchor,h=a.getAnchorInfo(l)),this.preTargetNode&&this.preTargetNode!==e.node&&this.preTargetNode.setElementState(Xe.DEFAULT),this.preTargetNode=e.node,p.id===h.id)return{pass:!1,msg:"",newTargetNode:c};var v="".concat(d.id,"_").concat(c.id,"_").concat(h.id,"_").concat(p.id);if(!this.targetRuleResults.has(v)){var g=d.isAllowConnectedAsSource(c,h,p,i),y=c.isAllowConnectedAsTarget(d,h,p,i);this.sourceRuleResults.set(v,ia(g)),this.targetRuleResults.set(v,ia(y))}var w=this.sourceRuleResults.get(v),M=w.isAllPass,C=w.msg,P=this.targetRuleResults.get(v),S=P.isAllPass,E=P.msg,T=M&&S?Xe.ALLOW_CONNECT:Xe.NOT_ALLOW_CONNECT;return f===br.SOURCE?d.setElementState(T):c.setElementState(T),{pass:M&&S,msg:E||C,newTargetNode:c}},t.prototype.render=function(){var e=this.props,n=e.x,o=e.y,i=e.getAdjustPointShape,a=e.edgeModel,s=this.state.dragging;return k("g",{pointerEvents:s?"none":"",onPointerDown:this.handleMouseDown,children:s?"":i(n,o,a)})},t})(De),Ky=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),sl=function(){return sl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},sl.apply(this,arguments)};(function(r){Ky(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getArrowAttributes=function(){var e=this.props,n=e.arrowInfo,o=e.style,i=n.start,a=n.end,s={start:i,end:a,offset:o.offset,verticalLength:o.verticalLength,type:"end"},l=zo(s),u=l.leftX,f=l.leftY,d=l.rightX,c=l.rightY;return sl({d:"M".concat(u," ").concat(f," L").concat(a.x," ").concat(a.y," L").concat(d," ").concat(c," z")},o)},t.prototype.getShape=function(){var e=this.getArrowAttributes(),n=e.d,o=e.strokeWidth,i=e.stroke,a=e.fill;return k($o,{d:n,fill:a,strokeWidth:o,stroke:i})},t.prototype.render=function(){return k("g",{className:"lf-arrow",children:this.getShape()})},t})(De);var Zy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Po=function(){return Po=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Po.apply(this,arguments)},qy=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},$a=(function(r){Zy(t,r);function t(){var e=r.call(this)||this;return e.textRef=ka(),e.handleHover=function(n,o){var i=e.props,a=i.model,s=i.graphModel.eventCenter;a.setHovered(n);var l=n?ne.EDGE_MOUSEENTER:ne.EDGE_MOUSELEAVE,u=a.getData();s.emit(l,{data:u,e:o})},e.setHoverOn=function(n){var o=e.props.model.isHovered;o||(e.textRef&&e.textRef.current&&e.textRef.current.setHoverOn(),e.handleHover(!0,n))},e.setHoverOff=function(n){var o=e.props.model.isHovered;o&&(e.textRef&&e.textRef.current&&e.textRef.current.setHoverOff(),e.handleHover(!1,n))},e.handleContextMenu=function(n){n.preventDefault(),e.contextMenuTime=new Date().getTime(),e.clickTimer&&clearTimeout(e.clickTimer);var o=e.props,i=o.model,a=o.graphModel,s=a.editConfigModel,l=a.getPointByClient({x:n.clientX,y:n.clientY});a.setElementStateById(i.id,Xe.SHOW_MENU,l.domOverlayPosition),s.isSilentMode||e.toFront(),i.isSelected||a.selectEdgeById(i.id);var u=i==null?void 0:i.getData();a.eventCenter.emit(ne.EDGE_CONTEXTMENU,{data:u,e:n,position:l})},e.handleMouseDown=function(n){n.stopPropagation(),e.startTime=new Date().getTime(),e.longPressTimer&&clearTimeout(e.longPressTimer),n.pointerType==="touch"&&(e.longPressTimer=window.setTimeout(function(){e.props.model.isDragging||e.handleContextMenu(n)},500))},e.handleMouseUp=function(){var n=e.props.model;e.mouseUpDrag=n.isDragging,e.longPressTimer&&(clearTimeout(e.longPressTimer),e.longPressTimer=void 0)},e.handleClick=function(n){if(e.startTime&&!e.mouseUpDrag){var o=n.button===2;if(!o){var i=n.detail===2,a=e.props,s=a.model,l=a.graphModel,u=s==null?void 0:s.getData(),f=l.getPointByClient({x:n.clientX,y:n.clientY});if(i){var d=l.editConfigModel,c=l.textEditElement,h=s.id,p=s.text,v=s.modelType;if(c&&c.id===h&&l.setElementStateById(h,Xe.DEFAULT),d.edgeTextEdit&&p.editable&&(s.setSelected(!1),l.setElementStateById(h,Xe.TEXT_EDIT)),v===Ae.POLYLINE_EDGE){var g=s,y=l.getPointByClient({x:n.x,y:n.y}).canvasOverlayPosition,w=y.x,M=y.y;g.dbClickPosition=sc({x:w,y:M},g.points)}l.eventCenter.emit(ne.EDGE_DBCLICK,{data:u,e:n,position:f})}else l.eventCenter.emit(ne.ELEMENT_CLICK,{data:u,e:n,position:f}),l.eventCenter.emit(ne.EDGE_CLICK,{data:u,e:n,position:f});var C=l.editConfigModel;l.selectEdgeById(s.id,lc(n,C)),C.isSilentMode||e.toFront()}}},e.handleFocus=function(){var n=e.props,o=n.model,i=n.graphModel;i.eventCenter.emit(ne.EDGE_FOCUS,{data:o.getData()})},e.handleBlur=function(){var n=e.props,o=n.model,i=n.graphModel;i.eventCenter.emit(ne.EDGE_BLUR,{data:o.getData()})},e}return t.prototype.getShape=function(){return k("g",{children:this.getEdge()})},t.prototype.getTextStyle=function(){},t.prototype.getText=function(){var e,n=this.props,o=n.model,i=n.graphModel,a=i.editConfigModel;if(a.edgeTextMode!==er.TEXT||o.state===Xe.TEXT_EDIT)return null;if(o.text){var s=!1;return a.edgeTextDraggable&&o.text.draggable&&(s=!0),k(Ly,{ref:this.textRef,editable:a.edgeTextEdit&&((e=o.text.editable)!==null&&e!==void 0?e:!0),model:o,graphModel:i,draggable:s})}return null},t.prototype.getArrowInfo=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint,i=e.isSelected,a=this.state.hover;return{start:n,end:o,hover:a,isSelected:i}},t.prototype.getLastTwoPoints=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint;return[n,o]},t.prototype.getArrowStyle=function(){return console.error("getArrowStyle is deprecated in 1.2.0, please use model.getArrowStyle"),null},t.prototype.getArrow=function(){var e=this.props.model,n=e.id,o=e.getArrowStyle(),i=o.refY,a=i===void 0?0:i,s=o.refX,l=s===void 0?2:s,u=qy(this.getLastTwoPoints(),2),f=u[0],d=u[1],c="auto";if(f&&d){var h=d.x-f.x,p=d.y-f.y;if(h!==0||p!==0){var v=ug(lg({x:h,y:p}));Number.isFinite(v)&&!Number.isNaN(v)&&(c=v)}}return k("g",{children:k("defs",{children:[k("marker",{id:"marker-start-".concat(n),refX:-l,refY:a,overflow:"visible",orient:"auto",markerUnits:"userSpaceOnUse",children:this.getStartArrow()}),k("marker",{id:"marker-end-".concat(n),refX:l,refY:a,overflow:"visible",orient:c,markerUnits:"userSpaceOnUse",children:this.getEndArrow()})]})})},t.prototype.getArrowPath=function(e,n){var o=n.stroke,i=n.fill,a=i===void 0?o:i,s=n.strokeWidth,l=n.offset,u=l===void 0?10:l,f=n.verticalLength,d=n.strokeLinecap,c=n.strokeLinejoin,h=n.transform,p="";switch(e){case"solid":p="M".concat(-u/4,",0 L").concat(3*u/4,",").concat(f," L").concat(3*u/4,",-").concat(f," Z");break;case"hollow":p="M".concat(-u/4,",0 L").concat(3*u/4,",").concat(f," L").concat(-u/4,",0 L").concat(3*u/4,",-").concat(f," L").concat(-u/4,",0 Z");break;case"diamond":p="M".concat(-u/2,",0 L0,").concat(f," L").concat(u/2,",0 L0,-").concat(f," L").concat(-u/2,",0 Z");break;case"circle":p="M".concat(-u/2,",0 A").concat(u/4,",").concat(u/4," 0 1,0 ").concat(u/2,",0 A").concat(u/4,",").concat(u/4," 0 1,0 ").concat(-u/2,",0 Z");break;default:p="";break}return k("path",{d:p,stroke:o,fill:a,strokeWidth:s,strokeLinecap:d,strokeLinejoin:c,transform:h})},t.prototype.getStartArrow=function(){var e=this.props.model,n=e.getArrowStyle(),o=n.stroke,i=n.strokeWidth,a=n.offset,s=n.verticalLength,l=n.startArrowType,u=l===void 0?"none":l,f=n.strokeLinecap,d=n.strokeLinejoin;return this.getArrowPath(u,{stroke:o,strokeWidth:i,offset:a,verticalLength:s,strokeLinecap:f,strokeLinejoin:d})},t.prototype.getEndArrow=function(){var e=this.props.model,n=e.getArrowStyle(),o=n.stroke,i=n.strokeWidth,a=n.offset,s=n.verticalLength,l=n.endArrowType,u=l===void 0?"solid":l,f=n.strokeLinecap,d=n.strokeLinejoin;return this.getArrowPath(u,{stroke:o,strokeWidth:i,offset:a,verticalLength:s,strokeLinecap:f,strokeLinejoin:d,transform:"rotate(180)"})},t.prototype.getAdjustPointShape=function(e,n,o){var i=o.getAdjustPointStyle();return k(Kn,Po({className:"lf-edge-adjust-point"},i,{x:e,y:n}))},t.prototype.getAdjustPoints=function(){var e=this.props,n=e.model,o=e.graphModel,i=o.editConfigModel,a=i.adjustEdgeStartAndEnd,s=i.adjustEdgeStart,l=i.adjustEdgeEnd,u=n.getAdjustStart(),f=n.getAdjustEnd();return k("g",{children:[a&&s&&k(sd,Po({type:br.SOURCE},u,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:n,graphModel:o})),a&&l&&k(sd,Po({type:br.TARGET},f,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:n,graphModel:o}))]})},t.prototype.getAnimation=function(){console.error("getAnimation is deprecated in 1.2.0, please use model.getEdgeAnimationStyle")},t.prototype.getAppendWidth=function(){return k("g",{})},t.prototype.getAppend=function(){return k("g",{className:"lf-edge-append",children:this.getAppendWidth()})},t.prototype.getEdge=function(){return null},t.prototype.toFront=function(){var e=this.props,n=e.graphModel,o=e.model;n.toFront(o.id)},t.prototype.render=function(){var e=this.props.model,n=e.isSelected,o=e.isHitable,i=e.isShowAdjustPoint;return k("g",{children:[k("g",{className:["lf-edge",!o&&"pointer-none",n&&"lf-edge-selected"].filter(Boolean).join(" "),style:{touchAction:"none",WebkitTouchCallout:"none"},onClick:this.handleClick,onContextMenu:this.handleContextMenu,onPointerDown:this.handleMouseDown,onPointerUp:this.handleMouseUp,onPointerCancel:this.handleMouseUp,onMouseOver:this.setHoverOn,onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,onFocus:this.handleFocus,onBlur:this.handleBlur,children:[this.getShape(),this.getAppend(),this.getText(),this.getArrow()]}),i&&n?this.getAdjustPoints():""]})},t.isObserved=!1,t})(De),Jy=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),ll=function(){return ll=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ll.apply(this,arguments)},Qy=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},ld=(function(r){Jy(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getEdge=function(){var e=this.props.model,n=e.getEdgeStyle(),o=e,i=o.path,a=o.isAnimation,s=o.arrowConfig,l=e.getEdgeAnimationStyle(),u=l.strokeDasharray,f=l.stroke,d=l.strokeDashoffset,c=l.animationName,h=l.animationDuration,p=l.animationIterationCount,v=l.animationTimingFunction,g=l.animationDirection;return k($o,ll({d:i},n,s,a?{strokeDasharray:u,stroke:f,style:{strokeDashoffset:d,animationName:c,animationDuration:h,animationIterationCount:p,animationTimingFunction:v,animationDirection:g}}:{}))},t.prototype.getAppendWidth=function(){var e=this.props.model.path;return k($o,{d:e,strokeWidth:10,stroke:"transparent",fill:"none"})},t.prototype.getArrowInfo=function(){var e=this.props.model,n=this.state.hover,o=e.isSelected,i=e.getArrowStyle().offset,a=e.pointsList.map(function(d){return{x:d.x,y:d.y}}),s=Qy(Hu(a,i),2),l=s[0],u=s[1],f={start:l,end:u,hover:n,isSelected:o};return f},t.prototype.getLastTwoPoints=function(){var e=this.props.model,n=e.getArrowStyle().offset,o=e.pointsList.map(function(i){return{x:i.x,y:i.y}});return Hu(o,n)},t})($a),em=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),ul=function(){return ul=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ul.apply(this,arguments)},ud=(function(r){em(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getEdge=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint,i=e.isAnimation,a=e.arrowConfig,s=e.getEdgeStyle(),l=e.getEdgeAnimationStyle(),u=l.strokeDasharray,f=l.stroke,d=l.strokeDashoffset,c=l.animationName,h=l.animationDuration,p=l.animationIterationCount,v=l.animationTimingFunction,g=l.animationDirection;return k(Vn,ul({},s,{x1:n.x,y1:n.y,x2:o.x,y2:o.y},a,i?{strokeDasharray:u,stroke:f,style:{strokeDashoffset:d,animationName:c,animationDuration:h,animationIterationCount:p,animationTimingFunction:v,animationDirection:g}}:{}))},t.prototype.getAppendWidth=function(){var e=this.props.model,n=e.startPoint,o=e.endPoint,i={start:n,end:o},a=pv(i),s=a.d,l=a.strokeWidth,u=a.fill,f=a.strokeDasharray,d=a.stroke;return k($o,{d:s,fill:u,strokeWidth:l,stroke:d,strokeDasharray:f})},t})($a),tm=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),sn=function(){return sn=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},sn.apply(this,arguments)},rm=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Qo=(function(r){tm(t,r);function t(){var e=r.call(this)||this;return e.onDragStart=function(){var n=e.props.model;n.dragAppendStart(),e.isShowAdjustPointTemp=n.isShowAdjustPoint,n.isShowAdjustPoint=!1},e.onDragging=function(n){var o=n.deltaX,i=n.deltaY,a=e.props,s=a.model,l=a.graphModel;e.isDragging=!0;var u=l.transformModel,f=l.editConfigModel,d=rm(u.fixDeltaXY(o,i),2),c=d[0],h=d[1],p=s,v=f.adjustEdgeMiddle;v?e.appendInfo=p.dragAppendSimple(e.appendInfo,{x:c,y:h}):e.appendInfo=p.dragAppend(e.appendInfo,{x:c,y:h})},e.onDragEnd=function(){var n,o=e.props,i=o.model,a=o.graphModel.eventCenter,s=i;s.dragAppendEnd(),e.isDragging=!1,s.isShowAdjustPoint=(n=e.isShowAdjustPointTemp)!==null&&n!==void 0?n:!1,e.appendInfo=void 0,a.emit(ne.EDGE_ADJUST,{data:s.getData()})},e.beforeDragStart=function(n,o){o.draggable&&e.drag.handleMouseDown(n),e.appendInfo=o},e.drag=new rr({onDragStart:e.onDragStart,onDragging:e.onDragging,onDragEnd:e.onDragEnd,isStopPropagation:!1}),e}return t.prototype.getEdge=function(){var e=this.props.model,n=e.points,o=e.isAnimation,i=e.arrowConfig,a=e.getEdgeStyle(),s=e.getEdgeAnimationStyle(),l=s.strokeDasharray,u=s.stroke,f=s.strokeDashoffset,d=s.animationName,c=s.animationDuration,h=s.animationIterationCount,p=s.animationTimingFunction,v=s.animationDirection;return k(Yv,sn({points:n},a,i,o?{strokeDasharray:l,stroke:u,style:{strokeDashoffset:f,animationName:d,animationDuration:c,animationIterationCount:h,animationTimingFunction:p,animationDirection:v}}:{}))},t.prototype.getArrowInfo=function(){var e=this.props.model,n=e.points,o=e.isSelected,i=this.state.hover,a=vn(n),s=a[0],l=a[0];return a.length>=2&&(s=a[a.length-2],l=a[a.length-1]),{start:s,end:l,hover:i,isSelected:o}},t.prototype.getLastTwoPoints=function(){var e=this.props.model,n=e.points,o=vn(n),i=o[0],a=o[0];return o.length>=2&&(i=o[o.length-2],a=o[o.length-1]),[i,a]},t.prototype.getAppendAttributes=function(e){var n=e.start,o=e.end,i;if(n.x===o.x&&n.y===o.y)i="";else{var a={start:n,end:o,offset:10,verticalLength:5},s=zo(sn(sn({},a),{type:"start"})),l=zo(sn(sn({},a),{type:"end"}));i="M".concat(s.leftX," ").concat(s.leftY,`
      L`).concat(s.rightX," ").concat(s.rightY,`
      L`).concat(l.rightX," ").concat(l.rightY,`
      L`).concat(l.leftX," ").concat(l.leftY," z")}return{d:i,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}},t.prototype.getAppendShape=function(e){var n=this.getAppendAttributes(e),o=n.d,i=n.strokeWidth,a=n.fill,s=n.strokeDasharray,l=n.stroke;return k($o,{d:o,fill:a,strokeWidth:i,stroke:l,strokeDasharray:s})},t.prototype.getAppendWidth=function(){for(var e=this,n=this.props,o=n.model,i=n.graphModel,a=o.pointsList,s=o.draggable,l=[],u=a.length,f=function(h){var p="lf-polyline-append",v={start:{x:a[h].x,y:a[h].y},end:{x:a[h+1].x,y:a[h+1].y},startIndex:h,endIndex:h+1,direction:tt.HORIZONTAL,draggable:!0},g=k("g",{className:p,children:d.getAppendShape(v)}),y=i.editConfigModel,w=y.adjustEdge,M=y.adjustEdgeMiddle;if(w&&s){var C=v.startIndex,P=v.endIndex,S=M&&(C===0||P===u-1);v.draggable=!S,v.start.x===v.end.x?(v.draggable&&(p+="-ew-resize"),v.direction=tt.VERTICAL):v.start.y===v.end.y&&(v.draggable&&(p+="-ns-resize"),v.direction=tt.HORIZONTAL),g=k("g",{className:d.isDragging?"lf-dragging":"lf-drag-able",onPointerDown:function(E){return e.beforeDragStart(E,v)},children:k("g",{className:p,children:d.getAppendShape(v)})})}l.push(g)},d=this,c=0;c<u-1;c++)f(c);return k("g",{children:l})},t})($a),Ln=function(){return Ln=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ln.apply(this,arguments)},nm=(function(){function r(t){var e=this;this.nodeConfig=null,this.fakeNode=null,this.stopDrag=function(){e.nodeConfig=null,e.docPointerMove&&window.document.removeEventListener("pointermove",e.docPointerMove),e.docPointerUp&&window.document.removeEventListener("pointerup",e.docPointerUp)},this.dragEnter=function(o){!e.nodeConfig||e.fakeNode||(e.fakeNode=e.lf.createFakeNode(Ln(Ln({},e.nodeConfig),e.clientToLocalPoint({x:o.clientX,y:o.clientY}))))},this.onDragOver=function(o){if(e.lf.graphModel.eventCenter.emit(ne.BLANK_CANVAS_MOUSEMOVE,{e:o}),o.preventDefault(),e.fakeNode){var i=e.clientToLocalPoint({x:o.clientX,y:o.clientY}),a=i.x,s=i.y;e.fakeNode.moveTo(a,s);var l=e.fakeNode.getData();e.lf.setNodeSnapLine(l),e.lf.graphModel.eventCenter.emit(ne.NODE_DND_DRAG,{data:l,e:o})}return!1},this.onDragLeave=function(){e.fakeNode&&(e.lf.removeNodeSnapLine(),e.lf.graphModel.removeFakeNode(),e.fakeNode=null)},this.onDrop=function(o){!e.lf.graphModel||!o||!e.nodeConfig||(e.lf.addNode(Ln(Ln({},e.nodeConfig),e.clientToLocalPoint({x:o.clientX,y:o.clientY})),ne.NODE_DND_ADD,o),o.preventDefault(),o.stopPropagation(),e.nodeConfig=null,e.lf.removeNodeSnapLine(),e.lf.graphModel.removeFakeNode(),e.fakeNode=null)};var n=t.lf;this.lf=n}return r.prototype.clientToLocalPoint=function(t){var e=t.x,n=t.y,o=ei(this.lf.options,["grid","size"]),i=this.lf.graphModel.getPointByClient({x:e,y:n}),a=i.canvasOverlayPosition,s=a.x,l=a.y,u=this.lf.graphModel.editConfigModel.snapGrid;return{x:Un(s,o,u),y:Un(l,o,u)}},r.prototype.isInsideCanvas=function(t){var e=this.lf.graphModel.rootEl.querySelector('[name="canvas-overlay"]'),n=window.document.elementFromPoint(t.clientX,t.clientY);return n===e||n!==null&&!!e&&e.contains(n)},r.prototype.startDrag=function(t){var e=this,n=this.lf.graphModel.editConfigModel;n!=null&&n.isSilentMode||(this.nodeConfig=t,this.docPointerMove=function(o){if(e.nodeConfig){if(!e.isInsideCanvas(o)){e.onDragLeave();return}if(!e.fakeNode){e.dragEnter(o);return}e.onDragOver(o)}},this.docPointerUp=function(o){e.nodeConfig&&(e.isInsideCanvas(o)?e.onDrop(o):e.onDragLeave(),o.preventDefault(),o.stopPropagation(),e.stopDrag())},window.document.addEventListener("pointermove",this.docPointerMove),window.document.addEventListener("pointerup",this.docPointerUp))},r})();function om(r,t){r.on("node:mousemove",function(e){var n=e.data;t.setNodeSnapLine(n)}),r.on("node:mouseup",function(){t.clearSnapline()})}var im=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Pr=function(){return Pr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Pr.apply(this,arguments)},am=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},sm=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},lm=(function(r){im(t,r);function t(e){var n=r.call(this,e)||this;return n.ref=ka(),n.__prevText={type:"",text:"",id:""},n.keyupHandler=function(o){var i=n.props.graphModel.textEditElement;o.key==="Enter"&&o.altKey&&(i==null||i.setElementState(Xe.DEFAULT))},n.inputHandler=function(o){var i=o.target.innerText,a=n.props.graphModel.textEditElement;a&&(n.__prevText={type:a.type,text:i.replace(/(\r\n)+$|(\n)+$/,""),id:a.id})},n.keydownHandler=function(o){o.stopPropagation()},n.state={style:{left:0,top:0}},n}return t.getDerivedStateFromProps=function(e){var n,o=e.textEditElement,i=e.graphModel,a=i.transformModel,s=i.theme,l=s.inputText,u;if(o){if(!(!((n=o.text)===null||n===void 0)&&n.value)&&o.BaseType===at.EDGE){var f=o.text,d=o.textPosition,c=d.x,h=d.y;f.x=c,f.y=h,o.setText(f)}var p={resize:"auto",whiteSpace:"normal",wordBreak:"break-all"};if(o.BaseType===at.EDGE){var v=s.edgeText,g=v.overflowMode,y=v.lineHeight,w=v.wrapPadding,M=v.textWidth;M&&g==="autoWrap"&&(u=Pr(Pr({},p),{width:M,minWidth:M,lineHeight:y,padding:w}))}else if(o.BaseType===at.NODE){var C=s.nodeText,g=C.overflowMode,y=C.lineHeight,w=C.wrapPadding,M=C.textWidth,P=o.width,S=o.modelType,E=o.textWidth,T=E||M||P;(S!==Ae.TEXT_NODE&&g==="autoWrap"||S===Ae.TEXT_NODE&&M)&&(u=Pr(Pr({},p),{width:T,minWidth:T,lineHeight:y,padding:w}))}var j=o.text,q=j.x,ee=j.y,he=sm(a.CanvasPointToHtmlPoint([q,ee]),2),ke=he[0],be=he[1];return{style:Pr(Pr({left:ke,top:be},u),l)}}return null},t.prototype.componentDidUpdate=function(){var e=this.props.graphModel;if(this.ref.current&&(this.ref.current.focus(),this.placeCaretAtEnd(this.ref.current)),this.__prevText.id!==""){var n=this.__prevText,o=n.text,i=n.id;e.updateText(i,o),e.eventCenter.emit(ne.TEXT_UPDATE,{data:Pr({},this.__prevText)}),this.__prevText.id="",this.__prevText.text="",this.__prevText.type=""}},t.prototype.placeCaretAtEnd=function(e){if(window.getSelection!==void 0&&document.createRange!==void 0){var n=document.createRange();n.selectNodeContents(e),n.collapse(!1);var o=window.getSelection();o==null||o.removeAllRanges(),o==null||o.addRange(n)}},t.prototype.render=function(){var e,n=this.props.graphModel.textEditElement,o=this.state.style;return n?k("div",{contentEditable:!0,className:"lf-text-input",style:o,ref:this.ref,onKeyUp:this.keyupHandler,onKeyDown:this.keydownHandler,onKeyPress:this.keydownHandler,onInput:this.inputHandler,children:(e=n.text)===null||e===void 0?void 0:e.value},n.id):null},t.toolName="text-edit-tool",t=am([Lt],t),t})(De),um=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),dm=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},ls=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},fm=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},cm=(function(r){um(t,r);function t(e){var n=r.call(this,e)||this;n.handleMouseDown=function(s){n.stepDrag.handleMouseDown(s)},n.handleWheelEvent=function(s){var l,u;s.preventDefault();var f=s.deltaX,d=s.deltaY,c=s.clientX,h=s.clientY,p=s.ctrlKey,v=new WheelEvent("wheel",{deltaX:f,deltaY:d,clientX:c,clientY:h,ctrlKey:p});(u=(l=n.props.lf.container)===null||l===void 0?void 0:l.querySelector('.lf-canvas-overlay[name="canvas-overlay"]'))===null||u===void 0||u.dispatchEvent(v)},n.onDragging=function(s){var l=s.deltaX,u=s.deltaY,f=n.props,d=f.graphModel,c=f.lf,h=c.getTransform(),p=h.SCALE_X,v=h.SCALE_Y,g=d.getSelectElements(!0);d.moveNodes(g.nodes.map(function(y){return y.id}),l/p,u/v)},n.handleContextMenu=function(s){s.preventDefault();var l=n.props,u=l.graphModel,f=l.graphModel,d=f.eventCenter,c=f.selectElements,h=u.getPointByClient({x:s.clientX,y:s.clientY}),p={nodes:[],edges:[]},v=fm([],ls(c.values()),!1);v.forEach(function(g){g.BaseType===at.NODE&&p.nodes.push(g.getData()),g.BaseType===at.EDGE&&p.edges.push(g.getData())}),d.emit(ne.SELECTION_CONTEXTMENU,{data:p,e:s,position:h})};var o=e.graphModel,i=o.gridSize,a=o.eventCenter;return n.stepDrag=new rr({onDragging:n.onDragging,step:i,eventType:"SELECTION",eventCenter:a}),n}return t.prototype.render=function(){var e,n,o=this.props.graphModel,i=o.selectElements,a=o.transformModel,s=this.props.lf.getTransform(),l=s.SCALE_X,u=s.SCALE_Y;if(!(i.size<=1)){var f=Number.MAX_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER;i.forEach(function(v){var g;v.BaseType===at.NODE&&(g=qp(v)),v.BaseType===at.EDGE&&(g=tv(v)),g!==void 0&&(f=Math.min(f,g.x),d=Math.min(d,g.y),c=Math.max(c,g.x1),h=Math.max(h,g.y1))}),e=ls(a.CanvasPointToHtmlPoint([f,d]),2),f=e[0],d=e[1],n=ls(a.CanvasPointToHtmlPoint([c,h]),2),c=n[0],h=n[1];var p={left:"".concat(f-20*l/2,"px"),top:"".concat(d-20*u/2,"px"),width:"".concat(c-f+20*l,"px"),height:"".concat(h-d+20*u,"px"),"border-width":"".concat(2*l,"px")};return k("div",{className:"lf-multiple-select",style:p,onPointerDown:this.handleMouseDown,onContextMenu:this.handleContextMenu,onWheel:this.handleWheelEvent})}},t.toolName="multiple-select-tool",t=dm([Lt],t),t})(De),us=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},hm=[lm,cm],pm=(function(){function r(t){var e=this;this.toolMap=new Map,this.disabledToolMap=new Map,this.instance=t,Oe(hm,function(i){e.isDisabled(i.toolName)||e.registerTool(i.toolName,i)});var n=t.graphModel,o=n.eventCenter;o.on("".concat(ne.GRAPH_TRANSFORM,",").concat(ne.NODE_CLICK,",").concat(ne.BLANK_CLICK," "),function(){var i,a=n.textEditElement,s=n.editConfigModel,l=s.edgeTextEdit,u=s.nodeTextEdit;(l||u)&&a&&((i=n.textEditElement)===null||i===void 0||i.setElementState(Xe.DEFAULT))})}return r.prototype.isDisabled=function(t){var e;return((e=this.instance.options.disabledTools)===null||e===void 0?void 0:e.indexOf(t))!==-1},r.prototype.registerTool=function(t,e){this.toolMap.set(t,e)},r.prototype.disableTool=function(t){var e=this.toolMap.get(t);if(e)return this.disabledToolMap.set(t,e),this.toolMap.delete(t),!0;throw new Error(" ".concat(e," "))},r.prototype.enableTool=function(t){var e=this.disabledToolMap.get(t);if(e)return this.toolMap.set(t,e),this.disabledToolMap.delete(t),!0;throw new Error(" ".concat(e," "))},r.prototype.getTools=function(){return Array.from(this.toolMap.values())},r.prototype.getInstance=function(){return this.instance},r.prototype.destroy=function(){this.toolMap.clear(),this.disabledToolMap.clear()},us([I],r.prototype,"toolMap",void 0),us([L],r.prototype,"disableTool",null),us([L],r.prototype,"enableTool",null),r})();function vm(r){throw new Error("[mobx-utils] "+r)}function ga(r,t){t===void 0&&(t="Illegal state"),r||vm(t)}var _c=function(r){return r&&r!==Object.prototype&&Object.getOwnPropertyNames(r).concat(_c(Object.getPrototypeOf(r))||[])},gm=function(r){var t=_c(r),e=t.filter(function(n,o){return t.indexOf(n)===o});return e},ym=function(r){return gm(r).filter(function(t){return t!=="constructor"&&!~t.indexOf("__")})},xc="pending",ya="fulfilled",Il="rejected";function mm(r){switch(this.state){case xc:return r.pending&&r.pending(this.value);case Il:return r.rejected&&r.rejected(this.value);case ya:return r.fulfilled?r.fulfilled(this.value):this.value}}function dd(r,t){if(ga(arguments.length<=2,"fromPromise expects up to two arguments"),ga(typeof r=="function"||typeof r=="object"&&r&&typeof r.then=="function","Please pass a promise or function to fromPromise"),r.isPromiseBasedObservable===!0)return r;typeof r=="function"&&(r=new Promise(r));var e=r;r.then(L("observableFromPromise-resolve",function(o){e.value=o,e.state=ya}),L("observableFromPromise-reject",function(o){e.value=o,e.state=Il})),e.isPromiseBasedObservable=!0,e.case=mm;var n=t&&t.state===ya?t.value:void 0;return Rs(e,{value:n,state:xc},{},{deep:!1}),e}(function(r){r.reject=L("fromPromise.reject",function(e){var n=r(Promise.reject(e));return n.state=Il,n.value=e,n});function t(e){e===void 0&&(e=void 0);var n=r(Promise.resolve(e));return n.state=ya,n.value=e,n}r.resolve=L("fromPromise.resolve",t)})(dd||(dd={}));var Ni=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i};(function(){function r(t,e){var n=this;Wh(function(){n.current=e,n.subscription=t.subscribe(n)})}return r.prototype.dispose=function(){this.subscription&&this.subscription.unsubscribe()},r.prototype.next=function(t){this.current=t},r.prototype.complete=function(){this.dispose()},r.prototype.error=function(t){this.current=t,this.dispose()},Ni([I.ref],r.prototype,"current",void 0),Ni([L.bound],r.prototype,"next",null),Ni([L.bound],r.prototype,"complete",null),Ni([L.bound],r.prototype,"error",null),r})();var ma=function(){return ma=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ma.apply(this,arguments)},po=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},_m=["model","reset","submit","isDirty","isPropertyDirty","resetProperty"];(function(){function r(t){var e=this;this.model=t,this.localValues=I.map({}),this.localComputedValues=I.map({}),this.isPropertyDirty=function(n){return e.localValues.has(n)},ga(yr(t),"createViewModel expects an observable object"),ym(t).forEach(function(n){if(!(n===we||n==="__mobxDidRunLazyInitializers")){if(ga(_m.indexOf(n)===-1,"The propertyname "+n+" is reserved and cannot be used with viewModels"),ql(t,n)){var o=za(t,n).derivation;e.localComputedValues.set(n,et(o.bind(e)))}var i=Object.getOwnPropertyDescriptor(t,n),a=i?{enumerable:i.enumerable}:{};Object.defineProperty(e,n,ma(ma({},a),{configurable:!0,get:function(){return ql(t,n)?e.localComputedValues.get(n).get():e.isPropertyDirty(n)?e.localValues.get(n):e.model[n]},set:L(function(s){s!==e.model[n]?e.localValues.set(n,s):e.localValues.delete(n)})}))}})}return Object.defineProperty(r.prototype,"isDirty",{get:function(){return this.localValues.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"changedValues",{get:function(){return this.localValues.toJS()},enumerable:!1,configurable:!0}),r.prototype.submit=function(){var t=this;Wn(this.localValues).forEach(function(e){var n=t.localValues.get(e),o=t.model[e];Cr(o)?o.replace(n):Gt(o)?(o.clear(),o.merge(n)):Qh(n)||(t.model[e]=n)}),this.localValues.clear()},r.prototype.reset=function(){this.localValues.clear()},r.prototype.resetProperty=function(t){this.localValues.delete(t)},po([et],r.prototype,"isDirty",null),po([et],r.prototype,"changedValues",null),po([L.bound],r.prototype,"submit",null),po([L.bound],r.prototype,"reset",null),po([L.bound],r.prototype,"resetProperty",null),r})();function ds(r){if(!r)return"ROOT";for(var t=[];r.parent;)t.push(r.path),r=r.parent;return t.reverse().join("/")}function fs(r){return yr(r)||Cr(r)||Gt(r)}function xm(r,t){var e=new WeakMap;function n(s){var l=e.get(s.object);o(s,l),t(s,ds(l),r)}function o(s,l){switch(s.type){case"add":i(s.newValue,l,s.name);break;case"update":a(s.oldValue),i(s.newValue,l,s.name||""+s.index);break;case"remove":case"delete":a(s.oldValue);break;case"splice":s.removed.map(a),s.added.forEach(function(d,c){return i(d,l,""+(s.index+c))});for(var u=s.index+s.addedCount;u<s.object.length;u++)if(fs(s.object[u])){var f=e.get(s.object[u]);f&&(f.path=""+u)}break}}function i(s,l,u){if(fs(s)){var f=e.get(s);if(f){if(f.parent!==l||f.path!==u)throw new Error("The same observable object cannot appear twice in the same tree,"+(" trying to assign it to '"+ds(l)+"/"+u+"',")+(" but it already exists at '"+ds(f.parent)+"/"+f.path+"'"))}else{var d={parent:l,path:u,dispose:Yf(s,n)};e.set(s,d),rp(s).forEach(function(c){var h=c[0],p=c[1];return i(p,d,h)})}}}function a(s){if(fs(s)){var l=e.get(s);if(!l)return;e.delete(s),l.dispose(),tp(s).forEach(a)}}return i(r,void 0,""),function(){a(r)}}var wm=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})();(function(r){wm(t,r);function t(e,n,o){var i=o===void 0?{}:o,a=i.name,s=a===void 0?"ogm"+(Math.random()*1e3|0):a,l=i.keyToName,u=l===void 0?function(c){return""+c}:l,f=r.call(this)||this;f._keyToName=u,f._groupBy=n,f._ogmInfoKey=Symbol("ogmInfo"+s),f._base=e;for(var d=0;d<e.length;d++)f._addItem(e[d]);return f._disposeBaseObserver=Yf(f._base,function(c){if(c.type==="splice")dr(function(){for(var h=0,p=c.removed;h<p.length;h++){var v=p[h];f._removeItem(v)}for(var g=0,y=c.added;g<y.length;g++){var w=y[g];f._addItem(w)}});else if(c.type==="update")dr(function(){f._removeItem(c.oldValue),f._addItem(c.newValue)});else throw new Error("illegal state")}),f}return t.prototype.clear=function(){throw new Error("not supported")},t.prototype.delete=function(e){throw new Error("not supported")},t.prototype.set=function(e,n){throw new Error("not supported")},t.prototype.dispose=function(){this._disposeBaseObserver();for(var e=0;e<this._base.length;e++){var n=this._base[e],o=n[this._ogmInfoKey];o.reaction(),delete n[this._ogmInfoKey]}},t.prototype._getGroupArr=function(e){var n=r.prototype.get.call(this,e);return n===void 0&&(n=I([],{name:"GroupArray["+this._keyToName(e)+"]",deep:!1}),r.prototype.set.call(this,e,n)),n},t.prototype._removeFromGroupArr=function(e,n){var o=r.prototype.get.call(this,e);o.length===1?r.prototype.delete.call(this,e):(n===o.length-1||(o[n]=o[o.length-1],o[n][this._ogmInfoKey].groupArrIndex=n),o.length--)},t.prototype._addItem=function(e){var n=this,o=this._groupBy(e),i=this._getGroupArr(o),a={groupByValue:o,groupArrIndex:i.length,reaction:If(function(){return n._groupBy(e)},function(s,l){var u=e[n._ogmInfoKey];n._removeFromGroupArr(u.groupByValue,u.groupArrIndex);var f=n._getGroupArr(s),d=f.length;f.push(e),u.groupByValue=s,u.groupArrIndex=d})};Object.defineProperty(e,this._ogmInfoKey,{configurable:!0,enumerable:!1,value:a}),i.push(e)},t.prototype._removeItem=function(e){var n=e[this._ogmInfoKey];this._removeFromGroupArr(n.groupByValue,n.groupArrIndex),n.reaction(),delete e[this._ogmInfoKey]},t})(Tl);Promise.resolve(),typeof queueMicrotask<"u"||typeof process<"u"&&process.nextTick;var dl=function(){return dl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},dl.apply(this,arguments)},Em=(function(){function r(t){this.undos=[],this.redos=[],this.callbacks=[],this.stopWatch=null,this.curData=null,this.maxSize=50,this.waitTime=100,this.eventCenter=t}return r.prototype.add=function(t){zl(Zc(this.undos),t)||(this.undos.push(t),zl(this.curData,t)||(this.redos=[]),this.eventCenter.emit(ne.HISTORY_CHANGE,{data:{undos:this.undos,redos:this.redos,undoAble:this.undoAble(),redoAble:this.redoAble()}}),this.undos.length>this.maxSize&&this.undos.shift())},r.prototype.undoAble=function(){return this.undos.length>1},r.prototype.undo=function(){if(this.undoAble()){var t=this.undos.pop();this.redos.push(t);var e=this.undos.pop();return this.curData=xe(e),e}},r.prototype.redoAble=function(){return this.redos.length>0},r.prototype.redo=function(){if(this.redoAble()){var t=this.redos.pop();return this.curData=xe(t),t}},r.prototype.watch=function(t){var e=this;this.stopWatch&&this.stopWatch(),this.undos.push(t.modelToGraphData()),this.stopWatch=xm(t,tf(function(){var n=t.modelToHistoryData();n&&e.add(dl({},n))},this.waitTime))},r.prototype.destroy=function(){this.undos=[],this.redos=[],this.curData=null,this.stopWatch&&this.stopWatch()},r})(),cs={exports:{}},fd;function bm(){return fd||(fd=1,(function(r){(function(t,e,n){if(!t)return;for(var o={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},a={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l,u=1;u<20;++u)o[111+u]="f"+u;for(u=0;u<=9;++u)o[u+96]=u.toString();function f(E,T,j){if(E.addEventListener){E.addEventListener(T,j,!1);return}E.attachEvent("on"+T,j)}function d(E){if(E.type=="keypress"){var T=String.fromCharCode(E.which);return E.shiftKey||(T=T.toLowerCase()),T}return o[E.which]?o[E.which]:i[E.which]?i[E.which]:String.fromCharCode(E.which).toLowerCase()}function c(E,T){return E.sort().join(",")===T.sort().join(",")}function h(E){var T=[];return E.shiftKey&&T.push("shift"),E.altKey&&T.push("alt"),E.ctrlKey&&T.push("ctrl"),E.metaKey&&T.push("meta"),T}function p(E){if(E.preventDefault){E.preventDefault();return}E.returnValue=!1}function v(E){if(E.stopPropagation){E.stopPropagation();return}E.cancelBubble=!0}function g(E){return E=="shift"||E=="ctrl"||E=="alt"||E=="meta"}function y(){if(!l){l={};for(var E in o)E>95&&E<112||o.hasOwnProperty(E)&&(l[o[E]]=E)}return l}function w(E,T,j){return j||(j=y()[E]?"keydown":"keypress"),j=="keypress"&&T.length&&(j="keydown"),j}function M(E){return E==="+"?["+"]:(E=E.replace(/\+{2}/g,"+plus"),E.split("+"))}function C(E,T){var j,q,ee,he=[];for(j=M(E),ee=0;ee<j.length;++ee)q=j[ee],s[q]&&(q=s[q]),T&&T!="keypress"&&a[q]&&(q=a[q],he.push("shift")),g(q)&&he.push(q);return T=w(q,he,T),{key:q,modifiers:he,action:T}}function P(E,T){return E===null||E===e?!1:E===T?!0:P(E.parentNode,T)}function S(E){var T=this;if(E=E||e,!(T instanceof S))return new S(E);T.target=E,T._callbacks={},T._directMap={};var j={},q,ee=!1,he=!1,ke=!1;function be(ge){ge=ge||{};var Re=!1,Be;for(Be in j){if(ge[Be]){Re=!0;continue}j[Be]=0}Re||(ke=!1)}function $e(ge,Re,Be,Ce,Ke,N){var X,G,V=[],J=Be.type;if(!T._callbacks[ge])return[];for(J=="keyup"&&g(ge)&&(Re=[ge]),X=0;X<T._callbacks[ge].length;++X)if(G=T._callbacks[ge][X],!(!Ce&&G.seq&&j[G.seq]!=G.level)&&J==G.action&&(J=="keypress"&&!Be.metaKey&&!Be.ctrlKey||c(Re,G.modifiers))){var le=!Ce&&G.combo==Ke,ve=Ce&&G.seq==Ce&&G.level==N;(le||ve)&&T._callbacks[ge].splice(X,1),V.push(G)}return V}function rt(ge,Re,Be,Ce){T.stopCallback(Re,Re.target||Re.srcElement,Be,Ce)||ge(Re,Be)===!1&&(p(Re),v(Re))}T._handleKey=function(ge,Re,Be){var Ce=$e(ge,Re,Be),Ke,N={},X=0,G=!1;for(Ke=0;Ke<Ce.length;++Ke)Ce[Ke].seq&&(X=Math.max(X,Ce[Ke].level));for(Ke=0;Ke<Ce.length;++Ke){if(Ce[Ke].seq){if(Ce[Ke].level!=X)continue;G=!0,N[Ce[Ke].seq]=1,rt(Ce[Ke].callback,Be,Ce[Ke].combo,Ce[Ke].seq);continue}G||rt(Ce[Ke].callback,Be,Ce[Ke].combo)}var V=Be.type=="keypress"&&he;Be.type==ke&&!g(ge)&&!V&&be(N),he=G&&Be.type=="keydown"};function yt(ge){typeof ge.which!="number"&&(ge.which=ge.keyCode);var Re=d(ge);if(Re){if(ge.type=="keyup"&&ee===Re){ee=!1;return}T.handleKey(Re,h(ge),ge)}}function pt(){clearTimeout(q),q=setTimeout(be,1e3)}function ot(ge,Re,Be,Ce){j[ge]=0;function Ke(J){return function(){ke=J,++j[ge],pt()}}function N(J){rt(Be,J,ge),Ce!=="keyup"&&(ee=d(J)),setTimeout(be,10)}for(var X=0;X<Re.length;++X){var G=X+1===Re.length,V=G?N:Ke(Ce||C(Re[X+1]).action);st(Re[X],V,Ce,ge,X)}}function st(ge,Re,Be,Ce,Ke){T._directMap[ge+":"+Be]=Re,ge=ge.replace(/\s+/g," ");var N=ge.split(" "),X;if(N.length>1){ot(ge,N,Re,Be);return}X=C(ge,Be),T._callbacks[X.key]=T._callbacks[X.key]||[],$e(X.key,X.modifiers,{type:X.action},Ce,ge,Ke),T._callbacks[X.key][Ce?"unshift":"push"]({callback:Re,modifiers:X.modifiers,action:X.action,seq:Ce,level:Ke,combo:ge})}T._bindMultiple=function(ge,Re,Be){for(var Ce=0;Ce<ge.length;++Ce)st(ge[Ce],Re,Be)},f(E,"keypress",yt),f(E,"keydown",yt),f(E,"keyup",yt)}S.prototype.bind=function(E,T,j){var q=this;return E=E instanceof Array?E:[E],q._bindMultiple.call(q,E,T,j),q},S.prototype.unbind=function(E,T){var j=this;return j.bind.call(j,E,function(){},T)},S.prototype.trigger=function(E,T){var j=this;return j._directMap[E+":"+T]&&j._directMap[E+":"+T]({},E),j},S.prototype.reset=function(){var E=this;return E._callbacks={},E._directMap={},E},S.prototype.stopCallback=function(E,T){var j=this;if((" "+T.className+" ").indexOf(" mousetrap ")>-1||P(T,j.target))return!1;if("composedPath"in E&&typeof E.composedPath=="function"){var q=E.composedPath()[0];q!==E.target&&(T=q)}return T.tagName=="INPUT"||T.tagName=="SELECT"||T.tagName=="TEXTAREA"||T.isContentEditable},S.prototype.handleKey=function(){var E=this;return E._handleKey.apply(E,arguments)},S.addKeycodes=function(E){for(var T in E)E.hasOwnProperty(T)&&(o[T]=E[T]);l=null},S.init=function(){var E=S(e);for(var T in E)T.charAt(0)!=="_"&&(S[T]=(function(j){return function(){return E[j].apply(E,arguments)}})(T))},S.init(),t.Mousetrap=S,r.exports&&(r.exports=S)})(typeof window<"u"?window:null,typeof window<"u"?document:null)})(cs)),cs.exports}var Sm=bm();const Om=yl(Sm);var zr=function(){return zr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},zr.apply(this,arguments)},Mm=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},_r=null;function cd(r,t){var e,n;return r.x+=t,r.y+=t,bs(r.text)||(r.text.x+=t,r.text.y+=t),bs((e=r.properties)===null||e===void 0?void 0:e._label)||(n=r.properties)===null||n===void 0||n._label.forEach(function(o){o.x+=t,o.y+=t}),r}function hd(r,t){return r.startPoint&&(r.startPoint.x+=t,r.startPoint.y+=t),r.endPoint&&(r.endPoint.x+=t,r.endPoint.y+=t),r.pointsList&&r.pointsList.length>0&&r.pointsList.forEach(function(e){e.x+=t,e.y+=t}),bs(r.text)||(r.text.x+=t,r.text.y+=t),r}function Am(r,t){var e=r.x,n=r.y,o=r.text,i=o?{x:o.x+t,y:o.y+t,value:o.value}:void 0;return zr(zr({},r),{id:"",x:e+t,y:n+t,text:i})}function Nm(r,t){var e=r.startPoint,n=r.endPoint,o=r.pointsList,i=r.text,a=Mm(r,["startPoint","endPoint","pointsList","text"]);a.id="";var s={x:e.x+t,y:e.y+t},l={x:n.x+t,y:n.y+t},u=gr(o,function(d){return{x:d.x+t,y:d.y+t}}),f=i?zr(zr({},i),{x:i.x+t,y:i.y+t}):void 0;return zr(zr({},a),{startPoint:s,endPoint:l,pointsList:u,text:f})}var Mn=40,Ci=40;function Cm(r,t){var e=r.keyboard,n=e.options.keyboard;e.on(["cmd + c","ctrl + c"],function(){if(Ci=Mn,!(n!=null&&n.enabled)||t.textEditElement)return!0;var o=r.options.guards,i=t.getSelectElements(!1),a=o&&o.beforeClone?o.beforeClone(i):!0;return!a||i.nodes.length===0&&i.edges.length===0?(_r=null,!0):(_r=i,_r.nodes.forEach(function(s){return cd(s,Mn)}),_r.edges.forEach(function(s){return hd(s,Mn)}),!1)}),e.on(["cmd + v","ctrl + v"],function(){if(!(n!=null&&n.enabled)||t.textEditElement)return!0;if(_r&&(_r.nodes||_r.edges)){r.clearSelectElements();var o=r.addElements(_r,Ci);if(!o)return!0;o.nodes.forEach(function(i){return r.selectElementById(i.id,!0)}),o.edges.forEach(function(i){return r.selectElementById(i.id,!0)}),_r.nodes.forEach(function(i){return cd(i,Mn)}),_r.edges.forEach(function(i){return hd(i,Mn)}),Ci=Ci+Mn}return!1}),e.on(["cmd + z","ctrl + z"],function(){return!(n!=null&&n.enabled)||t.textEditElement?!0:(r.undo(),!1)}),e.on(["cmd + y","ctrl + y"],function(){return!(n!=null&&n.enabled)||t.textEditElement?!0:(r.redo(),!1)}),e.on(["backspace"],function(){if(!(n!=null&&n.enabled)||t.textEditElement)return!0;var o=t.getSelectElements(!0);return r.clearSelectElements(),o.edges.forEach(function(i){return i.id&&r.deleteEdge(i.id)}),o.nodes.forEach(function(i){return i.id&&r.deleteNode(i.id)}),!1})}var Tm=(function(){function r(t){t.keyboard||(t.keyboard={enabled:!1}),this.options=t;var e=t.lf;this.target=e.container,this.mousetrap=new Om(this.target),t.keyboard.enabled&&!e.options.isSilentMode&&this.enable(!0)}return r.prototype.initShortcuts=function(){var t=this,e,n=((e=this.options.keyboard)!==null&&e!==void 0?e:{}).shortcuts;if(n)if(rf(n))n.forEach(function(s){var l=s.keys,u=s.callback,f=s.action;return t.on(l,u,f)});else{var o=n.keys,i=n.callback,a=n.action;this.on(o,i,a)}},r.prototype.on=function(t,e,n){this.mousetrap.bind(this.getKeys(t),e,n)},Object.defineProperty(r.prototype,"disabled",{get:function(){var t,e;return((e=(t=this.options)===null||t===void 0?void 0:t.keyboard)===null||e===void 0?void 0:e.enabled)!==!0},enumerable:!1,configurable:!0}),r.prototype.off=function(t,e){this.mousetrap.unbind(this.getKeys(t),e)},r.prototype.enable=function(t){(this.disabled||t)&&(this.options.keyboard&&(this.options.keyboard.enabled=!0),this.target instanceof HTMLElement&&(this.target.setAttribute("tabindex","-1"),this.target.style.outline="none"))},r.prototype.disable=function(){this.disabled||(this.options.keyboard&&(this.options.keyboard.enabled=!1),this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))},r.prototype.destroy=function(){this.mousetrap.reset()},r.prototype.getKeys=function(t){var e=this;return(Array.isArray(t)?t:[t]).map(function(n){return e.formatKey(n)})},r.prototype.formatKey=function(t){return t.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command")},r})(),Xr=function(){return Xr=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Xr.apply(this,arguments)},Ti=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},hs=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},ps=Symbol("plugin registered by Logicflow.use"),fl=(function(){function r(t){var e=this,n;this.viewMap=new Map,this.components=[],this.extension={},this.setView=function(u,f){return e.viewMap.set(u,f)},this.getView=function(u){return e.viewMap.get(u)};var o=Ho.get(t),i=o.container,a=o.width,s=o.height;this.options=o,this.container=this.initContainer(i,a,s),this.graphModel=new yy(Xr(Xr({},o),{container:this.container})),this.plugins=(n=o.plugins)!==null&&n!==void 0?n:[];var l=this.graphModel.eventCenter;this.tool=new pm(this),this.dnd=new nm({lf:this}),this.history=new Em(l),this.keyboard=new Tm({lf:this,keyboard:o.keyboard}),o.snapline!==!1&&(this.snaplineModel=new my(this.graphModel,o.snaplineEpsilon),om(l,this.snaplineModel)),o.isSilentMode||(Cm(this,this.graphModel),this.keyboard.initShortcuts()),this.defaultRegister(),this.installPlugins(o.disabledPlugins)}return r.prototype.initContainer=function(t,e,n){var o=document.createElement("div");return o.style.position="relative",o.style.width=e?"".concat(e,"px"):"100%",o.style.height=n?"".concat(n,"px"):"100%",t.innerHTML="",t.appendChild(o),o},Object.defineProperty(r.prototype,Symbol.toStringTag,{get:function(){return r.toStringTag},enumerable:!1,configurable:!0}),r.prototype.register=function(t,e,n){if(n===void 0&&(n=!0),typeof t!="string"){this.registerElement(t);return}var o={BaseEdge:$a,BaseEdgeModel:Fa,BaseNode:Kr,BaseNodeModel:Vr,RectNode:gn,RectNodeModel:Zn,CircleNode:ca,CircleNodeModel:la,PolygonNode:pa,PolygonNodeModel:ua,TextNode:ad,TextNodeModel:nd,LineEdge:ud,LineEdgeModel:Qu,DiamondNode:nl,DiamondNodeModel:Ks,PolylineEdge:Qo,PolylineEdgeModel:qo,BezierEdge:ld,BezierEdgeModel:qu,EllipseNode:il,EllipseNodeModel:Zs,HtmlNode:va,HtmlNodeModel:da,h:ce,type:t};if(this.viewMap.forEach(function(u){var f=u.extendKey;f&&(o[f]=u)}),this.graphModel.modelMap.forEach(function(u){var f=u.extendKey;f&&(o[f]=u)}),e){var i=e(o),a=i.view,s=i.model,l=a;n&&!l.isObserved&&(l.isObserved=!0,l=Lt(l)),this.setView(t,l),this.graphModel.setModel(t,s)}},r.prototype.registerElement=function(t){var e=t.view;t.isObserverView!==!1&&!e.isObserved&&(e.isObserved=!0,e=Lt(e)),this.setView(t.type,e),this.graphModel.setModel(t.type,t.model)},r.prototype.batchRegister=function(t){var e=this;t===void 0&&(t=[]),Oe(t,function(n){e.registerElement(n)})},r.prototype.defaultRegister=function(){var t=[{type:"rect",view:gn,model:Zn},{type:"circle",view:ca,model:la},{type:"polygon",view:pa,model:ua},{type:"text",view:ad,model:nd},{type:"ellipse",view:il,model:Zs},{type:"diamond",view:nl,model:Ks},{type:"html",view:va,model:da},{type:"line",view:ud,model:Qu},{type:"polyline",view:Qo,model:qo},{type:"bezier",view:ld,model:qu}];this.batchRegister(t)},r.prototype.addNode=function(t,e,n){return e===void 0&&(e=ne.NODE_ADD),this.graphModel.addNode(t,e,n)},r.prototype.deleteNode=function(t){var e=this.graphModel.getNodeModelById(t);if(!e)return!1;var n=e.getData(),o=this.options.guards,i=o!=null&&o.beforeDelete?o.beforeDelete(n):!0;return i&&this.graphModel.deleteNode(t),i},r.prototype.cloneNode=function(t){var e=this.graphModel.getNodeModelById(t),n=e==null?void 0:e.getData();if(n){var o=this.options.guards,i=o!=null&&o.beforeClone?o.beforeClone(n):!0;if(i)return this.graphModel.cloneNode(t)}},r.prototype.changeNodeId=function(t,e){return this.graphModel.changeNodeId(t,e)},r.prototype.changeNodeType=function(t,e){this.graphModel.changeNodeType(t,e)},r.prototype.getNodeModelById=function(t){return this.graphModel.getNodeModelById(t)},r.prototype.getNodeDataById=function(t){var e=this.getNodeModelById(t);return e==null?void 0:e.getData()},r.prototype.getNodeIncomingEdge=function(t){return this.graphModel.getNodeIncomingEdge(t)},r.prototype.getNodeOutgoingEdge=function(t){return this.graphModel.getNodeOutgoingEdge(t)},r.prototype.getNodeIncomingNode=function(t){return this.graphModel.getNodeIncomingNode(t)},r.prototype.getNodeOutgoingNode=function(t){return this.graphModel.getNodeOutgoingNode(t)},r.prototype.createFakeNode=function(t){var e=this.graphModel.modelMap.get(t.type);if(!e)return console.warn("".concat(t.type,"")),null;var n=new e(Xr(Xr({},t),{virtual:!0}),this.graphModel);return this.graphModel.setFakeNode(n),n},r.prototype.removeFakeNode=function(){this.graphModel.removeFakeNode()},r.prototype.setNodeSnapLine=function(t){var e;(e=this.snaplineModel)===null||e===void 0||e.setNodeSnapLine(t)},r.prototype.removeNodeSnapLine=function(){var t;(t=this.snaplineModel)===null||t===void 0||t.clearSnapline()},r.prototype.setDefaultEdgeType=function(t){this.graphModel.setDefaultEdgeType(t)},r.prototype.addEdge=function(t){return this.graphModel.addEdge(t)},r.prototype.getEdgeDataById=function(t){var e=this.getEdgeModelById(t);return e==null?void 0:e.getData()},r.prototype.getEdgeModelById=function(t){return this.graphModel.getEdgeModelById(t)},r.prototype.getEdgeModels=function(t){var e=t.sourceNodeId,n=t.targetNodeId,o=[],i=this.graphModel.edges;return e&&n?Oe(i,function(a){a.sourceNodeId===e&&a.targetNodeId===n&&o.push(a)}):e?Oe(i,function(a){a.sourceNodeId===e&&o.push(a)}):n&&Oe(i,function(a){a.targetNodeId===n&&o.push(a)}),o},r.prototype.changeEdgeId=function(t,e){return this.graphModel.changeEdgeId(t,e)},r.prototype.changeEdgeType=function(t,e){this.graphModel.changeEdgeType(t,e)},r.prototype.deleteEdge=function(t){var e=this.graphModel.getEdgeModelById(t);if(!e)return!1;var n=e.getData(),o=this.options.guards,i=o!=null&&o.beforeDelete?o.beforeDelete(n):!0;return i&&this.graphModel.deleteEdgeById(t),i},r.prototype.deleteEdgeByNodeId=function(t){var e=t.sourceNodeId,n=t.targetNodeId;e&&n?this.graphModel.deleteEdgeBySourceAndTarget(e,n):e?this.graphModel.deleteEdgeBySource(e):n&&this.graphModel.deleteEdgeByTarget(n)},r.prototype.getNodeEdges=function(t){return this.graphModel.getNodeEdges(t)},r.prototype.addElements=function(t,e){var n=this,o=t.nodes,i=t.edges;e===void 0&&(e=40);var a={},s={nodes:[],edges:[]};return Oe(o,function(l){var u=l.id,f=n.addNode(l);u&&(a[u]=f.id),s.nodes.push(f)}),Oe(i,function(l){var u=l.sourceNodeId,f=l.targetNodeId;a[u]&&(u=a[u]),a[f]&&(f=a[f]);var d=n.graphModel.addEdge(Xr(Xr({},l),{sourceNodeId:u,targetNodeId:f}));s.edges.push(d)}),s},r.prototype.selectElementById=function(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),this.graphModel.selectElementById(t,e),!e&&n&&this.graphModel.toFront(t)},r.prototype.deselectElementById=function(t){this.graphModel.deselectElementById(t)},r.prototype.getSelectElements=function(t){return t===void 0&&(t=!0),this.graphModel.getSelectElements(t)},r.prototype.clearSelectElements=function(){this.graphModel.clearSelectElements()},r.prototype.getModelById=function(t){return this.graphModel.getElement(t)},r.prototype.getDataById=function(t){var e;return(e=this.graphModel.getElement(t))===null||e===void 0?void 0:e.getData()},r.prototype.deleteElement=function(t){var e,n,o,i=this.getModelById(t);if(!i)return!1;var a=(e={},e[at.NODE]=this.deleteNode,e[at.EDGE]=this.deleteEdge,e);return(o=(n=a[i.BaseType])===null||n===void 0?void 0:n.call(this,t))!==null&&o!==void 0?o:!1},r.prototype.setElementZIndex=function(t,e){return this.graphModel.setElementZIndex(t,e)},r.prototype.getAreaElement=function(t,e,n,o,i){return n===void 0&&(n=!0),o===void 0&&(o=!0),i===void 0&&(i=!1),this.graphModel.getAreaElement(t,e,n,o,i).map(function(a){return a.getData()})},r.prototype.setProperties=function(t,e){var n;(n=this.graphModel.getElement(t))===null||n===void 0||n.setProperties(Ct(e))},r.prototype.getProperties=function(t){var e;return(e=this.graphModel.getElement(t))===null||e===void 0?void 0:e.getProperties()},r.prototype.deleteProperty=function(t,e){var n;(n=this.graphModel.getElement(t))===null||n===void 0||n.deleteProperty(e)},r.prototype.updateAttributes=function(t,e){this.graphModel.updateAttributes(t,e)},r.prototype.editText=function(t){this.graphModel.editText(t)},r.prototype.updateText=function(t,e){this.graphModel.updateText(t,e)},r.prototype.updateEditConfig=function(t){var e=this.graphModel,n=e.editConfigModel,o=e.transformModel,i=n.snapGrid;if(n.updateEditConfig(t),(t==null?void 0:t.stopMoveGraph)!==void 0&&o.updateTranslateLimits(t.stopMoveGraph),t!=null&&t.isSilentMode?this.keyboard.disable():this.keyboard.enable(!0),!Rt(t==null?void 0:t.snapGrid)&&t.snapGrid!==i){var a=this.graphModel.grid.size,s=a===void 0?1:a;this.graphModel.updateGridSize(t.snapGrid?s:1)}this.emit(ne.EDIT_CONFIG_CHANGED,{data:n.getConfig()})},r.prototype.getEditConfig=function(){return this.graphModel.editConfigModel.getConfig()},r.prototype.setTheme=function(t,e){this.graphModel.setTheme(t,e)},r.prototype.getTheme=function(){return this.graphModel.getTheme()},r.prototype.focusByElement=function(t){var e=void 0,n=this.getNodeModelById(t);if(n){var o=n.getData(),i=o.x,a=o.y;e={x:i,y:a}}var s=this.getEdgeModelById(t);if(s){var l=s.textPosition,i=l.x,a=l.y;e={x:i,y:a}}e&&this.focusByCoordinate(e)},r.prototype.focusByCoordinate=function(t){var e=this.graphModel,n=e.transformModel,o=e.width,i=e.height,a=t.x,s=t.y;n.focusOn(a,s,o,i)},r.prototype.focusOn=function(t){if(typeof t=="string")this.focusByElement(t);else if("x"in t&&"y"in t)this.focusByCoordinate(t);else{var e=t.id,n=t.coordinate;e&&this.focusByElement(e),n&&this.focusByCoordinate(n)}},r.prototype.resize=function(t,e){this.graphModel.resize(t,e),this.options.width=this.graphModel.width,this.options.height=this.graphModel.height},r.prototype.toFront=function(t){this.graphModel.toFront(t)},r.prototype.getPointByClient=function(t,e){if(typeof t=="object")return this.graphModel.getPointByClient(t);if(typeof e=="number")return this.graphModel.getPointByClient({x:t,y:e})},r.prototype.getGraphData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.getGraphRawData();return this.adapterOut?this.adapterOut.apply(this,hs([n],Ti(t),!1)):n},r.prototype.getGraphRawData=function(){return this.graphModel.modelToGraphData()},r.prototype.clearData=function(){this.graphModel.clearData(),this.render({})},r.prototype.setOverlapMode=function(t){this.graphModel.setOverlapMode(t)},r.prototype.renderRawData=function(t){this.graphModel.graphDataToModel(Ct(t)),this.options.history!==!1&&this.history.watch(this.graphModel),Su(k(by,{getView:this.getView,tool:this.tool,options:this.options,dnd:this.dnd,snaplineModel:this.snaplineModel,graphModel:this.graphModel}),this.container),this.emit(ne.GRAPH_RENDERED,{data:this.graphModel.modelToGraphData(),graphModel:this.graphModel})},r.prototype.render=function(t){var e=xe(t);this.adapterIn&&(e=this.adapterIn(e)),this.renderRawData(e)},r.prototype.undo=function(){if(this.history.undoAble()){var t=Ct(this.history.undo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},r.prototype.redo=function(){if(this.history.redoAble()){var t=Ct(this.history.redo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},r.prototype.zoom=function(t,e){var n=this.graphModel.transformModel;return n.zoom(t,e)},r.prototype.resetZoom=function(){var t=this.graphModel.transformModel;t.resetZoom()},r.prototype.setZoomMiniSize=function(t){var e=this.graphModel.transformModel;e.setZoomMiniSize(t)},r.prototype.setZoomMaxSize=function(t){var e=this.graphModel.transformModel;e.setZoomMaxSize(t)},r.prototype.getTransform=function(){var t=this.graphModel.transformModel,e=t.SCALE_X,n=t.SCALE_Y,o=t.TRANSLATE_X,i=t.TRANSLATE_Y;return{SCALE_X:e,SCALE_Y:n,TRANSLATE_X:o,TRANSLATE_Y:i}},r.prototype.translate=function(t,e){var n=this.graphModel.transformModel;n.translate(t,e)},r.prototype.resetTranslate=function(){var t=this.graphModel.transformModel,e=t.TRANSLATE_X,n=t.TRANSLATE_Y;this.translate(-e,-n)},r.prototype.translateCenter=function(){this.graphModel.translateCenter()},r.prototype.fitView=function(t,e){e===void 0&&(e=t),this.graphModel.fitView(t,e)},r.prototype.openEdgeAnimation=function(t){this.graphModel.openEdgeAnimation(t)},r.prototype.closeEdgeAnimation=function(t){this.graphModel.closeEdgeAnimation(t)},r.prototype.on=function(t,e){this.graphModel.eventCenter.on(t,e)},r.prototype.off=function(t,e){this.graphModel.eventCenter.off(t,e)},r.prototype.once=function(t,e){this.graphModel.eventCenter.once(t,e)},r.prototype.emit=function(t,e){this.graphModel.eventCenter.emit(t,e)},r.use=function(t,e){var n,o=t.pluginName;if(!o)throw new Error(" pluginName!");this.extensions.set(o,(n={},n[ps]=ps,n.extension=t,n.props=e,n))},r.addThemeMode=function(t,e){yg(t,e)},r.removeThemeMode=function(t){mg(t)},r.clearThemeMode=function(){Zu()},r.prototype.installPlugins=function(t){var e=this;t===void 0&&(t=[]);var n=Array.from(r.extensions,function(i){var a=Ti(i,2),s=a[1];return s}),o=hs(hs([],Ti(this.plugins),!1),Ti(n),!1);Oe(o,function(i){var a,s;ps in i?(a=i.extension,s=i.props):a=i;var l=a==null?void 0:a.pluginName;qc(t,l)===-1&&e.installPlugin(a,s)})},r.prototype.installPlugin=function(t,e){var n,o;if("pluginName"in t&&"install"in t){var i=t.pluginName,a=t.install,s=t.render;i&&(a&&a.call(t,this,r),s&&this.components.push(s.bind(t)),this.extension[i]=t);return}var l=t,u=l.pluginName,f=new l({lf:this,LogicFlow:r,props:e,options:(o=(n=this.options.pluginsOptions)===null||n===void 0?void 0:n[u])!==null&&o!==void 0?o:{}});f.render&&this.components.push(f.render.bind(f)),this.extension[u]=f},r.prototype.destroy=function(){var t;this.clearData(),Su(null,this.container),this.keyboard.destroy(),this.graphModel.destroy(),this.tool.destroy(),this.history.destroy(),Zu();for(var e in this.extension){var n=this.extension[e];"destroy"in n&&((t=n.destroy)===null||t===void 0||t.call(n))}},r.extensions=new Map,r})();(function(r){r.toStringTag="LF.".concat(r.name)})(fl||(fl={}));const g0=fl;function Lt(r){return Dl(r)}var pd={width:40,height:40},vd={width:40,height:40},gd={width:40,height:40},yd={width:100,height:80},md={width:100,height:80},Pm=(function(){function r(){globalThis._ids=this,this._ids=new Set}return r.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})},r.prototype.next=function(){for(var t=this.generateId();this._ids.has(t);)t=this.generateId();return this._ids.add(t),t},r})(),Dm=(globalThis==null?void 0:globalThis._ids)||new Pm;function oo(){return Dm.next()}var wc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})();(function(r){wc(t,r);function t(e,n){return e.id||(e.id="Event_".concat(oo())),e.text||(e.text=""),e.text&&typeof e.text=="string"&&(e.text={value:e.text,x:e.x,y:e.y+40}),r.call(this,e,n)||this}return t.prototype.setAttributes=function(){this.r=18},t.prototype.getConnectedTargetRules=function(){var e=r.prototype.getConnectedTargetRules.call(this),n={message:"",validate:function(){return!1}};return e.push(n),e},t.extendKey="StartEventModel",t})(la);(function(r){wc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.extendKey="StartEventNode",t})(ca);var Ec=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),_a=function(){return _a=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},_a.apply(this,arguments)};(function(r){Ec(t,r);function t(e,n){return e.id||(e.id="Event_".concat(oo())),e.text||(e.text=""),e.text&&typeof e.text=="string"&&(e.text={value:e.text,x:e.x,y:e.y+40}),r.call(this,e,n)||this}return t.prototype.setAttributes=function(){this.r=18},t.prototype.getConnectedSourceRules=function(){var e=r.prototype.getConnectedSourceRules.call(this),n={message:"",validate:function(){return!1}};return e.push(n),e},t.extendKey="EndEventModel",t})(la);(function(r){Ec(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},t.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle(),o=e,i=o.x,a=o.y,s=o.r,l=r.prototype.getShape.call(this);return ce("g",{},l,ce("circle",_a(_a({},n),{cx:i,cy:a,r:s-5})))},t.extendKey="EndEventView",t})(ca);var bc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})();(function(r){bc(t,r);function t(e,n){return e.id||(e.id="Flow_".concat(oo())),r.call(this,e,n)||this}return t.extendKey="SequenceFlowModel",t})(qo);(function(r){bc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.extendKey="SequenceFlowEdge",t})(Qo);var Sc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Do=function(){return Do=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Do.apply(this,arguments)};(function(r){Sc(t,r);function t(e,n){var o=this;return e.id||(e.id="Gateway_".concat(oo())),e.text||(e.text=""),e.text&&typeof e.text=="string"&&(e.text={value:e.text,x:e.x,y:e.y+40}),o=r.call(this,e,n)||this,o.points=[[25,0],[50,25],[25,50],[0,25]],o}return t.extendKey="ExclusiveGatewayModel",t})(ua);(function(r){Sc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getShape=function(){var e=this.props.model,n=e,o=n.x,i=n.y,a=n.width,s=n.height,l=n.points,u=e.getNodeStyle();return ce("g",{transform:"matrix(1 0 0 1 ".concat(o-a/2," ").concat(i-s/2,")")},ce("polygon",Do(Do({},u),{x:o,y:i,points:l})),ce("path",Do({d:"m 16,15 7.42857142857143,9.714285714285715 -7.42857142857143,9.714285714285715 3.428571428571429,0 5.714285714285715,-7.464228571428572 5.714285714285715,7.464228571428572 3.428571428571429,0 -7.42857142857143,-9.714285714285715 7.42857142857143,-9.714285714285715 -3.428571428571429,0 -5.714285714285715,7.464228571428572 -5.714285714285715,-7.464228571428572 -3.428571428571429,0 z"},u)))},t.extendKey="ExclusiveGatewayNode",t})(pa);var Oc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),cl=function(){return cl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},cl.apply(this,arguments)};(function(r){Oc(t,r);function t(e,n){return e.id||(e.id="Activity_".concat(oo())),r.call(this,e,n)||this}return t.extendKey="ServiceTaskModel",t})(Zn);(function(r){Oc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getLabelShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.getNodeStyle();return ce("svg",{x:n-i/2+5,y:o-a/2+5,width:30,height:30,viewBox:"0 0 1274 1024"},ce("path",{fill:s.stroke,d:"M882.527918 434.149934c-2.234901-5.303796-7.311523-8.853645-13.059434-9.138124l-61.390185-3.009544c-6.635117-20.973684-15.521508-41.175795-26.513864-60.282968l42.051745-47.743374c4.308119-4.889357 4.955872-12.004405 1.602498-17.59268-46.384423-77.30362-103.969956-101.422947-106.400309-102.410438-5.332449-2.170432-11.432377-1.090844-15.693424 2.77009L654.674467 240.664222c-17.004279-8.654101-35.092239-15.756869-53.995775-21.210068l-3.26537-66.490344c-0.280386-5.747911-3.833305-10.824533-9.134031-13.059434-1.683339-0.709151-30.193673-12.391215-76.866668-12.051477-46.672996-0.339738-75.18333 11.342326-76.866668 12.051477-5.300726 2.234901-8.853645 7.311523-9.134031 13.059434l-3.26537 66.490344c-18.903535 5.453199-36.991496 12.555967-53.995775 21.210068l-48.450479-43.922349c-4.261047-3.860934-10.360975-4.940522-15.693424-2.77009-2.430352 0.98749-60.015885 25.106818-106.400309 102.410438-3.353374 5.588275-2.705622 12.703323 1.602498 17.59268l42.051745 47.743374c-10.992355 19.107173-19.878746 39.309284-26.513864 60.282968l-61.390185 3.009544c-5.747911 0.284479-10.824533 3.834328-13.059434 9.138124-1.01512 2.415003-24.687262 60.190871-2.822278 147.651828 1.583055 6.324032 7.072069 10.893094 13.57518 11.308557 5.892197 0.37146 11.751648 0.523933 17.419741 0.667196 14.498202 0.372483 28.193109 0.723477 40.908712 4.63353 4.212952 1.294482 6.435573 8.270361 9.349949 18.763342 1.287319 4.640694 2.617617 9.43693 4.484128 14.010085 1.794879 4.393054 3.75758 8.570189 5.66093 12.607132 1.302669 2.765997 2.529613 5.380544 3.689019 8.018627 2.986007 6.803963 2.682086 9.773598 2.578732 10.349719-3.061732 3.672646-6.391571 7.238868-9.91379 11.015891-1.810229 1.943258-3.680832 3.949962-5.523807 5.980201l-22.560832 24.8909c-3.865028 4.261047-4.940522 10.365068-2.774183 15.693424 0.991584 2.426259 25.102724 60.011792 102.414531 106.400309 5.588275 3.353374 12.703323 2.701528 17.591657-1.603521l23.476691-20.682042c2.346441-2.061962 4.64888-4.336772 6.875594-6.534833 9.05319-8.93858 14.018272-12.95608 17.73185-11.576663 3.305279 1.222851 6.907317 3.166109 10.720156 5.228071 3.325745 1.794879 6.764054 3.650133 10.465352 5.288446 6.016017 2.662643 12.120039 4.688789 18.019399 6.65149 6.827499 2.266623 13.279445 4.409426 18.819624 7.275707 1.518586 0.782829 1.926886 0.994654 2.358721 7.830339 0.726547 11.496845 1.25048 23.276123 1.753947 34.672684 0.264013 5.900384 0.528026 11.803837 0.815575 17.700127 0.284479 5.743818 3.833305 10.82044 9.138124 13.05534 1.654686 0.698918 29.371958 12.063757 74.869175 12.063757 0.328481 0 3.65832 0 3.986801 0 45.497217 0 73.214489-11.364839 74.869175-12.063757 5.304819-2.234901 8.853645-7.311523 9.138124-13.05534 0.287549-5.89629 0.551562-11.799744 0.815575-17.700127 0.503467-11.396561 1.027399-23.175839 1.753947-34.672684 0.431835-6.835685 0.840134-7.04751 2.358721-7.830339 5.54018-2.866281 11.992125-5.009084 18.819624-7.275707 5.89936-1.962701 12.003382-3.988848 18.019399-6.65149 3.701299-1.638313 7.139607-3.493567 10.465352-5.288446 3.812839-2.061962 7.414877-4.00522 10.720156-5.228071 3.713578-1.379417 8.67866 2.638083 17.73185 11.576663 2.226714 2.198062 4.529153 4.472871 6.875594 6.534833l23.476691 20.682042c4.888334 4.305049 12.003382 4.956895 17.591657 1.603521 77.311807-46.388517 101.422947-103.97405 102.414531-106.400309 2.166339-5.328355 1.090844-11.432377-2.774183-15.693424l-22.560832-24.8909c-1.842974-2.030239-3.713578-4.036943-5.523807-5.980201-3.52222-3.777023-6.852058-7.343245-9.91379-11.015891-0.103354-0.576121-0.407276-3.545756 2.578732-10.349719 1.159406-2.638083 2.38635-5.252631 3.689019-8.018627 1.90335-4.036943 3.866051-8.214079 5.66093-12.607132 1.866511-4.573155 3.196809-9.369392 4.484128-14.010085 2.914376-10.492982 5.136997-17.46886 9.349949-18.763342 12.715603-3.910053 26.41051-4.261047 40.908712-4.63353 5.668093-0.143263 11.527544-0.295735 17.419741-0.667196 6.503111-0.415462 11.992125-4.984524 13.57518-11.308557C907.21518 494.340805 883.543038 436.564937 882.527918 434.149934zM643.49894 643.761929c-35.280528 35.280528-82.191954 54.711066-132.086317 54.711066s-96.806813-19.430538-132.086317-54.711066c-35.280528-35.279504-54.711066-82.191954-54.711066-132.086317 0-49.894364 19.430538-96.80272 54.711066-132.082224 35.283598-35.284621 82.191954-54.711066 132.086317-54.711066s96.80579 19.426445 132.086317 54.711066c35.279504 35.279504 54.711066 82.187861 54.711066 132.082224C698.210006 561.569976 678.782537 608.482425 643.49894 643.761929z"}))},t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.radius,l=e.getNodeStyle();return ce("g",{},[ce("rect",cl({x:n-i/2,y:o-a/2,rx:s,ry:s,width:i,height:a},l)),this.getLabelShape()])},t.extendKey="ServiceTaskNode",t})(gn);var Mc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),xa=function(){return xa=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},xa.apply(this,arguments)};(function(r){Mc(t,r);function t(e,n){return e.id||(e.id="Activity_".concat(oo())),r.call(this,e,n)||this}return t.extendKey="UserTaskModel",t})(Zn);(function(r){Mc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getLabelShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.getNodeStyle();return ce("svg",{x:n-i/2+5,y:o-a/2+5,width:25,height:25,viewBox:"0 0 1274 1024"},ce("path",{fill:s.stroke,d:"M655.807326 287.35973m-223.989415 0a218.879 218.879 0 1 0 447.978829 0 218.879 218.879 0 1 0-447.978829 0ZM1039.955839 895.482975c-0.490184-212.177424-172.287821-384.030443-384.148513-384.030443-211.862739 0-383.660376 171.85302-384.15056 384.030443L1039.955839 895.482975z"}))},t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.radius,l=e.getNodeStyle();return ce("g",{},[ce("rect",xa(xa({},l),{x:n-i/2,y:o-a/2,rx:s,ry:s,width:i,height:a})),this.getLabelShape()])},t.extendKey="UserTaskNode",t})(gn);var Rm=(function(){function r(){globalThis._ids=this,this._ids=new Set}return r.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})},r.prototype.next=function(){for(var t=this.generateId();this._ids.has(t);)t=this.generateId();return this._ids.add(t),t},r})(),Lm=(globalThis==null?void 0:globalThis._ids)||new Rm;function _d(){return Lm.next()}function Ac(r){return Object.prototype.toString.call(r)}function jm(r){return"  ".repeat(r)}function wa(r){var t=r;return Ac(r)==="[object Object]"?(t={},Object.keys(r).forEach(function(e){var n=e;e.charAt(0)==="-"&&(n=e.substring(1)),t[n]=wa(r[e])})):Array.isArray(r)&&(t=[],r.forEach(function(e,n){t[n]=wa(e)})),t}function Ea(r){return r==null?"":r.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function Im(r){var t=r;try{typeof t!="string"&&(t=JSON.parse(r))}catch{t=JSON.stringify(wa(r)).replace(/"/g,"'")}return Ea(String(t))}var en=`	
`;function Bi(r,t,e){var n=jm(e);if(r!==0&&r!==!1&&!r)return en+n+"<".concat(t," />");var o="";if(t==="#text")return en+n+Ea(String(r));if(t==="#cdata-section")return en+n+"<![CDATA["+r+"]]>";if(t==="#comment")return en+n+"<!--"+r+"-->";if("".concat(t).charAt(0)==="-")return" "+t.substring(1)+'="'+Im(r)+'"';if(Array.isArray(r))r.forEach(function(l){o+=Bi(l,t,e+1)});else if(Ac(r)==="[object Object]"){var i=Object.keys(r),a="",s="";o+=(e===0?"":en+n)+"<"+t,i.forEach(function(l){l.charAt(0)==="-"?a+=Bi(r[l],l,e+1):s+=Bi(r[l],l,e+1)}),o+=a+(s!==""?">".concat(s).concat(en+n,"</").concat(t,">"):" />")}else o+=en+n+"<".concat(t,">").concat(Ea(String(r)),"</").concat(t,">");return o}function km(r){var t="";for(var e in r)t+=Bi(r[e],e,0);return t}var It=function(){};It.ObjTree=function(){return this};It.ObjTree.VERSION="0.23";It.ObjTree.prototype.xmlDecl=`<?xml version="1.0" encoding="UTF-8" ?>
`;It.ObjTree.prototype.attr_prefix="-";It.ObjTree.prototype.parseXML=function(r){var t;if(window.DOMParser){var e=new DOMParser,n=e.parseFromString(r,"application/xml");if(!n)return;t=n.documentElement}else window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(r),t=e.documentElement);if(t)return this.parseDOM(t)};It.ObjTree.prototype.parseHTTP=function(r,t,e){var n={};for(var o in t)n[o]=t[o];if(n.method||(typeof n.postBody>"u"&&typeof n.postbody>"u"&&typeof n.parameters>"u"?n.method="get":n.method="post"),e){n.asynchronous=!0;var i=this,a=e,s=n.onComplete;n.onComplete=function(f){var d;f&&f.responseXML&&f.responseXML.documentElement&&(d=i.parseDOM(f.responseXML.documentElement)),a(d,f),s&&s(f)}}else n.asynchronous=!1;var l;if(typeof HTTP<"u"&&HTTP.Request){n.uri=r;var u=new HTTP.Request(n);u&&(l=u.transport)}else if(typeof Ajax<"u"&&Ajax.Request){var u=new Ajax.Request(r,n);u&&(l=u.transport)}if(e)return l;if(l&&l.responseXML&&l.responseXML.documentElement)return this.parseDOM(l.responseXML.documentElement)};It.ObjTree.prototype.parseDOM=function(r){if(r){if(this.__force_array={},this.force_array)for(var t=0;t<this.force_array.length;t++)this.__force_array[this.force_array[t]]=1;var e=this.parseElement(r);if(this.__force_array[r.nodeName]&&(e=[e]),r.nodeType!=11){var n={};n[r.nodeName]=e,e=n}return e}};It.ObjTree.prototype.parseElement=function(r){if(r.nodeType!=7){if(r.nodeType==3||r.nodeType==4||r.nodeType==8){var t=r.nodeValue.match(/[^\x00-\x20]/);return t==null?void 0:r.nodeValue}var e=null,n={};if(r.attributes&&r.attributes.length){e={};for(var o=0;o<r.attributes.length;o++){var i=r.attributes[o].nodeName;if(typeof i=="string"){var a=r.attributes[o].nodeValue;try{a=JSON.parse(r.attributes[o].nodeValue.replace(/'/g,'"'))}catch{a=r.attributes[o].nodeValue}a&&(i=this.attr_prefix+i,typeof n[i]>"u"&&(n[i]=0),n[i]++,this.addNode(e,i,n[i],a))}}}if(r.childNodes&&r.childNodes.length){var s=!0;e&&(s=!1);for(var o=0;o<r.childNodes.length&&s;o++){var l=r.childNodes[o].nodeType;l==3||l==4||l==8||(s=!1)}if(s){e||(e="");for(var o=0;o<r.childNodes.length;o++)e+=r.childNodes[o].nodeValue}else{e||(e={});for(var o=0;o<r.childNodes.length;o++){var i=r.childNodes[o].nodeName;if(typeof i=="string"){var a=this.parseElement(r.childNodes[o]);a&&(typeof n[i]>"u"&&(n[i]=0),n[i]++,this.addNode(e,i,n[i],a))}}}}else e===null&&(e={});return e}};It.ObjTree.prototype.addNode=function(r,t,e,n){this.__force_array[t]?(e==1&&(r[t]=[]),r[t][r[t].length]=n):e==1?r[t]=n:e==2?r[t]=[r[t],n]:r[t][r[t].length]=n};It.ObjTree.prototype.writeXML=function(r){var t=this.hash_to_xml(null,r);return this.xmlDecl+t};It.ObjTree.prototype.hash_to_xml=function(r,t){var e=[],n=[];for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];o.charAt(0)!=this.attr_prefix?typeof i>"u"||i==null?e[e.length]="<"+o+" />":typeof i=="object"&&i.constructor==Array?e[e.length]=this.array_to_xml(o,i):typeof i=="object"?e[e.length]=this.hash_to_xml(o,i):e[e.length]=this.scalar_to_xml(o,i):n[n.length]=" "+o.substring(1)+'="'+this.xml_escape(i)+'"'}var a=n.join(""),s=e.join("");return typeof r>"u"||r==null||(e.length>0?s.match(/\n/)?s="<"+r+a+`>
`+s+"</"+r+`>
`:s="<"+r+a+">"+s+"</"+r+`>
`:s="<"+r+a+` />
`),s};It.ObjTree.prototype.array_to_xml=function(r,t){for(var e=[],n=0;n<t.length;n++){var o=t[n];typeof o>"u"||o==null?e[e.length]="<"+r+" />":typeof o=="object"&&o.constructor==Array?e[e.length]=this.array_to_xml(r,o):typeof o=="object"?e[e.length]=this.hash_to_xml(r,o):e[e.length]=this.scalar_to_xml(r,o)}return e.join("")};It.ObjTree.prototype.scalar_to_xml=function(r,t){return r=="#text"?this.xml_escape(t):"<"+r+">"+this.xml_escape(t)+"</"+r+`>
`};It.ObjTree.prototype.xml_escape=Ea;var Bm=function(r){return new It.ObjTree().parseXML(r)},Xm=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),hl=function(){return hl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},hl.apply(this,arguments)},Wa=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Nr;(function(r){r.START="bpmn:startEvent",r.END="bpmn:endEvent",r.GATEWAY="bpmn:exclusiveGateway",r.USER="bpmn:userTask",r.SYSTEM="bpmn:serviceTask",r.FLOW="bpmn:sequenceFlow"})(Nr||(Nr={}));var Nc=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef"],xd=["properties","startPoint","endPoint","pointsList"],Cc=function(r){return String(r||"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&apos;/g,"'")};function wd(r){var t=r?xd.concat(r):xd;return function(e){function n(o){var i={};return typeof o=="string"?o:Array.isArray(o)?o.map(function(a){return n(a)}):(Object.entries(o).forEach(function(a){var s=Wa(a,2),l=s[0],u=s[1];typeof u!="object"?l.indexOf("-")===0||["#text","#cdata-section","#comment"].includes(l)?i[l]=u:i["-".concat(l)]=u:t.includes(l)?i["-".concat(l)]=n(u):i[l]=n(u)}),i)}return n(e)}}function ba(r){var t={};return Object.entries(r).forEach(function(e){var n=Wa(e,2),o=n[0],i=n[1];o.indexOf("-")===0?t[o.substring(1)]=wa(i):typeof i=="string"?t[o]=i:Object.prototype.toString.call(i)==="[object Object]"?t[o]=ba(i):Array.isArray(i)?t[o]=i.map(function(a){return ba(a)}):t[o]=i}),t}function Hm(r,t,e){var n=new Map;t.nodes.forEach(function(i){var a,s={"-id":i.id};if(!((a=i.text)===null||a===void 0)&&a.value&&(s["-name"]=i.text.value),i.properties){var l=wd(e)(i.properties);Object.assign(s,l)}n.set(i.id,s),r[i.type]?Array.isArray(r[i.type])?r[i.type].push(s):r[i.type]=[r[i.type],s]:r[i.type]=s});var o=t.edges.map(function(i){var a,s,l=n.get(i.targetNodeId);l["bpmn:incoming"]?Array.isArray(l["bpmn:incoming"])?l["bpmn:incoming"].push(i.id):l["bpmn:incoming"]=[l["bpmn:incoming"],i.id]:l["bpmn:incoming"]=i.id;var u={"-id":i.id,"-sourceRef":i.sourceNodeId,"-targetRef":i.targetNodeId};if(!((a=i.text)===null||a===void 0)&&a.value&&(u["-name"]=(s=i.text)===null||s===void 0?void 0:s.value),i.properties){var f=wd(e)(i.properties);Object.assign(u,f)}return u});t.edges.forEach(function(i){var a=n.get(i.sourceNodeId);a["bpmn:outgoing"]?Array.isArray(a["bpmn:outgoing"])?a["bpmn:outgoing"].push(i.id):a["bpmn:outgoing"]=[a["bpmn:outgoing"],i.id]:a["bpmn:outgoing"]=i.id}),r[Nr.FLOW]=o}function Gm(r,t){r["bpmndi:BPMNEdge"]=t.edges.map(function(e){var n,o=e.id,i=e.pointsList.map(function(s){var l=s.x,u=s.y;return{"-x":l,"-y":u}}),a={"-id":"".concat(o,"_di"),"-bpmnElement":o,"di:waypoint":i};return!((n=e.text)===null||n===void 0)&&n.value&&(a["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),a}),r["bpmndi:BPMNShape"]=t.nodes.map(function(e){var n,o=e.id,i=100,a=80,s=e.x,l=e.y,u=Zr.shapeConfigMap.get(e.type);u&&(i=u.width,a=u.height),s-=i/2,l-=a/2;var f={"-id":"".concat(o,"_di"),"-bpmnElement":o,"dc:Bounds":{"-x":s,"-y":l,"-width":i,"-height":a}};return!((n=e.text)===null||n===void 0)&&n.value&&(f["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),f})}function zm(r){var t=[],e=[],n=r["bpmn:definitions"];if(n){var o=n["bpmn:process"],i=n["bpmndi:BPMNDiagram"],a=i==null?void 0:i["bpmndi:BPMNPlane"];if(!o||!a)return{nodes:t,edges:e};Object.keys(o).forEach(function(s){if(s.indexOf("bpmn:")===0){var l=o[s];if(s===Nr.FLOW){var u=a["bpmndi:BPMNEdge"],f=(Array.isArray(u),u);e=Fm(l,f)}else{var d=a["bpmndi:BPMNShape"],c=(Array.isArray(d),d);t=t.concat(Ym(l,c,s))}}})}return{nodes:t,edges:e}}function Ym(r,t,e){var n=[];if(Array.isArray(r))r.forEach(function(a){var s;Array.isArray(t)?s=t.find(function(u){return u["-bpmnElement"]===a["-id"]}):s=t;var l=Ed(s,e,a);n.push(l)});else{var o=void 0;Array.isArray(t)?o=t.find(function(a){return a["-bpmnElement"]===r["-id"]}):o=t;var i=Ed(o,e,r);n.push(i)}return n}function Ed(r,t,e){var n=Number(r["dc:Bounds"]["-x"]),o=Number(r["dc:Bounds"]["-y"]),i=Cc(e["-name"]),a=Zr.shapeConfigMap.get(t);a&&(n+=a.width/2,o+=a.height/2);var s;Object.entries(e).forEach(function(d){var c=Wa(d,2),h=c[0],p=c[1];Nc.indexOf(h)===-1&&(s||(s={}),s[h]=p)}),s&&(s=ba(s));var l;if(i&&(l={x:n,y:o,value:i},r["bpmndi:BPMNLabel"]&&r["bpmndi:BPMNLabel"]["dc:Bounds"])){var u=r["bpmndi:BPMNLabel"]["dc:Bounds"];l.x=Number(u["-x"])+Number(u["-width"])/2,l.y=Number(u["-y"])+Number(u["-height"])/2}var f={id:r["-bpmnElement"],type:t,x:n,y:o,properties:s};return l&&(f.text=l),f}function Fm(r,t){var e=[];if(Array.isArray(r))r.forEach(function(o){var i;Array.isArray(t)?i=t.find(function(a){return a["-bpmnElement"]===o["-id"]}):i=t,e.push(bd(i,o))});else{var n=void 0;Array.isArray(t)?n=t.find(function(o){return o["-bpmnElement"]===r["-id"]}):n=t,e.push(bd(n,r))}return e}function bd(r,t){var e,n=t["-name"]?Cc("".concat(t["-name"])):"";if(n){var o=void 0;r["bpmndi:BPMNLabel"]&&r["bpmndi:BPMNLabel"]["dc:Bounds"]&&(o=r["bpmndi:BPMNLabel"]["dc:Bounds"]);var i=0;if(n.split(`
`).forEach(function(h){i<h.length&&(i=h.length)}),o)e={value:n,x:Number(o["-x"])+i*10/2,y:Number(o["-y"])+7};else{var a=r["di:waypoint"]||[],s=a[0],l=a[a.length-1]||s,u=(Number((s==null?void 0:s["-x"])||0)+Number((l==null?void 0:l["-x"])||0))/2,f=(Number((s==null?void 0:s["-y"])||0)+Number((l==null?void 0:l["-y"])||0))/2;e={value:n,x:u,y:f}}}var d;Object.entries(t).forEach(function(h){var p=Wa(h,2),v=p[0],g=p[1];Nc.indexOf(v)===-1&&(d||(d={}),d[v]=g)}),d&&(d=ba(d));var c={id:t["-id"],type:Nr.FLOW,pointsList:r["di:waypoint"].map(function(h){return{x:Number(h["-x"]),y:Number(h["-y"])}}),sourceNodeId:t["-sourceRef"],targetNodeId:t["-targetRef"],properties:d};return e&&(c.text=e),c}var Zr=(function(){function r(t){var e=t.lf,n=this;this.adapterOut=function(o,i){var a=hl({},n.processAttributes);Hm(a,o,i);var s={"-id":"BPMNPlane_1","-bpmnElement":a["-id"]};Gm(s,o);var l=n.definitionAttributes;l["bpmn:process"]=a,l["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":s};var u={"bpmn:definitions":l};return u},this.adapterIn=function(o){if(o)return zm(o)},e.adapterIn=function(o){return n.adapterIn(o)},e.adapterOut=function(o,i){return n.adapterOut(o,i)},this.processAttributes={"-isExecutable":"true","-id":"Process_".concat(_d())},this.definitionAttributes={"-id":"Definitions_".concat(_d()),"-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.0"}}return r.prototype.setCustomShape=function(t,e){r.shapeConfigMap.set(t,e)},r.pluginName="bpmn-adapter",r.shapeConfigMap=new Map,r})();Zr.shapeConfigMap.set(Nr.START,{width:pd.width,height:pd.height});Zr.shapeConfigMap.set(Nr.END,{width:vd.width,height:vd.height});Zr.shapeConfigMap.set(Nr.GATEWAY,{width:gd.width,height:gd.height});Zr.shapeConfigMap.set(Nr.SYSTEM,{width:yd.width,height:yd.height});Zr.shapeConfigMap.set(Nr.USER,{width:md.width,height:md.height});(function(r){Xm(t,r);function t(e){var n=r.call(this,e)||this;n.adapterXmlIn=function(i){var a=typeof i=="string"?n.sanitizeNameAttributes(i):i,s=Bm(a);return n.adapterIn(s)},n.adapterXmlOut=function(i,a){var s=n.adapterOut(i,a);return km(s)};var o=e.lf;return o.adapterIn=n.adapterXmlIn,o.adapterOut=n.adapterXmlOut,n}return t.prototype.sanitizeNameAttributes=function(e){return e.replace(/name="([^"]*)"/g,function(n,o){var i=o.replace(/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return'name="'.concat(i,'"')})},t.pluginName="bpmnXmlAdapter",t})(Zr);var $m=(function(){function r(){globalThis._ids=this,this._ids=new Set}return r.prototype.generateId=function(){var t="xxxxxxx".replace(/[x]/g,function(e){var n=Math.random()*16|0,o=e==="x"?n:n&3|8;return o.toString(16)});return t},r.prototype.next=function(){for(var t=this.generateId();this._ids.has(t);)t=this.generateId();return this._ids.add(t),t},r})(),Wm=(globalThis==null?void 0:globalThis._ids)||new $m;function Um(){return Wm.next()}ce("circle",{cx:18,cy:18,r:11,style:"stroke-linecap: round;stroke-linejoin: round;stroke: rgb(34, 36, 42);stroke-width: 2px;fill: white"}),ce("path",{d:"M 18,18 l 2.25,-7.5 m -2.25,7.5 l 5.25,1.5",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(0,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(30,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(60,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(90,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(120,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(150,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(180,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(210,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(240,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(270,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(300,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),ce("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(330,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"});ce("circle",{cx:18,cy:18,r:10,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 4px; fill: rgb(34, 36, 42);"});ce("circle",{cx:25,cy:25,r:13,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2.5px; fill: white;"});var Vm=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),ln=function(){return ln=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ln.apply(this,arguments)},Km=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Zm=rr,qm=(function(r){Vm(t,r);function t(e){var n=r.call(this)||this;return n.updatePosition=function(o){var i=o.deltaX,a=o.deltaY,s=n.nodeModel,l=s.x,u=s.y;n.nodeModel.x=l+i/2,n.nodeModel.y=u+a/2,n.nodeModel.moveText(i/2,a/2)},n.getResize=function(o){var i=o.index,a=o.deltaX,s=o.deltaY,l=o.width,u=o.height,f=o.PCTResizeInfo,d=o.pct,c=d===void 0?1:d,h=o.freezeWidth,p=h===void 0?!1:h,v=o.freezeHeight,g=v===void 0?!1:v,y={width:l,height:u,deltaX:a,deltaY:s};if(f){var w=4,M=0,C=0;switch(i){case 0:C=(a*-1-s)/w;break;case 1:C=(a-s)/w;break;case 2:C=(a+s)/w;break;case 3:C=(a*-1+s)/w;break}C!==0&&(M=Math.round(C/f.ResizeBasis.basisHeight*1e5)/1e3),f.ResizePCT.widthPCT=Math.max(Math.min(f.ResizePCT.widthPCT+M,f.ScaleLimit.maxScaleLimit),f.ScaleLimit.minScaleLimit),f.ResizePCT.heightPCT=Math.max(Math.min(f.ResizePCT.heightPCT+M,f.ScaleLimit.maxScaleLimit),f.ScaleLimit.minScaleLimit);var P=Math.round(f.ResizePCT.widthPCT*f.ResizeBasis.basisWidth/100),S=Math.round(f.ResizePCT.heightPCT*f.ResizeBasis.basisHeight/100);switch(i){case 0:a=l-P,s=u-S;break;case 1:a=P-l,s=u-S;break;case 2:a=P-l,s=S-u;break;case 3:a=l-P,s=S-u;break}return y.width=P,y.height=S,y.deltaX=a/c,y.deltaY=s/c,y}switch(i){case 0:y.width=p?l:l-a*c,y.height=g?u:u-s*c;break;case 1:y.width=p?l:l+a*c,y.height=g?u:u-s*c;break;case 2:y.width=p?l:l+a*c,y.height=g?u:u+s*c;break;case 3:y.width=p?l:l-a*c,y.height=g?u:u+s*c;break}return y},n.updateEdgePointByAnchors=function(){var o=n.nodeModel,i=o.id,a=o.anchors,s=n.getNodeEdges(i);s.sourceEdges.forEach(function(l){var u=a.find(function(f){return f.id===l.sourceAnchorId});u&&l.updateStartPoint({x:u.x,y:u.y})}),s.targetEdges.forEach(function(l){var u=a.find(function(f){return f.id===l.targetAnchorId});u&&l.updateEndPoint({x:u.x,y:u.y})})},n.updateRect=function(o){var i=o.deltaX,a=o.deltaY,s=n.nodeModel,l=s.x,u=s.y,f=s.width,d=s.height,c=s.radius,h=s.PCTResizeInfo,p=n.nodeModel,v=p.minWidth,g=p.minHeight,y=p.maxWidth,w=p.maxHeight,M=n.index,C=v===y,P=g===w,S=n.getResize({index:M,deltaX:i,deltaY:a,width:f,height:d,PCTResizeInfo:h,pct:1,freezeWidth:C,freezeHeight:P});if(S.width<v||S.width>y||S.height<g||S.height>w){n.dragHandler.cancelDrag();return}n.updatePosition({deltaX:C?0:S.deltaX,deltaY:P?0:S.deltaY}),n.nodeModel.width=S.width,n.nodeModel.height=S.height,n.nodeModel.setProperties({nodeSize:{width:S.width,height:S.height}});var E={x:l,y:u,width:f,height:d,radius:c},T={x:n.nodeModel.x,y:n.nodeModel.y,width:n.nodeModel.width,height:n.nodeModel.height,radius:c};n.updateEdgePointByAnchors(),n.eventEmit({deltaX:i,deltaY:a,beforeNode:E,afterNode:T})},n.updateEllipse=function(o){var i=o.deltaX,a=o.deltaY,s=n.nodeModel,l=s.rx,u=s.ry,f=s.x,d=s.y,c=s.PCTResizeInfo,h=n.index,p=n.nodeModel,v=p.minWidth,g=p.minHeight,y=p.maxWidth,w=p.maxHeight,M=v===y,C=g===w,P=l,S=u,E=n.getResize({index:h,deltaX:i,deltaY:a,width:P,height:S,PCTResizeInfo:c,pct:1/2,freezeWidth:M,freezeHeight:C});if(E.width<v/2||E.width>y/2||E.height<g/2||E.height>w/2){n.dragHandler.cancelDrag();return}n.updatePosition({deltaX:M?0:E.deltaX,deltaY:C?0:E.deltaY}),n.nodeModel.rx=E.width,n.nodeModel.ry=E.height,n.nodeModel.setProperties({nodeSize:{rx:E.width,ry:E.height}});var T={x:f,y:d},j={rx:E.width,ry:E.height,x:n.nodeModel.x,y:n.nodeModel.y};n.updateEdgePointByAnchors(),n.eventEmit({deltaX:i,deltaY:a,beforeNode:ln(ln({},T),{rx:l,ry:u}),afterNode:j})},n.updateDiamond=function(o){var i=o.deltaX,a=o.deltaY,s=n.nodeModel,l=s.rx,u=s.ry,f=s.x,d=s.y,c=s.PCTResizeInfo,h=n.index,p=n.nodeModel,v=p.minWidth,g=p.minHeight,y=p.maxWidth,w=p.maxHeight,M=v===y,C=g===w,P=l,S=u,E=n.getResize({index:h,deltaX:i,deltaY:a,width:P,height:S,PCTResizeInfo:c,pct:1/2,freezeWidth:M,freezeHeight:C});if(E.width<v/2||E.width>y/2||E.height<g/2||E.height>w/2){n.dragHandler.cancelDrag();return}n.updatePosition({deltaX:M?0:E.deltaX,deltaY:C?0:E.deltaY}),n.nodeModel.rx=E.width,n.nodeModel.ry=E.height,n.nodeModel.setProperties({nodeSize:{rx:E.width,ry:E.height}});var T={x:f,y:d,rx:l,ry:u},j={rx:E.width,ry:E.height,x:n.nodeModel.x,y:n.nodeModel.y};n.updateEdgePointByAnchors(),n.eventEmit({deltaX:i,deltaY:a,beforeNode:T,afterNode:j})},n.eventEmit=function(o){var i=o.deltaX,a=o.deltaY,s=o.beforeNode,l=o.afterNode,u=n.nodeModel,f=u.id,d=u.modelType,c=u.type,h=ln({id:f,modelType:d,type:c},s),p=ln({id:f,modelType:d,type:c},l);n.graphModel.eventCenter.emit("node:resize",{preData:h,data:p,deltaX:i,deltaY:a,index:n.index,model:n.nodeModel})},n.onDragging=function(o){var i,a=o.deltaX,s=o.deltaY,l=n.graphModel.transformModel,u=n.nodeModel.modelType;i=Km(l.fixDeltaXY(a,s),2),a=i[0],s=i[1],u===Ae.RECT_NODE||u===Ae.HTML_NODE?n.updateRect({deltaX:a,deltaY:s}):u===Ae.ELLIPSE_NODE?n.updateEllipse({deltaX:a,deltaY:s}):u===Ae.DIAMOND_NODE&&n.updateDiamond({deltaX:a,deltaY:s})},n.onDragEnd=function(){var o=n.graphModel.gridSize,i=o===void 0?1:o,a=i*Math.round(n.nodeModel.x/i),s=i*Math.round(n.nodeModel.y/i);n.nodeModel.moveTo(a,s),n.updateEdgePointByAnchors()},n.index=e.index,n.nodeModel=e.model,n.graphModel=e.graphModel,n.dragHandler=new Zm({onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:1}),n}return t.prototype.getNodeEdges=function(e){for(var n=this.graphModel,o=n.edges,i=[],a=[],s=0;s<o.length;s++){var l=o[s];l.sourceNodeId===e?i.push(l):o[s].targetNodeId===e&&a.push(l)}return{sourceEdges:i,targetEdges:a}},t.prototype.render=function(){var e=this.props,n=e.x,o=e.y,i=e.index,a=e.model,s=a.getControlPointStyle();return k("g",{className:"lf-resize-control-".concat(i),children:k(Jt,ln({className:"lf-node-control",x:n,y:o},s,{onMouseDown:this.dragHandler.handleMouseDown}))})},t})(De),Jm=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Sa=function(){return Sa=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Sa.apply(this,arguments)},Ua=(function(r){Jm(t,r);function t(){var e=r.call(this)||this;return e.state={},e}return t.prototype.getResizeControl=function(){var e=this.props,n=e.model,o=e.graphModel,i=n.x,a=n.y,s=n.width,l=n.height,u={minX:i-s/2,minY:a-l/2,maxX:i+s/2,maxY:a+l/2},f=u.minX,d=u.minY,c=u.maxX,h=u.maxY,p=[{x:f,y:d},{x:c,y:d},{x:c,y:h},{x:f,y:h}];return p.map(function(v,g){return k(qm,Sa({index:g},v,{model:n,graphModel:o}))})},t.prototype.getGroupSolid=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.getResizeOutlineStyle();return k(Jt,Sa({},s,{x:n,y:o,width:i,height:a}))},t.prototype.render=function(){return k("g",{className:"lf-resize-control",children:[this.getGroupSolid(),this.getResizeControl()]})},t})(De),Tc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})();(function(r){Tc(t,r);function t(e,n){var o=r.call(this,e,n)||this,i=e.properties.nodeSize;return i&&(o.rx=i.rx,o.ry=i.ry),o}return t.prototype.initNodeData=function(e){r.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},t.prototype.getOutlineStyle=function(){var e=r.prototype.getOutlineStyle.call(this),n=this.graphModel.editConfigModel.isSilentMode;return n||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var n={widthPCT:100,heightPCT:100},o={basisWidth:this.rx,basisHeight:this.ry},i={maxScaleLimit:Math.min(this.maxWidth/(this.rx*2)*100,this.maxHeight/(this.ry*2)*100),minScaleLimit:Math.max(this.minWidth/(this.rx*2)*100,this.minHeight/(this.ry*2)*100)};this.PCTResizeInfo={ResizePCT:n,ResizeBasis:o,ScaleLimit:i}}else delete this.PCTResizeInfo},t})(Zs);(function(r){Tc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getControlGroup=function(){var e=this.props,n=e.model,o=e.graphModel;return k(Ua,{model:n,graphModel:o})},t.prototype.getResizeShape=function(){return r.prototype.getShape.call(this)},t.prototype.getShape=function(){var e=this.props,n=e.model,o=e.graphModel.editConfigModel.isSilentMode;return k("g",{children:[this.getResizeShape(),n.isSelected&&!o?this.getControlGroup():""]})},t})(il);var Pc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),pl=function(){return pl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},pl.apply(this,arguments)};(function(r){Pc(t,r);function t(e,n){var o=r.call(this,e,n)||this,i=e.properties.nodeSize;return i&&(o.rx=i.rx,o.ry=i.ry),o}return t.prototype.initNodeData=function(e){r.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.gridSize=1},t.prototype.getOutlineStyle=function(){var e=r.prototype.getOutlineStyle.call(this),n=this.graphModel.editConfigModel.isSilentMode;return n||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var n={widthPCT:100,heightPCT:100},o={basisWidth:this.rx,basisHeight:this.ry},i={maxScaleLimit:Math.min(this.maxWidth/(this.rx*2)*100,this.maxHeight/(this.ry*2)*100),minScaleLimit:Math.max(this.minWidth/(this.rx*2)*100,this.minHeight/(this.ry*2)*100)};this.PCTResizeInfo={ResizePCT:n,ResizeBasis:o,ScaleLimit:i}}else delete this.PCTResizeInfo},t})(Ks);(function(r){Pc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getControlGroup=function(){var e=this.props,n=e.model,o=e.graphModel;return k(Ua,{model:n,graphModel:o})},t.prototype.getResizeShape=function(){var e=this.props.model,n=e.points,o=e.getNodeStyle();return k("g",{children:k(jl,pl({},o,{points:n}))})},t.prototype.getShape=function(){var e=this.props,n=e.model.isSelected,o=e.graphModel.editConfigModel.isSilentMode;return k("g",{children:[this.getResizeShape(),n&&!o?this.getControlGroup():""]})},t})(nl);var Dc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})();(function(r){Dc(t,r);function t(e,n){var o=r.call(this,e,n)||this,i=e.properties.nodeSize;return i&&(o.width=i.width,o.height=i.height),o}return t.prototype.initNodeData=function(e){r.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},t.prototype.getOutlineStyle=function(){var e=r.prototype.getOutlineStyle.call(this),n=this.graphModel.editConfigModel.isSilentMode;return n||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var n={widthPCT:100,heightPCT:100},o={basisWidth:this.width,basisHeight:this.height},i={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:n,ResizeBasis:o,ScaleLimit:i}}else delete this.PCTResizeInfo},t})(da);(function(r){Dc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getControlGroup=function(){var e=this.props,n=e.model,o=e.graphModel;return k(Ua,{model:n,graphModel:o})},t.prototype.getResizeShape=function(){return r.prototype.getShape.call(this)},t.prototype.getShape=function(){var e=this.props,n=e.model.isSelected,o=e.graphModel.editConfigModel.isSilentMode;return k("g",{children:[this.getResizeShape(),n&&!o?this.getControlGroup():""]})},t})(va);var Rc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Qm=(function(r){Rc(t,r);function t(e,n){var o=r.call(this,e,n)||this,i=e.properties.nodeSize;return i&&(o.width=i.width,o.height=i.height),o}return t.prototype.initNodeData=function(e){r.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},t.prototype.getOutlineStyle=function(){var e=r.prototype.getOutlineStyle.call(this),n=this.graphModel.editConfigModel.isSilentMode;return n||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var n={widthPCT:100,heightPCT:100},o={basisWidth:this.width,basisHeight:this.height},i={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:n,ResizeBasis:o,ScaleLimit:i}}else delete this.PCTResizeInfo},t})(Zn),e_=(function(r){Rc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getControlGroup=function(){var e=this.props,n=e.model,o=e.graphModel;return k(Ua,{model:n,graphModel:o})},t.prototype.getResizeShape=function(){return r.prototype.getShape.call(this)},t.prototype.getShape=function(){var e=this.props,n=e.model.isSelected,o=e.graphModel.editConfigModel.isSilentMode;return k("g",{children:[this.getResizeShape(),n&&!o?this.getControlGroup():""]})},t})(gn),Lc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Oa=function(){return Oa=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Oa.apply(this,arguments)},tn=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},rn=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Sd=500,Od=300,t_=-1e4;(function(r){Lc(t,r);function t(){var e=r.apply(this,rn([],tn(arguments),!1))||this;return e.isGroup=!0,e.isFolded=!1,e.unfoldedWidth=Sd,e.unfoldedHeight=Od,e.childrenLastFoldStatus={},e}return t.prototype.initNodeData=function(e){var n=this;r.prototype.initNodeData.call(this,e);var o=[];rf(e.children)&&(o=e.children),this.children=new Set(o),this.width=Sd,this.height=Od,this.foldedWidth=80,this.foldedHeight=60,this.zIndex=t_,this.radius=0,this.text.editable=!1,this.text.draggable=!1,this.isRestrict=!1,this.resizable=!1,this.autoToFront=!1,this.foldable=!1,this.properties.isFolded===void 0&&(this.properties.isFolded=!1),this.isFolded=!!this.properties.isFolded,setTimeout(function(){n.isFolded&&n.foldGroup(n.isFolded)})},t.prototype.getResizeOutlineStyle=function(){var e=r.prototype.getResizeOutlineStyle.call(this);return e.stroke="none",e},t.prototype.foldGroup=function(e){var n=this;if(e!==this.isFolded){this.setProperty("isFolded",e),this.isFolded=e,e?(this.x=this.x-this.width/2+this.foldedWidth/2,this.y=this.y-this.height/2+this.foldedHeight/2,this.unfoldedWidth=this.width,this.unfoldedHeight=this.height,this.width=this.foldedWidth,this.height=this.foldedHeight):(this.width=this.unfoldedWidth,this.height=this.unfoldedHeight,this.x=this.x+this.width/2-this.foldedWidth/2,this.y=this.y+this.height/2-this.foldedHeight/2);var o=rn(rn([],tn(this.incoming.edges),!1),tn(this.outgoing.edges),!1);this.children.forEach(function(i){var a=n.graphModel.getElement(i);if(a){var s=a.isFolded;if(a.isGroup&&!a.isFolded&&a.foldGroup(e),a.isGroup&&!e){var l=n.childrenLastFoldStatus[i];l!==void 0&&l!==a.isFolded&&a.foldGroup(l)}n.childrenLastFoldStatus[i]=!!s,a.visible=!e;var u=a.incoming.edges,f=a.outgoing.edges;o=rn(rn(rn([],tn(o),!1),tn(u),!1),tn(f),!1)}}),this.foldEdge(e,o)}},t.prototype.getAnchorStyle=function(e){var n=r.prototype.getAnchorStyle.call(this,e);return n.stroke="transparent",n.fill="transparent",n.hover.fill="transparent",n.hover.stroke="transparent",n},t.prototype.foldEdge=function(e,n){var o=this;n.forEach(function(i,a){var s=i.id,l=i.sourceNodeId,u=i.targetNodeId,f=i.startPoint,d=i.endPoint,c=i.type,h=i.text,p=i.getProperties(),v={id:"".concat(s,"__").concat(a),sourceNodeId:l,targetNodeId:u,startPoint:f,endPoint:d,type:c,properties:p,text:h==null?void 0:h.value};i.virtual&&o.graphModel.deleteEdgeById(i.id);var g=o.graphModel.group.getNodeGroup(u);g||(g=o.graphModel.getNodeModelById(u));var y=o.graphModel.group.getNodeGroup(l);y||(y=o.graphModel.getNodeModelById(l)),e&&i.visible!==!1&&(o.children.has(l)||o.id===l?(v.startPoint=void 0,v.sourceNodeId=o.id):(v.endPoint=void 0,v.targetNodeId=o.id),(g.id!==o.id||y.id!==o.id)&&o.createVirtualEdge(v),i.visible=!1),!e&&i.visible===!1&&(g&&g.isGroup&&g.isFolded?(v.targetNodeId=g.id,v.endPoint=void 0,o.createVirtualEdge(v)):y&&y.isGroup&&y.isFolded?(v.sourceNodeId=y.id,v.startPoint=void 0,o.createVirtualEdge(v)):i.visible=!0)})},t.prototype.createVirtualEdge=function(e){e.pointsList=void 0;var n=this.graphModel.addEdge(e);n.virtual=!0,n.text.editable=!1,n.isFoldedEdge=!0},t.prototype.isInRange=function(e){var n=e.minX,o=e.minY,i=e.maxX,a=e.maxY;return n>=this.x-this.width/2&&i<=this.x+this.width/2&&o>=this.y-this.height/2&&a<=this.y+this.height/2},t.prototype.isAllowMoveTo=function(e){var n=e.minX,o=e.minY,i=e.maxX,a=e.maxY;return{x:n>=this.x-this.width/2&&i<=this.x+this.width/2,y:o>=this.y-this.height/2&&a<=this.y+this.height/2}},t.prototype.setAllowAppendChild=function(e){this.setProperty("groupAddable",e)},t.prototype.addChild=function(e){this.children.add(e),this.graphModel.eventCenter.emit("group:add-node",{data:this.getData()})},t.prototype.removeChild=function(e){this.children.delete(e),this.graphModel.eventCenter.emit("group:remove-node",{data:this.getData()})},t.prototype.getAddableOutlineStyle=function(){return{stroke:"#FEB663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},t.prototype.getData=function(){var e=this,n=r.prototype.getData.call(this);n.children=[],this.children.forEach(function(i){var a=e.graphModel.getNodeModelById(i);a&&!a.virtual&&n.children.push(i)});var o=n.properties;return o==null||delete o.groupAddable,o==null||delete o.isFolded,n},t.prototype.getHistoryData=function(){var e=r.prototype.getData.call(this);e.children=rn([],tn(this.children),!1),e.isGroup=!0;var n=e.properties;return n==null||delete n.groupAddable,n!=null&&n.isFolded&&(e.x=e.x+this.unfoldedWidth/2-this.foldedWidth/2,e.y=e.y+this.unfoldedHeight/2-this.foldedHeight/2),e},t.prototype.isAllowAppendIn=function(e){return console.info("_nodeData",e),!0},t.prototype.toBack=function(){this.zIndex--},t})(Qm);(function(r){Lc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getControlGroup=function(){var e=this.props.model,n=e.resizable,o=e.properties;return n&&!o.isFolded?r.prototype.getControlGroup.call(this):null},t.prototype.getAddableShape=function(){var e=this.props.model,n=e.width,o=e.height,i=e.x,a=e.y,s=e.radius,l=e.properties,u=e.getAddableOutlineStyle;if(!l.groupAddable)return null;var f=this.props.model.getNodeStyle().strokeWidth,d=f===void 0?0:f,c=u(),h=n+d+8,p=o+d+8;return ce("rect",Oa(Oa({},c),{width:h,height:p,x:i-h/2,y:a-p/2,rx:s,ry:s}))},t.prototype.getFoldIcon=function(){var e=this.props.model,n=e.x-e.width/2+5,o=e.y-e.height/2+5;if(!e.foldable)return null;var i=ce("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:e.properties.isFolded?"M ".concat(n+3,",").concat(o+6," ").concat(n+11,",").concat(o+6," M").concat(n+7,",").concat(o+2," ").concat(n+7,",").concat(o+10):"M ".concat(n+3,",").concat(o+6," ").concat(n+11,",").concat(o+6," ")});return ce("g",{},[ce("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#F4F5F6",stroke:"#CECECE",cursor:"pointer",x:e.x-e.width/2+5,y:e.y-e.height/2+5,onClick:function(){e.foldGroup(!e.properties.isFolded)}}),i])},t.prototype.getResizeShape=function(){return ce("g",{},[this.getAddableShape(),r.prototype.getResizeShape.call(this),this.getFoldIcon()])},t})(e_);var Md=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Ro=function(){return Ro=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ro.apply(this,arguments)};function r_(r){var t=(function(n){Md(o,n);function o(i,a){i.id||(i.id="Flow_".concat(Um()));var s=Ro(Ro(Ro({},{}),i.properties),{isDefaultFlow:!1});return i.properties=s,n.call(this,i,a)||this}return o.extendKey="SequenceFlowModel",o})(qo),e=(function(n){Md(o,n);function o(){return n!==null&&n.apply(this,arguments)||this}return o.prototype.getStartArrow=function(){var i=this.props.model,a=i.properties.isDefaultFlow;return a?ce("path",{refX:15,stroke:"#000000",strokeWidth:2,d:"M 20 5 10 -5 z"}):ce("path",{d:""})},o.extendKey="SequenceFlowEdge",o})(Qo);return{type:"bpmn:sequenceFlow",view:e,model:t}}r_();var Ad={width:40,height:40},Nd={width:40,height:40},Cd={width:100,height:80},Ma={width:100,height:80},Td={width:100,height:80},Pd={width:100,height:80},Dd={width:100,height:80},Rd={width:100,height:80},Ld={width:100,height:80},jd={width:100,height:80},kt=function(){};kt.ObjTree=function(){return this};kt.ObjTree.VERSION="0.23";kt.ObjTree.prototype.xmlDecl=`<?xml version="1.0" encoding="UTF-8" ?>
`;kt.ObjTree.prototype.attr_prefix="-";kt.ObjTree.prototype.parseXML=function(r){var t;if(window.DOMParser){var e=new DOMParser,n=e.parseFromString(r,"application/xml");if(!n)return;t=n.documentElement}else window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(r),t=e.documentElement);if(t){var o=this.parseDOM(t);return o}};kt.ObjTree.prototype.parseHTTP=function(r,t,e){var n={};for(var o in t)n[o]=t[o];if(n.method||(typeof n.postBody>"u"&&typeof n.postbody>"u"&&typeof n.parameters>"u"?n.method="get":n.method="post"),e){n.asynchronous=!0;var i=this,a=e,s=n.onComplete;n.onComplete=function(f){var d;f&&f.responseXML&&f.responseXML.documentElement&&(d=i.parseDOM(f.responseXML.documentElement)),a(d,f),s&&s(f)}}else n.asynchronous=!1;var l;if(typeof HTTP<"u"&&HTTP.Request){n.uri=r;var u=new HTTP.Request(n);u&&(l=u.transport)}else if(typeof Ajax<"u"&&Ajax.Request){var u=new Ajax.Request(r,n);u&&(l=u.transport)}if(e)return l;if(l&&l.responseXML&&l.responseXML.documentElement)return this.parseDOM(l.responseXML.documentElement)};kt.ObjTree.prototype.parseDOM=function(r){if(r){if(this.__force_array={},this.force_array)for(var t=0;t<this.force_array.length;t++)this.__force_array[this.force_array[t]]=1;var e=this.parseElement(r);if(this.__force_array[r.nodeName]&&(e=[e]),r.nodeType!==11){var n={};n[r.nodeName]=e,e=n}return e}};kt.ObjTree.prototype.parseElement=function(r){if(r.nodeType!==7){if(r.nodeType===3||r.nodeType===4||r.nodeType===8){var t=r.nodeValue.match(/[^\x00-\x20]/);return t==null?void 0:r.nodeValue}var e=null,n={};if(r.attributes&&r.attributes.length){e={};for(var o=0;o<r.attributes.length;o++){var i=r.attributes[o].nodeName;if(typeof i=="string"){var a=r.attributes[o].nodeValue;try{a=JSON.parse(r.attributes[o].nodeValue.replace(/'/g,'"'))}catch{a=r.attributes[o].nodeValue}a!=null&&(i=this.attr_prefix+i,typeof n[i]>"u"&&(n[i]=0),n[i]++,this.addNode(e,i,n[i],a))}}}if(r.childNodes&&r.childNodes.length){var s=!0;e&&(s=!1);for(var o=0;o<r.childNodes.length&&s;o++){var l=r.childNodes[o].nodeType;l===3||l===4||l===8||(s=!1)}if(s){e||(e="");for(var o=0;o<r.childNodes.length;o++)e+=r.childNodes[o].nodeValue}else{e||(e={});for(var o=0;o<r.childNodes.length;o++){var i=r.childNodes[o].nodeName;if(typeof i=="string"){var a=this.parseElement(r.childNodes[o]);a&&(typeof n[i]>"u"&&(n[i]=0),n[i]++,this.addNode(e,i,n[i],a))}}}}else e===null&&(e={});return e}};kt.ObjTree.prototype.addNode=function(r,t,e,n){this.__force_array[t]?(e===1&&(r[t]=[]),r[t][r[t].length]=n):e===1?r[t]=n:e===2?r[t]=[r[t],n]:r[t][r[t].length]=n};kt.ObjTree.prototype.writeXML=function(r){var t=this.hash_to_xml(null,r);return this.xmlDecl+t};kt.ObjTree.prototype.hash_to_xml=function(r,t){var e=[],n=[];for(var o in t)if(Io(t,o)){var i=t[o];o.charAt(0)!==this.attr_prefix?typeof i>"u"||i==null?e[e.length]="<".concat(o," />"):typeof i=="object"&&i.constructor===Array?e[e.length]=this.array_to_xml(o,i):typeof i=="object"?e[e.length]=this.hash_to_xml(o,i):e[e.length]=this.scalar_to_xml(o,i):n[n.length]=" ".concat(o.substring(1),'="').concat(this.xml_escape(i),'"')}var a=n.join(""),s=e.join("");return typeof r>"u"||r==null||(e.length>0?s.match(/\n/)?s="<".concat(r).concat(a,`>
`).concat(s,"</").concat(r,`>
`):s="<".concat(r).concat(a,">").concat(s,"</").concat(r,`>
`):s="<".concat(r).concat(a,` />
`)),s};kt.ObjTree.prototype.array_to_xml=function(r,t){for(var e=[],n=0;n<t.length;n++){var o=t[n];typeof o>"u"||o==null?e[e.length]="<".concat(r," />"):typeof o=="object"&&o.constructor===Array?e[e.length]=this.array_to_xml(r,o):typeof o=="object"?e[e.length]=this.hash_to_xml(r,o):e[e.length]=this.scalar_to_xml(r,o)}return e.join("")};kt.ObjTree.prototype.scalar_to_xml=function(r,t){return r==="#text"?this.xml_escape(t):"<".concat(r,">").concat(this.xml_escape(t),"</").concat(r,`>
`)};kt.ObjTree.prototype.xml_escape=function(r){return r.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"')};var n_=function(r){return new kt.ObjTree().parseXML(r)};function jc(r){return Object.prototype.toString.call(r)}function Id(r){return"  ".repeat(r)}function Aa(r){return jc(r)==="[object Object]"?Object.keys(r).reduce(function(t,e){var n=e;return e.charAt(0)==="-"&&(n=e.substring(1)),t[n]=Aa(r[e]),t},{}):Array.isArray(r)?r.map(function(t){return Aa(t)}):r}function o_(r){var t=r;try{typeof t!="string"&&(t=JSON.parse(r))}catch{t=JSON.stringify(Aa(r)).replace(/"/g,"'")}return t}var kd=`	
`;function Xi(r,t,e){var n=Id(e),o="",i=kd+n;if(t==="-json")return"";if(t==="#text")return i+r;if(t==="#cdata-section")return"".concat(i,"<![CDATA[").concat(r,"]]>");if(t==="#comment")return"".concat(i,"<!--").concat(r,"-->");if("".concat(t).charAt(0)==="-")return" ".concat(t.substring(1),'="').concat(o_(r),'"');if(Array.isArray(r))o+=r.map(function(u){return Xi(u,t,e+1)}).join("");else if(jc(r)==="[object Object]"){var a=Object.keys(r),s="",l=r["-json"]?kd+Id(e+1)+r["-json"]:"";o+="".concat(e===0?"":i,"<").concat(t),a.forEach(function(u){u.charAt(0)==="-"?s+=Xi(r[u],u,e+1):l+=Xi(r[u],u,e+1)}),o+=s+(l!==""?">".concat(l).concat(i,"</").concat(t,">"):" />")}else o+="".concat(i,"<").concat(t,">").concat(r.toString(),"</").concat(t,">");return o}function i_(r){var t="";for(var e in r)t+=Xi(r[e],e,0);return t}var a_=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),vl=function(){return vl=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},vl.apply(this,arguments)},Bd=function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(e[n[o]]=r[n[o]]);return e},kl=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Nt=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},ur=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},jt;(function(r){r.START="bpmn:startEvent",r.END="bpmn:endEvent",r.INTERMEDIATE_CATCH="bpmn:intermediateCatchEvent",r.INTERMEDIATE_THROW="bpmn:intermediateThrowEvent",r.BOUNDARY="bpmn:boundaryEvent",r.PARALLEL_GATEWAY="bpmn:parallelGateway",r.INCLUSIVE_GATEWAY="bpmn:inclusiveGateway",r.EXCLUSIVE_GATEWAY="bpmn:exclusiveGateway",r.USER="bpmn:userTask",r.SYSTEM="bpmn:serviceTask",r.FLOW="bpmn:sequenceFlow",r.SUBPROCESS="bpmn:subProcess"})(jt||(jt={}));var Ic=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef","-children"],s_=["properties","startPoint","endPoint","pointsList"],Na={in:[],out:["properties.panels","properties.nodeSize","properties.definitionId","properties.timerValue","properties.timerType","properties.definitionType","properties.parent","properties.isBoundaryEventTouchingTask"]},kc=function(r,t){var e=Object.keys(t||{});return e.forEach(function(n){if(r[n]){var o=t[n],i=o.in,a=o.out;i&&(r[n].in=i),a&&(r[n].out=a)}else r[n]=t[n]}),r},Zt={"bpmn:startEvent":{out:function(r){var t,e,n=r.properties;return((e=(t=Zt[n.definitionType])===null||t===void 0?void 0:t.out)===null||e===void 0?void 0:e.call(t,r))||{}}},"bpmn:intermediateCatchEvent":{out:function(r){var t,e,n=r.properties;return((e=(t=Zt[n.definitionType])===null||t===void 0?void 0:t.out)===null||e===void 0?void 0:e.call(t,r))||{}}},"bpmn:intermediateThrowEvent":{out:function(r){var t,e,n=r.properties;return((e=(t=Zt[n.definitionType])===null||t===void 0?void 0:t.out)===null||e===void 0?void 0:e.call(t,r))||{}}},"bpmn:boundaryEvent":{out:function(r){var t,e,n=r.properties;return((e=(t=Zt[n.definitionType])===null||t===void 0?void 0:t.out)===null||e===void 0?void 0:e.call(t,r))||{}}},"bpmn:sequenceFlow":{out:function(r){var t=r.properties,e=t.expressionType,n=t.condition;return n?e==="cdata"?{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression"><![CDATA[${'.concat(n,"}]]></bpmn:conditionExpression>")}:{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression">'.concat(n,"</bpmn:conditionExpression>")}:{json:""}}},"bpmn:timerEventDefinition":{out:function(r){var t=r.properties,e=t.timerType,n=t.timerValue,o=t.definitionId,i=function(){return"<bpmn:".concat(e,' xsi:type="bpmn:tFormalExpression">').concat(n,"</bpmn:").concat(e,">")};return{json:'<bpmn:timerEventDefinition id="'.concat(o,'"').concat(e&&n?">".concat(i(),"</bpmn:timerEventDefinition>"):"/>")}},in:function(r,t){var e,n,o,i,a=r,s=t["-id"],l="",u="";try{for(var f=kl(Object.keys(t)),d=f.next();!d.done;d=f.next()){var c=d.value;c.includes("bpmn:")&&(o=Nt(c.split(":"),2),l=o[1],u=(i=t[c])===null||i===void 0?void 0:i["#text"])}}catch(h){e={error:h}}finally{try{d&&!d.done&&(n=f.return)&&n.call(f)}finally{if(e)throw e.error}}return{"-definitionId":s,"-definitionType":a,"-timerType":l,"-timerValue":u}}},"bpmn:conditionExpression":{in:function(r,t){var e,n="",o="";return t["#cdata-section"]?(o="cdata",n=((e=/^\$\{(.*)\}$/g.exec(t["#cdata-section"]))===null||e===void 0?void 0:e[1])||""):t["#text"]&&(o="normal",n=t["#text"]),{"-condition":n,"-expressionType":o}}}};function l_(r){var t=r??{},e=t.retainedAttrsFields,n=t.excludeFields,o=t.transformer,i=new Set(ur(ur([],Nt(s_),!1),Nt(e||[]),!1)),a={in:new Set(ur(ur([],Nt(Na.in),!1),Nt((n==null?void 0:n.in)||[]),!1)),out:new Set(ur(ur([],Nt(Na.out),!1),Nt((n==null?void 0:n.out)||[]),!1))};return Zt=kc(Zt,o),function(s){var l=s.nodes,u=s.edges;function f(d,c){var h,p;if((d==null?void 0:d.flag)!==1){var v;if((v=Zt[d.type])&&v.out){var g=v.out(d),y=Object.keys(g);y.length>0&&y.forEach(function(j){d[j]=g[j]})}d!=null&&d.children&&(d.children=d.children.map(function(j){var q=l.find(function(ee){return ee.id===j})||u.find(function(ee){return ee.id===j});return q||{}}));var w={};if(typeof d=="string")return d;if(Array.isArray(d))return d.map(function(j){return f(j,"")}).filter(function(j){return j!=null});try{for(var M=kl(Object.entries(d)),C=M.next();!C.done;C=M.next()){var P=Nt(C.value,2),S=P[0],E=P[1];if((E==null?void 0:E.flag)===1)return;var T=[c,S].filter(function(j){return j}).join(".");a.out.has(T)||(typeof E!="object"?S.indexOf("-")===0||["#text","#cdata-section","#comment"].includes(S)?w[S]=E:w["-".concat(S)]=E:i.has(T)?w["-".concat(S)]=f(E,T):w[S]=f(E,T))}}catch(j){h={error:j}}finally{try{C&&!C.done&&(p=M.return)&&p.call(M)}finally{if(h)throw h.error}}return w}}return f(s,"")}}function Ca(r){var t,e,n={};try{for(var o=kl(Object.entries(r)),i=o.next();!i.done;i=o.next()){var a=Nt(i.value,2),s=a[0],l=a[1];s.indexOf("-")===0?n[s.substring(1)]=Aa(l):typeof l=="string"?n[s]=l:Object.prototype.toString.call(l)==="[object Object]"?n[s]=Ca(l):Array.isArray(l)?n[s]=l.map(function(u){return Ca(u)}):n[s]=l}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n}function u_(r,t,e){var n,o=new Map,i=l_(e)(t);i.nodes.forEach(function(s){var l=s["-id"],u=s["-type"],f=s.text,d=s.children,c=Bd(s,["-id","-type","text","children"]),h={"-id":l};f!=null&&f["-value"]&&(h["-name"]=f["-value"]),c["-json"]&&(h["-json"]=c["-json"]),c["-properties"]&&Object.assign(h,c["-properties"]),d&&(h.children=d),r[u]||(r[u]=[]),r[u].push(h),o.set(l,h)});var a=i.edges.map(function(s){var l=s["-id"],u=s["-sourceNodeId"],f=s["-targetNodeId"],d=s.text,c=Bd(s,["-id","-sourceNodeId","-targetNodeId","text"]),h=o.get(f);h["bpmn:incoming"]||(h["bpmn:incoming"]=[]),h["bpmn:incoming"].push(l);var p={"-id":l,"-sourceRef":u,"-targetRef":f};return d!=null&&d["-value"]&&(p["-name"]=d["-value"]),c["-json"]&&(p["-json"]=c["-json"]),c["-properties"]&&Object.assign(p,c["-properties"]),p});return t.edges.forEach(function(s){var l=s.sourceNodeId,u=s.id,f=o.get(l);f["bpmn:outgoing"]||(f["bpmn:outgoing"]=[]),f["bpmn:outgoing"].push(u)}),(n=r["bpmn:subProcess"])===null||n===void 0||n.forEach(function(s){var l={"bpmn:incoming":new Set,"bpmn:outgoing":new Set},u=[];s.children.forEach(function(v){var g,y=o.get(v["-id"]);["bpmn:incoming","bpmn:outgoing"].forEach(function(M){y[M]&&y[M].forEach(function(C){l[M].add(C)})});var w=(g=r[v["-type"]])===null||g===void 0?void 0:g.findIndex(function(M){return M["-id"]===v["-id"]});w>=0&&r[v["-type"]].splice(w,1),o.delete(v["-id"]),s[v["-type"]]||(s[v["-type"]]=[]),s[v["-type"]].push(y)});var f=l["bpmn:incoming"],d=l["bpmn:outgoing"];d.forEach(function(v){f.has(v)&&u.push(v)});for(var c=function(v){var g=a.findIndex(function(y){return y["-id"]===u[v]});g>=0?(s["bpmn:sequenceFlow"]||(s["bpmn:sequenceFlow"]=[]),s["bpmn:sequenceFlow"].push(a[g]),a.splice(g,1)):v++,h=v},h,p=0;p<u.length;)c(p),p=h;delete s.children}),r[jt.FLOW]=a,r}function d_(r,t){r["bpmndi:BPMNEdge"]=t.edges.map(function(e){var n,o=e.id,i=e.pointsList.map(function(s){var l=s.x,u=s.y;return{"-x":l,"-y":u}}),a={"-id":"".concat(o,"_di"),"-bpmnElement":o,"di:waypoint":i};return!((n=e.text)===null||n===void 0)&&n.value&&(a["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),a}),r["bpmndi:BPMNShape"]=t.nodes.map(function(e){var n,o=e.id,i=100,a=80,s=e.x,l=e.y,u=zt.shapeConfigMap.get(e.type);u&&(i=u.width,a=u.height),s-=i/2,l-=a/2;var f={"-id":"".concat(o,"_di"),"-bpmnElement":o,"dc:Bounds":{"-x":s,"-y":l,"-width":i,"-height":a}};return!((n=e.text)===null||n===void 0)&&n.value&&(f["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),f})}var f_=["bpmn:incoming","bpmn:outgoing"];function c_(r,t){var e=[],n=[],o=new Map,i=t??{},a=i.transformer,s=i.excludeFields,l={in:new Set(ur(ur([],Nt(Na.in),!1),Nt((s==null?void 0:s.in)||[]),!1)),out:new Set(ur(ur([],Nt(Na.out),!1),Nt((s==null?void 0:s.out)||[]),!1))};Zt=kc(Zt,a);var u=r["bpmn:definitions"];if(u){var f=u["bpmn:process"];(function(c,h){h.forEach(function(p){try{Object.keys(c).forEach(function(v){try{p(v)}catch(g){console.error(g)}})}catch(v){console.error(v)}})})(f,[function(c){function h(v){v["-children"]||(v["-children"]=[]),Object.keys(v).forEach(function(g){var y;g.indexOf("bpmn:")===0&&!f_.includes(g)&&(f[g]||(f[g]=[]),!Array.isArray(f[g])&&(f[g]=[f[g]]),Array.isArray(v[g])?(y=f[g]).push.apply(y,ur([],Nt(v[g]),!1)):f[g].push(v[g]),Array.isArray(v[g])?v[g].forEach(function(w){!g.includes("Flow")&&v["-children"].push(w["-id"])}):!g.includes("Flow")&&v["-children"].push(v[g]["-id"]),delete v[g])})}if(c==="bpmn:subProcess"){var p=f[c];Array.isArray(p)?p.forEach(function(v){c==="bpmn:subProcess"&&h(v)}):h(p)}},function(c){var h=function(v){Object.keys(v).forEach(function(g){var y,w;if(g.includes("bpmn:")){var M={};Zt[g]&&Zt[g].in?(M=(w=(y=Zt[g]).in)===null||w===void 0?void 0:w.call(y,g,nf.cloneDeep(v[g])),delete v[g]):p(v[g]);var C=void 0;(C=Reflect.ownKeys(M)).length>0&&C.forEach(function(P){Reflect.set(v,P,M[P])})}})};function p(v){o.set(v["-id"],v),Array.isArray(v)?v.forEach(function(g){p(g)}):typeof v=="object"&&h(v)}p(f[c])},function(c){if(c.indexOf("bpmn:")===0){var h=f[c];if(c==="bpmn:sequenceFlow"){var p=u["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];n=p_(h,p)}else{var v=u["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];if(c==="bpmn:boundaryEvent"){var g=f[c],y=function(w){var M=w["-attachedToRef"],C=o.get(M);C["-boundaryEvents"]||(C["-boundaryEvents"]=[]),C["-boundaryEvents"].push(w["-id"])};Array.isArray(g)?g.forEach(function(w){y(w)}):y(g)}e=e.concat(h_(h,v,c))}}}])}var d=function(c,h,p){Object.keys(c).forEach(function(v){var g=p?"".concat(p,".").concat(v):v;h.has(g)?delete c[v]:typeof c[v]=="object"&&d(c[v],h,g)})};return e.forEach(function(c){var h,p;if(!((h=t==null?void 0:t.mapping)===null||h===void 0)&&h.in){var v=(p=t==null?void 0:t.mapping)===null||p===void 0?void 0:p.in,g=c.type;v[g]&&(c.type=v[g])}d(c,l.in,"")}),n.forEach(function(c){var h,p;if(!((h=t==null?void 0:t.mapping)===null||h===void 0)&&h.in){var v=(p=t==null?void 0:t.mapping)===null||p===void 0?void 0:p.in,g=c.type;v[g]&&(c.type=v[g])}d(c,l.in,"")}),{nodes:e,edges:n}}function h_(r,t,e){var n=[];if(Array.isArray(r))r.forEach(function(a){var s;Array.isArray(t)?s=t.find(function(u){return u["-bpmnElement"]===a["-id"]}):s=t;var l=Xd(s,e,a);n.push(l)});else{var o=void 0;Array.isArray(t)?o=t.find(function(a){return a["-bpmnElement"]===r["-id"]}):o=t;var i=Xd(o,e,r);n.push(i)}return n}function Xd(r,t,e){var n=Number(r["dc:Bounds"]["-x"]),o=Number(r["dc:Bounds"]["-y"]),i=e["-children"],a=e["-name"],s=zt.shapeConfigMap.get(t);s&&(n+=s.width/2,o+=s.height/2);var l={};Object.entries(e).forEach(function(c){var h=Nt(c,2),p=h[0],v=h[1];Ic.includes(p)||(l[p]=v)}),l=Ca(l);var u;if(a&&(u={x:n,y:o,value:a},r["bpmndi:BPMNLabel"]&&r["bpmndi:BPMNLabel"]["dc:Bounds"])){var f=r["bpmndi:BPMNLabel"]["dc:Bounds"];u.x=Number(f["-x"])+Number(f["-width"])/2,u.y=Number(f["-y"])+Number(f["-height"])/2}var d={id:r["-bpmnElement"],type:t,x:n,y:o,properties:l};return i&&(d.children=i),u&&(d.text=u),d}function p_(r,t){var e=[];if(Array.isArray(r))r.forEach(function(o){var i;Array.isArray(t)?i=t.find(function(a){return a["-bpmnElement"]===o["-id"]}):i=t,e.push(Hd(i,o))});else{var n=void 0;Array.isArray(t)?n=t.find(function(o){return o["-bpmnElement"]===r["-id"]}):n=t,e.push(Hd(n,r))}return e}function Hd(r,t){var e,n=t["-name"]?"".concat(t["-name"]):"";if(n){var o=r["bpmndi:BPMNLabel"]["dc:Bounds"],i=0;n.split(`
`).forEach(function(u){i<u.length&&(i=u.length)}),e={value:n,x:Number(o["-x"])+i*10/2,y:Number(o["-y"])+7}}var a={};Object.entries(t).forEach(function(u){var f=Nt(u,2),d=f[0],c=f[1];Ic.includes(d)||(a[d]=c)}),a=Ca(a);var s=r["di:waypoint"].map(function(u){return{x:Number(u["-x"]),y:Number(u["-y"])}}),l={id:t["-id"],type:jt.FLOW,pointsList:s,sourceNodeId:t["-sourceRef"],targetNodeId:t["-targetRef"],properties:a};return e&&(l.text=e),l}var zt=(function(){function r(t){var e=t.lf,n=this;this.adapterOut=function(o,i){var a,s,l=vl({},n.processAttributes);u_(l,o,i);var u={"-id":"BPMNPlane_1","-bpmnElement":l["-id"]};d_(u,o);var f=n.definitionAttributes;f["bpmn:process"]=l,f["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":u};var d={"bpmn:definitions":f};if(!((a=i==null?void 0:i.mapping)===null||a===void 0)&&a.out){var c=(s=i==null?void 0:i.mapping)===null||s===void 0?void 0:s.out,h=function(p){Array.isArray(p)&&p.forEach(function(v){return h(v)}),typeof p=="object"&&Object.keys(p).forEach(function(v){var g;(g=c[v])?(p[g]=nf.cloneDeep(p[v]),delete p[v],h(p[g])):h(p[v])})};h(d)}return d},this.adapterIn=function(o,i){if(o)return c_(o,i)},e.adapterIn=this.adapterIn,e.adapterOut=this.adapterOut,this.processAttributes={"-isExecutable":"true","-id":"Process"},this.definitionAttributes={"-id":"Definitions","-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.10"}}return r.prototype.setCustomShape=function(t,e){r.shapeConfigMap.set(t,e)},r.pluginName="bpmn-adapter",r.shapeConfigMap=new Map,r})();zt.shapeConfigMap.set(jt.START,{width:Ad.width,height:Ad.height});zt.shapeConfigMap.set(jt.END,{width:Nd.width,height:Nd.height});zt.shapeConfigMap.set(jt.INTERMEDIATE_CATCH,{width:Ma.width,height:Ma.height});zt.shapeConfigMap.set(jt.INTERMEDIATE_THROW,{width:Ma.width,height:Ma.height});zt.shapeConfigMap.set(jt.BOUNDARY,{width:Cd.width,height:Cd.height});zt.shapeConfigMap.set(jt.PARALLEL_GATEWAY,{width:Td.width,height:Td.height});zt.shapeConfigMap.set(jt.INCLUSIVE_GATEWAY,{width:Pd.width,height:Pd.height});zt.shapeConfigMap.set(jt.EXCLUSIVE_GATEWAY,{width:Dd.width,height:Dd.height});zt.shapeConfigMap.set(jt.SYSTEM,{width:Rd.width,height:Rd.height});zt.shapeConfigMap.set(jt.USER,{width:Ld.width,height:Ld.height});zt.shapeConfigMap.set(jt.SUBPROCESS,{width:jd.width,height:jd.height});(function(r){a_(t,r);function t(e){var n=r.call(this,e)||this;n.adapterXmlIn=function(a){var s=n_(a);return n.adapterIn(s,n.props)},n.adapterXmlOut=function(a){var s=n.adapterOut(a,n.props);return i_(s)};var o=e.lf,i=e.props;return o.adapterIn=n.adapterXmlIn,o.adapterOut=n.adapterXmlOut,n.props=i,n}return t.pluginName="BPMNAdapter",t})(zt);function v_(r,t,e){var n=t.x,o=t.y,i=r.x,a=r.y,s=i-n,l=a-o,u=s*Math.cos(e)-l*Math.sin(e),f=s*Math.sin(e)+l*Math.cos(e),d=u+n,c=f+o;return{x:d,y:c}}var g_=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Ta=function(){return Ta=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ta.apply(this,arguments)},y_=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},m_=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},__=(function(r){g_(t,r);function t(){var e=r.apply(this,m_([],y_(arguments),!1))||this;return e.childrenPositionMap=new Map,e.onNodeRotate=function(n){var o=n.model,i=e.props,a=i.model,s=i.graphModel,l=a.transformWithContainer,u=a.isRestrict,f=e.childrenPositionMap;if(!(!l||u)&&o.id===a.id){var d={x:a.x,y:a.y};Oe(Array.from(a.children),function(c){var h=s.getNodeModelById(c);if(h){var p={x:h.x,y:h.y};f.has(h.id)?p=f.get(h.id):f.set(h.id,p);var v=o.rotate*(180/Math.PI);v<0&&(v+=360);var g=v*(Math.PI/180),y=v_(p,d,g);h.moveTo(y.x,y.y),h.rotate=o.rotate}})}},e.onNodeResize=function(n){var o=n.deltaX,i=n.deltaY,a=n.index,s=n.model,l=n.preData,u=e.props,f=u.model,d=u.graphModel,c=f.transformWithContainer,h=f.isRestrict;if(!(!c||h)&&s.id===f.id){var p=l.properties,v=p||{},g=v.width,y=v.height;Oe(Array.from(f.children),function(w){var M=d.getNodeModelById(w);if(M){var C=M.width/g*o,P=M.height/y*i;pc({deltaX:C,deltaY:P,index:a,nodeModel:M,graphModel:d,cancelCallback:function(){}})}})}},e.onNodeMouseMove=function(){},e.graphRendered=function(){var n=e.props.model;n.isCollapsed&&n.toggleCollapse(!0)},e}return t.prototype.componentDidMount=function(){r.prototype.componentDidMount.call(this);var e=this.props.graphModel.eventCenter;e.on("node:rotate",this.onNodeRotate),e.on("node:resize",this.onNodeResize),e.on("node:mousemove",this.onNodeMouseMove),e.on("graph:rendered",this.graphRendered)},t.prototype.componentWillUnmount=function(){r.prototype.componentWillUnmount.call(this);var e=this.props.graphModel.eventCenter;e.off("node:rotate",this.onNodeRotate),e.off("node:resize",this.onNodeResize),e.off("node:mousemove",this.onNodeMouseMove),e.off("graph:rendered",this.graphRendered)},t.prototype.getNodesInGroup=function(e,n){var o=this,i=[];return e.isGroup&&Oe(Array.from(e.children),function(a){i.push(a);var s=n.getNodeModelById(a);s!=null&&s.isGroup&&(i=i.concat(o.getNodesInGroup(s,n)))}),i},t.prototype.getResizeControl=function(){var e=this.props.model,n=e.resizable,o=e.isCollapsed,i=n&&!o;return i?r.prototype.getResizeControl.call(this):null},t.prototype.getAppendAreaShape=function(){var e=this.props.model,n=e.width,o=e.height,i=e.x,a=e.y,s=e.radius,l=e.groupAddable;if(!l)return null;var u=e.getNodeStyle().strokeWidth,f=u===void 0?0:u,d=e.getAddableOutlineStyle(),c=n+f+8,h=o+f+8;return ce("rect",Ta(Ta({},d),{width:c,height:h,x:i-c/2,y:a-h/2,rx:s,ry:s}))},t.prototype.getCollapseIcon=function(e,n){return"M ".concat(e+3,",").concat(n+6," ").concat(e+11,",").concat(n+6," M").concat(e+7,",").concat(n+2," ").concat(e+7,",").concat(n+10)},t.prototype.getExpandIcon=function(e,n){return"M ".concat(e+3,",").concat(n+6," ").concat(e+11,",").concat(n+6," ")},t.prototype.getOperateIcon=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=n-i/2+10,l=o-a/2+10;if(!e.collapsible)return null;var u=e!=null&&e.isCollapsed?this.getCollapseIcon(s,l):this.getExpandIcon(s,l),f=ce("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:u});return ce("g",{},[ce("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#f4f5f6",stroke:"#cecece",cursor:"pointer",x:s,y:l,onClick:function(){e.toggleCollapse(!e.isCollapsed)}}),f])},t.prototype.getShape=function(){return ce("g",{},[this.getAppendAreaShape(),r.prototype.getShape.call(this),this.getOperateIcon()])},t})(gn),x_=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Pa=function(){return Pa=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Pa.apply(this,arguments)},vs=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},An=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},vo=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},w_=400,E_=230,b_=80,S_=60,O_=-1e4,M_=(function(r){x_(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.isGroup=!0,o.isRestrict=!1,o.autoResize=!1,o.collapsible=!0,o.isCollapsed=!1,o.groupAddable=!1,o.transformWithContainer=!1,o.childrenLastCollapseStateDict=new Map,o.childrenLastCollapseStateDict=new Map,o.initNodeData(e),o.setAttributes(),o}return t.prototype.initNodeData=function(e){var n;r.prototype.initNodeData.call(this,e);var o=(n=e.properties)!==null&&n!==void 0?n:{},i=o.children,a=o.width,s=o.height,l=o.collapsedWidth,u=o.collapsedHeight,f=o.collapsible,d=o.isCollapsed,c=o.zIndex,h=o.isRestrict,p=o.autoResize,v=o.autoToFront,g=o.transformWithContainer;this.children=i?new Set(i):new Set,this.zIndex=c??O_,this.isCollapsed=d??!1,this.setProperties({isCollapsed:d??!1});var y=a??w_,w=s??E_;this.width=y,this.height=w,this.expandWidth=y,this.expandHeight=w,this.collapsedWidth=l??b_,this.collapsedHeight=u??S_,this.isRestrict=h??!1,this.transformWithContainer=g??!1,this.autoResize=p??!1,this.collapsible=f??!0,this.autoToFront=v??!1,this.text.editable=!1,this.text.draggable=!1},t.prototype.setAttributes=function(){r.prototype.setAttributes.call(this)},t.prototype.getData=function(){var e=this,n=r.prototype.getData.call(this),o=[];return Oe(Array.from(this.children),function(i){var a=e.graphModel.getNodeModelById(i);a&&!a.virtual&&o.push(i)}),n.children=o,n.properties&&(n.properties.children=o,n.properties.isCollapsed=this.isCollapsed),n},t.prototype.getNodesInGroup=function(e){var n=[];return e.isGroup&&Oe(Array.from(e.children),function(o){n.push(o)}),n},t.prototype.getMoveDistance=function(e,n,o){o===void 0&&(o=!1);var i=An(r.prototype.getMoveDistance.call(this,e,n,o),2),a=i[0],s=i[1],l=this.getNodesInGroup(this);return this.graphModel.moveNodes(l,e,n,o),[a,s]},t.prototype.getHistoryData=function(){var e=r.prototype.getHistoryData.call(this);e.children=Array.from(this.children),e.isGroup=!0;var n=this,o=n.x,i=n.y,a=n.collapsedWidth,s=n.collapsedHeight,l=n.expandWidth,u=n.expandHeight,f=n.isCollapsed;return f&&(e.x=o+l/2-a/2,e.y=i+u/2-s/2,e.text&&(e.text.x=e.text.x+l/2-a/2,e.text.y=e.text.y+u/2-s/2)),e},t.prototype.toggleCollapse=function(e){var n=this,o=this.graphModel,i=!!e;this.isCollapsed=i,this.setProperties({isCollapsed:i}),o.eventCenter.emit("dynamicGroup:collapse",{collapse:i,nodeModel:this}),i?this.collapse():this.expand();var a=vo(vo([],An(this.incoming.edges),!1),An(this.outgoing.edges),!1),s=Array.from(this.children);Oe(s,function(l){var u,f,d=n.graphModel.elementsModelMap.get(l);if(d){var c=d.isCollapsed;if(d.isGroup){var h=d;if(h.isCollapsed||h.toggleCollapse(e),!e){var p=(u=n.childrenLastCollapseStateDict)===null||u===void 0?void 0:u.get(l);p!==void 0&&p!==d.isCollapsed&&h.toggleCollapse(p)}}if((f=n.childrenLastCollapseStateDict)===null||f===void 0||f.set(l,!!c),d.visible=!e,d.BaseType===at.NODE){var v=d.incoming.edges,g=d.outgoing.edges;a=vo(vo(vo([],An(a),!1),An(v),!1),An(g),!1)}}}),this.collapseEdge(i,a)},t.prototype.collapse=function(){var e=this,n=e.x,o=e.y,i=e.text,a=e.width,s=e.height,l=e.collapsedWidth,u=e.collapsedHeight;this.x=n-a/2+l/2,this.y=o-s/2+u/2,this.text.x=i.x-a/2+l/2,this.text.y=i.y-s/2+u/2,this.expandWidth=a,this.expandHeight=s,this.width=l,this.height=u},t.prototype.expand=function(){var e=this,n=e.x,o=e.y,i=e.text,a=e.expandWidth,s=e.expandHeight,l=e.collapsedWidth,u=e.collapsedHeight;this.width=a,this.height=s,this.x=n+this.width/2-l/2,this.y=o+this.height/2-u/2,this.text.x=i.x+this.width/2-l/2,this.text.y=i.y+this.height/2-u/2},t.prototype.createVirtualEdge=function(e){e.pointsList=void 0;var n=this.graphModel.addEdge(e);n.virtual=!0,n.text.editable=!1,n.isCollapsedEdge=!0},t.prototype.collapseEdge=function(e,n){var o=this,i=this.graphModel;Oe(n,function(a,s){var l,u=a.getData(),f=u.targetNodeId,d=u.sourceNodeId,c=Pa(Pa({},u),{id:"".concat(u.id,"__").concat(s),text:(l=u.text)===null||l===void 0?void 0:l.value});a.virtual&&i.deleteEdgeById(a.id);var h=i.dynamicGroup.getGroupByNodeId(f);h||(h=i.getNodeModelById(f));var p=i.dynamicGroup.getGroupByNodeId(d);p||(p=i.getNodeModelById(d)),e&&a.visible&&(o.children.has(d)||o.id===d?(c.startPoint=void 0,c.sourceNodeId=o.id):(c.endPoint=void 0,c.targetNodeId=o.id),(h.id!==o.id||p.id!==o.id)&&o.createVirtualEdge(c),a.visible=!1),!e&&!a.visible&&(h&&h.isGroup&&h.isCollapsed?(c.targetNodeId=h.id,c.endPoint=void 0,o.createVirtualEdge(c)):p&&p.isGroup&&p.isCollapsed?(c.sourceNodeId=p.id,c.startPoint=void 0,o.createVirtualEdge(c)):a.visible=!0)})},t.prototype.isAllowAppendIn=function(e){return!0},t.prototype.setAllowAppendChild=function(e){this.groupAddable=e},t.prototype.addChild=function(e){this.children.add(e);var n=this.getData();this.graphModel.eventCenter.emit("group:add-node",{data:n,childId:e})},t.prototype.removeChild=function(e){this.children.delete(e);var n=this.getData();this.graphModel.eventCenter.emit("group:remove-node",{data:n})},t.prototype.toBack=function(){this.zIndex--},t.prototype.getResizeOutlineStyle=function(){var e=r.prototype.getResizeOutlineStyle.call(this);return e.stroke="none",e},t.prototype.getAnchorStyle=function(){var e=r.prototype.getAnchorStyle.call(this);return e.stroke="transparent",e.fill="transparent",e.hover&&(e.hover.fill="transparent",e.hover.stroke="transparent"),e},t.prototype.getAddableOutlineStyle=function(){return{stroke:"#feb663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},vs([I],t.prototype,"isCollapsed",void 0),vs([I],t.prototype,"groupAddable",void 0),vs([I],t.prototype,"transformWithContainer",void 0),t})(Zn);function A_(r,t){var e=r.minX,n=r.minY,o=r.maxX,i=r.maxY,a=t.x,s=t.y,l=t.width,u=t.height;return e>=a-l/2&&o<=a+l/2&&n>=s-u/2&&i<=s+u/2}function N_(r,t,e,n){var o=r.minX,i=r.minY,a=r.maxX,s=r.maxY,l=t.x,u=t.y,f=t.width,d=t.height,c=o+f/2,h=i+d/2,p=a-f/2,v=s-d/2;return{x:l+e>=c&&l+e<=p,y:u+n>=h&&u+n<=v}}var Da=function(){return Da=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Da.apply(this,arguments)},Nn=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Cn=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},C_={type:"dynamic-group",view:__,model:M_},T_=-1e3,Pi=-1e4,y0=(function(){function r(t){var e=t.lf,n=t.options,o=this;this.topGroupZIndex=Pi,this.nodeGroupMap=new Map,this.onSelectionDrop=function(){var i=o.lf.graphModel.getSelectElements().nodes;i.forEach(function(a){o.addNodeToGroup(a)})},this.onNodeAddOrDrop=function(i){var a=i.data;o.addNodeToGroup(a)},this.addNodeToGroup=function(i){var a=o.nodeGroupMap.get(i.id);if(a){var s=o.lf.getNodeModelById(a);s.removeChild(i.id),o.nodeGroupMap.delete(i.id),s.setAllowAppendChild(!1)}var l=o.lf.getNodeModelById(i.id),u=l==null?void 0:l.getBounds();if(l&&u){if(l.isGroup){var f=l;Oe(Array.from(f.children),function(h){o.nodeGroupMap.set(h,i.id)}),o.calibrateTopGroupZIndex([i]),o.onNodeSelect({data:i,isSelected:!1,isMultiple:!1})}var s=o.getGroupByBounds(u,i);if(s){var d=s.isAllowAppendIn(i);d?(s.addChild(i.id),s.setAllowAppendChild(!1)):o.lf.emit("group:not-allowed",{group:s.getData(),node:i})}}},this.onGroupAddNode=function(i){var a=i.data,s=i.childId;o.nodeGroupMap.set(s,a.id)},this.removeNodeFromGroup=function(i){var a=i.data,s=i.model;s.isGroup&&a.children&&Oe(Array.from(a.children),function(f){o.nodeGroupMap.delete(f),o.lf.deleteNode(f)});var l=o.nodeGroupMap.get(a.id);if(l){var u=o.lf.getNodeModelById(l);u&&u.removeChild(a.id),o.nodeGroupMap.delete(a.id)}},this.onSelectionDrag=function(){var i=o.lf.graphModel.getSelectElements().nodes;i.forEach(function(a){o.setActiveGroup(a)})},this.onNodeDrag=function(i){var a=i.data;o.setActiveGroup(a)},this.setActiveGroup=function(i){var a=o.lf.getNodeModelById(i.id),s=a==null?void 0:a.getBounds();if(a&&s){var l=o.getGroupByBounds(s,i);if(o.activeGroup&&o.activeGroup.setAllowAppendChild(!1),!l||a.isGroup&&l.id===i.id)return;var u=l.isAllowAppendIn(i);if(!u)return;o.activeGroup=l,o.activeGroup.setAllowAppendChild(!0)}},this.onNodeSelect=function(i){var a=i.data,s=i.isMultiple,l=i.isSelected,u=o.lf.getNodeModelById(a.id);if(o.sendNodeToFront(u),o.topGroupZIndex>T_){var f=o.lf.graphModel.nodes;o.topGroupZIndex=Pi;var d=Jc(li(f,function(g){return!!g.isGroup}),"zIndex"),c=0;Oe(d,function(g){g.zIndex!==c&&(o.topGroupZIndex++,c=g.zIndex),g.setZIndex(o.topGroupZIndex)})}if(s&&l)if(u!=null&&u.isGroup){var h=u.children;Oe(Array.from(h),function(g){var y=o.lf.getNodeModelById(g);y==null||y.setSelected(!1)})}else{var p=o.nodeGroupMap.get(a.id);if(p){var v=o.lf.getNodeModelById(p);v!=null&&v.isSelected&&(u==null||u.setSelected(!1))}}},this.onNodeMove=function(i){var a=i.deltaX,s=i.deltaY,l=i.data,u=l.id,f=l.x,d=l.y,c=l.properties;if(c){var h=c.width,p=c.height,v=o.nodeGroupMap.get(u);if(v){var g=o.lf.getNodeModelById(v);if(!(!g||!g.isRestrict||!g.autoResize)){var y=f+a/2,w=d+s/2,M=y-h/2,C=w-p/2,P=y+h/2,S=w+p/2,E=!1,T=g.getBounds(),j=Object.assign({},T);if(M<j.minX&&(j.minX=M,E=!0),C<j.minY&&(j.minY=C,E=!0),P>j.maxX&&(j.maxX=P,E=!0),S>j.maxY&&(j.maxY=S,E=!0),!!E){var q=j.minX+(j.maxX-j.minX)/2,ee=j.minY+(j.maxY-j.minY)/2,he=j.maxX-j.minX,ke=j.maxY-j.minY;g.moveTo(q,ee),g.width=he,g.height=ke}}}}},this.onGraphRendered=function(i){var a=i.data;Oe(a.nodes,function(s){s.children&&Oe(s.children,function(l){o.nodeGroupMap.set(l,s.id)})}),o.calibrateTopGroupZIndex(a.nodes)},e.register(C_),this.lf=e,Fe(this,n),this.init()}return r.prototype.getGroupByNodeId=function(t){var e=this.nodeGroupMap.get(t);if(e)return this.lf.getNodeModelById(e)},r.prototype.getGroupByBounds=function(t,e){var n=this.lf.graphModel.nodes,o=li(n,function(l){return!!l.isGroup&&A_(t,l)&&l.id!==e.id}),i=o.length;if(i<=1)return o[0];for(var a=o[i-1],s=i-2;s>=0;s--)o[s].zIndex>a.zIndex&&(a=o[s]);return a},r.prototype.sendNodeToFront=function(t){var e=this;if(!(!t||!t.isGroup)&&(this.topGroupZIndex++,t.setZIndex(this.topGroupZIndex),t.children)){var n=t.children;Oe(Array.from(n),function(o){var i=e.lf.getNodeModelById(o);e.sendNodeToFront(i)})}},r.prototype.getMaxZIndex=function(t){var e=this,n=Pi;if(t.isGroup&&(n=Math.max(n,t.zIndex)),t.children){var o=t.children;Oe(Array.from(o),function(i){var a=e.lf.getNodeModelById(i);if(a!=null&&a.isGroup){var s=e.getMaxZIndex(a);n=Math.max(n,s)}})}return n},r.prototype.calibrateTopGroupZIndex=function(t){var e=this,n=Pi;if(Oe(t,function(s){var l=e.lf.getNodeModelById(s.id);if(l){var u=e.getMaxZIndex(l);u>n&&(n=u)}}),!(this.topGroupZIndex>=n)){var o=this.lf.graphModel.nodes,i=li(o,function(s){return!!s.isGroup}),a=this.topGroupZIndex;Oe(i,function(s){s.zIndex>a&&(a=s.zIndex)}),this.topGroupZIndex=a}},r.prototype.removeChildrenInGroupNodeData=function(t){var e,n=xe(t);return delete n.children,!((e=n.properties)===null||e===void 0)&&e.children&&delete n.properties.children,n},r.prototype.initGroupChildNodes=function(t,e,n,o){var i=this,a=[],s=[],l=[];Oe(Array.from(e),function(d){var c=i.lf.getNodeModelById(d);if(c){var h=c.children,p=c.getData(),v=ne.NODE_GROUP_COPY||"node:group-copy-add",g=Am(i.removeChildrenInGroupNodeData(p),o),y=i.lf.addNode(g,v);if(n.addChild(y.id),t[d]=y.id,a.push(y),l.push.apply(l,Cn([],Nn(Cn(Cn([],Nn(y.incoming.edges),!1),Nn(y.outgoing.edges),!1)),!1)),h instanceof Set){var w=i.initGroupChildNodes(t,h,y,o),M=w.childNodes,C=w.edgesData;a.push.apply(a,Cn([],Nn(M),!1)),s.push.apply(s,Cn([],Nn(C),!1))}}});var u=li(l,function(d){return Io(t,d.sourceNodeId)&&Io(t,d.targetNodeId)}),f=gr(u,function(d){return d.getData()});return{childNodes:a,edgesData:s.concat(f)}},r.prototype.createEdge=function(t,e,n){var o,i,a=t.sourceNodeId,s=t.targetNodeId,l=(o=e[a])!==null&&o!==void 0?o:a,u=(i=e[s])!==null&&i!==void 0?i:s,f=xe(t);return t.id&&typeof t.text=="object"&&t.text!==null&&(f=Nm(t,n)),this.lf.graphModel.addEdge(Da(Da({},f),{sourceNodeId:l,targetNodeId:u}))},r.prototype.checkGroupBoundsWithChildren=function(t,e,n,o,i){if(t.children)for(var a=t.children,s=t.x,l=t.y,u=s+e/2,f=l+n/2,d=u-o/2,c=f-i/2,h=u+o/2,p=f+i/2,v=Array.from(a),g=0;g<v.length;g++){var y=v[g],w=this.lf.getNodeModelById(y);if(w){var M=w.getBounds(),C=M.minX,P=M.minY,S=M.maxX,E=M.maxY,T=d<=C&&c<=P&&h>=S&&p>=E;if(!T)return!1}}return!0},r.prototype.init=function(){var t=this,e=this.lf,n=e.graphModel;n.addNodeMoveRules(function(o,i,a){if(o.isGroup)return!0;var s=t.nodeGroupMap.get(o.id),l=t.lf.getNodeModelById(s);if(l&&l.isRestrict){if(l.autoResize)return!0;var u=l.getBounds();return N_(u,o,i,a)}return!0}),n.addNodeResizeRules(function(o,i,a,s,l){return o.isGroup&&o.isRestrict?t.checkGroupBoundsWithChildren(o,i,a,s,l):!0}),n.dynamicGroup=this,e.on("node:add,node:drop,node:dnd-add",this.onNodeAddOrDrop),e.on("selection:drop",this.onSelectionDrop),e.on("node:delete",this.removeNodeFromGroup),e.on("node:drag,node:dnd-drag",this.onNodeDrag),e.on("selection:drag",this.onSelectionDrag),e.on("node:click",this.onNodeSelect),e.on("node:mousemove",this.onNodeMove),e.on("graph:rendered",this.onGraphRendered),e.on("group:add-node",this.onGroupAddNode),e.addElements=function(o,i){var a=o.nodes,s=o.edges;i===void 0&&(i=40);var l={},u={nodes:[],edges:[]},f=[];return Oe(a,function(d){var c,h,p=d.id,v=(h=(c=d.properties)===null||c===void 0?void 0:c.children)!==null&&h!==void 0?h:d.children,g=e.addNode(t.removeChildrenInGroupNodeData(d));if(p&&(l[p]=g.id),u.nodes.push(g),g.isGroup){var y=t.initGroupChildNodes(l,v,g,i).edgesData;f.push.apply(f,Cn([],Nn(y),!1))}}),Oe(f,function(d){t.createEdge(d,l,i)}),Oe(s,function(d){u.edges.push(t.createEdge(d,l,i))}),u},this.render()},r.prototype.render=function(){},r.prototype.destroy=function(){this.lf.off("node:add,node:drop,node:dnd-add",this.onNodeAddOrDrop),this.lf.off("selection:drop",this.onSelectionDrop),this.lf.off("node:delete",this.removeNodeFromGroup),this.lf.off("node:drag,node:dnd-drag",this.onNodeDrag),this.lf.off("selection:drag",this.onSelectionDrag),this.lf.off("node:click",this.onNodeSelect),this.lf.off("node:mousemove",this.onNodeMove),this.lf.off("graph:rendered",this.onGraphRendered),this.lf.off("group:add-node",this.onGroupAddNode)},r.pluginName="dynamicGroup",r})(),Gd;(function(r){r.HORIZONTAL="horizontal",r.VERTICAL="vertical"})(Gd||(Gd={}));var P_=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Lo=function(){return Lo=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Lo.apply(this,arguments)},D_=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},R_=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},L_=(function(r){P_(t,r);function t(e){var n=r.call(this,e)||this;n.textRef=ka(),n.setHoverOn=function(){var l=n.props.element;l.isDragging||n.state.isHovered||(n.setState({isHovered:!0}),l.setHovered(!0))},n.setHoverOff=function(){var l=n.props.element;n.state.isHovered&&(n.setState({isHovered:!1}),l.setHovered(!1))},n.handleMouseDown=function(l){var u,f=n.props,d=f.label,c=f.graphModel,h=c.editConfigModel.nodeTextDraggable;((u=d.draggable)!==null&&u!==void 0?u:h)&&!n.state.isDragging&&!n.state.isEditing&&n.stepDrag.handleMouseDown(l)},n.handleMouseUp=function(l){n.state.isDragging&&n.stepDrag.handleMouseUp(l)},n.handleDragging=function(l){var u=l.deltaX,f=l.deltaY;n.state.isDragging||n.setState({isDragging:!0});var d=n.props,c=d.label,h=d.graphModel,p=h.transformModel,v=R_(p.fixDeltaXY(u,f),2),g=v[0],y=v[1];n.setElementModelLabelInfo({x:c.x+g,y:c.y+y}),h.eventCenter.emit("label:drag",{data:c.getData(),model:c})},n.handleDragEnd=function(){n.setState({isDragging:!1})},n.handleClick=function(l){var u=n.props,f=u.label,d=u.element,c=u.graphModel;d.setSelected(!n.state.isSelected),n.setState({isSelected:!n.state.isSelected}),n.setElementModelLabelInfo({isSelected:!0}),c.eventCenter.emit("label:click",{data:f.getData(),e:l,model:d})},n.handleDbClick=function(l){var u=n.props,f=u.label,d=u.element,c=u.graphModel;if(c.eventCenter.emit("label:dblclick",{data:f.getData(),e:l,model:d}),!f.editable){d.setSelected(!0);return}if(d.setSelected(),d.setElementState(Xe.TEXT_EDIT),n.setState({isEditing:!0}),n.textRef.current){n.textRef.current.contentEditable="true",n.textRef.current.focus();var h=document.createRange(),p=window.getSelection();h.selectNodeContents(n.textRef.current),h.collapse(!1),p==null||p.removeAllRanges(),p==null||p.addRange(h)}},n.handleBlur=function(l){var u=n.props,f=u.label,d=u.element,c=u.graphModel.eventCenter;c.emit("label:blur",{e:l,model:d,data:f.getData(),element:n.textRef.current}),n.setState({isDragging:!1,isHovered:!1,isSelected:!1})},n.handleInput=function(l){var u=n.props,f=u.label,d=u.graphModel;d.eventCenter.emit("label:input",{e:l,data:f.getData()})},n.reCalcLabelSize=function(){};var o=e.label,i=e.graphModel,a=i.gridSize,s=i.eventCenter;return n.stepDrag=new rr({onDragging:n.handleDragging,onDragEnd:n.handleDragEnd,step:a,eventType:"LABEL",model:o,eventCenter:s}),n.state={isEditing:!1,isHovered:!1,isDragging:!1,isSelected:!1},n}return t.prototype.setElementModelLabelInfo=function(e){var n=this.props,o=n.label,i=n.element,a=n.graphModel,s=i.properties._label,l=s,u=Qc(l,function(c){return c.id===o.id}),f=l[u];l[u]=Lo(Lo({},f),e);var d=a.getElement(i.id);d==null||d.setProperty("_label",l)},t.prototype.componentDidMount=function(){var e=this,n=this.props,o=n.label,i=n.element,a=n.graphModel;a.eventCenter.on("blank:click,node:click,edge:click,label:click",function(s){var l,u,f,d,c=s.data;if(((c==null?void 0:c.type)!=="label"||c.type==="label"&&c.id!==o.id||e.state.isSelected)&&e.setState({isSelected:!1}),((c==null?void 0:c.type)!=="label"||c.type=="label"&&c.id!==o.id)&&e.state.isEditing){e.setState({isEditing:!1});var h=(u=(l=e.textRef.current)===null||l===void 0?void 0:l.innerText)!==null&&u!==void 0?u:"",p=(d=(f=e.textRef.current)===null||f===void 0?void 0:f.innerHTML)!==null&&d!==void 0?d:"";e.setElementModelLabelInfo({value:h,content:p,isSelected:!1}),i.setElementState(Xe.DEFAULT)}((c==null?void 0:c.type)!=="label"||c.type=="label"&&c.id!==o.id)&&e.textRef.current&&(e.textRef.current.contentEditable="false")})},t.prototype.componentDidUpdate=function(){},t.prototype.componentWillUnmount=function(){var e=this.props.graphModel;e.eventCenter.off("blank:click,node:click,edge:click")},t.prototype.render=function(){var e,n=this.props,o=n.label,i=n.element,a=n.graphModel,s=this.state,l=s.isDragging,u=s.isHovered,f=s.isSelected,d=s.isEditing,c=a.transformModel,h=c.getTransformStyle().transform,p=o.id,v=o.x,g=o.y,y=o.zIndex,w=o.vertical,M=o.style,C=o.rotate,P=o.content,S=o.labelWidth,E=o.textOverflowMode,T=S??(i.BaseType==="node"?i.width-20:80),j={left:"".concat(v-T/2,"px"),top:"".concat(g-10,"px"),width:"".concat(T,"px"),height:"20px",zIndex:y??1,transform:C?"".concat(h," rotate(").concat(C,"deg)"):"".concat(h," rotate(").concat(w?-.25:0,"turn)")};return k("div",{id:"element-container-".concat(p),className:Js("lf-label-editor-container"),style:j,onPointerDown:this.handleMouseDown,onPointerUp:this.handleMouseUp,onClick:this.handleClick,onDblClick:this.handleDbClick,onBlur:this.handleBlur,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,children:k("div",{ref:this.textRef,id:"editor-container-".concat(p),className:Js("lf-label-editor",(e={"lf-label-editor-dragging":l,"lf-label-editor-editing":d,"lf-label-editor-hover":!d&&(u||f)},e["lf-label-editor-".concat(E)]=!d,e)),onInput:this.handleInput,style:Lo({maxWidth:"".concat(T,"px"),boxSizing:"border-box",display:"inline-block",background:d||i.BaseType==="edge"?"#fff":"transparent"},M),dangerouslySetInnerHTML:{__html:P}})})},t=D_([Lt],t),t})(De),Kt=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},j_=Fr,I_=(function(){function r(t,e,n){var o;this.type="label",this.content="",this.value="",this.style={},this.vertical=!1,this.editable=!0,this.draggable=!0,this.textOverflowMode="default",this.element=e,this.graphModel=n,this.id=(o=t.id)!==null&&o!==void 0?o:j_(),this.initLabelData(t)}return r.prototype.initLabelData=function(t){Fe(this,t)},r.prototype.getData=function(){return{id:this.id,x:this.x,y:this.y,type:"label",content:this.content,value:this.value,rotate:this.rotate,style:lr(this.style),draggable:this.draggable,editable:this.editable,labelWidth:this.labelWidth,textOverflowMode:this.textOverflowMode,vertical:this.vertical}},Kt([I],r.prototype,"x",void 0),Kt([I],r.prototype,"y",void 0),Kt([I],r.prototype,"content",void 0),Kt([I],r.prototype,"value",void 0),Kt([I],r.prototype,"rotate",void 0),Kt([I],r.prototype,"style",void 0),Kt([I],r.prototype,"zIndex",void 0),Kt([I],r.prototype,"vertical",void 0),Kt([I],r.prototype,"editable",void 0),Kt([I],r.prototype,"draggable",void 0),Kt([I],r.prototype,"labelWidth",void 0),Kt([I],r.prototype,"textOverflowMode",void 0),r})();/*!
 * vanilla-picker v2.12.3
 * https://vanilla-picker.js.org
 *
 * Copyright 2017-2024 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
 * Released under the ISC license.
 */var Bl=function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")},Xl=(function(){function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}})(),Di=(function(){function r(t,e){var n=[],o=!0,i=!1,a=void 0;try{for(var s=t[Symbol.iterator](),l;!(o=(l=s.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(u){i=!0,a=u}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return n}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})();String.prototype.startsWith=String.prototype.startsWith||function(r){return this.indexOf(r)===0};String.prototype.padStart=String.prototype.padStart||function(r,t){for(var e=this;e.length<r;)e=t+e;return e};var k_={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function zd(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,e=t>0?r.toFixed(t).replace(/0+$/,"").replace(/\.$/,""):r.toString();return e||"0"}var B_=(function(){function r(t,e,n,o){Bl(this,r);var i=this;function a(l){if(l.startsWith("hsl")){var u=l.match(/([\-\d\.e]+)/g).map(Number),f=Di(u,4),d=f[0],c=f[1],h=f[2],p=f[3];p===void 0&&(p=1),d/=360,c/=100,h/=100,i.hsla=[d,c,h,p]}else if(l.startsWith("rgb")){var v=l.match(/([\-\d\.e]+)/g).map(Number),g=Di(v,4),y=g[0],w=g[1],M=g[2],C=g[3];C===void 0&&(C=1),i.rgba=[y,w,M,C]}else l.startsWith("#")?i.rgba=r.hexToRgb(l):i.rgba=r.nameToRgb(l)||r.hexToRgb(l)}if(t!==void 0)if(Array.isArray(t))this.rgba=t;else if(n===void 0){var s=t&&""+t;s&&a(s.toLowerCase())}else this.rgba=[t,e,n,o===void 0?1:o]}return Xl(r,[{key:"printRGB",value:function(e){var n=e?this.rgba:this.rgba.slice(0,3),o=n.map(function(i,a){return zd(i,a===3?3:0)});return e?"rgba("+o+")":"rgb("+o+")"}},{key:"printHSL",value:function(e){var n=[360,100,100,1],o=["","%","%",""],i=e?this.hsla:this.hsla.slice(0,3),a=i.map(function(s,l){return zd(s*n[l],l===3?3:1)+o[l]});return e?"hsla("+a+")":"hsl("+a+")"}},{key:"printHex",value:function(e){var n=this.hex;return e?n:n.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=r.hslToRgb(this._hsla)},set:function(e){e.length===3&&(e[3]=1),this._rgba=e,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=r.rgbToHsl(this._rgba)},set:function(e){e.length===3&&(e[3]=1),this._hsla=e,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){var e=this.rgba,n=e.map(function(o,i){return i<3?o.toString(16):Math.round(o*255).toString(16)});return"#"+n.map(function(o){return o.padStart(2,"0")}).join("")},set:function(e){this.rgba=r.hexToRgb(e)}}],[{key:"hexToRgb",value:function(e){var n=(e.startsWith("#")?e.slice(1):e).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!n.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+e);var o=n.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(i){return parseInt(i,16)});return o[3]=o[3]/255,o}},{key:"nameToRgb",value:function(e){var n=e.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),o=k_[n];return o===void 0?o:r.hexToRgb(o.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(e){var n=Di(e,4),o=n[0],i=n[1],a=n[2],s=n[3];o/=255,i/=255,a/=255;var l=Math.max(o,i,a),u=Math.min(o,i,a),f=void 0,d=void 0,c=(l+u)/2;if(l===u)f=d=0;else{var h=l-u;switch(d=c>.5?h/(2-l-u):h/(l+u),l){case o:f=(i-a)/h+(i<a?6:0);break;case i:f=(a-o)/h+2;break;case a:f=(o-i)/h+4;break}f/=6}return[f,d,c,s]}},{key:"hslToRgb",value:function(e){var n=Di(e,4),o=n[0],i=n[1],a=n[2],s=n[3],l=void 0,u=void 0,f=void 0;if(i===0)l=u=f=a;else{var d=function(g,y,w){return w<0&&(w+=1),w>1&&(w-=1),w<.16666666666666666?g+(y-g)*6*w:w<.5?y:w<.6666666666666666?g+(y-g)*(.6666666666666666-w)*6:g},c=a<.5?a*(1+i):a+i-a*i,h=2*a-c;l=d(h,c,o+1/3),u=d(h,c,o),f=d(h,c,o-1/3)}var p=[l*255,u*255,f*255].map(Math.round);return p[3]=s,p}}]),r})(),X_=(function(){function r(){Bl(this,r),this._events=[]}return Xl(r,[{key:"add",value:function(e,n,o){e.addEventListener(n,o,!1),this._events.push({target:e,type:n,handler:o})}},{key:"remove",value:function(e,n,o){this._events=this._events.filter(function(i){var a=!0;return e&&e!==i.target&&(a=!1),n&&n!==i.type&&(a=!1),o&&o!==i.handler&&(a=!1),a&&r._doRemove(i.target,i.type,i.handler),!a})}},{key:"destroy",value:function(){this._events.forEach(function(e){return r._doRemove(e.target,e.type,e.handler)}),this._events=[]}}],[{key:"_doRemove",value:function(e,n,o){e.removeEventListener(n,o,!1)}}]),r})();function H_(r){var t=document.createElement("div");return t.innerHTML=r,t.firstElementChild}function gs(r,t,e){var n=!1;function o(l,u,f){return Math.max(u,Math.min(l,f))}function i(l,u,f){if(f&&(n=!0),!!n){l.preventDefault();var d=t.getBoundingClientRect(),c=d.width,h=d.height,p=u.clientX,v=u.clientY,g=o(p-d.left,0,c),y=o(v-d.top,0,h);e(g/c,y/h)}}function a(l,u){var f=l.buttons===void 0?l.which:l.buttons;f===1?i(l,l,u):n=!1}function s(l,u){l.touches.length===1?i(l,l.touches[0],u):n=!1}r.add(t,"mousedown",function(l){a(l,!0)}),r.add(t,"touchstart",function(l){s(l,!0)}),r.add(window,"mousemove",a),r.add(t,"touchmove",s),r.add(window,"mouseup",function(l){n=!1}),r.add(t,"touchend",function(l){n=!1}),r.add(t,"touchcancel",function(l){n=!1})}var G_=`linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,
                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em`,z_=360,Bc="keydown",Ri="mousedown",ys="focusin";function xr(r,t){return(t||document).querySelector(r)}function Y_(r){r.preventDefault(),r.stopPropagation()}function ms(r,t,e,n,o){r.add(t,Bc,function(i){e.indexOf(i.key)>=0&&n(i)})}var Xc=(function(){function r(t){Bl(this,r),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new X_,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(t)}return Xl(r,[{key:"setOptions",value:function(e){var n=this;if(!e)return;var o=this.settings;function i(u,f,d){for(var c in u)f[c]=u[c]}if(e instanceof HTMLElement)o.parent=e;else{o.parent&&e.parent&&o.parent!==e.parent&&(this._events.remove(o.parent),this._popupInited=!1),i(e,o),e.onChange&&(this.onChange=e.onChange),e.onDone&&(this.onDone=e.onDone),e.onOpen&&(this.onOpen=e.onOpen),e.onClose&&(this.onClose=e.onClose);var a=e.color||e.colour;a&&this._setColor(a)}var s=o.parent;if(s&&o.popup&&!this._popupInited){var l=function(f){return n.openHandler(f)};this._events.add(s,"click",l),ms(this._events,s,[" ","Spacebar","Enter"],l),this._popupInited=!0}else e.parent&&!o.popup&&this.show()}},{key:"openHandler",value:function(e){if(this.show()){e&&e.preventDefault(),this.settings.parent.style.pointerEvents="none";var n=e&&e.type===Bc?this._domEdit:this.domElement;setTimeout(function(){return n.focus()},100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(e){var n=e&&e.type,o=!1;if(!e)o=!0;else if(n===Ri||n===ys){var i=(this.__containedEvent||0)+100;e.timeStamp>i&&(o=!0)}else Y_(e),o=!0;o&&this.hide()&&(this.settings.parent.style.pointerEvents="",n!==Ri&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(e,n){this.closeHandler(),this.setOptions(e),n&&this.openHandler()}},{key:"setColor",value:function(e,n){this._setColor(e,{silent:n})}},{key:"_setColor",value:function(e,n){if(typeof e=="string"&&(e=e.trim()),!!e){n=n||{};var o=void 0;try{o=new B_(e)}catch(a){if(n.failSilently)return;throw a}if(!this.settings.alpha){var i=o.hsla;i[3]=1,o.hsla=i}this.colour=this.color=o,this._setHSLA(null,null,null,null,n)}}},{key:"setColour",value:function(e,n){this.setColor(e,n)}},{key:"show",value:function(){var e=this.settings.parent;if(!e)return!1;if(this.domElement){var n=this._toggleDOM(!0);return this._setPosition(),n}var o=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',i=H_(o);return this.domElement=i,this._domH=xr(".picker_hue",i),this._domSL=xr(".picker_sl",i),this._domA=xr(".picker_alpha",i),this._domEdit=xr(".picker_editor input",i),this._domSample=xr(".picker_sample",i),this._domOkay=xr(".picker_done button",i),this._domCancel=xr(".picker_cancel button",i),i.classList.add("layout_"+this.settings.layout),this.settings.alpha||i.classList.add("no_alpha"),this.settings.editor||i.classList.add("no_editor"),this.settings.cancelButton||i.classList.add("no_cancel"),this._ifPopup(function(){return i.classList.add("popup")}),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var e=this,n=this,o=this.domElement,i=this._events;function a(u,f,d){i.add(u,f,d)}a(o,"click",function(u){return u.preventDefault()}),gs(i,this._domH,function(u,f){return n._setHSLA(u)}),gs(i,this._domSL,function(u,f){return n._setHSLA(null,u,1-f)}),this.settings.alpha&&gs(i,this._domA,function(u,f){return n._setHSLA(null,null,null,1-f)});var s=this._domEdit;a(s,"input",function(u){n._setColor(this.value,{fromEditor:!0,failSilently:!0})}),a(s,"focus",function(u){var f=this;f.selectionStart===f.selectionEnd&&f.select()}),this._ifPopup(function(){var u=function(c){return e.closeHandler(c)};a(window,Ri,u),a(window,ys,u),ms(i,o,["Esc","Escape"],u);var f=function(c){e.__containedEvent=c.timeStamp};a(o,Ri,f),a(o,ys,f),a(e._domCancel,"click",u)});var l=function(f){e._ifPopup(function(){return e.closeHandler(f)}),e.onDone&&e.onDone(e.colour)};a(this._domOkay,"click",l),ms(i,o,["Enter"],l)}},{key:"_setPosition",value:function(){var e=this.settings.parent,n=this.domElement;e!==n.parentNode&&e.appendChild(n),this._ifPopup(function(o){getComputedStyle(e).position==="static"&&(e.style.position="relative");var i=o===!0?"popup_right":"popup_"+o;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(a){a===i?n.classList.add(a):n.classList.remove(a)}),n.classList.add(i)})}},{key:"_setHSLA",value:function(e,n,o,i,a){a=a||{};var s=this.colour,l=s.hsla;[e,n,o,i].forEach(function(u,f){(u||u===0)&&(l[f]=u)}),s.hsla=l,this._updateUI(a),this.onChange&&!a.silent&&this.onChange(s)}},{key:"_updateUI",value:function(e){if(!this.domElement)return;e=e||{};var n=this.colour,o=n.hsla,i="hsl("+o[0]*z_+", 100%, 50%)",a=n.hslString,s=n.hslaString,l=this._domH,u=this._domSL,f=this._domA,d=xr(".picker_selector",l),c=xr(".picker_selector",u),h=xr(".picker_selector",f);function p(S,E,T){E.style.left=T*100+"%"}function v(S,E,T){E.style.top=T*100+"%"}p(l,d,o[0]),this._domSL.style.backgroundColor=this._domH.style.color=i,p(u,c,o[1]),v(u,c,1-o[2]),u.style.color=a,v(f,h,1-o[3]);var g=a,y=g.replace("hsl","hsla").replace(")",", 0)"),w="linear-gradient("+[g,y]+")";if(this._domA.style.background=w+", "+G_,!e.fromEditor){var M=this.settings.editorFormat,C=this.settings.alpha,P=void 0;switch(M){case"rgb":P=n.printRGB(C);break;case"hsl":P=n.printHSL(C);break;default:P=n.printHex(C)}this._domEdit.value=P}this._domSample.style.color=s}},{key:"_ifPopup",value:function(e,n){this.settings.parent&&this.settings.popup?e&&e(this.settings.popup):n&&n()}},{key:"_toggleDOM",value:function(e){var n=this.domElement;if(!n)return!1;var o=e?"":"none",i=n.style.display!==o;return i&&(n.style.display=o),i}}]),r})();{var _s=document.createElement("style");_s.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(_s),Xc.StyleElement=_s}var xs={exports:{}},Yd;function Hc(){return Yd||(Yd=1,(function(r,t){(function(e,n){r.exports=e()})(function(){var e="object",n="function",o="undefined",i=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],a=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],s=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],l=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function u(N,X){var G=typeof N[X];return G==n||!!(G==e&&N[X])||G=="unknown"}function f(N,X){return!!(typeof N[X]==e&&N[X])}function d(N,X){return typeof N[X]!=o}function c(N){return function(X,G){for(var V=G.length;V--;)if(!N(X,G[V]))return!1;return!0}}var h=c(u),p=c(f),v=c(d);function g(N){return N&&h(N,l)&&v(N,s)}function y(N){return f(N,"body")?N.body:N.getElementsByTagName("body")[0]}var w=[].forEach?function(N,X){N.forEach(X)}:function(N,X){for(var G=0,V=N.length;G<V;++G)X(N[G],G)},M={},C=typeof window!=o&&typeof document!=o,P={isHostMethod:u,isHostObject:f,isHostProperty:d,areHostMethods:h,areHostObjects:p,areHostProperties:v,isTextRange:g,getBody:y,forEach:w},S={version:"1.3.2",initialized:!1,isBrowser:C,supported:!0,util:P,features:{},modules:M,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==o?!0:rangyAutoInitialize}};function E(N){typeof console!=o&&u(console,"log")}function T(N,X){C&&X?alert(N):E(N)}function j(N){S.initialized=!0,S.supported=!1,T("Rangy is not supported in this environment. Reason: "+N,S.config.alertOnFail)}S.fail=j;function q(N){T("Rangy warning: "+N,S.config.alertOnWarn)}S.warn=q;var ee;({}).hasOwnProperty?(P.extend=ee=function(N,X,G){var V,J;for(var le in X)le==="__proto__"||le==="constructor"||le==="prototype"||X.hasOwnProperty(le)&&(V=N[le],J=X[le],G&&V!==null&&typeof V=="object"&&J!==null&&typeof J=="object"&&ee(V,J,!0),N[le]=J);return X.hasOwnProperty("toString")&&(N.toString=X.toString),N},P.createOptions=function(N,X){var G={};return ee(G,X),N&&ee(G,N),G}):j("hasOwnProperty not supported"),C||j("Rangy can only run in a browser"),(function(){var N;if(C){var X=document.createElement("div");X.appendChild(document.createElement("span"));var G=[].slice;try{G.call(X.childNodes,0)[0].nodeType==1&&(N=function(V){return G.call(V,0)})}catch{}}N||(N=function(V){for(var J=[],le=0,ve=V.length;le<ve;++le)J[le]=V[le];return J}),P.toArray=N})();var he;C&&(u(document,"addEventListener")?he=function(N,X,G){N.addEventListener(X,G,!1)}:u(document,"attachEvent")?he=function(N,X,G){N.attachEvent("on"+X,G)}:j("Document does not have required addEventListener or attachEvent method"),P.addListener=he);var ke=[];function be(N){return N.message||N.description||String(N)}function $e(){if(!(!C||S.initialized)){var N,X=!1,G=!1;u(document,"createRange")&&(N=document.createRange(),h(N,a)&&v(N,i)&&(X=!0));var V=y(document);if(!V||V.nodeName.toLowerCase()!="body"){j("No body element found");return}if(V&&u(V,"createTextRange")&&(N=V.createTextRange(),g(N)&&(G=!0)),!X&&!G){j("Neither Range nor TextRange are available");return}S.initialized=!0,S.features={implementsDomRange:X,implementsTextRange:G};var J,le;for(var ve in M)(J=M[ve])instanceof st&&J.init(J,S);for(var qe=0,it=ke.length;qe<it;++qe)try{ke[qe](S)}catch(ut){le="Rangy init listener threw an exception. Continuing. Detail: "+be(ut),E(le)}}}function rt(N,X,G){G&&(N+=" in module "+G.name),S.warn("DEPRECATED: "+N+" is deprecated. Please use "+X+" instead.")}function yt(N,X,G,V){N[X]=function(){return rt(X,G,V),N[G].apply(N,P.toArray(arguments))}}P.deprecationNotice=rt,P.createAliasForDeprecatedMethod=yt,S.init=$e,S.addInitListener=function(N){S.initialized?N(S):ke.push(N)};var pt=[];S.addShimListener=function(N){pt.push(N)};function ot(N){N=N||window,$e();for(var X=0,G=pt.length;X<G;++X)pt[X](N)}C&&(S.shim=S.createMissingNativeApi=ot,yt(S,"createMissingNativeApi","shim"));function st(N,X,G){this.name=N,this.dependencies=X,this.initialized=!1,this.supported=!1,this.initializer=G}st.prototype={init:function(){for(var N=this.dependencies||[],X=0,G=N.length,V,J;X<G;++X){if(J=N[X],V=M[J],!V||!(V instanceof st))throw new Error("required module '"+J+"' not found");if(V.init(),!V.supported)throw new Error("required module '"+J+"' not supported")}this.initializer(this)},fail:function(N){throw this.initialized=!0,this.supported=!1,new Error(N)},warn:function(N){S.warn("Module "+this.name+": "+N)},deprecationNotice:function(N,X){S.warn("DEPRECATED: "+N+" in module "+this.name+" is deprecated. Please use "+X+" instead")},createError:function(N){return new Error("Error in Rangy "+this.name+" module: "+N)}};function ge(N,X,G){var V=new st(N,X,function(J){if(!J.initialized){J.initialized=!0;try{G(S,J),J.supported=!0}catch(ve){var le="Module '"+N+"' failed to load: "+be(ve);E(le),ve.stack&&E(ve.stack)}}});return M[N]=V,V}S.createModule=function(N){var X,G;arguments.length==2?(X=arguments[1],G=[]):(X=arguments[2],G=arguments[1]);var V=ge(N,G,X);S.initialized&&S.supported&&V.init()},S.createCoreModule=function(N,X,G){ge(N,X,G)};function Re(){}S.RangePrototype=Re,S.rangePrototype=new Re;function Be(){}S.selectionPrototype=new Be,S.createCoreModule("DomUtil",[],function(N,X){var G="undefined",V=N.util,J=V.getBody;V.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||X.fail("document missing a Node creation method"),V.isHostMethod(document,"getElementsByTagName")||X.fail("document missing getElementsByTagName method");var le=document.createElement("div");V.areHostMethods(le,["insertBefore","appendChild","cloneNode"])||X.fail("Incomplete Element implementation"),V.isHostProperty(le,"innerHTML")||X.fail("Element is missing innerHTML property");var ve=document.createTextNode("test");V.areHostMethods(ve,["splitText","deleteData","insertData","appendData","cloneNode"])||X.fail("Incomplete Text Node implementation");var qe=function(B,Z){for(var Se=B.length;Se--;)if(B[Se]===Z)return!0;return!1};function it(B){var Z;return typeof B.namespaceURI==G||(Z=B.namespaceURI)===null||Z=="http://www.w3.org/1999/xhtml"}function ut(B){var Z=B.parentNode;return Z.nodeType==1?Z:null}function Ue(B){for(var Z=0;B=B.previousSibling;)++Z;return Z}function vt(B){switch(B.nodeType){case 7:case 10:return 0;case 3:case 8:return B.length;default:return B.childNodes.length}}function mt(B,Z){var Se=[],pe;for(pe=B;pe;pe=pe.parentNode)Se.push(pe);for(pe=Z;pe;pe=pe.parentNode)if(qe(Se,pe))return pe;return null}function x(B,Z,Se){for(var pe=Se?Z:Z.parentNode;pe;){if(pe===B)return!0;pe=pe.parentNode}return!1}function b(B,Z){return x(B,Z,!0)}function O(B,Z,Se){for(var pe,nt=Se?B:B.parentNode;nt;){if(pe=nt.parentNode,pe===Z)return nt;nt=pe}return null}function H(B){var Z=B.nodeType;return Z==3||Z==4||Z==8}function A(B){if(!B)return!1;var Z=B.nodeType;return Z==3||Z==8}function $(B,Z){var Se=Z.nextSibling,pe=Z.parentNode;return Se?pe.insertBefore(B,Se):pe.appendChild(B),B}function Y(B,Z,Se){var pe=B.cloneNode(!1);if(pe.deleteData(0,Z),B.deleteData(Z,B.length-Z),$(pe,B),Se)for(var nt=0,Ze;Ze=Se[nt++];)Ze.node==B&&Ze.offset>Z?(Ze.node=pe,Ze.offset-=Z):Ze.node==B.parentNode&&Ze.offset>Ue(B)&&++Ze.offset;return pe}function W(B){if(B.nodeType==9)return B;if(typeof B.ownerDocument!=G)return B.ownerDocument;if(typeof B.document!=G)return B.document;if(B.parentNode)return W(B.parentNode);throw X.createError("getDocument: no document found for node")}function ye(B){var Z=W(B);if(typeof Z.defaultView!=G)return Z.defaultView;if(typeof Z.parentWindow!=G)return Z.parentWindow;throw X.createError("Cannot get a window object for node")}function se(B){if(typeof B.contentDocument!=G)return B.contentDocument;if(typeof B.contentWindow!=G)return B.contentWindow.document;throw X.createError("getIframeDocument: No Document object found for iframe element")}function Q(B){if(typeof B.contentWindow!=G)return B.contentWindow;if(typeof B.contentDocument!=G)return B.contentDocument.defaultView;throw X.createError("getIframeWindow: No Window object found for iframe element")}function Ie(B){return B&&V.isHostMethod(B,"setTimeout")&&V.isHostObject(B,"document")}function Te(B,Z,Se){var pe;if(B?V.isHostProperty(B,"nodeType")?pe=B.nodeType==1&&B.tagName.toLowerCase()=="iframe"?se(B):W(B):Ie(B)&&(pe=B.document):pe=document,!pe)throw Z.createError(Se+"(): Parameter must be a Window object or DOM node");return pe}function Le(B){for(var Z;Z=B.parentNode;)B=Z;return B}function _t(B,Z,Se,pe){var nt,Ze,nr,Ft,Pt;if(B==Se)return Z===pe?0:Z<pe?-1:1;if(nt=O(Se,B,!0))return Z<=Ue(nt)?-1:1;if(nt=O(B,Se,!0))return Ue(nt)<pe?-1:1;if(Ze=mt(B,Se),!Ze)throw new Error("comparePoints error: nodes have no common ancestor");if(nr=B===Ze?Ze:O(B,Ze,!0),Ft=Se===Ze?Ze:O(Se,Ze,!0),nr===Ft)throw X.createError("comparePoints got to case 4 and childA and childB are the same!");for(Pt=Ze.firstChild;Pt;){if(Pt===nr)return-1;if(Pt===Ft)return 1;Pt=Pt.nextSibling}}var te=!1;function ue(B){var Z;try{return Z=B.parentNode,!1}catch{return!0}}(function(){var B=document.createElement("b");B.innerHTML="1";var Z=B.firstChild;B.innerHTML="<br />",te=ue(Z),N.features.crashyTextNodes=te})();function He(B){if(!B)return"[No node]";if(te&&ue(B))return"[Broken node]";if(H(B))return'"'+B.data+'"';if(B.nodeType==1){var Z=B.id?' id="'+B.id+'"':"";return"<"+B.nodeName+Z+">[index:"+Ue(B)+",length:"+B.childNodes.length+"]["+(B.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return B.nodeName}function Qe(B){for(var Z=W(B).createDocumentFragment(),Se;Se=B.firstChild;)Z.appendChild(Se);return Z}var dt;typeof window.getComputedStyle!=G?dt=function(B,Z){return ye(B).getComputedStyle(B,null)[Z]}:typeof document.documentElement.currentStyle!=G?dt=function(B,Z){return B.currentStyle?B.currentStyle[Z]:""}:X.fail("No means of obtaining computed style properties found");function Yt(B,Z,Se){var pe=J(B),nt=B.createElement("div");nt.contentEditable=""+!!Se,Z&&(nt.innerHTML=Z);var Ze=pe.firstChild;return Ze?pe.insertBefore(nt,Ze):pe.appendChild(nt),nt}function Tt(B){return B.parentNode.removeChild(B)}function xt(B){this.root=B,this._next=B}xt.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var B=this._current=this._next,Z,Se;if(this._current)if(Z=B.firstChild,Z)this._next=Z;else{for(Se=null;B!==this.root&&!(Se=B.nextSibling);)B=B.parentNode;this._next=Se}return this._current},detach:function(){this._current=this._next=this.root=null}};function wt(B){return new xt(B)}function Mt(B,Z){this.node=B,this.offset=Z}Mt.prototype={equals:function(B){return!!B&&this.node===B.node&&this.offset==B.offset},inspect:function(){return"[DomPosition("+He(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};function Bt(B){this.code=this[B],this.codeName=B,this.message="DOMException: "+this.codeName}Bt.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},Bt.prototype.toString=function(){return this.message},N.dom={arrayContains:qe,isHtmlNamespace:it,parentElement:ut,getNodeIndex:Ue,getNodeLength:vt,getCommonAncestor:mt,isAncestorOf:x,isOrIsAncestorOf:b,getClosestAncestorIn:O,isCharacterDataNode:H,isTextOrCommentNode:A,insertAfter:$,splitDataNode:Y,getDocument:W,getWindow:ye,getIframeWindow:Q,getIframeDocument:se,getBody:J,isWindow:Ie,getContentDocument:Te,getRootContainer:Le,comparePoints:_t,isBrokenNode:ue,inspectNode:He,getComputedStyleProperty:dt,createTestElement:Yt,removeNode:Tt,fragmentFromNodeChildren:Qe,createIterator:wt,DomPosition:Mt},N.DOMException=Bt}),S.createCoreModule("DomRange",["DomUtil"],function(N,X){var G=N.dom,V=N.util,J=G.DomPosition,le=N.DOMException,ve=G.isCharacterDataNode,qe=G.getNodeIndex,it=G.isOrIsAncestorOf,ut=G.getDocument,Ue=G.comparePoints,vt=G.splitDataNode,mt=G.getClosestAncestorIn,x=G.getNodeLength,b=G.arrayContains,O=G.getRootContainer,H=N.features.crashyTextNodes,A=G.removeNode;function $(_,D){return _.nodeType!=3&&(it(_,D.startContainer)||it(_,D.endContainer))}function Y(_){return _.document||ut(_.startContainer)}function W(_){return O(_.startContainer)}function ye(_){return new J(_.parentNode,qe(_))}function se(_){return new J(_.parentNode,qe(_)+1)}function Q(_,D,z){var K=_.nodeType==11?_.firstChild:_;return ve(D)?z==D.length?G.insertAfter(_,D):D.parentNode.insertBefore(_,z==0?D:vt(D,z)):z>=D.childNodes.length?D.appendChild(_):D.insertBefore(_,D.childNodes[z]),K}function Ie(_,D,z){if(Je(_),Je(D),Y(D)!=Y(_))throw new le("WRONG_DOCUMENT_ERR");var K=Ue(_.startContainer,_.startOffset,D.endContainer,D.endOffset),de=Ue(_.endContainer,_.endOffset,D.startContainer,D.startOffset);return z?K<=0&&de>=0:K<0&&de>0}function Te(_){for(var D,z,K=Y(_.range).createDocumentFragment(),de;z=_.next();){if(D=_.isPartiallySelectedSubtree(),z=z.cloneNode(!D),D&&(de=_.getSubtreeIterator(),z.appendChild(Te(de)),de.detach()),z.nodeType==10)throw new le("HIERARCHY_REQUEST_ERR");K.appendChild(z)}return K}function Le(_,D,z){var K,de;z=z||{stop:!1};for(var je,U;je=_.next();)if(_.isPartiallySelectedSubtree()){if(D(je)===!1){z.stop=!0;return}else if(U=_.getSubtreeIterator(),Le(U,D,z),U.detach(),z.stop)return}else for(K=G.createIterator(je);de=K.next();)if(D(de)===!1){z.stop=!0;return}}function _t(_){for(var D;_.next();)_.isPartiallySelectedSubtree()?(D=_.getSubtreeIterator(),_t(D),D.detach()):_.remove()}function te(_){for(var D,z=Y(_.range).createDocumentFragment(),K;D=_.next();){if(_.isPartiallySelectedSubtree()?(D=D.cloneNode(!1),K=_.getSubtreeIterator(),D.appendChild(te(K)),K.detach()):_.remove(),D.nodeType==10)throw new le("HIERARCHY_REQUEST_ERR");z.appendChild(D)}return z}function ue(_,D,z){var K=!!(D&&D.length),de,je=!!z;K&&(de=new RegExp("^("+D.join("|")+")$"));var U=[];return Le(new Qe(_,!1),function(ae){if(!(K&&!de.test(ae.nodeType))&&!(je&&!z(ae))){var me=_.startContainer;if(!(ae==me&&ve(me)&&_.startOffset==me.length)){var Pe=_.endContainer;ae==Pe&&ve(Pe)&&_.endOffset==0||U.push(ae)}}}),U}function He(_){var D=typeof _.getName>"u"?"Range":_.getName();return"["+D+"("+G.inspectNode(_.startContainer)+":"+_.startOffset+", "+G.inspectNode(_.endContainer)+":"+_.endOffset+")]"}function Qe(_,D){if(this.range=_,this.clonePartiallySelectedTextNodes=D,!_.collapsed){this.sc=_.startContainer,this.so=_.startOffset,this.ec=_.endContainer,this.eo=_.endOffset;var z=_.commonAncestorContainer;this.sc===this.ec&&ve(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===z&&!ve(this.sc)?this.sc.childNodes[this.so]:mt(this.sc,z,!0),this._last=this.ec===z&&!ve(this.ec)?this.ec.childNodes[this.eo-1]:mt(this.ec,z,!0))}}Qe.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var _=this._current=this._next;return _&&(this._next=_!==this._last?_.nextSibling:null,ve(_)&&this.clonePartiallySelectedTextNodes&&(_===this.ec&&(_=_.cloneNode(!0)).deleteData(this.eo,_.length-this.eo),this._current===this.sc&&(_=_.cloneNode(!0)).deleteData(0,this.so))),_},remove:function(){var _=this._current,D,z;ve(_)&&(_===this.sc||_===this.ec)?(D=_===this.sc?this.so:0,z=_===this.ec?this.eo:_.length,D!=z&&_.deleteData(D,z-D)):_.parentNode&&A(_)},isPartiallySelectedSubtree:function(){var _=this._current;return $(_,this.range)},getSubtreeIterator:function(){var _;if(this.isSingleCharacterDataNode)_=this.range.cloneRange(),_.collapse(!1);else{_=new ft(Y(this.range));var D=this._current,z=D,K=0,de=D,je=x(D);it(D,this.sc)&&(z=this.sc,K=this.so),it(D,this.ec)&&(de=this.ec,je=this.eo),Ge(_,z,K,de,je)}return new Qe(_,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var dt=[1,3,4,5,7,8,10],Yt=[2,9,11],Tt=[5,6,10,12],xt=[1,3,4,5,7,8,10,11],wt=[1,3,4,5,7,8];function Mt(_){return function(D,z){for(var K,de=z?D:D.parentNode;de;){if(K=de.nodeType,b(_,K))return de;de=de.parentNode}return null}}var Bt=Mt([9,11]),B=Mt(Tt),Z=Mt([6,10,12]),Se=Mt([1]);function pe(_,D){if(Z(_,D))throw new le("INVALID_NODE_TYPE_ERR")}function nt(_,D){if(!b(D,_.nodeType))throw new le("INVALID_NODE_TYPE_ERR")}function Ze(_,D){if(D<0||D>(ve(_)?_.length:_.childNodes.length))throw new le("INDEX_SIZE_ERR")}function nr(_,D){if(Bt(_,!0)!==Bt(D,!0))throw new le("WRONG_DOCUMENT_ERR")}function Ft(_){if(B(_,!0))throw new le("NO_MODIFICATION_ALLOWED_ERR")}function Pt(_,D){if(!_)throw new le(D)}function ao(_,D){return D<=(ve(_)?_.length:_.childNodes.length)}function qr(_){return!!_.startContainer&&!!_.endContainer&&!(H&&(G.isBrokenNode(_.startContainer)||G.isBrokenNode(_.endContainer)))&&O(_.startContainer)==O(_.endContainer)&&ao(_.startContainer,_.startOffset)&&ao(_.endContainer,_.endOffset)}function Je(_){if(!qr(_))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+_.inspect()+")")}var so=document.createElement("style"),Tr=!1;try{so.innerHTML="<b>x</b>",Tr=so.firstChild.nodeType==3}catch{}N.features.htmlParsingConforms=Tr;var lo=Tr?function(_){var D=this.startContainer,z=ut(D);if(!D)throw new le("INVALID_STATE_ERR");var K=null;return D.nodeType==1?K=D:ve(D)&&(K=G.parentElement(D)),K===null||K.nodeName=="HTML"&&G.isHtmlNamespace(ut(K).documentElement)&&G.isHtmlNamespace(K)?K=z.createElement("body"):K=K.cloneNode(!1),K.innerHTML=_,G.fragmentFromNodeChildren(K)}:function(_){var D=Y(this),z=D.createElement("body");return z.innerHTML=_,G.fragmentFromNodeChildren(z)};function yn(_,D){Je(_);var z=_.startContainer,K=_.startOffset,de=_.endContainer,je=_.endOffset,U=z===de;ve(de)&&je>0&&je<de.length&&vt(de,je,D),ve(z)&&K>0&&K<z.length&&(z=vt(z,K,D),U?(je-=K,de=z):de==z.parentNode&&je>=qe(z)&&je++,K=0),_.setStartAndEnd(z,K,de,je)}function Me(_){Je(_);var D=_.commonAncestorContainer.parentNode.cloneNode(!1);return D.appendChild(_.cloneContents()),D.innerHTML}var mn=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],_n=0,Jr=1,si=2,jr=3,Qr=0,uo=1,fo=2,xn=3;V.extend(N.rangePrototype,{compareBoundaryPoints:function(_,D){Je(this),nr(this.startContainer,D.startContainer);var z,K,de,je,U=_==jr||_==_n?"start":"end",ae=_==Jr||_==_n?"start":"end";return z=this[U+"Container"],K=this[U+"Offset"],de=D[ae+"Container"],je=D[ae+"Offset"],Ue(z,K,de,je)},insertNode:function(_){if(Je(this),nt(_,xt),Ft(this.startContainer),it(_,this.startContainer))throw new le("HIERARCHY_REQUEST_ERR");var D=Q(_,this.startContainer,this.startOffset);this.setStartBefore(D)},cloneContents:function(){Je(this);var _,D;if(this.collapsed)return Y(this).createDocumentFragment();if(this.startContainer===this.endContainer&&ve(this.startContainer))return _=this.startContainer.cloneNode(!0),_.data=_.data.slice(this.startOffset,this.endOffset),D=Y(this).createDocumentFragment(),D.appendChild(_),D;var z=new Qe(this,!0);return _=Te(z),z.detach(),_},canSurroundContents:function(){Je(this),Ft(this.startContainer),Ft(this.endContainer);var _=new Qe(this,!0),D=_._first&&$(_._first,this)||_._last&&$(_._last,this);return _.detach(),!D},surroundContents:function(_){if(nt(_,wt),!this.canSurroundContents())throw new le("INVALID_STATE_ERR");var D=this.extractContents();if(_.hasChildNodes())for(;_.lastChild;)_.removeChild(_.lastChild);Q(_,this.startContainer,this.startOffset),_.appendChild(D),this.selectNode(_)},cloneRange:function(){Je(this);for(var _=new ft(Y(this)),D=mn.length,z;D--;)z=mn[D],_[z]=this[z];return _},toString:function(){Je(this);var _=this.startContainer;if(_===this.endContainer&&ve(_))return _.nodeType==3||_.nodeType==4?_.data.slice(this.startOffset,this.endOffset):"";var D=[],z=new Qe(this,!0);return Le(z,function(K){(K.nodeType==3||K.nodeType==4)&&D.push(K.data)}),z.detach(),D.join("")},compareNode:function(_){Je(this);var D=_.parentNode,z=qe(_);if(!D)throw new le("NOT_FOUND_ERR");var K=this.comparePoint(D,z),de=this.comparePoint(D,z+1);return K<0?de>0?fo:Qr:de>0?uo:xn},comparePoint:function(_,D){return Je(this),Pt(_,"HIERARCHY_REQUEST_ERR"),nr(_,this.startContainer),Ue(_,D,this.startContainer,this.startOffset)<0?-1:Ue(_,D,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:lo,toHtml:function(){return Me(this)},intersectsNode:function(_,D){if(Je(this),O(_)!=W(this))return!1;var z=_.parentNode,K=qe(_);if(!z)return!0;var de=Ue(z,K,this.endContainer,this.endOffset),je=Ue(z,K+1,this.startContainer,this.startOffset);return D?de<=0&&je>=0:de<0&&je>0},isPointInRange:function(_,D){return Je(this),Pt(_,"HIERARCHY_REQUEST_ERR"),nr(_,this.startContainer),Ue(_,D,this.startContainer,this.startOffset)>=0&&Ue(_,D,this.endContainer,this.endOffset)<=0},intersectsRange:function(_){return Ie(this,_,!1)},intersectsOrTouchesRange:function(_){return Ie(this,_,!0)},intersection:function(_){if(this.intersectsRange(_)){var D=Ue(this.startContainer,this.startOffset,_.startContainer,_.startOffset),z=Ue(this.endContainer,this.endOffset,_.endContainer,_.endOffset),K=this.cloneRange();return D==-1&&K.setStart(_.startContainer,_.startOffset),z==1&&K.setEnd(_.endContainer,_.endOffset),K}return null},union:function(_){if(this.intersectsOrTouchesRange(_)){var D=this.cloneRange();return Ue(_.startContainer,_.startOffset,this.startContainer,this.startOffset)==-1&&D.setStart(_.startContainer,_.startOffset),Ue(_.endContainer,_.endOffset,this.endContainer,this.endOffset)==1&&D.setEnd(_.endContainer,_.endOffset),D}else throw new le("Ranges do not intersect")},containsNode:function(_,D){return D?this.intersectsNode(_,!1):this.compareNode(_)==xn},containsNodeContents:function(_){return this.comparePoint(_,0)>=0&&this.comparePoint(_,x(_))<=0},containsRange:function(_){var D=this.intersection(_);return D!==null&&_.equals(D)},containsNodeText:function(_){var D=this.cloneRange();D.selectNode(_);var z=D.getNodes([3]);if(z.length>0){D.setStart(z[0],0);var K=z.pop();return D.setEnd(K,K.length),this.containsRange(D)}else return this.containsNodeContents(_)},getNodes:function(_,D){return Je(this),ue(this,_,D)},getDocument:function(){return Y(this)},collapseBefore:function(_){this.setEndBefore(_),this.collapse(!1)},collapseAfter:function(_){this.setStartAfter(_),this.collapse(!0)},getBookmark:function(_){var D=Y(this),z=N.createRange(D);_=_||G.getBody(D),z.selectNodeContents(_);var K=this.intersection(z),de=0,je=0;return K&&(z.setEnd(K.startContainer,K.startOffset),de=z.toString().length,je=de+K.toString().length),{start:de,end:je,containerNode:_}},moveToBookmark:function(_){var D=_.containerNode,z=0;this.setStart(D,0),this.collapse(!0);for(var K=[D],de,je=!1,U=!1,ae,me,Pe;!U&&(de=K.pop());)if(de.nodeType==3)ae=z+de.length,!je&&_.start>=z&&_.start<=ae&&(this.setStart(de,_.start-z),je=!0),je&&_.end>=z&&_.end<=ae&&(this.setEnd(de,_.end-z),U=!0),z=ae;else for(Pe=de.childNodes,me=Pe.length;me--;)K.push(Pe[me])},getName:function(){return"DomRange"},equals:function(_){return ft.rangesEqual(this,_)},isValid:function(){return qr(this)},inspect:function(){return He(this)},detach:function(){}});function m(_){_.START_TO_START=_n,_.START_TO_END=Jr,_.END_TO_END=si,_.END_TO_START=jr,_.NODE_BEFORE=Qr,_.NODE_AFTER=uo,_.NODE_BEFORE_AND_AFTER=fo,_.NODE_INSIDE=xn}function R(_){m(_),m(_.prototype)}function F(_,D){return function(){Je(this);var z=this.startContainer,K=this.startOffset,de=this.commonAncestorContainer,je=new Qe(this,!0),U,ae;z!==de&&(U=mt(z,de,!0),ae=se(U),z=ae.node,K=ae.offset),Le(je,Ft),je.reset();var me=_(je);return je.detach(),D(this,z,K,z,K),me}}function re(_,D){function z(U,ae){return function(me){nt(me,dt),nt(O(me),Yt);var Pe=(U?ye:se)(me);(ae?K:de)(this,Pe.node,Pe.offset)}}function K(U,ae,me){var Pe=U.endContainer,Dt=U.endOffset;(ae!==U.startContainer||me!==U.startOffset)&&((O(ae)!=O(Pe)||Ue(ae,me,Pe,Dt)==1)&&(Pe=ae,Dt=me),D(U,ae,me,Pe,Dt))}function de(U,ae,me){var Pe=U.startContainer,Dt=U.startOffset;(ae!==U.endContainer||me!==U.endOffset)&&((O(ae)!=O(Pe)||Ue(ae,me,Pe,Dt)==-1)&&(Pe=ae,Dt=me),D(U,Pe,Dt,ae,me))}var je=function(){};je.prototype=N.rangePrototype,_.prototype=new je,V.extend(_.prototype,{setStart:function(U,ae){pe(U,!0),Ze(U,ae),K(this,U,ae)},setEnd:function(U,ae){pe(U,!0),Ze(U,ae),de(this,U,ae)},setStartAndEnd:function(){var U=arguments,ae=U[0],me=U[1],Pe=ae,Dt=me;switch(U.length){case 3:Dt=U[2];break;case 4:Pe=U[2],Dt=U[3];break}pe(ae,!0),Ze(ae,me),pe(Pe,!0),Ze(Pe,Dt),D(this,ae,me,Pe,Dt)},setBoundary:function(U,ae,me){this["set"+(me?"Start":"End")](U,ae)},setStartBefore:z(!0,!0),setStartAfter:z(!1,!0),setEndBefore:z(!0,!1),setEndAfter:z(!1,!1),collapse:function(U){Je(this),U?D(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):D(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(U){pe(U,!0),D(this,U,0,U,x(U))},selectNode:function(U){pe(U,!1),nt(U,dt);var ae=ye(U),me=se(U);D(this,ae.node,ae.offset,me.node,me.offset)},extractContents:F(te,D),deleteContents:F(_t,D),canSurroundContents:function(){Je(this),Ft(this.startContainer),Ft(this.endContainer);var U=new Qe(this,!0),ae=U._first&&$(U._first,this)||U._last&&$(U._last,this);return U.detach(),!ae},splitBoundaries:function(){yn(this)},splitBoundariesPreservingPositions:function(U){yn(this,U)},normalizeBoundaries:function(){Je(this);var U=this.startContainer,ae=this.startOffset,me=this.endContainer,Pe=this.endOffset,Dt=function(Xt){var mr=Xt.nextSibling;mr&&mr.nodeType==Xt.nodeType&&(me=Xt,Pe=Xt.length,Xt.appendData(mr.data),A(mr))},Hl=function(Xt){var mr=Xt.previousSibling;if(mr&&mr.nodeType==Xt.nodeType){U=Xt;var Fc=Xt.length;if(ae=mr.length,Xt.insertData(0,mr.data),A(mr),U==me)Pe+=ae,me=U;else if(me==Xt.parentNode){var Gl=qe(Xt);Pe==Gl?(me=Xt,Pe=Fc):Pe>Gl&&Pe--}}},Va=!0,Ut;if(ve(me))Pe==me.length?Dt(me):Pe==0&&(Ut=me.previousSibling,Ut&&Ut.nodeType==me.nodeType&&(Pe=Ut.length,U==me&&(Va=!1),Ut.appendData(me.data),A(me),me=Ut));else{if(Pe>0){var Ka=me.childNodes[Pe-1];Ka&&ve(Ka)&&Dt(Ka)}Va=!this.collapsed}if(Va){if(ve(U))ae==0?Hl(U):ae==U.length&&(Ut=U.nextSibling,Ut&&Ut.nodeType==U.nodeType&&(me==Ut&&(me=U,Pe+=U.length),U.appendData(Ut.data),A(Ut)));else if(ae<U.childNodes.length){var Za=U.childNodes[ae];Za&&ve(Za)&&Hl(Za)}}else U=me,ae=Pe;D(this,U,ae,me,Pe)},collapseToPoint:function(U,ae){pe(U,!0),Ze(U,ae),this.setStartAndEnd(U,ae)},parentElement:function(){Je(this);var U=this.commonAncestorContainer;return U?Se(this.commonAncestorContainer,!0):null}}),R(_)}function Ee(_){_.collapsed=_.startContainer===_.endContainer&&_.startOffset===_.endOffset,_.commonAncestorContainer=_.collapsed?_.startContainer:G.getCommonAncestor(_.startContainer,_.endContainer)}function Ge(_,D,z,K,de){_.startContainer=D,_.startOffset=z,_.endContainer=K,_.endOffset=de,_.document=G.getDocument(D),Ee(_)}function ft(_){Ge(this,_,0,_,0)}re(ft,Ge),V.extend(ft,{rangeProperties:mn,RangeIterator:Qe,copyComparisonConstants:R,createPrototypeRange:re,inspect:He,toHtml:Me,getRangeDocument:Y,rangesEqual:function(_,D){return _.startContainer===D.startContainer&&_.startOffset===D.startOffset&&_.endContainer===D.endContainer&&_.endOffset===D.endOffset}}),N.DomRange=ft}),S.createCoreModule("WrappedRange",["DomRange"],function(N,X){var G,V,J=N.dom,le=N.util,ve=J.DomPosition,qe=N.DomRange,it=J.getBody,ut=J.getContentDocument,Ue=J.isCharacterDataNode;if(N.features.implementsDomRange&&(function(){var A,$=qe.rangeProperties;function Y(te){for(var ue=$.length,He;ue--;)He=$[ue],te[He]=te.nativeRange[He];te.collapsed=te.startContainer===te.endContainer&&te.startOffset===te.endOffset}function W(te,ue,He,Qe,dt){var Yt=te.startContainer!==ue||te.startOffset!=He,Tt=te.endContainer!==Qe||te.endOffset!=dt,xt=!te.equals(te.nativeRange);(Yt||Tt||xt)&&(te.setEnd(Qe,dt),te.setStart(ue,He))}var ye;G=function(te){if(!te)throw X.createError("WrappedRange: Range must be specified");this.nativeRange=te,Y(this)},qe.createPrototypeRange(G,W),A=G.prototype,A.selectNode=function(te){this.nativeRange.selectNode(te),Y(this)},A.cloneContents=function(){return this.nativeRange.cloneContents()},A.surroundContents=function(te){this.nativeRange.surroundContents(te),Y(this)},A.collapse=function(te){this.nativeRange.collapse(te),Y(this)},A.cloneRange=function(){return new G(this.nativeRange.cloneRange())},A.refresh=function(){Y(this)},A.toString=function(){return this.nativeRange.toString()};var se=document.createTextNode("test");it(document).appendChild(se);var Q=document.createRange();Q.setStart(se,0),Q.setEnd(se,0);try{Q.setStart(se,1),A.setStart=function(te,ue){this.nativeRange.setStart(te,ue),Y(this)},A.setEnd=function(te,ue){this.nativeRange.setEnd(te,ue),Y(this)},ye=function(te){return function(ue){this.nativeRange[te](ue),Y(this)}}}catch{A.setStart=function(ue,He){try{this.nativeRange.setStart(ue,He)}catch{this.nativeRange.setEnd(ue,He),this.nativeRange.setStart(ue,He)}Y(this)},A.setEnd=function(ue,He){try{this.nativeRange.setEnd(ue,He)}catch{this.nativeRange.setStart(ue,He),this.nativeRange.setEnd(ue,He)}Y(this)},ye=function(ue,He){return function(Qe){try{this.nativeRange[ue](Qe)}catch{this.nativeRange[He](Qe),this.nativeRange[ue](Qe)}Y(this)}}}A.setStartBefore=ye("setStartBefore","setEndBefore"),A.setStartAfter=ye("setStartAfter","setEndAfter"),A.setEndBefore=ye("setEndBefore","setStartBefore"),A.setEndAfter=ye("setEndAfter","setStartAfter"),A.selectNodeContents=function(te){this.setStartAndEnd(te,0,J.getNodeLength(te))},Q.selectNodeContents(se),Q.setEnd(se,3);var Ie=document.createRange();Ie.selectNodeContents(se),Ie.setEnd(se,4),Ie.setStart(se,2),Q.compareBoundaryPoints(Q.START_TO_END,Ie)==-1&&Q.compareBoundaryPoints(Q.END_TO_START,Ie)==1?A.compareBoundaryPoints=function(te,ue){return ue=ue.nativeRange||ue,te==ue.START_TO_END?te=ue.END_TO_START:te==ue.END_TO_START&&(te=ue.START_TO_END),this.nativeRange.compareBoundaryPoints(te,ue)}:A.compareBoundaryPoints=function(te,ue){return this.nativeRange.compareBoundaryPoints(te,ue.nativeRange||ue)};var Te=document.createElement("div");Te.innerHTML="123";var Le=Te.firstChild,_t=it(document);_t.appendChild(Te),Q.setStart(Le,1),Q.setEnd(Le,2),Q.deleteContents(),Le.data=="13"&&(A.deleteContents=function(){this.nativeRange.deleteContents(),Y(this)},A.extractContents=function(){var te=this.nativeRange.extractContents();return Y(this),te}),_t.removeChild(Te),_t=null,le.isHostMethod(Q,"createContextualFragment")&&(A.createContextualFragment=function(te){return this.nativeRange.createContextualFragment(te)}),it(document).removeChild(se),A.getName=function(){return"WrappedRange"},N.WrappedRange=G,N.createNativeRange=function(te){return te=ut(te,X,"createNativeRange"),te.createRange()}})(),N.features.implementsTextRange){var vt=function(A){var $=A.parentElement(),Y=A.duplicate();Y.collapse(!0);var W=Y.parentElement();Y=A.duplicate(),Y.collapse(!1);var ye=Y.parentElement(),se=W==ye?W:J.getCommonAncestor(W,ye);return se==$?se:J.getCommonAncestor($,se)},mt=function(A){return A.compareEndPoints("StartToEnd",A)==0},x=function(A,$,Y,W,ye){var se=A.duplicate();se.collapse(Y);var Q=se.parentElement();if(J.isOrIsAncestorOf($,Q)||(Q=$),!Q.canHaveHTML){var Ie=new ve(Q.parentNode,J.getNodeIndex(Q));return{boundaryPosition:Ie,nodeInfo:{nodeIndex:Ie.offset,containerElement:Ie.node}}}var Te=J.getDocument(Q).createElement("span");Te.parentNode&&J.removeNode(Te);for(var Le,_t=Y?"StartToStart":"StartToEnd",te,ue,He,Qe,dt=ye&&ye.containerElement==Q?ye.nodeIndex:0,Yt=Q.childNodes.length,Tt=Yt,xt=Tt;xt==Yt?Q.appendChild(Te):Q.insertBefore(Te,Q.childNodes[xt]),se.moveToElementText(Te),Le=se.compareEndPoints(_t,A),!(Le==0||dt==Tt);){if(Le==-1){if(Tt==dt+1)break;dt=xt}else Tt=Tt==dt+1?dt:xt;xt=Math.floor((dt+Tt)/2),Q.removeChild(Te)}if(Qe=Te.nextSibling,Le==-1&&Qe&&Ue(Qe)){se.setEndPoint(Y?"EndToStart":"EndToEnd",A);var wt;if(/[\r\n]/.test(Qe.data)){var Mt=se.duplicate(),Bt=Mt.text.replace(/\r\n/g,"\r").length;for(wt=Mt.moveStart("character",Bt);(Le=Mt.compareEndPoints("StartToEnd",Mt))==-1;)wt++,Mt.moveStart("character",1)}else wt=se.text.length;He=new ve(Qe,wt)}else te=(W||!Y)&&Te.previousSibling,ue=(W||Y)&&Te.nextSibling,ue&&Ue(ue)?He=new ve(ue,0):te&&Ue(te)?He=new ve(te,te.data.length):He=new ve(Q,J.getNodeIndex(Te));return J.removeNode(Te),{boundaryPosition:He,nodeInfo:{nodeIndex:xt,containerElement:Q}}},b=function(A,$){var Y,W,ye=A.offset,se=J.getDocument(A.node),Q,Ie,Te=it(se).createTextRange(),Le=Ue(A.node);return Le?(Y=A.node,W=Y.parentNode):(Ie=A.node.childNodes,Y=ye<Ie.length?Ie[ye]:null,W=A.node),Q=se.createElement("span"),Q.innerHTML="&#feff;",Y?W.insertBefore(Q,Y):W.appendChild(Q),Te.moveToElementText(Q),Te.collapse(!$),W.removeChild(Q),Le&&Te[$?"moveStart":"moveEnd"]("character",ye),Te};V=function(A){this.textRange=A,this.refresh()},V.prototype=new qe(document),V.prototype.refresh=function(){var A,$,Y,W=vt(this.textRange);mt(this.textRange)?$=A=x(this.textRange,W,!0,!0).boundaryPosition:(Y=x(this.textRange,W,!0,!1),A=Y.boundaryPosition,$=x(this.textRange,W,!1,!1,Y.nodeInfo).boundaryPosition),this.setStart(A.node,A.offset),this.setEnd($.node,$.offset)},V.prototype.getName=function(){return"WrappedTextRange"},qe.copyComparisonConstants(V);var O=function(A){if(A.collapsed)return b(new ve(A.startContainer,A.startOffset),!0);var $=b(new ve(A.startContainer,A.startOffset),!0),Y=b(new ve(A.endContainer,A.endOffset),!1),W=it(qe.getRangeDocument(A)).createTextRange();return W.setEndPoint("StartToStart",$),W.setEndPoint("EndToEnd",Y),W};if(V.rangeToTextRange=O,V.prototype.toTextRange=function(){return O(this)},N.WrappedTextRange=V,!N.features.implementsDomRange||N.config.preferTextRange){var H=(function(A){return A("return this;")()})(Function);typeof H.Range>"u"&&(H.Range=V),N.createNativeRange=function(A){return A=ut(A,X,"createNativeRange"),it(A).createTextRange()},N.WrappedRange=V}}N.createRange=function(A){return A=ut(A,X,"createRange"),new N.WrappedRange(N.createNativeRange(A))},N.createRangyRange=function(A){return A=ut(A,X,"createRangyRange"),new qe(A)},le.createAliasForDeprecatedMethod(N,"createIframeRange","createRange"),le.createAliasForDeprecatedMethod(N,"createIframeRangyRange","createRangyRange"),N.addShimListener(function(A){var $=A.document;typeof $.createRange>"u"&&($.createRange=function(){return N.createRange($)}),$=A=null})}),S.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(N,X){N.config.checkSelectionRanges=!0;var G="boolean",V="number",J=N.dom,le=N.util,ve=le.isHostMethod,qe=N.DomRange,it=N.WrappedRange,ut=N.DOMException,Ue=J.DomPosition,vt,mt,x=N.features,b="Control",O=J.getDocument,H=J.getBody,A=qe.rangesEqual;function $(m){return typeof m=="string"?/^backward(s)?$/i.test(m):!!m}function Y(m,R){if(m){if(J.isWindow(m))return m;if(m instanceof Je)return m.win;var F=J.getContentDocument(m,X,R);return J.getWindow(F)}else return window}function W(m){return Y(m,"getWinSelection").getSelection()}function ye(m){return Y(m,"getDocSelection").document.selection}function se(m){var R=!1;return m.anchorNode&&(R=J.comparePoints(m.anchorNode,m.anchorOffset,m.focusNode,m.focusOffset)==1),R}var Q=ve(window,"getSelection"),Ie=le.isHostObject(document,"selection");x.implementsWinGetSelection=Q,x.implementsDocSelection=Ie;var Te=Ie&&(!Q||N.config.preferTextRange);if(Te)vt=ye,N.isSelectionValid=function(m){var R=Y(m,"isSelectionValid").document,F=R.selection;return F.type!="None"||O(F.createRange().parentElement())==R};else if(Q)vt=W,N.isSelectionValid=function(){return!0};else return X.fail("Neither document.selection or window.getSelection() detected."),!1;N.getNativeSelection=vt;var Le=vt();if(!Le)return X.fail("Native selection was null (possibly issue 138?)"),!1;var _t=N.createNativeRange(document),te=H(document),ue=le.areHostProperties(Le,["anchorNode","focusNode","anchorOffset","focusOffset"]);x.selectionHasAnchorAndFocus=ue;var He=ve(Le,"extend");x.selectionHasExtend=He;var Qe=ve(Le,"setBaseAndExtent");x.selectionHasSetBaseAndExtent=Qe;var dt=typeof Le.rangeCount==V;x.selectionHasRangeCount=dt;var Yt=!1,Tt=!0,xt=He?function(m,R){var F=qe.getRangeDocument(R),re=N.createRange(F);re.collapseToPoint(R.endContainer,R.endOffset),m.addRange(pe(re)),m.extend(R.startContainer,R.startOffset)}:null;le.areHostMethods(Le,["addRange","getRangeAt","removeAllRanges"])&&typeof Le.rangeCount==V&&x.implementsDomRange&&(function(){var m=window.getSelection();if(m){for(var R=m.rangeCount,F=R>1,re=[],Ee=se(m),Ge=0;Ge<R;++Ge)re[Ge]=m.getRangeAt(Ge);var ft=J.createTestElement(document,"",!1),_=ft.appendChild(document.createTextNode("")),D=document.createRange();if(D.setStart(_,1),D.collapse(!0),m.removeAllRanges(),m.addRange(D),Tt=m.rangeCount==1,m.removeAllRanges(),!F){var z=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(z&&parseInt(z[1])>=36)Yt=!1;else{var K=D.cloneRange();D.setStart(_,0),K.setEnd(_,3),K.setStart(_,2),m.addRange(D),m.addRange(K),Yt=m.rangeCount==2}}for(J.removeNode(ft),m.removeAllRanges(),Ge=0;Ge<R;++Ge)Ge==0&&Ee?xt?xt(m,re[Ge]):(N.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),m.addRange(re[Ge])):m.addRange(re[Ge])}})(),x.selectionSupportsMultipleRanges=Yt,x.collapsedNonEditableSelectionsSupported=Tt;var wt=!1,Mt;te&&ve(te,"createControlRange")&&(Mt=te.createControlRange(),le.areHostProperties(Mt,["item","add"])&&(wt=!0)),x.implementsControlRange=wt,ue?mt=function(m){return m.anchorNode===m.focusNode&&m.anchorOffset===m.focusOffset}:mt=function(m){return m.rangeCount?m.getRangeAt(m.rangeCount-1).collapsed:!1};function Bt(m,R,F){var re=F?"end":"start",Ee=F?"start":"end";m.anchorNode=R[re+"Container"],m.anchorOffset=R[re+"Offset"],m.focusNode=R[Ee+"Container"],m.focusOffset=R[Ee+"Offset"]}function B(m){var R=m.nativeSelection;m.anchorNode=R.anchorNode,m.anchorOffset=R.anchorOffset,m.focusNode=R.focusNode,m.focusOffset=R.focusOffset}function Z(m){m.anchorNode=m.focusNode=null,m.anchorOffset=m.focusOffset=0,m.rangeCount=0,m.isCollapsed=!0,m._ranges.length=0,Se(m)}function Se(m){m.type=m.rangeCount==0?"None":mt(m)?"Caret":"Range"}function pe(m){var R;return m instanceof qe?(R=N.createNativeRange(m.getDocument()),R.setEnd(m.endContainer,m.endOffset),R.setStart(m.startContainer,m.startOffset)):m instanceof it?R=m.nativeRange:x.implementsDomRange&&m instanceof J.getWindow(m.startContainer).Range&&(R=m),R}function nt(m){if(!m.length||m[0].nodeType!=1)return!1;for(var R=1,F=m.length;R<F;++R)if(!J.isAncestorOf(m[0],m[R]))return!1;return!0}function Ze(m){var R=m.getNodes();if(!nt(R))throw X.createError("getSingleElementFromRange: range "+m.inspect()+" did not consist of a single element");return R[0]}function nr(m){return!!m&&typeof m.text<"u"}function Ft(m,R){var F=new it(R);m._ranges=[F],Bt(m,F,!1),m.rangeCount=1,m.isCollapsed=F.collapsed,Se(m)}function Pt(m){if(m._ranges.length=0,m.docSelection.type=="None")Z(m);else{var R=m.docSelection.createRange();if(nr(R))Ft(m,R);else{m.rangeCount=R.length;for(var F,re=O(R.item(0)),Ee=0;Ee<m.rangeCount;++Ee)F=N.createRange(re),F.selectNode(R.item(Ee)),m._ranges.push(F);m.isCollapsed=m.rangeCount==1&&m._ranges[0].collapsed,Bt(m,m._ranges[m.rangeCount-1],!1),Se(m)}}}function ao(m,R){for(var F=m.docSelection.createRange(),re=Ze(R),Ee=O(F.item(0)),Ge=H(Ee).createControlRange(),ft=0,_=F.length;ft<_;++ft)Ge.add(F.item(ft));try{Ge.add(re)}catch{throw X.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}Ge.select(),Pt(m)}var qr;ve(Le,"getRangeAt")?qr=function(m,R){try{return m.getRangeAt(R)}catch{return null}}:ue&&(qr=function(m){var R=O(m.anchorNode),F=N.createRange(R);return F.setStartAndEnd(m.anchorNode,m.anchorOffset,m.focusNode,m.focusOffset),F.collapsed!==this.isCollapsed&&F.setStartAndEnd(m.focusNode,m.focusOffset,m.anchorNode,m.anchorOffset),F});function Je(m,R,F){this.nativeSelection=m,this.docSelection=R,this._ranges=[],this.win=F,this.refresh()}Je.prototype=N.selectionPrototype;function so(m){m.win=m.anchorNode=m.focusNode=m._ranges=null,m.rangeCount=m.anchorOffset=m.focusOffset=0,m.detached=!0,Se(m)}var Tr=[];function lo(m,R){for(var F=Tr.length,re,Ee;F--;)if(re=Tr[F],Ee=re.selection,R=="deleteAll")so(Ee);else if(re.win==m)return R=="delete"?(Tr.splice(F,1),!0):Ee;return R=="deleteAll"&&(Tr.length=0),null}var yn=function(m){if(m&&m instanceof Je)return m.refresh(),m;m=Y(m,"getNativeSelection");var R=lo(m),F=vt(m),re=Ie?ye(m):null;return R?(R.nativeSelection=F,R.docSelection=re,R.refresh()):(R=new Je(F,re,m),Tr.push({win:m,selection:R})),R};N.getSelection=yn,le.createAliasForDeprecatedMethod(N,"getIframeSelection","getSelection");var Me=Je.prototype;function mn(m,R){for(var F=O(R[0].startContainer),re=H(F).createControlRange(),Ee=0,Ge,ft=R.length;Ee<ft;++Ee){Ge=Ze(R[Ee]);try{re.add(Ge)}catch{throw X.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}re.select(),Pt(m)}if(!Te&&ue&&le.areHostMethods(Le,["removeAllRanges","addRange"])){Me.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),Z(this)};var _n=function(m,R){xt(m.nativeSelection,R),m.refresh()};dt?Me.addRange=function(m,R){if(wt&&Ie&&this.docSelection.type==b)ao(this,m);else if($(R)&&He)_n(this,m);else{var F;Yt?F=this.rangeCount:(this.removeAllRanges(),F=0);var re=pe(m).cloneRange();try{this.nativeSelection.addRange(re)}catch{}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==F+1){if(N.config.checkSelectionRanges){var Ee=qr(this.nativeSelection,this.rangeCount-1);Ee&&!A(Ee,m)&&(m=new it(Ee))}this._ranges[this.rangeCount-1]=m,Bt(this,m,jr(this.nativeSelection)),this.isCollapsed=mt(this),Se(this)}else this.refresh()}}:Me.addRange=function(m,R){$(R)&&He?_n(this,m):(this.nativeSelection.addRange(pe(m)),this.refresh())},Me.setRanges=function(m){if(wt&&Ie&&m.length>1)mn(this,m);else{this.removeAllRanges();for(var R=0,F=m.length;R<F;++R)this.addRange(m[R])}}}else if(ve(Le,"empty")&&ve(_t,"select")&&wt&&Te)Me.removeAllRanges=function(){try{if(this.docSelection.empty(),this.docSelection.type!="None"){var m;if(this.anchorNode)m=O(this.anchorNode);else if(this.docSelection.type==b){var R=this.docSelection.createRange();R.length&&(m=O(R.item(0)))}if(m){var F=H(m).createTextRange();F.select(),this.docSelection.empty()}}}catch{}Z(this)},Me.addRange=function(m){this.docSelection.type==b?ao(this,m):(N.WrappedTextRange.rangeToTextRange(m).select(),this._ranges[0]=m,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,Bt(this,m,!1),Se(this))},Me.setRanges=function(m){this.removeAllRanges();var R=m.length;R>1?mn(this,m):R&&this.addRange(m[0])};else return X.fail("No means of selecting a Range or TextRange was found"),!1;Me.getRangeAt=function(m){if(m<0||m>=this.rangeCount)throw new ut("INDEX_SIZE_ERR");return this._ranges[m].cloneRange()};var Jr;if(Te)Jr=function(m){var R;N.isSelectionValid(m.win)?R=m.docSelection.createRange():(R=H(m.win.document).createTextRange(),R.collapse(!0)),m.docSelection.type==b?Pt(m):nr(R)?Ft(m,R):Z(m)};else if(ve(Le,"getRangeAt")&&typeof Le.rangeCount==V)Jr=function(m){if(wt&&Ie&&m.docSelection.type==b)Pt(m);else if(m._ranges.length=m.rangeCount=m.nativeSelection.rangeCount,m.rangeCount){for(var R=0,F=m.rangeCount;R<F;++R)m._ranges[R]=new N.WrappedRange(m.nativeSelection.getRangeAt(R));Bt(m,m._ranges[m.rangeCount-1],jr(m.nativeSelection)),m.isCollapsed=mt(m),Se(m)}else Z(m)};else if(ue&&typeof Le.isCollapsed==G&&typeof _t.collapsed==G&&x.implementsDomRange)Jr=function(m){var R,F=m.nativeSelection;F.anchorNode?(R=qr(F,0),m._ranges=[R],m.rangeCount=1,B(m),m.isCollapsed=mt(m),Se(m)):Z(m)};else return X.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;Me.refresh=function(m){var R=m?this._ranges.slice(0):null,F=this.anchorNode,re=this.anchorOffset;if(Jr(this),m){var Ee=R.length;if(Ee!=this._ranges.length||this.anchorNode!=F||this.anchorOffset!=re)return!0;for(;Ee--;)if(!A(R[Ee],this._ranges[Ee]))return!0;return!1}};var si=function(m,R){var F=m.getAllRanges();m.removeAllRanges();for(var re=0,Ee=F.length;re<Ee;++re)A(R,F[re])||m.addRange(F[re]);m.rangeCount||Z(m)};wt&&Ie?Me.removeRange=function(m){if(this.docSelection.type==b){for(var R=this.docSelection.createRange(),F=Ze(m),re=O(R.item(0)),Ee=H(re).createControlRange(),Ge,ft=!1,_=0,D=R.length;_<D;++_)Ge=R.item(_),Ge!==F||ft?Ee.add(R.item(_)):ft=!0;Ee.select(),Pt(this)}else si(this,m)}:Me.removeRange=function(m){si(this,m)};var jr;!Te&&ue&&x.implementsDomRange?(jr=se,Me.isBackward=function(){return jr(this)}):jr=Me.isBackward=function(){return!1},Me.isBackwards=Me.isBackward,Me.toString=function(){for(var m=[],R=0,F=this.rangeCount;R<F;++R)m[R]=""+this._ranges[R];return m.join("")};function Qr(m,R){if(m.win.document!=O(R))throw new ut("WRONG_DOCUMENT_ERR")}function uo(m,R){if(R<0||R>(J.isCharacterDataNode(m)?m.length:m.childNodes.length))throw new ut("INDEX_SIZE_ERR")}Me.collapse=function(m,R){Qr(this,m);var F=N.createRange(m);F.collapseToPoint(m,R),this.setSingleRange(F),this.isCollapsed=!0},Me.collapseToStart=function(){if(this.rangeCount){var m=this._ranges[0];this.collapse(m.startContainer,m.startOffset)}else throw new ut("INVALID_STATE_ERR")},Me.collapseToEnd=function(){if(this.rangeCount){var m=this._ranges[this.rangeCount-1];this.collapse(m.endContainer,m.endOffset)}else throw new ut("INVALID_STATE_ERR")},Me.selectAllChildren=function(m){Qr(this,m);var R=N.createRange(m);R.selectNodeContents(m),this.setSingleRange(R)},Qe?Me.setBaseAndExtent=function(m,R,F,re){this.nativeSelection.setBaseAndExtent(m,R,F,re),this.refresh()}:He&&(Me.setBaseAndExtent=function(m,R,F,re){uo(m,R),uo(F,re),Qr(this,m),Qr(this,F);var Ee=N.createRange(node),Ge=J.comparePoints(m,R,F,re)==-1;Ge?Ee.setStartAndEnd(F,re,m,R):Ee.setStartAndEnd(m,R,F,re),this.setSingleRange(Ee,Ge)}),Me.deleteFromDocument=function(){if(wt&&Ie&&this.docSelection.type==b){for(var m=this.docSelection.createRange(),R;m.length;)R=m.item(0),m.remove(R),J.removeNode(R);this.refresh()}else if(this.rangeCount){var F=this.getAllRanges();if(F.length){this.removeAllRanges();for(var re=0,Ee=F.length;re<Ee;++re)F[re].deleteContents();this.addRange(F[Ee-1])}}},Me.eachRange=function(m,R){for(var F=0,re=this._ranges.length;F<re;++F)if(m(this.getRangeAt(F)))return R},Me.getAllRanges=function(){var m=[];return this.eachRange(function(R){m.push(R)}),m},Me.setSingleRange=function(m,R){this.removeAllRanges(),this.addRange(m,R)},Me.callMethodOnEachRange=function(m,R){var F=[];return this.eachRange(function(re){F.push(re[m].apply(re,R||[]))}),F};function fo(m){return function(R,F){var re;this.rangeCount?(re=this.getRangeAt(0),re["set"+(m?"Start":"End")](R,F)):(re=N.createRange(this.win.document),re.setStartAndEnd(R,F)),this.setSingleRange(re,this.isBackward())}}Me.setStart=fo(!0),Me.setEnd=fo(!1),N.rangePrototype.select=function(m){yn(this.getDocument()).setSingleRange(this,m)},Me.changeEachRange=function(m){var R=[],F=this.isBackward();this.eachRange(function(re){m(re),R.push(re)}),this.removeAllRanges(),F&&R.length==1?this.addRange(R[0],"backward"):this.setRanges(R)},Me.containsNode=function(m,R){return this.eachRange(function(F){return F.containsNode(m,R)},!0)||!1},Me.getBookmark=function(m){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[m])}},Me.moveToBookmark=function(m){for(var R=[],F=0,re,Ee;re=m.rangeBookmarks[F++];)Ee=N.createRange(this.win),Ee.moveToBookmark(re),R.push(Ee);m.backward?this.setSingleRange(R[0],"backward"):this.setRanges(R)},Me.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},Me.restoreRanges=function(m){this.removeAllRanges();for(var R=0,F;F=m.ranges[R];++R)this.addRange(F,m.backward&&R==0)},Me.toHtml=function(){var m=[];return this.eachRange(function(R){m.push(qe.toHtml(R))}),m.join("")},x.implementsTextRange&&(Me.getNativeTextRange=function(){var m;if(m=this.docSelection){var R=m.createRange();if(nr(R))return R;throw X.createError("getNativeTextRange: selection is a control selection")}else{if(this.rangeCount>0)return N.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw X.createError("getNativeTextRange: selection contains no range")}});function xn(m){var R=[],F=new Ue(m.anchorNode,m.anchorOffset),re=new Ue(m.focusNode,m.focusOffset),Ee=typeof m.getName=="function"?m.getName():"Selection";if(typeof m.rangeCount<"u")for(var Ge=0,ft=m.rangeCount;Ge<ft;++Ge)R[Ge]=qe.inspect(m.getRangeAt(Ge));return"["+Ee+"(Ranges: "+R.join(", ")+")(anchor: "+F.inspect()+", focus: "+re.inspect()+"]"}Me.getName=function(){return"WrappedSelection"},Me.inspect=function(){return xn(this)},Me.detach=function(){lo(this.win,"delete"),so(this)},Je.detachAll=function(){lo(null,"deleteAll")},Je.inspect=xn,Je.isDirectionBackward=$,N.Selection=Je,N.selectionPrototype=Me,N.addShimListener(function(m){typeof m.getSelection>"u"&&(m.getSelection=function(){return yn(m)}),m=null})});var Ce=!1,Ke=function(N){Ce||(Ce=!0,!S.initialized&&S.config.autoInitialize&&$e())};return C&&(document.readyState=="complete"?Ke():(u(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",Ke,!1),he(window,"load",Ke))),S})})(xs)),xs.exports}var F_=Hc();const Fd=yl(F_);var ws={exports:{}},$d;function $_(){return $d||($d=1,(function(r,t){(function(e,n){r.exports=e(Hc())})(function(e){return e.createModule("ClassApplier",["WrappedSelection"],function(n,o){var i=n.dom,a=i.DomPosition,s=i.arrayContains,l=n.util,u=l.forEach,f="span",d=l.isHostMethod(document,"createElementNS");function c(x,b){for(var O in x)if(x.hasOwnProperty(O)&&b(O,x[O])===!1)return!1;return!0}function h(x){return x.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function p(x,b){return!!x&&new RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(x)}function v(x,b){if(typeof x.classList=="object")return x.classList.contains(b);var O=typeof x.className=="string",H=O?x.className:x.getAttribute("class");return p(H,b)}function g(x,b){if(typeof x.classList=="object")x.classList.add(b);else{var O=typeof x.className=="string",H=O?x.className:x.getAttribute("class");H?p(H,b)||(H+=" "+b):H=b,O?x.className=H:x.setAttribute("class",H)}}var y=(function(){function x(b,O,H){return O&&H?" ":""}return function(b,O){if(typeof b.classList=="object")b.classList.remove(O);else{var H=typeof b.className=="string",A=H?b.className:b.getAttribute("class");A=A.replace(new RegExp("(^|\\s)"+O+"(\\s|$)"),x),H?b.className=A:b.setAttribute("class",A)}}})();function w(x){var b=typeof x.className=="string";return b?x.className:x.getAttribute("class")}function M(x){return x&&x.split(/\s+/).sort().join(" ")}function C(x){return M(w(x))}function P(x,b){return C(x)==C(b)}function S(x,b){for(var O=b.split(/\s+/),H=0,A=O.length;H<A;++H)if(!v(x,h(O[H])))return!1;return!0}function E(x){var b=x.parentNode;return b&&b.nodeType==1&&!/^(textarea|style|script|select|iframe)$/i.test(b.nodeName)}function T(x,b,O,H,A){var $=x.node,Y=x.offset,W=$,ye=Y;$==H&&Y>A&&++ye,$==b&&(Y==O||Y==O+1)&&(W=H,ye+=A-O),$==b&&Y>O+1&&--ye,x.node=W,x.offset=ye}function j(x,b,O){x.node==b&&x.offset>O&&--x.offset}function q(x,b,O,H){O==-1&&(O=b.childNodes.length);var A=x.parentNode,$=i.getNodeIndex(x);u(H,function(Y){T(Y,A,$,b,O)}),b.childNodes.length==O?b.appendChild(x):b.insertBefore(x,b.childNodes[O])}function ee(x,b){var O=x.parentNode,H=i.getNodeIndex(x);u(b,function(A){j(A,O,H)}),i.removeNode(x)}function he(x,b,O,H,A){for(var $,Y=[];$=x.firstChild;)q($,b,O++,A),Y.push($);return ee(x,A),Y}function ke(x,b){return he(x,x.parentNode,i.getNodeIndex(x),!0,b)}function be(x,b){var O=x.cloneRange();O.selectNodeContents(b);var H=O.intersection(x),A=H?H.toString():"";return A!=""}function $e(x){for(var b=x.getNodes([3]),O=0,H;(H=b[O])&&!be(x,H);)++O;for(var A=b.length-1;(H=b[A])&&!be(x,H);)--A;return b.slice(O,A+1)}function rt(x,b){if(x.attributes.length!=b.attributes.length)return!1;for(var O=0,H=x.attributes.length,A,$,Y;O<H;++O)if(A=x.attributes[O],Y=A.name,Y!="class"&&($=b.attributes.getNamedItem(Y),A===null!=($===null)||A.specified!=$.specified||A.specified&&A.nodeValue!==$.nodeValue))return!1;return!0}function yt(x,b){for(var O=0,H=x.attributes.length,A;O<H;++O)if(A=x.attributes[O].name,!(b&&s(b,A))&&x.attributes[O].specified&&A!="class")return!0;return!1}var pt=i.getComputedStyleProperty,ot=(function(){var x=document.createElement("div");return typeof x.isContentEditable=="boolean"?function(b){return b&&b.nodeType==1&&b.isContentEditable}:function(b){return!b||b.nodeType!=1||b.contentEditable=="false"?!1:b.contentEditable=="true"||ot(b.parentNode)}})();function st(x){var b;return x&&x.nodeType==1&&((b=x.parentNode)&&b.nodeType==9&&b.designMode=="on"||ot(x)&&!ot(x.parentNode))}function ge(x){return(ot(x)||x.nodeType!=1&&ot(x.parentNode))&&!st(x)}var Re=/^inline(-block|-table)?$/i;function Be(x){return x&&x.nodeType==1&&!Re.test(pt(x,"display"))}var Ce=/[^\r\n\t\f \u200B]/;function Ke(x){if(x.data.length==0)return!0;if(Ce.test(x.data))return!1;var b=pt(x.parentNode,"whiteSpace");switch(b){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(x.data))return!1}return Be(x.previousSibling)||Be(x.nextSibling)}function N(x){var b=[],O,H;for(O=0;H=x[O++];)b.push(new a(H.startContainer,H.startOffset),new a(H.endContainer,H.endOffset));return b}function X(x,b){for(var O=0,H,A,$,Y=x.length;O<Y;++O)H=x[O],A=b[O*2],$=b[O*2+1],H.setStartAndEnd(A.node,A.offset,$.node,$.offset)}function G(x,b){return i.isCharacterDataNode(x)?b==0?!!x.previousSibling:b==x.length?!!x.nextSibling:!0:b>0&&b<x.childNodes.length}function V(x,b,O,H){var A,$,Y=O==0;if(i.isAncestorOf(b,x))return x;if(i.isCharacterDataNode(b)){var W=i.getNodeIndex(b);if(O==0)O=W;else if(O==b.length)O=W+1;else throw o.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+O+" in "+b.data);b=b.parentNode}if(G(b,O)){A=b.cloneNode(!1),$=b.parentNode,A.id&&A.removeAttribute("id");for(var ye,se=0;ye=b.childNodes[O];)q(ye,A,se++,H);return q(A,$,i.getNodeIndex(b)+1,H),b==x?A:V(x,$,i.getNodeIndex(A),H)}else if(x!=b){A=b.parentNode;var Q=i.getNodeIndex(b);return Y||Q++,V(x,A,Q,H)}return x}function J(x,b){return x.namespaceURI==b.namespaceURI&&x.tagName.toLowerCase()==b.tagName.toLowerCase()&&P(x,b)&&rt(x,b)&&pt(x,"display")=="inline"&&pt(b,"display")=="inline"}function le(x){var b=x?"nextSibling":"previousSibling";return function(O,H){var A=O.parentNode,$=O[b];if($){if($&&$.nodeType==3)return $}else if(H&&($=A[b],$&&$.nodeType==1&&J(A,$))){var Y=$[x?"firstChild":"lastChild"];if(Y&&Y.nodeType==3)return Y}return null}}var ve=le(!1),qe=le(!0);function it(x){this.isElementMerge=x.nodeType==1,this.textNodes=[];var b=this.isElementMerge?x.lastChild:x;b&&(this.textNodes[0]=b)}it.prototype={doMerge:function(x){var b=this.textNodes,O=b[0];if(b.length>1){var H=i.getNodeIndex(O),A=[],$=0,Y;u(b,function(W,ye){Y=W.parentNode,ye>0&&(Y.removeChild(W),Y.hasChildNodes()||i.removeNode(Y),x&&u(x,function(se){se.node==W&&(se.node=O,se.offset+=$),se.node==Y&&se.offset>H&&(--se.offset,se.offset==H+1&&ye<b.length-1&&(se.node=O,se.offset=$))})),A[ye]=W.data,$+=W.data.length}),O.data=A.join("")}return O.data},getLength:function(){for(var x=this.textNodes.length,b=0;x--;)b+=this.textNodes[x].length;return b},toString:function(){var x=[];return u(this.textNodes,function(b,O){x[O]="'"+b.data+"'"}),"[Merge("+x.join(",")+")]"}};var ut=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],Ue={};function vt(x,b,O){var H,A,$,Y,W=this;W.cssClass=W.className=x;var ye=null,se={};if(typeof b=="object"&&b!==null){for(typeof b.elementTagName<"u"&&(b.elementTagName=b.elementTagName.toLowerCase()),O=b.tagNames,ye=b.elementProperties,se=b.elementAttributes,A=0;Y=ut[A++];)b.hasOwnProperty(Y)&&(W[Y]=b[Y]);H=b.normalize}else H=b;W.normalize=typeof H>"u"?!0:H,W.attrExceptions=[];var Q=document.createElement(W.elementTagName);W.elementProperties=W.copyPropertiesToElement(ye,Q,!0),c(se,function(Te,Le){W.attrExceptions.push(Te),se[Te]=""+Le}),W.elementAttributes=se,W.elementSortedClassName=W.elementProperties.hasOwnProperty("className")?M(W.elementProperties.className+" "+x):x,W.applyToAnyTagName=!1;var Ie=typeof O;if(Ie=="string")O=="*"?W.applyToAnyTagName=!0:W.tagNames=h(O.toLowerCase()).split(/\s*,\s*/);else if(Ie=="object"&&typeof O.length=="number")for(W.tagNames=[],A=0,$=O.length;A<$;++A)O[A]=="*"?W.applyToAnyTagName=!0:W.tagNames.push(O[A].toLowerCase());else W.tagNames=[W.elementTagName]}vt.prototype={elementTagName:f,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(x,b,O){var H,A,$={},Y,W,ye,se;for(var Q in x)if(x.hasOwnProperty(Q))if(W=x[Q],ye=b[Q],Q=="className")g(b,W),g(b,this.className),b[Q]=M(b[Q]),O&&($[Q]=W);else if(Q=="style"){A=ye,O&&($[Q]=Y={});for(H in x[Q])x[Q].hasOwnProperty(H)&&(A[H]=W[H],O&&(Y[H]=A[H]));this.attrExceptions.push(Q)}else b[Q]=W,O&&($[Q]=b[Q],se=Ue.hasOwnProperty(Q)?Ue[Q]:Q,this.attrExceptions.push(se));return O?$:""},copyAttributesToElement:function(x,b){for(var O in x)x.hasOwnProperty(O)&&!/^class(?:Name)?$/i.test(O)&&b.setAttribute(O,x[O])},appliesToElement:function(x){return s(this.tagNames,x.tagName.toLowerCase())},getEmptyElements:function(x){var b=this;return x.getNodes([1],function(O){return b.appliesToElement(O)&&!O.hasChildNodes()})},hasClass:function(x){return x.nodeType==1&&(this.applyToAnyTagName||this.appliesToElement(x))&&v(x,this.className)},getSelfOrAncestorWithClass:function(x){for(;x;){if(this.hasClass(x))return x;x=x.parentNode}return null},isModifiable:function(x){return!this.applyToEditableOnly||ge(x)},isIgnorableWhiteSpaceNode:function(x){return this.ignoreWhiteSpace&&x&&x.nodeType==3&&Ke(x)},postApply:function(x,b,O,H){var A=x[0],$=x[x.length-1],Y=[],W,ye=A,se=$,Q=0,Ie=$.length,Te;u(x,function(ue){Te=ve(ue,!H),Te?(W||(W=new it(Te),Y.push(W)),W.textNodes.push(ue),ue===A&&(ye=W.textNodes[0],Q=ye.length),ue===$&&(se=W.textNodes[0],Ie=W.getLength())):W=null});var Le=qe($,!H);if(Le&&(W||(W=new it($),Y.push(W)),W.textNodes.push(Le)),Y.length){for(var _t=0,te=Y.length;_t<te;++_t)Y[_t].doMerge(O);b.setStartAndEnd(ye,Q,se,Ie)}},createContainer:function(x){var b=i.getDocument(x),O=d&&!i.isHtmlNamespace(x)&&x.namespaceURI?b.createElementNS(x.namespaceURI,this.elementTagName):b.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,O,!1),this.copyAttributesToElement(this.elementAttributes,O),g(O,this.className),this.onElementCreate&&this.onElementCreate(O,this),O},elementHasProperties:function(x,b){var O=this;return c(b,function(H,A){if(H=="className")return S(x,A);if(typeof A=="object"){if(!O.elementHasProperties(x[H],A))return!1}else if(x[H]!==A)return!1})},elementHasAttributes:function(x,b){return c(b,function(O,H){if(x.getAttribute(O)!==H)return!1})},applyToTextNode:function(x,b){if(E(x)){var O=x.parentNode;if(O.childNodes.length==1&&this.useExistingElements&&this.appliesToElement(O)&&this.elementHasProperties(O,this.elementProperties)&&this.elementHasAttributes(O,this.elementAttributes))g(O,this.className);else{var H=x.parentNode,A=this.createContainer(H);H.insertBefore(A,x),A.appendChild(x)}}},isRemovable:function(x){return x.tagName.toLowerCase()==this.elementTagName&&C(x)==this.elementSortedClassName&&this.elementHasProperties(x,this.elementProperties)&&!yt(x,this.attrExceptions)&&this.elementHasAttributes(x,this.elementAttributes)&&this.isModifiable(x)},isEmptyContainer:function(x){var b=x.childNodes.length;return x.nodeType==1&&this.isRemovable(x)&&(b==0||b==1&&this.isEmptyContainer(x.firstChild))},removeEmptyContainers:function(x){var b=this,O=x.getNodes([1],function($){return b.isEmptyContainer($)}),H=[x],A=N(H);u(O,function($){ee($,A)}),X(H,A)},undoToTextNode:function(x,b,O,H){if(!b.containsNode(O)){var A=b.cloneRange();A.selectNode(O),A.isPointInRange(b.endContainer,b.endOffset)&&(V(O,b.endContainer,b.endOffset,H),b.setEndAfter(O)),A.isPointInRange(b.startContainer,b.startOffset)&&(O=V(O,b.startContainer,b.startOffset,H))}this.isRemovable(O)?ke(O,H):y(O,this.className)},splitAncestorWithClass:function(x,b,O){var H=this.getSelfOrAncestorWithClass(x);H&&V(H,x,b,O)},undoToAncestor:function(x,b){this.isRemovable(x)?ke(x,b):y(x,this.className)},applyToRange:function(x,b){var O=this;b=b||[];var H=N(b||[]);x.splitBoundariesPreservingPositions(H),O.removeEmptyElements&&O.removeEmptyContainers(x);var A=$e(x);if(A.length){u(A,function(W){!O.isIgnorableWhiteSpaceNode(W)&&!O.getSelfOrAncestorWithClass(W)&&O.isModifiable(W)&&O.applyToTextNode(W,H)});var $=A[A.length-1];x.setStartAndEnd(A[0],0,$,$.length),O.normalize&&O.postApply(A,x,H,!1),X(b,H)}var Y=O.getEmptyElements(x);u(Y,function(W){g(W,O.className)})},applyToRanges:function(x){for(var b=x.length;b--;)this.applyToRange(x[b],x);return x},applyToSelection:function(x){var b=n.getSelection(x);b.setRanges(this.applyToRanges(b.getAllRanges()))},undoToRange:function(x,b){var O=this;b=b||[];var H=N(b);x.splitBoundariesPreservingPositions(H),O.removeEmptyElements&&O.removeEmptyContainers(x,H);var A=$e(x),$,Y,W=A[A.length-1];if(A.length){O.splitAncestorWithClass(x.endContainer,x.endOffset,H),O.splitAncestorWithClass(x.startContainer,x.startOffset,H);for(var ye=0,se=A.length;ye<se;++ye)$=A[ye],Y=O.getSelfOrAncestorWithClass($),Y&&O.isModifiable($)&&O.undoToAncestor(Y,H);x.setStartAndEnd(A[0],0,W,W.length),O.normalize&&O.postApply(A,x,H,!0),X(b,H)}var Q=O.getEmptyElements(x);u(Q,function(Ie){y(Ie,O.className)})},undoToRanges:function(x){for(var b=x.length;b--;)this.undoToRange(x[b],x);return x},undoToSelection:function(x){var b=n.getSelection(x),O=n.getSelection(x).getAllRanges();this.undoToRanges(O),b.setRanges(O)},isAppliedToRange:function(x){if(x.collapsed||x.toString()=="")return!!this.getSelfOrAncestorWithClass(x.commonAncestorContainer);var b=x.getNodes([3]);if(b.length){for(var O=0,H;H=b[O++];)if(!this.isIgnorableWhiteSpaceNode(H)&&be(x,H)&&this.isModifiable(H)&&!this.getSelfOrAncestorWithClass(H))return!1}return!0},isAppliedToRanges:function(x){var b=x.length;if(b==0)return!1;for(;b--;)if(!this.isAppliedToRange(x[b]))return!1;return!0},isAppliedToSelection:function(x){var b=n.getSelection(x);return this.isAppliedToRanges(b.getAllRanges())},toggleRange:function(x){this.isAppliedToRange(x)?this.undoToRange(x):this.applyToRange(x)},toggleSelection:function(x){this.isAppliedToSelection(x)?this.undoToSelection(x):this.applyToSelection(x)},getElementsWithClassIntersectingRange:function(x){var b=[],O=this;return x.getNodes([3],function(H){var A=O.getSelfOrAncestorWithClass(H);A&&!s(b,A)&&b.push(A)}),b},detach:function(){}};function mt(x,b,O){return new vt(x,b,O)}vt.util={hasClass:v,addClass:g,removeClass:y,getClass:w,hasSameClasses:P,hasAllClasses:S,replaceWithOwnChildren:ke,elementsHaveSameNonClassAttributes:rt,elementHasNonClassAttributes:yt,splitNodeAt:V,isEditableElement:ot,isEditingHost:st,isEditable:ge},n.CssClassApplier=n.ClassApplier=vt,n.createClassApplier=mt,l.createAliasForDeprecatedMethod(n,"createCssClassApplier","createClassApplier",o)}),e})})(ws)),ws.exports}$_();var Wd={toolbar:{allowMultiParagraphSelection:!0,buttons:["bold","colorpicker","italic","underline","strikethrough","quote","justifyLeft","justifyCenter","justifyRight","justifyFull","superscript","subscript","orderedlist","unorderedlist","pre","removeFormat","outdent","indent","h2","h3"],standardizeSelectionStart:!1,updateOnEmptySelection:!1},placeholder:{text:"",hideOnClick:!0},disableEditing:!0},Ud=Gi.extensions.button.extend({name:"colorpicker",tagNames:["mark"],contentDefault:"<b>Color</b>",aria:"Color Picker",action:"colorPicker",init:function(){var r=this;Fd.init(),Gi.extensions.button.prototype.init.call(this),this.colorPicker=new Xc({parent:this.button,color:"#000",onDone:function(t){r.coloredText&&r.coloredText.isAppliedToSelection()&&r.coloredText.undoToSelection(),r.coloredText=Fd.createClassApplier("colored",{elementTagName:"span",elementProperties:{style:{color:t.hex}},normalize:!0}),r.coloredText.toggleSelection(),r.base.checkContentChanged(),r.setInactive()}})},getButton:function(){return this.button},handleClick:function(){this.setActive(),this.colorPicker.show()},isAlreadyApplied:function(r){return r.nodeName.toLowerCase()==="mark"},isActive:function(){return this.button.classList.contains("medium-editor-button-active")},setInactive:function(){this.button.classList.remove("medium-editor-button-active")},setActive:function(){this.button.classList.add("medium-editor-button-active")}}),W_=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),U_=function(r,t,e,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,n);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(i=(o<3?a(i):o>3?a(t,e,i):a(t,e))||i);return o>3&&i&&Object.defineProperty(t,e,i),i},Vd=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Kd=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))};(function(r){W_(t,r);function t(e){var n=r.call(this,e)||this;n.labelMap=new Map;var o=e.lf,i=e.graphModel;return n.lf=o,n.graphModel=i,n.state={tick:0},n}return t.prototype.componentDidMount=function(){var e=this,n=this.props.graphModel;this.editor=new Gi(".lf-label-editor",kn(Wd,{autoLink:!0,extensions:{colorPicker:new Ud}})),n.eventCenter.on("text:update,node:mousemove,node:resize,node:rotate,node:drag,label:drop,node:drop",function(){}),n.eventCenter.on("node:properties-change,node:properties-delete",function(){e.setState({tick:e.state.tick+1})})},t.prototype.componentDidUpdate=function(){var e;this.editor&&this.editor.elements.length>0?this.editor.addElements(".lf-label-editor"):((e=this.editor)===null||e===void 0||e.destroy(),this.editor=new Gi(".lf-label-editor",kn(Wd,{autoLink:!0,extensions:{colorPicker:new Ud}})))},t.prototype.componentWillUnmount=function(){var e;(e=this.editor)===null||e===void 0||e.destroy()},t.prototype.getLabels=function(){var e=this,n=this.props,o=n.lf.extension,i=n.graphModel,a=Kd(Kd([],Vd(i.nodes),!1),Vd(i.edges),!1),s=o.label;if(s){var l=[];return Oe(a,function(u){var f,d,c=u.getData(),h=(d=(f=c.properties)===null||f===void 0?void 0:f._label)!==null&&d!==void 0?d:[];Oe(h,function(p){var v=e.labelMap,g=new I_(p,u,i);v.set(g.id,g),l.push(k(L_,{label:g,element:u,graphModel:i},g.id))})}),l}return null},t.prototype.render=function(){return k("foreignObject",{id:"lf-label-overlay",class:"lf-label-overlay",children:this.getLabels()})},t.toolName="label-edit-tool",t=U_([Lt],t),t})(De);var m0=(function(){function r(t){var e=t.lf,n=this;this.lf=e,this.lf.setPatternItems=function(o){n.setPatternItems(o)}}return r.prototype.render=function(t,e){var n=this;if(this.destroy(),!this.shapeList||this.shapeList.length===0){this.domContainer=e;return}this.panelEl=document.createElement("div"),this.panelEl.className="lf-dndpanel",this.panelEl.addEventListener("touchmove",function(o){o.preventDefault()},{passive:!1}),this.shapeList.forEach(function(o){var i;(i=n.panelEl)===null||i===void 0||i.appendChild(n.createDndItem(o))}),e.appendChild(this.panelEl),this.domContainer=e},r.prototype.destroy=function(){this.domContainer&&this.panelEl&&this.domContainer.contains(this.panelEl)&&this.domContainer.removeChild(this.panelEl)},r.prototype.setPatternItems=function(t){this.shapeList=t,this.domContainer&&this.render(this.lf,this.domContainer)},r.prototype.createDndItem=function(t){var e=this,n=document.createElement("div");n.className=t.className?"lf-dnd-item ".concat(t.className):"lf-dnd-item";var o=document.createElement("div");if(o.className="lf-dnd-shape",t.icon&&(o.style.backgroundImage="url(".concat(t.icon,")")),n.appendChild(o),t.label){var i=document.createElement("div");i.innerText=t.label,i.className="lf-dnd-text",n.appendChild(i)}return t.disabled?(n.classList.add("disabled"),n.onpointerdown=function(){t.callback&&t.callback(e.lf,e.domContainer)},n):(n.onpointerdown=function(a){t.type&&e.lf.dnd.startDrag({type:t.type,properties:t.properties,text:t.text}),t.callback&&t.callback(e.lf,e.domContainer),a.preventDefault()},n.ondblclick=function(a){e.lf.graphModel.eventCenter.emit("dnd:panel-dbclick",{e:a,data:t})},n.onclick=function(a){e.lf.graphModel.eventCenter.emit("dnd:panel-click",{e:a,data:t})},n.oncontextmenu=function(a){e.lf.graphModel.eventCenter.emit("dnd:panel-contextmenu",{e:a,data:t})},n)},r.pluginName="dndPanel",r})(),V_=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_0=(function(){function r(t){var e=t.lf,n=t.LogicFlow,o=t.options,i=this;this.width=200,this.height=150,this.scale=1,this.translateX=0,this.translateY=0,this.showEdge=!1,this.viewPortTop=0,this.viewPortLeft=0,this.viewPortWidth=150,this.viewPortHeight=75,this.isShow=!1,this.isShowHeader=!1,this.isShowCloseIcon=!1,this.headerTitle="",this.disabledPlugins=["miniMap","control","selectionSelect"],this.onGraphResize=function(){i.updateViewPortBounds(),i.isShow&&i.updateViewPort()},this.render=function(s,l){i.container=l,i.lf.on("history:change",function(){i.isShow&&i.setView()}),i.lf.on("graph:transform",function(){i.isShow&&i.setView(!1)})},this.show=function(s,l){i.isShow||(i.initMiniMap(),i.lf.on("graph:resize",i.onGraphResize),i.createMiniMap(s,l),i.setView(!0)),i.isShow=!0},this.hide=function(){i.isShow&&(i.lf.off("graph:resize",i.onGraphResize),i.lfMap.destroy(),i.translateX=0,i.translateY=0,i.removeMiniMap(),i.lf.emit("miniMap:close",{})),i.isShow=!1},this.updatePosition=function(s){if(typeof s=="object")(s.left!==void 0||s.right!==void 0)&&(i.leftPosition=s.left,i.rightPosition=s.right),(s.top!==void 0||s.bottom!==void 0)&&(i.topPosition=s.top,i.bottomPosition=s.bottom);else switch(s){case"left-top":i.leftPosition=0,i.rightPosition=void 0,i.topPosition=0,i.bottomPosition=void 0;break;case"right-top":i.leftPosition=void 0,i.rightPosition=0,i.topPosition=0,i.bottomPosition=void 0;break;case"left-bottom":i.leftPosition=0,i.rightPosition=void 0,i.topPosition=void 0,i.bottomPosition=0;break;case"right-bottom":i.leftPosition=void 0,i.rightPosition=0,i.topPosition=void 0,i.bottomPosition=0;break}i.updateMiniMapPosition()},this.reset=function(){i.lf.resetTranslate(),i.lf.resetZoom()},this.setShowEdge=function(s){i.showEdge!==s&&(i.showEdge=s,i.setView())},this.startDrag=function(s){document.addEventListener("pointermove",i.drag),document.addEventListener("pointerup",i.drop);var l=s.x,u=s.y;i.startPosition={x:l,y:u}},this.drag=function(s){var l=s.x,u=s.y,f=(l-i.startPosition.x)/i.scale,d=(u-i.startPosition.y)/i.scale,c=i.viewPortLeft+f+i.viewPortWidth/i.scale/2,h=i.viewPortTop+d+i.viewPortHeight/i.scale/2;i.startPosition={x:l,y:u},i.lf.focusOn({coordinate:{x:c,y:h}})},this.drop=function(){document.removeEventListener("pointermove",i.drag),document.removeEventListener("pointerup",i.drop)},this.mapClick=function(s){var l=s.offsetX,u=s.offsetY,f=i.translateX+l/i.scale,d=i.translateY+u/i.scale;i.lf.focusOn({coordinate:{x:f,y:d}})},this.lf=e,this.LFCtor=n,o&&this.setOption(o),this.viewPortWidth=e.graphModel.width,this.viewPortHeight=e.graphModel.height;var a={left:0,right:this.viewPortWidth,top:0,bottom:this.viewPortHeight};this.bounds=a,this.elementAreaBounds=a,this.viewPortBounds=a}return r.prototype.setOption=function(t){var e=t.width,n=e===void 0?150:e,o=t.height,i=o===void 0?220:o,a=t.showEdge,s=a===void 0?!1:a,l=t.isShowHeader,u=l===void 0?!1:l,f=t.isShowCloseIcon,d=f===void 0?!1:f,c=t.leftPosition,h=t.topPosition,p=t.rightPosition,v=p===void 0?0:p,g=t.bottomPosition,y=g===void 0?0:g,w=t.headerTitle,M=w===void 0?"":w;this.width=n,this.height=i,this.showEdge=s,this.isShowHeader=u,this.isShowCloseIcon=d,this.leftPosition=c,this.rightPosition=c!==void 0?void 0:v,this.topPosition=h,this.bottomPosition=h!==void 0?void 0:y,this.headerTitle=M},r.prototype.initMiniMap=function(){var t=document.createElement("div");t.className="lf-mini-map-graph",t.style.width="".concat(this.width,"px"),t.style.height="".concat(this.height,"px"),this.lfMap=new this.LFCtor({container:t,grid:!1,isSilentMode:!0,stopZoomGraph:!0,stopScrollGraph:!0,stopMoveGraph:!1,history:!1,snapline:!1,disabledPlugins:this.disabledPlugins,isMiniMap:!0}),this.miniMapWrap=t,this.createViewPort(),t.addEventListener("click",this.mapClick)},r.prototype.createMiniMap=function(t,e){var n,o=document.createElement("div");this.miniMapContainer=o,o.appendChild(this.miniMapWrap),o.style.position="absolute",(t!==void 0||e!==void 0)&&(this.leftPosition=t||0,this.topPosition=e||0,this.rightPosition=void 0,this.bottomPosition=void 0),this.updateMiniMapPosition(),o.className="lf-mini-map",this.isShowCloseIcon||o.classList.add("lf-mini-map-no-close-icon"),this.isShowHeader||o.classList.add("lf-mini-map-no-header"),(n=this.container)===null||n===void 0||n.appendChild(o),this.miniMapWrap.appendChild(this.viewport);var i=document.createElement("div");i.className="lf-mini-map-header",i.innerText=this.headerTitle,o.appendChild(i);var a=document.createElement("span");a.className="lf-mini-map-close",a.addEventListener("click",this.hide),o.appendChild(a)},r.prototype.updateMiniMapPosition=function(){if(this.miniMapContainer){var t=this.miniMapContainer.style;this.rightPosition!==void 0?(t.right="".concat(this.rightPosition,"px"),t.left=""):(t.left="".concat(this.leftPosition,"px"),t.right=""),this.bottomPosition!==void 0?(t.bottom="".concat(this.bottomPosition,"px"),t.top=""):(t.top="".concat(this.topPosition,"px"),t.bottom="")}},r.prototype.removeMiniMap=function(){var t;this.miniMapContainer&&((t=this.container)===null||t===void 0||t.removeChild(this.miniMapContainer))},r.prototype.updateBounds=function(t){t&&this.updateElementAreaBounds(t),this.updateViewPortBounds(),this.bounds={left:Math.min(this.elementAreaBounds.left,this.viewPortBounds.left),right:Math.max(this.elementAreaBounds.right,this.viewPortBounds.right),top:Math.min(this.elementAreaBounds.top,this.viewPortBounds.top),bottom:Math.max(this.elementAreaBounds.bottom,this.viewPortBounds.bottom)}},r.prototype.updateElementAreaBounds=function(t){var e={left:0,right:0,top:0,bottom:0},n=t.nodes;n&&n.length>0&&n.forEach(function(o){var i,a,s=o.x,l=o.y,u=(i=o.width)!==null&&i!==void 0?i:200,f=(a=o.height)!==null&&a!==void 0?a:200,d=s-u/2,c=s+u/2,h=l-f/2,p=l+f/2;e.left=Math.min(d,e.left),e.right=Math.max(c,e.right),e.top=Math.min(h,e.top),e.bottom=Math.max(p,e.bottom)}),this.elementAreaBounds=e},r.prototype.updateViewPortBounds=function(){var t=this.lf.getTransform(),e=t.TRANSLATE_X,n=t.TRANSLATE_Y,o=t.SCALE_X,i=t.SCALE_Y,a=this.lf.graphModel,s=a.width,l=a.height;this.viewPortBounds={left:-e/o,right:(-e+s)/o,top:-n/i,bottom:(-n+l)/i}},r.prototype.resetData=function(t){var e=t.nodes,n=t.edges;return e.forEach(function(o){o.text=void 0}),this.showEdge&&n.forEach(function(o){o.text=void 0}),{nodes:e,edges:this.showEdge?n:[]}},r.prototype.setView=function(t){var e,n;if(t===void 0&&(t=!0),t){var o=this.lf.getGraphRawData(),i=this.resetData(o),a=this.lf.viewMap,s=this.lf.graphModel.modelMap,l=this.lfMap.viewMap;try{for(var u=V_(a.keys()),f=u.next();!f.done;f=u.next()){var d=f.value;l.has(d)||this.lfMap.register({type:d,view:a.get(d),model:s.get(d)})}}catch(j){e={error:j}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}this.lfMap.render(i),this.updateBounds(i)}else this.updateBounds();var c=this.bounds,h=c.left,p=c.top,v=c.right,g=c.bottom,y=v-h,w=g-p,M=this.width/y,C=this.height/w,P=Math.min(M,C);this.scale=P;var S=h-(this.width/P-y)/2,E=p-(this.height/P-w)/2;if(this.lfMap.graphModel.transformModel.translate(-S+this.translateX,-E+this.translateY),this.translateX=S,this.translateY=E,this.miniMapWrap.firstChild){var T=this.miniMapWrap.firstChild.style;T.pointerEvents="none",T.transform="matrix(".concat(P,", 0, 0, ").concat(P,", 0, 0)"),T.transformOrigin="left top",T.height="".concat(this.height/P,"px"),T.width="".concat(this.width/P,"px"),this.updateViewPort()}},r.prototype.updateViewPort=function(){var t=this.viewport.style,e=this.lf.getTransform(),n=e.TRANSLATE_X,o=e.TRANSLATE_Y,i=e.SCALE_X,a=e.SCALE_Y,s=this.lf.graphModel,l=s.width,u=s.height;this.viewPortLeft=-n/i,this.viewPortTop=-o/a,this.viewPortWidth=l/i*this.scale,this.viewPortHeight=u/a*this.scale,t.width="".concat(this.viewPortWidth,"px"),t.height="".concat(this.viewPortHeight,"px"),t.left="".concat((this.viewPortLeft-this.translateX)*this.scale,"px"),t.top="".concat((this.viewPortTop-this.translateY)*this.scale,"px")},r.prototype.createViewPort=function(){var t=document.createElement("div");t.className="lf-minimap-viewport",t.style.touchAction="none",t.addEventListener("pointerdown",this.startDrag),t.addEventListener("click",function(e){e.stopPropagation()}),this.viewport=t},r.prototype.destroy=function(){this.lf.off("graph:resize",this.onGraphResize)},r.pluginName="miniMap",r})(),Zd=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},qd=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},x0=(function(){function r(t){var e=t.lf,n=t.options,o=this,i;this.disabled=!0,this.isWholeNode=!0,this.isWholeEdge=!0,this.originStatusSaved=!1,this.exclusiveMode=!1,this.mouseDownInfo=null,this.originalStopMoveGraph=!1,this.handleBlankMouseDown=function(a){var s=a.e;o.handleMouseDown(s)},this.draw=function(a){if(o.lf.graphModel.editConfigModel.isPinching){o.lf.updateEditConfig({stopMoveGraph:o.originalStopMoveGraph}),o.originStatusSaved=!1,o.cleanupSelectionState();return}var s=o.lf.getPointByClient(a.clientX,a.clientY).domOverlayPosition,l=s.x,u=s.y;if(o.endPoint={x:l,y:u},o.startPoint){var f=o.startPoint,d=f.x,c=f.y,h=d,p=c,v=l-d,g=u-c;l<d&&(h=l,v=d-l),u<c&&(p=u,g=c-u),o.wrapper&&(o.wrapper.style.left="".concat(h,"px"),o.wrapper.style.top="".concat(p,"px"),o.wrapper.style.width="".concat(v,"px"),o.wrapper.style.height="".concat(g,"px"))}},this.drawOff=function(a){if(o.lf.updateEditConfig({stopMoveGraph:o.originalStopMoveGraph}),o.originStatusSaved=!1,o.mouseDownInfo){var s=o.mouseDownInfo,l=s.x,u=s.y,f=s.time,d=Math.abs(a.clientX-l)<5&&Math.abs(a.clientY-u)<5&&Date.now()-f<200;if(d){o.lf.clearSelectElements(),o.cleanupSelectionState();return}}var c=xe(o.startPoint),h=xe(o.endPoint);if(document.removeEventListener("pointermove",o.draw),o.exclusiveMode||document.removeEventListener("pointerup",o.drawOff),c&&h){var l=c.x,u=c.y,p=h.x,v=h.y,g=[Math.min(l,p),Math.min(u,v)],y=[Math.max(l,p),Math.max(u,v)];if(o.lf.emit("selection:selected-area",{topLeft:g,bottomRight:y}),Math.abs(p-l)<10&&Math.abs(v-u)<10){o.wrapper&&(o.wrapper.oncontextmenu=null,o.container&&o.wrapper.parentNode===o.container&&o.container.removeChild(o.wrapper),o.wrapper=void 0);return}var w=o.lf.graphModel.getAreaElement(g,y,o.isWholeEdge,o.isWholeNode,!0),M=o.lf.graphModel,C=M.dynamicGroup,P=M.group,S=[],E=o.lf.getSelectElements(),T=new Set(qd(qd([],Zd(E.nodes.map(function(ee){return ee.id})),!1),Zd(E.edges.map(function(ee){return ee.id})),!1));w.forEach(function(ee){if(P){var he=P.getNodeGroup(ee.id);if(w.includes(he))return}if(C){var he=C.getGroupByNodeId(ee.id);if(w.includes(he))return}if(o.exclusiveMode&&T.has(ee.id)){o.lf.deselectElementById(ee.id);return}o.lf.selectElementById(ee.id,!0),S.push(ee)}),o.startPoint=void 0,o.endPoint=void 0,S.length>0&&o.lf.emit("selection:drop",{e:a}),o.lf.emit("selection:selected",{elements:S,leftTopPoint:g,rightBottomPoint:y})}o.wrapper&&(o.wrapper.oncontextmenu=null,o.container&&o.wrapper.parentNode===o.container&&o.container.removeChild(o.wrapper),o.wrapper=void 0)},this.lf=e,this.exclusiveMode=(i=n==null?void 0:n.exclusiveMode)!==null&&i!==void 0?i:!1,e.openSelectionSelect=function(){o.openSelectionSelect()},e.closeSelectionSelect=function(){o.closeSelectionSelect()},e.setSelectionSelectMode=function(a){o.setExclusiveMode(a)},this.handleMouseDown=this.handleMouseDown.bind(this),this.draw=this.draw.bind(this),this.drawOff=this.drawOff.bind(this)}return r.prototype.render=function(t,e){this.container=e},r.prototype.cleanupSelectionState=function(){this.wrapper&&(this.wrapper.oncontextmenu=null,this.container&&this.wrapper.parentNode===this.container&&this.container.removeChild(this.wrapper),this.wrapper=void 0),this.startPoint=void 0,this.endPoint=void 0,this.mouseDownInfo=null,document.removeEventListener("pointermove",this.draw),document.removeEventListener("pointerup",this.drawOff)},r.prototype.setExclusiveMode=function(t){t===void 0&&(t=!1),this.exclusiveMode!==t&&(this.cleanupSelectionState(),this.exclusiveMode=t,this.container&&!this.disabled&&(this.removeEventListeners(),this.addEventListeners()))},r.prototype.addEventListeners=function(){this.container&&(this.exclusiveMode?(this.container.style.pointerEvents="auto",this.container.style.touchAction="none",this.container.addEventListener("pointerdown",this.handleMouseDown)):(this.container.style.pointerEvents="none",this.lf.on("blank:mousedown",this.handleBlankMouseDown)))},r.prototype.removeEventListeners=function(){this.container&&(this.container.style.pointerEvents="none",this.container.removeEventListener("pointerdown",this.handleMouseDown)),this.lf.off("blank:mousedown",this.handleBlankMouseDown)},r.prototype.handleMouseDown=function(t){var e;if(!(!this.container||this.disabled)&&!this.lf.graphModel.editConfigModel.isPinching){var n=t.button===2;if(!n){this.cleanupSelectionState(),this.mouseDownInfo={x:t.clientX,y:t.clientY,time:Date.now()},this.originStatusSaved||(this.originalStopMoveGraph=this.lf.getEditConfig().stopMoveGraph,this.originStatusSaved=!0),this.lf.updateEditConfig({stopMoveGraph:!0});var o=this.lf.getPointByClient(t.clientX,t.clientY).domOverlayPosition,i=o.x,a=o.y;this.startPoint={x:i,y:a},this.endPoint={x:i,y:a};var s=document.createElement("div");s.className="lf-selection-select",s.oncontextmenu=function(u){u.preventDefault()},s.style.top="".concat(this.startPoint.y,"px"),s.style.left="".concat(this.startPoint.x,"px"),(e=this.container)===null||e===void 0||e.appendChild(s),this.wrapper=s,document.addEventListener("pointermove",this.draw),document.addEventListener("pointerup",this.drawOff)}}},r.prototype.setSelectionSense=function(t,e){t===void 0&&(t=!0),e===void 0&&(e=!0),this.isWholeEdge=t,this.isWholeNode=e},r.prototype.openSelectionSelect=function(){this.disabled||this.closeSelectionSelect(),this.container&&(this.cleanupSelectionState(),this.addEventListeners(),this.open())},r.prototype.closeSelectionSelect=function(){if(this.container){if(this.wrapper&&this.startPoint&&this.endPoint){var t=xe(this.endPoint),e=new PointerEvent("pointerup",{clientX:t.x,clientY:t.y});this.drawOff(e)}this.cleanupSelectionState(),this.removeEventListeners(),this.close()}},r.prototype.open=function(){this.disabled=!1},r.prototype.close=function(){this.disabled=!0},r.pluginName="selectionSelect",r})();var Gc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),jn=function(){return jn=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},jn.apply(this,arguments)},jo=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},K_={tr:"tl",lb:"tl",tl:"tr",rb:"tr",br:"bl",lt:"bl",bl:"br",rt:"br"};function Z_(r){for(var t=r,e=1;e<t.length-1;){var n=jo(t[e-1],2),o=n[0],i=n[1],a=jo(t[e],2),s=a[0],l=a[1],u=jo(t[e+1],2),f=u[0],d=u[1];o===s&&s===f||i===l&&l===d?t.splice(e,1):e++}return t}function q_(r,t,e,n){var o=[r[0],r[1]],i=[r[0],r[1]];switch(e){case"tl":return t==="tr"?(o[1]+=n,i[0]+=n):t==="lb"&&(o[0]+=n,i[1]+=n),[o,i];case"tr":return t==="tl"?(o[1]+=n,i[0]-=n):t==="rb"&&(o[0]-=n,i[1]+=n),[o,i];case"bl":return t==="br"?(o[1]-=n,i[0]+=n):t==="lt"&&(o[0]+=n,i[1]-=n),[o,i];case"br":return t==="bl"?(o[1]-=n,i[0]-=n):t==="rt"&&(o[0]-=n,i[1]-=n),[o,i];default:return[]}}function J_(r,t,e,n){var o,i="",a="";r[0]===t[0]?i=r[1]>t[1]?"t":"b":r[1]===t[1]&&(i=r[0]>t[0]?"l":"r"),t[0]===e[0]?a=t[1]>e[1]?"t":"b":t[1]===e[1]&&(a=t[0]>e[0]?"l":"r");var s=Math.min(Math.hypot(t[0]-r[0],t[1]-r[1])/2,Math.hypot(e[0]-t[0],e[1]-t[1])/2,n)||1/5*n,l="".concat(i).concat(a),u=K_[l]||"-",f="L ".concat(r[0]," ").concat(r[1]);if(u==="-")f+="L ".concat(t[0]," ").concat(t[1]," L ").concat(e[0]," ").concat(e[1]);else{var d=jo(q_(t,l,u,s),2),c=d[0],h=d[1];c&&h&&(f+="L ".concat(c[0]," ").concat(c[1]," Q ").concat(t[0]," ").concat(t[1]," ").concat(h[0]," ").concat(h[1]),o=jo(h,2),t[0]=o[0],t[1]=o[1])}return f}function Q_(r,t){var e=0,n="";if(r.length===2)n+="M".concat(r[e][0]," ").concat(r[e++][1]," L ").concat(r[e][0]," ").concat(r[e][1]);else{for(n+="M".concat(r[e][0]," ").concat(r[e++][1]);e+1<r.length;){var o=r[e-1],i=r[e],a=r[e+++1];n+=J_(o,i,a,t)}n+="L ".concat(r[e][0]," ").concat(r[e][1])}return n}(function(r){Gc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getEdge=function(){var e=this.props.model,n=e.points,o=e.isAnimation,i=e.arrowConfig,a=e.radius,s=a===void 0?5:a,l=e.getEdgeStyle(),u=e.getEdgeAnimationStyle(),f=Z_(n.split(" ").map(function(h){return h.split(",").map(function(p){return+p})})),d=Q_(f,s),c=jn(jn(jn({style:o?u:{}},l),i),{fill:"none"});return ce("path",jn({d},c))},t})(Qo);(function(r){Gc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(qo);var zc=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),Ra=function(){return Ra=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ra.apply(this,arguments)},Jd=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return i},Qd=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},e0=(function(r){zc(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getLabelShape=function(){var e=this.props.model,n=e.id,o=e.x,i=e.y,a=e.width,s=e.height,l=e.properties,u=this.props.model.getNodeStyle();return ce("svg",{x:o-a/2,y:i-s/2,width:50,height:24,style:"z-index: 0; background: none; overflow: auto;"},[l.labelText?ce("text",{x:0,y:-5,fontSize:"16px",fill:u.stroke},l.labelText):"",l.disabledDelete?"":ce("text",{x:l.labelText?50:0,y:-5,fontSize:"24px",cursor:"pointer",fill:u.stroke,onclick:this.handleCustomDeleteIconClick.bind(this,n)},"x")])},t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.id,l=this.props.model.getNodeStyle();return ce("g",{},[ce("rect",Ra(Ra({},l),{x:n-i/2,y:o-a/2,width:i,height:a,id:s})),this.getLabelShape()])},t.prototype.toFront=function(){},t.prototype.handleCustomDeleteIconClick=function(e){var n=this.props.graphModel;n.deleteNode(e)},t})(pa),t0=(function(r){zc(t,r);function t(){var e=r.apply(this,Qd([],Jd(arguments),!1))||this;return e.d=10,e.isResize=!1,e}return t.prototype.initNodeData=function(e){e.text={value:"",x:e.x,y:e.y,draggable:!1,editable:!1},r.prototype.initNodeData.call(this,e),this.zIndex=0,this.draggable=!0},t.prototype.setAttributes=function(){var e=this,n;this.points=[],((n=this.properties)===null||n===void 0?void 0:n.node_selection_ids).length>1&&setTimeout(function(){var o;e.updatePointsByNodes(((o=e.properties)===null||o===void 0?void 0:o.node_selection_ids)||[])})},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this);return e.stroke=this.properties.strokeColor||"#008000",e.strokeDasharray="10 5",e},t.prototype.getDefaultAnchor=function(){return[]},t.prototype.updatePoints=function(e){this.points=e},t.prototype.updateCoordinate=function(e){var n=e.x,o=e.y;this.x=n,this.y=o},t.prototype.updatePointsByNodes=function(e){var n=this,o=[],i=1/0,a=1/0,s=-1/0,l=-1/0;e.forEach(function(u){var f=n.graphModel.getNodeModelById(u);if(f){var d=f.width,c=f.height,h=f.x,p=f.y;i=Math.min(i,h-d/2-n.d),a=Math.min(a,p-c/2-n.d),s=Math.max(s,h+d/2+n.d),l=Math.max(l,p+c/2+n.d)}}),o.push([i,a],[s,a],[s,l],[i,l]),![i,a,s,l].some(function(u){return Math.abs(u)===1/0})&&(this.updatePoints(o),this.updateCoordinate({x:(s+i)/2,y:(l+a)/2}))},t.prototype.resize=function(e){var n;this.isResize=!0;for(var o=e.width,i=e.height,a={x:o/this.width,y:i/this.height},s=(this.properties.node_selection_ids||[]).slice(),l=[],u=new Set;s.length;){var f=s.shift(),d=(n=this.graphModel.nodesMap[f])===null||n===void 0?void 0:n.model;if(d){if(!Hi(d)){l.push(d);continue}u.has(d.id)||(u.add(d.id),s.push.apply(s,Qd([],Jd(d.properties.node_selection_ids||[]),!1)))}}var c={x:this.x-this.width/2,y:this.y-this.height/2},h=r.prototype.resize.call(this,e),p={x:this.x-this.width/2,y:this.y-this.height/2};return l.forEach(function(v){v.width=v.width*a.x,v.height=v.height*a.y;var g=(v.x-c.x)*a.x+p.x-v.x,y=(v.y-c.y)*a.y+p.y-v.y;v.move(g,y,!0)}),this.isResize=!1,h},t})(ua),gl="node-selection";(function(){function r(t){var e=t.lf;this.selectNodes=[],this.d=10,this.lf=e,e.register({type:gl,view:e0,model:t0})}return Object.defineProperty(r.prototype,"selectNodesIds",{get:function(){return this.selectNodes.map(function(t){return t.id})},enumerable:!1,configurable:!0}),r.prototype.addNodeSelection=function(){var t=this.lf.addNode({type:"node-selection",text:"",properties:{node_selection_ids:this.selectNodesIds},x:0,y:0});t.updatePointsByNodes(this.selectNodesIds)},r.prototype.updateNodeSelection=function(){var t,e=this.getNodeSelection();e&&(this.lf.setProperties(e.id,{node_selection_ids:this.selectNodesIds}),(t=this.lf.getNodeModelById(e.id))===null||t===void 0||t.updatePointsByNodes(this.selectNodesIds))},r.prototype.getNodeSelection=function(){var t=this,e=this.selectNodesIds,n=this.lf.getGraphRawData(),o=e.filter(function(i){return i!==t.currentClickNode.id});return n.nodes.find(function(i){if(i.type==="node-selection"){var a=ei(i,"properties.node_selection_ids",[]);return o.every(function(s){return a.includes(s)})}return!1})},r.prototype.onNodeChange=function(t,e){var n=t.graphModel.nodes.filter(function(o){if(!Hi(o))return!1;var i=o.properties.node_selection_ids||[];return i.includes(e.id)});Promise.resolve().then(function(){n.forEach(function(o){o.updatePointsByNodes(o.properties.node_selection_ids||[])})})},r.prototype.render=function(t){var e=this;this.lf=t,t.on("node:click",function(n){var o;if(!(!n.e.shiftKey||n.data.type===gl)){e.currentClickNode=n.data;var i=!1;e.selectNodesIds.includes(n.data.id)&&((o=e.lf.getNodeModelById(n.data.id))===null||o===void 0||o.setSelected(!1),i=!0);var a=t.getSelectElements(!0).nodes;e.selectNodes=a,e.selectNodes.length===1?i?e.updateNodeSelection():e.addNodeSelection():e.selectNodes.length>1&&e.updateNodeSelection()}}),t.graphModel.addNodeMoveRules(function(n,o,i){if(e.onNodeChange(t,n),Hi(n)&&!n.isResize){var a=n.properties.node_selection_ids||[];return t.graphModel.moveNodes(a,o,i,!0),!0}return!0}),t.graphModel.addNodeResizeRules(function(n){return Hi(n)||e.onNodeChange(t,n),!0})},r.pluginName="node-selection",r})();var Hi=function(r){return!!(r&&r.type===gl)},r0=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),La=function(){return La=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},La.apply(this,arguments)};(function(r){r0(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getLabelShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=e.properties;return ce("text",{x:n-i/2+5,y:o-a/2+16,fontSize:12,fill:"blue"},s.moreText)},t.prototype.getShape=function(){var e=this.props.model,n=e.x,o=e.y,i=e.width,a=e.height,s=this.props.model.getNodeStyle();return ce("g",{},[ce("rect",La(La({},s),{fill:"#FFFFFF",x:n-i/2,y:o-a/2})),this.getLabelShape()])},t})(gn);var n0=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),un=function(){return un=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},un.apply(this,arguments)},o0=(function(r){n0(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.setAttributes=function(){var e=this.properties,n=e.width,o=e.height,i=e.radius;Rt(n)||(this.width=n),Rt(o)||(this.height=o),Rt(i)||(this.radius=i)},t.prototype.getTextStyle=function(){var e=this.properties,n=e.refX,o=n===void 0?0:n,i=e.refY,a=i===void 0?0:i,s=e.textStyle,l=r.prototype.getTextStyle.call(this);return un(un(un({},l),xe(s)||{}),{transform:"matrix(1 0 0 1 ".concat(o," ").concat(a,")")})},t.prototype.getNodeStyle=function(){var e=r.prototype.getNodeStyle.call(this),n=this.properties.style;return un(un({},e),xe(n)||{})},t})(da),Yc={};function w0(r,t){var e=r.type,n=r.component,o=r.effect,i=r.view,a=r.model;if(!e)throw new Error("You should specify type in config");Yc[e]={component:n,effect:o},t.register({type:e,view:i||f0,model:a||o0})}var io=!1,qn=new Map,Jn=new Map,ja=eh({});function i0(r,t,e,n,o){io&&(o.isMiniMap&&l0(e,o.flowId),ja[r]=rh(of({render:function(){return ko(nh,{to:e},[ko(t,{node:n,graph:o})])},provide:function(){return{getNode:function(){return n},getGraph:function(){return o}}}})))}function a0(r,t){if(io&&(delete ja[r],qn.has(t))){var e=Jn.get(t)||[],n=e.indexOf(r);n>-1&&(e.splice(n,1),e.length===0?u0(t):Jn.set(t,e))}}function ef(){return io}function s0(){return io=!0,of({props:{flowId:{type:String,required:!0}},setup:function(r){return function(){var t=[];return Object.keys(ja).forEach(function(e){if(e.startsWith(r.flowId)){if(qn.has(r.flowId)){var n=Jn.get(r.flowId)||[];n.includes(e)||(n.push(e),Jn.set(r.flowId,n))}t.push(ja[e])}}),ko(th,{},t.map(function(e){return ko(e)}))}}})}function l0(r,t){if(!(!t||!r||!io)){var e=s0();if(!qn.has(t)){var n=document.createElement("div");r.appendChild(n);var o=af(e,{flowId:t});o.mount(n),qn.set(t,o),Jn.set(t,[])}}}function u0(r){if(!(!r||!io)){var t=qn.get(r);t&&(t.unmount(),qn.delete(r),Jn.delete(r))}}var d0=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),f0=(function(r){d0(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getComponentContainer=function(){return this.root},t.prototype.targetId=function(){return"".concat(this.props.graphModel.flowId,":").concat(this.props.model.id)},t.prototype.componentWillUnmount=function(){r.prototype.componentWillUnmount.call(this),this.unmount()},t.prototype.setHtml=function(e){var n=document.createElement("div");n.className="custom-vue-node-content",this.root=n,e.appendChild(n),this.renderVueComponent()},t.prototype.confirmUpdate=function(e){},t.prototype.renderVueComponent=function(){var e;this.unmountVueComponent();var n=this.getComponentContainer(),o=this.props,i=o.model,a=o.graphModel;if(n){var s=Yc[i.type].component;s&&(ef()?i0(this.targetId(),s,n,i,a):(this.vm=af({render:function(){return ko(s,{node:i,graph:a})},provide:function(){return{getNode:function(){return i},getGraph:function(){return a}}}}),(e=this.vm)===null||e===void 0||e.mount(n)))}},t.prototype.unmountVueComponent=function(){var e=this.getComponentContainer();return this.vm&&(this.vm.unmount(),this.vm=null),e&&(e.innerHTML=""),e},t.prototype.unmount=function(){ef()&&a0(this.targetId(),this.props.graphModel.flowId),this.unmountVueComponent()},t})(va);export{ld as B,m0 as D,va as H,g0 as L,_0 as M,Qo as P,x0 as S,ce as _,qo as a,qu as b,da as c,C_ as d,y0 as e,s0 as g,w0 as r};
//# sourceMappingURL=logicflow-DKG0_Fp4.js.map
