import{f as C,aw as T,r as N,ac as c,ad as f,k as t,ar as e,aE as S,aF as z,u as d,G as s,F as U,ax as H,at as m,as as u}from"./vue-chunks-CGLjTDrY.js";import{f as K,a as X,u as Y,h as Z}from"./index-BOfoaUzR.js";import{_ as V}from"../../index-WMhSApoa.js";import{F as P,e as ee,I as te,v as E,ah as p,y as ne,z as le,Q as L,M as D,b as B,a6 as oe,B as ae,E as se,J as ie,G as de,W as ue}from"./ui-antd-BDReVt-O.js";import"./neo4j-CK9lNpyi.js";import"./utils-DXEytJvC.js";import"./other-BrZCAsTs.js";const re={class:"add-data-sheet"},pe={__name:"add-field-modal",emits:["ok"],setup(J,{expose:I,emit:q}){const k=C("添加字段"),h=T().query,v=C(!1),x=q,F=[{label:"string",value:"string"},{label:"integer",value:"integer"},{label:"number",value:"number"},{label:"boolean",value:"boolean"}],l=N({name:"",description:"",type:void 0,required:"false",form_id:h.form_id,id:""}),o=a=>{v.value=!0,_(),l.name=a.name||"",l.description=a.description||"",l.type=a.type,l.required=a.required,l.id=a.id||"",k.value=a.id?"编辑字段":"添加字段"},O=N({name:[{required:!0,validator:async(a,n)=>/^[a-z][a-z0-9_]*$/.test(n)?Promise.resolve():Promise.reject("必须以英文字母开头，只能包含小写字母、数字、下划线")}],description:[{required:!0,message:"请输入字段描述"}],type:[{required:!0,message:"请选择数据类型"}]}),r=P.useForm,{resetFields:_,validate:$,validateInfos:g}=r(l,O),R=()=>{$().then(()=>{K(l).then(a=>{let n=l.id?"修改成功":"新增成功";B.success(n),v.value=!1,x("ok")})})};return I({show:o}),(a,n)=>{const b=E,M=te,w=ee,A=le,G=ne,Q=L,j=P,W=D;return f(),c("div",re,[t(W,{open:v.value,"onUpdate:open":n[4]||(n[4]=i=>v.value=i),title:k.value,onOk:R,width:540},{default:e(()=>[t(j,{layout:"vertical"},{default:e(()=>[t(w,S(z(d(g).name)),{label:e(()=>[n[6]||(n[6]=s("字段名称  ",-1)),t(b,null,{title:e(()=>[...n[5]||(n[5]=[s("定义数据表的表头，可以在对应表头下存储相关数据。",-1)])]),default:e(()=>[t(d(p))]),_:1})]),default:e(()=>[t(M,{maxLength:64,value:l.name,"onUpdate:value":n[0]||(n[0]=i=>l.name=i),placeholder:"请输入字段名称"},null,8,["value"])]),_:1},16),t(w,S(z(d(g).description)),{label:e(()=>[n[8]||(n[8]=s("字段描述  ",-1)),t(b,null,{title:e(()=>[...n[7]||(n[7]=[s("表头字段的说明，帮助用户或大模型理解表头字段",-1)])]),default:e(()=>[t(d(p))]),_:1})]),default:e(()=>[t(M,{maxLength:64,value:l.description,"onUpdate:value":n[1]||(n[1]=i=>l.description=i),placeholder:"请输入字段描述"},null,8,["value"])]),_:1},16),t(w,S(z(d(g).type)),{label:e(()=>[n[10]||(n[10]=s("数据类型  ",-1)),t(b,null,{title:e(()=>[...n[9]||(n[9]=[s("选择存储字段对应的数据类型",-1)])]),default:e(()=>[t(d(p))]),_:1})]),default:e(()=>[t(G,{value:l.type,"onUpdate:value":n[2]||(n[2]=i=>l.type=i),style:{width:"100%"},placeholder:"请选择数据类型"},{default:e(()=>[(f(),c(U,null,H(F,i=>t(A,{value:i.value,key:i.value},{default:e(()=>[s(m(i.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},16),t(w,null,{label:e(()=>[n[12]||(n[12]=s("是否必要  ",-1)),t(b,null,{title:e(()=>[...n[11]||(n[11]=[u("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1),u("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)])]),default:e(()=>[t(d(p))]),_:1})]),default:e(()=>[t(Q,{checked:l.required,"onUpdate:checked":n[3]||(n[3]=i=>l.required=i),"checked-children":"开","un-checked-children":"关",checkedValue:"true",unCheckedValue:"false"},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["open","title"])])}}},_e=V(pe,[["__scopeId","data-v-85152a05"]]),me={class:"field-manage-page"},ce={class:"page-title"},fe={class:"table-wrapper customize-scroll-style"},ve={key:0},ke={key:1},ye={key:0},ge={key:1},qe=["onClick"],xe=["onClick"],Fe={__name:"index",setup(J){const q=T().query,k=C([]),y=()=>{X({form_id:q.form_id}).then(l=>{k.value=l.data||[]})};y();const h=l=>{Y({id:l.id,form_id:q.form_id,required:l.required=="true"?"false":"true"}).then(o=>{B.success("修改成功"),y()})},v=l=>{D.confirm({title:"删除确认",icon:t(ue),content:`删除后，字段下所有数据将一并删除，删除后不可恢复。确认删除字段${l.name}吗?`,okText:"确 定",okType:"danger",cancelText:"取 消",onOk(){Z({id:l.id}).then(o=>{B.success("删除成功"),y()})},onCancel(){}})},x=C(null),F=(l={})=>{x.value.show(JSON.parse(JSON.stringify(l)))};return(l,o)=>{const O=ae,r=E,_=se,$=L,g=ie,R=de;return f(),c(U,null,[u("div",me,[u("div",ce,[o[2]||(o[2]=s(" 字段管理 ",-1)),t(O,{type:"primary",onClick:o[0]||(o[0]=a=>F())},{icon:e(()=>[t(d(oe))]),default:e(()=>[o[1]||(o[1]=s(" 添加字段 ",-1))]),_:1})]),u("div",fe,[t(R,{pagination:!1,"data-source":k.value},{default:e(()=>[t(_,{key:"name","data-index":"name",width:150},{title:e(()=>[o[4]||(o[4]=s(" 字段名称 ",-1)),t(r,null,{title:e(()=>[...o[3]||(o[3]=[s("定义数据表的表头，可以在对应表头下存储相关数据。",-1)])]),default:e(()=>[t(d(p))]),_:1})]),default:e(({record:a})=>[a.name.length>50?(f(),c("span",ve,[t(r,null,{title:e(()=>[s(m(a.name),1)]),default:e(()=>[s(" "+m(a.name.slice(0,50)+"..."),1)]),_:2},1024)])):(f(),c("span",ke,m(a.name),1))]),_:1}),t(_,{key:"description","data-index":"description",width:150},{title:e(()=>[o[6]||(o[6]=s(" 字段描述 ",-1)),t(r,null,{title:e(()=>[...o[5]||(o[5]=[s("表头字段的说明，帮助用户或大模型理解表头字段",-1)])]),default:e(()=>[t(d(p))]),_:1})]),default:e(({record:a})=>[a.description.length>50?(f(),c("span",ye,[t(r,null,{title:e(()=>[s(m(a.description),1)]),default:e(()=>[s(" "+m(a.description.slice(0,50)+"..."),1)]),_:2},1024)])):(f(),c("span",ge,m(a.description),1))]),_:1}),t(_,{key:"type","data-index":"type",width:120},{title:e(()=>[o[8]||(o[8]=s(" 数据类型 ",-1)),t(r,null,{title:e(()=>[...o[7]||(o[7]=[s("选择存储字段对应的数据类型",-1)])]),default:e(()=>[t(d(p))]),_:1})]),_:1}),t(_,{key:"required","data-index":"required",width:120},{title:e(()=>[o[10]||(o[10]=s(" 是否必要 ",-1)),t(r,null,{title:e(()=>[...o[9]||(o[9]=[u("div",null,"必要字段：在保存一行数据时，必须提供对应字段信息，否则无法保存该行数据",-1),u("div",null,"非必要字段：缺失该字段信息时，一行数据仍可被保存在表中",-1)])]),default:e(()=>[t(d(p))]),_:1})]),default:e(({record:a})=>[t($,{onChange:n=>h(a),checked:a.required=="true","checked-children":"开","un-checked-children":"关"},null,8,["onChange","checked"])]),_:1}),t(_,{key:"action",title:"操作",width:90},{default:e(({record:a})=>[u("span",null,[u("a",{onClick:n=>F(a)},"编辑",8,qe),t(g,{type:"vertical"}),u("a",{onClick:n=>v(a)},"删除",8,xe)])]),_:1})]),_:1},8,["data-source"])])]),t(_e,{onOk:y,ref_key:"addFieldModalRef",ref:x},null,512)],64)}}},Se=V(Fe,[["__scopeId","data-v-7f6a3079"]]);export{Se as default};
