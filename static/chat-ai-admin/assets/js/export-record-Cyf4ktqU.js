import{_ as E}from"./date-BMtcJDpd.js";import{h as F}from"./index-BuDcjXHQ.js";import{ah as I,r as $,E as q,a as i,p as y,v as l,u as s,y as r,t as h,b as o,q as u,F as x,_ as m,e as T}from"./vue-chunks-BdaA73Wf.js";import{u as B,d as N}from"../../index-DSFcP5NQ.js";import{d as O}from"./utils-CvB22N-W.js";import{_ as V}from"./emoji-mart-BBMRoEa3.js";import{m as Y,x as H,b5 as L,a0 as M,ad as Q,aO as R,q as U,ac as j}from"./ui-antd-Dl1wwwCD.js";import"./editor-cherry-CFIsbKoN.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./other-LrIFyvU9.js";const J={class:"user-model-page"},P={class:"page-title"},A={class:"list-wrapper"},G={class:"content-wrapper"},K={class:"search-block"},W={key:0,class:"status-item status-0"},X={key:1,class:"status-item status-1"},Z={key:2,class:"status-item status-2"},tt={key:3,class:"status-item status-3"},et=["onClick"],st={key:1},at={__name:"export-record",setup(ot){const{t}=B("views.library.library-details.export-record"),C=N(),k=I().query,f=$([]),a=q({library_id:k.id,source:2,page:1,size:10,total:0,start_time:"",end_time:""}),b=e=>{a.page=e.current,a.size=e.pageSize,v()},w=()=>{a.page=1,v()},D=e=>{a.start_time=e.start_time,a.end_time=e.end_time,w()},v=()=>{F({...a}).then(e=>{let d=e.data.list,_=e.data.map;d.forEach(n=>{var p;n.create_time_desc=O(n.create_time*1e3).format("YYYY/MM/DD HH:mm"),n.source_desc=(p=_.filter(g=>g.source==n.source)[0])==null?void 0:p.source_name,n.is_over_7_days=n.create_time<Date.now()/1e3-10080*60}),f.value=d,a.total=+e.data.total})},S=e=>{let d=`/manage/downloadExportFile?id=${e.id}&library_id=${k.id}&token=${C.getToken}`;var _=document.createElement("a");_.href=d,_.style.display="none",_.click()},z=[{title:t("column_export_time"),dataIndex:"create_time_desc",key:"create_time_desc"},{title:t("column_file_name"),dataIndex:"file_name",key:"file_name"},{title:t("column_source"),key:"source_desc",dataIndex:"source_desc"},{title:t("column_status"),key:"status",dataIndex:"status"},{title:t("column_action"),key:"action"}];return(e,d)=>{const _=Y,n=U,p=H;return o(),i("div",J,[y("div",P,l(s(t)("title")),1),y("div",A,[y("div",G,[r(_,{"show-icon":"",message:s(t)("alert_message")},null,8,["message"]),y("div",K,[r(E,{datekey:"2",onDateChange:D})]),r(p,{class:"table-list",columns:z,"data-source":f.value,pagination:{current:a.page,total:a.total,pageSize:a.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:b},{bodyCell:h(({column:g,record:c})=>[g.key==="status"?(o(),i(x,{key:0},[c.status==0?(o(),i("div",W,[r(s(L)),m(l(s(t)("status_waiting")),1)])):u("",!0),c.status==1?(o(),i("div",X,[r(s(M)),m(l(s(t)("status_exporting")),1)])):u("",!0),c.status==2?(o(),i("div",Z,[r(s(Q)),m(l(s(t)("status_success")),1)])):u("",!0),c.status==3?(o(),i("div",tt,[r(s(R)),m(l(s(t)("status_failed"))+" ",1),c.err_msg?(o(),T(n,{key:0},{title:h(()=>[m(l(c.err_msg),1)]),default:h(()=>[r(s(j))]),_:2},1024)):u("",!0)])):u("",!0)],64)):u("",!0),g.key==="action"?(o(),i(x,{key:1},[c.is_over_7_days?(o(),i("span",st,"--")):(o(),i("a",{key:0,onClick:it=>S(c)},l(s(t)("action_download")),9,et))],64)):u("",!0)]),_:1},8,["data-source","pagination"])])])])}}},kt=V(at,[["__scopeId","data-v-142228c7"]]);export{kt as default};
//# sourceMappingURL=export-record-Cyf4ktqU.js.map
