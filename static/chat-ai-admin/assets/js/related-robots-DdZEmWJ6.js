import{_ as U}from"./cu-scroll-BxmqGNDQ.js";import{_ as D}from"./empty-DkpCLaix.js";import{f as p,a1 as k,_ as i,a2 as _,Y as d,ae as E,a5 as t,k as m,a7 as v,F as w,a9 as $,u as N,ab as V,o as F,r as O,G as P}from"./vue-chunks-yZ4gwLzA.js";import{b as B,f as j,h as q,bD as G,bE as K}from"../../index-CuFGOJXl.js";import{aj as M,N as Y,E as z,M as H,B as J,a2 as Q,a as W}from"./ui-antd-BKjlZQNA.js";import{g as X}from"./index-CfeGYFjs.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./utils-smNh_pj2.js";const Z={key:0,class:"form-wrapper"},ee={class:"select"},te={class:"tools-wrapper"},oe=["src"],se={class:"item-name"},ae={key:1,class:"form-wrapper"},le={class:"select"},ne={class:"tools-wrapper"},ie={class:"item-name"},re={key:2,class:"form-wrapper"},ce={class:"select"},de={class:"tools-wrapper"},ue={class:"item-name"},_e={key:3,class:"empty-box"},ve={__name:"see-model-alert",props:{robotList:{type:Array,default:null},libraryList:{type:Array,default:null},formList:{type:Array,default:null},currentTitle:{type:String,default:"关联机器人"}},emits:["save"],setup(L,{expose:x,emit:y}){const g=M.PRESENTED_IMAGE_SIMPLE,I=y,f=L,o=p([]),c=p(""),{t:R}=j(),b=p(!1),u=p([]),h=a=>{const e=[];return a.map(n=>{e.push(n.id)}),e},S=(a,e,n)=>{o.value=[],c.value=a,c.value==="robot"?(u.value=f.robotList,e&&e==="edit"&&n&&(o.value=h(n.managed_robot_list))):c.value==="library"?(u.value=f.libraryList,e&&e==="edit"&&n&&(o.value=h(n.managed_library_list))):c.value==="form"&&(u.value=f.formList,e&&e==="edit"&&n&&(o.value=h(n.managed_form_list))),b.value=!0},A=()=>{b.value=!1,u.value.length&&I("save",o.value)},r=()=>{};return x({open:S}),(a,e)=>{const n=Y,l=z,C=M,T=H;return i(),k(T,{class:"add-model-alert",width:"800px",open:b.value,"onUpdate:open":e[3]||(e[3]=s=>b.value=s),title:L.currentTitle,onOk:A,onCancel:r},{default:_(()=>[c.value==="robot"?(i(),d("div",Z,[t("div",ee," 已选择("+v(o.value.length)+") ",1),m(l,{class:"list-box",value:o.value,"onUpdate:value":e[0]||(e[0]=s=>o.value=s)},{default:_(()=>[(i(!0),d(w,null,$(u.value,s=>(i(),k(n,{class:"list-item",key:s.id,value:s.id},{default:_(()=>[t("div",te,[t("img",{class:"model-logo",src:s.robot_avatar,alt:""},null,8,oe),t("div",se,v(s.robot_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="library"?(i(),d("div",ae,[t("div",le," 已选择("+v(o.value.length)+") ",1),m(l,{class:"list-box",value:o.value,"onUpdate:value":e[1]||(e[1]=s=>o.value=s)},{default:_(()=>[(i(!0),d(w,null,$(u.value,s=>(i(),k(n,{class:"list-item",key:s.id,value:s.id},{default:_(()=>[t("div",ne,[t("div",ie,v(s.library_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="form"?(i(),d("div",re,[t("div",ce," 已选择("+v(o.value.length)+") ",1),m(l,{class:"list-box",value:o.value,"onUpdate:value":e[2]||(e[2]=s=>o.value=s)},{default:_(()=>[(i(!0),d(w,null,$(u.value,s=>(i(),k(n,{class:"list-item",key:s.id,value:s.id},{default:_(()=>[t("div",de,[t("div",ue,v(s.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):E("",!0),u.value.length?E("",!0):(i(),d("div",_e,[m(C,{image:N(g)},null,8,["image"])]))]),_:1},8,["open","title"])}}},pe=B(ve,[["__scopeId","data-v-a5d4de58"]]),me={class:"robot-page"},fe={class:"associated-robot"},be={class:"associated-robot-title"},he={class:"list-box"},ye=["onClick"],ge={class:"list-item"},ke={class:"robot-info"},we=["src"],$e={class:"robot-info-content"},Le={class:"robot-name"},xe={class:"robot-type-tag"},Re={class:"robot-desc"},Se={key:0,class:"empty-box"},Ae={__name:"related-robots",setup(L){const x=q(),y=p(null),g=p([]),f=V().query,o=p([]),c=p(!1),R=()=>{c.value=!0,G({id:f.id}).then(r=>{o.value=r.data||[],x.setRobotNums(o.value.length)}).finally(()=>{c.value=!1})};F(()=>{R()}),O({managed_robot_list:[]});const b=async()=>{await h(),y.value.open("robot")},u=(r,a)=>{const e=new Set(a.map(l=>l.id));return r.filter(l=>l.application_type==="0").filter(l=>!e.has(l.id))},h=async()=>{await X().then(r=>{g.value=u(r.data,o.value)}).catch(()=>{})},S=r=>{let a={library_id:f.id,robot_ids:r.join(",")};K(a).then(e=>{W.success("操作成功"),R()}).catch(()=>{})},A=({id:r,robot_key:a,application_type:e})=>{e==0?window.open(`#/robot/config/basic-config?id=${r}&robot_key=${a}`):window.open(`#/robot/config/workflow?id=${r}&robot_key=${a}`)};return(r,a)=>{const e=J,n=U;return i(),d("div",me,[m(n,null,{default:_(()=>[t("div",fe,[t("div",be,"已关联机器人 ("+v(o.value.length)+")",1),m(e,{type:"primary",onClick:b},{icon:_(()=>[m(N(Q))]),default:_(()=>[a[0]||(a[0]=P(" 关联机器人 ",-1))]),_:1})]),t("div",he,[(i(!0),d(w,null,$(o.value,l=>(i(),d("div",{class:"list-item-wrapper",key:l.id,onClick:C=>A(l)},[t("div",ge,[t("div",ke,[t("img",{class:"robot-avatar",src:l.robot_avatar,alt:""},null,8,we),t("div",$e,[t("div",Le,v(l.robot_name),1),t("div",xe,v(l.application_type==0?"聊天机器人":"工作流"),1)])]),t("div",Re,v(l.robot_intro),1)])],8,ye))),128))]),o.value.length==0&&!c.value?(i(),d("div",Se,[...a[1]||(a[1]=[t("img",{src:D,alt:""},null,-1),t("div",{class:"title"},"暂无数据",-1)])])):E("",!0)]),_:1}),m(pe,{ref_key:"seeModelAlertRef",ref:y,currentTitle:"关联机器人",robotList:g.value,onSave:S},null,8,["robotList"])])}}},Ve=B(Ae,[["__scopeId","data-v-bd91d8b6"]]);export{Ve as default};
