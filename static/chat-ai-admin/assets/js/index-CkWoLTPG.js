import{b as B,M as D,k as w,B as P,af as G,$ as T,ag as X,E as Z,ah as H,ai as J,aj as K}from"../../index-CzPebXix.js";import{S as Q,a as W}from"./index-6HDf6TPN.js";import{_ as Y}from"./index-BFhVTGQQ.js";import{I as M}from"./Input-DFtZp9vk.js";import{d as u,z as E,S as R,O as g,U as p,X as l,j as s,N as O,a1 as oo,_ as F,F as to,G as N,u as eo,Z as ao,a6 as no}from"./vue-chunks-BRsu9_To.js";import{_ as q,F as z}from"./index-BgVvqN-n.js";import{_ as A}from"./TextArea-DrgXbuSS.js";import{_ as lo}from"./index-CBmR-lHY.js";import{a as so}from"./index-Bh3NMpRp.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Trigger-Bvakuge0.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./index-Bxqtz4sn.js";import"./slide-CsbPJG8I.js";import"./index-Bhf8G0AA.js";import"./List-D7uk7Chm.js";import"./useMergedState-C0iIHNGF.js";import"./DownOutlined-DXKkgIsm.js";import"./CheckOutlined-Mk6nTpyE.js";import"./SearchOutlined-a_gTycfl.js";import"./FormItemContext-B2RmG14m.js";import"./move-CkiYyFmr.js";import"./Search-Cf7bcOZJ.js";import"./isPlainObject-OEy0Jz8l.js";import"./inputProps-jdR54afw.js";import"./Password-fnCqxsm2.js";import"./Col-CFxRRwN8.js";import"./responsiveObserve-DqAe0rZk.js";import"./collapseMotion-Brd6xpAT.js";import"./index-BwqnaIPU.js";import"./colors-DfoziJR7.js";import"./QuestionCircleOutlined-DTfTQPH4.js";import"./index-BYVEo4R0.js";import"./CaretDownFilled-DSht_iiA.js";import"./index-BhHQj-ne.js";import"./index-0UwCX3b0.js";import"./LeftOutlined-BKUTcRtP.js";import"./RightOutlined-DH_YROnp.js";import"./index-DLRiQ5Ho.js";import"./Checkbox-oqMTsvET.js";import"./index-BSz5XTfh.js";import"./dropdown-DTOAy9tU.js";import"./index-DlQVT6K6.js";import"./shallowequal-C0xnIuy8.js";import"./index-Di5l0R3t.js";import"./RadioButton-h1wW1k6O.js";import"./CaretDownOutlined-Byn8iz8T.js";const io={class:"add-domain-form"},co={class:"form-item"},ro={class:"form-input-box"},po={__name:"add-domain-modal ",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(U,{expose:f,emit:v}){const b=U;function L(e){return e=e.replace("。",".").toLowerCase(),e=e.replace(/\/$/,""),e=e.replace(/(^\s*)|(\s*$)/g,""),e=e.replace("http://",""),e=e.replace("https://",""),e}const k=v,a=u(!1),h=u("添加自定义域名"),d=u([{label:"http",value:"http:"},{label:"https",value:"https:"}]),t=E({id:null,url:"",protocol:"http:"}),S=()=>{try{if(t.url){const e=new URL(t.url);e.protocol=="http:"||e.protocol=="https:"?t.protocol=e.protocol:t.protocol="http:",t.url=e.hostname}}catch{t.url=L(t.url)}},C=()=>{if(!t.url)return w.error("请输入配置域名");t.url=L(t.url),k("ok",{...t})};return f({open:e=>{e?(t.url=e.url,t.protocol=e.protocol,t.id=e.id,h.value="修改自定义域名"):(t.id=null,t.url="",t.protocol="http:",h.value="添加自定义域名"),a.value=!0},close:()=>{a.value=!1}}),(e,c)=>{const x=W,m=Q,o=M,n=Y,y=D;return g(),R(y,{open:a.value,"onUpdate:open":c[2]||(c[2]=_=>a.value=_),title:h.value,onOk:C,confirmLoading:b.confirmLoading},{default:p(()=>[l("div",io,[l("div",co,[c[3]||(c[3]=l("div",{class:"form-label"},"配置域名：",-1)),l("div",ro,[s(n,{compact:"",style:{width:"100%"}},{default:p(()=>[s(m,{value:t.protocol,"onUpdate:value":c[0]||(c[0]=_=>t.protocol=_),style:{width:"20%"}},{default:p(()=>[(g(!0),O(to,null,oo(d.value,_=>(g(),R(x,{value:_.value,key:_.value},{default:p(()=>[l("span",null,F(_.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),s(o,{value:t.url,"onUpdate:value":c[1]||(c[1]=_=>t.url=_),style:{width:"80%"},placeholder:"请输入配置域名",onBlur:S},null,8,["value"])]),_:1})])]),c[4]||(c[4]=l("div",{class:"form-tip"}," 配置域名只需要填写域名部分,比如kf.xxx.com.您可以根据需求选择http或https协议 ",-1))])]),_:1},8,["open","title","confirmLoading"])}}},uo=B(po,[["__scopeId","data-v-bac76e5e"]]),mo={class:"upload-ssl-form"},_o={class:"domain"},fo={__name:"upload-ssl",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(U,{expose:f,emit:v}){const b=v,L=U,k=u(),a=E({id:"",domain:"",ssl_certificate:"",ssl_certificate_key:""}),h={ssl_certificate:[{required:!0,message:"请输入证书文件(.crt或.pem)"}],ssl_certificate_key:[{required:!0,message:"请输入私钥文件(.key)"}]},d=u(!1),t=r=>{a.id=r.id,a.domain=r.url,a.ssl_certificate="",a.ssl_certificate_key="",d.value=!0},S=()=>{d.value=!1},C=()=>{k.value.validate().then(()=>{b("ok",N(a))}).catch(r=>{})};return f({open:t,close:S}),(r,i)=>{const e=A,c=q,x=z,m=D;return g(),R(m,{open:d.value,"onUpdate:open":i[2]||(i[2]=o=>d.value=o),title:"上传证书",onOk:C,confirmLoading:L.confirmLoading},{default:p(()=>[l("div",mo,[l("div",_o,"域名："+F(r.domain),1),s(x,{ref_key:"formRef",ref:k,model:a,rules:h,autocomplete:"off",layout:"vertical"},{default:p(()=>[s(c,{label:"证书文件(.crt或.pem)",name:"ssl_certificate"},{default:p(()=>[s(e,{rows:5,value:a.ssl_certificate,"onUpdate:value":i[0]||(i[0]=o=>a.ssl_certificate=o)},null,8,["value"])]),_:1}),s(c,{label:"私钥文件(.key)",name:"ssl_certificate_key"},{default:p(()=>[s(e,{rows:5,value:a.ssl_certificate_key,"onUpdate:value":i[1]||(i[1]=o=>a.ssl_certificate_key=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open","confirmLoading"])}}},vo=B(fo,[["__scopeId","data-v-e93ea490"]]),ko={class:"upload-ssl-form"},ho={__name:"upload-validation-file",props:{confirmLoading:{type:Boolean,default:!1}},emits:["ok"],setup(U,{expose:f,emit:v}){const b=v,L=U,k=u(),a=E({id:"",file_name:"",file_content:""}),h={file_name:[{required:!0,message:"请输入文件名"}],file_content:[{required:!0,message:"请输入文件内容"}]},d=u(!1),t=r=>{a.id=r.id,a.file_name="",a.file_content="",d.value=!0},S=()=>{d.value=!1},C=()=>{k.value.validate().then(()=>{b("ok",N(a))}).catch(r=>{})};return f({open:t,close:S}),(r,i)=>{const e=M,c=q,x=A,m=z,o=D;return g(),R(o,{open:d.value,"onUpdate:open":i[2]||(i[2]=n=>d.value=n),title:"上传证书",onOk:C,confirmLoading:L.confirmLoading},{default:p(()=>[l("div",ko,[s(m,{ref_key:"formRef",ref:k,model:a,rules:h,autocomplete:"off",layout:"vertical"},{default:p(()=>[s(c,{label:"文件名（含文件后缀，比如 mzkAzOpb6L.txt）",name:"file_name"},{default:p(()=>[s(e,{value:a.file_name,"onUpdate:value":i[0]||(i[0]=n=>a.file_name=n)},null,8,["value"])]),_:1}),s(c,{label:"文件内容",name:"file_content"},{default:p(()=>[s(x,{rows:5,value:a.file_content,"onUpdate:value":i[1]||(i[1]=n=>a.file_content=n)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open","confirmLoading"])}}},yo=B(ho,[["__scopeId","data-v-a24b293f"]]),go={class:"domain-page"},Lo={class:"page-container"},xo={class:"domain-tips"},bo={class:"list-action-box"},So={class:"list-box"},Co={key:0},Uo={key:1},$o={key:2,class:"action-box"},wo=["onClick"],Oo=["onClick"],Ro=["onClick"],Fo=["onClick"],Bo={__name:"index",setup(U){const f=u(null),v=u(!1),b=[{title:"域名",dataIndex:"url",key:"url"},{title:"证书",dataIndex:"is_upload",key:"is_upload",width:300},{title:"操作",key:"action"}],L=()=>{f.value.open()},k=o=>{let n={id:o.id,url:o.url,protocol:"http:"};try{const y=new URL(o.url);y.protocol=="http:"||y.protocol=="https:"?n.protocol=y.protocol:n.protocol="http:",n.url=y.hostname}catch{}f.value.open(n)},a=o=>{v.value=!0;let n=`${o.protocol}//${o.url}`;H({url:n,id:o.id||void 0}).then(()=>{w.success("保存成功"),v.value=!1,f.value.close(),m()}).catch(()=>{v.value=!1})},h=o=>{D.confirm({title:"删除",icon:s(Z),content:"确定要删除吗？",onOk(){X({id:o.id}).then(()=>{w.success("删除成功"),m()})},onCancel(){}})},d=u(null),t=u(!1),S=o=>{d.value.open(o)},C=o=>{t.value=!0;let n={id:o.id,ssl_certificate:o.ssl_certificate,ssl_certificate_key:o.ssl_certificate_key};J(n).then(()=>{t.value=!1,d.value.close(),w.success("上传成功"),m()}).catch(()=>{t.value=!1})},r=u(null),i=u(!1),e=o=>{r.value.open(o)},c=o=>{i.value=!0,K({...o}).then(()=>{i.value=!1,r.value.close(),w.success("上传成功"),m()}).catch(()=>{i.value=!1})},x=u([]),m=async()=>{const o=await G();x.value=o.data||[]};return m(),(o,n)=>{const y=lo,_=P,j=so;return g(),O("div",go,[l("div",Lo,[n[2]||(n[2]=l("div",{class:"page-title"},"自定义域名设置",-1)),l("div",xo,[s(y,{type:"info","show-icon":""},{icon:p(()=>[l("div",null,[s(eo(T),{style:{"font-size":"16px"}})])]),description:p(()=>n[0]||(n[0]=[l("div",{class:"tip-text"},[l("div",null,"将域名解析到部署服务器，可以通过自由域名访问对外文档和对外服务web APP。"),l("div",null,"1、如需使用https,请在添加域名后，上传证书文件，包括公钥和私钥(ky文件)。")],-1)])),_:1})]),l("div",bo,[l("div",null,[s(_,{type:"primary",onClick:L},{default:p(()=>n[1]||(n[1]=[ao("添加自定义域名")])),_:1,__:[1]})])]),l("div",So,[s(j,{columns:b,"data-source":x.value},{bodyCell:p(({column:V,record:$})=>[V.key==="url"?(g(),O("span",Co,F($.url),1)):V.key==="is_upload"?(g(),O("span",Uo,F($.is_upload?"已上传":"未上传"),1)):V.key==="action"?(g(),O("span",$o,[l("a",{class:"action-btn",onClick:I=>S($)},"上传证书",8,wo),l("a",{class:"action-btn",onClick:I=>e($)},"上传验证文件",8,Oo),l("a",{class:"action-btn",onClick:I=>k($)},"编辑",8,Ro),l("a",{class:"action-btn",onClick:I=>h($)},"删除",8,Fo)])):no("",!0)]),_:1},8,["data-source"])])]),s(uo,{ref_key:"addDomainModalRef",ref:f,confirmLoading:v.value,onOk:a},null,8,["confirmLoading"]),s(vo,{ref_key:"uploadSSLRef",ref:d,"confirm-loading":t.value,onOk:C},null,8,["confirm-loading"]),s(yo,{ref_key:"uploadValidationFileRef",ref:r,"confirm-loading":i.value,onOk:c},null,8,["confirm-loading"])])}}},Ot=B(Bo,[["__scopeId","data-v-a35ba7d4"]]);export{Ot as default};
