import{_ as z}from"./date-C0BQwmis.js";import{h as S}from"./index-D4Gl6KHo.js";import{aw as E,f as F,r as $,ac as o,as as p,k as r,ar as k,ad as a,az as c,F as h,G as _,u as d,ae as I,at as T}from"./vue-chunks-CGLjTDrY.js";import{_ as B,c as N}from"../../index-CB2DywzJ.js";import{o as V,G as Y,bE as q,a5 as O,ai as R,aR as G,v as H,ah as L,d as M}from"./ui-antd-BHaxN-GS.js";import"./neo4j-CSfpjqgw.js";import"./utils-pAinW4BS.js";import"./other-BrZCAsTs.js";const Q={class:"user-model-page"},U={class:"list-wrapper"},j={class:"content-wrapper"},J={class:"search-block"},P={key:0,class:"status-item status-0"},A={key:1,class:"status-item status-1"},K={key:2,class:"status-item status-2"},W={key:3,class:"status-item status-3"},X=["onClick"],Z={key:1},tt={__name:"export-record",setup(et){const v=N(),g=E().query,y=F([]),s=$({library_id:g.id,source:2,page:1,size:10,total:0,start_time:"",end_time:""}),C=e=>{s.page=e.current,s.size=e.pageSize,f()},x=()=>{s.page=1,f()},w=e=>{s.start_time=e.start_time,s.end_time=e.end_time,x()},f=()=>{S({...s}).then(e=>{let t=e.data.list,l=e.data.map;t.forEach(n=>{var u;n.create_time_desc=M(n.create_time*1e3).format("YYYY/MM/DD HH:mm"),n.source_desc=(u=l.filter(m=>m.source==n.source)[0])==null?void 0:u.source_name,n.is_over_7_days=n.create_time<Date.now()/1e3-10080*60}),y.value=t,s.total=+e.data.total})},b=e=>{let t=`/manage/downloadExportFile?id=${e.id}&library_id=${g.id}&token=${v.getToken}`;var l=document.createElement("a");l.href=t,l.style.display="none",l.click()},D=[{title:"导出时间",dataIndex:"create_time_desc",key:"create_time_desc"},{title:"导出文件名称",dataIndex:"file_name",key:"file_name"},{title:"来源",key:"source_desc",dataIndex:"source_desc"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"action"}];return(e,t)=>{const l=V,n=H,u=Y;return a(),o("div",Q,[t[4]||(t[4]=p("div",{class:"page-title"},"导出记录",-1)),p("div",U,[p("div",j,[r(l,{"show-icon":"",message:"导出文件仅保留7天，7天后自动删除，请及时下载到本地"}),p("div",J,[r(z,{datekey:"2",onDateChange:w})]),r(u,{class:"table-list",columns:D,"data-source":y.value,pagination:{current:s.page,total:s.total,pageSize:s.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:C},{bodyCell:k(({column:m,record:i})=>[m.key==="status"?(a(),o(h,{key:0},[i.status==0?(a(),o("div",P,[r(d(q)),t[0]||(t[0]=_("等待导出 ",-1))])):c("",!0),i.status==1?(a(),o("div",A,[r(d(O)),t[1]||(t[1]=_("导出中 ",-1))])):c("",!0),i.status==2?(a(),o("div",K,[r(d(R)),t[2]||(t[2]=_("导出成功 ",-1))])):c("",!0),i.status==3?(a(),o("div",W,[r(d(G)),t[3]||(t[3]=_("导出失败 ",-1)),i.err_msg?(a(),I(n,{key:0},{title:k(()=>[_(T(i.err_msg),1)]),default:k(()=>[r(d(L))]),_:2},1024)):c("",!0)])):c("",!0)],64)):c("",!0),m.key==="action"?(a(),o(h,{key:1},[i.is_over_7_days?(a(),o("span",Z,"--")):(a(),o("a",{key:0,onClick:st=>b(i)},"下载",8,X))],64)):c("",!0)]),_:1},8,["data-source","pagination"])])])])}}},dt=B(tt,[["__scopeId","data-v-63403e33"]]);export{dt as default};
