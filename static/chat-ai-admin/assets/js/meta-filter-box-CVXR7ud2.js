import{_ as lt}from"./cu-scroll-CpIj948h.js";import{u as W,Y as at,a1 as nt,_ as ct,a8 as it}from"../../index-DSFcP5NQ.js";import{_ as X}from"./emoji-mart-BBMRoEa3.js";import{q as Z,al as rt,B as tt,au as _t,ag as ut,D as et,aq as pt,aU as dt,ai as vt,M as V,O as ht,f as yt,g as mt,i as ft,v as bt,u as gt,a3 as kt,G as xt,I as Ct,a1 as $t,b as Ot}from"./ui-antd-Dl1wwwCD.js";import{r as S,a as i,b as o,y as d,t as _,p as t,v as l,u as n,F as x,l as L,h as st,e as b,q as f,_ as k,G as wt,a2 as Dt,c as F,C as z,an as T,m as K,E as St,w as Q,Y as Ut}from"./vue-chunks-BdaA73Wf.js";import{d as R}from"./utils-CvB22N-W.js";const jt={class:"prompt-wrapper"},Bt={class:"group-box"},Ht={class:"main-title"},Nt={class:"group-list-box"},Lt=["onClick"],It={class:"group-name"},Mt={class:"name-text"},qt={class:"content-box"},Pt={class:"opration-btn-block"},Et={class:"content-scroll-box"},Yt={key:0,class:"loading-box"},At={class:"prompt-list-box"},Gt={class:"prompt-header"},Ft={class:"prompt-title"},Jt={key:0,class:"prompt-type diy"},Vt={key:1,class:"prompt-type"},zt={class:"title"},Tt={class:"right-btn-box"},Kt=["onClick"],Qt=["onClick"],Rt={class:"prompt-content-box"},Wt={key:0,class:"prompt-content"},Xt=["onClick"],Zt={key:1,class:"structure-list-box"},te={class:"structure-list"},ee={class:"structure-title"},se={class:"structure-content"},oe={class:"structure-list"},le={class:"structure-title"},ae={class:"structure-content"},ne=["onClick"],ce={class:"structure-list"},ie={class:"structure-title"},re={class:"structure-content"},_e={key:0,class:"structure-list"},ue={class:"structure-title"},pe={class:"structure-content"},de={class:"structure-list"},ve={class:"structure-title"},he={class:"structure-content"},ye={class:"structure-list"},me={class:"structure-title"},fe={class:"structure-content"},be={class:"structure-title"},ge={class:"structure-content"},ke={class:"empty-content"},xe={class:"title"},Ce={class:"desc"},$e={__name:"index",emits:["ok"],setup(I,{expose:O,emit:U}){const{t:e}=W("components.import-prompt.index"),h=S(!1),g=U,M=()=>{h.value=!0,q(),a()},u=m=>{V.confirm({title:e("title_import_confirm"),icon:wt(ht),content:e("msg_import_confirm"),onOk(){g("ok",m),h.value=!1},onCancel(){}})},y=S(-1),w=S([]),q=()=>{at().then(m=>{w.value=[{id:-1,group_name:e("label_all")},{id:0,group_name:e("label_default_group")},...m.data]})},P=m=>{y.value=m.id,a()},j=S([]),B=S(!1),D=S(!1),E=()=>{D.value=!0,a(),q()},a=()=>{B.value=!0,nt({group_id:y.value,page:1,size:9999}).then(m=>{let C=m.data.list||[];C=C.map($=>({...$,isHide:!0,prompt_struct:$.prompt_struct?JSON.parse($.prompt_struct):{}})),j.value=C}).finally(()=>{B.value=!1,D.value=!1})},r=m=>{m.isHide=!m.isHide},v=()=>{window.open("#/user/prompt-library")};return O({show:M}),(m,C)=>{const $=Z,H=lt,N=tt,Y=ut,A=vt,G=V;return o(),i("div",null,[d(G,{open:h.value,"onUpdate:open":C[0]||(C[0]=s=>h.value=s),title:null,width:950,footer:null,wrapClassName:"add-prommpt-modal"},{default:_(()=>[t("div",jt,[t("div",Bt,[t("div",Ht,l(n(e)("title_import_prompt")),1),d(H,{style:{height:"480px"}},{default:_(()=>[t("div",Nt,[(o(!0),i(x,null,L(w.value,s=>(o(),i("div",{class:st(["group-list",{active:s.id==y.value}]),onClick:c=>P(s),key:s.id},[t("div",It,[t("div",Mt,l(s.group_name),1),s.group_desc?(o(),b($,{key:0},{title:_(()=>[k(l(s.group_desc),1)]),default:_(()=>[d(n(rt))]),_:2},1024)):f("",!0)])],10,Lt))),128))])]),_:1})]),t("div",qt,[t("div",Pt,[d(N,{loading:D.value,onClick:E},{default:_(()=>[D.value?f("",!0):(o(),b(n(_t),{key:0})),k(l(n(e)("btn_refresh_list")),1)]),_:1},8,["loading"]),d(N,{onClick:v},{default:_(()=>[k(l(n(e)("btn_manage_knowledge_base")),1)]),_:1})]),t("div",Et,[d(H,{style:{padding:"0 24px"}},{default:_(()=>[B.value?(o(),i("div",Yt,[d(Y)])):f("",!0),t("div",At,[(o(!0),i(x,null,L(j.value,s=>(o(),i("div",{class:"prompt-list",key:s.id},[t("div",Gt,[t("div",Ft,[s.prompt_type==0?(o(),i("div",Jt,l(n(e)("label_custom")),1)):f("",!0),s.prompt_type==1?(o(),i("div",Vt,l(n(e)("label_structured")),1)):f("",!0),t("div",zt,l(s.title),1)]),t("div",Tt,[d($,{title:s.isHide?n(e)("tooltip_expand"):n(e)("tooltip_collapse")},{default:_(()=>[t("div",{class:"hover-btn-box",onClick:c=>r(s)},[s.isHide?(o(),b(n(et),{key:0})):(o(),b(n(pt),{key:1}))],8,Kt)]),_:2},1032,["title"]),t("div",{class:"hover-btn-box primary",onClick:c=>u(s)},[d(n(dt)),k(l(n(e)("btn_import")),1)],8,Qt)])]),t("div",Rt,[s.prompt_type==0?(o(),i("div",Wt,[s.isHide?(o(),i(x,{key:0},[k(l(s.prompt.slice(0,200))+" ",1),s.prompt.length>200?(o(),i("span",{key:0,onClick:c=>r(s),style:{cursor:"pointer"}},"...",8,Xt)):f("",!0)],64)):(o(),i(x,{key:1},[k(l(s.prompt),1)],64))])):(o(),i("div",Zt,[t("div",te,[t("div",ee,l(s.prompt_struct.role.subject),1),t("div",se,l(s.prompt_struct.role.describe),1)]),t("div",oe,[t("div",le,l(s.prompt_struct.task.subject),1),t("div",ae,[k(l(s.prompt_struct.task.describe)+" ",1),s.isHide?(o(),i("span",{key:0,onClick:c=>r(s),style:{cursor:"pointer"}},"...",8,ne)):f("",!0)])]),s.isHide?f("",!0):(o(),i(x,{key:0},[t("div",ce,[t("div",ie,l(s.prompt_struct.constraints.subject),1),t("div",re,l(s.prompt_struct.constraints.describe),1)]),s.prompt_struct.skill?(o(),i("div",_e,[t("div",ue,l(s.prompt_struct.skill.subject),1),t("div",pe,l(s.prompt_struct.skill.describe),1)])):f("",!0),t("div",de,[t("div",ve,l(s.prompt_struct.output.subject),1),t("div",he,l(s.prompt_struct.output.describe),1)]),t("div",ye,[t("div",me,l(s.prompt_struct.tone.subject),1),t("div",fe,l(s.prompt_struct.tone.describe),1)]),(o(!0),i(x,null,L(s.prompt_struct.custom,c=>(o(),i("div",{class:"structure-list",key:c.subject},[t("div",be,l(c.subject),1),t("div",ge,l(c.describe),1)]))),128))],64))]))])]))),128))]),j.value.length==0?(o(),b(A,{key:1,style:{"padding-top":"100px"}},{description:_(()=>[t("div",ke,[t("div",xe,l(n(e)("msg_no_prompts")),1),t("div",Ce,l(n(e)("msg_no_prompts_desc")),1),t("div",null,[d(N,{type:"primary",onClick:v},{default:_(()=>[k(l(n(e)("btn_add_now")),1)]),_:1})])])]),_:1})):f("",!0)]),_:1})])])])]),_:1},8,["open"])])}}},Fe=X($e,[["__scopeId","data-v-44bbb482"]]),Je={__name:"index",props:{disabled:{type:Boolean,default:!1}},setup(I){const O=Dt(),U=F(()=>{const{disabled:h,...g}=O;return g}),e=F(()=>{const{title:h,overlayClassName:g,overlayStyle:M,mouseEnterDelay:u,mouseLeaveDelay:y,...w}=O;return w});return(h,g)=>I.disabled?(o(),i("div",T(K({key:1},e.value)),[z(h.$slots,"default")],16)):(o(),b(n(Z),T(K({key:0},U.value)),{default:_(()=>[z(h.$slots,"default")]),_:3},16))}},Oe={class:"query-condition-filter"},we={class:"condition-select-box"},De={class:"select-wrapper"},Se={href:"javascript:;"},Ue={href:"javascript:;"},je={class:"field-items"},Be={class:"field-select-box"},He={class:"operator-select-box"},Ne={class:"field-value-box"},Le=["onClick"],Ie={key:0,class:"add-btn-box"},Me={__name:"meta-filter-box",props:{rule:{type:String},type:{type:Number},metaData:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["change","update:rule","update:type"],setup(I,{expose:O,emit:U}){const{t:e}=W("views.robot.robot-config.basic-config.components.meta-filter-box"),h=U,g=I,M=F(()=>[{value:1,label:e("op_is"),use_types:[0,1,2]},{value:2,label:e("op_is_not"),use_types:[0,1,2]},{value:3,label:e("op_contains"),use_types:[0]},{value:4,label:e("op_not_contains"),use_types:[0]},{value:5,label:e("op_is_empty"),use_types:[0,1,2]},{value:6,label:e("op_is_not_empty"),use_types:[0,1,2]},{value:7,label:e("op_greater_than"),use_types:[1,2]},{value:8,label:e("op_equals"),use_types:[1,2]},{value:9,label:e("op_less_than"),use_types:[1,2]},{value:10,label:e("op_greater_than_or_equal"),use_types:[1,2]},{value:11,label:e("op_less_than_or_equal"),use_types:[1,2]}]),u=St({list:[],type:1});Q(()=>g.rule,()=>{let a=it(g.rule,[]);a.forEach(r=>{r.type==1&&r.value>0&&(r.value=R(r.value*1e3))}),u.list=a},{immediate:!0}),Q(()=>g.type,()=>{u.type=g.type},{immediate:!0});const y=()=>{let a={type:u.type,list:u.list},r=JSON.parse(JSON.stringify(u.list));r.forEach(v=>{v.type==1&&v.value&&(v.value=R(v.value).startOf("minute").unix()),v.value=v.value.toString()}),h("update:rule",JSON.stringify(r)),h("update:type",u.type),h("change",a)},w=()=>{let a={key:void 0,type:void 0,op:void 0,value:""};u.list.push(a),y()},q=a=>{u.list.splice(a,1),y()},P=({key:a})=>{u.type=a,y()};function j(a,r,v){a.type=v.type,a.value="",y()}function B(a){[5,6].includes(a.op)&&(a.value=""),y()}function D(a){return M.value.filter(r=>r.use_types.includes(a))}function E(){try{for(let a of u.list){if(!a.key)throw e("msg_select_filter_metadata");if(!a.op)throw e("msg_select_filter_operator");if(a.value&&![5,6].includes(a.op)&&!a.value)throw e("msg_select_filter_metadata_value")}if(!u.list.length)throw e("msg_complete_at_least_one_filter_rule");return!0}catch(a){return Ot.error(a),!1}}return O({verify:E}),(a,r)=>{const v=mt,m=yt,C=ft,$=bt,H=gt,N=kt,Y=xt,A=Ct,G=ct,s=tt;return o(),i("div",{class:st(["query-condition-filter-warpper",{"is-multiple":u.list.length>1}])},[t("div",Oe,[r[1]||(r[1]=t("div",{class:"auxiliary-line"},null,-1)),t("div",we,[t("div",De,[d(C,{onClick:P},{overlay:_(()=>[d(m,{style:{width:"100px"}},{default:_(()=>[(o(),b(v,{key:1},{default:_(()=>[t("a",Se,l(n(e)("label_and")),1)]),_:1})),(o(),b(v,{key:2},{default:_(()=>[t("a",Ue,l(n(e)("label_or")),1)]),_:1}))]),_:1})]),default:_(()=>[t("a",{class:"ant-dropdown-link",onClick:r[0]||(r[0]=Ut(()=>{},["prevent"]))},[k(l(u.type==1?n(e)("label_and"):n(e)("label_or"))+" ",1),d(n(et))])]),_:1})])]),t("div",je,[(o(!0),i(x,null,L(u.list,(c,J)=>(o(),i("div",{class:"field-item",key:J},[t("div",Be,[d(H,{value:c.key,"onUpdate:value":p=>c.key=p,placeholder:n(e)("ph_select"),style:{width:"200px"},onChange:(p,ot)=>j(c,p,ot)},{default:_(()=>[(o(!0),i(x,null,L(g.metaData,p=>(o(),b($,{value:p.key,key:p.key,type:p.type},{default:_(()=>[k(l(p.name),1)]),_:2},1032,["value","type"]))),128))]),_:1},8,["value","onUpdate:value","placeholder","onChange"])]),t("div",He,[d(H,{value:c.op,"onUpdate:value":p=>c.op=p,style:{width:"120px"},placeholder:n(e)("ph_select"),options:D(c.type),onChange:p=>B(c)},null,8,["value","onUpdate:value","placeholder","options","onChange"])]),t("div",Ne,[[5,6].includes(c.op)?f("",!0):(o(),i(x,{key:0},[c.type==1?(o(),b(N,{key:0,value:c.value,"onUpdate:value":p=>c.value=p,onChange:y,format:"YYYY-MM-DD HH:mm",style:{width:"100%"}},null,8,["value","onUpdate:value"])):c.type==2?(o(),b(Y,{key:1,value:c.value,"onUpdate:value":p=>c.value=p,placeholder:n(e)("ph_input"),onBlur:y,style:{width:"100%"}},null,8,["value","onUpdate:value","placeholder"])):(o(),b(A,{key:2,value:c.value,"onUpdate:value":p=>c.value=p,valueModifiers:{trim:!0},placeholder:n(e)("ph_input"),maxlength:20,onBlur:y,style:{width:"100%"}},null,8,["value","onUpdate:value","placeholder"]))],64))]),t("span",{class:"field-del-btn",onClick:p=>q(J)},[d(G,{class:"del-icon",name:"close-circle"})],8,Le)]))),128))])]),u.list.length<10?(o(),i("div",Ie,[d(s,{class:"add-btn",type:"dashed",block:"",onClick:w},{default:_(()=>[d(n($t)),k(" "+l(n(e)("btn_add_condition")),1)]),_:1})])):f("",!0)],2)}}},Ve=X(Me,[["__scopeId","data-v-6c32c957"]]);export{Ve as M,Fe as _,Je as a};
//# sourceMappingURL=meta-filter-box-CVXR7ud2.js.map
