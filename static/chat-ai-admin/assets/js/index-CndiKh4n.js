import{r as u,w as P,L as d,M as f,j as p,V as i,Q as F,a7 as I,F as N,a1 as V,u as b,a2 as A}from"./vue-chunks-XoCroLmQ.js";import{u as h}from"./index-1KQ010za.js";import{_ as B,e as s,bA as J}from"../../index-BokOG9ZU.js";import{E as z}from"./Password-D_H-hnpK.js";import{D as G,U as R}from"./index-CAuXv0Mv.js";import"./index-BitUTYbL.js";import{I as $}from"./Input-CUxLS_nc.js";const q={class:"upload-box"},Q={class:"mask-box"},S=["src"],y=3,H={__name:"index",props:{value:{type:[String,Array],default:""}},emits:["update:value"],setup(k,{emit:D}){const m=D,g=u([]),t=u([]),v=u(""),w=k;P(()=>w.value,e=>{t.value=e},{immediate:!0});const x=e=>{if(!(e.type==="image/jpeg"||e.type==="image/png"))return s.error("只支持JPG、PNG格式的图片"),!1;const o=e.size/1024<1024*2;return t.value.length>=y?s.error("最多上传三张图片"):o?(h({category:"library_image",file:e}).then(l=>{t.value.push(l.data.link),m("update:value",t.value)}),!1):(s.error("图片大小不能超过2M"),!1)},U=e=>{J({images:[e]})},M=e=>{t.value.splice(e,1)};let n=!1;const L=async e=>{if(t.value.length>=y)return s.error("最多上传三张图片");if(!(e.clipboardData&&e.clipboardData.items)){s.error("当前浏览器不支持粘贴上传操作！");return}if(!n)try{if(e.clipboardData||e.originalEvent||window.clipboardData){var r=e.clipboardData||e.originalEvent.clipboardData||window.clipboardData,o=r.items;let l=null;for(let a=0;a<o.length;a++)if(o[a].type.indexOf("image")!==-1){l=o[a].getAsFile();break}v.value="",l?(e.preventDefault(),n=!0,h({category:"library_image",file:l}).then(a=>{n=!1,t.value.push(a.data.link),m("update:value",t.value)})):(error("请粘贴正确图片"),n=!1,v.value="")}}catch{n=!1,s.error("上传失败")}},c=u(null),C=()=>{c.value.focus()},j=()=>{c.value.blur()};function E(e){}return(e,r)=>{const o=$,l=R;return d(),f("div",q,[p(o,{class:"hidden-input",ref_key:"inputRef",ref:c,onPaste:L},null,512),i("div",{onMouseenter:C,onMouseleave:j},[p(l,{fileList:g.value,"onUpdate:fileList":r[1]||(r[1]=a=>g.value=a),name:"file",multiple:!1,"list-type":"picture","show-upload-list":!1,accept:".jpg,.png,.jpeg","before-upload":x,onDrop:E},{default:F(()=>[i("div",{class:"img-list-box",onClick:r[0]||(r[0]=I(()=>{},["stop"]))},[(d(!0),f(N,null,V(t.value,(a,_)=>(d(),f("div",{class:"img-item",key:_},[i("div",Q,[p(b(z),{onClick:O=>U(a)},null,8,["onClick"]),p(b(G),{onClick:O=>M(_)},null,8,["onClick"])]),i("img",{src:a,alt:""},null,8,S)]))),128))]),i("p",{class:A(["upload-text",{"center-content":t.value.length==0}])}," 支持点击空白处、拖拽、粘贴图片，上传图片不得超过2M，仅支持png、jpg、jpeg格式 ",2)]),_:1},8,["fileList"])],32)])}}},ae=B(H,[["__scopeId","data-v-0416e0a3"]]);export{ae as U};
