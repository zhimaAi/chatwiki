import{_ as V}from"./cu-scroll-CpIj948h.js";import{_ as q}from"./empty-DkpCLaix.js";import{r as m,e as x,b as n,t as v,a as _,q as C,p as e,y as f,v as r,u as d,F as $,l as L,ah as D,j as F,E as O,_ as P}from"./vue-chunks-BdaA73Wf.js";import{u as T,d as j,bH as G,bI as H}from"../../index-DSFcP5NQ.js";import{_ as U}from"./emoji-mart-BBMRoEa3.js";import{ai as B,N as K,E as z,M as J,B as Q,a1 as W,b as X}from"./ui-antd-Dl1wwwCD.js";import{g as Y}from"./index-Cg7-0swo.js";import"./pull-up.esm-DIiTC7VE.js";import"./observe-dom.esm-B25JyVKH.js";import"./editor-cherry-CFIsbKoN.js";import"./neo4j-MWxXN7EM.js";import"./lodash-Bm5sK6rN.js";import"./elkjs-BN8GIjVH.js";import"./utils-CvB22N-W.js";import"./other-LrIFyvU9.js";const Z={key:0,class:"form-wrapper"},tt={class:"select"},et={class:"tools-wrapper"},ot=["src"],st={class:"item-name"},at={key:1,class:"form-wrapper"},lt={class:"select"},nt={class:"tools-wrapper"},it={class:"item-name"},rt={key:2,class:"form-wrapper"},ct={class:"select"},_t={class:"tools-wrapper"},dt={class:"item-name"},ut={key:3,class:"empty-box"},vt={__name:"see-model-alert",props:{robotList:{type:Array,default:null},libraryList:{type:Array,default:null},formList:{type:Array,default:null},currentTitle:{type:String,default:"关联机器人"}},emits:["save"],setup(I,{expose:p,emit:R}){const{t:y}=T("components.see-model-alert.see-model-alert"),w=B.PRESENTED_IMAGE_SIMPLE,M=R,h=I,o=m([]),c=m(""),b=m(!1),u=m([]),k=l=>{const t=[];return l.map(a=>{t.push(a.id)}),t},S=(l,t,a)=>{o.value=[],c.value=l,c.value==="robot"?(u.value=h.robotList,t&&t==="edit"&&a&&(o.value=k(a.managed_robot_list))):c.value==="library"?(u.value=h.libraryList,t&&t==="edit"&&a&&(o.value=k(a.managed_library_list))):c.value==="form"&&(u.value=h.formList,t&&t==="edit"&&a&&(o.value=k(a.managed_form_list))),b.value=!0},A=()=>{b.value=!1,u.value.length&&M("save",o.value)},E=()=>{};return p({open:S}),(l,t)=>{const a=K,g=z,i=B,N=J;return n(),x(N,{class:"add-model-alert",width:"800px",open:b.value,"onUpdate:open":t[3]||(t[3]=s=>b.value=s),title:I.currentTitle,onOk:A,onCancel:E},{default:v(()=>[c.value==="robot"?(n(),_("div",Z,[e("div",tt,r(d(y)("text_selected",{count:o.value.length})),1),f(g,{class:"list-box",value:o.value,"onUpdate:value":t[0]||(t[0]=s=>o.value=s)},{default:v(()=>[(n(!0),_($,null,L(u.value,s=>(n(),x(a,{class:"list-item",key:s.id,value:s.id},{default:v(()=>[e("div",et,[e("img",{class:"model-logo",src:s.robot_avatar,alt:""},null,8,ot),e("div",st,r(s.robot_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="library"?(n(),_("div",at,[e("div",lt,r(d(y)("text_selected",{count:o.value.length})),1),f(g,{class:"list-box",value:o.value,"onUpdate:value":t[1]||(t[1]=s=>o.value=s)},{default:v(()=>[(n(!0),_($,null,L(u.value,s=>(n(),x(a,{class:"list-item",key:s.id,value:s.id},{default:v(()=>[e("div",nt,[e("div",it,r(s.library_name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):c.value==="form"?(n(),_("div",rt,[e("div",ct,r(d(y)("text_selected",{count:o.value.length})),1),f(g,{class:"list-box",value:o.value,"onUpdate:value":t[2]||(t[2]=s=>o.value=s)},{default:v(()=>[(n(!0),_($,null,L(u.value,s=>(n(),x(a,{class:"list-item",key:s.id,value:s.id},{default:v(()=>[e("div",_t,[e("div",dt,r(s.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):C("",!0),u.value.length?C("",!0):(n(),_("div",ut,[f(i,{image:d(w)},null,8,["image"])]))]),_:1},8,["open","title"])}}},pt=U(vt,[["__scopeId","data-v-e038ea82"]]),mt={class:"robot-page"},ft={class:"associated-robot"},bt={class:"associated-robot-title"},yt={class:"list-box"},ht=["onClick"],gt={class:"list-item"},kt={class:"robot-info"},wt=["src"],xt={class:"robot-info-content"},$t={class:"robot-name"},Lt={class:"robot-type-tag"},It={class:"robot-desc"},Rt={key:0,class:"empty-box"},St={class:"title"},At={__name:"related-robots",setup(I){const{t:p}=T("views.library.library-details.related-robots"),R=j(),y=m(null),w=m([]),h=D().query,o=m([]),c=m(!1),b=()=>{c.value=!0,G({id:h.id}).then(l=>{o.value=l.data||[],R.setRobotNums(o.value.length)}).finally(()=>{c.value=!1})};F(()=>{b()}),O({managed_robot_list:[]});const u=async()=>{await S(),y.value.open("robot")},k=(l,t)=>{const a=new Set(t.map(i=>i.id));return l.filter(i=>i.application_type==="0").filter(i=>!a.has(i.id))},S=async()=>{await Y().then(l=>{w.value=k(l.data,o.value)}).catch(()=>{})},A=l=>{let t={library_id:h.id,robot_ids:l.join(",")};H(t).then(a=>{X.success(p("msg_operation_success")),b()}).catch(()=>{})},E=({id:l,robot_key:t,application_type:a})=>{a==0?window.open(`#/robot/config/basic-config?id=${l}&robot_key=${t}`):window.open(`#/robot/config/workflow?id=${l}&robot_key=${t}`)};return(l,t)=>{const a=Q,g=V;return n(),_("div",mt,[f(g,null,{default:v(()=>[e("div",ft,[e("div",bt,r(d(p)("title",{count:o.value.length})),1),f(a,{type:"primary",onClick:u},{icon:v(()=>[f(d(W))]),default:v(()=>[P(" "+r(d(p)("btn_associate_robot")),1)]),_:1})]),e("div",yt,[(n(!0),_($,null,L(o.value,i=>(n(),_("div",{class:"list-item-wrapper",key:i.id,onClick:N=>E(i)},[e("div",gt,[e("div",kt,[e("img",{class:"robot-avatar",src:i.robot_avatar,alt:""},null,8,wt),e("div",xt,[e("div",$t,r(i.robot_name),1),e("div",Lt,r(i.application_type==0?d(p)("type_chat_bot"):d(p)("type_workflow")),1)])]),e("div",It,r(i.robot_intro),1)])],8,ht))),128))]),o.value.length==0&&!c.value?(n(),_("div",Rt,[t[0]||(t[0]=e("img",{src:q,alt:""},null,-1)),e("div",St,r(d(p)("empty_no_data")),1)])):C("",!0)]),_:1}),f(pt,{ref_key:"seeModelAlertRef",ref:y,currentTitle:d(p)("modal_title"),robotList:w.value,onSave:A},null,8,["currentTitle","robotList"])])}}},Ht=U(At,[["__scopeId","data-v-3a848c01"]]);export{Ht as default};
//# sourceMappingURL=related-robots-BNum1rU_.js.map
