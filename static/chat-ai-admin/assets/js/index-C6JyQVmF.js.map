{"version":3,"file":"index-C6JyQVmF.js","sources":["../../../../front-end/chat-ai-admin-vue/src/assets/img/user/account/colour-edit.svg","../../../../front-end/chat-ai-admin-vue/src/views/user/account/components/modify-account.vue","../../../../front-end/chat-ai-admin-vue/src/views/user/account/components/modify-avatar.vue","../../../../front-end/chat-ai-admin-vue/src/views/user/account/index.vue"],"sourcesContent":["export default \"data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2040%2040'%20class='design-iconfont'%3e%3crect%20width='40'%20height='40'%20rx='20'%20fill='%232475FC'/%3e%3cpath%20d='M10.0835%2030.5H31.0835'%20stroke='%23fff'%20stroke-width='2.275'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M12.4165%2021.5867V25.8333H16.6848L28.7498%2013.763L24.4886%209.5L12.4165%2021.5867Z'%20stroke='%23fff'%20stroke-width='2.275'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e\"","<template>\r\n  <div>\r\n    <a-modal v-model:open=\"show\" :title=\"modalTitle\" @ok=\"handleOk\" width=\"476px\">\r\n      <div class=\"form-box\">\r\n        <a-form layout=\"vertical\">\r\n          <a-form-item :label=\"t('label_old_password')\" v-bind=\"validateInfos.old_password\">\r\n            <a-input-password\r\n              v-model:value=\"formState.old_password\"\r\n              :placeholder=\"t('ph_input_old_password')\"\r\n            />\r\n          </a-form-item>\r\n          <a-form-item :label=\"t('label_password')\" v-bind=\"validateInfos.password\">\r\n            <a-input-password\r\n              v-model:value=\"formState.password\"\r\n              :placeholder=\"t('ph_password_rule')\"\r\n            />\r\n          </a-form-item>\r\n          <a-form-item :label=\"t('label_confirm_password')\" v-bind=\"validateInfos.check_password\">\r\n            <a-input-password\r\n              v-model:value=\"formState.check_password\"\r\n              :placeholder=\"t('ph_reinput_password')\"\r\n            />\r\n          </a-form-item>\r\n        </a-form>\r\n      </div>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { validatePassword } from '@/utils/validate.js'\r\nimport { ref, reactive, toRaw } from 'vue'\r\nimport { Form, message } from 'ant-design-vue'\r\nimport { saveProfile } from '@/api/manage/index.js'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nconst emit = defineEmits(['ok'])\r\n\r\nconst useForm = Form.useForm\r\nconst { t } = useI18n('views.user.account.components.modify-account')\r\nconst show = ref(false)\r\nconst modalTitle = ref(t('title_modify_password'))\r\nconst formState = reactive({\r\n  password: '',\r\n  check_password: '',\r\n  old_password: '',\r\n  id: ''\r\n})\r\n\r\nconst formRules = reactive({\r\n  old_password: [\r\n    {\r\n      message: t('msg_input_old_password'),\r\n      required: true\r\n    }\r\n  ],\r\n  password: [\r\n    {\r\n      message: t('msg_input_password'),\r\n      required: true\r\n    },\r\n    {\r\n      validator: async (rule, value) => {\r\n        if (!validatePassword(value) && value) {\r\n          return Promise.reject(t('ph_password_rule'))\r\n        }\r\n        if(value == formState.old_password){\r\n          return Promise.reject(t('msg_password_same'))\r\n        }\r\n        return Promise.resolve()\r\n      }\r\n    }\r\n  ],\r\n  check_password: [\r\n    {\r\n      message: t('msg_input_confirm_password'),\r\n      required: true\r\n    },\r\n    {\r\n      validator: async (rule, value) => {\r\n        if (value != formState.password && value) {\r\n          return Promise.reject(t('msg_password_mismatch'))\r\n        }\r\n        return Promise.resolve()\r\n      }\r\n    }\r\n  ]\r\n})\r\n\r\nconst { resetFields, validate, validateInfos } = useForm(formState, formRules)\r\n\r\nconst open = (record) => {\r\n  show.value = true\r\n  resetFields()\r\n  formState.password = ''\r\n  formState.check_password = ''\r\n  formState.old_password = ''\r\n  formState.id = record.user_id;\r\n}\r\n\r\nconst handleOk = () => {\r\n  validate().then(() => {\r\n    saveProfile({\r\n      ...toRaw(formState)\r\n    }).then((res) => {\r\n      message.success(t('msg_modify_success'))\r\n      show.value = false\r\n      emit('ok')\r\n    })\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.form-box {\r\n  margin-top: 24px;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"upload-box\">\r\n    <a-upload\r\n      v-model:file-list=\"fileList\"\r\n      list-type=\"picture-card\"\r\n      :show-upload-list=\"false\"\r\n      :before-upload=\"beforeUpload\"\r\n      accept=\".jpg,.png,.jpeg\"\r\n    >\r\n      <div ref=\"uploadBtnRef\">修改头像</div>\r\n    </a-upload>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, toRaw } from 'vue'\r\nimport { Form, message } from 'ant-design-vue'\r\nimport { saveProfile } from '@/api/manage/index.js'\r\nconst emit = defineEmits(['ok'])\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader()\r\n    reader.readAsDataURL(file)\r\n    reader.onload = () => resolve(reader.result)\r\n    reader.onerror = (error) => reject(error)\r\n  })\r\n}\r\nconst fileList = ref([])\r\nconst imageUrl = ref('')\r\nconst beforeUpload = (file) => {\r\n  const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png'\r\n\r\n  if (!isJpgOrPng) {\r\n    message.error('机器人头像只支持JPG、PNG格式的图片')\r\n    return false\r\n  }\r\n\r\n  const isLt2M = file.size / 1024 < 1024\r\n\r\n  if (!isLt2M) {\r\n    message.error('成员头像图片大小不能超过1M')\r\n    return false\r\n  }\r\n\r\n  fileList.value = [file]\r\n\r\n  getBase64(file).then((base64Url) => {\r\n    imageUrl.value = base64Url\r\n\r\n    triggerChange()\r\n  })\r\n\r\n  return false\r\n}\r\nconst triggerChange = () => {\r\n  let data = {\r\n    imageUrl: imageUrl.value,\r\n    file: fileList.value[0].originFileObj\r\n  }\r\n  handleOk(data)\r\n}\r\nconst modalTitle = ref('修改登录密码')\r\nconst formState = reactive({\r\n  id: ''\r\n})\r\nconst uploadBtnRef = ref(null)\r\nconst setAvatar = (record) => {\r\n  formState.id = record.user_id\r\n  uploadBtnRef.value.click()\r\n}\r\n\r\nconst handleOk = (data) => {\r\n  saveProfile({\r\n    ...toRaw(formState),\r\n    avatar: data.file\r\n  }).then((res) => {\r\n    message.success(`修改成功`)\r\n    emit('ok', data.imageUrl)\r\n  })\r\n}\r\n\r\ndefineExpose({\r\n  setAvatar\r\n})\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.upload-box {\r\n  position: absolute;\r\n  left: -9999999px;\r\n}\r\n</style>\r\n","<style lang=\"less\" scoped>\r\n.user-account {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 24px;\r\n  background-color: #fff;\r\n  .page-title {\r\n    line-height: 24px;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n  }\r\n  .user-avatar-box {\r\n    position: relative;\r\n    width: 120px;\r\n    height: 120px;\r\n    margin: 24px auto 0 auto;\r\n    border-radius: 50%;\r\n    overflow: hidden;\r\n    .user-avatar {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n    .change-avatar {\r\n      position: absolute;\r\n      left: 0;\r\n      right: 0;\r\n      top: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      background-color: rgba(0, 0, 0, 0.45);\r\n      opacity: 0;\r\n      transition: opacity 0.2s;\r\n\r\n      &:hover {\r\n        opacity: 1;\r\n      }\r\n\r\n      .change-btn {\r\n        width: 40px;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n  }\r\n\r\n  .user-info-items {\r\n    .user-info-item {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      line-height: 22px;\r\n      padding-bottom: 16px;\r\n      .item-left {\r\n        display: flex;\r\n      }\r\n      .item-label {\r\n        padding-right: 32px;\r\n        font-size: 14px;\r\n        color: rgb(140, 140, 140);\r\n      }\r\n      .item-value {\r\n        font-size: 14px;\r\n        color: rgb(38, 38, 38);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <div class=\"user-account\">\r\n    <div class=\"page-title\">{{ t('views.user.account.accountSettings') }}</div>\r\n\r\n    <div class=\"user-avatar-box\">\r\n      <img class=\"user-avatar\" :src=\"avatar\" alt=\"\" />\r\n      <span class=\"change-avatar\" @click=\"handleSetAvatar\">\r\n        <img class=\"change-btn\" src=\"@/assets/img/user/account/colour-edit.svg\" alt=\"\" srcset=\"\" />\r\n      </span>\r\n    </div>\r\n\r\n    <div class=\"user-info-items\">\r\n      <div class=\"user-info-item\">\r\n        <div class=\"item-left\">\r\n          <span class=\"item-label\">{{ t('views.user.account.loginAccount') }}</span>\r\n          <span class=\"item-value\">{{ user_name }}</span>\r\n        </div>\r\n        <div class=\"item-right\">\r\n          <!-- <a>修改</a> -->\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"user-info-item\">\r\n        <div class=\"item-left\">\r\n          <span class=\"item-label\">{{ t('views.user.account.accountPassword') }}</span>\r\n          <span class=\"item-value\">**************</span>\r\n        </div>\r\n        <div class=\"item-right\" @click=\"handleOpenModifyAccountModal\">\r\n          <a>{{ t('common.change') }}</a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <ModifyAccount @ok=\"onLogout\" ref=\"modifyAccountRef\"></ModifyAccount>\r\n    <ModifyAvatar @ok=\"handleChangeAvatar\" ref=\"modifyAvatarRef\"></ModifyAvatar>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport { useUserStore } from '@/stores/modules/user'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\nimport ModifyAccount from './components/modify-account.vue'\r\nimport ModifyAvatar from './components/modify-avatar.vue'\r\n\r\nconst { t } = useI18n()\r\n\r\nconst userStore = useUserStore()\r\n\r\nconst { userInfo, avatar, user_name } = storeToRefs(userStore)\r\n\r\nconst modifyAccountRef = ref(null)\r\nconst handleOpenModifyAccountModal = () => {\r\n  modifyAccountRef.value.open(userInfo.value)\r\n}\r\n\r\nconst onLogout = () => {\r\n  userStore.reset(true)\r\n}\r\nconst modifyAvatarRef = ref(null)\r\nconst handleSetAvatar = () => {\r\n  modifyAvatarRef.value.setAvatar(userInfo.value)\r\n}\r\n\r\nconst handleChangeAvatar = (url) => {\r\n  userStore.setAvatar(url)\r\n}\r\n</script>\r\n"],"names":["_imports_0","emit","__emit","useForm","Form","t","useI18n","show","ref","modalTitle","formState","reactive","formRules","rule","value","validatePassword","resetFields","validate","validateInfos","open","record","handleOk","saveProfile","toRaw","res","message","__expose","_createElementBlock","_createVNode","_component_a_modal","$event","_createElementVNode","_hoisted_1","_component_a_form","_component_a_form_item","_mergeProps","_unref","_component_a_input_password","_cache","getBase64","file","resolve","reject","reader","error","fileList","imageUrl","beforeUpload","base64Url","triggerChange","data","uploadBtnRef","setAvatar","_openBlock","_component_a_upload","userStore","useUserStore","userInfo","avatar","user_name","storeToRefs","modifyAccountRef","handleOpenModifyAccountModal","onLogout","modifyAvatarRef","handleSetAvatar","handleChangeAvatar","url","_hoisted_2","_toDisplayString","_hoisted_3","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","ModifyAccount","ModifyAvatar"],"mappings":"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"}