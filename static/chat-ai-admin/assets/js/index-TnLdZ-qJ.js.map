{"version":3,"file":"index-TnLdZ-qJ.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/robot/robot-config/subscribe-reply/received-reply.vue","../../../../front-end/chat-ai-admin-vue/src/views/robot/robot-config/subscribe-reply/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"user-model-page\">\r\n    <!-- <div class=\"page-title\">关注后自动回复</div> -->\r\n    <div class=\"breadcrumb-wrap\">\r\n      <svg-icon @click=\"goBack\" name=\"back\" style=\"font-size: 20px;\" />\r\n      <div @click=\"goBack\" class=\"breadcrumb-title\">关注后回复</div>\r\n      <!-- 关注后回复开关，开关后面的提示：开启后，用户关注公众号后，回复指定的内容，该功能仅支持公众号内回复 -->\r\n       <a-switch v-model:checked=\"enabled_status\" :checkedValue=\"'1'\" :un-checkedValue=\"'0'\" checked-children=\"开\" un-checked-children=\"关\" @change=\"handleSwitchChange\" />\r\n       <span class=\"switch-tip\">开启后，用户关注公众号后，回复指定的内容，该功能仅支持公众号内回复</span>\r\n    </div>\r\n    <!-- 公众号列表 -->\r\n    <div class=\"mp-list-block\">\r\n      <div class=\"mp-list\" :class=\"{ expanded }\" ref=\"mpListRef\">\r\n        <div class=\"mp-card\" v-for=\"mp in (expanded ? mpAccounts : mpAccounts.slice(0, visibleCount))\" :key=\"mp.id\" :class=\"{ selected: mp.appid === selectedAppid }\" @click=\"selectMp(mp)\">\r\n          <img :src=\"mp.logo\" class=\"mp-logo\" />\r\n          <span class=\"mp-name\">{{ mp.name }}</span>\r\n        </div>\r\n        <a-button v-if=\"!expanded && mpAccounts.length > visibleCount\" type=\"dashed\" class=\"more-btn\" @click=\"expanded = true\">\r\n          更多 +{{ mpAccounts.length - visibleCount }}\r\n        </a-button>\r\n      </div>\r\n    </div>\r\n    <a-tabs v-model:activeKey=\"rule_type\" @change=\"onRuleTypeChange\" style=\"margin-top: 8px;\">\r\n      <a-tab-pane key=\"subscribe_reply_default\" tab=\"默认回复\" />\r\n      <a-tab-pane key=\"subscribe_reply_duration\" tab=\"按时段设置\" />\r\n      <a-tab-pane key=\"subscribe_reply_source\" tab=\"按关注来源设置\" />\r\n    </a-tabs>\r\n    <a-alert show-icon>\r\n      <template #message>\r\n        <p v-if=\"rule_type === 'subscribe_reply_default'\">关注后1分钟内只能给粉丝发送3条消息。建议关注后自动回复数量不要超过2条。可以根据关注来源或关注时间段单独设置回复</p>\r\n        <p v-else-if=\"rule_type === 'subscribe_reply_duration'\">优先级设置的区间为1-100的自然整数，数字越小，优先级越高。触发优先级为：按时间段回复>按关注来源回复>默认回复。</p>\r\n        <p v-else>触发优先级为：按时间段回复>按关注来源回复>默认回复。</p>\r\n      </template>\r\n    </a-alert>\r\n    <div class=\"search-block\" v-if=\"rule_type !== 'subscribe_reply_default'\">\r\n      <div class=\"left-block\">\r\n        <a-button type=\"primary\" @click=\"handleAddReply\">\r\n          <template #icon>\r\n            <PlusOutlined />\r\n          </template>\r\n          {{ rule_type === 'subscribe_reply_duration' ? '增加时段回复' : '新增回复' }}\r\n        </a-button>\r\n        <!-- 回复内容：text：文本，image：图片，voice：语音，video：视频 -->\r\n        <div class=\"search-item\">\r\n          <a-select\r\n            v-model=\"reply_type\"\r\n            placeholder=\"回复内容\"\r\n            allowClear\r\n            :options=\"replyTypeOptions\"\r\n            style=\"width: 240px;\"\r\n            @change=\"onReplyTypeChange\"\r\n          />\r\n        </div>\r\n\r\n        <!-- <div class=\"search-item\">\r\n          <a-input-search\r\n            v-model:value=\"search_keyword\"\r\n            placeholder=\"请输入关键词名称和规则名称搜索\"\r\n            allowClear\r\n            style=\"width: 240px;\"\r\n            @search=\"onSearch\"\r\n          >\r\n          </a-input-search>\r\n        </div> -->\r\n      </div>\r\n      </div>\r\n      <div class=\"list-box\" v-if=\"rule_type !== 'subscribe_reply_default'\">\r\n        <a-table\r\n        :columns=\"columns\"\r\n        :data-source=\"tableData\"\r\n        :loading=\"loading\"\r\n        :pagination=\"{\r\n          current: pager.page,\r\n          total: pager.total,\r\n          pageSize: pager.size,\r\n          showQuickJumper: true,\r\n          showSizeChanger: true,\r\n          pageSizeOptions: ['10', '20', '50', '100']\r\n        }\"\r\n        @change=\"onTableChange\"\r\n      >\r\n        <template #headerCell=\"{ column }\">\r\n          <span v-if=\"column.key === 'priority_num'\">\r\n            优先级\r\n            <a-tooltip title=\"优先级设置的数值不能重复，数值越小，优先级越高\">\r\n              <QuestionCircleOutlined />\r\n            </a-tooltip>\r\n          </span>\r\n          <span v-else-if=\"column.key === 'switch_status'\">\r\n            启用状态\r\n            <a-tooltip :title=\"rule_type === 'receive_reply_message_type' ? '开启开关后，触发消息类型回复指定的内容' : '开启后，按照设置的时间段回复指定的内容'\">\r\n              <QuestionCircleOutlined />\r\n            </a-tooltip>\r\n          </span>\r\n          <span v-else>{{ column.title }}</span>\r\n        </template>\r\n        <template #bodyCell=\"{ column, record }\">\r\n\r\n          <!-- 关注来源 -->\r\n          <template v-if=\"column.key === 'subscribe_source'\">\r\n            <span style=\"color:#595959;\">{{ formatMessageType(record) }}</span>\r\n          </template>\r\n          <!-- 回复内容 -->\r\n          <template v-if=\"column.key === 'reply_content'\">\r\n            <span style=\"color:#595959;\">{{ summarizeReplyTypes(record.reply_content) || '--' }}</span>\r\n          </template>\r\n\r\n          <template v-if=\"column.key === 'reply_num'\">\r\n            {{ record.reply_num == 0 ? '全部回复' : '随机回复一条' }}\r\n          </template>\r\n\r\n          <!-- 创建时间 -->\r\n          <template v-if=\"column.key === 'create_time'\">\r\n            <span style=\"color:#595959;\">{{ formatDateFn(record.create_time) || '--' }}</span>\r\n          </template>\r\n\r\n          <template v-if=\"column.key === 'duration'\">\r\n            <span style=\"color:#595959; white-space: pre-wrap;\">{{ formatDurationLabel(record) }}</span>\r\n          </template>\r\n\r\n          <!-- 优先级可编辑 -->\r\n          <template v-if=\"column.key === 'priority_num'\">\r\n            <a-input-number\r\n              v-model:value=\"record.priority_num\"\r\n              :min=\"1\"\r\n              :max=\"100\"\r\n              :precision=\"0\"\r\n              style=\"width: 96px;\"\r\n              @blur=\"onPriorityChange(record)\"\r\n              @pressEnter=\"onPriorityChange(record)\"\r\n            />\r\n          </template>\r\n\r\n          <!-- 启用状态 开关-->\r\n          <template v-if=\"column.key === 'switch_status'\">\r\n            <a-switch\r\n              :checked=\"record.switch_status\"\r\n              :checkedValue=\"'1'\"\r\n              :un-checkedValue=\"'0'\"\r\n              checked-children=\"开\"\r\n              un-checked-children=\"关\"\r\n              @change=\"handleReplySwitchChange(record, $event)\"\r\n            />\r\n          </template>\r\n\r\n\r\n          <!-- 操作 -->\r\n          <template v-if=\"column.key === 'action'\">\r\n            <a-flex :gap=\"8\">\r\n              <a @click=\"handleEdit(record)\">编辑</a>\r\n              <a @click=\"handleDelete(record)\">删除</a>\r\n              <a @click=\"handleCopy(record)\">复制</a>\r\n            </a-flex>\r\n          </template>\r\n        </template>\r\n      </a-table>\r\n    </div>\r\n\r\n    <div v-if=\"rule_type === 'subscribe_reply_default'\" class=\"reply-editor\">\r\n      <div class=\"reply-editor-item\" v-for=\"(rule, ri) in defaultRules\" :key=\"rule.id\">\r\n        <div class=\"switch-box\">\r\n          <div class=\"nav-box\">关注后自动回复（优先级：{{ rule.priority_num }}）</div>\r\n          <a-switch\r\n            :checked=\"rule.switch_status\"\r\n            :checkedValue=\"'1'\"\r\n            :un-checkedValue=\"'0'\"\r\n            checked-children=\"开\"\r\n            un-checked-children=\"关\"\r\n            @change=\"(val) => handleRuleSwitchChange(ri, val)\"\r\n          />\r\n        </div>\r\n        <transition name=\"collapse\">\r\n        <div class=\"reply-main\" v-show=\"rule.switch_status === '1'\">\r\n          <div class=\"content-box\">\r\n            <div class=\"nav-box\">回复内容：</div>\r\n            <div class=\"item-box\">\r\n              <MultiReply v-for=\"(it, idx) in rule.replyList\" :key=\"idx\" :ref=\"el => setRuleReplyRef(ri, idx, el)\" v-model:value=\"rule.replyList[idx]\" :reply_index=\"idx\"\r\n                @change=\"(payload) => onRuleContentChange(ri, payload)\" @del=\"(index) => onRuleDelItem(ri, index)\" />\r\n              <a-button type=\"dashed\" style=\"width: 694px;\" :disabled=\"rule.replyList.length >= 5\" @click=\"() => addRuleReplyItem(ri)\">\r\n                <template #icon>\r\n                  <PlusOutlined />\r\n                </template>\r\n                添加回复内容({{rule.replyList.length}}/5)\r\n              </a-button>\r\n            </div>\r\n          </div>\r\n          <div class=\"method-box\">\r\n            <div class=\"nav-box\">回复方式：</div>\r\n            <a-radio-group v-model:value=\"rule.reply_num\">\r\n              <a-radio :value=\"0\">全部回复</a-radio>\r\n              <a-radio :value=\"1\">随机回复一条</a-radio>\r\n            </a-radio-group>\r\n          </div>\r\n          <div style=\"margin-top: 8px;\">\r\n            <a-button type=\"primary\" @click=\"onSaveRule(ri)\">保存</a-button>\r\n          </div>\r\n        </div>\r\n        </transition>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, computed, onMounted, onUnmounted, nextTick } from 'vue'\r\nimport MultiReply from '@/components/replay-card/multi-reply.vue'\r\nimport { QuestionCircleOutlined, PlusOutlined } from '@ant-design/icons-vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { getRobotSubscribeReplyList, updateRobotSubscribeReplyPriorityNum, updateRobotSubscribeReplySwitchStatus, deleteRobotSubscribeReply, saveRobotSubscribeReply, getSpecifyAbilityConfig, saveUserAbility } from '@/api/explore/index.js'\r\nimport { getWechatAppList } from '@/api/robot'\r\nimport { REPLY_TYPE_OPTIONS, REPLY_TYPE_LABEL_MAP, SUBSCRIBE_SOURCE_OPTIONS } from '@/constants/index'\r\nimport { message, Modal } from 'ant-design-vue'\r\nimport dayjs from 'dayjs'\r\n\r\nconst replyRefs = ref([])\r\nconst ruleReplyRefs = ref({})\r\nconst query = useRoute().query\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\nconst rule_type = ref(query.subscribe_rule_type || 'subscribe_reply_default')\r\nconst defaultRules = ref([])\r\nconst enabled_status = ref('0')\r\n\r\nconst mpAccounts = ref([])\r\nconst selectedAppid = ref('')\r\nconst expanded = ref(false)\r\nconst mpListRef = ref(null)\r\nconst visibleCount = ref(0)\r\nconst CARD_WIDTH = 160\r\nconst GAP = 8\r\nconst MORE_BTN_WIDTH = 96\r\n\r\nfunction calcVisibleCount () {\r\n  const el = mpListRef.value\r\n  if (!el) { visibleCount.value = 0; return }\r\n  const w = el.clientWidth || 0\r\n  const per = CARD_WIDTH + GAP\r\n  const count = Math.floor((w - MORE_BTN_WIDTH) / per)\r\n  visibleCount.value = Math.max(count, 0)\r\n}\r\n\r\nconst getWechatAppListFn = async() => {\r\n  try {\r\n    const res = await getWechatAppList({ app_type: 'official_account', app_name: '' })\r\n    const list = Array.isArray(res?.data) ? res.data : []\r\n    // 只需要account_is_verify为true的公众号\r\n    mpAccounts.value = list.filter((it) => it.account_is_verify == 'true').map((it) => ({ id: it.id, appid: it.app_id, name: it.app_name, logo: it.app_avatar }))\r\n    selectedAppid.value = mpAccounts.value[0]?.appid || ''\r\n  } catch (_e) {\r\n    mpAccounts.value = []\r\n    selectedAppid.value = ''\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const res = await getSpecifyAbilityConfig({ ability_type: 'robot_subscribe_reply' })\r\n    const item = res?.data\r\n    const status = String(item?.user_config?.switch_status ?? '0')\r\n    enabled_status.value = status\r\n  } catch (_) { enabled_status.value = '0' }\r\n  await getWechatAppListFn()\r\n  nextTick(calcVisibleCount)\r\n  window.addEventListener('resize', calcVisibleCount)\r\n  if (rule_type.value === 'subscribe_reply_default') {\r\n    loadDefaultRule()\r\n  }\r\n})\r\nonUnmounted(() => { window.removeEventListener('resize', calcVisibleCount) })\r\n\r\nconst columnsMessageType = [\r\n  { title: '关注来源', dataIndex: 'subscribe_source', key: 'subscribe_source', width: 120 },\r\n  { title: '回复内容', dataIndex: 'reply_content', key: 'reply_content', width: 120 },\r\n  { title: '回复方式', dataIndex: 'reply_num', key: 'reply_num', width: 120 },\r\n  { title: '创建时间', dataIndex: 'create_time', key: 'create_time', width: 120 },\r\n  { title: '启用状态', dataIndex: 'switch_status', key: 'switch_status', width: 120 },\r\n  { title: '操作', dataIndex: 'action', key: 'action', width: 120 }\r\n]\r\n\r\nconst columnsDuration = [\r\n  { title: '时间段', dataIndex: 'duration', key: 'duration', width: 220 },\r\n  { title: '回复内容', dataIndex: 'reply_content', key: 'reply_content', width: 120 },\r\n  { title: '回复方式', dataIndex: 'reply_num', key: 'reply_num', width: 120 },\r\n  { title: '优先级', dataIndex: 'priority_num', key: 'priority_num', width: 120 },\r\n  { title: '创建时间', dataIndex: 'create_time', key: 'create_time', width: 120 },\r\n  { title: '启用状态', dataIndex: 'switch_status', key: 'switch_status', width: 120 },\r\n  { title: '操作', dataIndex: 'action', key: 'action', width: 120 }\r\n]\r\n\r\nconst columns = computed(() => rule_type.value === 'subscribe_reply_duration' ? columnsDuration : columnsMessageType)\r\n\r\nconst pager = reactive({\r\n  page: 1,\r\n  size: 10,\r\n  total: 0\r\n})\r\nconst replyTypeOptions = REPLY_TYPE_OPTIONS()\r\nconst tableData = ref([])\r\nconst loading = ref(false)\r\nconst reply_type = ref('')\r\n// const search_keyword = ref('')\r\nconst getTableData = () => {\r\n  const parmas = {\r\n    rule_type: rule_type.value,\r\n    reply_type: reply_type.value || '',\r\n    appid: selectedAppid.value || '',\r\n    page: pager.page,\r\n    size: pager.size\r\n  }\r\n  loading.value = true\r\n  getRobotSubscribeReplyList({\r\n    ...parmas\r\n  })\r\n    .then((res) => {\r\n      const data = res?.data || { list: [], total: 0, page: pager.page, size: pager.size }\r\n      tableData.value = (data.list || []).map((item) => ({\r\n        ...item,\r\n        reply_content: Array.isArray(item.reply_content) ? item.reply_content : [],\r\n        switch_status: String(item.switch_status ?? '0'),\r\n        duration_type: item.duration_type || '',\r\n        start_duration: item.start_duration || '',\r\n        end_duration: item.end_duration || '',\r\n        priority_num: item.priority_num ?? '',\r\n        subscribe_source: Array.isArray(item.subscribe_source) ? item.subscribe_source : []\r\n      }))\r\n      pager.total = +data.total || 0\r\n    })\r\n    .finally(() => {\r\n      loading.value = false\r\n    })\r\n}\r\ngetTableData()\r\n\r\nconst onTableChange = (pagination) => {\r\n  pager.page = pagination.current\r\n  pager.size = pagination.pageSize\r\n  getTableData()\r\n}\r\n\r\nconst onSearch = () => {\r\n  pager.page = 1\r\n  getTableData()\r\n}\r\n\r\nconst onReplyTypeChange = (val) => {\r\n  reply_type.value = val\r\n  onSearch()\r\n}\r\n\r\nconst onRuleTypeChange = () => {\r\n  pager.page = 1\r\n  getTableData()\r\n  if (rule_type.value === 'subscribe_reply_default') {\r\n    loadDefaultRule()\r\n  }\r\n}\r\n\r\nfunction selectMp (mp) {\r\n  selectedAppid.value = mp.appid\r\n  expanded.value = true\r\n  pager.page = 1\r\n  getTableData()\r\n  if (rule_type.value === 'subscribe_reply_default') {\r\n    loadDefaultRule()\r\n  }\r\n}\r\n\r\nasync function onPriorityChange (record) {\r\n  const val = Number(record.priority_num)\r\n  if (!Number.isInteger(val) || val < 0) {\r\n    message.error('请输入有效的优先级')\r\n    return\r\n  }\r\n  try {\r\n    await updateRobotSubscribeReplyPriorityNum({ id: record.id, priority_num: val, appid: selectedAppid.value || '' })\r\n    message.success('优先级已更新')\r\n    getTableData()\r\n  } catch (e) {\r\n    // message.error('更新失败，请稍后重试')\r\n  }\r\n}\r\n\r\nconst handleAddReply = () => {\r\n  router.push({\r\n    path: '/explore/index/subscribe-reply/add-rule',\r\n    query: {\r\n      subscribe_rule_type: rule_type.value,\r\n      appid: selectedAppid.value || ''\r\n    }\r\n  })\r\n}\r\n\r\n  const handleEdit = (record) => {\r\n    router.push({\r\n      path: '/explore/index/subscribe-reply/add-rule',\r\n      query: {\r\n        rule_id: record.id,\r\n        appid: selectedAppid.value || ''\r\n      }\r\n    })\r\n  }\r\n\r\n  const handleCopy = (record) => {\r\n    router.push({\r\n      path: '/explore/index/subscribe-reply/add-rule',\r\n      query: {\r\n        copy_id: record.id,\r\n        appid: selectedAppid.value || ''\r\n      }\r\n    })\r\n  }\r\n\r\nconst handleReplySwitchChange = (record, checked) => {\r\n  const switch_status = checked\r\n  updateRobotSubscribeReplySwitchStatus({ id: record.id, switch_status, appid: selectedAppid.value || '' }).then((res) => {\r\n    if (res && res.res == 0) {\r\n      record.switch_status = switch_status\r\n      message.success('操作成功')\r\n    }\r\n  })\r\n}\r\n\r\nconst handleDelete = (record) => {\r\n  // 确认删除\r\n  Modal.confirm({\r\n    title: '确认删除吗？',\r\n    okText: '确认',\r\n    onOk: () => {\r\n      deleteRobotSubscribeReply({ id: record.id }).then((res) => {\r\n        if (res && res.res == 0) {\r\n          message.success('删除成功')\r\n          getTableData()\r\n        }\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\nfunction serializeReplyContent (list) {\r\n  return (list || []).map((it) => ({ ...it, status: '1' }))\r\n}\r\n\r\nfunction serializeReplyTypeCodes (list) {\r\n  const map = { text: '2', image: '4', card: '3', imageText: '1', url: '5', smartMenu: '6' }\r\n  return list.map((it) => map[it.type] || '').filter(Boolean)\r\n}\r\n\r\nasync function loadDefaultRule () {\r\n  try {\r\n    const res = await getRobotSubscribeReplyList({ rule_type: 'subscribe_reply_default', appid: selectedAppid.value || '', page: 1, size: 3 })\r\n    const list = Array.isArray(res?.data?.list) ? res.data.list : []\r\n    defaultRules.value = list.map((item) => ({\r\n      id: Number(item.id || 0),\r\n      priority_num: Number(item.priority_num || 0),\r\n      switch_status: String(item.switch_status ?? '0'),\r\n      reply_num: Number(item.reply_num || 0),\r\n      replyList: (Array.isArray(item.reply_content) ? item.reply_content : []).map((rc) => ({\r\n        type: rc?.type || rc?.reply_type || 'text',\r\n        description: rc?.description || '',\r\n        thumb_url: rc?.thumb_url || rc?.pic || '',\r\n        title: rc?.title || '',\r\n        url: rc?.url || '',\r\n        appid: rc?.appid || '',\r\n        page_path: rc?.page_path || '',\r\n        smart_menu_id: rc?.smart_menu_id || '',\r\n        smart_menu: rc?.smart_menu || {},\r\n      }))\r\n    }))\r\n    // 填充至3条数据\r\n    const need = 3 - defaultRules.value.length\r\n    if (need > 0) {\r\n      const start = defaultRules.value.length + 1\r\n      for (let i = 0; i < need; i++) {\r\n        defaultRules.value.push({ id: 0, priority_num: start + i, switch_status: '0', reply_num: 0, replyList: [{ type: 'text', description: '' }] })\r\n      }\r\n    }\r\n  } catch (e) {\r\n    // 接口失败时也保证3条\r\n    defaultRules.value = [\r\n      { id: 0, priority_num: 1, switch_status: '0', reply_num: 0, replyList: [{ type: 'text', description: '' }] },\r\n      { id: 0, priority_num: 2, switch_status: '0', reply_num: 0, replyList: [{ type: 'text', description: '' }] },\r\n      { id: 0, priority_num: 3, switch_status: '0', reply_num: 0, replyList: [{ type: 'text', description: '' }] }\r\n    ]\r\n  }\r\n}\r\n\r\nasync function onSaveRule (ri) {\r\n  if (!selectedAppid.value) {\r\n    message.warning('请选择公众号')\r\n    return\r\n  }\r\n  const rule = defaultRules.value[ri]\r\n  if (!rule || !Array.isArray(rule.replyList) || rule.replyList.length === 0) {\r\n    message.warning('请完善回复内容')\r\n    return\r\n  }\r\n  const arr = Array.isArray(ruleReplyRefs.value[ri]) ? ruleReplyRefs.value[ri].filter(Boolean) : []\r\n  for (const comp of arr) {\r\n    if (comp && comp.validate) {\r\n      const ok = await comp.validate()\r\n      if (!ok) { return }\r\n    }\r\n  }\r\n  try {\r\n    const payload = {\r\n      appid: selectedAppid.value,\r\n      rule_type: 'subscribe_reply_default',\r\n      reply_content: JSON.stringify(serializeReplyContent(rule.replyList)),\r\n      reply_type: serializeReplyTypeCodes(rule.replyList),\r\n      priority_num: Number(rule.priority_num) || 0,\r\n      reply_num: Number(rule.reply_num) || 0,\r\n      switch_status: Number(rule.switch_status) || 0,\r\n      id: Number(rule.id) || undefined\r\n    }\r\n    const res = await saveRobotSubscribeReply(payload)\r\n    if (res && res.res == 0) {\r\n      message.success('保存成功')\r\n      loadDefaultRule()\r\n    }\r\n  } catch (e) {\r\n    // message.error('保存失败，请稍后重试')\r\n  }\r\n}\r\n\r\nfunction handleRuleSwitchChange (ri, val) {\r\n  const next = String(val)\r\n  const rule = defaultRules.value[ri]\r\n  if (!rule?.id) {\r\n    defaultRules.value[ri].switch_status = next\r\n    message.info('请先保存当前规则')\r\n    return\r\n  }\r\n  updateRobotSubscribeReplySwitchStatus({ id: rule.id, switch_status: next, appid: selectedAppid.value || '' })\r\n    .then((res) => {\r\n      if (res && res.res == 0) {\r\n        defaultRules.value[ri].switch_status = next\r\n        message.success('操作成功')\r\n      }\r\n    })\r\n}\r\n\r\nfunction mapReplyTypeLabel (t) {\r\n  return REPLY_TYPE_LABEL_MAP()[t] || ''\r\n}\r\n\r\nfunction summarizeReplyTypes (list) {\r\n  if (!Array.isArray(list)) return ''\r\n  const labels = list\r\n    .map((rc) => mapReplyTypeLabel(rc?.type))\r\n    .filter((s) => !!s)\r\n  // 去重并使用/连接\r\n  const uniq = [...new Set(labels)]\r\n  return uniq.join('/')\r\n}\r\n\r\nfunction formatWeek (v) {\r\n  const map = { '1': '周一', '2': '周二', '3': '周三', '4': '周四', '5': '周五', '6': '周六', '7': '周日' }\r\n  const s = String(v || '')\r\n  return map[s] || s\r\n}\r\n\r\nfunction formatDate (s) {\r\n  const str = String(s || '')\r\n  if (!str) return ''\r\n  if (/^\\d{4}-\\d{2}-\\d{2}/.test(str)) return str.slice(0, 10)\r\n  return str\r\n}\r\n\r\nfunction formatDateFn (date, format = 'YYYY-MM-DD') {\r\n  if (!date) return ''\r\n  return dayjs(date * 1000).format(format)\r\n}\r\n\r\nfunction formatTime (s) {\r\n  const str = String(s || '')\r\n  if (!str) return ''\r\n  if (/^\\d{2}:\\d{2}/.test(str)) return str.slice(0, 5)\r\n  return str\r\n}\r\n\r\nfunction formatDurationLabel (record) {\r\n  const type = record?.duration_type || ''\r\n  const wd = record?.week_duration || ''\r\n  const sd = record?.start_duration || ''\r\n  const ed = record?.end_duration || ''\r\n  if (type === 'week') {\r\n    const weekList = Array.isArray(wd) ? wd.map(v => String(v)) : (wd ? [String(wd)] : [])\r\n    const weekText = weekList.length ? weekList.map(v => formatWeek(v)).join('、') : ''\r\n    const timeText = `${formatTime(sd)} 至 ${formatTime(ed)}`\r\n    return weekText ? `每星期${weekText}：${timeText}` : `每星期：${timeText}`\r\n  }\r\n  if (type === 'day') {\r\n    return `每天：${formatDate(sd)} 至 ${formatDate(ed)}`\r\n  }\r\n  if (type === 'time_range') {\r\n    const sDay = record?.start_day || ''\r\n    const eDay = record?.end_day || ''\r\n    const startStr = `${formatDate(sDay)} ${formatTime(sd)}`.trim()\r\n    const endStr = `${formatDate(eDay)} ${formatTime(ed)}`.trim()\r\n    return `自定义时间：\\n${startStr} 至 ${endStr}`\r\n  }\r\n  return `${type || ''}：${sd || ''} 至 ${ed || ''}`\r\n}\r\n\r\nconst SUBSCRIBE_SOURCE_LABEL_MAP = Object.fromEntries((SUBSCRIBE_SOURCE_OPTIONS() || []).map((op) => [String(op.value), op.label]))\r\n\r\nfunction formatMessageType (record) {\r\n  const list = Array.isArray(record?.subscribe_source) ? record.subscribe_source : []\r\n  if (!list.length) return '--'\r\n  const labels = list.map((v) => SUBSCRIBE_SOURCE_LABEL_MAP[String(v)] || String(v)).filter(Boolean)\r\n  return labels.length ? labels.join('、') : '--'\r\n}\r\n\r\nfunction addRuleReplyItem (ri) {\r\n  const list = defaultRules.value[ri]?.replyList || []\r\n  if (list.length >= 5) return\r\n  list.push({ type: 'text', description: '' })\r\n}\r\nfunction onRuleContentChange (ri, payload) {\r\n  const { reply_index, ...rest } = payload\r\n  const list = defaultRules.value[ri]?.replyList || []\r\n  if (reply_index >= 0 && reply_index < list.length) {\r\n    list[reply_index] = rest\r\n  }\r\n}\r\nfunction onRuleDelItem (ri, index) { (defaultRules.value[ri]?.replyList || []).splice(index, 1) }\r\n\r\nfunction setRuleReplyRef (ri, idx, el) {\r\n  const map = ruleReplyRefs.value\r\n  const arr = Array.isArray(map[ri]) ? map[ri] : []\r\n  arr[idx] = el\r\n  map[ri] = arr\r\n}\r\n\r\nconst goBack = () => {\r\n  if (route.query.id && route.query.robot_key) {\r\n    router.push({ path: '/robot/config/function-center', query: { id: route.query.id, robot_key: route.query.robot_key } })\r\n  } else {\r\n    router.push({ path: '/explore/index' })\r\n  }\r\n}\r\n\r\nconst handleSwitchChange = (checked) => {\r\n  const prev = enabled_status.value\r\n  const next = checked\r\n  if (next === '0') {\r\n    Modal.confirm({\r\n      title: '提示',\r\n      content: '关闭后，该功能默认关闭不再支持使用，所有的公众号菜单都会停用，确认关闭？',\r\n      onOk: () => {\r\n        saveUserAbility({ ability_type: 'robot_subscribe_reply', switch_status: next }).then((res) => {\r\n          if (res && res.res == 0) {\r\n            enabled_status.value = next\r\n            message.success('操作成功')\r\n          } else {\r\n            enabled_status.value = prev\r\n          }\r\n        }).catch(() => { enabled_status.value = prev })\r\n      },\r\n      onCancel: () => { enabled_status.value = '1' }\r\n    })\r\n    return\r\n  }\r\n  saveUserAbility({ ability_type: 'robot_subscribe_reply', switch_status: next }).then((res) => {\r\n    if (res && res.res == 0) {\r\n      enabled_status.value = next\r\n      message.success('操作成功')\r\n    } else {\r\n      enabled_status.value = prev\r\n    }\r\n  }).catch(() => { enabled_status.value = prev })\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.user-model-page {\r\n  width: 100%;\r\n  .page-title {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 24px;\r\n    padding-bottom: 16px;\r\n    background-color: #fff;\r\n    color: #000000;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n  }\r\n  .search-block {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    margin-top: 16px;\r\n    .left-block {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 16px;\r\n    }\r\n    .right-block {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 2px;\r\n    }\r\n  }\r\n  .list-box {\r\n    margin-top: 8px;\r\n  }\r\n  ::v-deep(.ant-alert) {\r\n    align-items: baseline;\r\n  }\r\n}\r\n\r\n.switch-block {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 16px;\r\n\r\n  .switch-title {\r\n    margin-right: 12px;\r\n    color: #262626;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n  }\r\n}\r\n.switch-desc {\r\n  margin-left: 4px;\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 22px;\r\n}\r\n\r\n.flex {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.popover-cont {\r\n  max-width: 560px;\r\n}\r\n\r\n.mp-list-block {\r\n  margin: 8px 0 4px 0;\r\n}\r\n.mp-list {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  flex-wrap: nowrap;\r\n}\r\n.mp-list.expanded {\r\n  flex-wrap: wrap;\r\n}\r\n.mp-card {\r\n  cursor: pointer;\r\n  min-width: 160px;\r\n  padding: 8px 12px;\r\n  border-radius: 8px;\r\n  background: #fff;\r\n  border: 1px solid #edeff2;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n\r\n  &:hover {\r\n    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.08);\r\n  }\r\n}\r\n\r\n.selected {\r\n  border-color: #1890ff;\r\n  background-color: rgba(24, 144, 255, 0.04);\r\n}\r\n.mp-logo {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n}\r\n.mp-name {\r\n  color: #262626;\r\n  font-size: 14px;\r\n  line-height: 22px;\r\n}\r\n.more-btn {\r\n  flex: 0 0 auto;\r\n}\r\n\r\n.reply-editor {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n  margin-top: 16px;\r\n\r\n  .reply-editor-item {\r\n    border: 1px solid #edeff2;\r\n    padding: 12px;\r\n    border-radius: 8px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 8px;\r\n\r\n    .switch-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n    }\r\n\r\n    .content-box {\r\n      margin-top: 8px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n    }\r\n\r\n    .method-box {\r\n      margin-top: 8px;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n    }\r\n  }\r\n}\r\n\r\n.collapse-enter-active,\r\n.collapse-leave-active {\r\n  transition: max-height .2s ease, opacity .2s ease, padding .2s ease;\r\n}\r\n.collapse-enter-from,\r\n.collapse-leave-to {\r\n  max-height: 0;\r\n  opacity: 0;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n}\r\n.collapse-enter-to,\r\n.collapse-leave-from {\r\n  max-height: 1000px;\r\n  opacity: 1;\r\n}\r\n.reply-main {\r\n  overflow: hidden;\r\n}\r\n.subManage-breadcrumb {\r\n  display: flex;\r\n  align-items: center;\r\n  color: #000000;\r\n  font-family: \"PingFang SC\";\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  line-height: 22px;\r\n  padding-bottom: 16px;\r\n}\r\n\r\n.breadcrumb-wrap {\r\n  width: fit-content;\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  margin-bottom: 16px;\r\n}\r\n.breadcrumb-title {\r\n  margin: 0 12px 0 2px;\r\n  color: #262626;\r\n  font-size: 16px;\r\n  font-style: normal;\r\n  font-weight: 600;\r\n  line-height: 24px;\r\n}\r\n\r\n.switch-tip {\r\n  margin-left: 4px;\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 22px;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"auto-reply-home\">\r\n    <template v-if=\"hasApps\">\r\n      <ReceivedReply />\r\n    </template>\r\n    <template v-else>\r\n      <div class=\"user-model-page\">\r\n        <!-- <div class=\"page-title\">关注后自动回复</div> -->\r\n        <div class=\"breadcrumb-wrap\">\r\n          <svg-icon @click=\"goBack\" name=\"back\" style=\"font-size: 20px;\" />\r\n          <div @click=\"goBack\" class=\"breadcrumb-title\">关注后回复</div>\r\n          <a-switch v-model:checked=\"enabled_status\" :checkedValue=\"'1'\" :un-checkedValue=\"'0'\" checked-children=\"开\" un-checked-children=\"关\" @change=\"handleSwitchChange\" />\r\n          <span class=\"switch-tip\">开启后，用户关注公众号后，回复指定的内容，该功能仅支持公众号内回复</span>\r\n        </div>\r\n        <a-alert show-icon>\r\n          <template #message>\r\n            开启后，用户关注公众号后，回复指定的内容，<span style=\"color: #FF4D4F;\">该功能仅支持公众号内回复</span>\r\n          </template>\r\n        </a-alert>\r\n        <div class=\"empty-wrap\">\r\n          <ListEmpty size=\"180\">\r\n            <div class=\"empty-default\">暂未绑定公众号</div>\r\n            <div class=\"empty-sub\">请选到系统设置>公众号管理绑定公众号</div>\r\n          </ListEmpty>\r\n          <div class=\"empty-actions\">\r\n            <a-button type=\"primary\" @click=\"goBind\">去绑定公众号</a-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </div>\r\n  \r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { useRoute,useRouter } from 'vue-router'\r\nimport { getWechatAppList } from '@/api/robot'\r\nimport ReceivedReply from './received-reply.vue'\r\nimport ListEmpty from '@/views/robot/robot-config/function-center/components/list-empty.vue'\r\nimport { getSpecifyAbilityConfig, saveUserAbility } from '@/api/explore/index.js'\r\nimport { message, Modal } from 'ant-design-vue'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst hasApps = ref(true)\r\nconst enabled_status = ref('0')\r\n\r\nconst fetchApps = async () => {\r\n  try {\r\n    const res = await getWechatAppList({ app_type: 'official_account', app_name: '' })\r\n    // 只需要account_is_verify为true的公众号\r\n    const list = Array.isArray(res?.data) ? res.data.filter((it) => it.account_is_verify == 'true') : []\r\n    hasApps.value = list.length > 0\r\n  } catch (_e) {\r\n    hasApps.value = false\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const res = await getSpecifyAbilityConfig({ ability_type: 'robot_subscribe_reply' })\r\n    const item = res?.data\r\n    const status = String(item?.user_config?.switch_status ?? '0')\r\n    enabled_status.value = status\r\n  } catch (_) { enabled_status.value = '0' }\r\n  fetchApps()\r\n})\r\n\r\nconst goBind = () => {\r\n  const url = router.resolve({ path: '/user/official-account' })\r\n  window.open(url.href, '_blank')\r\n}\r\n\r\nconst goBack = () => {\r\n  if (route.query.id && route.query.robot_key) {\r\n    router.push({ path: '/robot/config/function-center', query: { id: route.query.id, robot_key: route.query.robot_key } })\r\n  } else {\r\n    router.push({ path: '/explore/index' })\r\n  }\r\n}\r\n\r\nconst handleSwitchChange = (checked) => {\r\n  const prev = enabled_status.value\r\n  const next = checked\r\n  if (next === '0') {\r\n    Modal.confirm({\r\n      title: '提示',\r\n      content: '关闭后，该功能默认关闭不再支持使用，所有的公众号菜单都会停用，确认关闭？',\r\n      onOk: () => {\r\n        saveUserAbility({ ability_type: 'robot_subscribe_reply', switch_status: next }).then((res) => {\r\n          if (res && res.res == 0) {\r\n            enabled_status.value = next\r\n            message.success('操作成功')\r\n          } else {\r\n            enabled_status.value = prev\r\n          }\r\n        }).catch(() => { enabled_status.value = prev })\r\n      },\r\n      onCancel: () => { enabled_status.value = '1' }\r\n    })\r\n    return\r\n  }\r\n  saveUserAbility({ ability_type: 'robot_subscribe_reply', switch_status: next }).then((res) => {\r\n    if (res && res.res == 0) {\r\n      enabled_status.value = next\r\n      message.success('操作成功')\r\n    } else {\r\n      enabled_status.value = prev\r\n    }\r\n  }).catch(() => { enabled_status.value = prev })\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.auto-reply-home {\r\n  height: 100%;\r\n  width: 100%;\r\n  padding: 16px 48px;\r\n  overflow-y: auto;\r\n}\r\n.empty-wrap {\r\n  margin-top: 100px;\r\n  height: calc(100% - 32px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 12px;\r\n  .empty-default {\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 24px;\r\n  }\r\n  .empty-sub {\r\n    font-size: 14px;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    line-height: 22px;\r\n  }\r\n}\r\n.empty-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.page-title {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 24px;\r\n  padding-bottom: 16px;\r\n  background-color: #fff;\r\n  color: #000000;\r\n  font-size: 16px;\r\n  font-style: normal;\r\n  font-weight: 600;\r\n  line-height: 24px;\r\n}\r\n.subManage-breadcrumb {\r\n  display: flex;\r\n  align-items: center;\r\n  color: #000000;\r\n  font-family: \"PingFang SC\";\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  line-height: 22px;\r\n  padding-bottom: 16px;\r\n}\r\n\r\n.breadcrumb-wrap {\r\n  width: fit-content;\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  margin-bottom: 16px;\r\n}\r\n.breadcrumb-title {\r\n  margin: 0 12px 0 2px;\r\n  color: #262626;\r\n  font-size: 16px;\r\n  font-style: normal;\r\n  font-weight: 600;\r\n  line-height: 24px;\r\n}\r\n.switch-tip {\r\n  margin-left: 4px;\r\n  color: #8c8c8c;\r\n  font-size: 14px;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  line-height: 22px;\r\n}\r\n</style>\r\n"],"names":["CARD_WIDTH","GAP","MORE_BTN_WIDTH","ref","ruleReplyRefs","query","useRoute","route","router","useRouter","rule_type","defaultRules","enabled_status","mpAccounts","selectedAppid","expanded","mpListRef","visibleCount","calcVisibleCount","el","w","per","count","getWechatAppListFn","res","getWechatAppList","list","it","_a","onMounted","getSpecifyAbilityConfig","item","status","nextTick","loadDefaultRule","onUnmounted","columnsMessageType","columnsDuration","columns","computed","pager","reactive","replyTypeOptions","REPLY_TYPE_OPTIONS","tableData","loading","reply_type","getTableData","parmas","getRobotSubscribeReplyList","data","onTableChange","pagination","onSearch","onReplyTypeChange","val","onRuleTypeChange","selectMp","mp","onPriorityChange","record","message","updateRobotSubscribeReplyPriorityNum","handleAddReply","handleEdit","handleCopy","handleReplySwitchChange","checked","switch_status","updateRobotSubscribeReplySwitchStatus","handleDelete","Modal","deleteRobotSubscribeReply","serializeReplyContent","serializeReplyTypeCodes","map","rc","need","start","i","onSaveRule","ri","rule","arr","comp","payload","saveRobotSubscribeReply","handleRuleSwitchChange","next","mapReplyTypeLabel","REPLY_TYPE_LABEL_MAP","summarizeReplyTypes","labels","formatWeek","v","s","formatDate","str","formatDateFn","date","format","dayjs","formatTime","formatDurationLabel","type","wd","sd","ed","weekList","weekText","timeText","sDay","eDay","startStr","endStr","SUBSCRIBE_SOURCE_LABEL_MAP","SUBSCRIBE_SOURCE_OPTIONS","op","formatMessageType","addRuleReplyItem","onRuleContentChange","reply_index","rest","onRuleDelItem","index","setRuleReplyRef","idx","goBack","handleSwitchChange","prev","saveUserAbility","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_svg_icon","_component_a_switch","$event","_cache","_hoisted_3","_normalizeClass","_Fragment","_renderList","_hoisted_6","_toDisplayString","_createBlock","_component_a_button","_createTextVNode","_component_a_tabs","_component_a_tab_pane","_component_a_alert","_hoisted_10","_hoisted_11","_unref","PlusOutlined","_hoisted_12","_component_a_select","_hoisted_13","_component_a_table","_withCtx","column","_hoisted_14","_component_a_tooltip","QuestionCircleOutlined","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_component_a_input_number","_component_a_flex","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_Transition","_withDirectives","_hoisted_27","_hoisted_28","_hoisted_29","MultiReply","_hoisted_30","_component_a_radio_group","_component_a_radio","_hoisted_31","_vShow","hasApps","fetchApps","goBind","url","ReceivedReply","_hoisted_4","ListEmpty","_hoisted_5"],"mappings":"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"}