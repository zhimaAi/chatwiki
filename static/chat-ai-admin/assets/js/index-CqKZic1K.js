import{d,z as U,N as M,O as R,j as i,U as h,X as o,W as P,u as l,G as F,a8 as I,_ as b}from"./vue-chunks-BRsu9_To.js";import{b as j,M as N,m as B,k as A,f as $,h as q}from"../../index-CzPebXix.js";import{v as G}from"./validate-8MtiUsxW.js";import{F as L,_ as J}from"./index-BgVvqN-n.js";import{_ as V}from"./Password-fnCqxsm2.js";import{_ as z}from"./index-7Ecr060x.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./Trigger-Bvakuge0.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./isPlainObject-OEy0Jz8l.js";import"./Col-CFxRRwN8.js";import"./responsiveObserve-DqAe0rZk.js";import"./collapseMotion-Brd6xpAT.js";import"./index-BwqnaIPU.js";import"./colors-DfoziJR7.js";import"./QuestionCircleOutlined-DTfTQPH4.js";import"./FormItemContext-B2RmG14m.js";import"./Input-DFtZp9vk.js";import"./index-Bxqtz4sn.js";import"./inputProps-jdR54afw.js";import"./DownloadOutlined-CeWsYko2.js";import"./index-hvcgcTJ4.js";import"./CheckOutlined-Mk6nTpyE.js";import"./useRefs-CRRjy_qY.js";import"./useMergedState-C0iIHNGF.js";const D="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2040%2040'%20class='design-iconfont'%3e%3crect%20width='40'%20height='40'%20rx='20'%20fill='%232475FC'/%3e%3cpath%20d='M10.0835%2030.5H31.0835'%20stroke='%23fff'%20stroke-width='2.275'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M12.4165%2021.5867V25.8333H16.6848L28.7498%2013.763L24.4886%209.5L12.4165%2021.5867Z'%20stroke='%23fff'%20stroke-width='2.275'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",H={class:"form-box"},T={__name:"modify-account",emits:["ok"],setup(O,{expose:c,emit:u}){const v=u,k=L.useForm,n=d(!1),p=d("修改登录密码"),t=U({password:"",check_password:"",old_password:"",id:""}),y=U({old_password:[{message:"请输入原始密码",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(a,s)=>!G(s)&&s?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):s==t.old_password?Promise.reject("原密码不能和新密码一致"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(a,s)=>s!=t.password&&s?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:m,validate:g,validateInfos:_}=k(t,y),w=a=>{n.value=!0,m(),t.password="",t.check_password="",t.old_password="",t.id=a.user_id},e=()=>{g().then(()=>{B({...F(t)}).then(a=>{A.success("修改成功"),n.value=!1,v("ok")})})};return c({open:w}),(a,s)=>{const r=V,x=J,S=L,C=N;return R(),M("div",null,[i(C,{open:n.value,"onUpdate:open":s[3]||(s[3]=f=>n.value=f),title:p.value,onOk:e,width:"476px"},{default:h(()=>[o("div",H,[i(S,{layout:"vertical"},{default:h(()=>[i(x,P({label:"原密码"},l(_).old_password),{default:h(()=>[i(r,{value:t.old_password,"onUpdate:value":s[0]||(s[0]=f=>t.old_password=f),placeholder:"请输入原始密码校验"},null,8,["value"])]),_:1},16),i(x,P({label:"登录密码"},l(_).password),{default:h(()=>[i(r,{value:t.password,"onUpdate:value":s[1]||(s[1]=f=>t.password=f),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),i(x,P({label:"确认密码"},l(_).check_password),{default:h(()=>[i(r,{value:t.check_password,"onUpdate:value":s[2]||(s[2]=f=>t.check_password=f),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},E=j(T,[["__scopeId","data-v-cb17ec91"]]),W={class:"upload-box"},X={__name:"modify-avatar",emits:["ok"],setup(O,{expose:c,emit:u}){const v=u;function k(e){return new Promise((a,s)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>a(r.result),r.onerror=x=>s(x)})}const n=d([]),p=d(""),t=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size/1024<1024?(n.value=[e],k(e).then(r=>{p.value=r,y()}),!1):(A.error("成员头像图片大小不能超过1M"),!1):(A.error("机器人头像只支持JPG、PNG格式的图片"),!1),y=()=>{let e={imageUrl:p.value,file:n.value[0].originFileObj};w(e)};d("修改登录密码");const m=U({id:""}),g=d(null),_=e=>{m.id=e.user_id,g.value.click()},w=e=>{B({...F(m),avatar:e.file}).then(a=>{A.success("修改成功"),v("ok",e.imageUrl)})};return c({setAvatar:_}),(e,a)=>{const s=z;return R(),M("div",W,[i(s,{"file-list":n.value,"onUpdate:fileList":a[0]||(a[0]=r=>n.value=r),"list-type":"picture-card","show-upload-list":!1,"before-upload":t,accept:".jpg,.png,.jpeg"},{default:h(()=>[o("div",{ref_key:"uploadBtnRef",ref:g},"修改头像",512)]),_:1},8,["file-list"])])}}},Z=j(X,[["__scopeId","data-v-f5e61674"]]),K={class:"user-account"},Q={class:"page-title"},Y={class:"user-avatar-box"},ee=["src"],se={class:"user-info-items"},oe={class:"user-info-item"},te={class:"item-left"},ae={class:"item-label"},re={class:"item-value"},ne={class:"user-info-item"},ie={class:"item-left"},le={class:"item-label"},ce={__name:"index",setup(O){const{t:c}=$(),u=q(),{userInfo:v,avatar:k,user_name:n}=I(u),p=d(null),t=()=>{p.value.open(v.value)},y=()=>{u.reset(!0)},m=d(null),g=()=>{m.value.setAvatar(v.value)},_=w=>{u.setAvatar(w)};return(w,e)=>(R(),M("div",K,[o("div",Q,b(l(c)("views.user.account.accountSettings")),1),o("div",Y,[o("img",{class:"user-avatar",src:l(k),alt:""},null,8,ee),o("span",{class:"change-avatar",onClick:g},e[0]||(e[0]=[o("img",{class:"change-btn",src:D,alt:"",srcset:""},null,-1)]))]),o("div",se,[o("div",oe,[o("div",te,[o("span",ae,b(l(c)("views.user.account.loginAccount")),1),o("span",re,b(l(n)),1)]),e[1]||(e[1]=o("div",{class:"item-right"},null,-1))]),o("div",ne,[o("div",ie,[o("span",le,b(l(c)("views.user.account.accountPassword")),1),e[2]||(e[2]=o("span",{class:"item-value"},"**************",-1))]),o("div",{class:"item-right",onClick:t},[o("a",null,b(l(c)("common.change")),1)])])]),i(E,{onOk:y,ref_key:"modifyAccountRef",ref:p},null,512),i(Z,{onOk:_,ref_key:"modifyAvatarRef",ref:m},null,512)]))}},$e=j(ce,[["__scopeId","data-v-c0eaeb88"]]);export{$e as default};
