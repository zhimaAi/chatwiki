import{b as m,a3 as A,d as D,w as Q,N as c,X as o,F as R,a1 as U,a2 as G,O as s,a6 as T,u as y,a5 as B,j as t,_ as $,U as l,Z as N,S as P,a7 as H,q as ee,D as te,a8 as oe,a0 as ae,z as j,W as E,G as se,V as ne,Y as V}from"./vue-chunks-BRsu9_To.js";import{b as I,e as K,j as W,d as X,h as F,f as re,R as le,M as ie,r as ce,k as ue}from"../../index-CzPebXix.js";import{L as _e}from"./layout-logo-BRnmFpzX.js";import{g as pe}from"./index-jmRHMddk.js";import{D as de}from"./DownOutlined-DXKkgIsm.js";import{M as Y,_ as Z}from"./index-DlQVT6K6.js";import{C as q}from"./CheckOutlined-Mk6nTpyE.js";import"./index-BSz5XTfh.js";import{D as J}from"./dropdown-DTOAy9tU.js";import{B as me,_ as ve}from"./index-CyLUFO3Y.js";import{v as be}from"./validate-8MtiUsxW.js";import{F as z,_ as he}from"./index-BgVvqN-n.js";import{_ as ye}from"./index-CBmR-lHY.js";import{_ as fe}from"./Password-fnCqxsm2.js";import"./index-BFhVTGQQ.js";import"./axios-Dq7h7Pqt.js";import"./qs-BrxkIg-9.js";import"./crypto-js-ClNpte_9.js";import"./dayjs-B6IotFah.js";import"./shallowequal-C0xnIuy8.js";import"./Trigger-Bvakuge0.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./collapseMotion-Brd6xpAT.js";import"./slide-CsbPJG8I.js";import"./index-Bhf8G0AA.js";import"./index-BwqnaIPU.js";import"./colors-DfoziJR7.js";import"./RightOutlined-DH_YROnp.js";import"./move-CkiYyFmr.js";import"./isPlainObject-OEy0Jz8l.js";import"./Col-CFxRRwN8.js";import"./responsiveObserve-DqAe0rZk.js";import"./QuestionCircleOutlined-DTfTQPH4.js";import"./FormItemContext-B2RmG14m.js";import"./Input-DFtZp9vk.js";import"./index-Bxqtz4sn.js";import"./inputProps-jdR54afw.js";import"./Search-Cf7bcOZJ.js";import"./SearchOutlined-a_gTycfl.js";import"./TextArea-DrgXbuSS.js";const ke={class:"navbar-wrapper"},ge={class:"navbar"},we=["onClick"],Ce={class:"nav-name"},$e={class:"down-icon"},Se=["onClick"],Me={class:"nav-name"},xe={__name:"layout-navbar",setup(L){const r=K(),u=G(),p=A(),d=m(()=>p.meta.activeMenu||""),v=m(()=>p.path.split("/")[1]),i=D(localStorage.getItem("local__robot_menu_key")||"robot_detail"),b=[{id:1,key:"robot",label:"robot",title:"机器人",icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:"知识库",icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:"文档",icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:"搜索",icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:"会话",icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}],C=m(()=>r.top_navigate),S=m(()=>C.value.filter(n=>n.open).map(n=>b.find(_=>_.key===n.id)).filter(Boolean)),h=e=>{u.push(e.path)},M=(e,n)=>{localStorage.setItem("local__robot_menu_key",e),i.value=e,k(n)},k=e=>{i.value=="robot_detail"?g():h(e)},g=async()=>{try{const{data:e=[]}=await pe();if(e.length===0){u.push("/robot/list");return}const n=localStorage.getItem("last_local_robot_id");let _;n&&(_=e.find(a=>a.id==n)),_=_||e[0];const{id:w,robot_key:x,application_type:f}=_;u.push({path:`/robot/config/${f==1?"workflow":"basic-config"}`,query:{id:w,robot_key:x}})}catch{u.push("/robot/list")}};return Q(()=>p.path,()=>{},{immediate:!0}),(e,n)=>{const _=X,w=Z,x=Y,f=J;return s(),c("div",ke,[o("div",ge,[(s(!0),c(R,null,U(S.value,a=>(s(),c(R,null,[y(W)(a.permission)?(s(),c(R,{key:0},[a.key==="robot"?(s(),c("div",{key:0,class:B(["nav-menu",{active:a.key===v.value||a.key===d.value}]),onClick:O=>k(a)},[t(_,{class:"nav-icon",name:a.icon},null,8,["name"]),o("span",Ce,$(a.title),1),t(f,null,{overlay:l(()=>[t(x,null,{default:l(()=>[t(w,{key:"1",onClick:O=>M("robot_detail",a)},{default:l(()=>[o("div",{class:B(["robot-ment-item",{"robot-active-item":i.value=="robot_detail"}])},[t(y(q),{class:"anticon-check"}),n[0]||(n[0]=N(" 进入机器人详情 "))],2)]),_:2},1032,["onClick"]),t(w,{key:"2",onClick:O=>M("robot_list",a)},{default:l(()=>[o("div",{class:B(["robot-ment-item",{"robot-active-item":i.value=="robot_list"}])},[t(y(q)),n[1]||(n[1]=N(" 进入机器人管理 "))],2)]),_:2},1032,["onClick"])]),_:2},1024)]),default:l(()=>[o("div",$e,[t(y(de))])]),_:2},1024)],10,we)):(s(),c("div",{key:1,class:B(["nav-menu",{active:a.key===v.value||a.key===d.value}]),onClick:O=>h(a)},[t(_,{class:"nav-icon",name:a.icon},null,8,["name"]),o("span",Me,$(a.title),1)],10,Se))],64)):T("",!0)],64))),256))])])}}},Re=I(xe,[["__scopeId","data-v-7b24017e"]]),Le={class:"layout-breadcrumb"},Ie={key:1,class:"page-title"},Pe={__name:"layout-breadcrumb",props:{title:{type:[String,Boolean],default:""},items:{type:[Array,Boolean],default:()=>[]}},setup(L){const r=L;return(u,p)=>{const d=H("router-link"),v=ve,i=me;return s(),c("div",Le,[r.items.length>0?(s(),P(i,{key:0},{default:l(()=>[(s(!0),c(R,null,U(r.items,(b,C)=>(s(),c(R,{key:b.title},[C!==r.items.length-1?(s(),P(v,{key:0},{default:l(()=>[t(d,{to:b.path},{default:l(()=>[N($(b.title),1)]),_:2},1032,["to"])]),_:2},1024)):(s(),P(v,{key:1},{default:l(()=>[N($(b.title),1)]),_:2},1024))],64))),128))]),_:1})):(s(),c("div",Ie,$(r.title),1))])}}},Te=I(Pe,[["__scopeId","data-v-3def9f41"]]),Be={class:"layout-footer"},De={class:"copyright-text"},Ne={__name:"layout-footer",setup(L){const r=F(),{t:u}=re(),p=D(null);return ee(()=>{p.value=setInterval(()=>{setTimeout(()=>{r.refreshToken()},0)},le)}),te(()=>{clearInterval(p.value),p.value=null}),(d,v)=>(s(),c("div",Be,[o("div",De,$(y(u)("common.copyright")),1)]))}},Fe=I(Ne,[["__scopeId","data-v-ca41b2c2"]]),Oe={key:0,class:"user-dropdown"},Ue=["src"],je={class:"user-name"},Ee=["onClick"],Ve={class:"menu-name"},qe={__name:"user-dropdown",setup(L){const r=K(),u=G(),p=F(),{userInfo:d,avatar:v,user_name:i}=oe(p),b=()=>{p.logoutConfirm(!0)},C=()=>{window.open("/#/user/model","_blank","noopener")},S=[{id:1,key:"robot",label:"robot",title:"应用",icon:"nav-robot",path:"/robot/list",permission:["RobotManage"]},{id:2,key:"library",label:"library",title:"知识库",icon:"nav-library",path:"/library/list",permission:["LibraryManage"]},{id:3,key:"PublicLibrary",label:"PublicLibrary",title:"文档",icon:"nav-doc",path:"/public-library/list",permission:["OpenLibDocManage"]},{id:4,key:"library-search",label:"library-search",title:"搜索",icon:"search",path:"/library-search/index",permission:["SearchManage"]},{id:5,key:"chat-monitor",label:"chat-monitor",title:"会话",icon:"nav-chat",path:"/chat-monitor/index",permission:["ChatSessionManage"]}],h=m(()=>r.top_navigate),M=m(()=>h.value.filter(e=>!e.open).map(e=>S.find(n=>n.key===e.id)).filter(Boolean)),k=g=>{u.push(g.path)};return(g,e)=>{const n=X,_=Z,w=Y,x=J;return y(d)?(s(),c("div",Oe,[t(x,null,{overlay:l(()=>[t(w,null,{default:l(()=>[t(_,null,{default:l(()=>[o("a",{class:"menu-item",href:"javascript:;",onClick:C},[t(n,{class:"menu-icon",name:"system-setting"}),e[1]||(e[1]=o("span",{class:"menu-name"},"系统管理",-1))])]),_:1}),(s(!0),c(R,null,U(M.value,f=>(s(),c(R,null,[y(W)(f.permission)?(s(),P(_,{key:0},{default:l(()=>[o("a",{class:"menu-item",href:"javascript:;",onClick:a=>k(f)},[t(n,{class:"menu-icon",name:f.icon},null,8,["name"]),o("span",Ve,$(f.title),1)],8,Ee)]),_:2},1024)):T("",!0)],64))),256)),t(_,null,{default:l(()=>[o("a",{class:"menu-item",href:"javascript:;",onClick:b},[t(n,{class:"menu-icon",name:"logout"}),e[2]||(e[2]=o("span",{class:"menu-name"},"退出登录",-1))])]),_:1})]),_:1})]),default:l(()=>[o("div",{class:"user-dropdown-link",onClick:e[0]||(e[0]=ae(()=>{},["prevent"]))},[o("img",{class:"user-avatar",src:y(v),alt:""},null,8,Ue),o("span",je,$(y(i)),1),t(n,{name:"arrow-down",style:{"font-size":"16px",color:"#8c8c8c"}})])]),_:1})])):T("",!0)}}},ze=I(qe,[["__scopeId","data-v-bb852be0"]]),Ae={class:"form-box"},Ge={__name:"reset-password",setup(L,{expose:r}){const u=F(),p=z.useForm,d=D(!0),v=D("重置登录密码"),i=j({password:"",check_password:"",id:u.userInfo.user_id}),b=j({password:[{message:"请输入登录密码",required:!0},{validator:async(g,e)=>!be(e)&&e?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(g,e)=>e!=i.password&&e?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:C,validate:S,validateInfos:h}=p(i,b),M=()=>{S().then(()=>{ce({...se(i)}).then(g=>{ue.success("修改成功"),d.value=!1,u.reset(!0)})})},k=()=>{u.setResetPassModal()};return r({open}),(g,e)=>{const n=ye,_=fe,w=he,x=z,f=ie;return s(),c("div",null,[t(f,{open:d.value,"onUpdate:open":e[2]||(e[2]=a=>d.value=a),title:v.value,onOk:M,width:"520px",onCancel:k},{default:l(()=>[t(n,{class:"alert-box",message:"您还未修改初始密码，为了保障您的数据安全，请您尽快重置密码。",type:"info","show-icon":""}),o("div",Ae,[t(x,{layout:"vertical"},{default:l(()=>[t(w,E({label:"登录密码"},y(h).password),{default:l(()=>[t(_,{value:i.password,"onUpdate:value":e[0]||(e[0]=a=>i.password=a),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),t(w,E({label:"确认密码"},y(h).check_password),{default:l(()=>[t(_,{value:i.check_password,"onUpdate:value":e[1]||(e[1]=a=>i.check_password=a),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},He=I(Ge,[["__scopeId","data-v-40aed5c2"]]),Ke={class:"admin-layout"},We={class:"layout-header-wrapper"},Xe={class:"layout-header"},Ye={class:"header-left"},Ze={class:"header-body"},Je={class:"header-right"},Qe={class:"item-box"},et={class:"layout-body"},tt={key:0,class:"layout-breadcrumb-wrapper"},ot={class:"layout-footer-wrapper"},at={__name:"index",setup(L){const r=A(),u=F(),p=m(()=>r.meta.isCustomPage||!1),d=m(()=>r.meta.pageStyle||{}),v=m(()=>r.meta.bgColor||"#ffffff"),i=m(()=>r.meta.breadcrumb||[]),b=m(()=>r.meta.hideTitle||!1),C=m(()=>r.meta.title||!1),S=m(()=>{var h;return((h=u.userInfo)==null?void 0:h.d_pass)==1&&u.isShowResetPassModal});return(h,M)=>{const k=H("router-view");return s(),c("div",Ke,[o("div",We,[o("div",Xe,[o("div",Ye,[t(_e)]),o("div",Ze,[t(Re)]),o("div",Je,[o("div",Qe,[t(ze)])])])]),o("div",et,[p.value?ne(h.$slots,"default",{key:0},()=>[t(k)],!0):(s(),c("div",{key:1,class:"page-wrapper",style:V({"background-color":v.value})},[b.value?T("",!0):(s(),c("div",tt,[t(Te,{items:i.value,title:C.value},null,8,["items","title"])])),o("div",{class:"page-container",style:V({...d.value})},[t(k)],4)],4))]),o("div",ot,[t(Fe)]),S.value?(s(),P(He,{key:0})):T("",!0)])}}},At=I(at,[["__scopeId","data-v-d663ab1a"]]);export{At as default};
