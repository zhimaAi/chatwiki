{"version":3,"file":"library-select-alert-BCR3m1P9.js","sources":["../../../../front-end/chat-ai-admin-vue/src/views/robot/robot-config/basic-config/components/associated-knowledge-base/library-select-alert.vue"],"sourcesContent":["<style lang=\"less\">\r\n.correlation-library-modal.ant-modal-wrap .ant-modal-content {\r\n  padding: 0;\r\n}\r\n</style>\r\n<style lang=\"less\" scoped>\r\n.library-checkbox-box {\r\n  .list-tools {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-top: 16px;\r\n    margin-bottom: 8px;\r\n  }\r\n  .list-group-box {\r\n    display: flex;\r\n    height: auto;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .group-list-box {\r\n    width: 248px;\r\n    border-right: 1px solid #d9d9d9;\r\n    position: relative;\r\n    padding: 24px 0 0 16px;\r\n    .main-title-block {\r\n      color: #262626;\r\n      font-size: 16px;\r\n      font-weight: 600;\r\n      line-height: 24px;\r\n      padding-left: 8px;\r\n      padding-bottom: 24px;\r\n    }\r\n\r\n    .classify-box {\r\n      flex: 1;\r\n      overflow: hidden;\r\n      font-size: 14px;\r\n      .classify-item {\r\n        height: 40px;\r\n        padding: 0 16px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        cursor: pointer;\r\n        border-radius: 6px;\r\n        color: #595959;\r\n        transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\r\n\r\n        .classify-title {\r\n          flex: 1;\r\n          text-overflow: ellipsis;\r\n          overflow: hidden;\r\n          white-space: nowrap;\r\n        }\r\n        .num {\r\n          display: block;\r\n        }\r\n        &:hover {\r\n          background: #f2f4f7;\r\n        }\r\n        &.active {\r\n          color: #2475fc;\r\n          background: #e6efff;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .list-item-box {\r\n    flex: 1;\r\n    overflow: hidden;\r\n    padding-top: 24px;\r\n    .alert-box {\r\n      width: 600px;\r\n      padding-left: 16px;\r\n    }\r\n    .btn-box {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      margin-top: 16px;\r\n      margin-bottom: 8px;\r\n      padding-left: 16px;\r\n    }\r\n  }\r\n  .library-list-item {\r\n    min-height: 97px;\r\n    padding: 24px 12px;\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    cursor: pointer;\r\n    &:hover {\r\n      background: var(--09, #f2f4f7);\r\n    }\r\n    .avatar-box {\r\n      width: 48px;\r\n      height: 48px;\r\n      img {\r\n        width: 100%;\r\n        height: 100%;\r\n        border-radius: 12px;\r\n      }\r\n    }\r\n    .info-content-box {\r\n      flex: 1;\r\n      .title-info-block {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        color: #262626;\r\n        font-weight: 600;\r\n        line-height: 22px;\r\n        .type-tag {\r\n          height: 18px;\r\n          line-height: 16px;\r\n          padding: 0 4px;\r\n          font-size: 12px;\r\n          font-weight: 400;\r\n          border-radius: 6px;\r\n          color: #2475fc;\r\n          border: 1px solid #99bffd;\r\n          &.gray-tag {\r\n            border: 1px solid var(--06, #d9d9d9);\r\n            color: #8c8c8c;\r\n          }\r\n        }\r\n      }\r\n      .desc-info-block {\r\n        color: #8c8c8c;\r\n        font-size: 14px;\r\n        line-height: 22px;\r\n        font-weight: 400;\r\n        margin-top: 4px;\r\n      }\r\n    }\r\n  }\r\n  .footer-box {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: flex-end;\r\n    gap: 8px;\r\n    border-top: 1px solid var(--06, #d9d9d9);\r\n    padding: 8px 24px;\r\n  }\r\n}\r\n</style>\r\n\r\n<template>\r\n  <a-modal\r\n    :width=\"916\"\r\n    v-model:open=\"show\"\r\n    wrapClassName=\"correlation-library-modal\"\r\n    :title=\"null\"\r\n    :footer=\"null\"\r\n  >\r\n    <div class=\"library-checkbox-box\">\r\n      <div class=\"list-group-box\">\r\n        <div class=\"group-list-box\">\r\n          <div class=\"main-title-block\">{{ t('title_associate_library') }}</div>\r\n          <div style=\"margin-bottom: 16px\">\r\n            <a-input\r\n              style=\"width: 216px\"\r\n              v-model:value=\"searchKeyword\"\r\n              :placeholder=\"t('ph_search_library_name')\"\r\n              @change=\"onSearch\"\r\n            >\r\n              <template #suffix>\r\n                <SearchOutlined style=\"color: rgba(0, 0, 0, 0.25)\" />\r\n              </template>\r\n            </a-input>\r\n          </div>\r\n          <cu-scroll style=\"padding-right: 16px; height: 480px\">\r\n            <div class=\"classify-box\">\r\n              <div\r\n                class=\"classify-item\"\r\n                @click=\"handleChangeGroup(item)\"\r\n                :class=\"{ active: item.id == group_id }\"\r\n                v-for=\"item in groupLists\"\r\n                :key=\"item.id\"\r\n              >\r\n                <div class=\"classify-title\">{{ item.group_name }}</div>\r\n                <div class=\"right-content\">\r\n                  <div class=\"num\" :class=\"{ 'num-block': item.id <= 0 }\">{{ item.total }}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </cu-scroll>\r\n        </div>\r\n        <div class=\"list-item-box\">\r\n          <div class=\"alert-box\">\r\n            <a-alert\r\n              class=\"zm-alert-info\"\r\n              :message=\"t('msg_select_library_tips')\"\r\n              type=\"info\"\r\n            />\r\n          </div>\r\n          <div class=\"btn-box\">\r\n            <a-button @click=\"onRefresh\"> <SyncOutlined /> {{ t('btn_refresh') }} </a-button>\r\n            <a-button type=\"primary\" ghost @click=\"openAddLibrary\">{{ t('btn_create_library') }}</a-button>\r\n          </div>\r\n          <a-spin :spinning=\"isRefresh\" :delay=\"100\">\r\n            <cu-scroll style=\"padding: 0 16px; height: 414px\">\r\n              <div\r\n                class=\"library-list-item\"\r\n                @click=\"handleChangeChecked(item)\"\r\n                v-for=\"item in showOptions\"\r\n                :key=\"item.id\"\r\n              >\r\n                <div class=\"avatar-box\">\r\n                  <img :src=\"item.avatar\" alt=\"\" />\r\n                </div>\r\n                <div class=\"info-content-box\">\r\n                  <div class=\"title-info-block\">\r\n                    {{ item.library_name }}\r\n                    <span class=\"type-tag\" :class=\"{ 'gray-tag': item.graph_switch == 0 }\"\r\n                      >{{ t('tag_graph') }}</span\r\n                    >\r\n                    <span class=\"type-tag\" v-if=\"item.type == 0\">{{ t('tag_normal_library') }}</span>\r\n                    <span class=\"type-tag\" v-if=\"item.type == 1\">{{ t('tag_external_library') }}</span>\r\n                    <span class=\"type-tag\" v-if=\"item.type == 2\">{{ t('tag_qa_library') }}</span>\r\n                    <span class=\"type-tag\" v-if=\"item.type == 3\">{{ t('tag_wechat_library') }}</span>\r\n                  </div>\r\n                  <div class=\"desc-info-block\">{{ item.library_intro }}</div>\r\n                </div>\r\n                <div class=\"check-block\">\r\n                  <a-checkbox\r\n                    :disabled=\"robotInfo.default_library_id == item.id\"\r\n                    :checked=\"state.checkedList.includes(item.id)\"\r\n                  ></a-checkbox>\r\n                </div>\r\n              </div>\r\n            </cu-scroll>\r\n          </a-spin>\r\n          <div class=\"footer-box\">\r\n            <a-button @click=\"show = false\">{{ t('btn_cancel') }}</a-button>\r\n            <a-button type=\"primary\" @click=\"saveCheckedList\">\r\n              ({{ state.checkedList.length }}) {{ t('btn_confirm') }}</a-button\r\n            >\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, computed } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\nimport { SearchOutlined, SyncOutlined, RightOutlined, LeftOutlined } from '@ant-design/icons-vue'\r\nimport { getLibraryList, getLibraryListGroup } from '@/api/library/index'\r\nimport { useRobotStore } from '@/stores/modules/robot'\r\nimport { useI18n } from '@/hooks/web/useI18n'\r\n\r\nconst robotStore = useRobotStore()\r\nconst { robotInfo } = robotStore\r\n\r\nconst { t } = useI18n('views.robot.robot-config.basic-config.components.associated-knowledge-base.library-select-alert')\r\n\r\nconst emit = defineEmits(['change'])\r\nconst props = defineProps({\r\n  showWxType: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nconst state = reactive({\r\n  indeterminate: false,\r\n  checkAll: false,\r\n  checkedList: []\r\n})\r\n\r\nconst group_id = ref('')\r\n\r\nconst groupLists = ref([])\r\n\r\nconst getGroupList = () => {\r\n  getLibraryListGroup().then((res) => {\r\n    let lists = res.data || []\r\n    let totalNumber = 0\r\n    // 计算每个分组的机器人数量\r\n    lists.forEach((group) => {\r\n      totalNumber += +group.total\r\n    })\r\n    groupLists.value = [\r\n      {\r\n        group_name: t('group_all'),\r\n        total: totalNumber,\r\n        id: ''\r\n      },\r\n      ...lists\r\n    ]\r\n  })\r\n}\r\n\r\nconst handleChangeGroup = (item) => {\r\n  group_id.value = item.id\r\n  getList()\r\n}\r\n\r\nconst show = ref(false)\r\n\r\nconst open = (checkedList) => {\r\n  group_id.value = ''\r\n  getList()\r\n  getGroupList()\r\n\r\n  state.checkedList = checkedList\r\n  show.value = true\r\n}\r\n\r\nconst saveCheckedList = () => {\r\n  show.value = false\r\n  triggerChange()\r\n}\r\n\r\nconst searchKeyword = ref('')\r\n\r\nconst onSearch = () => {\r\n  getList()\r\n}\r\n\r\nconst options = ref([])\r\n\r\nconst showOptions = computed(() => {\r\n  if (props.showWxType) {\r\n    return options.value\r\n  } else {\r\n    return options.value.filter((item) => item.type != 3)\r\n  }\r\n})\r\n\r\nconst triggerChange = () => {\r\n  emit('change', [...state.checkedList])\r\n}\r\n\r\nconst getList = async () => {\r\n  isRefresh.value = true\r\n  const res = await getLibraryList({\r\n    library_name: searchKeyword.value,\r\n    type: '',\r\n    show_open_docs: 1\r\n  })\r\n  isRefresh.value = false\r\n  if (res) {\r\n    let list = res.data || []\r\n    if (group_id.value != '') {\r\n      list = list.filter((item) => item.group_id == group_id.value)\r\n    }\r\n    options.value = list\r\n  }\r\n}\r\n\r\nconst handleChangeChecked = (e) => {\r\n  let value = e.id\r\n  if (robotInfo.default_library_id == value) {\r\n    return\r\n  }\r\n  if (state.checkedList.includes(value)) {\r\n    state.checkedList = state.checkedList.filter((item) => item != value)\r\n  } else {\r\n    state.checkedList.push(value)\r\n  }\r\n}\r\n\r\nconst isRefresh = ref(false)\r\nconst onRefresh = async () => {\r\n  isRefresh.value = true\r\n\r\n  await getList()\r\n\r\n  isRefresh.value = false\r\n\r\n  message.success(t('msg_refresh_success'))\r\n}\r\n\r\nconst openAddLibrary = () => {\r\n  window.open('/#/library/list')\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n"],"names":["robotStore","useRobotStore","robotInfo","t","useI18n","emit","__emit","props","__props","state","reactive","group_id","ref","groupLists","getGroupList","getLibraryListGroup","res","lists","totalNumber","group","handleChangeGroup","item","getList","show","open","checkedList","saveCheckedList","triggerChange","searchKeyword","onSearch","options","showOptions","computed","isRefresh","getLibraryList","list","handleChangeChecked","e","value","onRefresh","message","openAddLibrary","__expose","_createBlock","_component_a_modal","$event","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","_unref","_hoisted_5","_createVNode","_component_a_input","SearchOutlined","_component_cu_scroll","_hoisted_6","_createElementBlock","_Fragment","_renderList","_hoisted_8","_hoisted_9","_normalizeClass","_hoisted_10","_hoisted_11","_component_a_alert","_hoisted_12","_component_a_button","SyncOutlined","_createTextVNode","_component_a_spin","_hoisted_14","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_component_a_checkbox","_hoisted_24"],"mappings":"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"}