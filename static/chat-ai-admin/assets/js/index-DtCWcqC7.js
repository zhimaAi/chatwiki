import{_ as P}from"./cu-scroll-BiKEilFP.js";import{Q as U,K as J}from"./knowledge-document-Cp_MEyem.js";import{am as W,b as T,e as Z,d as X,F as tt,an as at,ao as et,ap as ot,aq as st}from"../../index-0SFcfYGN.js";import{u as V}from"./robot-DwqmFfQP.js";import{e as R,f as w,o as D,Y as l,_ as s,a1 as m,ae as u,F as E,ab as q,ag as it,r as rt,h as lt,a5 as a,k as _,a2 as c,G as A,a9 as nt,B as k,u as $,a7 as b,ad as ct,J as _t,aa as dt}from"./vue-chunks-BSjLwu6d.js";import{G as pt}from"./index-B4oOBcCh.js";import{L as ut}from"./library-select-alert-Dakag8_a.js";import{B as yt,p as bt,b as mt,c as ft,D as vt,M as ht,a as gt,Y as kt,d as B,Z as wt}from"./ui-antd-BIopZvX3.js";import"./pull-up.esm-D94Swpvl.js";import"./observe-dom.esm-CyCedSm-.js";import"./edit-subsection-CTQGqx4f.js";import"./index-Beyh1KL9.js";import"./index-1KR-OfoX.js";import"./util-BwuffJOK.js";import"./index-WmX9Oj3S.js";import"./index-B3eanVnA.js";import"./index-BMSQkwth.js";import"./upload-input-DlFNN4-Q.js";import"./validate-8MtiUsxW.js";import"./model-select-BMElW6Zs.js";import"./open-grapg-modal-B3ns2jr7.js";import"./rename-modal-BX4ipd3h.js";import"./page-alert-CS0KjXGI.js";import"./vuedraggable.umd-CLoFUBnR.js";import"./utils-BMKRjDTh.js";const xt={__name:"default-library",setup(M){const f=V(),d=R(()=>f.robotInfo.default_library_id),n=w(null);return D(()=>{W({id:d.value}).then(y=>{n.value=+y.data.type||0})}),(y,v)=>(s(),l(E,null,[n.value==2?(s(),m(U,{key:0,library_id:d.value},null,8,["library_id"])):u("",!0),n.value==0?(s(),m(J,{key:1,library_id:d.value},null,8,["library_id"])):u("",!0)],64))}},Lt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1749612065457'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5081'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='256'%20height='256'%3e%3cpath%20d='M0%200v1024L1024%200H0z%20m294.4%20172.8h12.8c22.4%200%2048-3.2%2060.8%200v32c-19.2-3.2-51.2%200-76.8%200l3.2-32z%20m-128%20422.4l44.8-48-19.2-16-38.4%2038.4-19.2-19.2L172.8%20512l-12.8-12.8-38.4%2038.4L28.8%20448%20128%20348.8l92.8%2092.8L179.2%20480l16%2016%2038.4-38.4%2019.2%2019.2L214.4%20512l16%2016%2038.4-44.8%2019.2%2019.2c-35.2%2041.6-73.6%2083.2-99.2%20112l-22.4-19.2z%20m60.8%2073.6c-6.4-19.2-16-44.8-25.6-64l22.4-6.4c9.6%2019.2%2022.4%2044.8%2025.6%2064l-22.4%206.4z%20m48-38.4c-9.6-12.8-28.8-28.8-44.8-41.6l9.6-12.8c16%209.6%2035.2%2025.6%2048%2038.4l-12.8%2016z%20m22.4-32c-9.6-9.6-28.8-22.4-44.8-32l9.6-16c16%209.6%2035.2%2019.2%2048%2028.8l-12.8%2019.2z%20m16-35.2c-9.6-6.4-25.6-16-41.6-19.2l9.6-19.2c16%203.2%2032%2012.8%2041.6%2019.2l-9.6%2019.2z%20m48-9.6c-9.6%200-22.4%200-32%203.2-3.2-70.4-38.4-128-73.6-169.6l-38.4%2038.4-22.4-22.4%2038.4-38.4-9.6-9.6-57.6-57.6%2019.2-19.2%2019.2%2019.2%206.4-22.4c22.4%203.2%2051.2%206.4%2067.2%2012.8l-6.4%2022.4c-16-6.4-44.8-9.6-67.2-12.8l48%2048%2048-48%2022.4%2022.4-48%2048c60.8%2041.6%20121.6%2070.4%20172.8%2064%200%209.6%200%2022.4%203.2%2032-41.6%203.2-86.4-16-134.4-44.8%2022.4%2041.6%2041.6%2083.2%2044.8%20134.4z%20m150.4-163.2c-6.4-3.2-22.4-3.2-28.8-3.2%200-9.6%200-25.6-12.8-38.4l-80-80L352%20307.2l-22.4-22.4%2064-60.8%2099.2%2099.2%209.6-44.8%2025.6%2012.8c-16%2076.8-16%2089.6-16%2099.2z%20m67.2-51.2c-9.6-3.2-25.6-3.2-35.2%200%2016-102.4-64-182.4-144-262.4l-9.6-9.6%2025.6-22.4c25.6%2025.6%2048%2051.2%2070.4%2076.8%2028.8%2022.4%20112%2086.4%20201.6%2070.4-3.2%209.6%200%2025.6%200%2035.2-54.4%209.6-108.8-12.8-150.4-35.2%2032%2044.8%2048%2096%2041.6%20147.2z'%20p-id='5082'%20fill='%232475fc'%3e%3c/path%3e%3cpath%20d='M124.8%20384l-25.6%2025.6L160%20467.2l25.6-25.6L124.8%20384z%20m25.6%2067.2c-6.4-12.8-19.2-35.2-28.8-48l16-6.4c9.6%2016%2019.2%2038.4%2022.4%2051.2l-9.6%203.2zM64%20444.8l60.8%2060.8%2022.4-25.6-60.8-60.8-22.4%2025.6z%20m57.6%2041.6c-9.6-9.6-28.8-22.4-44.8-28.8l6.4-12.8c16%206.4%2035.2%2019.2%2044.8%2028.8l-6.4%2012.8z'%20p-id='5083'%20fill='%232475fc'%3e%3c/path%3e%3c/svg%3e",Ct={class:"main-content-block"},St={class:"btn-block"},zt={class:"list-box"},Rt=["onClick"],At={key:0,class:"default-icon",src:Lt,alt:""},Dt={class:"library-info"},Mt=["src"],Yt={class:"library-info-content"},It={class:"library-title"},$t={class:"library-type"},Bt={key:0,class:"type-tag"},Kt={key:1,class:"type-tag"},Tt={key:2,class:"type-tag"},Vt={class:"item-body"},Et={class:"library-desc"},qt={class:"item-footer"},Gt={class:"library-size"},Nt={class:"text-item"},Ot={class:"text-item"},jt={class:"text-item"},Ft=["onClick"],Qt=["onClick"],Ht={__name:"related-library",setup(M){const f=Z(),d=R(()=>{var t;return((t=f.companyInfo)==null?void 0:t.neo4j_status)=="true"}),n=q().query,y=V(),{getRobot:v}=y,{robotInfo:p}=it(y),i=rt({library_ids:[],default_library_id:""}),h=w([]),g=w(null),x=R(()=>{let t=h.value.filter(e=>i.library_ids.includes(e.id));if(p.value.default_library_id){let e=t.find(r=>r.id==p.value.default_library_id);e&&(t=t.filter(r=>r.id!=p.value.default_library_id),t.unshift(e))}return t}),L=t=>{let e=i.library_ids.indexOf(t.id);i.library_ids.splice(e,1),z()},C=t=>{ht.confirm({title:`确定将${t.library_name}设为默认知识库吗？`,icon:null,content:_("div",{style:"color:red;"},"一个机器人只能有一个默认知识库"),onOk(){i.default_library_id=t.id,z(i.default_library_id)},onCancel(){}})},S=()=>{g.value.open([...i.library_ids])},G=t=>{i.library_ids=[...t],z()},z=t=>{let e={..._t(i)};e.library_ids=e.library_ids.join(","),pt({library_ids:e.library_ids,default_library_id:t||null,id:n.id}).then(r=>{gt.success("操作成功"),v(n.id)})};lt(()=>{i.library_ids=p.value.library_ids.split(","),i.default_library_id=p.value.default_library_id||""});const N=t=>{t.type=="1"?window.open(`/#/public-library/config?library_id=${t.id}`,"_blank","noopener"):window.open(`/#/library/details?id=${t.id}`,"_blank","noopener")},O=async()=>{const t=await tt({type:"",show_open_docs:1});if(t){let e=t.data||[];e.forEach(r=>{r.file_size_str=at(r.file_size),r.avatar||(r.avatar=r.type==0?et:ot)}),h.value=e}};return D(()=>{O()}),(t,e)=>{const r=yt,j=bt,F=X,Y=ft,Q=mt,H=vt;return s(),l("div",Ct,[a("div",St,[_(r,{type:"primary",onClick:S},{default:c(()=>e[2]||(e[2]=[A("关联知识库")])),_:1,__:[2]})]),a("div",zt,[(s(!0),l(E,null,nt(x.value,o=>(s(),l("div",{class:"list-item-wrapper",key:o.id},[a("div",{class:"list-item",onClick:k(I=>N(o),["stop"])},[o.id==$(p).default_library_id?(s(),l("img",At)):u("",!0),a("div",Dt,[a("img",{class:"library-icon",src:o.avatar,alt:""},null,8,Mt),a("div",Yt,[a("div",It,b(o.library_name),1),a("div",$t,[o.type==0?(s(),l("span",Bt,"普通知识库")):u("",!0),o.type==1?(s(),l("span",Kt,"对外知识库")):u("",!0),o.type==2?(s(),l("span",Tt,"问答知识库")):u("",!0),d.value?(s(),m(j,{key:3},{title:c(()=>[A(b(o.graph_switch==0?"未":"已")+"开启知识图谱生成",1)]),default:c(()=>[a("span",{class:ct(["type-tag graph-tag",{"gray-tag":o.graph_switch==0}])},"Graph",2)]),_:2},1024)):u("",!0)])])]),a("div",Vt,[a("div",Et,b(o.library_intro),1)]),a("div",qt,[a("div",Gt,[a("span",Nt,"文档："+b(o.file_total),1),a("span",Ot,"大小："+b(o.file_size_str),1),a("span",jt,"关联应用："+b(o.robot_nums||0),1)]),o.id!=$(p).default_library_id?(s(),l("div",{key:0,class:"action-box",onClick:e[1]||(e[1]=k(()=>{},["stop"]))},[_(H,null,{overlay:c(()=>[_(Q,null,{default:c(()=>[o.type!=1?(s(),m(Y,{key:0},{default:c(()=>[a("a",{onClick:k(I=>C(o),["stop"])},"设为默认",8,Ft)]),_:2},1024)):u("",!0),_(Y,null,{default:c(()=>[a("a",{class:"delete-text-color",onClick:k(I=>L(o),["stop"])},"取消关联",8,Qt)]),_:2},1024)]),_:2},1024)]),default:c(()=>[a("div",{class:"action-item",onClick:e[0]||(e[0]=k(()=>{},["stop"]))},[_(F,{class:"action-icon",name:"point-h"})])]),_:2},1024)])):u("",!0)])],8,Rt)]))),128))]),_(ut,{ref_key:"librarySelectAlertRef",ref:g,onChange:G},null,512)])}}},Pt=T(Ht,[["__scopeId","data-v-e875e068"]]),Ut={class:"main-content-block"},Jt={class:"tab-right-extra"},Wt={key:0,class:"body-content-box",style:{"padding-right":"16px"}},Zt={key:1,class:"body-content-box"},K="/robot/config/library-config/activeKey",Xt={__name:"index",setup(M){const f=dt(),d=q().query,n=w(+localStorage.getItem(K)||1),y=()=>{localStorage.setItem(K,n.value)},v=w(0),p=async()=>{st({robot_id:d.id,start_date:B().subtract(6,"day").format("YYYY-MM-DD"),end_date:B().format("YYYY-MM-DD")}).then(h=>{v.value=h.data.header.library_hit_rate})},i=()=>{localStorage.setItem("/robot/config/statistical_analysis/activeKey",3),f.push({path:"/robot/config/statistical_analysis",query:{id:d.id,robot_key:d.robot_key}})};return D(()=>{p()}),(h,g)=>{const x=wt,L=kt,C=P;return s(),l("div",Ut,[_(L,{class:"tab-wrapper",activeKey:n.value,"onUpdate:activeKey":g[0]||(g[0]=S=>n.value=S),onChange:y},{rightExtra:c(()=>[a("div",Jt,[A(" 近7天客户消息知识库命中率："+b(v.value)+"% ",1),a("a",{onClick:i},"查看")])]),default:c(()=>[(s(),m(x,{key:1,tab:"默认知识库"})),(s(),m(x,{key:2,tab:"关联知识库"}))]),_:1},8,["activeKey"]),n.value==1?(s(),l("div",Wt,[_(xt)])):(s(),l("div",Zt,[_(C,null,{default:c(()=>[_(Pt)]),_:1})]))])}}},C2=T(Xt,[["__scopeId","data-v-b0e673b1"]]);export{C2 as default};
